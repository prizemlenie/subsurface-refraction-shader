{"version":3,"file":"index-C90IC0nz.js","sources":["../../node_modules/three/build/three.core.js","../../node_modules/three/build/three.webgpu.js","../../node_modules/three/examples/jsm/utils/BufferGeometryUtils.js","../../node_modules/three/examples/jsm/loaders/GLTFLoader.js","../../node_modules/three/examples/jsm/loaders/DRACOLoader.js","../../src/js/assetsLoadingIndicator.js","../../src/js/loadMesh.js","../../node_modules/three/build/three.tsl.js","../../node_modules/three/examples/jsm/tsl/display/BloomNode.js","../../node_modules/three/examples/jsm/controls/OrbitControls.js","../../node_modules/tweakpane/dist/tweakpane.js","../../node_modules/@tweakpane/plugin-essentials/dist/tweakpane-plugin-essentials.js","../../src/js/gui.js","../../src/js/sceneSetup.js","../../src/js/subsurfaceShader.js","../../src/js/createNormalCubeMap.js","../../src/js/uniforms.js","../../src/js/initMeshMaterial.js","../../src/js/index.js"],"sourcesContent":["/**\n * @license\n * Copyright 2010-2024 Three.js Authors\n * SPDX-License-Identifier: MIT\n */\nconst REVISION = '171';\n\nconst MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2, ROTATE: 0, DOLLY: 1, PAN: 2 };\nconst TOUCH = { ROTATE: 0, PAN: 1, DOLLY_PAN: 2, DOLLY_ROTATE: 3 };\nconst CullFaceNone = 0;\nconst CullFaceBack = 1;\nconst CullFaceFront = 2;\nconst CullFaceFrontBack = 3;\nconst BasicShadowMap = 0;\nconst PCFShadowMap = 1;\nconst PCFSoftShadowMap = 2;\nconst VSMShadowMap = 3;\nconst FrontSide = 0;\nconst BackSide = 1;\nconst DoubleSide = 2;\nconst NoBlending = 0;\nconst NormalBlending = 1;\nconst AdditiveBlending = 2;\nconst SubtractiveBlending = 3;\nconst MultiplyBlending = 4;\nconst CustomBlending = 5;\nconst AddEquation = 100;\nconst SubtractEquation = 101;\nconst ReverseSubtractEquation = 102;\nconst MinEquation = 103;\nconst MaxEquation = 104;\nconst ZeroFactor = 200;\nconst OneFactor = 201;\nconst SrcColorFactor = 202;\nconst OneMinusSrcColorFactor = 203;\nconst SrcAlphaFactor = 204;\nconst OneMinusSrcAlphaFactor = 205;\nconst DstAlphaFactor = 206;\nconst OneMinusDstAlphaFactor = 207;\nconst DstColorFactor = 208;\nconst OneMinusDstColorFactor = 209;\nconst SrcAlphaSaturateFactor = 210;\nconst ConstantColorFactor = 211;\nconst OneMinusConstantColorFactor = 212;\nconst ConstantAlphaFactor = 213;\nconst OneMinusConstantAlphaFactor = 214;\nconst NeverDepth = 0;\nconst AlwaysDepth = 1;\nconst LessDepth = 2;\nconst LessEqualDepth = 3;\nconst EqualDepth = 4;\nconst GreaterEqualDepth = 5;\nconst GreaterDepth = 6;\nconst NotEqualDepth = 7;\nconst MultiplyOperation = 0;\nconst MixOperation = 1;\nconst AddOperation = 2;\nconst NoToneMapping = 0;\nconst LinearToneMapping = 1;\nconst ReinhardToneMapping = 2;\nconst CineonToneMapping = 3;\nconst ACESFilmicToneMapping = 4;\nconst CustomToneMapping = 5;\nconst AgXToneMapping = 6;\nconst NeutralToneMapping = 7;\nconst AttachedBindMode = 'attached';\nconst DetachedBindMode = 'detached';\n\nconst UVMapping = 300;\nconst CubeReflectionMapping = 301;\nconst CubeRefractionMapping = 302;\nconst EquirectangularReflectionMapping = 303;\nconst EquirectangularRefractionMapping = 304;\nconst CubeUVReflectionMapping = 306;\nconst RepeatWrapping = 1000;\nconst ClampToEdgeWrapping = 1001;\nconst MirroredRepeatWrapping = 1002;\nconst NearestFilter = 1003;\nconst NearestMipmapNearestFilter = 1004;\nconst NearestMipMapNearestFilter = 1004;\nconst NearestMipmapLinearFilter = 1005;\nconst NearestMipMapLinearFilter = 1005;\nconst LinearFilter = 1006;\nconst LinearMipmapNearestFilter = 1007;\nconst LinearMipMapNearestFilter = 1007;\nconst LinearMipmapLinearFilter = 1008;\nconst LinearMipMapLinearFilter = 1008;\nconst UnsignedByteType = 1009;\nconst ByteType = 1010;\nconst ShortType = 1011;\nconst UnsignedShortType = 1012;\nconst IntType = 1013;\nconst UnsignedIntType = 1014;\nconst FloatType = 1015;\nconst HalfFloatType = 1016;\nconst UnsignedShort4444Type = 1017;\nconst UnsignedShort5551Type = 1018;\nconst UnsignedInt248Type = 1020;\nconst UnsignedInt5999Type = 35902;\nconst AlphaFormat = 1021;\nconst RGBFormat = 1022;\nconst RGBAFormat = 1023;\nconst LuminanceFormat = 1024;\nconst LuminanceAlphaFormat = 1025;\nconst DepthFormat = 1026;\nconst DepthStencilFormat = 1027;\nconst RedFormat = 1028;\nconst RedIntegerFormat = 1029;\nconst RGFormat = 1030;\nconst RGIntegerFormat = 1031;\nconst RGBIntegerFormat = 1032;\nconst RGBAIntegerFormat = 1033;\n\nconst RGB_S3TC_DXT1_Format = 33776;\nconst RGBA_S3TC_DXT1_Format = 33777;\nconst RGBA_S3TC_DXT3_Format = 33778;\nconst RGBA_S3TC_DXT5_Format = 33779;\nconst RGB_PVRTC_4BPPV1_Format = 35840;\nconst RGB_PVRTC_2BPPV1_Format = 35841;\nconst RGBA_PVRTC_4BPPV1_Format = 35842;\nconst RGBA_PVRTC_2BPPV1_Format = 35843;\nconst RGB_ETC1_Format = 36196;\nconst RGB_ETC2_Format = 37492;\nconst RGBA_ETC2_EAC_Format = 37496;\nconst RGBA_ASTC_4x4_Format = 37808;\nconst RGBA_ASTC_5x4_Format = 37809;\nconst RGBA_ASTC_5x5_Format = 37810;\nconst RGBA_ASTC_6x5_Format = 37811;\nconst RGBA_ASTC_6x6_Format = 37812;\nconst RGBA_ASTC_8x5_Format = 37813;\nconst RGBA_ASTC_8x6_Format = 37814;\nconst RGBA_ASTC_8x8_Format = 37815;\nconst RGBA_ASTC_10x5_Format = 37816;\nconst RGBA_ASTC_10x6_Format = 37817;\nconst RGBA_ASTC_10x8_Format = 37818;\nconst RGBA_ASTC_10x10_Format = 37819;\nconst RGBA_ASTC_12x10_Format = 37820;\nconst RGBA_ASTC_12x12_Format = 37821;\nconst RGBA_BPTC_Format = 36492;\nconst RGB_BPTC_SIGNED_Format = 36494;\nconst RGB_BPTC_UNSIGNED_Format = 36495;\nconst RED_RGTC1_Format = 36283;\nconst SIGNED_RED_RGTC1_Format = 36284;\nconst RED_GREEN_RGTC2_Format = 36285;\nconst SIGNED_RED_GREEN_RGTC2_Format = 36286;\nconst LoopOnce = 2200;\nconst LoopRepeat = 2201;\nconst LoopPingPong = 2202;\nconst InterpolateDiscrete = 2300;\nconst InterpolateLinear = 2301;\nconst InterpolateSmooth = 2302;\nconst ZeroCurvatureEnding = 2400;\nconst ZeroSlopeEnding = 2401;\nconst WrapAroundEnding = 2402;\nconst NormalAnimationBlendMode = 2500;\nconst AdditiveAnimationBlendMode = 2501;\nconst TrianglesDrawMode = 0;\nconst TriangleStripDrawMode = 1;\nconst TriangleFanDrawMode = 2;\nconst BasicDepthPacking = 3200;\nconst RGBADepthPacking = 3201;\nconst RGBDepthPacking = 3202;\nconst RGDepthPacking = 3203;\nconst TangentSpaceNormalMap = 0;\nconst ObjectSpaceNormalMap = 1;\n\n// Color space string identifiers, matching CSS Color Module Level 4 and WebGPU names where available.\nconst NoColorSpace = '';\nconst SRGBColorSpace = 'srgb';\nconst LinearSRGBColorSpace = 'srgb-linear';\n\nconst LinearTransfer = 'linear';\nconst SRGBTransfer = 'srgb';\n\nconst ZeroStencilOp = 0;\nconst KeepStencilOp = 7680;\nconst ReplaceStencilOp = 7681;\nconst IncrementStencilOp = 7682;\nconst DecrementStencilOp = 7683;\nconst IncrementWrapStencilOp = 34055;\nconst DecrementWrapStencilOp = 34056;\nconst InvertStencilOp = 5386;\n\nconst NeverStencilFunc = 512;\nconst LessStencilFunc = 513;\nconst EqualStencilFunc = 514;\nconst LessEqualStencilFunc = 515;\nconst GreaterStencilFunc = 516;\nconst NotEqualStencilFunc = 517;\nconst GreaterEqualStencilFunc = 518;\nconst AlwaysStencilFunc = 519;\n\nconst NeverCompare = 512;\nconst LessCompare = 513;\nconst EqualCompare = 514;\nconst LessEqualCompare = 515;\nconst GreaterCompare = 516;\nconst NotEqualCompare = 517;\nconst GreaterEqualCompare = 518;\nconst AlwaysCompare = 519;\n\nconst StaticDrawUsage = 35044;\nconst DynamicDrawUsage = 35048;\nconst StreamDrawUsage = 35040;\nconst StaticReadUsage = 35045;\nconst DynamicReadUsage = 35049;\nconst StreamReadUsage = 35041;\nconst StaticCopyUsage = 35046;\nconst DynamicCopyUsage = 35050;\nconst StreamCopyUsage = 35042;\n\nconst GLSL1 = '100';\nconst GLSL3 = '300 es';\n\nconst WebGLCoordinateSystem = 2000;\nconst WebGPUCoordinateSystem = 2001;\n\n/**\n * https://github.com/mrdoob/eventdispatcher.js/\n */\n\nclass EventDispatcher {\n\n\taddEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) this._listeners = {};\n\n\t\tconst listeners = this._listeners;\n\n\t\tif ( listeners[ type ] === undefined ) {\n\n\t\t\tlisteners[ type ] = [];\n\n\t\t}\n\n\t\tif ( listeners[ type ].indexOf( listener ) === - 1 ) {\n\n\t\t\tlisteners[ type ].push( listener );\n\n\t\t}\n\n\t}\n\n\thasEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) return false;\n\n\t\tconst listeners = this._listeners;\n\n\t\treturn listeners[ type ] !== undefined && listeners[ type ].indexOf( listener ) !== - 1;\n\n\t}\n\n\tremoveEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) return;\n\n\t\tconst listeners = this._listeners;\n\t\tconst listenerArray = listeners[ type ];\n\n\t\tif ( listenerArray !== undefined ) {\n\n\t\t\tconst index = listenerArray.indexOf( listener );\n\n\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\tlistenerArray.splice( index, 1 );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tdispatchEvent( event ) {\n\n\t\tif ( this._listeners === undefined ) return;\n\n\t\tconst listeners = this._listeners;\n\t\tconst listenerArray = listeners[ event.type ];\n\n\t\tif ( listenerArray !== undefined ) {\n\n\t\t\tevent.target = this;\n\n\t\t\t// Make a copy, in case listeners are removed while iterating.\n\t\t\tconst array = listenerArray.slice( 0 );\n\n\t\t\tfor ( let i = 0, l = array.length; i < l; i ++ ) {\n\n\t\t\t\tarray[ i ].call( this, event );\n\n\t\t\t}\n\n\t\t\tevent.target = null;\n\n\t\t}\n\n\t}\n\n}\n\nconst _lut = [ '00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '0a', '0b', '0c', '0d', '0e', '0f', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '1a', '1b', '1c', '1d', '1e', '1f', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '2a', '2b', '2c', '2d', '2e', '2f', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '3a', '3b', '3c', '3d', '3e', '3f', '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '4a', '4b', '4c', '4d', '4e', '4f', '50', '51', '52', '53', '54', '55', '56', '57', '58', '59', '5a', '5b', '5c', '5d', '5e', '5f', '60', '61', '62', '63', '64', '65', '66', '67', '68', '69', '6a', '6b', '6c', '6d', '6e', '6f', '70', '71', '72', '73', '74', '75', '76', '77', '78', '79', '7a', '7b', '7c', '7d', '7e', '7f', '80', '81', '82', '83', '84', '85', '86', '87', '88', '89', '8a', '8b', '8c', '8d', '8e', '8f', '90', '91', '92', '93', '94', '95', '96', '97', '98', '99', '9a', '9b', '9c', '9d', '9e', '9f', 'a0', 'a1', 'a2', 'a3', 'a4', 'a5', 'a6', 'a7', 'a8', 'a9', 'aa', 'ab', 'ac', 'ad', 'ae', 'af', 'b0', 'b1', 'b2', 'b3', 'b4', 'b5', 'b6', 'b7', 'b8', 'b9', 'ba', 'bb', 'bc', 'bd', 'be', 'bf', 'c0', 'c1', 'c2', 'c3', 'c4', 'c5', 'c6', 'c7', 'c8', 'c9', 'ca', 'cb', 'cc', 'cd', 'ce', 'cf', 'd0', 'd1', 'd2', 'd3', 'd4', 'd5', 'd6', 'd7', 'd8', 'd9', 'da', 'db', 'dc', 'dd', 'de', 'df', 'e0', 'e1', 'e2', 'e3', 'e4', 'e5', 'e6', 'e7', 'e8', 'e9', 'ea', 'eb', 'ec', 'ed', 'ee', 'ef', 'f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9', 'fa', 'fb', 'fc', 'fd', 'fe', 'ff' ];\n\nlet _seed = 1234567;\n\n\nconst DEG2RAD = Math.PI / 180;\nconst RAD2DEG = 180 / Math.PI;\n\n// http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\nfunction generateUUID() {\n\n\tconst d0 = Math.random() * 0xffffffff | 0;\n\tconst d1 = Math.random() * 0xffffffff | 0;\n\tconst d2 = Math.random() * 0xffffffff | 0;\n\tconst d3 = Math.random() * 0xffffffff | 0;\n\tconst uuid = _lut[ d0 & 0xff ] + _lut[ d0 >> 8 & 0xff ] + _lut[ d0 >> 16 & 0xff ] + _lut[ d0 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d1 & 0xff ] + _lut[ d1 >> 8 & 0xff ] + '-' + _lut[ d1 >> 16 & 0x0f | 0x40 ] + _lut[ d1 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d2 & 0x3f | 0x80 ] + _lut[ d2 >> 8 & 0xff ] + '-' + _lut[ d2 >> 16 & 0xff ] + _lut[ d2 >> 24 & 0xff ] +\n\t\t\t_lut[ d3 & 0xff ] + _lut[ d3 >> 8 & 0xff ] + _lut[ d3 >> 16 & 0xff ] + _lut[ d3 >> 24 & 0xff ];\n\n\t// .toLowerCase() here flattens concatenated strings to save heap memory space.\n\treturn uuid.toLowerCase();\n\n}\n\nfunction clamp( value, min, max ) {\n\n\treturn Math.max( min, Math.min( max, value ) );\n\n}\n\n// compute euclidean modulo of m % n\n// https://en.wikipedia.org/wiki/Modulo_operation\nfunction euclideanModulo( n, m ) {\n\n\treturn ( ( n % m ) + m ) % m;\n\n}\n\n// Linear mapping from range <a1, a2> to range <b1, b2>\nfunction mapLinear( x, a1, a2, b1, b2 ) {\n\n\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\n\n}\n\n// https://www.gamedev.net/tutorials/programming/general-and-gameplay-programming/inverse-lerp-a-super-useful-yet-often-overlooked-function-r5230/\nfunction inverseLerp( x, y, value ) {\n\n\tif ( x !== y ) {\n\n\t\treturn ( value - x ) / ( y - x );\n\n\t} else {\n\n\t\treturn 0;\n\n\t}\n\n}\n\n// https://en.wikipedia.org/wiki/Linear_interpolation\nfunction lerp( x, y, t ) {\n\n\treturn ( 1 - t ) * x + t * y;\n\n}\n\n// http://www.rorydriscoll.com/2016/03/07/frame-rate-independent-damping-using-lerp/\nfunction damp( x, y, lambda, dt ) {\n\n\treturn lerp( x, y, 1 - Math.exp( - lambda * dt ) );\n\n}\n\n// https://www.desmos.com/calculator/vcsjnyz7x4\nfunction pingpong( x, length = 1 ) {\n\n\treturn length - Math.abs( euclideanModulo( x, length * 2 ) - length );\n\n}\n\n// http://en.wikipedia.org/wiki/Smoothstep\nfunction smoothstep( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * ( 3 - 2 * x );\n\n}\n\nfunction smootherstep( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\n\n}\n\n// Random integer from <low, high> interval\nfunction randInt( low, high ) {\n\n\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\n\n}\n\n// Random float from <low, high> interval\nfunction randFloat( low, high ) {\n\n\treturn low + Math.random() * ( high - low );\n\n}\n\n// Random float from <-range/2, range/2> interval\nfunction randFloatSpread( range ) {\n\n\treturn range * ( 0.5 - Math.random() );\n\n}\n\n// Deterministic pseudo-random float in the interval [ 0, 1 ]\nfunction seededRandom( s ) {\n\n\tif ( s !== undefined ) _seed = s;\n\n\t// Mulberry32 generator\n\n\tlet t = _seed += 0x6D2B79F5;\n\n\tt = Math.imul( t ^ t >>> 15, t | 1 );\n\n\tt ^= t + Math.imul( t ^ t >>> 7, t | 61 );\n\n\treturn ( ( t ^ t >>> 14 ) >>> 0 ) / 4294967296;\n\n}\n\nfunction degToRad( degrees ) {\n\n\treturn degrees * DEG2RAD;\n\n}\n\nfunction radToDeg( radians ) {\n\n\treturn radians * RAD2DEG;\n\n}\n\nfunction isPowerOfTwo( value ) {\n\n\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\n\n}\n\nfunction ceilPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.ceil( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction floorPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.floor( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction setQuaternionFromProperEuler( q, a, b, c, order ) {\n\n\t// Intrinsic Proper Euler Angles - see https://en.wikipedia.org/wiki/Euler_angles\n\n\t// rotations are applied to the axes in the order specified by 'order'\n\t// rotation by angle 'a' is applied first, then by angle 'b', then by angle 'c'\n\t// angles are in radians\n\n\tconst cos = Math.cos;\n\tconst sin = Math.sin;\n\n\tconst c2 = cos( b / 2 );\n\tconst s2 = sin( b / 2 );\n\n\tconst c13 = cos( ( a + c ) / 2 );\n\tconst s13 = sin( ( a + c ) / 2 );\n\n\tconst c1_3 = cos( ( a - c ) / 2 );\n\tconst s1_3 = sin( ( a - c ) / 2 );\n\n\tconst c3_1 = cos( ( c - a ) / 2 );\n\tconst s3_1 = sin( ( c - a ) / 2 );\n\n\tswitch ( order ) {\n\n\t\tcase 'XYX':\n\t\t\tq.set( c2 * s13, s2 * c1_3, s2 * s1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YZY':\n\t\t\tq.set( s2 * s1_3, c2 * s13, s2 * c1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZXZ':\n\t\t\tq.set( s2 * c1_3, s2 * s1_3, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'XZX':\n\t\t\tq.set( c2 * s13, s2 * s3_1, s2 * c3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YXY':\n\t\t\tq.set( s2 * c3_1, c2 * s13, s2 * s3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZYZ':\n\t\t\tq.set( s2 * s3_1, s2 * c3_1, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tconsole.warn( 'THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: ' + order );\n\n\t}\n\n}\n\nfunction denormalize( value, array ) {\n\n\tswitch ( array.constructor ) {\n\n\t\tcase Float32Array:\n\n\t\t\treturn value;\n\n\t\tcase Uint32Array:\n\n\t\t\treturn value / 4294967295.0;\n\n\t\tcase Uint16Array:\n\n\t\t\treturn value / 65535.0;\n\n\t\tcase Uint8Array:\n\n\t\t\treturn value / 255.0;\n\n\t\tcase Int32Array:\n\n\t\t\treturn Math.max( value / 2147483647.0, - 1.0 );\n\n\t\tcase Int16Array:\n\n\t\t\treturn Math.max( value / 32767.0, - 1.0 );\n\n\t\tcase Int8Array:\n\n\t\t\treturn Math.max( value / 127.0, - 1.0 );\n\n\t\tdefault:\n\n\t\t\tthrow new Error( 'Invalid component type.' );\n\n\t}\n\n}\n\nfunction normalize( value, array ) {\n\n\tswitch ( array.constructor ) {\n\n\t\tcase Float32Array:\n\n\t\t\treturn value;\n\n\t\tcase Uint32Array:\n\n\t\t\treturn Math.round( value * 4294967295.0 );\n\n\t\tcase Uint16Array:\n\n\t\t\treturn Math.round( value * 65535.0 );\n\n\t\tcase Uint8Array:\n\n\t\t\treturn Math.round( value * 255.0 );\n\n\t\tcase Int32Array:\n\n\t\t\treturn Math.round( value * 2147483647.0 );\n\n\t\tcase Int16Array:\n\n\t\t\treturn Math.round( value * 32767.0 );\n\n\t\tcase Int8Array:\n\n\t\t\treturn Math.round( value * 127.0 );\n\n\t\tdefault:\n\n\t\t\tthrow new Error( 'Invalid component type.' );\n\n\t}\n\n}\n\nconst MathUtils = {\n\tDEG2RAD: DEG2RAD,\n\tRAD2DEG: RAD2DEG,\n\tgenerateUUID: generateUUID,\n\tclamp: clamp,\n\teuclideanModulo: euclideanModulo,\n\tmapLinear: mapLinear,\n\tinverseLerp: inverseLerp,\n\tlerp: lerp,\n\tdamp: damp,\n\tpingpong: pingpong,\n\tsmoothstep: smoothstep,\n\tsmootherstep: smootherstep,\n\trandInt: randInt,\n\trandFloat: randFloat,\n\trandFloatSpread: randFloatSpread,\n\tseededRandom: seededRandom,\n\tdegToRad: degToRad,\n\tradToDeg: radToDeg,\n\tisPowerOfTwo: isPowerOfTwo,\n\tceilPowerOfTwo: ceilPowerOfTwo,\n\tfloorPowerOfTwo: floorPowerOfTwo,\n\tsetQuaternionFromProperEuler: setQuaternionFromProperEuler,\n\tnormalize: normalize,\n\tdenormalize: denormalize\n};\n\nclass Vector2 {\n\n\tconstructor( x = 0, y = 0 ) {\n\n\t\tVector2.prototype.isVector2 = true;\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\n\t}\n\n\tget width() {\n\n\t\treturn this.x;\n\n\t}\n\n\tset width( value ) {\n\n\t\tthis.x = value;\n\n\t}\n\n\tget height() {\n\n\t\treturn this.y;\n\n\t}\n\n\tset height( value ) {\n\n\t\tthis.y = value;\n\n\t}\n\n\tset( x, y ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v ) {\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v ) {\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tdivide( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tconst x = this.x, y = this.y;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ];\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ];\n\n\t\treturn this;\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = clamp( this.x, min.x, max.x );\n\t\tthis.y = clamp( this.y, min.y, max.y );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = clamp( this.x, minVal, maxVal );\n\t\tthis.y = clamp( this.y, minVal, maxVal );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( clamp( length, min, max ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = Math.trunc( this.x );\n\t\tthis.y = Math.trunc( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y;\n\n\t}\n\n\tcross( v ) {\n\n\t\treturn this.x * v.y - this.y * v.x;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tangle() {\n\n\t\t// computes the angle in radians with respect to the positive x-axis\n\n\t\tconst angle = Math.atan2( - this.y, - this.x ) + Math.PI;\n\n\t\treturn angle;\n\n\t}\n\n\tangleTo( v ) {\n\n\t\tconst denominator = Math.sqrt( this.lengthSq() * v.lengthSq() );\n\n\t\tif ( denominator === 0 ) return Math.PI / 2;\n\n\t\tconst theta = this.dot( v ) / denominator;\n\n\t\t// clamp, to handle numerical problems\n\n\t\treturn Math.acos( clamp( theta, - 1, 1 ) );\n\n\t}\n\n\tdistanceTo( v ) {\n\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t}\n\n\tdistanceToSquared( v ) {\n\n\t\tconst dx = this.x - v.x, dy = this.y - v.y;\n\t\treturn dx * dx + dy * dy;\n\n\t}\n\n\tmanhattanDistanceTo( v ) {\n\n\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\n\t\treturn this;\n\n\t}\n\n\trotateAround( center, angle ) {\n\n\t\tconst c = Math.cos( angle ), s = Math.sin( angle );\n\n\t\tconst x = this.x - center.x;\n\t\tconst y = this.y - center.y;\n\n\t\tthis.x = x * c - y * s + center.x;\n\t\tthis.y = x * s + y * c + center.y;\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\n\t}\n\n}\n\nclass Matrix3 {\n\n\tconstructor( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\n\n\t\tMatrix3.prototype.isMatrix3 = true;\n\n\t\tthis.elements = [\n\n\t\t\t1, 0, 0,\n\t\t\t0, 1, 0,\n\t\t\t0, 0, 1\n\n\t\t];\n\n\t\tif ( n11 !== undefined ) {\n\n\t\t\tthis.set( n11, n12, n13, n21, n22, n23, n31, n32, n33 );\n\n\t\t}\n\n\t}\n\n\tset( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 1 ] = n21; te[ 2 ] = n31;\n\t\tte[ 3 ] = n12; te[ 4 ] = n22; te[ 5 ] = n32;\n\t\tte[ 6 ] = n13; te[ 7 ] = n23; te[ 8 ] = n33;\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0,\n\t\t\t0, 1, 0,\n\t\t\t0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tcopy( m ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ];\n\t\tte[ 3 ] = me[ 3 ]; te[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ];\n\t\tte[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ]; te[ 8 ] = me[ 8 ];\n\n\t\treturn this;\n\n\t}\n\n\textractBasis( xAxis, yAxis, zAxis ) {\n\n\t\txAxis.setFromMatrix3Column( this, 0 );\n\t\tyAxis.setFromMatrix3Column( this, 1 );\n\t\tzAxis.setFromMatrix3Column( this, 2 );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrix4( m ) {\n\n\t\tconst me = m.elements;\n\n\t\tthis.set(\n\n\t\t\tme[ 0 ], me[ 4 ], me[ 8 ],\n\t\t\tme[ 1 ], me[ 5 ], me[ 9 ],\n\t\t\tme[ 2 ], me[ 6 ], me[ 10 ]\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( m ) {\n\n\t\treturn this.multiplyMatrices( this, m );\n\n\t}\n\n\tpremultiply( m ) {\n\n\t\treturn this.multiplyMatrices( m, this );\n\n\t}\n\n\tmultiplyMatrices( a, b ) {\n\n\t\tconst ae = a.elements;\n\t\tconst be = b.elements;\n\t\tconst te = this.elements;\n\n\t\tconst a11 = ae[ 0 ], a12 = ae[ 3 ], a13 = ae[ 6 ];\n\t\tconst a21 = ae[ 1 ], a22 = ae[ 4 ], a23 = ae[ 7 ];\n\t\tconst a31 = ae[ 2 ], a32 = ae[ 5 ], a33 = ae[ 8 ];\n\n\t\tconst b11 = be[ 0 ], b12 = be[ 3 ], b13 = be[ 6 ];\n\t\tconst b21 = be[ 1 ], b22 = be[ 4 ], b23 = be[ 7 ];\n\t\tconst b31 = be[ 2 ], b32 = be[ 5 ], b33 = be[ 8 ];\n\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31;\n\t\tte[ 3 ] = a11 * b12 + a12 * b22 + a13 * b32;\n\t\tte[ 6 ] = a11 * b13 + a12 * b23 + a13 * b33;\n\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31;\n\t\tte[ 4 ] = a21 * b12 + a22 * b22 + a23 * b32;\n\t\tte[ 7 ] = a21 * b13 + a22 * b23 + a23 * b33;\n\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31;\n\t\tte[ 5 ] = a31 * b12 + a32 * b22 + a33 * b32;\n\t\tte[ 8 ] = a31 * b13 + a32 * b23 + a33 * b33;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] *= s; te[ 3 ] *= s; te[ 6 ] *= s;\n\t\tte[ 1 ] *= s; te[ 4 ] *= s; te[ 7 ] *= s;\n\t\tte[ 2 ] *= s; te[ 5 ] *= s; te[ 8 ] *= s;\n\n\t\treturn this;\n\n\t}\n\n\tdeterminant() {\n\n\t\tconst te = this.elements;\n\n\t\tconst a = te[ 0 ], b = te[ 1 ], c = te[ 2 ],\n\t\t\td = te[ 3 ], e = te[ 4 ], f = te[ 5 ],\n\t\t\tg = te[ 6 ], h = te[ 7 ], i = te[ 8 ];\n\n\t\treturn a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\n\n\t}\n\n\tinvert() {\n\n\t\tconst te = this.elements,\n\n\t\t\tn11 = te[ 0 ], n21 = te[ 1 ], n31 = te[ 2 ],\n\t\t\tn12 = te[ 3 ], n22 = te[ 4 ], n32 = te[ 5 ],\n\t\t\tn13 = te[ 6 ], n23 = te[ 7 ], n33 = te[ 8 ],\n\n\t\t\tt11 = n33 * n22 - n32 * n23,\n\t\t\tt12 = n32 * n13 - n33 * n12,\n\t\t\tt13 = n23 * n12 - n22 * n13,\n\n\t\t\tdet = n11 * t11 + n21 * t12 + n31 * t13;\n\n\t\tif ( det === 0 ) return this.set( 0, 0, 0, 0, 0, 0, 0, 0, 0 );\n\n\t\tconst detInv = 1 / det;\n\n\t\tte[ 0 ] = t11 * detInv;\n\t\tte[ 1 ] = ( n31 * n23 - n33 * n21 ) * detInv;\n\t\tte[ 2 ] = ( n32 * n21 - n31 * n22 ) * detInv;\n\n\t\tte[ 3 ] = t12 * detInv;\n\t\tte[ 4 ] = ( n33 * n11 - n31 * n13 ) * detInv;\n\t\tte[ 5 ] = ( n31 * n12 - n32 * n11 ) * detInv;\n\n\t\tte[ 6 ] = t13 * detInv;\n\t\tte[ 7 ] = ( n21 * n13 - n23 * n11 ) * detInv;\n\t\tte[ 8 ] = ( n22 * n11 - n21 * n12 ) * detInv;\n\n\t\treturn this;\n\n\t}\n\n\ttranspose() {\n\n\t\tlet tmp;\n\t\tconst m = this.elements;\n\n\t\ttmp = m[ 1 ]; m[ 1 ] = m[ 3 ]; m[ 3 ] = tmp;\n\t\ttmp = m[ 2 ]; m[ 2 ] = m[ 6 ]; m[ 6 ] = tmp;\n\t\ttmp = m[ 5 ]; m[ 5 ] = m[ 7 ]; m[ 7 ] = tmp;\n\n\t\treturn this;\n\n\t}\n\n\tgetNormalMatrix( matrix4 ) {\n\n\t\treturn this.setFromMatrix4( matrix4 ).invert().transpose();\n\n\t}\n\n\ttransposeIntoArray( r ) {\n\n\t\tconst m = this.elements;\n\n\t\tr[ 0 ] = m[ 0 ];\n\t\tr[ 1 ] = m[ 3 ];\n\t\tr[ 2 ] = m[ 6 ];\n\t\tr[ 3 ] = m[ 1 ];\n\t\tr[ 4 ] = m[ 4 ];\n\t\tr[ 5 ] = m[ 7 ];\n\t\tr[ 6 ] = m[ 2 ];\n\t\tr[ 7 ] = m[ 5 ];\n\t\tr[ 8 ] = m[ 8 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetUvTransform( tx, ty, sx, sy, rotation, cx, cy ) {\n\n\t\tconst c = Math.cos( rotation );\n\t\tconst s = Math.sin( rotation );\n\n\t\tthis.set(\n\t\t\tsx * c, sx * s, - sx * ( c * cx + s * cy ) + cx + tx,\n\t\t\t- sy * s, sy * c, - sy * ( - s * cx + c * cy ) + cy + ty,\n\t\t\t0, 0, 1\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\t//\n\n\tscale( sx, sy ) {\n\n\t\tthis.premultiply( _m3.makeScale( sx, sy ) );\n\n\t\treturn this;\n\n\t}\n\n\trotate( theta ) {\n\n\t\tthis.premultiply( _m3.makeRotation( - theta ) );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( tx, ty ) {\n\n\t\tthis.premultiply( _m3.makeTranslation( tx, ty ) );\n\n\t\treturn this;\n\n\t}\n\n\t// for 2D Transforms\n\n\tmakeTranslation( x, y ) {\n\n\t\tif ( x.isVector2 ) {\n\n\t\t\tthis.set(\n\n\t\t\t\t1, 0, x.x,\n\t\t\t\t0, 1, x.y,\n\t\t\t\t0, 0, 1\n\n\t\t\t);\n\n\t\t} else {\n\n\t\t\tthis.set(\n\n\t\t\t\t1, 0, x,\n\t\t\t\t0, 1, y,\n\t\t\t\t0, 0, 1\n\n\t\t\t);\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotation( theta ) {\n\n\t\t// counterclockwise\n\n\t\tconst c = Math.cos( theta );\n\t\tconst s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\tc, - s, 0,\n\t\t\ts, c, 0,\n\t\t\t0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeScale( x, y ) {\n\n\t\tthis.set(\n\n\t\t\tx, 0, 0,\n\t\t\t0, y, 0,\n\t\t\t0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\t//\n\n\tequals( matrix ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = matrix.elements;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst te = this.elements;\n\n\t\tarray[ offset ] = te[ 0 ];\n\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\tarray[ offset + 2 ] = te[ 2 ];\n\n\t\tarray[ offset + 3 ] = te[ 3 ];\n\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\tarray[ offset + 5 ] = te[ 5 ];\n\n\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\tarray[ offset + 7 ] = te[ 7 ];\n\t\tarray[ offset + 8 ] = te[ 8 ];\n\n\t\treturn array;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().fromArray( this.elements );\n\n\t}\n\n}\n\nconst _m3 = /*@__PURE__*/ new Matrix3();\n\nfunction arrayNeedsUint32( array ) {\n\n\t// assumes larger values usually on last\n\n\tfor ( let i = array.length - 1; i >= 0; -- i ) {\n\n\t\tif ( array[ i ] >= 65535 ) return true; // account for PRIMITIVE_RESTART_FIXED_INDEX, #24565\n\n\t}\n\n\treturn false;\n\n}\n\nconst TYPED_ARRAYS = {\n\tInt8Array: Int8Array,\n\tUint8Array: Uint8Array,\n\tUint8ClampedArray: Uint8ClampedArray,\n\tInt16Array: Int16Array,\n\tUint16Array: Uint16Array,\n\tInt32Array: Int32Array,\n\tUint32Array: Uint32Array,\n\tFloat32Array: Float32Array,\n\tFloat64Array: Float64Array\n};\n\nfunction getTypedArray( type, buffer ) {\n\n\treturn new TYPED_ARRAYS[ type ]( buffer );\n\n}\n\nfunction createElementNS( name ) {\n\n\treturn document.createElementNS( 'http://www.w3.org/1999/xhtml', name );\n\n}\n\nfunction createCanvasElement() {\n\n\tconst canvas = createElementNS( 'canvas' );\n\tcanvas.style.display = 'block';\n\treturn canvas;\n\n}\n\nconst _cache = {};\n\nfunction warnOnce( message ) {\n\n\tif ( message in _cache ) return;\n\n\t_cache[ message ] = true;\n\n\tconsole.warn( message );\n\n}\n\nfunction probeAsync( gl, sync, interval ) {\n\n\treturn new Promise( function ( resolve, reject ) {\n\n\t\tfunction probe() {\n\n\t\t\tswitch ( gl.clientWaitSync( sync, gl.SYNC_FLUSH_COMMANDS_BIT, 0 ) ) {\n\n\t\t\t\tcase gl.WAIT_FAILED:\n\t\t\t\t\treject();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase gl.TIMEOUT_EXPIRED:\n\t\t\t\t\tsetTimeout( probe, interval );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tresolve();\n\n\t\t\t}\n\n\t\t}\n\n\t\tsetTimeout( probe, interval );\n\n\t} );\n\n}\n\nfunction toNormalizedProjectionMatrix( projectionMatrix ) {\n\n\tconst m = projectionMatrix.elements;\n\n\t// Convert [-1, 1] to [0, 1] projection matrix\n\tm[ 2 ] = 0.5 * m[ 2 ] + 0.5 * m[ 3 ];\n\tm[ 6 ] = 0.5 * m[ 6 ] + 0.5 * m[ 7 ];\n\tm[ 10 ] = 0.5 * m[ 10 ] + 0.5 * m[ 11 ];\n\tm[ 14 ] = 0.5 * m[ 14 ] + 0.5 * m[ 15 ];\n\n}\n\nfunction toReversedProjectionMatrix( projectionMatrix ) {\n\n\tconst m = projectionMatrix.elements;\n\tconst isPerspectiveMatrix = m[ 11 ] === - 1;\n\n\t// Reverse [0, 1] projection matrix\n\tif ( isPerspectiveMatrix ) {\n\n\t\tm[ 10 ] = - m[ 10 ] - 1;\n\t\tm[ 14 ] = - m[ 14 ];\n\n\t} else {\n\n\t\tm[ 10 ] = - m[ 10 ];\n\t\tm[ 14 ] = - m[ 14 ] + 1;\n\n\t}\n\n}\n\nconst LINEAR_REC709_TO_XYZ = /*@__PURE__*/ new Matrix3().set(\n\t0.4123908, 0.3575843, 0.1804808,\n\t0.2126390, 0.7151687, 0.0721923,\n\t0.0193308, 0.1191948, 0.9505322\n);\n\nconst XYZ_TO_LINEAR_REC709 = /*@__PURE__*/ new Matrix3().set(\n\t3.2409699, - 1.5373832, - 0.4986108,\n\t- 0.9692436, 1.8759675, 0.0415551,\n\t0.0556301, - 0.2039770, 1.0569715\n);\n\nfunction createColorManagement() {\n\n\tconst ColorManagement = {\n\n\t\tenabled: true,\n\n\t\tworkingColorSpace: LinearSRGBColorSpace,\n\n\t\t/**\n\t\t * Implementations of supported color spaces.\n\t\t *\n\t\t * Required:\n\t\t *\t- primaries: chromaticity coordinates [ rx ry gx gy bx by ]\n\t\t *\t- whitePoint: reference white [ x y ]\n\t\t *\t- transfer: transfer function (pre-defined)\n\t\t *\t- toXYZ: Matrix3 RGB to XYZ transform\n\t\t *\t- fromXYZ: Matrix3 XYZ to RGB transform\n\t\t *\t- luminanceCoefficients: RGB luminance coefficients\n\t\t *\n\t\t * Optional:\n\t\t *  - outputColorSpaceConfig: { drawingBufferColorSpace: ColorSpace }\n\t\t *  - workingColorSpaceConfig: { unpackColorSpace: ColorSpace }\n\t\t *\n\t\t * Reference:\n\t\t * - https://www.russellcottrell.com/photo/matrixCalculator.htm\n\t\t */\n\t\tspaces: {},\n\n\t\tconvert: function ( color, sourceColorSpace, targetColorSpace ) {\n\n\t\t\tif ( this.enabled === false || sourceColorSpace === targetColorSpace || ! sourceColorSpace || ! targetColorSpace ) {\n\n\t\t\t\treturn color;\n\n\t\t\t}\n\n\t\t\tif ( this.spaces[ sourceColorSpace ].transfer === SRGBTransfer ) {\n\n\t\t\t\tcolor.r = SRGBToLinear( color.r );\n\t\t\t\tcolor.g = SRGBToLinear( color.g );\n\t\t\t\tcolor.b = SRGBToLinear( color.b );\n\n\t\t\t}\n\n\t\t\tif ( this.spaces[ sourceColorSpace ].primaries !== this.spaces[ targetColorSpace ].primaries ) {\n\n\t\t\t\tcolor.applyMatrix3( this.spaces[ sourceColorSpace ].toXYZ );\n\t\t\t\tcolor.applyMatrix3( this.spaces[ targetColorSpace ].fromXYZ );\n\n\t\t\t}\n\n\t\t\tif ( this.spaces[ targetColorSpace ].transfer === SRGBTransfer ) {\n\n\t\t\t\tcolor.r = LinearToSRGB( color.r );\n\t\t\t\tcolor.g = LinearToSRGB( color.g );\n\t\t\t\tcolor.b = LinearToSRGB( color.b );\n\n\t\t\t}\n\n\t\t\treturn color;\n\n\t\t},\n\n\t\tfromWorkingColorSpace: function ( color, targetColorSpace ) {\n\n\t\t\treturn this.convert( color, this.workingColorSpace, targetColorSpace );\n\n\t\t},\n\n\t\ttoWorkingColorSpace: function ( color, sourceColorSpace ) {\n\n\t\t\treturn this.convert( color, sourceColorSpace, this.workingColorSpace );\n\n\t\t},\n\n\t\tgetPrimaries: function ( colorSpace ) {\n\n\t\t\treturn this.spaces[ colorSpace ].primaries;\n\n\t\t},\n\n\t\tgetTransfer: function ( colorSpace ) {\n\n\t\t\tif ( colorSpace === NoColorSpace ) return LinearTransfer;\n\n\t\t\treturn this.spaces[ colorSpace ].transfer;\n\n\t\t},\n\n\t\tgetLuminanceCoefficients: function ( target, colorSpace = this.workingColorSpace ) {\n\n\t\t\treturn target.fromArray( this.spaces[ colorSpace ].luminanceCoefficients );\n\n\t\t},\n\n\t\tdefine: function ( colorSpaces ) {\n\n\t\t\tObject.assign( this.spaces, colorSpaces );\n\n\t\t},\n\n\t\t// Internal APIs\n\n\t\t_getMatrix: function ( targetMatrix, sourceColorSpace, targetColorSpace ) {\n\n\t\t\treturn targetMatrix\n\t\t\t\t.copy( this.spaces[ sourceColorSpace ].toXYZ )\n\t\t\t\t.multiply( this.spaces[ targetColorSpace ].fromXYZ );\n\n\t\t},\n\n\t\t_getDrawingBufferColorSpace: function ( colorSpace ) {\n\n\t\t\treturn this.spaces[ colorSpace ].outputColorSpaceConfig.drawingBufferColorSpace;\n\n\t\t},\n\n\t\t_getUnpackColorSpace: function ( colorSpace = this.workingColorSpace ) {\n\n\t\t\treturn this.spaces[ colorSpace ].workingColorSpaceConfig.unpackColorSpace;\n\n\t\t}\n\n\t};\n\n\t/******************************************************************************\n\t * sRGB definitions\n\t */\n\n\tconst REC709_PRIMARIES = [ 0.640, 0.330, 0.300, 0.600, 0.150, 0.060 ];\n\tconst REC709_LUMINANCE_COEFFICIENTS = [ 0.2126, 0.7152, 0.0722 ];\n\tconst D65 = [ 0.3127, 0.3290 ];\n\n\tColorManagement.define( {\n\n\t\t[ LinearSRGBColorSpace ]: {\n\t\t\tprimaries: REC709_PRIMARIES,\n\t\t\twhitePoint: D65,\n\t\t\ttransfer: LinearTransfer,\n\t\t\ttoXYZ: LINEAR_REC709_TO_XYZ,\n\t\t\tfromXYZ: XYZ_TO_LINEAR_REC709,\n\t\t\tluminanceCoefficients: REC709_LUMINANCE_COEFFICIENTS,\n\t\t\tworkingColorSpaceConfig: { unpackColorSpace: SRGBColorSpace },\n\t\t\toutputColorSpaceConfig: { drawingBufferColorSpace: SRGBColorSpace }\n\t\t},\n\n\t\t[ SRGBColorSpace ]: {\n\t\t\tprimaries: REC709_PRIMARIES,\n\t\t\twhitePoint: D65,\n\t\t\ttransfer: SRGBTransfer,\n\t\t\ttoXYZ: LINEAR_REC709_TO_XYZ,\n\t\t\tfromXYZ: XYZ_TO_LINEAR_REC709,\n\t\t\tluminanceCoefficients: REC709_LUMINANCE_COEFFICIENTS,\n\t\t\toutputColorSpaceConfig: { drawingBufferColorSpace: SRGBColorSpace }\n\t\t},\n\n\t} );\n\n\treturn ColorManagement;\n\n}\n\nconst ColorManagement = /*@__PURE__*/ createColorManagement();\n\nfunction SRGBToLinear( c ) {\n\n\treturn ( c < 0.04045 ) ? c * 0.0773993808 : Math.pow( c * 0.9478672986 + 0.0521327014, 2.4 );\n\n}\n\nfunction LinearToSRGB( c ) {\n\n\treturn ( c < 0.0031308 ) ? c * 12.92 : 1.055 * ( Math.pow( c, 0.41666 ) ) - 0.055;\n\n}\n\nlet _canvas;\n\nclass ImageUtils {\n\n\tstatic getDataURL( image ) {\n\n\t\tif ( /^data:/i.test( image.src ) ) {\n\n\t\t\treturn image.src;\n\n\t\t}\n\n\t\tif ( typeof HTMLCanvasElement === 'undefined' ) {\n\n\t\t\treturn image.src;\n\n\t\t}\n\n\t\tlet canvas;\n\n\t\tif ( image instanceof HTMLCanvasElement ) {\n\n\t\t\tcanvas = image;\n\n\t\t} else {\n\n\t\t\tif ( _canvas === undefined ) _canvas = createElementNS( 'canvas' );\n\n\t\t\t_canvas.width = image.width;\n\t\t\t_canvas.height = image.height;\n\n\t\t\tconst context = _canvas.getContext( '2d' );\n\n\t\t\tif ( image instanceof ImageData ) {\n\n\t\t\t\tcontext.putImageData( image, 0, 0 );\n\n\t\t\t} else {\n\n\t\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height );\n\n\t\t\t}\n\n\t\t\tcanvas = _canvas;\n\n\t\t}\n\n\t\tif ( canvas.width > 2048 || canvas.height > 2048 ) {\n\n\t\t\tconsole.warn( 'THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons', image );\n\n\t\t\treturn canvas.toDataURL( 'image/jpeg', 0.6 );\n\n\t\t} else {\n\n\t\t\treturn canvas.toDataURL( 'image/png' );\n\n\t\t}\n\n\t}\n\n\tstatic sRGBToLinear( image ) {\n\n\t\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\t\tconst canvas = createElementNS( 'canvas' );\n\n\t\t\tcanvas.width = image.width;\n\t\t\tcanvas.height = image.height;\n\n\t\t\tconst context = canvas.getContext( '2d' );\n\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height );\n\n\t\t\tconst imageData = context.getImageData( 0, 0, image.width, image.height );\n\t\t\tconst data = imageData.data;\n\n\t\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\t\tdata[ i ] = SRGBToLinear( data[ i ] / 255 ) * 255;\n\n\t\t\t}\n\n\t\t\tcontext.putImageData( imageData, 0, 0 );\n\n\t\t\treturn canvas;\n\n\t\t} else if ( image.data ) {\n\n\t\t\tconst data = image.data.slice( 0 );\n\n\t\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\t\tif ( data instanceof Uint8Array || data instanceof Uint8ClampedArray ) {\n\n\t\t\t\t\tdata[ i ] = Math.floor( SRGBToLinear( data[ i ] / 255 ) * 255 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// assuming float\n\n\t\t\t\t\tdata[ i ] = SRGBToLinear( data[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdata: data,\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied.' );\n\t\t\treturn image;\n\n\t\t}\n\n\t}\n\n}\n\nlet _sourceId = 0;\n\nclass Source {\n\n\tconstructor( data = null ) {\n\n\t\tthis.isSource = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _sourceId ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.data = data;\n\t\tthis.dataReady = true;\n\n\t\tthis.version = 0;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( ! isRootObject && meta.images[ this.uuid ] !== undefined ) {\n\n\t\t\treturn meta.images[ this.uuid ];\n\n\t\t}\n\n\t\tconst output = {\n\t\t\tuuid: this.uuid,\n\t\t\turl: ''\n\t\t};\n\n\t\tconst data = this.data;\n\n\t\tif ( data !== null ) {\n\n\t\t\tlet url;\n\n\t\t\tif ( Array.isArray( data ) ) {\n\n\t\t\t\t// cube texture\n\n\t\t\t\turl = [];\n\n\t\t\t\tfor ( let i = 0, l = data.length; i < l; i ++ ) {\n\n\t\t\t\t\tif ( data[ i ].isDataTexture ) {\n\n\t\t\t\t\t\turl.push( serializeImage( data[ i ].image ) );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\turl.push( serializeImage( data[ i ] ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// texture\n\n\t\t\t\turl = serializeImage( data );\n\n\t\t\t}\n\n\t\t\toutput.url = url;\n\n\t\t}\n\n\t\tif ( ! isRootObject ) {\n\n\t\t\tmeta.images[ this.uuid ] = output;\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n}\n\nfunction serializeImage( image ) {\n\n\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\t// default images\n\n\t\treturn ImageUtils.getDataURL( image );\n\n\t} else {\n\n\t\tif ( image.data ) {\n\n\t\t\t// images of DataTexture\n\n\t\t\treturn {\n\t\t\t\tdata: Array.from( image.data ),\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height,\n\t\t\t\ttype: image.data.constructor.name\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.Texture: Unable to serialize Texture.' );\n\t\t\treturn {};\n\n\t\t}\n\n\t}\n\n}\n\nlet _textureId = 0;\n\nclass Texture extends EventDispatcher {\n\n\tconstructor( image = Texture.DEFAULT_IMAGE, mapping = Texture.DEFAULT_MAPPING, wrapS = ClampToEdgeWrapping, wrapT = ClampToEdgeWrapping, magFilter = LinearFilter, minFilter = LinearMipmapLinearFilter, format = RGBAFormat, type = UnsignedByteType, anisotropy = Texture.DEFAULT_ANISOTROPY, colorSpace = NoColorSpace ) {\n\n\t\tsuper();\n\n\t\tthis.isTexture = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _textureId ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\n\t\tthis.source = new Source( image );\n\t\tthis.mipmaps = [];\n\n\t\tthis.mapping = mapping;\n\t\tthis.channel = 0;\n\n\t\tthis.wrapS = wrapS;\n\t\tthis.wrapT = wrapT;\n\n\t\tthis.magFilter = magFilter;\n\t\tthis.minFilter = minFilter;\n\n\t\tthis.anisotropy = anisotropy;\n\n\t\tthis.format = format;\n\t\tthis.internalFormat = null;\n\t\tthis.type = type;\n\n\t\tthis.offset = new Vector2( 0, 0 );\n\t\tthis.repeat = new Vector2( 1, 1 );\n\t\tthis.center = new Vector2( 0, 0 );\n\t\tthis.rotation = 0;\n\n\t\tthis.matrixAutoUpdate = true;\n\t\tthis.matrix = new Matrix3();\n\n\t\tthis.generateMipmaps = true;\n\t\tthis.premultiplyAlpha = false;\n\t\tthis.flipY = true;\n\t\tthis.unpackAlignment = 4;\t// valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\n\n\t\tthis.colorSpace = colorSpace;\n\n\t\tthis.userData = {};\n\n\t\tthis.version = 0;\n\t\tthis.onUpdate = null;\n\n\t\tthis.isRenderTargetTexture = false; // indicates whether a texture belongs to a render target or not\n\t\tthis.pmremVersion = 0; // indicates whether this texture should be processed by PMREMGenerator or not (only relevant for render target textures)\n\n\t}\n\n\tget image() {\n\n\t\treturn this.source.data;\n\n\t}\n\n\tset image( value = null ) {\n\n\t\tthis.source.data = value;\n\n\t}\n\n\tupdateMatrix() {\n\n\t\tthis.matrix.setUvTransform( this.offset.x, this.offset.y, this.repeat.x, this.repeat.y, this.rotation, this.center.x, this.center.y );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.source = source.source;\n\t\tthis.mipmaps = source.mipmaps.slice( 0 );\n\n\t\tthis.mapping = source.mapping;\n\t\tthis.channel = source.channel;\n\n\t\tthis.wrapS = source.wrapS;\n\t\tthis.wrapT = source.wrapT;\n\n\t\tthis.magFilter = source.magFilter;\n\t\tthis.minFilter = source.minFilter;\n\n\t\tthis.anisotropy = source.anisotropy;\n\n\t\tthis.format = source.format;\n\t\tthis.internalFormat = source.internalFormat;\n\t\tthis.type = source.type;\n\n\t\tthis.offset.copy( source.offset );\n\t\tthis.repeat.copy( source.repeat );\n\t\tthis.center.copy( source.center );\n\t\tthis.rotation = source.rotation;\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\t\tthis.matrix.copy( source.matrix );\n\n\t\tthis.generateMipmaps = source.generateMipmaps;\n\t\tthis.premultiplyAlpha = source.premultiplyAlpha;\n\t\tthis.flipY = source.flipY;\n\t\tthis.unpackAlignment = source.unpackAlignment;\n\t\tthis.colorSpace = source.colorSpace;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\tthis.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( ! isRootObject && meta.textures[ this.uuid ] !== undefined ) {\n\n\t\t\treturn meta.textures[ this.uuid ];\n\n\t\t}\n\n\t\tconst output = {\n\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.6,\n\t\t\t\ttype: 'Texture',\n\t\t\t\tgenerator: 'Texture.toJSON'\n\t\t\t},\n\n\t\t\tuuid: this.uuid,\n\t\t\tname: this.name,\n\n\t\t\timage: this.source.toJSON( meta ).uuid,\n\n\t\t\tmapping: this.mapping,\n\t\t\tchannel: this.channel,\n\n\t\t\trepeat: [ this.repeat.x, this.repeat.y ],\n\t\t\toffset: [ this.offset.x, this.offset.y ],\n\t\t\tcenter: [ this.center.x, this.center.y ],\n\t\t\trotation: this.rotation,\n\n\t\t\twrap: [ this.wrapS, this.wrapT ],\n\n\t\t\tformat: this.format,\n\t\t\tinternalFormat: this.internalFormat,\n\t\t\ttype: this.type,\n\t\t\tcolorSpace: this.colorSpace,\n\n\t\t\tminFilter: this.minFilter,\n\t\t\tmagFilter: this.magFilter,\n\t\t\tanisotropy: this.anisotropy,\n\n\t\t\tflipY: this.flipY,\n\n\t\t\tgenerateMipmaps: this.generateMipmaps,\n\t\t\tpremultiplyAlpha: this.premultiplyAlpha,\n\t\t\tunpackAlignment: this.unpackAlignment\n\n\t\t};\n\n\t\tif ( Object.keys( this.userData ).length > 0 ) output.userData = this.userData;\n\n\t\tif ( ! isRootObject ) {\n\n\t\t\tmeta.textures[ this.uuid ] = output;\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\ttransformUv( uv ) {\n\n\t\tif ( this.mapping !== UVMapping ) return uv;\n\n\t\tuv.applyMatrix3( this.matrix );\n\n\t\tif ( uv.x < 0 || uv.x > 1 ) {\n\n\t\t\tswitch ( this.wrapS ) {\n\n\t\t\t\tcase RepeatWrapping:\n\n\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ClampToEdgeWrapping:\n\n\t\t\t\t\tuv.x = uv.x < 0 ? 0 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MirroredRepeatWrapping:\n\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.x ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\tuv.x = Math.ceil( uv.x ) - uv.x;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( uv.y < 0 || uv.y > 1 ) {\n\n\t\t\tswitch ( this.wrapT ) {\n\n\t\t\t\tcase RepeatWrapping:\n\n\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ClampToEdgeWrapping:\n\n\t\t\t\t\tuv.y = uv.y < 0 ? 0 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MirroredRepeatWrapping:\n\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.y ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\tuv.y = Math.ceil( uv.y ) - uv.y;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.flipY ) {\n\n\t\t\tuv.y = 1 - uv.y;\n\n\t\t}\n\n\t\treturn uv;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) {\n\n\t\t\tthis.version ++;\n\t\t\tthis.source.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\tset needsPMREMUpdate( value ) {\n\n\t\tif ( value === true ) {\n\n\t\t\tthis.pmremVersion ++;\n\n\t\t}\n\n\t}\n\n}\n\nTexture.DEFAULT_IMAGE = null;\nTexture.DEFAULT_MAPPING = UVMapping;\nTexture.DEFAULT_ANISOTROPY = 1;\n\nclass Vector4 {\n\n\tconstructor( x = 0, y = 0, z = 0, w = 1 ) {\n\n\t\tVector4.prototype.isVector4 = true;\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t\tthis.w = w;\n\n\t}\n\n\tget width() {\n\n\t\treturn this.z;\n\n\t}\n\n\tset width( value ) {\n\n\t\tthis.z = value;\n\n\t}\n\n\tget height() {\n\n\t\treturn this.w;\n\n\t}\n\n\tset height( value ) {\n\n\t\tthis.w = value;\n\n\t}\n\n\tset( x, y, z, w ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t\tthis.w = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\t\tthis.z = scalar;\n\t\tthis.w = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( z ) {\n\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetW( w ) {\n\n\t\tthis.w = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tcase 2: this.z = value; break;\n\t\t\tcase 3: this.w = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tcase 2: return this.z;\n\t\t\tcase 3: return this.w;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y, this.z, this.w );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t\tthis.z = v.z;\n\t\tthis.w = ( v.w !== undefined ) ? v.w : 1;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v ) {\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t\tthis.z += v.z;\n\t\tthis.w += v.w;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\t\tthis.z += s;\n\t\tthis.w += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\t\tthis.z = a.z + b.z;\n\t\tthis.w = a.w + b.w;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\t\tthis.z += v.z * s;\n\t\tthis.w += v.w * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v ) {\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\t\tthis.z -= v.z;\n\t\tthis.w -= v.w;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\t\tthis.z -= s;\n\t\tthis.w -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\t\tthis.z = a.z - b.z;\n\t\tthis.w = a.w - b.w;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\t\tthis.z *= v.z;\n\t\tthis.w *= v.w;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\tthis.z *= scalar;\n\t\tthis.w *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z, w = this.w;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\n\t\tthis.w = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\n\n\t\treturn this;\n\n\t}\n\n\tdivide( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\t\tthis.z /= v.z;\n\t\tthis.w /= v.w;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tsetAxisAngleFromQuaternion( q ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\n\n\t\t// q is assumed to be normalized\n\n\t\tthis.w = 2 * Math.acos( q.w );\n\n\t\tconst s = Math.sqrt( 1 - q.w * q.w );\n\n\t\tif ( s < 0.0001 ) {\n\n\t\t\tthis.x = 1;\n\t\t\tthis.y = 0;\n\t\t\tthis.z = 0;\n\n\t\t} else {\n\n\t\t\tthis.x = q.x / s;\n\t\t\tthis.y = q.y / s;\n\t\t\tthis.z = q.z / s;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetAxisAngleFromRotationMatrix( m ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tlet angle, x, y, z; // variables for result\n\t\tconst epsilon = 0.01,\t\t// margin to allow for rounding errors\n\t\t\tepsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\n\n\t\t\tte = m.elements,\n\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\tif ( ( Math.abs( m12 - m21 ) < epsilon ) &&\n\t\t     ( Math.abs( m13 - m31 ) < epsilon ) &&\n\t\t     ( Math.abs( m23 - m32 ) < epsilon ) ) {\n\n\t\t\t// singularity found\n\t\t\t// first check for identity matrix which must have +1 for all terms\n\t\t\t// in leading diagonal and zero in other terms\n\n\t\t\tif ( ( Math.abs( m12 + m21 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m13 + m31 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m23 + m32 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m11 + m22 + m33 - 3 ) < epsilon2 ) ) {\n\n\t\t\t\t// this singularity is identity matrix so angle = 0\n\n\t\t\t\tthis.set( 1, 0, 0, 0 );\n\n\t\t\t\treturn this; // zero angle, arbitrary axis\n\n\t\t\t}\n\n\t\t\t// otherwise this singularity is angle = 180\n\n\t\t\tangle = Math.PI;\n\n\t\t\tconst xx = ( m11 + 1 ) / 2;\n\t\t\tconst yy = ( m22 + 1 ) / 2;\n\t\t\tconst zz = ( m33 + 1 ) / 2;\n\t\t\tconst xy = ( m12 + m21 ) / 4;\n\t\t\tconst xz = ( m13 + m31 ) / 4;\n\t\t\tconst yz = ( m23 + m32 ) / 4;\n\n\t\t\tif ( ( xx > yy ) && ( xx > zz ) ) {\n\n\t\t\t\t// m11 is the largest diagonal term\n\n\t\t\t\tif ( xx < epsilon ) {\n\n\t\t\t\t\tx = 0;\n\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tx = Math.sqrt( xx );\n\t\t\t\t\ty = xy / x;\n\t\t\t\t\tz = xz / x;\n\n\t\t\t\t}\n\n\t\t\t} else if ( yy > zz ) {\n\n\t\t\t\t// m22 is the largest diagonal term\n\n\t\t\t\tif ( yy < epsilon ) {\n\n\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\ty = 0;\n\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t} else {\n\n\t\t\t\t\ty = Math.sqrt( yy );\n\t\t\t\t\tx = xy / y;\n\t\t\t\t\tz = yz / y;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// m33 is the largest diagonal term so base result on this\n\n\t\t\t\tif ( zz < epsilon ) {\n\n\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\tz = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tz = Math.sqrt( zz );\n\t\t\t\t\tx = xz / z;\n\t\t\t\t\ty = yz / z;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.set( x, y, z, angle );\n\n\t\t\treturn this; // return 180 deg rotation\n\n\t\t}\n\n\t\t// as we have reached here there are no singularities so we can handle normally\n\n\t\tlet s = Math.sqrt( ( m32 - m23 ) * ( m32 - m23 ) +\n\t\t\t( m13 - m31 ) * ( m13 - m31 ) +\n\t\t\t( m21 - m12 ) * ( m21 - m12 ) ); // used to normalize\n\n\t\tif ( Math.abs( s ) < 0.001 ) s = 1;\n\n\t\t// prevent divide by zero, should not happen if matrix is orthogonal and should be\n\t\t// caught by singularity test above, but I've left it in just in case\n\n\t\tthis.x = ( m32 - m23 ) / s;\n\t\tthis.y = ( m13 - m31 ) / s;\n\t\tthis.z = ( m21 - m12 ) / s;\n\t\tthis.w = Math.acos( ( m11 + m22 + m33 - 1 ) / 2 );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixPosition( m ) {\n\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 12 ];\n\t\tthis.y = e[ 13 ];\n\t\tthis.z = e[ 14 ];\n\t\tthis.w = e[ 15 ];\n\n\t\treturn this;\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\t\tthis.z = Math.min( this.z, v.z );\n\t\tthis.w = Math.min( this.w, v.w );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\t\tthis.z = Math.max( this.z, v.z );\n\t\tthis.w = Math.max( this.w, v.w );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = clamp( this.x, min.x, max.x );\n\t\tthis.y = clamp( this.y, min.y, max.y );\n\t\tthis.z = clamp( this.z, min.z, max.z );\n\t\tthis.w = clamp( this.w, min.w, max.w );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = clamp( this.x, minVal, maxVal );\n\t\tthis.y = clamp( this.y, minVal, maxVal );\n\t\tthis.z = clamp( this.z, minVal, maxVal );\n\t\tthis.w = clamp( this.w, minVal, maxVal );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( clamp( length, min, max ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\t\tthis.z = Math.floor( this.z );\n\t\tthis.w = Math.floor( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\t\tthis.z = Math.ceil( this.z );\n\t\tthis.w = Math.ceil( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\t\tthis.z = Math.round( this.z );\n\t\tthis.w = Math.round( this.w );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = Math.trunc( this.x );\n\t\tthis.y = Math.trunc( this.y );\n\t\tthis.z = Math.trunc( this.z );\n\t\tthis.w = Math.trunc( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\t\tthis.z = - this.z;\n\t\tthis.w = - this.w;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z ) + Math.abs( this.w );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\tthis.z += ( v.z - this.z ) * alpha;\n\t\tthis.w += ( v.w - this.w ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\t\tthis.z = v1.z + ( v2.z - v1.z ) * alpha;\n\t\tthis.w = v1.w + ( v2.w - v1.w ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) && ( v.w === this.w ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\t\tthis.z = array[ offset + 2 ];\n\t\tthis.w = array[ offset + 3 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\t\tarray[ offset + 2 ] = this.z;\n\t\tarray[ offset + 3 ] = this.w;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\t\tthis.z = attribute.getZ( index );\n\t\tthis.w = attribute.getW( index );\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\t\tthis.z = Math.random();\n\t\tthis.w = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\t\tyield this.z;\n\t\tyield this.w;\n\n\t}\n\n}\n\n/*\n In options, we can specify:\n * Texture parameters for an auto-generated target texture\n * depthBuffer/stencilBuffer: Booleans to indicate if we should generate these buffers\n*/\nclass RenderTarget extends EventDispatcher {\n\n\tconstructor( width = 1, height = 1, options = {} ) {\n\n\t\tsuper();\n\n\t\tthis.isRenderTarget = true;\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.depth = 1;\n\n\t\tthis.scissor = new Vector4( 0, 0, width, height );\n\t\tthis.scissorTest = false;\n\n\t\tthis.viewport = new Vector4( 0, 0, width, height );\n\n\t\tconst image = { width: width, height: height, depth: 1 };\n\n\t\toptions = Object.assign( {\n\t\t\tgenerateMipmaps: false,\n\t\t\tinternalFormat: null,\n\t\t\tminFilter: LinearFilter,\n\t\t\tdepthBuffer: true,\n\t\t\tstencilBuffer: false,\n\t\t\tresolveDepthBuffer: true,\n\t\t\tresolveStencilBuffer: true,\n\t\t\tdepthTexture: null,\n\t\t\tsamples: 0,\n\t\t\tcount: 1\n\t\t}, options );\n\n\t\tconst texture = new Texture( image, options.mapping, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy, options.colorSpace );\n\n\t\ttexture.flipY = false;\n\t\ttexture.generateMipmaps = options.generateMipmaps;\n\t\ttexture.internalFormat = options.internalFormat;\n\n\t\tthis.textures = [];\n\n\t\tconst count = options.count;\n\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\tthis.textures[ i ] = texture.clone();\n\t\t\tthis.textures[ i ].isRenderTargetTexture = true;\n\n\t\t}\n\n\t\tthis.depthBuffer = options.depthBuffer;\n\t\tthis.stencilBuffer = options.stencilBuffer;\n\n\t\tthis.resolveDepthBuffer = options.resolveDepthBuffer;\n\t\tthis.resolveStencilBuffer = options.resolveStencilBuffer;\n\n\t\tthis.depthTexture = options.depthTexture;\n\n\t\tthis.samples = options.samples;\n\n\t}\n\n\tget texture() {\n\n\t\treturn this.textures[ 0 ];\n\n\t}\n\n\tset texture( value ) {\n\n\t\tthis.textures[ 0 ] = value;\n\n\t}\n\n\tsetSize( width, height, depth = 1 ) {\n\n\t\tif ( this.width !== width || this.height !== height || this.depth !== depth ) {\n\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\t\t\tthis.depth = depth;\n\n\t\t\tfor ( let i = 0, il = this.textures.length; i < il; i ++ ) {\n\n\t\t\t\tthis.textures[ i ].image.width = width;\n\t\t\t\tthis.textures[ i ].image.height = height;\n\t\t\t\tthis.textures[ i ].image.depth = depth;\n\n\t\t\t}\n\n\t\t\tthis.dispose();\n\n\t\t}\n\n\t\tthis.viewport.set( 0, 0, width, height );\n\t\tthis.scissor.set( 0, 0, width, height );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.width = source.width;\n\t\tthis.height = source.height;\n\t\tthis.depth = source.depth;\n\n\t\tthis.scissor.copy( source.scissor );\n\t\tthis.scissorTest = source.scissorTest;\n\n\t\tthis.viewport.copy( source.viewport );\n\n\t\tthis.textures.length = 0;\n\n\t\tfor ( let i = 0, il = source.textures.length; i < il; i ++ ) {\n\n\t\t\tthis.textures[ i ] = source.textures[ i ].clone();\n\t\t\tthis.textures[ i ].isRenderTargetTexture = true;\n\n\t\t}\n\n\t\t// ensure image object is not shared, see #20328\n\n\t\tconst image = Object.assign( {}, source.texture.image );\n\t\tthis.texture.source = new Source( image );\n\n\t\tthis.depthBuffer = source.depthBuffer;\n\t\tthis.stencilBuffer = source.stencilBuffer;\n\n\t\tthis.resolveDepthBuffer = source.resolveDepthBuffer;\n\t\tthis.resolveStencilBuffer = source.resolveStencilBuffer;\n\n\t\tif ( source.depthTexture !== null ) this.depthTexture = source.depthTexture.clone();\n\n\t\tthis.samples = source.samples;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n}\n\nclass WebGLRenderTarget extends RenderTarget {\n\n\tconstructor( width = 1, height = 1, options = {} ) {\n\n\t\tsuper( width, height, options );\n\n\t\tthis.isWebGLRenderTarget = true;\n\n\t}\n\n}\n\nclass DataArrayTexture extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, depth = 1 ) {\n\n\t\tsuper( null );\n\n\t\tthis.isDataArrayTexture = true;\n\n\t\tthis.image = { data, width, height, depth };\n\n\t\tthis.magFilter = NearestFilter;\n\t\tthis.minFilter = NearestFilter;\n\n\t\tthis.wrapR = ClampToEdgeWrapping;\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t\tthis.layerUpdates = new Set();\n\n\t}\n\n\taddLayerUpdate( layerIndex ) {\n\n\t\tthis.layerUpdates.add( layerIndex );\n\n\t}\n\n\tclearLayerUpdates() {\n\n\t\tthis.layerUpdates.clear();\n\n\t}\n\n}\n\nclass WebGLArrayRenderTarget extends WebGLRenderTarget {\n\n\tconstructor( width = 1, height = 1, depth = 1, options = {} ) {\n\n\t\tsuper( width, height, options );\n\n\t\tthis.isWebGLArrayRenderTarget = true;\n\n\t\tthis.depth = depth;\n\n\t\tthis.texture = new DataArrayTexture( null, width, height, depth );\n\n\t\tthis.texture.isRenderTargetTexture = true;\n\n\t}\n\n}\n\nclass Data3DTexture extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, depth = 1 ) {\n\n\t\t// We're going to add .setXXX() methods for setting properties later.\n\t\t// Users can still set in DataTexture3D directly.\n\t\t//\n\t\t//\tconst texture = new THREE.DataTexture3D( data, width, height, depth );\n\t\t// \ttexture.anisotropy = 16;\n\t\t//\n\t\t// See #14839\n\n\t\tsuper( null );\n\n\t\tthis.isData3DTexture = true;\n\n\t\tthis.image = { data, width, height, depth };\n\n\t\tthis.magFilter = NearestFilter;\n\t\tthis.minFilter = NearestFilter;\n\n\t\tthis.wrapR = ClampToEdgeWrapping;\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t}\n\n}\n\nclass WebGL3DRenderTarget extends WebGLRenderTarget {\n\n\tconstructor( width = 1, height = 1, depth = 1, options = {} ) {\n\n\t\tsuper( width, height, options );\n\n\t\tthis.isWebGL3DRenderTarget = true;\n\n\t\tthis.depth = depth;\n\n\t\tthis.texture = new Data3DTexture( null, width, height, depth );\n\n\t\tthis.texture.isRenderTargetTexture = true;\n\n\t}\n\n}\n\nclass Quaternion {\n\n\tconstructor( x = 0, y = 0, z = 0, w = 1 ) {\n\n\t\tthis.isQuaternion = true;\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._w = w;\n\n\t}\n\n\tstatic slerpFlat( dst, dstOffset, src0, srcOffset0, src1, srcOffset1, t ) {\n\n\t\t// fuzz-free, array-based Quaternion SLERP operation\n\n\t\tlet x0 = src0[ srcOffset0 + 0 ],\n\t\t\ty0 = src0[ srcOffset0 + 1 ],\n\t\t\tz0 = src0[ srcOffset0 + 2 ],\n\t\t\tw0 = src0[ srcOffset0 + 3 ];\n\n\t\tconst x1 = src1[ srcOffset1 + 0 ],\n\t\t\ty1 = src1[ srcOffset1 + 1 ],\n\t\t\tz1 = src1[ srcOffset1 + 2 ],\n\t\t\tw1 = src1[ srcOffset1 + 3 ];\n\n\t\tif ( t === 0 ) {\n\n\t\t\tdst[ dstOffset + 0 ] = x0;\n\t\t\tdst[ dstOffset + 1 ] = y0;\n\t\t\tdst[ dstOffset + 2 ] = z0;\n\t\t\tdst[ dstOffset + 3 ] = w0;\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( t === 1 ) {\n\n\t\t\tdst[ dstOffset + 0 ] = x1;\n\t\t\tdst[ dstOffset + 1 ] = y1;\n\t\t\tdst[ dstOffset + 2 ] = z1;\n\t\t\tdst[ dstOffset + 3 ] = w1;\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( w0 !== w1 || x0 !== x1 || y0 !== y1 || z0 !== z1 ) {\n\n\t\t\tlet s = 1 - t;\n\t\t\tconst cos = x0 * x1 + y0 * y1 + z0 * z1 + w0 * w1,\n\t\t\t\tdir = ( cos >= 0 ? 1 : - 1 ),\n\t\t\t\tsqrSin = 1 - cos * cos;\n\n\t\t\t// Skip the Slerp for tiny steps to avoid numeric problems:\n\t\t\tif ( sqrSin > Number.EPSILON ) {\n\n\t\t\t\tconst sin = Math.sqrt( sqrSin ),\n\t\t\t\t\tlen = Math.atan2( sin, cos * dir );\n\n\t\t\t\ts = Math.sin( s * len ) / sin;\n\t\t\t\tt = Math.sin( t * len ) / sin;\n\n\t\t\t}\n\n\t\t\tconst tDir = t * dir;\n\n\t\t\tx0 = x0 * s + x1 * tDir;\n\t\t\ty0 = y0 * s + y1 * tDir;\n\t\t\tz0 = z0 * s + z1 * tDir;\n\t\t\tw0 = w0 * s + w1 * tDir;\n\n\t\t\t// Normalize in case we just did a lerp:\n\t\t\tif ( s === 1 - t ) {\n\n\t\t\t\tconst f = 1 / Math.sqrt( x0 * x0 + y0 * y0 + z0 * z0 + w0 * w0 );\n\n\t\t\t\tx0 *= f;\n\t\t\t\ty0 *= f;\n\t\t\t\tz0 *= f;\n\t\t\t\tw0 *= f;\n\n\t\t\t}\n\n\t\t}\n\n\t\tdst[ dstOffset ] = x0;\n\t\tdst[ dstOffset + 1 ] = y0;\n\t\tdst[ dstOffset + 2 ] = z0;\n\t\tdst[ dstOffset + 3 ] = w0;\n\n\t}\n\n\tstatic multiplyQuaternionsFlat( dst, dstOffset, src0, srcOffset0, src1, srcOffset1 ) {\n\n\t\tconst x0 = src0[ srcOffset0 ];\n\t\tconst y0 = src0[ srcOffset0 + 1 ];\n\t\tconst z0 = src0[ srcOffset0 + 2 ];\n\t\tconst w0 = src0[ srcOffset0 + 3 ];\n\n\t\tconst x1 = src1[ srcOffset1 ];\n\t\tconst y1 = src1[ srcOffset1 + 1 ];\n\t\tconst z1 = src1[ srcOffset1 + 2 ];\n\t\tconst w1 = src1[ srcOffset1 + 3 ];\n\n\t\tdst[ dstOffset ] = x0 * w1 + w0 * x1 + y0 * z1 - z0 * y1;\n\t\tdst[ dstOffset + 1 ] = y0 * w1 + w0 * y1 + z0 * x1 - x0 * z1;\n\t\tdst[ dstOffset + 2 ] = z0 * w1 + w0 * z1 + x0 * y1 - y0 * x1;\n\t\tdst[ dstOffset + 3 ] = w0 * w1 - x0 * x1 - y0 * y1 - z0 * z1;\n\n\t\treturn dst;\n\n\t}\n\n\tget x() {\n\n\t\treturn this._x;\n\n\t}\n\n\tset x( value ) {\n\n\t\tthis._x = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget y() {\n\n\t\treturn this._y;\n\n\t}\n\n\tset y( value ) {\n\n\t\tthis._y = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget z() {\n\n\t\treturn this._z;\n\n\t}\n\n\tset z( value ) {\n\n\t\tthis._z = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget w() {\n\n\t\treturn this._w;\n\n\t}\n\n\tset w( value ) {\n\n\t\tthis._w = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tset( x, y, z, w ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._w = w;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this._x, this._y, this._z, this._w );\n\n\t}\n\n\tcopy( quaternion ) {\n\n\t\tthis._x = quaternion.x;\n\t\tthis._y = quaternion.y;\n\t\tthis._z = quaternion.z;\n\t\tthis._w = quaternion.w;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromEuler( euler, update = true ) {\n\n\t\tconst x = euler._x, y = euler._y, z = euler._z, order = euler._order;\n\n\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\n\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\n\t\t//\tcontent/SpinCalc.m\n\n\t\tconst cos = Math.cos;\n\t\tconst sin = Math.sin;\n\n\t\tconst c1 = cos( x / 2 );\n\t\tconst c2 = cos( y / 2 );\n\t\tconst c3 = cos( z / 2 );\n\n\t\tconst s1 = sin( x / 2 );\n\t\tconst s2 = sin( y / 2 );\n\t\tconst s3 = sin( z / 2 );\n\n\t\tswitch ( order ) {\n\n\t\t\tcase 'XYZ':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'YXZ':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZXY':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZYX':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'YZX':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'XZY':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.warn( 'THREE.Quaternion: .setFromEuler() encountered an unknown order: ' + order );\n\n\t\t}\n\n\t\tif ( update === true ) this._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromAxisAngle( axis, angle ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\n\n\t\t// assumes axis is normalized\n\n\t\tconst halfAngle = angle / 2, s = Math.sin( halfAngle );\n\n\t\tthis._x = axis.x * s;\n\t\tthis._y = axis.y * s;\n\t\tthis._z = axis.z * s;\n\t\tthis._w = Math.cos( halfAngle );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromRotationMatrix( m ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tconst te = m.elements,\n\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\n\n\t\t\ttrace = m11 + m22 + m33;\n\n\t\tif ( trace > 0 ) {\n\n\t\t\tconst s = 0.5 / Math.sqrt( trace + 1.0 );\n\n\t\t\tthis._w = 0.25 / s;\n\t\t\tthis._x = ( m32 - m23 ) * s;\n\t\t\tthis._y = ( m13 - m31 ) * s;\n\t\t\tthis._z = ( m21 - m12 ) * s;\n\n\t\t} else if ( m11 > m22 && m11 > m33 ) {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\n\n\t\t\tthis._w = ( m32 - m23 ) / s;\n\t\t\tthis._x = 0.25 * s;\n\t\t\tthis._y = ( m12 + m21 ) / s;\n\t\t\tthis._z = ( m13 + m31 ) / s;\n\n\t\t} else if ( m22 > m33 ) {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\n\n\t\t\tthis._w = ( m13 - m31 ) / s;\n\t\t\tthis._x = ( m12 + m21 ) / s;\n\t\t\tthis._y = 0.25 * s;\n\t\t\tthis._z = ( m23 + m32 ) / s;\n\n\t\t} else {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\n\n\t\t\tthis._w = ( m21 - m12 ) / s;\n\t\t\tthis._x = ( m13 + m31 ) / s;\n\t\t\tthis._y = ( m23 + m32 ) / s;\n\t\t\tthis._z = 0.25 * s;\n\n\t\t}\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromUnitVectors( vFrom, vTo ) {\n\n\t\t// assumes direction vectors vFrom and vTo are normalized\n\n\t\tlet r = vFrom.dot( vTo ) + 1;\n\n\t\tif ( r < Number.EPSILON ) {\n\n\t\t\t// vFrom and vTo point in opposite directions\n\n\t\t\tr = 0;\n\n\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\n\n\t\t\t\tthis._x = - vFrom.y;\n\t\t\t\tthis._y = vFrom.x;\n\t\t\t\tthis._z = 0;\n\t\t\t\tthis._w = r;\n\n\t\t\t} else {\n\n\t\t\t\tthis._x = 0;\n\t\t\t\tthis._y = - vFrom.z;\n\t\t\t\tthis._z = vFrom.y;\n\t\t\t\tthis._w = r;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// crossVectors( vFrom, vTo ); // inlined to avoid cyclic dependency on Vector3\n\n\t\t\tthis._x = vFrom.y * vTo.z - vFrom.z * vTo.y;\n\t\t\tthis._y = vFrom.z * vTo.x - vFrom.x * vTo.z;\n\t\t\tthis._z = vFrom.x * vTo.y - vFrom.y * vTo.x;\n\t\t\tthis._w = r;\n\n\t\t}\n\n\t\treturn this.normalize();\n\n\t}\n\n\tangleTo( q ) {\n\n\t\treturn 2 * Math.acos( Math.abs( clamp( this.dot( q ), - 1, 1 ) ) );\n\n\t}\n\n\trotateTowards( q, step ) {\n\n\t\tconst angle = this.angleTo( q );\n\n\t\tif ( angle === 0 ) return this;\n\n\t\tconst t = Math.min( 1, step / angle );\n\n\t\tthis.slerp( q, t );\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\treturn this.set( 0, 0, 0, 1 );\n\n\t}\n\n\tinvert() {\n\n\t\t// quaternion is assumed to have unit length\n\n\t\treturn this.conjugate();\n\n\t}\n\n\tconjugate() {\n\n\t\tthis._x *= - 1;\n\t\tthis._y *= - 1;\n\t\tthis._z *= - 1;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\n\n\t}\n\n\tnormalize() {\n\n\t\tlet l = this.length();\n\n\t\tif ( l === 0 ) {\n\n\t\t\tthis._x = 0;\n\t\t\tthis._y = 0;\n\t\t\tthis._z = 0;\n\t\t\tthis._w = 1;\n\n\t\t} else {\n\n\t\t\tl = 1 / l;\n\n\t\t\tthis._x = this._x * l;\n\t\t\tthis._y = this._y * l;\n\t\t\tthis._z = this._z * l;\n\t\t\tthis._w = this._w * l;\n\n\t\t}\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( q ) {\n\n\t\treturn this.multiplyQuaternions( this, q );\n\n\t}\n\n\tpremultiply( q ) {\n\n\t\treturn this.multiplyQuaternions( q, this );\n\n\t}\n\n\tmultiplyQuaternions( a, b ) {\n\n\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\n\n\t\tconst qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\n\t\tconst qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\n\n\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\n\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\n\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\n\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tslerp( qb, t ) {\n\n\t\tif ( t === 0 ) return this;\n\t\tif ( t === 1 ) return this.copy( qb );\n\n\t\tconst x = this._x, y = this._y, z = this._z, w = this._w;\n\n\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\n\n\t\tlet cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\n\n\t\tif ( cosHalfTheta < 0 ) {\n\n\t\t\tthis._w = - qb._w;\n\t\t\tthis._x = - qb._x;\n\t\t\tthis._y = - qb._y;\n\t\t\tthis._z = - qb._z;\n\n\t\t\tcosHalfTheta = - cosHalfTheta;\n\n\t\t} else {\n\n\t\t\tthis.copy( qb );\n\n\t\t}\n\n\t\tif ( cosHalfTheta >= 1.0 ) {\n\n\t\t\tthis._w = w;\n\t\t\tthis._x = x;\n\t\t\tthis._y = y;\n\t\t\tthis._z = z;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst sqrSinHalfTheta = 1.0 - cosHalfTheta * cosHalfTheta;\n\n\t\tif ( sqrSinHalfTheta <= Number.EPSILON ) {\n\n\t\t\tconst s = 1 - t;\n\t\t\tthis._w = s * w + t * this._w;\n\t\t\tthis._x = s * x + t * this._x;\n\t\t\tthis._y = s * y + t * this._y;\n\t\t\tthis._z = s * z + t * this._z;\n\n\t\t\tthis.normalize(); // normalize calls _onChangeCallback()\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst sinHalfTheta = Math.sqrt( sqrSinHalfTheta );\n\t\tconst halfTheta = Math.atan2( sinHalfTheta, cosHalfTheta );\n\t\tconst ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\n\t\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\n\n\t\tthis._w = ( w * ratioA + this._w * ratioB );\n\t\tthis._x = ( x * ratioA + this._x * ratioB );\n\t\tthis._y = ( y * ratioA + this._y * ratioB );\n\t\tthis._z = ( z * ratioA + this._z * ratioB );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tslerpQuaternions( qa, qb, t ) {\n\n\t\treturn this.copy( qa ).slerp( qb, t );\n\n\t}\n\n\trandom() {\n\n\t\t// sets this quaternion to a uniform random unit quaternnion\n\n\t\t// Ken Shoemake\n\t\t// Uniform random rotations\n\t\t// D. Kirk, editor, Graphics Gems III, pages 124-132. Academic Press, New York, 1992.\n\n\t\tconst theta1 = 2 * Math.PI * Math.random();\n\t\tconst theta2 = 2 * Math.PI * Math.random();\n\n\t\tconst x0 = Math.random();\n\t\tconst r1 = Math.sqrt( 1 - x0 );\n\t\tconst r2 = Math.sqrt( x0 );\n\n\t\treturn this.set(\n\t\t\tr1 * Math.sin( theta1 ),\n\t\t\tr1 * Math.cos( theta1 ),\n\t\t\tr2 * Math.sin( theta2 ),\n\t\t\tr2 * Math.cos( theta2 ),\n\t\t);\n\n\t}\n\n\tequals( quaternion ) {\n\n\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis._x = array[ offset ];\n\t\tthis._y = array[ offset + 1 ];\n\t\tthis._z = array[ offset + 2 ];\n\t\tthis._w = array[ offset + 3 ];\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this._x;\n\t\tarray[ offset + 1 ] = this._y;\n\t\tarray[ offset + 2 ] = this._z;\n\t\tarray[ offset + 3 ] = this._w;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis._x = attribute.getX( index );\n\t\tthis._y = attribute.getY( index );\n\t\tthis._z = attribute.getZ( index );\n\t\tthis._w = attribute.getW( index );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\treturn this.toArray();\n\n\t}\n\n\t_onChange( callback ) {\n\n\t\tthis._onChangeCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\t_onChangeCallback() {}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this._x;\n\t\tyield this._y;\n\t\tyield this._z;\n\t\tyield this._w;\n\n\t}\n\n}\n\nclass Vector3 {\n\n\tconstructor( x = 0, y = 0, z = 0 ) {\n\n\t\tVector3.prototype.isVector3 = true;\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\n\t}\n\n\tset( x, y, z ) {\n\n\t\tif ( z === undefined ) z = this.z; // sprite.scale.set(x,y)\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\t\tthis.z = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( z ) {\n\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tcase 2: this.z = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tcase 2: return this.z;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y, this.z );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t\tthis.z = v.z;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v ) {\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t\tthis.z += v.z;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\t\tthis.z += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\t\tthis.z = a.z + b.z;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\t\tthis.z += v.z * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v ) {\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\t\tthis.z -= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\t\tthis.z -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\t\tthis.z = a.z - b.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\t\tthis.z *= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\tthis.z *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyVectors( a, b ) {\n\n\t\tthis.x = a.x * b.x;\n\t\tthis.y = a.y * b.y;\n\t\tthis.z = a.z * b.z;\n\n\t\treturn this;\n\n\t}\n\n\tapplyEuler( euler ) {\n\n\t\treturn this.applyQuaternion( _quaternion$4.setFromEuler( euler ) );\n\n\t}\n\n\tapplyAxisAngle( axis, angle ) {\n\n\t\treturn this.applyQuaternion( _quaternion$4.setFromAxisAngle( axis, angle ) );\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ] * z;\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ] * z;\n\t\tthis.z = e[ 2 ] * x + e[ 5 ] * y + e[ 8 ] * z;\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\treturn this.applyMatrix3( m ).normalize();\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tconst w = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] );\n\n\t\tthis.x = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] ) * w;\n\t\tthis.y = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] ) * w;\n\t\tthis.z = ( e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] ) * w;\n\n\t\treturn this;\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\t// quaternion q is assumed to have unit length\n\n\t\tconst vx = this.x, vy = this.y, vz = this.z;\n\t\tconst qx = q.x, qy = q.y, qz = q.z, qw = q.w;\n\n\t\t// t = 2 * cross( q.xyz, v );\n\t\tconst tx = 2 * ( qy * vz - qz * vy );\n\t\tconst ty = 2 * ( qz * vx - qx * vz );\n\t\tconst tz = 2 * ( qx * vy - qy * vx );\n\n\t\t// v + q.w * t + cross( q.xyz, t );\n\t\tthis.x = vx + qw * tx + qy * tz - qz * ty;\n\t\tthis.y = vy + qw * ty + qz * tx - qx * tz;\n\t\tthis.z = vz + qw * tz + qx * ty - qy * tx;\n\n\t\treturn this;\n\n\t}\n\n\tproject( camera ) {\n\n\t\treturn this.applyMatrix4( camera.matrixWorldInverse ).applyMatrix4( camera.projectionMatrix );\n\n\t}\n\n\tunproject( camera ) {\n\n\t\treturn this.applyMatrix4( camera.projectionMatrixInverse ).applyMatrix4( camera.matrixWorld );\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\t// input: THREE.Matrix4 affine matrix\n\t\t// vector interpreted as a direction\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z;\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z;\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\n\n\t\treturn this.normalize();\n\n\t}\n\n\tdivide( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\t\tthis.z /= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\t\tthis.z = Math.min( this.z, v.z );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\t\tthis.z = Math.max( this.z, v.z );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = clamp( this.x, min.x, max.x );\n\t\tthis.y = clamp( this.y, min.y, max.y );\n\t\tthis.z = clamp( this.z, min.z, max.z );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = clamp( this.x, minVal, maxVal );\n\t\tthis.y = clamp( this.y, minVal, maxVal );\n\t\tthis.z = clamp( this.z, minVal, maxVal );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( clamp( length, min, max ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\t\tthis.z = Math.floor( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\t\tthis.z = Math.ceil( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\t\tthis.z = Math.round( this.z );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = Math.trunc( this.x );\n\t\tthis.y = Math.trunc( this.y );\n\t\tthis.z = Math.trunc( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\t\tthis.z = - this.z;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z;\n\n\t}\n\n\t// TODO lengthSquared?\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\tthis.z += ( v.z - this.z ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\t\tthis.z = v1.z + ( v2.z - v1.z ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tcross( v ) {\n\n\t\treturn this.crossVectors( this, v );\n\n\t}\n\n\tcrossVectors( a, b ) {\n\n\t\tconst ax = a.x, ay = a.y, az = a.z;\n\t\tconst bx = b.x, by = b.y, bz = b.z;\n\n\t\tthis.x = ay * bz - az * by;\n\t\tthis.y = az * bx - ax * bz;\n\t\tthis.z = ax * by - ay * bx;\n\n\t\treturn this;\n\n\t}\n\n\tprojectOnVector( v ) {\n\n\t\tconst denominator = v.lengthSq();\n\n\t\tif ( denominator === 0 ) return this.set( 0, 0, 0 );\n\n\t\tconst scalar = v.dot( this ) / denominator;\n\n\t\treturn this.copy( v ).multiplyScalar( scalar );\n\n\t}\n\n\tprojectOnPlane( planeNormal ) {\n\n\t\t_vector$c.copy( this ).projectOnVector( planeNormal );\n\n\t\treturn this.sub( _vector$c );\n\n\t}\n\n\treflect( normal ) {\n\n\t\t// reflect incident vector off plane orthogonal to normal\n\t\t// normal is assumed to have unit length\n\n\t\treturn this.sub( _vector$c.copy( normal ).multiplyScalar( 2 * this.dot( normal ) ) );\n\n\t}\n\n\tangleTo( v ) {\n\n\t\tconst denominator = Math.sqrt( this.lengthSq() * v.lengthSq() );\n\n\t\tif ( denominator === 0 ) return Math.PI / 2;\n\n\t\tconst theta = this.dot( v ) / denominator;\n\n\t\t// clamp, to handle numerical problems\n\n\t\treturn Math.acos( clamp( theta, - 1, 1 ) );\n\n\t}\n\n\tdistanceTo( v ) {\n\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t}\n\n\tdistanceToSquared( v ) {\n\n\t\tconst dx = this.x - v.x, dy = this.y - v.y, dz = this.z - v.z;\n\n\t\treturn dx * dx + dy * dy + dz * dz;\n\n\t}\n\n\tmanhattanDistanceTo( v ) {\n\n\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y ) + Math.abs( this.z - v.z );\n\n\t}\n\n\tsetFromSpherical( s ) {\n\n\t\treturn this.setFromSphericalCoords( s.radius, s.phi, s.theta );\n\n\t}\n\n\tsetFromSphericalCoords( radius, phi, theta ) {\n\n\t\tconst sinPhiRadius = Math.sin( phi ) * radius;\n\n\t\tthis.x = sinPhiRadius * Math.sin( theta );\n\t\tthis.y = Math.cos( phi ) * radius;\n\t\tthis.z = sinPhiRadius * Math.cos( theta );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCylindrical( c ) {\n\n\t\treturn this.setFromCylindricalCoords( c.radius, c.theta, c.y );\n\n\t}\n\n\tsetFromCylindricalCoords( radius, theta, y ) {\n\n\t\tthis.x = radius * Math.sin( theta );\n\t\tthis.y = y;\n\t\tthis.z = radius * Math.cos( theta );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixPosition( m ) {\n\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 12 ];\n\t\tthis.y = e[ 13 ];\n\t\tthis.z = e[ 14 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixScale( m ) {\n\n\t\tconst sx = this.setFromMatrixColumn( m, 0 ).length();\n\t\tconst sy = this.setFromMatrixColumn( m, 1 ).length();\n\t\tconst sz = this.setFromMatrixColumn( m, 2 ).length();\n\n\t\tthis.x = sx;\n\t\tthis.y = sy;\n\t\tthis.z = sz;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixColumn( m, index ) {\n\n\t\treturn this.fromArray( m.elements, index * 4 );\n\n\t}\n\n\tsetFromMatrix3Column( m, index ) {\n\n\t\treturn this.fromArray( m.elements, index * 3 );\n\n\t}\n\n\tsetFromEuler( e ) {\n\n\t\tthis.x = e._x;\n\t\tthis.y = e._y;\n\t\tthis.z = e._z;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromColor( c ) {\n\n\t\tthis.x = c.r;\n\t\tthis.y = c.g;\n\t\tthis.z = c.b;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\t\tthis.z = array[ offset + 2 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\t\tarray[ offset + 2 ] = this.z;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\t\tthis.z = attribute.getZ( index );\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\t\tthis.z = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\trandomDirection() {\n\n\t\t// https://mathworld.wolfram.com/SpherePointPicking.html\n\n\t\tconst theta = Math.random() * Math.PI * 2;\n\t\tconst u = Math.random() * 2 - 1;\n\t\tconst c = Math.sqrt( 1 - u * u );\n\n\t\tthis.x = c * Math.cos( theta );\n\t\tthis.y = u;\n\t\tthis.z = c * Math.sin( theta );\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\t\tyield this.z;\n\n\t}\n\n}\n\nconst _vector$c = /*@__PURE__*/ new Vector3();\nconst _quaternion$4 = /*@__PURE__*/ new Quaternion();\n\nclass Box3 {\n\n\tconstructor( min = new Vector3( + Infinity, + Infinity, + Infinity ), max = new Vector3( - Infinity, - Infinity, - Infinity ) ) {\n\n\t\tthis.isBox3 = true;\n\n\t\tthis.min = min;\n\t\tthis.max = max;\n\n\t}\n\n\tset( min, max ) {\n\n\t\tthis.min.copy( min );\n\t\tthis.max.copy( max );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromArray( array ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( let i = 0, il = array.length; i < il; i += 3 ) {\n\n\t\t\tthis.expandByPoint( _vector$b.fromArray( array, i ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromBufferAttribute( attribute ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( let i = 0, il = attribute.count; i < il; i ++ ) {\n\n\t\t\tthis.expandByPoint( _vector$b.fromBufferAttribute( attribute, i ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tthis.expandByPoint( points[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCenterAndSize( center, size ) {\n\n\t\tconst halfSize = _vector$b.copy( size ).multiplyScalar( 0.5 );\n\n\t\tthis.min.copy( center ).sub( halfSize );\n\t\tthis.max.copy( center ).add( halfSize );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromObject( object, precise = false ) {\n\n\t\tthis.makeEmpty();\n\n\t\treturn this.expandByObject( object, precise );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( box ) {\n\n\t\tthis.min.copy( box.min );\n\t\tthis.max.copy( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.min.x = this.min.y = this.min.z = + Infinity;\n\t\tthis.max.x = this.max.y = this.max.z = - Infinity;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y ) || ( this.max.z < this.min.z );\n\n\t}\n\n\tgetCenter( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\n\n\t}\n\n\tgetSize( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.subVectors( this.max, this.min );\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\tthis.min.min( point );\n\t\tthis.max.max( point );\n\n\t\treturn this;\n\n\t}\n\n\texpandByVector( vector ) {\n\n\t\tthis.min.sub( vector );\n\t\tthis.max.add( vector );\n\n\t\treturn this;\n\n\t}\n\n\texpandByScalar( scalar ) {\n\n\t\tthis.min.addScalar( - scalar );\n\t\tthis.max.addScalar( scalar );\n\n\t\treturn this;\n\n\t}\n\n\texpandByObject( object, precise = false ) {\n\n\t\t// Computes the world-axis-aligned bounding box of an object (including its children),\n\t\t// accounting for both the object's, and children's, world transforms\n\n\t\tobject.updateWorldMatrix( false, false );\n\n\t\tconst geometry = object.geometry;\n\n\t\tif ( geometry !== undefined ) {\n\n\t\t\tconst positionAttribute = geometry.getAttribute( 'position' );\n\n\t\t\t// precise AABB computation based on vertex data requires at least a position attribute.\n\t\t\t// instancing isn't supported so far and uses the normal (conservative) code path.\n\n\t\t\tif ( precise === true && positionAttribute !== undefined && object.isInstancedMesh !== true ) {\n\n\t\t\t\tfor ( let i = 0, l = positionAttribute.count; i < l; i ++ ) {\n\n\t\t\t\t\tif ( object.isMesh === true ) {\n\n\t\t\t\t\t\tobject.getVertexPosition( i, _vector$b );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t_vector$b.fromBufferAttribute( positionAttribute, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_vector$b.applyMatrix4( object.matrixWorld );\n\t\t\t\t\tthis.expandByPoint( _vector$b );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( object.boundingBox !== undefined ) {\n\n\t\t\t\t\t// object-level bounding box\n\n\t\t\t\t\tif ( object.boundingBox === null ) {\n\n\t\t\t\t\t\tobject.computeBoundingBox();\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_box$4.copy( object.boundingBox );\n\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// geometry-level bounding box\n\n\t\t\t\t\tif ( geometry.boundingBox === null ) {\n\n\t\t\t\t\t\tgeometry.computeBoundingBox();\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_box$4.copy( geometry.boundingBox );\n\n\t\t\t\t}\n\n\t\t\t\t_box$4.applyMatrix4( object.matrixWorld );\n\n\t\t\t\tthis.union( _box$4 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tthis.expandByObject( children[ i ], precise );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn point.x >= this.min.x && point.x <= this.max.x &&\n\t\t\tpoint.y >= this.min.y && point.y <= this.max.y &&\n\t\t\tpoint.z >= this.min.z && point.z <= this.max.z;\n\n\t}\n\n\tcontainsBox( box ) {\n\n\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\n\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y &&\n\t\t\tthis.min.z <= box.min.z && box.max.z <= this.max.z;\n\n\t}\n\n\tgetParameter( point, target ) {\n\n\t\t// This can potentially have a divide by zero if the box\n\t\t// has a size dimension of 0.\n\n\t\treturn target.set(\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y ),\n\t\t\t( point.z - this.min.z ) / ( this.max.z - this.min.z )\n\t\t);\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\t// using 6 splitting planes to rule out intersections.\n\t\treturn box.max.x >= this.min.x && box.min.x <= this.max.x &&\n\t\t\tbox.max.y >= this.min.y && box.min.y <= this.max.y &&\n\t\t\tbox.max.z >= this.min.z && box.min.z <= this.max.z;\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\t// Find the point on the AABB closest to the sphere center.\n\t\tthis.clampPoint( sphere.center, _vector$b );\n\n\t\t// If that point is inside the sphere, the AABB and sphere intersect.\n\t\treturn _vector$b.distanceToSquared( sphere.center ) <= ( sphere.radius * sphere.radius );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\t// We compute the minimum and maximum dot product values. If those values\n\t\t// are on the same side (back or front) of the plane, then there is no intersection.\n\n\t\tlet min, max;\n\n\t\tif ( plane.normal.x > 0 ) {\n\n\t\t\tmin = plane.normal.x * this.min.x;\n\t\t\tmax = plane.normal.x * this.max.x;\n\n\t\t} else {\n\n\t\t\tmin = plane.normal.x * this.max.x;\n\t\t\tmax = plane.normal.x * this.min.x;\n\n\t\t}\n\n\t\tif ( plane.normal.y > 0 ) {\n\n\t\t\tmin += plane.normal.y * this.min.y;\n\t\t\tmax += plane.normal.y * this.max.y;\n\n\t\t} else {\n\n\t\t\tmin += plane.normal.y * this.max.y;\n\t\t\tmax += plane.normal.y * this.min.y;\n\n\t\t}\n\n\t\tif ( plane.normal.z > 0 ) {\n\n\t\t\tmin += plane.normal.z * this.min.z;\n\t\t\tmax += plane.normal.z * this.max.z;\n\n\t\t} else {\n\n\t\t\tmin += plane.normal.z * this.max.z;\n\t\t\tmax += plane.normal.z * this.min.z;\n\n\t\t}\n\n\t\treturn ( min <= - plane.constant && max >= - plane.constant );\n\n\t}\n\n\tintersectsTriangle( triangle ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// compute box center and extents\n\t\tthis.getCenter( _center );\n\t\t_extents.subVectors( this.max, _center );\n\n\t\t// translate triangle to aabb origin\n\t\t_v0$2.subVectors( triangle.a, _center );\n\t\t_v1$7.subVectors( triangle.b, _center );\n\t\t_v2$4.subVectors( triangle.c, _center );\n\n\t\t// compute edge vectors for triangle\n\t\t_f0.subVectors( _v1$7, _v0$2 );\n\t\t_f1.subVectors( _v2$4, _v1$7 );\n\t\t_f2.subVectors( _v0$2, _v2$4 );\n\n\t\t// test against axes that are given by cross product combinations of the edges of the triangle and the edges of the aabb\n\t\t// make an axis testing of each of the 3 sides of the aabb against each of the 3 sides of the triangle = 9 axis of separation\n\t\t// axis_ij = u_i x f_j (u0, u1, u2 = face normals of aabb = x,y,z axes vectors since aabb is axis aligned)\n\t\tlet axes = [\n\t\t\t0, - _f0.z, _f0.y, 0, - _f1.z, _f1.y, 0, - _f2.z, _f2.y,\n\t\t\t_f0.z, 0, - _f0.x, _f1.z, 0, - _f1.x, _f2.z, 0, - _f2.x,\n\t\t\t- _f0.y, _f0.x, 0, - _f1.y, _f1.x, 0, - _f2.y, _f2.x, 0\n\t\t];\n\t\tif ( ! satForAxes( axes, _v0$2, _v1$7, _v2$4, _extents ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// test 3 face normals from the aabb\n\t\taxes = [ 1, 0, 0, 0, 1, 0, 0, 0, 1 ];\n\t\tif ( ! satForAxes( axes, _v0$2, _v1$7, _v2$4, _extents ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// finally testing the face normal of the triangle\n\t\t// use already existing triangle edge vectors here\n\t\t_triangleNormal.crossVectors( _f0, _f1 );\n\t\taxes = [ _triangleNormal.x, _triangleNormal.y, _triangleNormal.z ];\n\n\t\treturn satForAxes( axes, _v0$2, _v1$7, _v2$4, _extents );\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\treturn target.copy( point ).clamp( this.min, this.max );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn this.clampPoint( point, _vector$b ).distanceTo( point );\n\n\t}\n\n\tgetBoundingSphere( target ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\ttarget.makeEmpty();\n\n\t\t} else {\n\n\t\t\tthis.getCenter( target.center );\n\n\t\t\ttarget.radius = this.getSize( _vector$b ).length() * 0.5;\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n\tintersect( box ) {\n\n\t\tthis.min.max( box.min );\n\t\tthis.max.min( box.max );\n\n\t\t// ensure that if there is no overlap, the result is fully empty, not slightly empty with non-inf/+inf values that will cause subsequence intersects to erroneously return valid values.\n\t\tif ( this.isEmpty() ) this.makeEmpty();\n\n\t\treturn this;\n\n\t}\n\n\tunion( box ) {\n\n\t\tthis.min.min( box.min );\n\t\tthis.max.max( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\t// transform of empty box is an empty box.\n\t\tif ( this.isEmpty() ) return this;\n\n\t\t// NOTE: I am using a binary pattern to specify all 2^3 combinations below\n\t\t_points[ 0 ].set( this.min.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 000\n\t\t_points[ 1 ].set( this.min.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 001\n\t\t_points[ 2 ].set( this.min.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 010\n\t\t_points[ 3 ].set( this.min.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 011\n\t\t_points[ 4 ].set( this.max.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 100\n\t\t_points[ 5 ].set( this.max.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 101\n\t\t_points[ 6 ].set( this.max.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 110\n\t\t_points[ 7 ].set( this.max.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 111\n\n\t\tthis.setFromPoints( _points );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.min.add( offset );\n\t\tthis.max.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\tequals( box ) {\n\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\n\n\t}\n\n}\n\nconst _points = [\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3()\n];\n\nconst _vector$b = /*@__PURE__*/ new Vector3();\n\nconst _box$4 = /*@__PURE__*/ new Box3();\n\n// triangle centered vertices\n\nconst _v0$2 = /*@__PURE__*/ new Vector3();\nconst _v1$7 = /*@__PURE__*/ new Vector3();\nconst _v2$4 = /*@__PURE__*/ new Vector3();\n\n// triangle edge vectors\n\nconst _f0 = /*@__PURE__*/ new Vector3();\nconst _f1 = /*@__PURE__*/ new Vector3();\nconst _f2 = /*@__PURE__*/ new Vector3();\n\nconst _center = /*@__PURE__*/ new Vector3();\nconst _extents = /*@__PURE__*/ new Vector3();\nconst _triangleNormal = /*@__PURE__*/ new Vector3();\nconst _testAxis = /*@__PURE__*/ new Vector3();\n\nfunction satForAxes( axes, v0, v1, v2, extents ) {\n\n\tfor ( let i = 0, j = axes.length - 3; i <= j; i += 3 ) {\n\n\t\t_testAxis.fromArray( axes, i );\n\t\t// project the aabb onto the separating axis\n\t\tconst r = extents.x * Math.abs( _testAxis.x ) + extents.y * Math.abs( _testAxis.y ) + extents.z * Math.abs( _testAxis.z );\n\t\t// project all 3 vertices of the triangle onto the separating axis\n\t\tconst p0 = v0.dot( _testAxis );\n\t\tconst p1 = v1.dot( _testAxis );\n\t\tconst p2 = v2.dot( _testAxis );\n\t\t// actual test, basically see if either of the most extreme of the triangle points intersects r\n\t\tif ( Math.max( - Math.max( p0, p1, p2 ), Math.min( p0, p1, p2 ) ) > r ) {\n\n\t\t\t// points of the projected triangle are outside the projected half-length of the aabb\n\t\t\t// the axis is separating and we can exit\n\t\t\treturn false;\n\n\t\t}\n\n\t}\n\n\treturn true;\n\n}\n\nconst _box$3 = /*@__PURE__*/ new Box3();\nconst _v1$6 = /*@__PURE__*/ new Vector3();\nconst _v2$3 = /*@__PURE__*/ new Vector3();\n\nclass Sphere {\n\n\tconstructor( center = new Vector3(), radius = - 1 ) {\n\n\t\tthis.isSphere = true;\n\n\t\tthis.center = center;\n\t\tthis.radius = radius;\n\n\t}\n\n\tset( center, radius ) {\n\n\t\tthis.center.copy( center );\n\t\tthis.radius = radius;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points, optionalCenter ) {\n\n\t\tconst center = this.center;\n\n\t\tif ( optionalCenter !== undefined ) {\n\n\t\t\tcenter.copy( optionalCenter );\n\n\t\t} else {\n\n\t\t\t_box$3.setFromPoints( points ).getCenter( center );\n\n\t\t}\n\n\t\tlet maxRadiusSq = 0;\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( points[ i ] ) );\n\n\t\t}\n\n\t\tthis.radius = Math.sqrt( maxRadiusSq );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( sphere ) {\n\n\t\tthis.center.copy( sphere.center );\n\t\tthis.radius = sphere.radius;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\treturn ( this.radius < 0 );\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.center.set( 0, 0, 0 );\n\t\tthis.radius = - 1;\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn ( point.distanceToSquared( this.center ) <= ( this.radius * this.radius ) );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn ( point.distanceTo( this.center ) - this.radius );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\tconst radiusSum = this.radius + sphere.radius;\n\n\t\treturn sphere.center.distanceToSquared( this.center ) <= ( radiusSum * radiusSum );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsSphere( this );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\treturn Math.abs( plane.distanceToPoint( this.center ) ) <= this.radius;\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\tconst deltaLengthSq = this.center.distanceToSquared( point );\n\n\t\ttarget.copy( point );\n\n\t\tif ( deltaLengthSq > ( this.radius * this.radius ) ) {\n\n\t\t\ttarget.sub( this.center ).normalize();\n\t\t\ttarget.multiplyScalar( this.radius ).add( this.center );\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n\tgetBoundingBox( target ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\t// Empty sphere produces empty bounding box\n\t\t\ttarget.makeEmpty();\n\t\t\treturn target;\n\n\t\t}\n\n\t\ttarget.set( this.center, this.center );\n\t\ttarget.expandByScalar( this.radius );\n\n\t\treturn target;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tthis.center.applyMatrix4( matrix );\n\t\tthis.radius = this.radius * matrix.getMaxScaleOnAxis();\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.center.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\tthis.center.copy( point );\n\n\t\t\tthis.radius = 0;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\t_v1$6.subVectors( point, this.center );\n\n\t\tconst lengthSq = _v1$6.lengthSq();\n\n\t\tif ( lengthSq > ( this.radius * this.radius ) ) {\n\n\t\t\t// calculate the minimal sphere\n\n\t\t\tconst length = Math.sqrt( lengthSq );\n\n\t\t\tconst delta = ( length - this.radius ) * 0.5;\n\n\t\t\tthis.center.addScaledVector( _v1$6, delta / length );\n\n\t\t\tthis.radius += delta;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunion( sphere ) {\n\n\t\tif ( sphere.isEmpty() ) {\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\tthis.copy( sphere );\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( this.center.equals( sphere.center ) === true ) {\n\n\t\t\t this.radius = Math.max( this.radius, sphere.radius );\n\n\t\t} else {\n\n\t\t\t_v2$3.subVectors( sphere.center, this.center ).setLength( sphere.radius );\n\n\t\t\tthis.expandByPoint( _v1$6.copy( sphere.center ).add( _v2$3 ) );\n\n\t\t\tthis.expandByPoint( _v1$6.copy( sphere.center ).sub( _v2$3 ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tequals( sphere ) {\n\n\t\treturn sphere.center.equals( this.center ) && ( sphere.radius === this.radius );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nconst _vector$a = /*@__PURE__*/ new Vector3();\nconst _segCenter = /*@__PURE__*/ new Vector3();\nconst _segDir = /*@__PURE__*/ new Vector3();\nconst _diff = /*@__PURE__*/ new Vector3();\n\nconst _edge1 = /*@__PURE__*/ new Vector3();\nconst _edge2 = /*@__PURE__*/ new Vector3();\nconst _normal$1 = /*@__PURE__*/ new Vector3();\n\nclass Ray {\n\n\tconstructor( origin = new Vector3(), direction = new Vector3( 0, 0, - 1 ) ) {\n\n\t\tthis.origin = origin;\n\t\tthis.direction = direction;\n\n\t}\n\n\tset( origin, direction ) {\n\n\t\tthis.origin.copy( origin );\n\t\tthis.direction.copy( direction );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( ray ) {\n\n\t\tthis.origin.copy( ray.origin );\n\t\tthis.direction.copy( ray.direction );\n\n\t\treturn this;\n\n\t}\n\n\tat( t, target ) {\n\n\t\treturn target.copy( this.origin ).addScaledVector( this.direction, t );\n\n\t}\n\n\tlookAt( v ) {\n\n\t\tthis.direction.copy( v ).sub( this.origin ).normalize();\n\n\t\treturn this;\n\n\t}\n\n\trecast( t ) {\n\n\t\tthis.origin.copy( this.at( t, _vector$a ) );\n\n\t\treturn this;\n\n\t}\n\n\tclosestPointToPoint( point, target ) {\n\n\t\ttarget.subVectors( point, this.origin );\n\n\t\tconst directionDistance = target.dot( this.direction );\n\n\t\tif ( directionDistance < 0 ) {\n\n\t\t\treturn target.copy( this.origin );\n\n\t\t}\n\n\t\treturn target.copy( this.origin ).addScaledVector( this.direction, directionDistance );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn Math.sqrt( this.distanceSqToPoint( point ) );\n\n\t}\n\n\tdistanceSqToPoint( point ) {\n\n\t\tconst directionDistance = _vector$a.subVectors( point, this.origin ).dot( this.direction );\n\n\t\t// point behind the ray\n\n\t\tif ( directionDistance < 0 ) {\n\n\t\t\treturn this.origin.distanceToSquared( point );\n\n\t\t}\n\n\t\t_vector$a.copy( this.origin ).addScaledVector( this.direction, directionDistance );\n\n\t\treturn _vector$a.distanceToSquared( point );\n\n\t}\n\n\tdistanceSqToSegment( v0, v1, optionalPointOnRay, optionalPointOnSegment ) {\n\n\t\t// from https://github.com/pmjoniak/GeometricTools/blob/master/GTEngine/Include/Mathematics/GteDistRaySegment.h\n\t\t// It returns the min distance between the ray and the segment\n\t\t// defined by v0 and v1\n\t\t// It can also set two optional targets :\n\t\t// - The closest point on the ray\n\t\t// - The closest point on the segment\n\n\t\t_segCenter.copy( v0 ).add( v1 ).multiplyScalar( 0.5 );\n\t\t_segDir.copy( v1 ).sub( v0 ).normalize();\n\t\t_diff.copy( this.origin ).sub( _segCenter );\n\n\t\tconst segExtent = v0.distanceTo( v1 ) * 0.5;\n\t\tconst a01 = - this.direction.dot( _segDir );\n\t\tconst b0 = _diff.dot( this.direction );\n\t\tconst b1 = - _diff.dot( _segDir );\n\t\tconst c = _diff.lengthSq();\n\t\tconst det = Math.abs( 1 - a01 * a01 );\n\t\tlet s0, s1, sqrDist, extDet;\n\n\t\tif ( det > 0 ) {\n\n\t\t\t// The ray and segment are not parallel.\n\n\t\t\ts0 = a01 * b1 - b0;\n\t\t\ts1 = a01 * b0 - b1;\n\t\t\textDet = segExtent * det;\n\n\t\t\tif ( s0 >= 0 ) {\n\n\t\t\t\tif ( s1 >= - extDet ) {\n\n\t\t\t\t\tif ( s1 <= extDet ) {\n\n\t\t\t\t\t\t// region 0\n\t\t\t\t\t\t// Minimum at interior points of ray and segment.\n\n\t\t\t\t\t\tconst invDet = 1 / det;\n\t\t\t\t\t\ts0 *= invDet;\n\t\t\t\t\t\ts1 *= invDet;\n\t\t\t\t\t\tsqrDist = s0 * ( s0 + a01 * s1 + 2 * b0 ) + s1 * ( a01 * s0 + s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// region 1\n\n\t\t\t\t\t\ts1 = segExtent;\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// region 5\n\n\t\t\t\t\ts1 = - segExtent;\n\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( s1 <= - extDet ) {\n\n\t\t\t\t\t// region 4\n\n\t\t\t\t\ts0 = Math.max( 0, - ( - a01 * segExtent + b0 ) );\n\t\t\t\t\ts1 = ( s0 > 0 ) ? - segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t} else if ( s1 <= extDet ) {\n\n\t\t\t\t\t// region 3\n\n\t\t\t\t\ts0 = 0;\n\t\t\t\t\ts1 = Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// region 2\n\n\t\t\t\t\ts0 = Math.max( 0, - ( a01 * segExtent + b0 ) );\n\t\t\t\t\ts1 = ( s0 > 0 ) ? segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// Ray and segment are parallel.\n\n\t\t\ts1 = ( a01 > 0 ) ? - segExtent : segExtent;\n\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t}\n\n\t\tif ( optionalPointOnRay ) {\n\n\t\t\toptionalPointOnRay.copy( this.origin ).addScaledVector( this.direction, s0 );\n\n\t\t}\n\n\t\tif ( optionalPointOnSegment ) {\n\n\t\t\toptionalPointOnSegment.copy( _segCenter ).addScaledVector( _segDir, s1 );\n\n\t\t}\n\n\t\treturn sqrDist;\n\n\t}\n\n\tintersectSphere( sphere, target ) {\n\n\t\t_vector$a.subVectors( sphere.center, this.origin );\n\t\tconst tca = _vector$a.dot( this.direction );\n\t\tconst d2 = _vector$a.dot( _vector$a ) - tca * tca;\n\t\tconst radius2 = sphere.radius * sphere.radius;\n\n\t\tif ( d2 > radius2 ) return null;\n\n\t\tconst thc = Math.sqrt( radius2 - d2 );\n\n\t\t// t0 = first intersect point - entrance on front of sphere\n\t\tconst t0 = tca - thc;\n\n\t\t// t1 = second intersect point - exit point on back of sphere\n\t\tconst t1 = tca + thc;\n\n\t\t// test to see if t1 is behind the ray - if so, return null\n\t\tif ( t1 < 0 ) return null;\n\n\t\t// test to see if t0 is behind the ray:\n\t\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\n\t\t// in order to always return an intersect point that is in front of the ray.\n\t\tif ( t0 < 0 ) return this.at( t1, target );\n\n\t\t// else t0 is in front of the ray, so return the first collision point scaled by t0\n\t\treturn this.at( t0, target );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\treturn this.distanceSqToPoint( sphere.center ) <= ( sphere.radius * sphere.radius );\n\n\t}\n\n\tdistanceToPlane( plane ) {\n\n\t\tconst denominator = plane.normal.dot( this.direction );\n\n\t\tif ( denominator === 0 ) {\n\n\t\t\t// line is coplanar, return origin\n\t\t\tif ( plane.distanceToPoint( this.origin ) === 0 ) {\n\n\t\t\t\treturn 0;\n\n\t\t\t}\n\n\t\t\t// Null is preferable to undefined since undefined means.... it is undefined\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst t = - ( this.origin.dot( plane.normal ) + plane.constant ) / denominator;\n\n\t\t// Return if the ray never intersects the plane\n\n\t\treturn t >= 0 ? t : null;\n\n\t}\n\n\tintersectPlane( plane, target ) {\n\n\t\tconst t = this.distanceToPlane( plane );\n\n\t\tif ( t === null ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn this.at( t, target );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\t// check if the ray lies on the plane first\n\n\t\tconst distToPoint = plane.distanceToPoint( this.origin );\n\n\t\tif ( distToPoint === 0 ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\tconst denominator = plane.normal.dot( this.direction );\n\n\t\tif ( denominator * distToPoint < 0 ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\t// ray origin is behind the plane (and is pointing behind it)\n\n\t\treturn false;\n\n\t}\n\n\tintersectBox( box, target ) {\n\n\t\tlet tmin, tmax, tymin, tymax, tzmin, tzmax;\n\n\t\tconst invdirx = 1 / this.direction.x,\n\t\t\tinvdiry = 1 / this.direction.y,\n\t\t\tinvdirz = 1 / this.direction.z;\n\n\t\tconst origin = this.origin;\n\n\t\tif ( invdirx >= 0 ) {\n\n\t\t\ttmin = ( box.min.x - origin.x ) * invdirx;\n\t\t\ttmax = ( box.max.x - origin.x ) * invdirx;\n\n\t\t} else {\n\n\t\t\ttmin = ( box.max.x - origin.x ) * invdirx;\n\t\t\ttmax = ( box.min.x - origin.x ) * invdirx;\n\n\t\t}\n\n\t\tif ( invdiry >= 0 ) {\n\n\t\t\ttymin = ( box.min.y - origin.y ) * invdiry;\n\t\t\ttymax = ( box.max.y - origin.y ) * invdiry;\n\n\t\t} else {\n\n\t\t\ttymin = ( box.max.y - origin.y ) * invdiry;\n\t\t\ttymax = ( box.min.y - origin.y ) * invdiry;\n\n\t\t}\n\n\t\tif ( ( tmin > tymax ) || ( tymin > tmax ) ) return null;\n\n\t\tif ( tymin > tmin || isNaN( tmin ) ) tmin = tymin;\n\n\t\tif ( tymax < tmax || isNaN( tmax ) ) tmax = tymax;\n\n\t\tif ( invdirz >= 0 ) {\n\n\t\t\ttzmin = ( box.min.z - origin.z ) * invdirz;\n\t\t\ttzmax = ( box.max.z - origin.z ) * invdirz;\n\n\t\t} else {\n\n\t\t\ttzmin = ( box.max.z - origin.z ) * invdirz;\n\t\t\ttzmax = ( box.min.z - origin.z ) * invdirz;\n\n\t\t}\n\n\t\tif ( ( tmin > tzmax ) || ( tzmin > tmax ) ) return null;\n\n\t\tif ( tzmin > tmin || tmin !== tmin ) tmin = tzmin;\n\n\t\tif ( tzmax < tmax || tmax !== tmax ) tmax = tzmax;\n\n\t\t//return point closest to the ray (positive side)\n\n\t\tif ( tmax < 0 ) return null;\n\n\t\treturn this.at( tmin >= 0 ? tmin : tmax, target );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn this.intersectBox( box, _vector$a ) !== null;\n\n\t}\n\n\tintersectTriangle( a, b, c, backfaceCulling, target ) {\n\n\t\t// Compute the offset origin, edges, and normal.\n\n\t\t// from https://github.com/pmjoniak/GeometricTools/blob/master/GTEngine/Include/Mathematics/GteIntrRay3Triangle3.h\n\n\t\t_edge1.subVectors( b, a );\n\t\t_edge2.subVectors( c, a );\n\t\t_normal$1.crossVectors( _edge1, _edge2 );\n\n\t\t// Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\n\t\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\n\t\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\n\t\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\n\t\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\n\t\tlet DdN = this.direction.dot( _normal$1 );\n\t\tlet sign;\n\n\t\tif ( DdN > 0 ) {\n\n\t\t\tif ( backfaceCulling ) return null;\n\t\t\tsign = 1;\n\n\t\t} else if ( DdN < 0 ) {\n\n\t\t\tsign = - 1;\n\t\t\tDdN = - DdN;\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t_diff.subVectors( this.origin, a );\n\t\tconst DdQxE2 = sign * this.direction.dot( _edge2.crossVectors( _diff, _edge2 ) );\n\n\t\t// b1 < 0, no intersection\n\t\tif ( DdQxE2 < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst DdE1xQ = sign * this.direction.dot( _edge1.cross( _diff ) );\n\n\t\t// b2 < 0, no intersection\n\t\tif ( DdE1xQ < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// b1+b2 > 1, no intersection\n\t\tif ( DdQxE2 + DdE1xQ > DdN ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// Line intersects triangle, check if ray does.\n\t\tconst QdN = - sign * _diff.dot( _normal$1 );\n\n\t\t// t < 0, no intersection\n\t\tif ( QdN < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// Ray intersects triangle.\n\t\treturn this.at( QdN / DdN, target );\n\n\t}\n\n\tapplyMatrix4( matrix4 ) {\n\n\t\tthis.origin.applyMatrix4( matrix4 );\n\t\tthis.direction.transformDirection( matrix4 );\n\n\t\treturn this;\n\n\t}\n\n\tequals( ray ) {\n\n\t\treturn ray.origin.equals( this.origin ) && ray.direction.equals( this.direction );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nclass Matrix4 {\n\n\tconstructor( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\n\n\t\tMatrix4.prototype.isMatrix4 = true;\n\n\t\tthis.elements = [\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, 1, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t];\n\n\t\tif ( n11 !== undefined ) {\n\n\t\t\tthis.set( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 );\n\n\t\t}\n\n\t}\n\n\tset( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\n\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\n\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\n\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, 1, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new Matrix4().fromArray( this.elements );\n\n\t}\n\n\tcopy( m ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ]; te[ 3 ] = me[ 3 ];\n\t\tte[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ]; te[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ];\n\t\tte[ 8 ] = me[ 8 ]; te[ 9 ] = me[ 9 ]; te[ 10 ] = me[ 10 ]; te[ 11 ] = me[ 11 ];\n\t\tte[ 12 ] = me[ 12 ]; te[ 13 ] = me[ 13 ]; te[ 14 ] = me[ 14 ]; te[ 15 ] = me[ 15 ];\n\n\t\treturn this;\n\n\t}\n\n\tcopyPosition( m ) {\n\n\t\tconst te = this.elements, me = m.elements;\n\n\t\tte[ 12 ] = me[ 12 ];\n\t\tte[ 13 ] = me[ 13 ];\n\t\tte[ 14 ] = me[ 14 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrix3( m ) {\n\n\t\tconst me = m.elements;\n\n\t\tthis.set(\n\n\t\t\tme[ 0 ], me[ 3 ], me[ 6 ], 0,\n\t\t\tme[ 1 ], me[ 4 ], me[ 7 ], 0,\n\t\t\tme[ 2 ], me[ 5 ], me[ 8 ], 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\textractBasis( xAxis, yAxis, zAxis ) {\n\n\t\txAxis.setFromMatrixColumn( this, 0 );\n\t\tyAxis.setFromMatrixColumn( this, 1 );\n\t\tzAxis.setFromMatrixColumn( this, 2 );\n\n\t\treturn this;\n\n\t}\n\n\tmakeBasis( xAxis, yAxis, zAxis ) {\n\n\t\tthis.set(\n\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\n\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\n\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\n\t\t\t0, 0, 0, 1\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\textractRotation( m ) {\n\n\t\t// this method does not support reflection matrices\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tconst scaleX = 1 / _v1$5.setFromMatrixColumn( m, 0 ).length();\n\t\tconst scaleY = 1 / _v1$5.setFromMatrixColumn( m, 1 ).length();\n\t\tconst scaleZ = 1 / _v1$5.setFromMatrixColumn( m, 2 ).length();\n\n\t\tte[ 0 ] = me[ 0 ] * scaleX;\n\t\tte[ 1 ] = me[ 1 ] * scaleX;\n\t\tte[ 2 ] = me[ 2 ] * scaleX;\n\t\tte[ 3 ] = 0;\n\n\t\tte[ 4 ] = me[ 4 ] * scaleY;\n\t\tte[ 5 ] = me[ 5 ] * scaleY;\n\t\tte[ 6 ] = me[ 6 ] * scaleY;\n\t\tte[ 7 ] = 0;\n\n\t\tte[ 8 ] = me[ 8 ] * scaleZ;\n\t\tte[ 9 ] = me[ 9 ] * scaleZ;\n\t\tte[ 10 ] = me[ 10 ] * scaleZ;\n\t\tte[ 11 ] = 0;\n\n\t\tte[ 12 ] = 0;\n\t\tte[ 13 ] = 0;\n\t\tte[ 14 ] = 0;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationFromEuler( euler ) {\n\n\t\tconst te = this.elements;\n\n\t\tconst x = euler.x, y = euler.y, z = euler.z;\n\t\tconst a = Math.cos( x ), b = Math.sin( x );\n\t\tconst c = Math.cos( y ), d = Math.sin( y );\n\t\tconst e = Math.cos( z ), f = Math.sin( z );\n\n\t\tif ( euler.order === 'XYZ' ) {\n\n\t\t\tconst ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = - c * f;\n\t\t\tte[ 8 ] = d;\n\n\t\t\tte[ 1 ] = af + be * d;\n\t\t\tte[ 5 ] = ae - bf * d;\n\t\t\tte[ 9 ] = - b * c;\n\n\t\t\tte[ 2 ] = bf - ae * d;\n\t\t\tte[ 6 ] = be + af * d;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'YXZ' ) {\n\n\t\t\tconst ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\tte[ 0 ] = ce + df * b;\n\t\t\tte[ 4 ] = de * b - cf;\n\t\t\tte[ 8 ] = a * d;\n\n\t\t\tte[ 1 ] = a * f;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = - b;\n\n\t\t\tte[ 2 ] = cf * b - de;\n\t\t\tte[ 6 ] = df + ce * b;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'ZXY' ) {\n\n\t\t\tconst ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\tte[ 0 ] = ce - df * b;\n\t\t\tte[ 4 ] = - a * f;\n\t\t\tte[ 8 ] = de + cf * b;\n\n\t\t\tte[ 1 ] = cf + de * b;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = df - ce * b;\n\n\t\t\tte[ 2 ] = - a * d;\n\t\t\tte[ 6 ] = b;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'ZYX' ) {\n\n\t\t\tconst ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = be * d - af;\n\t\t\tte[ 8 ] = ae * d + bf;\n\n\t\t\tte[ 1 ] = c * f;\n\t\t\tte[ 5 ] = bf * d + ae;\n\t\t\tte[ 9 ] = af * d - be;\n\n\t\t\tte[ 2 ] = - d;\n\t\t\tte[ 6 ] = b * c;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'YZX' ) {\n\n\t\t\tconst ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = bd - ac * f;\n\t\t\tte[ 8 ] = bc * f + ad;\n\n\t\t\tte[ 1 ] = f;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = - b * e;\n\n\t\t\tte[ 2 ] = - d * e;\n\t\t\tte[ 6 ] = ad * f + bc;\n\t\t\tte[ 10 ] = ac - bd * f;\n\n\t\t} else if ( euler.order === 'XZY' ) {\n\n\t\t\tconst ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = - f;\n\t\t\tte[ 8 ] = d * e;\n\n\t\t\tte[ 1 ] = ac * f + bd;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = ad * f - bc;\n\n\t\t\tte[ 2 ] = bc * f - ad;\n\t\t\tte[ 6 ] = b * e;\n\t\t\tte[ 10 ] = bd * f + ac;\n\n\t\t}\n\n\t\t// bottom row\n\t\tte[ 3 ] = 0;\n\t\tte[ 7 ] = 0;\n\t\tte[ 11 ] = 0;\n\n\t\t// last column\n\t\tte[ 12 ] = 0;\n\t\tte[ 13 ] = 0;\n\t\tte[ 14 ] = 0;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationFromQuaternion( q ) {\n\n\t\treturn this.compose( _zero, q, _one );\n\n\t}\n\n\tlookAt( eye, target, up ) {\n\n\t\tconst te = this.elements;\n\n\t\t_z.subVectors( eye, target );\n\n\t\tif ( _z.lengthSq() === 0 ) {\n\n\t\t\t// eye and target are in the same position\n\n\t\t\t_z.z = 1;\n\n\t\t}\n\n\t\t_z.normalize();\n\t\t_x.crossVectors( up, _z );\n\n\t\tif ( _x.lengthSq() === 0 ) {\n\n\t\t\t// up and z are parallel\n\n\t\t\tif ( Math.abs( up.z ) === 1 ) {\n\n\t\t\t\t_z.x += 0.0001;\n\n\t\t\t} else {\n\n\t\t\t\t_z.z += 0.0001;\n\n\t\t\t}\n\n\t\t\t_z.normalize();\n\t\t\t_x.crossVectors( up, _z );\n\n\t\t}\n\n\t\t_x.normalize();\n\t\t_y.crossVectors( _z, _x );\n\n\t\tte[ 0 ] = _x.x; te[ 4 ] = _y.x; te[ 8 ] = _z.x;\n\t\tte[ 1 ] = _x.y; te[ 5 ] = _y.y; te[ 9 ] = _z.y;\n\t\tte[ 2 ] = _x.z; te[ 6 ] = _y.z; te[ 10 ] = _z.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( m ) {\n\n\t\treturn this.multiplyMatrices( this, m );\n\n\t}\n\n\tpremultiply( m ) {\n\n\t\treturn this.multiplyMatrices( m, this );\n\n\t}\n\n\tmultiplyMatrices( a, b ) {\n\n\t\tconst ae = a.elements;\n\t\tconst be = b.elements;\n\t\tconst te = this.elements;\n\n\t\tconst a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\n\t\tconst a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\n\t\tconst a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\n\t\tconst a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\n\n\t\tconst b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\n\t\tconst b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\n\t\tconst b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\n\t\tconst b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\n\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\n\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\n\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\n\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\n\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\n\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\n\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\n\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\n\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\n\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\n\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\n\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\n\n\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\n\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\n\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\n\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\n\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\n\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\n\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\n\n\t\treturn this;\n\n\t}\n\n\tdeterminant() {\n\n\t\tconst te = this.elements;\n\n\t\tconst n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\n\t\tconst n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\n\t\tconst n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\n\t\tconst n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\n\n\t\t//TODO: make this more efficient\n\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\n\n\t\treturn (\n\t\t\tn41 * (\n\t\t\t\t+ n14 * n23 * n32\n\t\t\t\t - n13 * n24 * n32\n\t\t\t\t - n14 * n22 * n33\n\t\t\t\t + n12 * n24 * n33\n\t\t\t\t + n13 * n22 * n34\n\t\t\t\t - n12 * n23 * n34\n\t\t\t) +\n\t\t\tn42 * (\n\t\t\t\t+ n11 * n23 * n34\n\t\t\t\t - n11 * n24 * n33\n\t\t\t\t + n14 * n21 * n33\n\t\t\t\t - n13 * n21 * n34\n\t\t\t\t + n13 * n24 * n31\n\t\t\t\t - n14 * n23 * n31\n\t\t\t) +\n\t\t\tn43 * (\n\t\t\t\t+ n11 * n24 * n32\n\t\t\t\t - n11 * n22 * n34\n\t\t\t\t - n14 * n21 * n32\n\t\t\t\t + n12 * n21 * n34\n\t\t\t\t + n14 * n22 * n31\n\t\t\t\t - n12 * n24 * n31\n\t\t\t) +\n\t\t\tn44 * (\n\t\t\t\t- n13 * n22 * n31\n\t\t\t\t - n11 * n23 * n32\n\t\t\t\t + n11 * n22 * n33\n\t\t\t\t + n13 * n21 * n32\n\t\t\t\t - n12 * n21 * n33\n\t\t\t\t + n12 * n23 * n31\n\t\t\t)\n\n\t\t);\n\n\t}\n\n\ttranspose() {\n\n\t\tconst te = this.elements;\n\t\tlet tmp;\n\n\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\n\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\n\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\n\n\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\n\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\n\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\n\n\t\treturn this;\n\n\t}\n\n\tsetPosition( x, y, z ) {\n\n\t\tconst te = this.elements;\n\n\t\tif ( x.isVector3 ) {\n\n\t\t\tte[ 12 ] = x.x;\n\t\t\tte[ 13 ] = x.y;\n\t\t\tte[ 14 ] = x.z;\n\n\t\t} else {\n\n\t\t\tte[ 12 ] = x;\n\t\t\tte[ 13 ] = y;\n\t\t\tte[ 14 ] = z;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tinvert() {\n\n\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\n\t\tconst te = this.elements,\n\n\t\t\tn11 = te[ 0 ], n21 = te[ 1 ], n31 = te[ 2 ], n41 = te[ 3 ],\n\t\t\tn12 = te[ 4 ], n22 = te[ 5 ], n32 = te[ 6 ], n42 = te[ 7 ],\n\t\t\tn13 = te[ 8 ], n23 = te[ 9 ], n33 = te[ 10 ], n43 = te[ 11 ],\n\t\t\tn14 = te[ 12 ], n24 = te[ 13 ], n34 = te[ 14 ], n44 = te[ 15 ],\n\n\t\t\tt11 = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44,\n\t\t\tt12 = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44,\n\t\t\tt13 = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44,\n\t\t\tt14 = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\n\n\t\tconst det = n11 * t11 + n21 * t12 + n31 * t13 + n41 * t14;\n\n\t\tif ( det === 0 ) return this.set( 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );\n\n\t\tconst detInv = 1 / det;\n\n\t\tte[ 0 ] = t11 * detInv;\n\t\tte[ 1 ] = ( n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44 ) * detInv;\n\t\tte[ 2 ] = ( n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44 ) * detInv;\n\t\tte[ 3 ] = ( n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43 ) * detInv;\n\n\t\tte[ 4 ] = t12 * detInv;\n\t\tte[ 5 ] = ( n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44 ) * detInv;\n\t\tte[ 6 ] = ( n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44 ) * detInv;\n\t\tte[ 7 ] = ( n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43 ) * detInv;\n\n\t\tte[ 8 ] = t13 * detInv;\n\t\tte[ 9 ] = ( n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44 ) * detInv;\n\t\tte[ 10 ] = ( n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44 ) * detInv;\n\t\tte[ 11 ] = ( n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43 ) * detInv;\n\n\t\tte[ 12 ] = t14 * detInv;\n\t\tte[ 13 ] = ( n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34 ) * detInv;\n\t\tte[ 14 ] = ( n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34 ) * detInv;\n\t\tte[ 15 ] = ( n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33 ) * detInv;\n\n\t\treturn this;\n\n\t}\n\n\tscale( v ) {\n\n\t\tconst te = this.elements;\n\t\tconst x = v.x, y = v.y, z = v.z;\n\n\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\n\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\n\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\n\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\n\n\t\treturn this;\n\n\t}\n\n\tgetMaxScaleOnAxis() {\n\n\t\tconst te = this.elements;\n\n\t\tconst scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\n\t\tconst scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\n\t\tconst scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\n\n\t\treturn Math.sqrt( Math.max( scaleXSq, scaleYSq, scaleZSq ) );\n\n\t}\n\n\tmakeTranslation( x, y, z ) {\n\n\t\tif ( x.isVector3 ) {\n\n\t\t\tthis.set(\n\n\t\t\t\t1, 0, 0, x.x,\n\t\t\t\t0, 1, 0, x.y,\n\t\t\t\t0, 0, 1, x.z,\n\t\t\t\t0, 0, 0, 1\n\n\t\t\t);\n\n\t\t} else {\n\n\t\t\tthis.set(\n\n\t\t\t\t1, 0, 0, x,\n\t\t\t\t0, 1, 0, y,\n\t\t\t\t0, 0, 1, z,\n\t\t\t\t0, 0, 0, 1\n\n\t\t\t);\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationX( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, c, - s, 0,\n\t\t\t0, s, c, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationY( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\t c, 0, s, 0,\n\t\t\t 0, 1, 0, 0,\n\t\t\t- s, 0, c, 0,\n\t\t\t 0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationZ( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\tc, - s, 0, 0,\n\t\t\ts, c, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationAxis( axis, angle ) {\n\n\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\n\n\t\tconst c = Math.cos( angle );\n\t\tconst s = Math.sin( angle );\n\t\tconst t = 1 - c;\n\t\tconst x = axis.x, y = axis.y, z = axis.z;\n\t\tconst tx = t * x, ty = t * y;\n\n\t\tthis.set(\n\n\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\n\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\n\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeScale( x, y, z ) {\n\n\t\tthis.set(\n\n\t\t\tx, 0, 0, 0,\n\t\t\t0, y, 0, 0,\n\t\t\t0, 0, z, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeShear( xy, xz, yx, yz, zx, zy ) {\n\n\t\tthis.set(\n\n\t\t\t1, yx, zx, 0,\n\t\t\txy, 1, zy, 0,\n\t\t\txz, yz, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tcompose( position, quaternion, scale ) {\n\n\t\tconst te = this.elements;\n\n\t\tconst x = quaternion._x, y = quaternion._y, z = quaternion._z, w = quaternion._w;\n\t\tconst x2 = x + x,\ty2 = y + y, z2 = z + z;\n\t\tconst xx = x * x2, xy = x * y2, xz = x * z2;\n\t\tconst yy = y * y2, yz = y * z2, zz = z * z2;\n\t\tconst wx = w * x2, wy = w * y2, wz = w * z2;\n\n\t\tconst sx = scale.x, sy = scale.y, sz = scale.z;\n\n\t\tte[ 0 ] = ( 1 - ( yy + zz ) ) * sx;\n\t\tte[ 1 ] = ( xy + wz ) * sx;\n\t\tte[ 2 ] = ( xz - wy ) * sx;\n\t\tte[ 3 ] = 0;\n\n\t\tte[ 4 ] = ( xy - wz ) * sy;\n\t\tte[ 5 ] = ( 1 - ( xx + zz ) ) * sy;\n\t\tte[ 6 ] = ( yz + wx ) * sy;\n\t\tte[ 7 ] = 0;\n\n\t\tte[ 8 ] = ( xz + wy ) * sz;\n\t\tte[ 9 ] = ( yz - wx ) * sz;\n\t\tte[ 10 ] = ( 1 - ( xx + yy ) ) * sz;\n\t\tte[ 11 ] = 0;\n\n\t\tte[ 12 ] = position.x;\n\t\tte[ 13 ] = position.y;\n\t\tte[ 14 ] = position.z;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tdecompose( position, quaternion, scale ) {\n\n\t\tconst te = this.elements;\n\n\t\tlet sx = _v1$5.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\n\t\tconst sy = _v1$5.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\n\t\tconst sz = _v1$5.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\n\n\t\t// if determine is negative, we need to invert one scale\n\t\tconst det = this.determinant();\n\t\tif ( det < 0 ) sx = - sx;\n\n\t\tposition.x = te[ 12 ];\n\t\tposition.y = te[ 13 ];\n\t\tposition.z = te[ 14 ];\n\n\t\t// scale the rotation part\n\t\t_m1$2.copy( this );\n\n\t\tconst invSX = 1 / sx;\n\t\tconst invSY = 1 / sy;\n\t\tconst invSZ = 1 / sz;\n\n\t\t_m1$2.elements[ 0 ] *= invSX;\n\t\t_m1$2.elements[ 1 ] *= invSX;\n\t\t_m1$2.elements[ 2 ] *= invSX;\n\n\t\t_m1$2.elements[ 4 ] *= invSY;\n\t\t_m1$2.elements[ 5 ] *= invSY;\n\t\t_m1$2.elements[ 6 ] *= invSY;\n\n\t\t_m1$2.elements[ 8 ] *= invSZ;\n\t\t_m1$2.elements[ 9 ] *= invSZ;\n\t\t_m1$2.elements[ 10 ] *= invSZ;\n\n\t\tquaternion.setFromRotationMatrix( _m1$2 );\n\n\t\tscale.x = sx;\n\t\tscale.y = sy;\n\t\tscale.z = sz;\n\n\t\treturn this;\n\n\t}\n\n\tmakePerspective( left, right, top, bottom, near, far, coordinateSystem = WebGLCoordinateSystem ) {\n\n\t\tconst te = this.elements;\n\t\tconst x = 2 * near / ( right - left );\n\t\tconst y = 2 * near / ( top - bottom );\n\n\t\tconst a = ( right + left ) / ( right - left );\n\t\tconst b = ( top + bottom ) / ( top - bottom );\n\n\t\tlet c, d;\n\n\t\tif ( coordinateSystem === WebGLCoordinateSystem ) {\n\n\t\t\tc = - ( far + near ) / ( far - near );\n\t\t\td = ( - 2 * far * near ) / ( far - near );\n\n\t\t} else if ( coordinateSystem === WebGPUCoordinateSystem ) {\n\n\t\t\tc = - far / ( far - near );\n\t\t\td = ( - far * near ) / ( far - near );\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.Matrix4.makePerspective(): Invalid coordinate system: ' + coordinateSystem );\n\n\t\t}\n\n\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a; \tte[ 12 ] = 0;\n\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b; \tte[ 13 ] = 0;\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c; \tte[ 14 ] = d;\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\n\n\t\treturn this;\n\n\t}\n\n\tmakeOrthographic( left, right, top, bottom, near, far, coordinateSystem = WebGLCoordinateSystem ) {\n\n\t\tconst te = this.elements;\n\t\tconst w = 1.0 / ( right - left );\n\t\tconst h = 1.0 / ( top - bottom );\n\t\tconst p = 1.0 / ( far - near );\n\n\t\tconst x = ( right + left ) * w;\n\t\tconst y = ( top + bottom ) * h;\n\n\t\tlet z, zInv;\n\n\t\tif ( coordinateSystem === WebGLCoordinateSystem ) {\n\n\t\t\tz = ( far + near ) * p;\n\t\t\tzInv = - 2 * p;\n\n\t\t} else if ( coordinateSystem === WebGPUCoordinateSystem ) {\n\n\t\t\tz = near * p;\n\t\t\tzInv = - 1 * p;\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.Matrix4.makeOrthographic(): Invalid coordinate system: ' + coordinateSystem );\n\n\t\t}\n\n\t\tte[ 0 ] = 2 * w;\tte[ 4 ] = 0;\t\tte[ 8 ] = 0; \t\tte[ 12 ] = - x;\n\t\tte[ 1 ] = 0; \t\tte[ 5 ] = 2 * h;\tte[ 9 ] = 0; \t\tte[ 13 ] = - y;\n\t\tte[ 2 ] = 0; \t\tte[ 6 ] = 0;\t\tte[ 10 ] = zInv;\tte[ 14 ] = - z;\n\t\tte[ 3 ] = 0; \t\tte[ 7 ] = 0;\t\tte[ 11 ] = 0;\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tequals( matrix ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = matrix.elements;\n\n\t\tfor ( let i = 0; i < 16; i ++ ) {\n\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tfor ( let i = 0; i < 16; i ++ ) {\n\n\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst te = this.elements;\n\n\t\tarray[ offset ] = te[ 0 ];\n\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\tarray[ offset + 2 ] = te[ 2 ];\n\t\tarray[ offset + 3 ] = te[ 3 ];\n\n\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\tarray[ offset + 5 ] = te[ 5 ];\n\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\tarray[ offset + 7 ] = te[ 7 ];\n\n\t\tarray[ offset + 8 ] = te[ 8 ];\n\t\tarray[ offset + 9 ] = te[ 9 ];\n\t\tarray[ offset + 10 ] = te[ 10 ];\n\t\tarray[ offset + 11 ] = te[ 11 ];\n\n\t\tarray[ offset + 12 ] = te[ 12 ];\n\t\tarray[ offset + 13 ] = te[ 13 ];\n\t\tarray[ offset + 14 ] = te[ 14 ];\n\t\tarray[ offset + 15 ] = te[ 15 ];\n\n\t\treturn array;\n\n\t}\n\n}\n\nconst _v1$5 = /*@__PURE__*/ new Vector3();\nconst _m1$2 = /*@__PURE__*/ new Matrix4();\nconst _zero = /*@__PURE__*/ new Vector3( 0, 0, 0 );\nconst _one = /*@__PURE__*/ new Vector3( 1, 1, 1 );\nconst _x = /*@__PURE__*/ new Vector3();\nconst _y = /*@__PURE__*/ new Vector3();\nconst _z = /*@__PURE__*/ new Vector3();\n\nconst _matrix$2 = /*@__PURE__*/ new Matrix4();\nconst _quaternion$3 = /*@__PURE__*/ new Quaternion();\n\nclass Euler {\n\n\tconstructor( x = 0, y = 0, z = 0, order = Euler.DEFAULT_ORDER ) {\n\n\t\tthis.isEuler = true;\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._order = order;\n\n\t}\n\n\tget x() {\n\n\t\treturn this._x;\n\n\t}\n\n\tset x( value ) {\n\n\t\tthis._x = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget y() {\n\n\t\treturn this._y;\n\n\t}\n\n\tset y( value ) {\n\n\t\tthis._y = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget z() {\n\n\t\treturn this._z;\n\n\t}\n\n\tset z( value ) {\n\n\t\tthis._z = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget order() {\n\n\t\treturn this._order;\n\n\t}\n\n\tset order( value ) {\n\n\t\tthis._order = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tset( x, y, z, order = this._order ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._order = order;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this._x, this._y, this._z, this._order );\n\n\t}\n\n\tcopy( euler ) {\n\n\t\tthis._x = euler._x;\n\t\tthis._y = euler._y;\n\t\tthis._z = euler._z;\n\t\tthis._order = euler._order;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromRotationMatrix( m, order = this._order, update = true ) {\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tconst te = m.elements;\n\t\tconst m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ];\n\t\tconst m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ];\n\t\tconst m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\tswitch ( order ) {\n\n\t\t\tcase 'XYZ':\n\n\t\t\t\tthis._y = Math.asin( clamp( m13, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m13 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\t\tthis._z = Math.atan2( - m12, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\t\tthis._z = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'YXZ':\n\n\t\t\t\tthis._x = Math.asin( - clamp( m23, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m23 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\t\t\t\t\tthis._z = Math.atan2( m21, m22 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\t\t\t\t\tthis._z = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZXY':\n\n\t\t\t\tthis._x = Math.asin( clamp( m32, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m32 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._y = Math.atan2( - m31, m33 );\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._y = 0;\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZYX':\n\n\t\t\t\tthis._y = Math.asin( - clamp( m31, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m31 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m33 );\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = 0;\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'YZX':\n\n\t\t\t\tthis._z = Math.asin( clamp( m21, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m21 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m22 );\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = 0;\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'XZY':\n\n\t\t\t\tthis._z = Math.asin( - clamp( m12, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m12 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\t\tthis._y = Math.atan2( m13, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\t\tthis._y = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tconsole.warn( 'THREE.Euler: .setFromRotationMatrix() encountered an unknown order: ' + order );\n\n\t\t}\n\n\t\tthis._order = order;\n\n\t\tif ( update === true ) this._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromQuaternion( q, order, update ) {\n\n\t\t_matrix$2.makeRotationFromQuaternion( q );\n\n\t\treturn this.setFromRotationMatrix( _matrix$2, order, update );\n\n\t}\n\n\tsetFromVector3( v, order = this._order ) {\n\n\t\treturn this.set( v.x, v.y, v.z, order );\n\n\t}\n\n\treorder( newOrder ) {\n\n\t\t// WARNING: this discards revolution information -bhouston\n\n\t\t_quaternion$3.setFromEuler( this );\n\n\t\treturn this.setFromQuaternion( _quaternion$3, newOrder );\n\n\t}\n\n\tequals( euler ) {\n\n\t\treturn ( euler._x === this._x ) && ( euler._y === this._y ) && ( euler._z === this._z ) && ( euler._order === this._order );\n\n\t}\n\n\tfromArray( array ) {\n\n\t\tthis._x = array[ 0 ];\n\t\tthis._y = array[ 1 ];\n\t\tthis._z = array[ 2 ];\n\t\tif ( array[ 3 ] !== undefined ) this._order = array[ 3 ];\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this._x;\n\t\tarray[ offset + 1 ] = this._y;\n\t\tarray[ offset + 2 ] = this._z;\n\t\tarray[ offset + 3 ] = this._order;\n\n\t\treturn array;\n\n\t}\n\n\t_onChange( callback ) {\n\n\t\tthis._onChangeCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\t_onChangeCallback() {}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this._x;\n\t\tyield this._y;\n\t\tyield this._z;\n\t\tyield this._order;\n\n\t}\n\n}\n\nEuler.DEFAULT_ORDER = 'XYZ';\n\nclass Layers {\n\n\tconstructor() {\n\n\t\tthis.mask = 1 | 0;\n\n\t}\n\n\tset( channel ) {\n\n\t\tthis.mask = ( 1 << channel | 0 ) >>> 0;\n\n\t}\n\n\tenable( channel ) {\n\n\t\tthis.mask |= 1 << channel | 0;\n\n\t}\n\n\tenableAll() {\n\n\t\tthis.mask = 0xffffffff | 0;\n\n\t}\n\n\ttoggle( channel ) {\n\n\t\tthis.mask ^= 1 << channel | 0;\n\n\t}\n\n\tdisable( channel ) {\n\n\t\tthis.mask &= ~ ( 1 << channel | 0 );\n\n\t}\n\n\tdisableAll() {\n\n\t\tthis.mask = 0;\n\n\t}\n\n\ttest( layers ) {\n\n\t\treturn ( this.mask & layers.mask ) !== 0;\n\n\t}\n\n\tisEnabled( channel ) {\n\n\t\treturn ( this.mask & ( 1 << channel | 0 ) ) !== 0;\n\n\t}\n\n}\n\nlet _object3DId = 0;\n\nconst _v1$4 = /*@__PURE__*/ new Vector3();\nconst _q1 = /*@__PURE__*/ new Quaternion();\nconst _m1$1 = /*@__PURE__*/ new Matrix4();\nconst _target = /*@__PURE__*/ new Vector3();\n\nconst _position$3 = /*@__PURE__*/ new Vector3();\nconst _scale$2 = /*@__PURE__*/ new Vector3();\nconst _quaternion$2 = /*@__PURE__*/ new Quaternion();\n\nconst _xAxis = /*@__PURE__*/ new Vector3( 1, 0, 0 );\nconst _yAxis = /*@__PURE__*/ new Vector3( 0, 1, 0 );\nconst _zAxis = /*@__PURE__*/ new Vector3( 0, 0, 1 );\n\nconst _addedEvent = { type: 'added' };\nconst _removedEvent = { type: 'removed' };\n\nconst _childaddedEvent = { type: 'childadded', child: null };\nconst _childremovedEvent = { type: 'childremoved', child: null };\n\nclass Object3D extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isObject3D = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _object3DId ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'Object3D';\n\n\t\tthis.parent = null;\n\t\tthis.children = [];\n\n\t\tthis.up = Object3D.DEFAULT_UP.clone();\n\n\t\tconst position = new Vector3();\n\t\tconst rotation = new Euler();\n\t\tconst quaternion = new Quaternion();\n\t\tconst scale = new Vector3( 1, 1, 1 );\n\n\t\tfunction onRotationChange() {\n\n\t\t\tquaternion.setFromEuler( rotation, false );\n\n\t\t}\n\n\t\tfunction onQuaternionChange() {\n\n\t\t\trotation.setFromQuaternion( quaternion, undefined, false );\n\n\t\t}\n\n\t\trotation._onChange( onRotationChange );\n\t\tquaternion._onChange( onQuaternionChange );\n\n\t\tObject.defineProperties( this, {\n\t\t\tposition: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: position\n\t\t\t},\n\t\t\trotation: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: rotation\n\t\t\t},\n\t\t\tquaternion: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: quaternion\n\t\t\t},\n\t\t\tscale: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: scale\n\t\t\t},\n\t\t\tmodelViewMatrix: {\n\t\t\t\tvalue: new Matrix4()\n\t\t\t},\n\t\t\tnormalMatrix: {\n\t\t\t\tvalue: new Matrix3()\n\t\t\t}\n\t\t} );\n\n\t\tthis.matrix = new Matrix4();\n\t\tthis.matrixWorld = new Matrix4();\n\n\t\tthis.matrixAutoUpdate = Object3D.DEFAULT_MATRIX_AUTO_UPDATE;\n\n\t\tthis.matrixWorldAutoUpdate = Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE; // checked by the renderer\n\t\tthis.matrixWorldNeedsUpdate = false;\n\n\t\tthis.layers = new Layers();\n\t\tthis.visible = true;\n\n\t\tthis.castShadow = false;\n\t\tthis.receiveShadow = false;\n\n\t\tthis.frustumCulled = true;\n\t\tthis.renderOrder = 0;\n\n\t\tthis.animations = [];\n\n\t\tthis.userData = {};\n\n\t}\n\n\tonBeforeShadow( /* renderer, object, camera, shadowCamera, geometry, depthMaterial, group */ ) {}\n\n\tonAfterShadow( /* renderer, object, camera, shadowCamera, geometry, depthMaterial, group */ ) {}\n\n\tonBeforeRender( /* renderer, scene, camera, geometry, material, group */ ) {}\n\n\tonAfterRender( /* renderer, scene, camera, geometry, material, group */ ) {}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tthis.matrix.premultiply( matrix );\n\n\t\tthis.matrix.decompose( this.position, this.quaternion, this.scale );\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\tthis.quaternion.premultiply( q );\n\n\t\treturn this;\n\n\t}\n\n\tsetRotationFromAxisAngle( axis, angle ) {\n\n\t\t// assumes axis is normalized\n\n\t\tthis.quaternion.setFromAxisAngle( axis, angle );\n\n\t}\n\n\tsetRotationFromEuler( euler ) {\n\n\t\tthis.quaternion.setFromEuler( euler, true );\n\n\t}\n\n\tsetRotationFromMatrix( m ) {\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tthis.quaternion.setFromRotationMatrix( m );\n\n\t}\n\n\tsetRotationFromQuaternion( q ) {\n\n\t\t// assumes q is normalized\n\n\t\tthis.quaternion.copy( q );\n\n\t}\n\n\trotateOnAxis( axis, angle ) {\n\n\t\t// rotate object on axis in object space\n\t\t// axis is assumed to be normalized\n\n\t\t_q1.setFromAxisAngle( axis, angle );\n\n\t\tthis.quaternion.multiply( _q1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateOnWorldAxis( axis, angle ) {\n\n\t\t// rotate object on axis in world space\n\t\t// axis is assumed to be normalized\n\t\t// method assumes no rotated parent\n\n\t\t_q1.setFromAxisAngle( axis, angle );\n\n\t\tthis.quaternion.premultiply( _q1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateX( angle ) {\n\n\t\treturn this.rotateOnAxis( _xAxis, angle );\n\n\t}\n\n\trotateY( angle ) {\n\n\t\treturn this.rotateOnAxis( _yAxis, angle );\n\n\t}\n\n\trotateZ( angle ) {\n\n\t\treturn this.rotateOnAxis( _zAxis, angle );\n\n\t}\n\n\ttranslateOnAxis( axis, distance ) {\n\n\t\t// translate object by distance along axis in object space\n\t\t// axis is assumed to be normalized\n\n\t\t_v1$4.copy( axis ).applyQuaternion( this.quaternion );\n\n\t\tthis.position.add( _v1$4.multiplyScalar( distance ) );\n\n\t\treturn this;\n\n\t}\n\n\ttranslateX( distance ) {\n\n\t\treturn this.translateOnAxis( _xAxis, distance );\n\n\t}\n\n\ttranslateY( distance ) {\n\n\t\treturn this.translateOnAxis( _yAxis, distance );\n\n\t}\n\n\ttranslateZ( distance ) {\n\n\t\treturn this.translateOnAxis( _zAxis, distance );\n\n\t}\n\n\tlocalToWorld( vector ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\treturn vector.applyMatrix4( this.matrixWorld );\n\n\t}\n\n\tworldToLocal( vector ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\treturn vector.applyMatrix4( _m1$1.copy( this.matrixWorld ).invert() );\n\n\t}\n\n\tlookAt( x, y, z ) {\n\n\t\t// This method does not support objects having non-uniformly-scaled parent(s)\n\n\t\tif ( x.isVector3 ) {\n\n\t\t\t_target.copy( x );\n\n\t\t} else {\n\n\t\t\t_target.set( x, y, z );\n\n\t\t}\n\n\t\tconst parent = this.parent;\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\t_position$3.setFromMatrixPosition( this.matrixWorld );\n\n\t\tif ( this.isCamera || this.isLight ) {\n\n\t\t\t_m1$1.lookAt( _position$3, _target, this.up );\n\n\t\t} else {\n\n\t\t\t_m1$1.lookAt( _target, _position$3, this.up );\n\n\t\t}\n\n\t\tthis.quaternion.setFromRotationMatrix( _m1$1 );\n\n\t\tif ( parent ) {\n\n\t\t\t_m1$1.extractRotation( parent.matrixWorld );\n\t\t\t_q1.setFromRotationMatrix( _m1$1 );\n\t\t\tthis.quaternion.premultiply( _q1.invert() );\n\n\t\t}\n\n\t}\n\n\tadd( object ) {\n\n\t\tif ( arguments.length > 1 ) {\n\n\t\t\tfor ( let i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\tthis.add( arguments[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( object === this ) {\n\n\t\t\tconsole.error( 'THREE.Object3D.add: object can\\'t be added as a child of itself.', object );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( object && object.isObject3D ) {\n\n\t\t\tobject.removeFromParent();\n\t\t\tobject.parent = this;\n\t\t\tthis.children.push( object );\n\n\t\t\tobject.dispatchEvent( _addedEvent );\n\n\t\t\t_childaddedEvent.child = object;\n\t\t\tthis.dispatchEvent( _childaddedEvent );\n\t\t\t_childaddedEvent.child = null;\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Object3D.add: object not an instance of THREE.Object3D.', object );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremove( object ) {\n\n\t\tif ( arguments.length > 1 ) {\n\n\t\t\tfor ( let i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\tthis.remove( arguments[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst index = this.children.indexOf( object );\n\n\t\tif ( index !== - 1 ) {\n\n\t\t\tobject.parent = null;\n\t\t\tthis.children.splice( index, 1 );\n\n\t\t\tobject.dispatchEvent( _removedEvent );\n\n\t\t\t_childremovedEvent.child = object;\n\t\t\tthis.dispatchEvent( _childremovedEvent );\n\t\t\t_childremovedEvent.child = null;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremoveFromParent() {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( parent !== null ) {\n\n\t\t\tparent.remove( this );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclear() {\n\n\t\treturn this.remove( ... this.children );\n\n\t}\n\n\tattach( object ) {\n\n\t\t// adds object as a child of this, while maintaining the object's world transform\n\n\t\t// Note: This method does not support scene graphs having non-uniformly-scaled nodes(s)\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\t_m1$1.copy( this.matrixWorld ).invert();\n\n\t\tif ( object.parent !== null ) {\n\n\t\t\tobject.parent.updateWorldMatrix( true, false );\n\n\t\t\t_m1$1.multiply( object.parent.matrixWorld );\n\n\t\t}\n\n\t\tobject.applyMatrix4( _m1$1 );\n\n\t\tobject.removeFromParent();\n\t\tobject.parent = this;\n\t\tthis.children.push( object );\n\n\t\tobject.updateWorldMatrix( false, true );\n\n\t\tobject.dispatchEvent( _addedEvent );\n\n\t\t_childaddedEvent.child = object;\n\t\tthis.dispatchEvent( _childaddedEvent );\n\t\t_childaddedEvent.child = null;\n\n\t\treturn this;\n\n\t}\n\n\tgetObjectById( id ) {\n\n\t\treturn this.getObjectByProperty( 'id', id );\n\n\t}\n\n\tgetObjectByName( name ) {\n\n\t\treturn this.getObjectByProperty( 'name', name );\n\n\t}\n\n\tgetObjectByProperty( name, value ) {\n\n\t\tif ( this[ name ] === value ) return this;\n\n\t\tfor ( let i = 0, l = this.children.length; i < l; i ++ ) {\n\n\t\t\tconst child = this.children[ i ];\n\t\t\tconst object = child.getObjectByProperty( name, value );\n\n\t\t\tif ( object !== undefined ) {\n\n\t\t\t\treturn object;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn undefined;\n\n\t}\n\n\tgetObjectsByProperty( name, value, result = [] ) {\n\n\t\tif ( this[ name ] === value ) result.push( this );\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].getObjectsByProperty( name, value, result );\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tgetWorldPosition( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\treturn target.setFromMatrixPosition( this.matrixWorld );\n\n\t}\n\n\tgetWorldQuaternion( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tthis.matrixWorld.decompose( _position$3, target, _scale$2 );\n\n\t\treturn target;\n\n\t}\n\n\tgetWorldScale( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tthis.matrixWorld.decompose( _position$3, _quaternion$2, target );\n\n\t\treturn target;\n\n\t}\n\n\tgetWorldDirection( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tconst e = this.matrixWorld.elements;\n\n\t\treturn target.set( e[ 8 ], e[ 9 ], e[ 10 ] ).normalize();\n\n\t}\n\n\traycast( /* raycaster, intersects */ ) {}\n\n\ttraverse( callback ) {\n\n\t\tcallback( this );\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].traverse( callback );\n\n\t\t}\n\n\t}\n\n\ttraverseVisible( callback ) {\n\n\t\tif ( this.visible === false ) return;\n\n\t\tcallback( this );\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].traverseVisible( callback );\n\n\t\t}\n\n\t}\n\n\ttraverseAncestors( callback ) {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( parent !== null ) {\n\n\t\t\tcallback( parent );\n\n\t\t\tparent.traverseAncestors( callback );\n\n\t\t}\n\n\t}\n\n\tupdateMatrix() {\n\n\t\tthis.matrix.compose( this.position, this.quaternion, this.scale );\n\n\t\tthis.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tif ( this.matrixWorldNeedsUpdate || force ) {\n\n\t\t\tif ( this.matrixWorldAutoUpdate === true ) {\n\n\t\t\t\tif ( this.parent === null ) {\n\n\t\t\t\t\tthis.matrixWorld.copy( this.matrix );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.matrixWorldNeedsUpdate = false;\n\n\t\t\tforce = true;\n\n\t\t}\n\n\t\t// make sure descendants are updated if required\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tconst child = children[ i ];\n\n\t\t\tchild.updateMatrixWorld( force );\n\n\t\t}\n\n\t}\n\n\tupdateWorldMatrix( updateParents, updateChildren ) {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( updateParents === true && parent !== null ) {\n\n\t\t\tparent.updateWorldMatrix( true, false );\n\n\t\t}\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tif ( this.matrixWorldAutoUpdate === true ) {\n\n\t\t\tif ( this.parent === null ) {\n\n\t\t\t\tthis.matrixWorld.copy( this.matrix );\n\n\t\t\t} else {\n\n\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// make sure descendants are updated\n\n\t\tif ( updateChildren === true ) {\n\n\t\t\tconst children = this.children;\n\n\t\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tconst child = children[ i ];\n\n\t\t\t\tchild.updateWorldMatrix( false, true );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\t// meta is a string when called from JSON.stringify\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tconst output = {};\n\n\t\t// meta is a hash used to collect geometries, materials.\n\t\t// not providing it implies that this is the root object\n\t\t// being serialized.\n\t\tif ( isRootObject ) {\n\n\t\t\t// initialize meta obj\n\t\t\tmeta = {\n\t\t\t\tgeometries: {},\n\t\t\t\tmaterials: {},\n\t\t\t\ttextures: {},\n\t\t\t\timages: {},\n\t\t\t\tshapes: {},\n\t\t\t\tskeletons: {},\n\t\t\t\tanimations: {},\n\t\t\t\tnodes: {}\n\t\t\t};\n\n\t\t\toutput.metadata = {\n\t\t\t\tversion: 4.6,\n\t\t\t\ttype: 'Object',\n\t\t\t\tgenerator: 'Object3D.toJSON'\n\t\t\t};\n\n\t\t}\n\n\t\t// standard Object3D serialization\n\n\t\tconst object = {};\n\n\t\tobject.uuid = this.uuid;\n\t\tobject.type = this.type;\n\n\t\tif ( this.name !== '' ) object.name = this.name;\n\t\tif ( this.castShadow === true ) object.castShadow = true;\n\t\tif ( this.receiveShadow === true ) object.receiveShadow = true;\n\t\tif ( this.visible === false ) object.visible = false;\n\t\tif ( this.frustumCulled === false ) object.frustumCulled = false;\n\t\tif ( this.renderOrder !== 0 ) object.renderOrder = this.renderOrder;\n\t\tif ( Object.keys( this.userData ).length > 0 ) object.userData = this.userData;\n\n\t\tobject.layers = this.layers.mask;\n\t\tobject.matrix = this.matrix.toArray();\n\t\tobject.up = this.up.toArray();\n\n\t\tif ( this.matrixAutoUpdate === false ) object.matrixAutoUpdate = false;\n\n\t\t// object specific properties\n\n\t\tif ( this.isInstancedMesh ) {\n\n\t\t\tobject.type = 'InstancedMesh';\n\t\t\tobject.count = this.count;\n\t\t\tobject.instanceMatrix = this.instanceMatrix.toJSON();\n\t\t\tif ( this.instanceColor !== null ) object.instanceColor = this.instanceColor.toJSON();\n\n\t\t}\n\n\t\tif ( this.isBatchedMesh ) {\n\n\t\t\tobject.type = 'BatchedMesh';\n\t\t\tobject.perObjectFrustumCulled = this.perObjectFrustumCulled;\n\t\t\tobject.sortObjects = this.sortObjects;\n\n\t\t\tobject.drawRanges = this._drawRanges;\n\t\t\tobject.reservedRanges = this._reservedRanges;\n\n\t\t\tobject.visibility = this._visibility;\n\t\t\tobject.active = this._active;\n\t\t\tobject.bounds = this._bounds.map( bound => ( {\n\t\t\t\tboxInitialized: bound.boxInitialized,\n\t\t\t\tboxMin: bound.box.min.toArray(),\n\t\t\t\tboxMax: bound.box.max.toArray(),\n\n\t\t\t\tsphereInitialized: bound.sphereInitialized,\n\t\t\t\tsphereRadius: bound.sphere.radius,\n\t\t\t\tsphereCenter: bound.sphere.center.toArray()\n\t\t\t} ) );\n\n\t\t\tobject.maxInstanceCount = this._maxInstanceCount;\n\t\t\tobject.maxVertexCount = this._maxVertexCount;\n\t\t\tobject.maxIndexCount = this._maxIndexCount;\n\n\t\t\tobject.geometryInitialized = this._geometryInitialized;\n\t\t\tobject.geometryCount = this._geometryCount;\n\n\t\t\tobject.matricesTexture = this._matricesTexture.toJSON( meta );\n\n\t\t\tif ( this._colorsTexture !== null ) object.colorsTexture = this._colorsTexture.toJSON( meta );\n\n\t\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\t\tobject.boundingSphere = {\n\t\t\t\t\tcenter: object.boundingSphere.center.toArray(),\n\t\t\t\t\tradius: object.boundingSphere.radius\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\tif ( this.boundingBox !== null ) {\n\n\t\t\t\tobject.boundingBox = {\n\t\t\t\t\tmin: object.boundingBox.min.toArray(),\n\t\t\t\t\tmax: object.boundingBox.max.toArray()\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tfunction serialize( library, element ) {\n\n\t\t\tif ( library[ element.uuid ] === undefined ) {\n\n\t\t\t\tlibrary[ element.uuid ] = element.toJSON( meta );\n\n\t\t\t}\n\n\t\t\treturn element.uuid;\n\n\t\t}\n\n\t\tif ( this.isScene ) {\n\n\t\t\tif ( this.background ) {\n\n\t\t\t\tif ( this.background.isColor ) {\n\n\t\t\t\t\tobject.background = this.background.toJSON();\n\n\t\t\t\t} else if ( this.background.isTexture ) {\n\n\t\t\t\t\tobject.background = this.background.toJSON( meta ).uuid;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.environment && this.environment.isTexture && this.environment.isRenderTargetTexture !== true ) {\n\n\t\t\t\tobject.environment = this.environment.toJSON( meta ).uuid;\n\n\t\t\t}\n\n\t\t} else if ( this.isMesh || this.isLine || this.isPoints ) {\n\n\t\t\tobject.geometry = serialize( meta.geometries, this.geometry );\n\n\t\t\tconst parameters = this.geometry.parameters;\n\n\t\t\tif ( parameters !== undefined && parameters.shapes !== undefined ) {\n\n\t\t\t\tconst shapes = parameters.shapes;\n\n\t\t\t\tif ( Array.isArray( shapes ) ) {\n\n\t\t\t\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\t\t\t\tconst shape = shapes[ i ];\n\n\t\t\t\t\t\tserialize( meta.shapes, shape );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tserialize( meta.shapes, shapes );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.isSkinnedMesh ) {\n\n\t\t\tobject.bindMode = this.bindMode;\n\t\t\tobject.bindMatrix = this.bindMatrix.toArray();\n\n\t\t\tif ( this.skeleton !== undefined ) {\n\n\t\t\t\tserialize( meta.skeletons, this.skeleton );\n\n\t\t\t\tobject.skeleton = this.skeleton.uuid;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.material !== undefined ) {\n\n\t\t\tif ( Array.isArray( this.material ) ) {\n\n\t\t\t\tconst uuids = [];\n\n\t\t\t\tfor ( let i = 0, l = this.material.length; i < l; i ++ ) {\n\n\t\t\t\t\tuuids.push( serialize( meta.materials, this.material[ i ] ) );\n\n\t\t\t\t}\n\n\t\t\t\tobject.material = uuids;\n\n\t\t\t} else {\n\n\t\t\t\tobject.material = serialize( meta.materials, this.material );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.children.length > 0 ) {\n\n\t\t\tobject.children = [];\n\n\t\t\tfor ( let i = 0; i < this.children.length; i ++ ) {\n\n\t\t\t\tobject.children.push( this.children[ i ].toJSON( meta ).object );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.animations.length > 0 ) {\n\n\t\t\tobject.animations = [];\n\n\t\t\tfor ( let i = 0; i < this.animations.length; i ++ ) {\n\n\t\t\t\tconst animation = this.animations[ i ];\n\n\t\t\t\tobject.animations.push( serialize( meta.animations, animation ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( isRootObject ) {\n\n\t\t\tconst geometries = extractFromCache( meta.geometries );\n\t\t\tconst materials = extractFromCache( meta.materials );\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\t\t\tconst shapes = extractFromCache( meta.shapes );\n\t\t\tconst skeletons = extractFromCache( meta.skeletons );\n\t\t\tconst animations = extractFromCache( meta.animations );\n\t\t\tconst nodes = extractFromCache( meta.nodes );\n\n\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\n\t\t\tif ( materials.length > 0 ) output.materials = materials;\n\t\t\tif ( textures.length > 0 ) output.textures = textures;\n\t\t\tif ( images.length > 0 ) output.images = images;\n\t\t\tif ( shapes.length > 0 ) output.shapes = shapes;\n\t\t\tif ( skeletons.length > 0 ) output.skeletons = skeletons;\n\t\t\tif ( animations.length > 0 ) output.animations = animations;\n\t\t\tif ( nodes.length > 0 ) output.nodes = nodes;\n\n\t\t}\n\n\t\toutput.object = object;\n\n\t\treturn output;\n\n\t\t// extract data from the cache hash\n\t\t// remove metadata on each item\n\t\t// and return as array\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t}\n\n\tclone( recursive ) {\n\n\t\treturn new this.constructor().copy( this, recursive );\n\n\t}\n\n\tcopy( source, recursive = true ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.up.copy( source.up );\n\n\t\tthis.position.copy( source.position );\n\t\tthis.rotation.order = source.rotation.order;\n\t\tthis.quaternion.copy( source.quaternion );\n\t\tthis.scale.copy( source.scale );\n\n\t\tthis.matrix.copy( source.matrix );\n\t\tthis.matrixWorld.copy( source.matrixWorld );\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\n\t\tthis.matrixWorldAutoUpdate = source.matrixWorldAutoUpdate;\n\t\tthis.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\n\n\t\tthis.layers.mask = source.layers.mask;\n\t\tthis.visible = source.visible;\n\n\t\tthis.castShadow = source.castShadow;\n\t\tthis.receiveShadow = source.receiveShadow;\n\n\t\tthis.frustumCulled = source.frustumCulled;\n\t\tthis.renderOrder = source.renderOrder;\n\n\t\tthis.animations = source.animations.slice();\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\tif ( recursive === true ) {\n\n\t\t\tfor ( let i = 0; i < source.children.length; i ++ ) {\n\n\t\t\t\tconst child = source.children[ i ];\n\t\t\t\tthis.add( child.clone() );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nObject3D.DEFAULT_UP = /*@__PURE__*/ new Vector3( 0, 1, 0 );\nObject3D.DEFAULT_MATRIX_AUTO_UPDATE = true;\nObject3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE = true;\n\nconst _v0$1 = /*@__PURE__*/ new Vector3();\nconst _v1$3 = /*@__PURE__*/ new Vector3();\nconst _v2$2 = /*@__PURE__*/ new Vector3();\nconst _v3$2 = /*@__PURE__*/ new Vector3();\n\nconst _vab = /*@__PURE__*/ new Vector3();\nconst _vac = /*@__PURE__*/ new Vector3();\nconst _vbc = /*@__PURE__*/ new Vector3();\nconst _vap = /*@__PURE__*/ new Vector3();\nconst _vbp = /*@__PURE__*/ new Vector3();\nconst _vcp = /*@__PURE__*/ new Vector3();\n\nconst _v40 = /*@__PURE__*/ new Vector4();\nconst _v41 = /*@__PURE__*/ new Vector4();\nconst _v42 = /*@__PURE__*/ new Vector4();\n\nclass Triangle {\n\n\tconstructor( a = new Vector3(), b = new Vector3(), c = new Vector3() ) {\n\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.c = c;\n\n\t}\n\n\tstatic getNormal( a, b, c, target ) {\n\n\t\ttarget.subVectors( c, b );\n\t\t_v0$1.subVectors( a, b );\n\t\ttarget.cross( _v0$1 );\n\n\t\tconst targetLengthSq = target.lengthSq();\n\t\tif ( targetLengthSq > 0 ) {\n\n\t\t\treturn target.multiplyScalar( 1 / Math.sqrt( targetLengthSq ) );\n\n\t\t}\n\n\t\treturn target.set( 0, 0, 0 );\n\n\t}\n\n\t// static/instance method to calculate barycentric coordinates\n\t// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\n\tstatic getBarycoord( point, a, b, c, target ) {\n\n\t\t_v0$1.subVectors( c, a );\n\t\t_v1$3.subVectors( b, a );\n\t\t_v2$2.subVectors( point, a );\n\n\t\tconst dot00 = _v0$1.dot( _v0$1 );\n\t\tconst dot01 = _v0$1.dot( _v1$3 );\n\t\tconst dot02 = _v0$1.dot( _v2$2 );\n\t\tconst dot11 = _v1$3.dot( _v1$3 );\n\t\tconst dot12 = _v1$3.dot( _v2$2 );\n\n\t\tconst denom = ( dot00 * dot11 - dot01 * dot01 );\n\n\t\t// collinear or singular triangle\n\t\tif ( denom === 0 ) {\n\n\t\t\ttarget.set( 0, 0, 0 );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst invDenom = 1 / denom;\n\t\tconst u = ( dot11 * dot02 - dot01 * dot12 ) * invDenom;\n\t\tconst v = ( dot00 * dot12 - dot01 * dot02 ) * invDenom;\n\n\t\t// barycentric coordinates must always sum to 1\n\t\treturn target.set( 1 - u - v, v, u );\n\n\t}\n\n\tstatic containsPoint( point, a, b, c ) {\n\n\t\t// if the triangle is degenerate then we can't contain a point\n\t\tif ( this.getBarycoord( point, a, b, c, _v3$2 ) === null ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\treturn ( _v3$2.x >= 0 ) && ( _v3$2.y >= 0 ) && ( ( _v3$2.x + _v3$2.y ) <= 1 );\n\n\t}\n\n\tstatic getInterpolation( point, p1, p2, p3, v1, v2, v3, target ) {\n\n\t\tif ( this.getBarycoord( point, p1, p2, p3, _v3$2 ) === null ) {\n\n\t\t\ttarget.x = 0;\n\t\t\ttarget.y = 0;\n\t\t\tif ( 'z' in target ) target.z = 0;\n\t\t\tif ( 'w' in target ) target.w = 0;\n\t\t\treturn null;\n\n\t\t}\n\n\t\ttarget.setScalar( 0 );\n\t\ttarget.addScaledVector( v1, _v3$2.x );\n\t\ttarget.addScaledVector( v2, _v3$2.y );\n\t\ttarget.addScaledVector( v3, _v3$2.z );\n\n\t\treturn target;\n\n\t}\n\n\tstatic getInterpolatedAttribute( attr, i1, i2, i3, barycoord, target ) {\n\n\t\t_v40.setScalar( 0 );\n\t\t_v41.setScalar( 0 );\n\t\t_v42.setScalar( 0 );\n\n\t\t_v40.fromBufferAttribute( attr, i1 );\n\t\t_v41.fromBufferAttribute( attr, i2 );\n\t\t_v42.fromBufferAttribute( attr, i3 );\n\n\t\ttarget.setScalar( 0 );\n\t\ttarget.addScaledVector( _v40, barycoord.x );\n\t\ttarget.addScaledVector( _v41, barycoord.y );\n\t\ttarget.addScaledVector( _v42, barycoord.z );\n\n\t\treturn target;\n\n\t}\n\n\tstatic isFrontFacing( a, b, c, direction ) {\n\n\t\t_v0$1.subVectors( c, b );\n\t\t_v1$3.subVectors( a, b );\n\n\t\t// strictly front facing\n\t\treturn ( _v0$1.cross( _v1$3 ).dot( direction ) < 0 ) ? true : false;\n\n\t}\n\n\tset( a, b, c ) {\n\n\t\tthis.a.copy( a );\n\t\tthis.b.copy( b );\n\t\tthis.c.copy( c );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPointsAndIndices( points, i0, i1, i2 ) {\n\n\t\tthis.a.copy( points[ i0 ] );\n\t\tthis.b.copy( points[ i1 ] );\n\t\tthis.c.copy( points[ i2 ] );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromAttributeAndIndices( attribute, i0, i1, i2 ) {\n\n\t\tthis.a.fromBufferAttribute( attribute, i0 );\n\t\tthis.b.fromBufferAttribute( attribute, i1 );\n\t\tthis.c.fromBufferAttribute( attribute, i2 );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( triangle ) {\n\n\t\tthis.a.copy( triangle.a );\n\t\tthis.b.copy( triangle.b );\n\t\tthis.c.copy( triangle.c );\n\n\t\treturn this;\n\n\t}\n\n\tgetArea() {\n\n\t\t_v0$1.subVectors( this.c, this.b );\n\t\t_v1$3.subVectors( this.a, this.b );\n\n\t\treturn _v0$1.cross( _v1$3 ).length() * 0.5;\n\n\t}\n\n\tgetMidpoint( target ) {\n\n\t\treturn target.addVectors( this.a, this.b ).add( this.c ).multiplyScalar( 1 / 3 );\n\n\t}\n\n\tgetNormal( target ) {\n\n\t\treturn Triangle.getNormal( this.a, this.b, this.c, target );\n\n\t}\n\n\tgetPlane( target ) {\n\n\t\treturn target.setFromCoplanarPoints( this.a, this.b, this.c );\n\n\t}\n\n\tgetBarycoord( point, target ) {\n\n\t\treturn Triangle.getBarycoord( point, this.a, this.b, this.c, target );\n\n\t}\n\n\tgetInterpolation( point, v1, v2, v3, target ) {\n\n\t\treturn Triangle.getInterpolation( point, this.a, this.b, this.c, v1, v2, v3, target );\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn Triangle.containsPoint( point, this.a, this.b, this.c );\n\n\t}\n\n\tisFrontFacing( direction ) {\n\n\t\treturn Triangle.isFrontFacing( this.a, this.b, this.c, direction );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsTriangle( this );\n\n\t}\n\n\tclosestPointToPoint( p, target ) {\n\n\t\tconst a = this.a, b = this.b, c = this.c;\n\t\tlet v, w;\n\n\t\t// algorithm thanks to Real-Time Collision Detection by Christer Ericson,\n\t\t// published by Morgan Kaufmann Publishers, (c) 2005 Elsevier Inc.,\n\t\t// under the accompanying license; see chapter 5.1.5 for detailed explanation.\n\t\t// basically, we're distinguishing which of the voronoi regions of the triangle\n\t\t// the point lies in with the minimum amount of redundant computation.\n\n\t\t_vab.subVectors( b, a );\n\t\t_vac.subVectors( c, a );\n\t\t_vap.subVectors( p, a );\n\t\tconst d1 = _vab.dot( _vap );\n\t\tconst d2 = _vac.dot( _vap );\n\t\tif ( d1 <= 0 && d2 <= 0 ) {\n\n\t\t\t// vertex region of A; barycentric coords (1, 0, 0)\n\t\t\treturn target.copy( a );\n\n\t\t}\n\n\t\t_vbp.subVectors( p, b );\n\t\tconst d3 = _vab.dot( _vbp );\n\t\tconst d4 = _vac.dot( _vbp );\n\t\tif ( d3 >= 0 && d4 <= d3 ) {\n\n\t\t\t// vertex region of B; barycentric coords (0, 1, 0)\n\t\t\treturn target.copy( b );\n\n\t\t}\n\n\t\tconst vc = d1 * d4 - d3 * d2;\n\t\tif ( vc <= 0 && d1 >= 0 && d3 <= 0 ) {\n\n\t\t\tv = d1 / ( d1 - d3 );\n\t\t\t// edge region of AB; barycentric coords (1-v, v, 0)\n\t\t\treturn target.copy( a ).addScaledVector( _vab, v );\n\n\t\t}\n\n\t\t_vcp.subVectors( p, c );\n\t\tconst d5 = _vab.dot( _vcp );\n\t\tconst d6 = _vac.dot( _vcp );\n\t\tif ( d6 >= 0 && d5 <= d6 ) {\n\n\t\t\t// vertex region of C; barycentric coords (0, 0, 1)\n\t\t\treturn target.copy( c );\n\n\t\t}\n\n\t\tconst vb = d5 * d2 - d1 * d6;\n\t\tif ( vb <= 0 && d2 >= 0 && d6 <= 0 ) {\n\n\t\t\tw = d2 / ( d2 - d6 );\n\t\t\t// edge region of AC; barycentric coords (1-w, 0, w)\n\t\t\treturn target.copy( a ).addScaledVector( _vac, w );\n\n\t\t}\n\n\t\tconst va = d3 * d6 - d5 * d4;\n\t\tif ( va <= 0 && ( d4 - d3 ) >= 0 && ( d5 - d6 ) >= 0 ) {\n\n\t\t\t_vbc.subVectors( c, b );\n\t\t\tw = ( d4 - d3 ) / ( ( d4 - d3 ) + ( d5 - d6 ) );\n\t\t\t// edge region of BC; barycentric coords (0, 1-w, w)\n\t\t\treturn target.copy( b ).addScaledVector( _vbc, w ); // edge region of BC\n\n\t\t}\n\n\t\t// face region\n\t\tconst denom = 1 / ( va + vb + vc );\n\t\t// u = va * denom\n\t\tv = vb * denom;\n\t\tw = vc * denom;\n\n\t\treturn target.copy( a ).addScaledVector( _vab, v ).addScaledVector( _vac, w );\n\n\t}\n\n\tequals( triangle ) {\n\n\t\treturn triangle.a.equals( this.a ) && triangle.b.equals( this.b ) && triangle.c.equals( this.c );\n\n\t}\n\n}\n\nconst _colorKeywords = { 'aliceblue': 0xF0F8FF, 'antiquewhite': 0xFAEBD7, 'aqua': 0x00FFFF, 'aquamarine': 0x7FFFD4, 'azure': 0xF0FFFF,\n\t'beige': 0xF5F5DC, 'bisque': 0xFFE4C4, 'black': 0x000000, 'blanchedalmond': 0xFFEBCD, 'blue': 0x0000FF, 'blueviolet': 0x8A2BE2,\n\t'brown': 0xA52A2A, 'burlywood': 0xDEB887, 'cadetblue': 0x5F9EA0, 'chartreuse': 0x7FFF00, 'chocolate': 0xD2691E, 'coral': 0xFF7F50,\n\t'cornflowerblue': 0x6495ED, 'cornsilk': 0xFFF8DC, 'crimson': 0xDC143C, 'cyan': 0x00FFFF, 'darkblue': 0x00008B, 'darkcyan': 0x008B8B,\n\t'darkgoldenrod': 0xB8860B, 'darkgray': 0xA9A9A9, 'darkgreen': 0x006400, 'darkgrey': 0xA9A9A9, 'darkkhaki': 0xBDB76B, 'darkmagenta': 0x8B008B,\n\t'darkolivegreen': 0x556B2F, 'darkorange': 0xFF8C00, 'darkorchid': 0x9932CC, 'darkred': 0x8B0000, 'darksalmon': 0xE9967A, 'darkseagreen': 0x8FBC8F,\n\t'darkslateblue': 0x483D8B, 'darkslategray': 0x2F4F4F, 'darkslategrey': 0x2F4F4F, 'darkturquoise': 0x00CED1, 'darkviolet': 0x9400D3,\n\t'deeppink': 0xFF1493, 'deepskyblue': 0x00BFFF, 'dimgray': 0x696969, 'dimgrey': 0x696969, 'dodgerblue': 0x1E90FF, 'firebrick': 0xB22222,\n\t'floralwhite': 0xFFFAF0, 'forestgreen': 0x228B22, 'fuchsia': 0xFF00FF, 'gainsboro': 0xDCDCDC, 'ghostwhite': 0xF8F8FF, 'gold': 0xFFD700,\n\t'goldenrod': 0xDAA520, 'gray': 0x808080, 'green': 0x008000, 'greenyellow': 0xADFF2F, 'grey': 0x808080, 'honeydew': 0xF0FFF0, 'hotpink': 0xFF69B4,\n\t'indianred': 0xCD5C5C, 'indigo': 0x4B0082, 'ivory': 0xFFFFF0, 'khaki': 0xF0E68C, 'lavender': 0xE6E6FA, 'lavenderblush': 0xFFF0F5, 'lawngreen': 0x7CFC00,\n\t'lemonchiffon': 0xFFFACD, 'lightblue': 0xADD8E6, 'lightcoral': 0xF08080, 'lightcyan': 0xE0FFFF, 'lightgoldenrodyellow': 0xFAFAD2, 'lightgray': 0xD3D3D3,\n\t'lightgreen': 0x90EE90, 'lightgrey': 0xD3D3D3, 'lightpink': 0xFFB6C1, 'lightsalmon': 0xFFA07A, 'lightseagreen': 0x20B2AA, 'lightskyblue': 0x87CEFA,\n\t'lightslategray': 0x778899, 'lightslategrey': 0x778899, 'lightsteelblue': 0xB0C4DE, 'lightyellow': 0xFFFFE0, 'lime': 0x00FF00, 'limegreen': 0x32CD32,\n\t'linen': 0xFAF0E6, 'magenta': 0xFF00FF, 'maroon': 0x800000, 'mediumaquamarine': 0x66CDAA, 'mediumblue': 0x0000CD, 'mediumorchid': 0xBA55D3,\n\t'mediumpurple': 0x9370DB, 'mediumseagreen': 0x3CB371, 'mediumslateblue': 0x7B68EE, 'mediumspringgreen': 0x00FA9A, 'mediumturquoise': 0x48D1CC,\n\t'mediumvioletred': 0xC71585, 'midnightblue': 0x191970, 'mintcream': 0xF5FFFA, 'mistyrose': 0xFFE4E1, 'moccasin': 0xFFE4B5, 'navajowhite': 0xFFDEAD,\n\t'navy': 0x000080, 'oldlace': 0xFDF5E6, 'olive': 0x808000, 'olivedrab': 0x6B8E23, 'orange': 0xFFA500, 'orangered': 0xFF4500, 'orchid': 0xDA70D6,\n\t'palegoldenrod': 0xEEE8AA, 'palegreen': 0x98FB98, 'paleturquoise': 0xAFEEEE, 'palevioletred': 0xDB7093, 'papayawhip': 0xFFEFD5, 'peachpuff': 0xFFDAB9,\n\t'peru': 0xCD853F, 'pink': 0xFFC0CB, 'plum': 0xDDA0DD, 'powderblue': 0xB0E0E6, 'purple': 0x800080, 'rebeccapurple': 0x663399, 'red': 0xFF0000, 'rosybrown': 0xBC8F8F,\n\t'royalblue': 0x4169E1, 'saddlebrown': 0x8B4513, 'salmon': 0xFA8072, 'sandybrown': 0xF4A460, 'seagreen': 0x2E8B57, 'seashell': 0xFFF5EE,\n\t'sienna': 0xA0522D, 'silver': 0xC0C0C0, 'skyblue': 0x87CEEB, 'slateblue': 0x6A5ACD, 'slategray': 0x708090, 'slategrey': 0x708090, 'snow': 0xFFFAFA,\n\t'springgreen': 0x00FF7F, 'steelblue': 0x4682B4, 'tan': 0xD2B48C, 'teal': 0x008080, 'thistle': 0xD8BFD8, 'tomato': 0xFF6347, 'turquoise': 0x40E0D0,\n\t'violet': 0xEE82EE, 'wheat': 0xF5DEB3, 'white': 0xFFFFFF, 'whitesmoke': 0xF5F5F5, 'yellow': 0xFFFF00, 'yellowgreen': 0x9ACD32 };\n\nconst _hslA = { h: 0, s: 0, l: 0 };\nconst _hslB = { h: 0, s: 0, l: 0 };\n\nfunction hue2rgb( p, q, t ) {\n\n\tif ( t < 0 ) t += 1;\n\tif ( t > 1 ) t -= 1;\n\tif ( t < 1 / 6 ) return p + ( q - p ) * 6 * t;\n\tif ( t < 1 / 2 ) return q;\n\tif ( t < 2 / 3 ) return p + ( q - p ) * 6 * ( 2 / 3 - t );\n\treturn p;\n\n}\n\nclass Color {\n\n\tconstructor( r, g, b ) {\n\n\t\tthis.isColor = true;\n\n\t\tthis.r = 1;\n\t\tthis.g = 1;\n\t\tthis.b = 1;\n\n\t\treturn this.set( r, g, b );\n\n\t}\n\n\tset( r, g, b ) {\n\n\t\tif ( g === undefined && b === undefined ) {\n\n\t\t\t// r is THREE.Color, hex or string\n\n\t\t\tconst value = r;\n\n\t\t\tif ( value && value.isColor ) {\n\n\t\t\t\tthis.copy( value );\n\n\t\t\t} else if ( typeof value === 'number' ) {\n\n\t\t\t\tthis.setHex( value );\n\n\t\t\t} else if ( typeof value === 'string' ) {\n\n\t\t\t\tthis.setStyle( value );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis.setRGB( r, g, b );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.r = scalar;\n\t\tthis.g = scalar;\n\t\tthis.b = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetHex( hex, colorSpace = SRGBColorSpace ) {\n\n\t\thex = Math.floor( hex );\n\n\t\tthis.r = ( hex >> 16 & 255 ) / 255;\n\t\tthis.g = ( hex >> 8 & 255 ) / 255;\n\t\tthis.b = ( hex & 255 ) / 255;\n\n\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\treturn this;\n\n\t}\n\n\tsetRGB( r, g, b, colorSpace = ColorManagement.workingColorSpace ) {\n\n\t\tthis.r = r;\n\t\tthis.g = g;\n\t\tthis.b = b;\n\n\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\treturn this;\n\n\t}\n\n\tsetHSL( h, s, l, colorSpace = ColorManagement.workingColorSpace ) {\n\n\t\t// h,s,l ranges are in 0.0 - 1.0\n\t\th = euclideanModulo( h, 1 );\n\t\ts = clamp( s, 0, 1 );\n\t\tl = clamp( l, 0, 1 );\n\n\t\tif ( s === 0 ) {\n\n\t\t\tthis.r = this.g = this.b = l;\n\n\t\t} else {\n\n\t\t\tconst p = l <= 0.5 ? l * ( 1 + s ) : l + s - ( l * s );\n\t\t\tconst q = ( 2 * l ) - p;\n\n\t\t\tthis.r = hue2rgb( q, p, h + 1 / 3 );\n\t\t\tthis.g = hue2rgb( q, p, h );\n\t\t\tthis.b = hue2rgb( q, p, h - 1 / 3 );\n\n\t\t}\n\n\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\treturn this;\n\n\t}\n\n\tsetStyle( style, colorSpace = SRGBColorSpace ) {\n\n\t\tfunction handleAlpha( string ) {\n\n\t\t\tif ( string === undefined ) return;\n\n\t\t\tif ( parseFloat( string ) < 1 ) {\n\n\t\t\t\tconsole.warn( 'THREE.Color: Alpha component of ' + style + ' will be ignored.' );\n\n\t\t\t}\n\n\t\t}\n\n\n\t\tlet m;\n\n\t\tif ( m = /^(\\w+)\\(([^\\)]*)\\)/.exec( style ) ) {\n\n\t\t\t// rgb / hsl\n\n\t\t\tlet color;\n\t\t\tconst name = m[ 1 ];\n\t\t\tconst components = m[ 2 ];\n\n\t\t\tswitch ( name ) {\n\n\t\t\t\tcase 'rgb':\n\t\t\t\tcase 'rgba':\n\n\t\t\t\t\tif ( color = /^\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgb(255,0,0) rgba(255,0,0,0.5)\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this.setRGB(\n\t\t\t\t\t\t\tMath.min( 255, parseInt( color[ 1 ], 10 ) ) / 255,\n\t\t\t\t\t\t\tMath.min( 255, parseInt( color[ 2 ], 10 ) ) / 255,\n\t\t\t\t\t\t\tMath.min( 255, parseInt( color[ 3 ], 10 ) ) / 255,\n\t\t\t\t\t\t\tcolorSpace\n\t\t\t\t\t\t);\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( color = /^\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgb(100%,0%,0%) rgba(100%,0%,0%,0.5)\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this.setRGB(\n\t\t\t\t\t\t\tMath.min( 100, parseInt( color[ 1 ], 10 ) ) / 100,\n\t\t\t\t\t\t\tMath.min( 100, parseInt( color[ 2 ], 10 ) ) / 100,\n\t\t\t\t\t\t\tMath.min( 100, parseInt( color[ 3 ], 10 ) ) / 100,\n\t\t\t\t\t\t\tcolorSpace\n\t\t\t\t\t\t);\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'hsl':\n\t\t\t\tcase 'hsla':\n\n\t\t\t\t\tif ( color = /^\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d*\\.?\\d+)\\%\\s*,\\s*(\\d*\\.?\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// hsl(120,50%,50%) hsla(120,50%,50%,0.5)\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this.setHSL(\n\t\t\t\t\t\t\tparseFloat( color[ 1 ] ) / 360,\n\t\t\t\t\t\t\tparseFloat( color[ 2 ] ) / 100,\n\t\t\t\t\t\t\tparseFloat( color[ 3 ] ) / 100,\n\t\t\t\t\t\t\tcolorSpace\n\t\t\t\t\t\t);\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tconsole.warn( 'THREE.Color: Unknown color model ' + style );\n\n\t\t\t}\n\n\t\t} else if ( m = /^\\#([A-Fa-f\\d]+)$/.exec( style ) ) {\n\n\t\t\t// hex color\n\n\t\t\tconst hex = m[ 1 ];\n\t\t\tconst size = hex.length;\n\n\t\t\tif ( size === 3 ) {\n\n\t\t\t\t// #ff0\n\t\t\t\treturn this.setRGB(\n\t\t\t\t\tparseInt( hex.charAt( 0 ), 16 ) / 15,\n\t\t\t\t\tparseInt( hex.charAt( 1 ), 16 ) / 15,\n\t\t\t\t\tparseInt( hex.charAt( 2 ), 16 ) / 15,\n\t\t\t\t\tcolorSpace\n\t\t\t\t);\n\n\t\t\t} else if ( size === 6 ) {\n\n\t\t\t\t// #ff0000\n\t\t\t\treturn this.setHex( parseInt( hex, 16 ), colorSpace );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.Color: Invalid hex color ' + style );\n\n\t\t\t}\n\n\t\t} else if ( style && style.length > 0 ) {\n\n\t\t\treturn this.setColorName( style, colorSpace );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetColorName( style, colorSpace = SRGBColorSpace ) {\n\n\t\t// color keywords\n\t\tconst hex = _colorKeywords[ style.toLowerCase() ];\n\n\t\tif ( hex !== undefined ) {\n\n\t\t\t// red\n\t\t\tthis.setHex( hex, colorSpace );\n\n\t\t} else {\n\n\t\t\t// unknown color\n\t\t\tconsole.warn( 'THREE.Color: Unknown color ' + style );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.r, this.g, this.b );\n\n\t}\n\n\tcopy( color ) {\n\n\t\tthis.r = color.r;\n\t\tthis.g = color.g;\n\t\tthis.b = color.b;\n\n\t\treturn this;\n\n\t}\n\n\tcopySRGBToLinear( color ) {\n\n\t\tthis.r = SRGBToLinear( color.r );\n\t\tthis.g = SRGBToLinear( color.g );\n\t\tthis.b = SRGBToLinear( color.b );\n\n\t\treturn this;\n\n\t}\n\n\tcopyLinearToSRGB( color ) {\n\n\t\tthis.r = LinearToSRGB( color.r );\n\t\tthis.g = LinearToSRGB( color.g );\n\t\tthis.b = LinearToSRGB( color.b );\n\n\t\treturn this;\n\n\t}\n\n\tconvertSRGBToLinear() {\n\n\t\tthis.copySRGBToLinear( this );\n\n\t\treturn this;\n\n\t}\n\n\tconvertLinearToSRGB() {\n\n\t\tthis.copyLinearToSRGB( this );\n\n\t\treturn this;\n\n\t}\n\n\tgetHex( colorSpace = SRGBColorSpace ) {\n\n\t\tColorManagement.fromWorkingColorSpace( _color.copy( this ), colorSpace );\n\n\t\treturn Math.round( clamp( _color.r * 255, 0, 255 ) ) * 65536 + Math.round( clamp( _color.g * 255, 0, 255 ) ) * 256 + Math.round( clamp( _color.b * 255, 0, 255 ) );\n\n\t}\n\n\tgetHexString( colorSpace = SRGBColorSpace ) {\n\n\t\treturn ( '000000' + this.getHex( colorSpace ).toString( 16 ) ).slice( - 6 );\n\n\t}\n\n\tgetHSL( target, colorSpace = ColorManagement.workingColorSpace ) {\n\n\t\t// h,s,l ranges are in 0.0 - 1.0\n\n\t\tColorManagement.fromWorkingColorSpace( _color.copy( this ), colorSpace );\n\n\t\tconst r = _color.r, g = _color.g, b = _color.b;\n\n\t\tconst max = Math.max( r, g, b );\n\t\tconst min = Math.min( r, g, b );\n\n\t\tlet hue, saturation;\n\t\tconst lightness = ( min + max ) / 2.0;\n\n\t\tif ( min === max ) {\n\n\t\t\thue = 0;\n\t\t\tsaturation = 0;\n\n\t\t} else {\n\n\t\t\tconst delta = max - min;\n\n\t\t\tsaturation = lightness <= 0.5 ? delta / ( max + min ) : delta / ( 2 - max - min );\n\n\t\t\tswitch ( max ) {\n\n\t\t\t\tcase r: hue = ( g - b ) / delta + ( g < b ? 6 : 0 ); break;\n\t\t\t\tcase g: hue = ( b - r ) / delta + 2; break;\n\t\t\t\tcase b: hue = ( r - g ) / delta + 4; break;\n\n\t\t\t}\n\n\t\t\thue /= 6;\n\n\t\t}\n\n\t\ttarget.h = hue;\n\t\ttarget.s = saturation;\n\t\ttarget.l = lightness;\n\n\t\treturn target;\n\n\t}\n\n\tgetRGB( target, colorSpace = ColorManagement.workingColorSpace ) {\n\n\t\tColorManagement.fromWorkingColorSpace( _color.copy( this ), colorSpace );\n\n\t\ttarget.r = _color.r;\n\t\ttarget.g = _color.g;\n\t\ttarget.b = _color.b;\n\n\t\treturn target;\n\n\t}\n\n\tgetStyle( colorSpace = SRGBColorSpace ) {\n\n\t\tColorManagement.fromWorkingColorSpace( _color.copy( this ), colorSpace );\n\n\t\tconst r = _color.r, g = _color.g, b = _color.b;\n\n\t\tif ( colorSpace !== SRGBColorSpace ) {\n\n\t\t\t// Requires CSS Color Module Level 4 (https://www.w3.org/TR/css-color-4/).\n\t\t\treturn `color(${ colorSpace } ${ r.toFixed( 3 ) } ${ g.toFixed( 3 ) } ${ b.toFixed( 3 ) })`;\n\n\t\t}\n\n\t\treturn `rgb(${ Math.round( r * 255 ) },${ Math.round( g * 255 ) },${ Math.round( b * 255 ) })`;\n\n\t}\n\n\toffsetHSL( h, s, l ) {\n\n\t\tthis.getHSL( _hslA );\n\n\t\treturn this.setHSL( _hslA.h + h, _hslA.s + s, _hslA.l + l );\n\n\t}\n\n\tadd( color ) {\n\n\t\tthis.r += color.r;\n\t\tthis.g += color.g;\n\t\tthis.b += color.b;\n\n\t\treturn this;\n\n\t}\n\n\taddColors( color1, color2 ) {\n\n\t\tthis.r = color1.r + color2.r;\n\t\tthis.g = color1.g + color2.g;\n\t\tthis.b = color1.b + color2.b;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.r += s;\n\t\tthis.g += s;\n\t\tthis.b += s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( color ) {\n\n\t\tthis.r = Math.max( 0, this.r - color.r );\n\t\tthis.g = Math.max( 0, this.g - color.g );\n\t\tthis.b = Math.max( 0, this.b - color.b );\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( color ) {\n\n\t\tthis.r *= color.r;\n\t\tthis.g *= color.g;\n\t\tthis.b *= color.b;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tthis.r *= s;\n\t\tthis.g *= s;\n\t\tthis.b *= s;\n\n\t\treturn this;\n\n\t}\n\n\tlerp( color, alpha ) {\n\n\t\tthis.r += ( color.r - this.r ) * alpha;\n\t\tthis.g += ( color.g - this.g ) * alpha;\n\t\tthis.b += ( color.b - this.b ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpColors( color1, color2, alpha ) {\n\n\t\tthis.r = color1.r + ( color2.r - color1.r ) * alpha;\n\t\tthis.g = color1.g + ( color2.g - color1.g ) * alpha;\n\t\tthis.b = color1.b + ( color2.b - color1.b ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpHSL( color, alpha ) {\n\n\t\tthis.getHSL( _hslA );\n\t\tcolor.getHSL( _hslB );\n\n\t\tconst h = lerp( _hslA.h, _hslB.h, alpha );\n\t\tconst s = lerp( _hslA.s, _hslB.s, alpha );\n\t\tconst l = lerp( _hslA.l, _hslB.l, alpha );\n\n\t\tthis.setHSL( h, s, l );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromVector3( v ) {\n\n\t\tthis.r = v.x;\n\t\tthis.g = v.y;\n\t\tthis.b = v.z;\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tconst r = this.r, g = this.g, b = this.b;\n\t\tconst e = m.elements;\n\n\t\tthis.r = e[ 0 ] * r + e[ 3 ] * g + e[ 6 ] * b;\n\t\tthis.g = e[ 1 ] * r + e[ 4 ] * g + e[ 7 ] * b;\n\t\tthis.b = e[ 2 ] * r + e[ 5 ] * g + e[ 8 ] * b;\n\n\t\treturn this;\n\n\t}\n\n\tequals( c ) {\n\n\t\treturn ( c.r === this.r ) && ( c.g === this.g ) && ( c.b === this.b );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.r = array[ offset ];\n\t\tthis.g = array[ offset + 1 ];\n\t\tthis.b = array[ offset + 2 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.r;\n\t\tarray[ offset + 1 ] = this.g;\n\t\tarray[ offset + 2 ] = this.b;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis.r = attribute.getX( index );\n\t\tthis.g = attribute.getY( index );\n\t\tthis.b = attribute.getZ( index );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\treturn this.getHex();\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.r;\n\t\tyield this.g;\n\t\tyield this.b;\n\n\t}\n\n}\n\nconst _color = /*@__PURE__*/ new Color();\n\nColor.NAMES = _colorKeywords;\n\nlet _materialId = 0;\n\nclass Material extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isMaterial = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _materialId ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'Material';\n\n\t\tthis.blending = NormalBlending;\n\t\tthis.side = FrontSide;\n\t\tthis.vertexColors = false;\n\n\t\tthis.opacity = 1;\n\t\tthis.transparent = false;\n\t\tthis.alphaHash = false;\n\n\t\tthis.blendSrc = SrcAlphaFactor;\n\t\tthis.blendDst = OneMinusSrcAlphaFactor;\n\t\tthis.blendEquation = AddEquation;\n\t\tthis.blendSrcAlpha = null;\n\t\tthis.blendDstAlpha = null;\n\t\tthis.blendEquationAlpha = null;\n\t\tthis.blendColor = new Color( 0, 0, 0 );\n\t\tthis.blendAlpha = 0;\n\n\t\tthis.depthFunc = LessEqualDepth;\n\t\tthis.depthTest = true;\n\t\tthis.depthWrite = true;\n\n\t\tthis.stencilWriteMask = 0xff;\n\t\tthis.stencilFunc = AlwaysStencilFunc;\n\t\tthis.stencilRef = 0;\n\t\tthis.stencilFuncMask = 0xff;\n\t\tthis.stencilFail = KeepStencilOp;\n\t\tthis.stencilZFail = KeepStencilOp;\n\t\tthis.stencilZPass = KeepStencilOp;\n\t\tthis.stencilWrite = false;\n\n\t\tthis.clippingPlanes = null;\n\t\tthis.clipIntersection = false;\n\t\tthis.clipShadows = false;\n\n\t\tthis.shadowSide = null;\n\n\t\tthis.colorWrite = true;\n\n\t\tthis.precision = null; // override the renderer's default precision for this material\n\n\t\tthis.polygonOffset = false;\n\t\tthis.polygonOffsetFactor = 0;\n\t\tthis.polygonOffsetUnits = 0;\n\n\t\tthis.dithering = false;\n\n\t\tthis.alphaToCoverage = false;\n\t\tthis.premultipliedAlpha = false;\n\t\tthis.forceSinglePass = false;\n\n\t\tthis.visible = true;\n\n\t\tthis.toneMapped = true;\n\n\t\tthis.userData = {};\n\n\t\tthis.version = 0;\n\n\t\tthis._alphaTest = 0;\n\n\t}\n\n\tget alphaTest() {\n\n\t\treturn this._alphaTest;\n\n\t}\n\n\tset alphaTest( value ) {\n\n\t\tif ( this._alphaTest > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._alphaTest = value;\n\n\t}\n\n\t// onBeforeRender and onBeforeCompile only supported in WebGLRenderer\n\n\tonBeforeRender( /* renderer, scene, camera, geometry, object, group */ ) {}\n\n\tonBeforeCompile( /* shaderobject, renderer */ ) {}\n\n\tcustomProgramCacheKey() {\n\n\t\treturn this.onBeforeCompile.toString();\n\n\t}\n\n\tsetValues( values ) {\n\n\t\tif ( values === undefined ) return;\n\n\t\tfor ( const key in values ) {\n\n\t\t\tconst newValue = values[ key ];\n\n\t\t\tif ( newValue === undefined ) {\n\n\t\t\t\tconsole.warn( `THREE.Material: parameter '${ key }' has value of undefined.` );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tconst currentValue = this[ key ];\n\n\t\t\tif ( currentValue === undefined ) {\n\n\t\t\t\tconsole.warn( `THREE.Material: '${ key }' is not a property of THREE.${ this.type }.` );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tif ( currentValue && currentValue.isColor ) {\n\n\t\t\t\tcurrentValue.set( newValue );\n\n\t\t\t} else if ( ( currentValue && currentValue.isVector3 ) && ( newValue && newValue.isVector3 ) ) {\n\n\t\t\t\tcurrentValue.copy( newValue );\n\n\t\t\t} else {\n\n\t\t\t\tthis[ key ] = newValue;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( isRootObject ) {\n\n\t\t\tmeta = {\n\t\t\t\ttextures: {},\n\t\t\t\timages: {}\n\t\t\t};\n\n\t\t}\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.6,\n\t\t\t\ttype: 'Material',\n\t\t\t\tgenerator: 'Material.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard Material serialization\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\n\t\tif ( this.name !== '' ) data.name = this.name;\n\n\t\tif ( this.color && this.color.isColor ) data.color = this.color.getHex();\n\n\t\tif ( this.roughness !== undefined ) data.roughness = this.roughness;\n\t\tif ( this.metalness !== undefined ) data.metalness = this.metalness;\n\n\t\tif ( this.sheen !== undefined ) data.sheen = this.sheen;\n\t\tif ( this.sheenColor && this.sheenColor.isColor ) data.sheenColor = this.sheenColor.getHex();\n\t\tif ( this.sheenRoughness !== undefined ) data.sheenRoughness = this.sheenRoughness;\n\t\tif ( this.emissive && this.emissive.isColor ) data.emissive = this.emissive.getHex();\n\t\tif ( this.emissiveIntensity !== undefined && this.emissiveIntensity !== 1 ) data.emissiveIntensity = this.emissiveIntensity;\n\n\t\tif ( this.specular && this.specular.isColor ) data.specular = this.specular.getHex();\n\t\tif ( this.specularIntensity !== undefined ) data.specularIntensity = this.specularIntensity;\n\t\tif ( this.specularColor && this.specularColor.isColor ) data.specularColor = this.specularColor.getHex();\n\t\tif ( this.shininess !== undefined ) data.shininess = this.shininess;\n\t\tif ( this.clearcoat !== undefined ) data.clearcoat = this.clearcoat;\n\t\tif ( this.clearcoatRoughness !== undefined ) data.clearcoatRoughness = this.clearcoatRoughness;\n\n\t\tif ( this.clearcoatMap && this.clearcoatMap.isTexture ) {\n\n\t\t\tdata.clearcoatMap = this.clearcoatMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.clearcoatRoughnessMap && this.clearcoatRoughnessMap.isTexture ) {\n\n\t\t\tdata.clearcoatRoughnessMap = this.clearcoatRoughnessMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.clearcoatNormalMap && this.clearcoatNormalMap.isTexture ) {\n\n\t\t\tdata.clearcoatNormalMap = this.clearcoatNormalMap.toJSON( meta ).uuid;\n\t\t\tdata.clearcoatNormalScale = this.clearcoatNormalScale.toArray();\n\n\t\t}\n\n\t\tif ( this.dispersion !== undefined ) data.dispersion = this.dispersion;\n\n\t\tif ( this.iridescence !== undefined ) data.iridescence = this.iridescence;\n\t\tif ( this.iridescenceIOR !== undefined ) data.iridescenceIOR = this.iridescenceIOR;\n\t\tif ( this.iridescenceThicknessRange !== undefined ) data.iridescenceThicknessRange = this.iridescenceThicknessRange;\n\n\t\tif ( this.iridescenceMap && this.iridescenceMap.isTexture ) {\n\n\t\t\tdata.iridescenceMap = this.iridescenceMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.iridescenceThicknessMap && this.iridescenceThicknessMap.isTexture ) {\n\n\t\t\tdata.iridescenceThicknessMap = this.iridescenceThicknessMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.anisotropy !== undefined ) data.anisotropy = this.anisotropy;\n\t\tif ( this.anisotropyRotation !== undefined ) data.anisotropyRotation = this.anisotropyRotation;\n\n\t\tif ( this.anisotropyMap && this.anisotropyMap.isTexture ) {\n\n\t\t\tdata.anisotropyMap = this.anisotropyMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.map && this.map.isTexture ) data.map = this.map.toJSON( meta ).uuid;\n\t\tif ( this.matcap && this.matcap.isTexture ) data.matcap = this.matcap.toJSON( meta ).uuid;\n\t\tif ( this.alphaMap && this.alphaMap.isTexture ) data.alphaMap = this.alphaMap.toJSON( meta ).uuid;\n\n\t\tif ( this.lightMap && this.lightMap.isTexture ) {\n\n\t\t\tdata.lightMap = this.lightMap.toJSON( meta ).uuid;\n\t\t\tdata.lightMapIntensity = this.lightMapIntensity;\n\n\t\t}\n\n\t\tif ( this.aoMap && this.aoMap.isTexture ) {\n\n\t\t\tdata.aoMap = this.aoMap.toJSON( meta ).uuid;\n\t\t\tdata.aoMapIntensity = this.aoMapIntensity;\n\n\t\t}\n\n\t\tif ( this.bumpMap && this.bumpMap.isTexture ) {\n\n\t\t\tdata.bumpMap = this.bumpMap.toJSON( meta ).uuid;\n\t\t\tdata.bumpScale = this.bumpScale;\n\n\t\t}\n\n\t\tif ( this.normalMap && this.normalMap.isTexture ) {\n\n\t\t\tdata.normalMap = this.normalMap.toJSON( meta ).uuid;\n\t\t\tdata.normalMapType = this.normalMapType;\n\t\t\tdata.normalScale = this.normalScale.toArray();\n\n\t\t}\n\n\t\tif ( this.displacementMap && this.displacementMap.isTexture ) {\n\n\t\t\tdata.displacementMap = this.displacementMap.toJSON( meta ).uuid;\n\t\t\tdata.displacementScale = this.displacementScale;\n\t\t\tdata.displacementBias = this.displacementBias;\n\n\t\t}\n\n\t\tif ( this.roughnessMap && this.roughnessMap.isTexture ) data.roughnessMap = this.roughnessMap.toJSON( meta ).uuid;\n\t\tif ( this.metalnessMap && this.metalnessMap.isTexture ) data.metalnessMap = this.metalnessMap.toJSON( meta ).uuid;\n\n\t\tif ( this.emissiveMap && this.emissiveMap.isTexture ) data.emissiveMap = this.emissiveMap.toJSON( meta ).uuid;\n\t\tif ( this.specularMap && this.specularMap.isTexture ) data.specularMap = this.specularMap.toJSON( meta ).uuid;\n\t\tif ( this.specularIntensityMap && this.specularIntensityMap.isTexture ) data.specularIntensityMap = this.specularIntensityMap.toJSON( meta ).uuid;\n\t\tif ( this.specularColorMap && this.specularColorMap.isTexture ) data.specularColorMap = this.specularColorMap.toJSON( meta ).uuid;\n\n\t\tif ( this.envMap && this.envMap.isTexture ) {\n\n\t\t\tdata.envMap = this.envMap.toJSON( meta ).uuid;\n\n\t\t\tif ( this.combine !== undefined ) data.combine = this.combine;\n\n\t\t}\n\n\t\tif ( this.envMapRotation !== undefined ) data.envMapRotation = this.envMapRotation.toArray();\n\t\tif ( this.envMapIntensity !== undefined ) data.envMapIntensity = this.envMapIntensity;\n\t\tif ( this.reflectivity !== undefined ) data.reflectivity = this.reflectivity;\n\t\tif ( this.refractionRatio !== undefined ) data.refractionRatio = this.refractionRatio;\n\n\t\tif ( this.gradientMap && this.gradientMap.isTexture ) {\n\n\t\t\tdata.gradientMap = this.gradientMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.transmission !== undefined ) data.transmission = this.transmission;\n\t\tif ( this.transmissionMap && this.transmissionMap.isTexture ) data.transmissionMap = this.transmissionMap.toJSON( meta ).uuid;\n\t\tif ( this.thickness !== undefined ) data.thickness = this.thickness;\n\t\tif ( this.thicknessMap && this.thicknessMap.isTexture ) data.thicknessMap = this.thicknessMap.toJSON( meta ).uuid;\n\t\tif ( this.attenuationDistance !== undefined && this.attenuationDistance !== Infinity ) data.attenuationDistance = this.attenuationDistance;\n\t\tif ( this.attenuationColor !== undefined ) data.attenuationColor = this.attenuationColor.getHex();\n\n\t\tif ( this.size !== undefined ) data.size = this.size;\n\t\tif ( this.shadowSide !== null ) data.shadowSide = this.shadowSide;\n\t\tif ( this.sizeAttenuation !== undefined ) data.sizeAttenuation = this.sizeAttenuation;\n\n\t\tif ( this.blending !== NormalBlending ) data.blending = this.blending;\n\t\tif ( this.side !== FrontSide ) data.side = this.side;\n\t\tif ( this.vertexColors === true ) data.vertexColors = true;\n\n\t\tif ( this.opacity < 1 ) data.opacity = this.opacity;\n\t\tif ( this.transparent === true ) data.transparent = true;\n\n\t\tif ( this.blendSrc !== SrcAlphaFactor ) data.blendSrc = this.blendSrc;\n\t\tif ( this.blendDst !== OneMinusSrcAlphaFactor ) data.blendDst = this.blendDst;\n\t\tif ( this.blendEquation !== AddEquation ) data.blendEquation = this.blendEquation;\n\t\tif ( this.blendSrcAlpha !== null ) data.blendSrcAlpha = this.blendSrcAlpha;\n\t\tif ( this.blendDstAlpha !== null ) data.blendDstAlpha = this.blendDstAlpha;\n\t\tif ( this.blendEquationAlpha !== null ) data.blendEquationAlpha = this.blendEquationAlpha;\n\t\tif ( this.blendColor && this.blendColor.isColor ) data.blendColor = this.blendColor.getHex();\n\t\tif ( this.blendAlpha !== 0 ) data.blendAlpha = this.blendAlpha;\n\n\t\tif ( this.depthFunc !== LessEqualDepth ) data.depthFunc = this.depthFunc;\n\t\tif ( this.depthTest === false ) data.depthTest = this.depthTest;\n\t\tif ( this.depthWrite === false ) data.depthWrite = this.depthWrite;\n\t\tif ( this.colorWrite === false ) data.colorWrite = this.colorWrite;\n\n\t\tif ( this.stencilWriteMask !== 0xff ) data.stencilWriteMask = this.stencilWriteMask;\n\t\tif ( this.stencilFunc !== AlwaysStencilFunc ) data.stencilFunc = this.stencilFunc;\n\t\tif ( this.stencilRef !== 0 ) data.stencilRef = this.stencilRef;\n\t\tif ( this.stencilFuncMask !== 0xff ) data.stencilFuncMask = this.stencilFuncMask;\n\t\tif ( this.stencilFail !== KeepStencilOp ) data.stencilFail = this.stencilFail;\n\t\tif ( this.stencilZFail !== KeepStencilOp ) data.stencilZFail = this.stencilZFail;\n\t\tif ( this.stencilZPass !== KeepStencilOp ) data.stencilZPass = this.stencilZPass;\n\t\tif ( this.stencilWrite === true ) data.stencilWrite = this.stencilWrite;\n\n\t\t// rotation (SpriteMaterial)\n\t\tif ( this.rotation !== undefined && this.rotation !== 0 ) data.rotation = this.rotation;\n\n\t\tif ( this.polygonOffset === true ) data.polygonOffset = true;\n\t\tif ( this.polygonOffsetFactor !== 0 ) data.polygonOffsetFactor = this.polygonOffsetFactor;\n\t\tif ( this.polygonOffsetUnits !== 0 ) data.polygonOffsetUnits = this.polygonOffsetUnits;\n\n\t\tif ( this.linewidth !== undefined && this.linewidth !== 1 ) data.linewidth = this.linewidth;\n\t\tif ( this.dashSize !== undefined ) data.dashSize = this.dashSize;\n\t\tif ( this.gapSize !== undefined ) data.gapSize = this.gapSize;\n\t\tif ( this.scale !== undefined ) data.scale = this.scale;\n\n\t\tif ( this.dithering === true ) data.dithering = true;\n\n\t\tif ( this.alphaTest > 0 ) data.alphaTest = this.alphaTest;\n\t\tif ( this.alphaHash === true ) data.alphaHash = true;\n\t\tif ( this.alphaToCoverage === true ) data.alphaToCoverage = true;\n\t\tif ( this.premultipliedAlpha === true ) data.premultipliedAlpha = true;\n\t\tif ( this.forceSinglePass === true ) data.forceSinglePass = true;\n\n\t\tif ( this.wireframe === true ) data.wireframe = true;\n\t\tif ( this.wireframeLinewidth > 1 ) data.wireframeLinewidth = this.wireframeLinewidth;\n\t\tif ( this.wireframeLinecap !== 'round' ) data.wireframeLinecap = this.wireframeLinecap;\n\t\tif ( this.wireframeLinejoin !== 'round' ) data.wireframeLinejoin = this.wireframeLinejoin;\n\n\t\tif ( this.flatShading === true ) data.flatShading = true;\n\n\t\tif ( this.visible === false ) data.visible = false;\n\n\t\tif ( this.toneMapped === false ) data.toneMapped = false;\n\n\t\tif ( this.fog === false ) data.fog = false;\n\n\t\tif ( Object.keys( this.userData ).length > 0 ) data.userData = this.userData;\n\n\t\t// TODO: Copied from Object3D.toJSON\n\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t\tif ( isRootObject ) {\n\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\n\t\t\tif ( textures.length > 0 ) data.textures = textures;\n\t\t\tif ( images.length > 0 ) data.images = images;\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.blending = source.blending;\n\t\tthis.side = source.side;\n\t\tthis.vertexColors = source.vertexColors;\n\n\t\tthis.opacity = source.opacity;\n\t\tthis.transparent = source.transparent;\n\n\t\tthis.blendSrc = source.blendSrc;\n\t\tthis.blendDst = source.blendDst;\n\t\tthis.blendEquation = source.blendEquation;\n\t\tthis.blendSrcAlpha = source.blendSrcAlpha;\n\t\tthis.blendDstAlpha = source.blendDstAlpha;\n\t\tthis.blendEquationAlpha = source.blendEquationAlpha;\n\t\tthis.blendColor.copy( source.blendColor );\n\t\tthis.blendAlpha = source.blendAlpha;\n\n\t\tthis.depthFunc = source.depthFunc;\n\t\tthis.depthTest = source.depthTest;\n\t\tthis.depthWrite = source.depthWrite;\n\n\t\tthis.stencilWriteMask = source.stencilWriteMask;\n\t\tthis.stencilFunc = source.stencilFunc;\n\t\tthis.stencilRef = source.stencilRef;\n\t\tthis.stencilFuncMask = source.stencilFuncMask;\n\t\tthis.stencilFail = source.stencilFail;\n\t\tthis.stencilZFail = source.stencilZFail;\n\t\tthis.stencilZPass = source.stencilZPass;\n\t\tthis.stencilWrite = source.stencilWrite;\n\n\t\tconst srcPlanes = source.clippingPlanes;\n\t\tlet dstPlanes = null;\n\n\t\tif ( srcPlanes !== null ) {\n\n\t\t\tconst n = srcPlanes.length;\n\t\t\tdstPlanes = new Array( n );\n\n\t\t\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\t\t\tdstPlanes[ i ] = srcPlanes[ i ].clone();\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.clippingPlanes = dstPlanes;\n\t\tthis.clipIntersection = source.clipIntersection;\n\t\tthis.clipShadows = source.clipShadows;\n\n\t\tthis.shadowSide = source.shadowSide;\n\n\t\tthis.colorWrite = source.colorWrite;\n\n\t\tthis.precision = source.precision;\n\n\t\tthis.polygonOffset = source.polygonOffset;\n\t\tthis.polygonOffsetFactor = source.polygonOffsetFactor;\n\t\tthis.polygonOffsetUnits = source.polygonOffsetUnits;\n\n\t\tthis.dithering = source.dithering;\n\n\t\tthis.alphaTest = source.alphaTest;\n\t\tthis.alphaHash = source.alphaHash;\n\t\tthis.alphaToCoverage = source.alphaToCoverage;\n\t\tthis.premultipliedAlpha = source.premultipliedAlpha;\n\t\tthis.forceSinglePass = source.forceSinglePass;\n\n\t\tthis.visible = source.visible;\n\n\t\tthis.toneMapped = source.toneMapped;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tonBuild( /* shaderobject, renderer */ ) {\n\n\t\tconsole.warn( 'Material: onBuild() has been removed.' ); // @deprecated, r166\n\n\t}\n\n}\n\nclass MeshBasicMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshBasicMaterial = true;\n\n\t\tthis.type = 'MeshBasicMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // emissive\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.envMapRotation = new Euler();\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.envMapRotation.copy( source.envMapRotation );\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\n// Fast Half Float Conversions, http://www.fox-toolkit.org/ftp/fasthalffloatconversion.pdf\n\nconst _tables = /*@__PURE__*/ _generateTables();\n\nfunction _generateTables() {\n\n\t// float32 to float16 helpers\n\n\tconst buffer = new ArrayBuffer( 4 );\n\tconst floatView = new Float32Array( buffer );\n\tconst uint32View = new Uint32Array( buffer );\n\n\tconst baseTable = new Uint32Array( 512 );\n\tconst shiftTable = new Uint32Array( 512 );\n\n\tfor ( let i = 0; i < 256; ++ i ) {\n\n\t\tconst e = i - 127;\n\n\t\t// very small number (0, -0)\n\n\t\tif ( e < - 27 ) {\n\n\t\t\tbaseTable[ i ] = 0x0000;\n\t\t\tbaseTable[ i | 0x100 ] = 0x8000;\n\t\t\tshiftTable[ i ] = 24;\n\t\t\tshiftTable[ i | 0x100 ] = 24;\n\n\t\t\t// small number (denorm)\n\n\t\t} else if ( e < - 14 ) {\n\n\t\t\tbaseTable[ i ] = 0x0400 >> ( - e - 14 );\n\t\t\tbaseTable[ i | 0x100 ] = ( 0x0400 >> ( - e - 14 ) ) | 0x8000;\n\t\t\tshiftTable[ i ] = - e - 1;\n\t\t\tshiftTable[ i | 0x100 ] = - e - 1;\n\n\t\t\t// normal number\n\n\t\t} else if ( e <= 15 ) {\n\n\t\t\tbaseTable[ i ] = ( e + 15 ) << 10;\n\t\t\tbaseTable[ i | 0x100 ] = ( ( e + 15 ) << 10 ) | 0x8000;\n\t\t\tshiftTable[ i ] = 13;\n\t\t\tshiftTable[ i | 0x100 ] = 13;\n\n\t\t\t// large number (Infinity, -Infinity)\n\n\t\t} else if ( e < 128 ) {\n\n\t\t\tbaseTable[ i ] = 0x7c00;\n\t\t\tbaseTable[ i | 0x100 ] = 0xfc00;\n\t\t\tshiftTable[ i ] = 24;\n\t\t\tshiftTable[ i | 0x100 ] = 24;\n\n\t\t\t// stay (NaN, Infinity, -Infinity)\n\n\t\t} else {\n\n\t\t\tbaseTable[ i ] = 0x7c00;\n\t\t\tbaseTable[ i | 0x100 ] = 0xfc00;\n\t\t\tshiftTable[ i ] = 13;\n\t\t\tshiftTable[ i | 0x100 ] = 13;\n\n\t\t}\n\n\t}\n\n\t// float16 to float32 helpers\n\n\tconst mantissaTable = new Uint32Array( 2048 );\n\tconst exponentTable = new Uint32Array( 64 );\n\tconst offsetTable = new Uint32Array( 64 );\n\n\tfor ( let i = 1; i < 1024; ++ i ) {\n\n\t\tlet m = i << 13; // zero pad mantissa bits\n\t\tlet e = 0; // zero exponent\n\n\t\t// normalized\n\t\twhile ( ( m & 0x00800000 ) === 0 ) {\n\n\t\t\tm <<= 1;\n\t\t\te -= 0x00800000; // decrement exponent\n\n\t\t}\n\n\t\tm &= ~ 0x00800000; // clear leading 1 bit\n\t\te += 0x38800000; // adjust bias\n\n\t\tmantissaTable[ i ] = m | e;\n\n\t}\n\n\tfor ( let i = 1024; i < 2048; ++ i ) {\n\n\t\tmantissaTable[ i ] = 0x38000000 + ( ( i - 1024 ) << 13 );\n\n\t}\n\n\tfor ( let i = 1; i < 31; ++ i ) {\n\n\t\texponentTable[ i ] = i << 23;\n\n\t}\n\n\texponentTable[ 31 ] = 0x47800000;\n\texponentTable[ 32 ] = 0x80000000;\n\n\tfor ( let i = 33; i < 63; ++ i ) {\n\n\t\texponentTable[ i ] = 0x80000000 + ( ( i - 32 ) << 23 );\n\n\t}\n\n\texponentTable[ 63 ] = 0xc7800000;\n\n\tfor ( let i = 1; i < 64; ++ i ) {\n\n\t\tif ( i !== 32 ) {\n\n\t\t\toffsetTable[ i ] = 1024;\n\n\t\t}\n\n\t}\n\n\treturn {\n\t\tfloatView: floatView,\n\t\tuint32View: uint32View,\n\t\tbaseTable: baseTable,\n\t\tshiftTable: shiftTable,\n\t\tmantissaTable: mantissaTable,\n\t\texponentTable: exponentTable,\n\t\toffsetTable: offsetTable\n\t};\n\n}\n\n// float32 to float16\n\nfunction toHalfFloat( val ) {\n\n\tif ( Math.abs( val ) > 65504 ) console.warn( 'THREE.DataUtils.toHalfFloat(): Value out of range.' );\n\n\tval = clamp( val, - 65504, 65504 );\n\n\t_tables.floatView[ 0 ] = val;\n\tconst f = _tables.uint32View[ 0 ];\n\tconst e = ( f >> 23 ) & 0x1ff;\n\treturn _tables.baseTable[ e ] + ( ( f & 0x007fffff ) >> _tables.shiftTable[ e ] );\n\n}\n\n// float16 to float32\n\nfunction fromHalfFloat( val ) {\n\n\tconst m = val >> 10;\n\t_tables.uint32View[ 0 ] = _tables.mantissaTable[ _tables.offsetTable[ m ] + ( val & 0x3ff ) ] + _tables.exponentTable[ m ];\n\treturn _tables.floatView[ 0 ];\n\n}\n\nconst DataUtils = {\n\ttoHalfFloat: toHalfFloat,\n\tfromHalfFloat: fromHalfFloat,\n};\n\nconst _vector$9 = /*@__PURE__*/ new Vector3();\nconst _vector2$1 = /*@__PURE__*/ new Vector2();\n\nclass BufferAttribute {\n\n\tconstructor( array, itemSize, normalized = false ) {\n\n\t\tif ( Array.isArray( array ) ) {\n\n\t\t\tthrow new TypeError( 'THREE.BufferAttribute: array should be a Typed Array.' );\n\n\t\t}\n\n\t\tthis.isBufferAttribute = true;\n\n\t\tthis.name = '';\n\n\t\tthis.array = array;\n\t\tthis.itemSize = itemSize;\n\t\tthis.count = array !== undefined ? array.length / itemSize : 0;\n\t\tthis.normalized = normalized;\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.updateRanges = [];\n\t\tthis.gpuType = FloatType;\n\n\t\tthis.version = 0;\n\n\t}\n\n\tonUploadCallback() {}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t}\n\n\taddUpdateRange( start, count ) {\n\n\t\tthis.updateRanges.push( { start, count } );\n\n\t}\n\n\tclearUpdateRanges() {\n\n\t\tthis.updateRanges.length = 0;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\t\tthis.array = new source.array.constructor( source.array );\n\t\tthis.itemSize = source.itemSize;\n\t\tthis.count = source.count;\n\t\tthis.normalized = source.normalized;\n\n\t\tthis.usage = source.usage;\n\t\tthis.gpuType = source.gpuType;\n\n\t\treturn this;\n\n\t}\n\n\tcopyAt( index1, attribute, index2 ) {\n\n\t\tindex1 *= this.itemSize;\n\t\tindex2 *= attribute.itemSize;\n\n\t\tfor ( let i = 0, l = this.itemSize; i < l; i ++ ) {\n\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcopyArray( array ) {\n\n\t\tthis.array.set( array );\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tif ( this.itemSize === 2 ) {\n\n\t\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t\t_vector2$1.fromBufferAttribute( this, i );\n\t\t\t\t_vector2$1.applyMatrix3( m );\n\n\t\t\t\tthis.setXY( i, _vector2$1.x, _vector2$1.y );\n\n\t\t\t}\n\n\t\t} else if ( this.itemSize === 3 ) {\n\n\t\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t\t_vector$9.fromBufferAttribute( this, i );\n\t\t\t\t_vector$9.applyMatrix3( m );\n\n\t\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$9.fromBufferAttribute( this, i );\n\n\t\t\t_vector$9.applyMatrix4( m );\n\n\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$9.fromBufferAttribute( this, i );\n\n\t\t\t_vector$9.applyNormalMatrix( m );\n\n\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$9.fromBufferAttribute( this, i );\n\n\t\t\t_vector$9.transformDirection( m );\n\n\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tset( value, offset = 0 ) {\n\n\t\t// Matching BufferAttribute constructor, do not normalize the array.\n\t\tthis.array.set( value, offset );\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index, component ) {\n\n\t\tlet value = this.array[ index * this.itemSize + component ];\n\n\t\tif ( this.normalized ) value = denormalize( value, this.array );\n\n\t\treturn value;\n\n\t}\n\n\tsetComponent( index, component, value ) {\n\n\t\tif ( this.normalized ) value = normalize( value, this.array );\n\n\t\tthis.array[ index * this.itemSize + component ] = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetX( index ) {\n\n\t\tlet x = this.array[ index * this.itemSize ];\n\n\t\tif ( this.normalized ) x = denormalize( x, this.array );\n\n\t\treturn x;\n\n\t}\n\n\tsetX( index, x ) {\n\n\t\tif ( this.normalized ) x = normalize( x, this.array );\n\n\t\tthis.array[ index * this.itemSize ] = x;\n\n\t\treturn this;\n\n\t}\n\n\tgetY( index ) {\n\n\t\tlet y = this.array[ index * this.itemSize + 1 ];\n\n\t\tif ( this.normalized ) y = denormalize( y, this.array );\n\n\t\treturn y;\n\n\t}\n\n\tsetY( index, y ) {\n\n\t\tif ( this.normalized ) y = normalize( y, this.array );\n\n\t\tthis.array[ index * this.itemSize + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tgetZ( index ) {\n\n\t\tlet z = this.array[ index * this.itemSize + 2 ];\n\n\t\tif ( this.normalized ) z = denormalize( z, this.array );\n\n\t\treturn z;\n\n\t}\n\n\tsetZ( index, z ) {\n\n\t\tif ( this.normalized ) z = normalize( z, this.array );\n\n\t\tthis.array[ index * this.itemSize + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tgetW( index ) {\n\n\t\tlet w = this.array[ index * this.itemSize + 3 ];\n\n\t\tif ( this.normalized ) w = denormalize( w, this.array );\n\n\t\treturn w;\n\n\t}\n\n\tsetW( index, w ) {\n\n\t\tif ( this.normalized ) w = normalize( w, this.array );\n\n\t\tthis.array[ index * this.itemSize + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetXY( index, x, y ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize( x, this.array );\n\t\t\ty = normalize( y, this.array );\n\n\t\t}\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZ( index, x, y, z ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize( x, this.array );\n\t\t\ty = normalize( y, this.array );\n\t\t\tz = normalize( z, this.array );\n\n\t\t}\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\t\tthis.array[ index + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZW( index, x, y, z, w ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize( x, this.array );\n\t\t\ty = normalize( y, this.array );\n\t\t\tz = normalize( z, this.array );\n\t\t\tw = normalize( w, this.array );\n\n\t\t}\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\t\tthis.array[ index + 2 ] = z;\n\t\tthis.array[ index + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tonUpload( callback ) {\n\n\t\tthis.onUploadCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.array, this.itemSize ).copy( this );\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\titemSize: this.itemSize,\n\t\t\ttype: this.array.constructor.name,\n\t\t\tarray: Array.from( this.array ),\n\t\t\tnormalized: this.normalized\n\t\t};\n\n\t\tif ( this.name !== '' ) data.name = this.name;\n\t\tif ( this.usage !== StaticDrawUsage ) data.usage = this.usage;\n\n\t\treturn data;\n\n\t}\n\n}\n\n//\n\nclass Int8BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int8Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint8BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint8Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint8ClampedBufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint8ClampedArray( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Int16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int16Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint16Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Int32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Float16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint16Array( array ), itemSize, normalized );\n\n\t\tthis.isFloat16BufferAttribute = true;\n\n\t}\n\n\tgetX( index ) {\n\n\t\tlet x = fromHalfFloat( this.array[ index * this.itemSize ] );\n\n\t\tif ( this.normalized ) x = denormalize( x, this.array );\n\n\t\treturn x;\n\n\t}\n\n\tsetX( index, x ) {\n\n\t\tif ( this.normalized ) x = normalize( x, this.array );\n\n\t\tthis.array[ index * this.itemSize ] = toHalfFloat( x );\n\n\t\treturn this;\n\n\t}\n\n\tgetY( index ) {\n\n\t\tlet y = fromHalfFloat( this.array[ index * this.itemSize + 1 ] );\n\n\t\tif ( this.normalized ) y = denormalize( y, this.array );\n\n\t\treturn y;\n\n\t}\n\n\tsetY( index, y ) {\n\n\t\tif ( this.normalized ) y = normalize( y, this.array );\n\n\t\tthis.array[ index * this.itemSize + 1 ] = toHalfFloat( y );\n\n\t\treturn this;\n\n\t}\n\n\tgetZ( index ) {\n\n\t\tlet z = fromHalfFloat( this.array[ index * this.itemSize + 2 ] );\n\n\t\tif ( this.normalized ) z = denormalize( z, this.array );\n\n\t\treturn z;\n\n\t}\n\n\tsetZ( index, z ) {\n\n\t\tif ( this.normalized ) z = normalize( z, this.array );\n\n\t\tthis.array[ index * this.itemSize + 2 ] = toHalfFloat( z );\n\n\t\treturn this;\n\n\t}\n\n\tgetW( index ) {\n\n\t\tlet w = fromHalfFloat( this.array[ index * this.itemSize + 3 ] );\n\n\t\tif ( this.normalized ) w = denormalize( w, this.array );\n\n\t\treturn w;\n\n\t}\n\n\tsetW( index, w ) {\n\n\t\tif ( this.normalized ) w = normalize( w, this.array );\n\n\t\tthis.array[ index * this.itemSize + 3 ] = toHalfFloat( w );\n\n\t\treturn this;\n\n\t}\n\n\tsetXY( index, x, y ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize( x, this.array );\n\t\t\ty = normalize( y, this.array );\n\n\t\t}\n\n\t\tthis.array[ index + 0 ] = toHalfFloat( x );\n\t\tthis.array[ index + 1 ] = toHalfFloat( y );\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZ( index, x, y, z ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize( x, this.array );\n\t\t\ty = normalize( y, this.array );\n\t\t\tz = normalize( z, this.array );\n\n\t\t}\n\n\t\tthis.array[ index + 0 ] = toHalfFloat( x );\n\t\tthis.array[ index + 1 ] = toHalfFloat( y );\n\t\tthis.array[ index + 2 ] = toHalfFloat( z );\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZW( index, x, y, z, w ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize( x, this.array );\n\t\t\ty = normalize( y, this.array );\n\t\t\tz = normalize( z, this.array );\n\t\t\tw = normalize( w, this.array );\n\n\t\t}\n\n\t\tthis.array[ index + 0 ] = toHalfFloat( x );\n\t\tthis.array[ index + 1 ] = toHalfFloat( y );\n\t\tthis.array[ index + 2 ] = toHalfFloat( z );\n\t\tthis.array[ index + 3 ] = toHalfFloat( w );\n\n\t\treturn this;\n\n\t}\n\n}\n\n\nclass Float32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Float32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nlet _id$1 = 0;\n\nconst _m1 = /*@__PURE__*/ new Matrix4();\nconst _obj = /*@__PURE__*/ new Object3D();\nconst _offset = /*@__PURE__*/ new Vector3();\nconst _box$2 = /*@__PURE__*/ new Box3();\nconst _boxMorphTargets = /*@__PURE__*/ new Box3();\nconst _vector$8 = /*@__PURE__*/ new Vector3();\n\nclass BufferGeometry extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isBufferGeometry = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _id$1 ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'BufferGeometry';\n\n\t\tthis.index = null;\n\t\tthis.indirect = null;\n\t\tthis.attributes = {};\n\n\t\tthis.morphAttributes = {};\n\t\tthis.morphTargetsRelative = false;\n\n\t\tthis.groups = [];\n\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\tthis.drawRange = { start: 0, count: Infinity };\n\n\t\tthis.userData = {};\n\n\t}\n\n\tgetIndex() {\n\n\t\treturn this.index;\n\n\t}\n\n\tsetIndex( index ) {\n\n\t\tif ( Array.isArray( index ) ) {\n\n\t\t\tthis.index = new ( arrayNeedsUint32( index ) ? Uint32BufferAttribute : Uint16BufferAttribute )( index, 1 );\n\n\t\t} else {\n\n\t\t\tthis.index = index;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetIndirect( indirect ) {\n\n\t\tthis.indirect = indirect;\n\n\t\treturn this;\n\n\t}\n\n\tgetIndirect() {\n\n\t\treturn this.indirect;\n\n\t}\n\n\tgetAttribute( name ) {\n\n\t\treturn this.attributes[ name ];\n\n\t}\n\n\tsetAttribute( name, attribute ) {\n\n\t\tthis.attributes[ name ] = attribute;\n\n\t\treturn this;\n\n\t}\n\n\tdeleteAttribute( name ) {\n\n\t\tdelete this.attributes[ name ];\n\n\t\treturn this;\n\n\t}\n\n\thasAttribute( name ) {\n\n\t\treturn this.attributes[ name ] !== undefined;\n\n\t}\n\n\taddGroup( start, count, materialIndex = 0 ) {\n\n\t\tthis.groups.push( {\n\n\t\t\tstart: start,\n\t\t\tcount: count,\n\t\t\tmaterialIndex: materialIndex\n\n\t\t} );\n\n\t}\n\n\tclearGroups() {\n\n\t\tthis.groups = [];\n\n\t}\n\n\tsetDrawRange( start, count ) {\n\n\t\tthis.drawRange.start = start;\n\t\tthis.drawRange.count = count;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tconst position = this.attributes.position;\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tposition.applyMatrix4( matrix );\n\n\t\t\tposition.needsUpdate = true;\n\n\t\t}\n\n\t\tconst normal = this.attributes.normal;\n\n\t\tif ( normal !== undefined ) {\n\n\t\t\tconst normalMatrix = new Matrix3().getNormalMatrix( matrix );\n\n\t\t\tnormal.applyNormalMatrix( normalMatrix );\n\n\t\t\tnormal.needsUpdate = true;\n\n\t\t}\n\n\t\tconst tangent = this.attributes.tangent;\n\n\t\tif ( tangent !== undefined ) {\n\n\t\t\ttangent.transformDirection( matrix );\n\n\t\t\ttangent.needsUpdate = true;\n\n\t\t}\n\n\t\tif ( this.boundingBox !== null ) {\n\n\t\t\tthis.computeBoundingBox();\n\n\t\t}\n\n\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\tthis.computeBoundingSphere();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\t_m1.makeRotationFromQuaternion( q );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateX( angle ) {\n\n\t\t// rotate geometry around world x-axis\n\n\t\t_m1.makeRotationX( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateY( angle ) {\n\n\t\t// rotate geometry around world y-axis\n\n\t\t_m1.makeRotationY( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateZ( angle ) {\n\n\t\t// rotate geometry around world z-axis\n\n\t\t_m1.makeRotationZ( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( x, y, z ) {\n\n\t\t// translate geometry\n\n\t\t_m1.makeTranslation( x, y, z );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\tscale( x, y, z ) {\n\n\t\t// scale geometry\n\n\t\t_m1.makeScale( x, y, z );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\tlookAt( vector ) {\n\n\t\t_obj.lookAt( vector );\n\n\t\t_obj.updateMatrix();\n\n\t\tthis.applyMatrix4( _obj.matrix );\n\n\t\treturn this;\n\n\t}\n\n\tcenter() {\n\n\t\tthis.computeBoundingBox();\n\n\t\tthis.boundingBox.getCenter( _offset ).negate();\n\n\t\tthis.translate( _offset.x, _offset.y, _offset.z );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tconst positionAttribute = this.getAttribute( 'position' );\n\n\t\tif ( positionAttribute === undefined ) {\n\n\t\t\tconst position = [];\n\n\t\t\tfor ( let i = 0, l = points.length; i < l; i ++ ) {\n\n\t\t\t\tconst point = points[ i ];\n\t\t\t\tposition.push( point.x, point.y, point.z || 0 );\n\n\t\t\t}\n\n\t\t\tthis.setAttribute( 'position', new Float32BufferAttribute( position, 3 ) );\n\n\t\t} else {\n\n\t\t\tconst l = Math.min( points.length, positionAttribute.count ); // make sure data do not exceed buffer size\n\n\t\t\tfor ( let i = 0; i < l; i ++ ) {\n\n\t\t\t\tconst point = points[ i ];\n\t\t\t\tpositionAttribute.setXYZ( i, point.x, point.y, point.z || 0 );\n\n\t\t\t}\n\n\t\t\tif ( points.length > positionAttribute.count ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry.' );\n\n\t\t\t}\n\n\t\t\tpositionAttribute.needsUpdate = true;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcomputeBoundingBox() {\n\n\t\tif ( this.boundingBox === null ) {\n\n\t\t\tthis.boundingBox = new Box3();\n\n\t\t}\n\n\t\tconst position = this.attributes.position;\n\t\tconst morphAttributesPosition = this.morphAttributes.position;\n\n\t\tif ( position && position.isGLBufferAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.', this );\n\n\t\t\tthis.boundingBox.set(\n\t\t\t\tnew Vector3( - Infinity, - Infinity, - Infinity ),\n\t\t\t\tnew Vector3( + Infinity, + Infinity, + Infinity )\n\t\t\t);\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tthis.boundingBox.setFromBufferAttribute( position );\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\t_box$2.setFromBufferAttribute( morphAttribute );\n\n\t\t\t\t\tif ( this.morphTargetsRelative ) {\n\n\t\t\t\t\t\t_vector$8.addVectors( this.boundingBox.min, _box$2.min );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector$8 );\n\n\t\t\t\t\t\t_vector$8.addVectors( this.boundingBox.max, _box$2.max );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector$8 );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box$2.min );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box$2.max );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis.boundingBox.makeEmpty();\n\n\t\t}\n\n\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t}\n\n\t}\n\n\tcomputeBoundingSphere() {\n\n\t\tif ( this.boundingSphere === null ) {\n\n\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t}\n\n\t\tconst position = this.attributes.position;\n\t\tconst morphAttributesPosition = this.morphAttributes.position;\n\n\t\tif ( position && position.isGLBufferAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.', this );\n\n\t\t\tthis.boundingSphere.set( new Vector3(), Infinity );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( position ) {\n\n\t\t\t// first, find the center of the bounding sphere\n\n\t\t\tconst center = this.boundingSphere.center;\n\n\t\t\t_box$2.setFromBufferAttribute( position );\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\t_boxMorphTargets.setFromBufferAttribute( morphAttribute );\n\n\t\t\t\t\tif ( this.morphTargetsRelative ) {\n\n\t\t\t\t\t\t_vector$8.addVectors( _box$2.min, _boxMorphTargets.min );\n\t\t\t\t\t\t_box$2.expandByPoint( _vector$8 );\n\n\t\t\t\t\t\t_vector$8.addVectors( _box$2.max, _boxMorphTargets.max );\n\t\t\t\t\t\t_box$2.expandByPoint( _vector$8 );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t_box$2.expandByPoint( _boxMorphTargets.min );\n\t\t\t\t\t\t_box$2.expandByPoint( _boxMorphTargets.max );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_box$2.getCenter( center );\n\n\t\t\t// second, try to find a boundingSphere with a radius smaller than the\n\t\t\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\n\n\t\t\tlet maxRadiusSq = 0;\n\n\t\t\tfor ( let i = 0, il = position.count; i < il; i ++ ) {\n\n\t\t\t\t_vector$8.fromBufferAttribute( position, i );\n\n\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector$8 ) );\n\n\t\t\t}\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\tconst morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t\t\t\tfor ( let j = 0, jl = morphAttribute.count; j < jl; j ++ ) {\n\n\t\t\t\t\t\t_vector$8.fromBufferAttribute( morphAttribute, j );\n\n\t\t\t\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t\t\t\t_offset.fromBufferAttribute( position, j );\n\t\t\t\t\t\t\t_vector$8.add( _offset );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector$8 ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\n\n\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcomputeTangents() {\n\n\t\tconst index = this.index;\n\t\tconst attributes = this.attributes;\n\n\t\t// based on http://www.terathon.com/code/tangent.html\n\t\t// (per vertex tangents)\n\n\t\tif ( index === null ||\n\t\t\t attributes.position === undefined ||\n\t\t\t attributes.normal === undefined ||\n\t\t\t attributes.uv === undefined ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst positionAttribute = attributes.position;\n\t\tconst normalAttribute = attributes.normal;\n\t\tconst uvAttribute = attributes.uv;\n\n\t\tif ( this.hasAttribute( 'tangent' ) === false ) {\n\n\t\t\tthis.setAttribute( 'tangent', new BufferAttribute( new Float32Array( 4 * positionAttribute.count ), 4 ) );\n\n\t\t}\n\n\t\tconst tangentAttribute = this.getAttribute( 'tangent' );\n\n\t\tconst tan1 = [], tan2 = [];\n\n\t\tfor ( let i = 0; i < positionAttribute.count; i ++ ) {\n\n\t\t\ttan1[ i ] = new Vector3();\n\t\t\ttan2[ i ] = new Vector3();\n\n\t\t}\n\n\t\tconst vA = new Vector3(),\n\t\t\tvB = new Vector3(),\n\t\t\tvC = new Vector3(),\n\n\t\t\tuvA = new Vector2(),\n\t\t\tuvB = new Vector2(),\n\t\t\tuvC = new Vector2(),\n\n\t\t\tsdir = new Vector3(),\n\t\t\ttdir = new Vector3();\n\n\t\tfunction handleTriangle( a, b, c ) {\n\n\t\t\tvA.fromBufferAttribute( positionAttribute, a );\n\t\t\tvB.fromBufferAttribute( positionAttribute, b );\n\t\t\tvC.fromBufferAttribute( positionAttribute, c );\n\n\t\t\tuvA.fromBufferAttribute( uvAttribute, a );\n\t\t\tuvB.fromBufferAttribute( uvAttribute, b );\n\t\t\tuvC.fromBufferAttribute( uvAttribute, c );\n\n\t\t\tvB.sub( vA );\n\t\t\tvC.sub( vA );\n\n\t\t\tuvB.sub( uvA );\n\t\t\tuvC.sub( uvA );\n\n\t\t\tconst r = 1.0 / ( uvB.x * uvC.y - uvC.x * uvB.y );\n\n\t\t\t// silently ignore degenerate uv triangles having coincident or colinear vertices\n\n\t\t\tif ( ! isFinite( r ) ) return;\n\n\t\t\tsdir.copy( vB ).multiplyScalar( uvC.y ).addScaledVector( vC, - uvB.y ).multiplyScalar( r );\n\t\t\ttdir.copy( vC ).multiplyScalar( uvB.x ).addScaledVector( vB, - uvC.x ).multiplyScalar( r );\n\n\t\t\ttan1[ a ].add( sdir );\n\t\t\ttan1[ b ].add( sdir );\n\t\t\ttan1[ c ].add( sdir );\n\n\t\t\ttan2[ a ].add( tdir );\n\t\t\ttan2[ b ].add( tdir );\n\t\t\ttan2[ c ].add( tdir );\n\n\t\t}\n\n\t\tlet groups = this.groups;\n\n\t\tif ( groups.length === 0 ) {\n\n\t\t\tgroups = [ {\n\t\t\t\tstart: 0,\n\t\t\t\tcount: index.count\n\t\t\t} ];\n\n\t\t}\n\n\t\tfor ( let i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tconst group = groups[ i ];\n\n\t\t\tconst start = group.start;\n\t\t\tconst count = group.count;\n\n\t\t\tfor ( let j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleTriangle(\n\t\t\t\t\tindex.getX( j + 0 ),\n\t\t\t\t\tindex.getX( j + 1 ),\n\t\t\t\t\tindex.getX( j + 2 )\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst tmp = new Vector3(), tmp2 = new Vector3();\n\t\tconst n = new Vector3(), n2 = new Vector3();\n\n\t\tfunction handleVertex( v ) {\n\n\t\t\tn.fromBufferAttribute( normalAttribute, v );\n\t\t\tn2.copy( n );\n\n\t\t\tconst t = tan1[ v ];\n\n\t\t\t// Gram-Schmidt orthogonalize\n\n\t\t\ttmp.copy( t );\n\t\t\ttmp.sub( n.multiplyScalar( n.dot( t ) ) ).normalize();\n\n\t\t\t// Calculate handedness\n\n\t\t\ttmp2.crossVectors( n2, t );\n\t\t\tconst test = tmp2.dot( tan2[ v ] );\n\t\t\tconst w = ( test < 0.0 ) ? - 1.0 : 1.0;\n\n\t\t\ttangentAttribute.setXYZW( v, tmp.x, tmp.y, tmp.z, w );\n\n\t\t}\n\n\t\tfor ( let i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tconst group = groups[ i ];\n\n\t\t\tconst start = group.start;\n\t\t\tconst count = group.count;\n\n\t\t\tfor ( let j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleVertex( index.getX( j + 0 ) );\n\t\t\t\thandleVertex( index.getX( j + 1 ) );\n\t\t\t\thandleVertex( index.getX( j + 2 ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcomputeVertexNormals() {\n\n\t\tconst index = this.index;\n\t\tconst positionAttribute = this.getAttribute( 'position' );\n\n\t\tif ( positionAttribute !== undefined ) {\n\n\t\t\tlet normalAttribute = this.getAttribute( 'normal' );\n\n\t\t\tif ( normalAttribute === undefined ) {\n\n\t\t\t\tnormalAttribute = new BufferAttribute( new Float32Array( positionAttribute.count * 3 ), 3 );\n\t\t\t\tthis.setAttribute( 'normal', normalAttribute );\n\n\t\t\t} else {\n\n\t\t\t\t// reset existing normals to zero\n\n\t\t\t\tfor ( let i = 0, il = normalAttribute.count; i < il; i ++ ) {\n\n\t\t\t\t\tnormalAttribute.setXYZ( i, 0, 0, 0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst pA = new Vector3(), pB = new Vector3(), pC = new Vector3();\n\t\t\tconst nA = new Vector3(), nB = new Vector3(), nC = new Vector3();\n\t\t\tconst cb = new Vector3(), ab = new Vector3();\n\n\t\t\t// indexed elements\n\n\t\t\tif ( index ) {\n\n\t\t\t\tfor ( let i = 0, il = index.count; i < il; i += 3 ) {\n\n\t\t\t\t\tconst vA = index.getX( i + 0 );\n\t\t\t\t\tconst vB = index.getX( i + 1 );\n\t\t\t\t\tconst vC = index.getX( i + 2 );\n\n\t\t\t\t\tpA.fromBufferAttribute( positionAttribute, vA );\n\t\t\t\t\tpB.fromBufferAttribute( positionAttribute, vB );\n\t\t\t\t\tpC.fromBufferAttribute( positionAttribute, vC );\n\n\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\tnA.fromBufferAttribute( normalAttribute, vA );\n\t\t\t\t\tnB.fromBufferAttribute( normalAttribute, vB );\n\t\t\t\t\tnC.fromBufferAttribute( normalAttribute, vC );\n\n\t\t\t\t\tnA.add( cb );\n\t\t\t\t\tnB.add( cb );\n\t\t\t\t\tnC.add( cb );\n\n\t\t\t\t\tnormalAttribute.setXYZ( vA, nA.x, nA.y, nA.z );\n\t\t\t\t\tnormalAttribute.setXYZ( vB, nB.x, nB.y, nB.z );\n\t\t\t\t\tnormalAttribute.setXYZ( vC, nC.x, nC.y, nC.z );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// non-indexed elements (unconnected triangle soup)\n\n\t\t\t\tfor ( let i = 0, il = positionAttribute.count; i < il; i += 3 ) {\n\n\t\t\t\t\tpA.fromBufferAttribute( positionAttribute, i + 0 );\n\t\t\t\t\tpB.fromBufferAttribute( positionAttribute, i + 1 );\n\t\t\t\t\tpC.fromBufferAttribute( positionAttribute, i + 2 );\n\n\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\tnormalAttribute.setXYZ( i + 0, cb.x, cb.y, cb.z );\n\t\t\t\t\tnormalAttribute.setXYZ( i + 1, cb.x, cb.y, cb.z );\n\t\t\t\t\tnormalAttribute.setXYZ( i + 2, cb.x, cb.y, cb.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.normalizeNormals();\n\n\t\t\tnormalAttribute.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\tnormalizeNormals() {\n\n\t\tconst normals = this.attributes.normal;\n\n\t\tfor ( let i = 0, il = normals.count; i < il; i ++ ) {\n\n\t\t\t_vector$8.fromBufferAttribute( normals, i );\n\n\t\t\t_vector$8.normalize();\n\n\t\t\tnormals.setXYZ( i, _vector$8.x, _vector$8.y, _vector$8.z );\n\n\t\t}\n\n\t}\n\n\ttoNonIndexed() {\n\n\t\tfunction convertBufferAttribute( attribute, indices ) {\n\n\t\t\tconst array = attribute.array;\n\t\t\tconst itemSize = attribute.itemSize;\n\t\t\tconst normalized = attribute.normalized;\n\n\t\t\tconst array2 = new array.constructor( indices.length * itemSize );\n\n\t\t\tlet index = 0, index2 = 0;\n\n\t\t\tfor ( let i = 0, l = indices.length; i < l; i ++ ) {\n\n\t\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\t\tindex = indices[ i ] * attribute.data.stride + attribute.offset;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tindex = indices[ i ] * itemSize;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let j = 0; j < itemSize; j ++ ) {\n\n\t\t\t\t\tarray2[ index2 ++ ] = array[ index ++ ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new BufferAttribute( array2, itemSize, normalized );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.index === null ) {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed.' );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst geometry2 = new BufferGeometry();\n\n\t\tconst indices = this.index.array;\n\t\tconst attributes = this.attributes;\n\n\t\t// attributes\n\n\t\tfor ( const name in attributes ) {\n\n\t\t\tconst attribute = attributes[ name ];\n\n\t\t\tconst newAttribute = convertBufferAttribute( attribute, indices );\n\n\t\t\tgeometry2.setAttribute( name, newAttribute );\n\n\t\t}\n\n\t\t// morph attributes\n\n\t\tconst morphAttributes = this.morphAttributes;\n\n\t\tfor ( const name in morphAttributes ) {\n\n\t\t\tconst morphArray = [];\n\t\t\tconst morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\n\n\t\t\tfor ( let i = 0, il = morphAttribute.length; i < il; i ++ ) {\n\n\t\t\t\tconst attribute = morphAttribute[ i ];\n\n\t\t\t\tconst newAttribute = convertBufferAttribute( attribute, indices );\n\n\t\t\t\tmorphArray.push( newAttribute );\n\n\t\t\t}\n\n\t\t\tgeometry2.morphAttributes[ name ] = morphArray;\n\n\t\t}\n\n\t\tgeometry2.morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t// groups\n\n\t\tconst groups = this.groups;\n\n\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\tconst group = groups[ i ];\n\t\t\tgeometry2.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t}\n\n\t\treturn geometry2;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.6,\n\t\t\t\ttype: 'BufferGeometry',\n\t\t\t\tgenerator: 'BufferGeometry.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard BufferGeometry serialization\n\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\t\tif ( this.name !== '' ) data.name = this.name;\n\t\tif ( Object.keys( this.userData ).length > 0 ) data.userData = this.userData;\n\n\t\tif ( this.parameters !== undefined ) {\n\n\t\t\tconst parameters = this.parameters;\n\n\t\t\tfor ( const key in parameters ) {\n\n\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\t// for simplicity the code assumes attributes are not shared across geometries, see #15811\n\n\t\tdata.data = { attributes: {} };\n\n\t\tconst index = this.index;\n\n\t\tif ( index !== null ) {\n\n\t\t\tdata.data.index = {\n\t\t\t\ttype: index.array.constructor.name,\n\t\t\t\tarray: Array.prototype.slice.call( index.array )\n\t\t\t};\n\n\t\t}\n\n\t\tconst attributes = this.attributes;\n\n\t\tfor ( const key in attributes ) {\n\n\t\t\tconst attribute = attributes[ key ];\n\n\t\t\tdata.data.attributes[ key ] = attribute.toJSON( data.data );\n\n\t\t}\n\n\t\tconst morphAttributes = {};\n\t\tlet hasMorphAttributes = false;\n\n\t\tfor ( const key in this.morphAttributes ) {\n\n\t\t\tconst attributeArray = this.morphAttributes[ key ];\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0, il = attributeArray.length; i < il; i ++ ) {\n\n\t\t\t\tconst attribute = attributeArray[ i ];\n\n\t\t\t\tarray.push( attribute.toJSON( data.data ) );\n\n\t\t\t}\n\n\t\t\tif ( array.length > 0 ) {\n\n\t\t\t\tmorphAttributes[ key ] = array;\n\n\t\t\t\thasMorphAttributes = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( hasMorphAttributes ) {\n\n\t\t\tdata.data.morphAttributes = morphAttributes;\n\t\t\tdata.data.morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t}\n\n\t\tconst groups = this.groups;\n\n\t\tif ( groups.length > 0 ) {\n\n\t\t\tdata.data.groups = JSON.parse( JSON.stringify( groups ) );\n\n\t\t}\n\n\t\tconst boundingSphere = this.boundingSphere;\n\n\t\tif ( boundingSphere !== null ) {\n\n\t\t\tdata.data.boundingSphere = {\n\t\t\t\tcenter: boundingSphere.center.toArray(),\n\t\t\t\tradius: boundingSphere.radius\n\t\t\t};\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\t// reset\n\n\t\tthis.index = null;\n\t\tthis.attributes = {};\n\t\tthis.morphAttributes = {};\n\t\tthis.groups = [];\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\t// used for storing cloned, shared data\n\n\t\tconst data = {};\n\n\t\t// name\n\n\t\tthis.name = source.name;\n\n\t\t// index\n\n\t\tconst index = source.index;\n\n\t\tif ( index !== null ) {\n\n\t\t\tthis.setIndex( index.clone( data ) );\n\n\t\t}\n\n\t\t// attributes\n\n\t\tconst attributes = source.attributes;\n\n\t\tfor ( const name in attributes ) {\n\n\t\t\tconst attribute = attributes[ name ];\n\t\t\tthis.setAttribute( name, attribute.clone( data ) );\n\n\t\t}\n\n\t\t// morph attributes\n\n\t\tconst morphAttributes = source.morphAttributes;\n\n\t\tfor ( const name in morphAttributes ) {\n\n\t\t\tconst array = [];\n\t\t\tconst morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\n\n\t\t\tfor ( let i = 0, l = morphAttribute.length; i < l; i ++ ) {\n\n\t\t\t\tarray.push( morphAttribute[ i ].clone( data ) );\n\n\t\t\t}\n\n\t\t\tthis.morphAttributes[ name ] = array;\n\n\t\t}\n\n\t\tthis.morphTargetsRelative = source.morphTargetsRelative;\n\n\t\t// groups\n\n\t\tconst groups = source.groups;\n\n\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\tconst group = groups[ i ];\n\t\t\tthis.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t}\n\n\t\t// bounding box\n\n\t\tconst boundingBox = source.boundingBox;\n\n\t\tif ( boundingBox !== null ) {\n\n\t\t\tthis.boundingBox = boundingBox.clone();\n\n\t\t}\n\n\t\t// bounding sphere\n\n\t\tconst boundingSphere = source.boundingSphere;\n\n\t\tif ( boundingSphere !== null ) {\n\n\t\t\tthis.boundingSphere = boundingSphere.clone();\n\n\t\t}\n\n\t\t// draw range\n\n\t\tthis.drawRange.start = source.drawRange.start;\n\t\tthis.drawRange.count = source.drawRange.count;\n\n\t\t// user data\n\n\t\tthis.userData = source.userData;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n}\n\nconst _inverseMatrix$3 = /*@__PURE__*/ new Matrix4();\nconst _ray$3 = /*@__PURE__*/ new Ray();\nconst _sphere$6 = /*@__PURE__*/ new Sphere();\nconst _sphereHitAt = /*@__PURE__*/ new Vector3();\n\nconst _vA$1 = /*@__PURE__*/ new Vector3();\nconst _vB$1 = /*@__PURE__*/ new Vector3();\nconst _vC$1 = /*@__PURE__*/ new Vector3();\n\nconst _tempA = /*@__PURE__*/ new Vector3();\nconst _morphA = /*@__PURE__*/ new Vector3();\n\nconst _intersectionPoint = /*@__PURE__*/ new Vector3();\nconst _intersectionPointWorld = /*@__PURE__*/ new Vector3();\n\nclass Mesh extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new MeshBasicMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.isMesh = true;\n\n\t\tthis.type = 'Mesh';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tif ( source.morphTargetInfluences !== undefined ) {\n\n\t\t\tthis.morphTargetInfluences = source.morphTargetInfluences.slice();\n\n\t\t}\n\n\t\tif ( source.morphTargetDictionary !== undefined ) {\n\n\t\t\tthis.morphTargetDictionary = Object.assign( {}, source.morphTargetDictionary );\n\n\t\t}\n\n\t\tthis.material = Array.isArray( source.material ) ? source.material.slice() : source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tconst morphAttributes = geometry.morphAttributes;\n\t\tconst keys = Object.keys( morphAttributes );\n\n\t\tif ( keys.length > 0 ) {\n\n\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgetVertexPosition( index, target ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst position = geometry.attributes.position;\n\t\tconst morphPosition = geometry.morphAttributes.position;\n\t\tconst morphTargetsRelative = geometry.morphTargetsRelative;\n\n\t\ttarget.fromBufferAttribute( position, index );\n\n\t\tconst morphInfluences = this.morphTargetInfluences;\n\n\t\tif ( morphPosition && morphInfluences ) {\n\n\t\t\t_morphA.set( 0, 0, 0 );\n\n\t\t\tfor ( let i = 0, il = morphPosition.length; i < il; i ++ ) {\n\n\t\t\t\tconst influence = morphInfluences[ i ];\n\t\t\t\tconst morphAttribute = morphPosition[ i ];\n\n\t\t\t\tif ( influence === 0 ) continue;\n\n\t\t\t\t_tempA.fromBufferAttribute( morphAttribute, index );\n\n\t\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA, influence );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA.sub( target ), influence );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttarget.add( _morphA );\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst material = this.material;\n\t\tconst matrixWorld = this.matrixWorld;\n\n\t\tif ( material === undefined ) return;\n\n\t\t// test with bounding sphere in world space\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere$6.copy( geometry.boundingSphere );\n\t\t_sphere$6.applyMatrix4( matrixWorld );\n\n\t\t// check distance from ray origin to bounding sphere\n\n\t\t_ray$3.copy( raycaster.ray ).recast( raycaster.near );\n\n\t\tif ( _sphere$6.containsPoint( _ray$3.origin ) === false ) {\n\n\t\t\tif ( _ray$3.intersectSphere( _sphere$6, _sphereHitAt ) === null ) return;\n\n\t\t\tif ( _ray$3.origin.distanceToSquared( _sphereHitAt ) > ( raycaster.far - raycaster.near ) ** 2 ) return;\n\n\t\t}\n\n\t\t// convert ray to local space of mesh\n\n\t\t_inverseMatrix$3.copy( matrixWorld ).invert();\n\t\t_ray$3.copy( raycaster.ray ).applyMatrix4( _inverseMatrix$3 );\n\n\t\t// test with bounding box in local space\n\n\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\tif ( _ray$3.intersectsBox( geometry.boundingBox ) === false ) return;\n\n\t\t}\n\n\t\t// test for intersections with geometry\n\n\t\tthis._computeIntersections( raycaster, intersects, _ray$3 );\n\n\t}\n\n\t_computeIntersections( raycaster, intersects, rayLocalSpace ) {\n\n\t\tlet intersection;\n\n\t\tconst geometry = this.geometry;\n\t\tconst material = this.material;\n\n\t\tconst index = geometry.index;\n\t\tconst position = geometry.attributes.position;\n\t\tconst uv = geometry.attributes.uv;\n\t\tconst uv1 = geometry.attributes.uv1;\n\t\tconst normal = geometry.attributes.normal;\n\t\tconst groups = geometry.groups;\n\t\tconst drawRange = geometry.drawRange;\n\n\t\tif ( index !== null ) {\n\n\t\t\t// indexed buffer geometry\n\n\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\tfor ( let i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\tconst start = Math.max( group.start, drawRange.start );\n\t\t\t\t\tconst end = Math.min( index.count, Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) ) );\n\n\t\t\t\t\tfor ( let j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\t\tconst a = index.getX( j );\n\t\t\t\t\t\tconst b = index.getX( j + 1 );\n\t\t\t\t\t\tconst c = index.getX( j + 2 );\n\n\t\t\t\t\t\tintersection = checkGeometryIntersection( this, groupMaterial, raycaster, rayLocalSpace, uv, uv1, normal, a, b, c );\n\n\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in indexed buffer semantics\n\t\t\t\t\t\t\tintersection.face.materialIndex = group.materialIndex;\n\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\t\tconst a = index.getX( i );\n\t\t\t\t\tconst b = index.getX( i + 1 );\n\t\t\t\t\tconst c = index.getX( i + 2 );\n\n\t\t\t\t\tintersection = checkGeometryIntersection( this, material, raycaster, rayLocalSpace, uv, uv1, normal, a, b, c );\n\n\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in indexed buffer semantics\n\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( position !== undefined ) {\n\n\t\t\t// non-indexed buffer geometry\n\n\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\tfor ( let i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\tconst start = Math.max( group.start, drawRange.start );\n\t\t\t\t\tconst end = Math.min( position.count, Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) ) );\n\n\t\t\t\t\tfor ( let j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\t\tconst a = j;\n\t\t\t\t\t\tconst b = j + 1;\n\t\t\t\t\t\tconst c = j + 2;\n\n\t\t\t\t\t\tintersection = checkGeometryIntersection( this, groupMaterial, raycaster, rayLocalSpace, uv, uv1, normal, a, b, c );\n\n\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in non-indexed buffer semantics\n\t\t\t\t\t\t\tintersection.face.materialIndex = group.materialIndex;\n\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( position.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\t\tconst a = i;\n\t\t\t\t\tconst b = i + 1;\n\t\t\t\t\tconst c = i + 2;\n\n\t\t\t\t\tintersection = checkGeometryIntersection( this, material, raycaster, rayLocalSpace, uv, uv1, normal, a, b, c );\n\n\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in non-indexed buffer semantics\n\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nfunction checkIntersection$1( object, material, raycaster, ray, pA, pB, pC, point ) {\n\n\tlet intersect;\n\n\tif ( material.side === BackSide ) {\n\n\t\tintersect = ray.intersectTriangle( pC, pB, pA, true, point );\n\n\t} else {\n\n\t\tintersect = ray.intersectTriangle( pA, pB, pC, ( material.side === FrontSide ), point );\n\n\t}\n\n\tif ( intersect === null ) return null;\n\n\t_intersectionPointWorld.copy( point );\n\t_intersectionPointWorld.applyMatrix4( object.matrixWorld );\n\n\tconst distance = raycaster.ray.origin.distanceTo( _intersectionPointWorld );\n\n\tif ( distance < raycaster.near || distance > raycaster.far ) return null;\n\n\treturn {\n\t\tdistance: distance,\n\t\tpoint: _intersectionPointWorld.clone(),\n\t\tobject: object\n\t};\n\n}\n\nfunction checkGeometryIntersection( object, material, raycaster, ray, uv, uv1, normal, a, b, c ) {\n\n\tobject.getVertexPosition( a, _vA$1 );\n\tobject.getVertexPosition( b, _vB$1 );\n\tobject.getVertexPosition( c, _vC$1 );\n\n\tconst intersection = checkIntersection$1( object, material, raycaster, ray, _vA$1, _vB$1, _vC$1, _intersectionPoint );\n\n\tif ( intersection ) {\n\n\t\tconst barycoord = new Vector3();\n\t\tTriangle.getBarycoord( _intersectionPoint, _vA$1, _vB$1, _vC$1, barycoord );\n\n\t\tif ( uv ) {\n\n\t\t\tintersection.uv = Triangle.getInterpolatedAttribute( uv, a, b, c, barycoord, new Vector2() );\n\n\t\t}\n\n\t\tif ( uv1 ) {\n\n\t\t\tintersection.uv1 = Triangle.getInterpolatedAttribute( uv1, a, b, c, barycoord, new Vector2() );\n\n\t\t}\n\n\t\tif ( normal ) {\n\n\t\t\tintersection.normal = Triangle.getInterpolatedAttribute( normal, a, b, c, barycoord, new Vector3() );\n\n\t\t\tif ( intersection.normal.dot( ray.direction ) > 0 ) {\n\n\t\t\t\tintersection.normal.multiplyScalar( - 1 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst face = {\n\t\t\ta: a,\n\t\t\tb: b,\n\t\t\tc: c,\n\t\t\tnormal: new Vector3(),\n\t\t\tmaterialIndex: 0\n\t\t};\n\n\t\tTriangle.getNormal( _vA$1, _vB$1, _vC$1, face.normal );\n\n\t\tintersection.face = face;\n\t\tintersection.barycoord = barycoord;\n\n\t}\n\n\treturn intersection;\n\n}\n\nclass BoxGeometry extends BufferGeometry {\n\n\tconstructor( width = 1, height = 1, depth = 1, widthSegments = 1, heightSegments = 1, depthSegments = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'BoxGeometry';\n\n\t\tthis.parameters = {\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\tdepth: depth,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\tdepthSegments: depthSegments\n\t\t};\n\n\t\tconst scope = this;\n\n\t\t// segments\n\n\t\twidthSegments = Math.floor( widthSegments );\n\t\theightSegments = Math.floor( heightSegments );\n\t\tdepthSegments = Math.floor( depthSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tlet numberOfVertices = 0;\n\t\tlet groupStart = 0;\n\n\t\t// build each side of the box geometry\n\n\t\tbuildPlane( 'z', 'y', 'x', - 1, - 1, depth, height, width, depthSegments, heightSegments, 0 ); // px\n\t\tbuildPlane( 'z', 'y', 'x', 1, - 1, depth, height, - width, depthSegments, heightSegments, 1 ); // nx\n\t\tbuildPlane( 'x', 'z', 'y', 1, 1, width, depth, height, widthSegments, depthSegments, 2 ); // py\n\t\tbuildPlane( 'x', 'z', 'y', 1, - 1, width, depth, - height, widthSegments, depthSegments, 3 ); // ny\n\t\tbuildPlane( 'x', 'y', 'z', 1, - 1, width, height, depth, widthSegments, heightSegments, 4 ); // pz\n\t\tbuildPlane( 'x', 'y', 'z', - 1, - 1, width, height, - depth, widthSegments, heightSegments, 5 ); // nz\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\tfunction buildPlane( u, v, w, udir, vdir, width, height, depth, gridX, gridY, materialIndex ) {\n\n\t\t\tconst segmentWidth = width / gridX;\n\t\t\tconst segmentHeight = height / gridY;\n\n\t\t\tconst widthHalf = width / 2;\n\t\t\tconst heightHalf = height / 2;\n\t\t\tconst depthHalf = depth / 2;\n\n\t\t\tconst gridX1 = gridX + 1;\n\t\t\tconst gridY1 = gridY + 1;\n\n\t\t\tlet vertexCounter = 0;\n\t\t\tlet groupCount = 0;\n\n\t\t\tconst vector = new Vector3();\n\n\t\t\t// generate vertices, normals and uvs\n\n\t\t\tfor ( let iy = 0; iy < gridY1; iy ++ ) {\n\n\t\t\t\tconst y = iy * segmentHeight - heightHalf;\n\n\t\t\t\tfor ( let ix = 0; ix < gridX1; ix ++ ) {\n\n\t\t\t\t\tconst x = ix * segmentWidth - widthHalf;\n\n\t\t\t\t\t// set values to correct vector component\n\n\t\t\t\t\tvector[ u ] = x * udir;\n\t\t\t\t\tvector[ v ] = y * vdir;\n\t\t\t\t\tvector[ w ] = depthHalf;\n\n\t\t\t\t\t// now apply vector to vertex buffer\n\n\t\t\t\t\tvertices.push( vector.x, vector.y, vector.z );\n\n\t\t\t\t\t// set values to correct vector component\n\n\t\t\t\t\tvector[ u ] = 0;\n\t\t\t\t\tvector[ v ] = 0;\n\t\t\t\t\tvector[ w ] = depth > 0 ? 1 : - 1;\n\n\t\t\t\t\t// now apply vector to normal buffer\n\n\t\t\t\t\tnormals.push( vector.x, vector.y, vector.z );\n\n\t\t\t\t\t// uvs\n\n\t\t\t\t\tuvs.push( ix / gridX );\n\t\t\t\t\tuvs.push( 1 - ( iy / gridY ) );\n\n\t\t\t\t\t// counters\n\n\t\t\t\t\tvertexCounter += 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// indices\n\n\t\t\t// 1. you need three indices to draw a single face\n\t\t\t// 2. a single segment consists of two faces\n\t\t\t// 3. so we need to generate six (2*3) indices per segment\n\n\t\t\tfor ( let iy = 0; iy < gridY; iy ++ ) {\n\n\t\t\t\tfor ( let ix = 0; ix < gridX; ix ++ ) {\n\n\t\t\t\t\tconst a = numberOfVertices + ix + gridX1 * iy;\n\t\t\t\t\tconst b = numberOfVertices + ix + gridX1 * ( iy + 1 );\n\t\t\t\t\tconst c = numberOfVertices + ( ix + 1 ) + gridX1 * ( iy + 1 );\n\t\t\t\t\tconst d = numberOfVertices + ( ix + 1 ) + gridX1 * iy;\n\n\t\t\t\t\t// faces\n\n\t\t\t\t\tindices.push( a, b, d );\n\t\t\t\t\tindices.push( b, c, d );\n\n\t\t\t\t\t// increase counter\n\n\t\t\t\t\tgroupCount += 6;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\n\t\t\tscope.addGroup( groupStart, groupCount, materialIndex );\n\n\t\t\t// calculate new start value for groups\n\n\t\t\tgroupStart += groupCount;\n\n\t\t\t// update total number of vertices\n\n\t\t\tnumberOfVertices += vertexCounter;\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new BoxGeometry( data.width, data.height, data.depth, data.widthSegments, data.heightSegments, data.depthSegments );\n\n\t}\n\n}\n\n/**\n * Uniform Utilities\n */\n\nfunction cloneUniforms( src ) {\n\n\tconst dst = {};\n\n\tfor ( const u in src ) {\n\n\t\tdst[ u ] = {};\n\n\t\tfor ( const p in src[ u ] ) {\n\n\t\t\tconst property = src[ u ][ p ];\n\n\t\t\tif ( property && ( property.isColor ||\n\t\t\t\tproperty.isMatrix3 || property.isMatrix4 ||\n\t\t\t\tproperty.isVector2 || property.isVector3 || property.isVector4 ||\n\t\t\t\tproperty.isTexture || property.isQuaternion ) ) {\n\n\t\t\t\tif ( property.isRenderTargetTexture ) {\n\n\t\t\t\t\tconsole.warn( 'UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms().' );\n\t\t\t\t\tdst[ u ][ p ] = null;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdst[ u ][ p ] = property.clone();\n\n\t\t\t\t}\n\n\t\t\t} else if ( Array.isArray( property ) ) {\n\n\t\t\t\tdst[ u ][ p ] = property.slice();\n\n\t\t\t} else {\n\n\t\t\t\tdst[ u ][ p ] = property;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn dst;\n\n}\n\nfunction mergeUniforms( uniforms ) {\n\n\tconst merged = {};\n\n\tfor ( let u = 0; u < uniforms.length; u ++ ) {\n\n\t\tconst tmp = cloneUniforms( uniforms[ u ] );\n\n\t\tfor ( const p in tmp ) {\n\n\t\t\tmerged[ p ] = tmp[ p ];\n\n\t\t}\n\n\t}\n\n\treturn merged;\n\n}\n\nfunction cloneUniformsGroups( src ) {\n\n\tconst dst = [];\n\n\tfor ( let u = 0; u < src.length; u ++ ) {\n\n\t\tdst.push( src[ u ].clone() );\n\n\t}\n\n\treturn dst;\n\n}\n\nfunction getUnlitUniformColorSpace( renderer ) {\n\n\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\tif ( currentRenderTarget === null ) {\n\n\t\t// https://github.com/mrdoob/three.js/pull/23937#issuecomment-1111067398\n\t\treturn renderer.outputColorSpace;\n\n\t}\n\n\t// https://github.com/mrdoob/three.js/issues/27868\n\tif ( currentRenderTarget.isXRRenderTarget === true ) {\n\n\t\treturn currentRenderTarget.texture.colorSpace;\n\n\t}\n\n\treturn ColorManagement.workingColorSpace;\n\n}\n\n// Legacy\n\nconst UniformsUtils = { clone: cloneUniforms, merge: mergeUniforms };\n\nvar default_vertex = \"void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}\";\n\nvar default_fragment = \"void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}\";\n\nclass ShaderMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isShaderMaterial = true;\n\n\t\tthis.type = 'ShaderMaterial';\n\n\t\tthis.defines = {};\n\t\tthis.uniforms = {};\n\t\tthis.uniformsGroups = [];\n\n\t\tthis.vertexShader = default_vertex;\n\t\tthis.fragmentShader = default_fragment;\n\n\t\tthis.linewidth = 1;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.fog = false; // set to use scene fog\n\t\tthis.lights = false; // set to use scene lights\n\t\tthis.clipping = false; // set to use user-defined clipping planes\n\n\t\tthis.forceSinglePass = true;\n\n\t\tthis.extensions = {\n\t\t\tclipCullDistance: false, // set to use vertex shader clipping\n\t\t\tmultiDraw: false // set to use vertex shader multi_draw / enable gl_DrawID\n\t\t};\n\n\t\t// When rendered geometry doesn't include these attributes but the material does,\n\t\t// use these default values in WebGL. This avoids errors when buffer data is missing.\n\t\tthis.defaultAttributeValues = {\n\t\t\t'color': [ 1, 1, 1 ],\n\t\t\t'uv': [ 0, 0 ],\n\t\t\t'uv1': [ 0, 0 ]\n\t\t};\n\n\t\tthis.index0AttributeName = undefined;\n\t\tthis.uniformsNeedUpdate = false;\n\n\t\tthis.glslVersion = null;\n\n\t\tif ( parameters !== undefined ) {\n\n\t\t\tthis.setValues( parameters );\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.fragmentShader = source.fragmentShader;\n\t\tthis.vertexShader = source.vertexShader;\n\n\t\tthis.uniforms = cloneUniforms( source.uniforms );\n\t\tthis.uniformsGroups = cloneUniformsGroups( source.uniformsGroups );\n\n\t\tthis.defines = Object.assign( {}, source.defines );\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\tthis.fog = source.fog;\n\t\tthis.lights = source.lights;\n\t\tthis.clipping = source.clipping;\n\n\t\tthis.extensions = Object.assign( {}, source.extensions );\n\n\t\tthis.glslVersion = source.glslVersion;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.glslVersion = this.glslVersion;\n\t\tdata.uniforms = {};\n\n\t\tfor ( const name in this.uniforms ) {\n\n\t\t\tconst uniform = this.uniforms[ name ];\n\t\t\tconst value = uniform.value;\n\n\t\t\tif ( value && value.isTexture ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 't',\n\t\t\t\t\tvalue: value.toJSON( meta ).uuid\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isColor ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'c',\n\t\t\t\t\tvalue: value.getHex()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector2 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v2',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector3 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v3',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector4 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v4',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isMatrix3 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'm3',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isMatrix4 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'm4',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\tvalue: value\n\t\t\t\t};\n\n\t\t\t\t// note: the array variants v2v, v3v, v4v, m4v and tv are not supported so far\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( Object.keys( this.defines ).length > 0 ) data.defines = this.defines;\n\n\t\tdata.vertexShader = this.vertexShader;\n\t\tdata.fragmentShader = this.fragmentShader;\n\n\t\tdata.lights = this.lights;\n\t\tdata.clipping = this.clipping;\n\n\t\tconst extensions = {};\n\n\t\tfor ( const key in this.extensions ) {\n\n\t\t\tif ( this.extensions[ key ] === true ) extensions[ key ] = true;\n\n\t\t}\n\n\t\tif ( Object.keys( extensions ).length > 0 ) data.extensions = extensions;\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass Camera extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isCamera = true;\n\n\t\tthis.type = 'Camera';\n\n\t\tthis.matrixWorldInverse = new Matrix4();\n\n\t\tthis.projectionMatrix = new Matrix4();\n\t\tthis.projectionMatrixInverse = new Matrix4();\n\n\t\tthis.coordinateSystem = WebGLCoordinateSystem;\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.matrixWorldInverse.copy( source.matrixWorldInverse );\n\n\t\tthis.projectionMatrix.copy( source.projectionMatrix );\n\t\tthis.projectionMatrixInverse.copy( source.projectionMatrixInverse );\n\n\t\tthis.coordinateSystem = source.coordinateSystem;\n\n\t\treturn this;\n\n\t}\n\n\tgetWorldDirection( target ) {\n\n\t\treturn super.getWorldDirection( target ).negate();\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tthis.matrixWorldInverse.copy( this.matrixWorld ).invert();\n\n\t}\n\n\tupdateWorldMatrix( updateParents, updateChildren ) {\n\n\t\tsuper.updateWorldMatrix( updateParents, updateChildren );\n\n\t\tthis.matrixWorldInverse.copy( this.matrixWorld ).invert();\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nconst _v3$1 = /*@__PURE__*/ new Vector3();\nconst _minTarget = /*@__PURE__*/ new Vector2();\nconst _maxTarget = /*@__PURE__*/ new Vector2();\n\n\nclass PerspectiveCamera extends Camera {\n\n\tconstructor( fov = 50, aspect = 1, near = 0.1, far = 2000 ) {\n\n\t\tsuper();\n\n\t\tthis.isPerspectiveCamera = true;\n\n\t\tthis.type = 'PerspectiveCamera';\n\n\t\tthis.fov = fov;\n\t\tthis.zoom = 1;\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\t\tthis.focus = 10;\n\n\t\tthis.aspect = aspect;\n\t\tthis.view = null;\n\n\t\tthis.filmGauge = 35;\t// width of the film (default in millimeters)\n\t\tthis.filmOffset = 0;\t// horizontal film offset (same unit as gauge)\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.fov = source.fov;\n\t\tthis.zoom = source.zoom;\n\n\t\tthis.near = source.near;\n\t\tthis.far = source.far;\n\t\tthis.focus = source.focus;\n\n\t\tthis.aspect = source.aspect;\n\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\n\t\tthis.filmGauge = source.filmGauge;\n\t\tthis.filmOffset = source.filmOffset;\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Sets the FOV by focal length in respect to the current .filmGauge.\n\t *\n\t * The default film gauge is 35, so that the focal length can be specified for\n\t * a 35mm (full frame) camera.\n\t *\n\t * Values for focal length and film gauge must have the same unit.\n\t */\n\tsetFocalLength( focalLength ) {\n\n\t\t/** see {@link http://www.bobatkins.com/photography/technical/field_of_view.html} */\n\t\tconst vExtentSlope = 0.5 * this.getFilmHeight() / focalLength;\n\n\t\tthis.fov = RAD2DEG * 2 * Math.atan( vExtentSlope );\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\t/**\n\t * Calculates the focal length from the current .fov and .filmGauge.\n\t */\n\tgetFocalLength() {\n\n\t\tconst vExtentSlope = Math.tan( DEG2RAD * 0.5 * this.fov );\n\n\t\treturn 0.5 * this.getFilmHeight() / vExtentSlope;\n\n\t}\n\n\tgetEffectiveFOV() {\n\n\t\treturn RAD2DEG * 2 * Math.atan(\n\t\t\tMath.tan( DEG2RAD * 0.5 * this.fov ) / this.zoom );\n\n\t}\n\n\tgetFilmWidth() {\n\n\t\t// film not completely covered in portrait format (aspect < 1)\n\t\treturn this.filmGauge * Math.min( this.aspect, 1 );\n\n\t}\n\n\tgetFilmHeight() {\n\n\t\t// film not completely covered in landscape format (aspect > 1)\n\t\treturn this.filmGauge / Math.max( this.aspect, 1 );\n\n\t}\n\n\t/**\n\t * Computes the 2D bounds of the camera's viewable rectangle at a given distance along the viewing direction.\n\t * Sets minTarget and maxTarget to the coordinates of the lower-left and upper-right corners of the view rectangle.\n\t */\n\tgetViewBounds( distance, minTarget, maxTarget ) {\n\n\t\t_v3$1.set( - 1, - 1, 0.5 ).applyMatrix4( this.projectionMatrixInverse );\n\n\t\tminTarget.set( _v3$1.x, _v3$1.y ).multiplyScalar( - distance / _v3$1.z );\n\n\t\t_v3$1.set( 1, 1, 0.5 ).applyMatrix4( this.projectionMatrixInverse );\n\n\t\tmaxTarget.set( _v3$1.x, _v3$1.y ).multiplyScalar( - distance / _v3$1.z );\n\n\t}\n\n\t/**\n\t * Computes the width and height of the camera's viewable rectangle at a given distance along the viewing direction.\n\t * Copies the result into the target Vector2, where x is width and y is height.\n\t */\n\tgetViewSize( distance, target ) {\n\n\t\tthis.getViewBounds( distance, _minTarget, _maxTarget );\n\n\t\treturn target.subVectors( _maxTarget, _minTarget );\n\n\t}\n\n\t/**\n\t * Sets an offset in a larger frustum. This is useful for multi-window or\n\t * multi-monitor/multi-machine setups.\n\t *\n\t * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\n\t * the monitors are in grid like this\n\t *\n\t *   +---+---+---+\n\t *   | A | B | C |\n\t *   +---+---+---+\n\t *   | D | E | F |\n\t *   +---+---+---+\n\t *\n\t * then for each monitor you would call it like this\n\t *\n\t *   const w = 1920;\n\t *   const h = 1080;\n\t *   const fullWidth = w * 3;\n\t *   const fullHeight = h * 2;\n\t *\n\t *   --A--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\n\t *   --B--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\n\t *   --C--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\n\t *   --D--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\n\t *   --E--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\n\t *   --F--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\n\t *\n\t *   Note there is no reason monitors have to be the same size or in a grid.\n\t */\n\tsetViewOffset( fullWidth, fullHeight, x, y, width, height ) {\n\n\t\tthis.aspect = fullWidth / fullHeight;\n\n\t\tif ( this.view === null ) {\n\n\t\t\tthis.view = {\n\t\t\t\tenabled: true,\n\t\t\t\tfullWidth: 1,\n\t\t\t\tfullHeight: 1,\n\t\t\t\toffsetX: 0,\n\t\t\t\toffsetY: 0,\n\t\t\t\twidth: 1,\n\t\t\t\theight: 1\n\t\t\t};\n\n\t\t}\n\n\t\tthis.view.enabled = true;\n\t\tthis.view.fullWidth = fullWidth;\n\t\tthis.view.fullHeight = fullHeight;\n\t\tthis.view.offsetX = x;\n\t\tthis.view.offsetY = y;\n\t\tthis.view.width = width;\n\t\tthis.view.height = height;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tclearViewOffset() {\n\n\t\tif ( this.view !== null ) {\n\n\t\t\tthis.view.enabled = false;\n\n\t\t}\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tupdateProjectionMatrix() {\n\n\t\tconst near = this.near;\n\t\tlet top = near * Math.tan( DEG2RAD * 0.5 * this.fov ) / this.zoom;\n\t\tlet height = 2 * top;\n\t\tlet width = this.aspect * height;\n\t\tlet left = - 0.5 * width;\n\t\tconst view = this.view;\n\n\t\tif ( this.view !== null && this.view.enabled ) {\n\n\t\t\tconst fullWidth = view.fullWidth,\n\t\t\t\tfullHeight = view.fullHeight;\n\n\t\t\tleft += view.offsetX * width / fullWidth;\n\t\t\ttop -= view.offsetY * height / fullHeight;\n\t\t\twidth *= view.width / fullWidth;\n\t\t\theight *= view.height / fullHeight;\n\n\t\t}\n\n\t\tconst skew = this.filmOffset;\n\t\tif ( skew !== 0 ) left += near * skew / this.getFilmWidth();\n\n\t\tthis.projectionMatrix.makePerspective( left, left + width, top, top - height, near, this.far, this.coordinateSystem );\n\n\t\tthis.projectionMatrixInverse.copy( this.projectionMatrix ).invert();\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.fov = this.fov;\n\t\tdata.object.zoom = this.zoom;\n\n\t\tdata.object.near = this.near;\n\t\tdata.object.far = this.far;\n\t\tdata.object.focus = this.focus;\n\n\t\tdata.object.aspect = this.aspect;\n\n\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\n\n\t\tdata.object.filmGauge = this.filmGauge;\n\t\tdata.object.filmOffset = this.filmOffset;\n\n\t\treturn data;\n\n\t}\n\n}\n\nconst fov = - 90; // negative fov is not an error\nconst aspect = 1;\n\nclass CubeCamera extends Object3D {\n\n\tconstructor( near, far, renderTarget ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CubeCamera';\n\n\t\tthis.renderTarget = renderTarget;\n\t\tthis.coordinateSystem = null;\n\t\tthis.activeMipmapLevel = 0;\n\n\t\tconst cameraPX = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPX.layers = this.layers;\n\t\tthis.add( cameraPX );\n\n\t\tconst cameraNX = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNX.layers = this.layers;\n\t\tthis.add( cameraNX );\n\n\t\tconst cameraPY = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPY.layers = this.layers;\n\t\tthis.add( cameraPY );\n\n\t\tconst cameraNY = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNY.layers = this.layers;\n\t\tthis.add( cameraNY );\n\n\t\tconst cameraPZ = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPZ.layers = this.layers;\n\t\tthis.add( cameraPZ );\n\n\t\tconst cameraNZ = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNZ.layers = this.layers;\n\t\tthis.add( cameraNZ );\n\n\t}\n\n\tupdateCoordinateSystem() {\n\n\t\tconst coordinateSystem = this.coordinateSystem;\n\n\t\tconst cameras = this.children.concat();\n\n\t\tconst [ cameraPX, cameraNX, cameraPY, cameraNY, cameraPZ, cameraNZ ] = cameras;\n\n\t\tfor ( const camera of cameras ) this.remove( camera );\n\n\t\tif ( coordinateSystem === WebGLCoordinateSystem ) {\n\n\t\t\tcameraPX.up.set( 0, 1, 0 );\n\t\t\tcameraPX.lookAt( 1, 0, 0 );\n\n\t\t\tcameraNX.up.set( 0, 1, 0 );\n\t\t\tcameraNX.lookAt( - 1, 0, 0 );\n\n\t\t\tcameraPY.up.set( 0, 0, - 1 );\n\t\t\tcameraPY.lookAt( 0, 1, 0 );\n\n\t\t\tcameraNY.up.set( 0, 0, 1 );\n\t\t\tcameraNY.lookAt( 0, - 1, 0 );\n\n\t\t\tcameraPZ.up.set( 0, 1, 0 );\n\t\t\tcameraPZ.lookAt( 0, 0, 1 );\n\n\t\t\tcameraNZ.up.set( 0, 1, 0 );\n\t\t\tcameraNZ.lookAt( 0, 0, - 1 );\n\n\t\t} else if ( coordinateSystem === WebGPUCoordinateSystem ) {\n\n\t\t\tcameraPX.up.set( 0, - 1, 0 );\n\t\t\tcameraPX.lookAt( - 1, 0, 0 );\n\n\t\t\tcameraNX.up.set( 0, - 1, 0 );\n\t\t\tcameraNX.lookAt( 1, 0, 0 );\n\n\t\t\tcameraPY.up.set( 0, 0, 1 );\n\t\t\tcameraPY.lookAt( 0, 1, 0 );\n\n\t\t\tcameraNY.up.set( 0, 0, - 1 );\n\t\t\tcameraNY.lookAt( 0, - 1, 0 );\n\n\t\t\tcameraPZ.up.set( 0, - 1, 0 );\n\t\t\tcameraPZ.lookAt( 0, 0, 1 );\n\n\t\t\tcameraNZ.up.set( 0, - 1, 0 );\n\t\t\tcameraNZ.lookAt( 0, 0, - 1 );\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: ' + coordinateSystem );\n\n\t\t}\n\n\t\tfor ( const camera of cameras ) {\n\n\t\t\tthis.add( camera );\n\n\t\t\tcamera.updateMatrixWorld();\n\n\t\t}\n\n\t}\n\n\tupdate( renderer, scene ) {\n\n\t\tif ( this.parent === null ) this.updateMatrixWorld();\n\n\t\tconst { renderTarget, activeMipmapLevel } = this;\n\n\t\tif ( this.coordinateSystem !== renderer.coordinateSystem ) {\n\n\t\t\tthis.coordinateSystem = renderer.coordinateSystem;\n\n\t\t\tthis.updateCoordinateSystem();\n\n\t\t}\n\n\t\tconst [ cameraPX, cameraNX, cameraPY, cameraNY, cameraPZ, cameraNZ ] = this.children;\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\t\tconst currentActiveCubeFace = renderer.getActiveCubeFace();\n\t\tconst currentActiveMipmapLevel = renderer.getActiveMipmapLevel();\n\n\t\tconst currentXrEnabled = renderer.xr.enabled;\n\n\t\trenderer.xr.enabled = false;\n\n\t\tconst generateMipmaps = renderTarget.texture.generateMipmaps;\n\n\t\trenderTarget.texture.generateMipmaps = false;\n\n\t\trenderer.setRenderTarget( renderTarget, 0, activeMipmapLevel );\n\t\trenderer.render( scene, cameraPX );\n\n\t\trenderer.setRenderTarget( renderTarget, 1, activeMipmapLevel );\n\t\trenderer.render( scene, cameraNX );\n\n\t\trenderer.setRenderTarget( renderTarget, 2, activeMipmapLevel );\n\t\trenderer.render( scene, cameraPY );\n\n\t\trenderer.setRenderTarget( renderTarget, 3, activeMipmapLevel );\n\t\trenderer.render( scene, cameraNY );\n\n\t\trenderer.setRenderTarget( renderTarget, 4, activeMipmapLevel );\n\t\trenderer.render( scene, cameraPZ );\n\n\t\t// mipmaps are generated during the last call of render()\n\t\t// at this point, all sides of the cube render target are defined\n\n\t\trenderTarget.texture.generateMipmaps = generateMipmaps;\n\n\t\trenderer.setRenderTarget( renderTarget, 5, activeMipmapLevel );\n\t\trenderer.render( scene, cameraNZ );\n\n\t\trenderer.setRenderTarget( currentRenderTarget, currentActiveCubeFace, currentActiveMipmapLevel );\n\n\t\trenderer.xr.enabled = currentXrEnabled;\n\n\t\trenderTarget.texture.needsPMREMUpdate = true;\n\n\t}\n\n}\n\nclass CubeTexture extends Texture {\n\n\tconstructor( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, colorSpace ) {\n\n\t\timages = images !== undefined ? images : [];\n\t\tmapping = mapping !== undefined ? mapping : CubeReflectionMapping;\n\n\t\tsuper( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, colorSpace );\n\n\t\tthis.isCubeTexture = true;\n\n\t\tthis.flipY = false;\n\n\t}\n\n\tget images() {\n\n\t\treturn this.image;\n\n\t}\n\n\tset images( value ) {\n\n\t\tthis.image = value;\n\n\t}\n\n}\n\nclass WebGLCubeRenderTarget extends WebGLRenderTarget {\n\n\tconstructor( size = 1, options = {} ) {\n\n\t\tsuper( size, size, options );\n\n\t\tthis.isWebGLCubeRenderTarget = true;\n\n\t\tconst image = { width: size, height: size, depth: 1 };\n\t\tconst images = [ image, image, image, image, image, image ];\n\n\t\tthis.texture = new CubeTexture( images, options.mapping, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy, options.colorSpace );\n\n\t\t// By convention -- likely based on the RenderMan spec from the 1990's -- cube maps are specified by WebGL (and three.js)\n\t\t// in a coordinate system in which positive-x is to the right when looking up the positive-z axis -- in other words,\n\t\t// in a left-handed coordinate system. By continuing this convention, preexisting cube maps continued to render correctly.\n\n\t\t// three.js uses a right-handed coordinate system. So environment maps used in three.js appear to have px and nx swapped\n\t\t// and the flag isRenderTargetTexture controls this conversion. The flip is not required when using WebGLCubeRenderTarget.texture\n\t\t// as a cube texture (this is detected when isRenderTargetTexture is set to true for cube textures).\n\n\t\tthis.texture.isRenderTargetTexture = true;\n\n\t\tthis.texture.generateMipmaps = options.generateMipmaps !== undefined ? options.generateMipmaps : false;\n\t\tthis.texture.minFilter = options.minFilter !== undefined ? options.minFilter : LinearFilter;\n\n\t}\n\n\tfromEquirectangularTexture( renderer, texture ) {\n\n\t\tthis.texture.type = texture.type;\n\t\tthis.texture.colorSpace = texture.colorSpace;\n\n\t\tthis.texture.generateMipmaps = texture.generateMipmaps;\n\t\tthis.texture.minFilter = texture.minFilter;\n\t\tthis.texture.magFilter = texture.magFilter;\n\n\t\tconst shader = {\n\n\t\t\tuniforms: {\n\t\t\t\ttEquirect: { value: null },\n\t\t\t},\n\n\t\t\tvertexShader: /* glsl */`\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t`,\n\n\t\t\tfragmentShader: /* glsl */`\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t`\n\t\t};\n\n\t\tconst geometry = new BoxGeometry( 5, 5, 5 );\n\n\t\tconst material = new ShaderMaterial( {\n\n\t\t\tname: 'CubemapFromEquirect',\n\n\t\t\tuniforms: cloneUniforms( shader.uniforms ),\n\t\t\tvertexShader: shader.vertexShader,\n\t\t\tfragmentShader: shader.fragmentShader,\n\t\t\tside: BackSide,\n\t\t\tblending: NoBlending\n\n\t\t} );\n\n\t\tmaterial.uniforms.tEquirect.value = texture;\n\n\t\tconst mesh = new Mesh( geometry, material );\n\n\t\tconst currentMinFilter = texture.minFilter;\n\n\t\t// Avoid blurred poles\n\t\tif ( texture.minFilter === LinearMipmapLinearFilter ) texture.minFilter = LinearFilter;\n\n\t\tconst camera = new CubeCamera( 1, 10, this );\n\t\tcamera.update( renderer, mesh );\n\n\t\ttexture.minFilter = currentMinFilter;\n\n\t\tmesh.geometry.dispose();\n\t\tmesh.material.dispose();\n\n\t\treturn this;\n\n\t}\n\n\tclear( renderer, color, depth, stencil ) {\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\trenderer.setRenderTarget( this, i );\n\n\t\t\trenderer.clear( color, depth, stencil );\n\n\t\t}\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t}\n\n}\n\nclass FogExp2 {\n\n\tconstructor( color, density = 0.00025 ) {\n\n\t\tthis.isFogExp2 = true;\n\n\t\tthis.name = '';\n\n\t\tthis.color = new Color( color );\n\t\tthis.density = density;\n\n\t}\n\n\tclone() {\n\n\t\treturn new FogExp2( this.color, this.density );\n\n\t}\n\n\ttoJSON( /* meta */ ) {\n\n\t\treturn {\n\t\t\ttype: 'FogExp2',\n\t\t\tname: this.name,\n\t\t\tcolor: this.color.getHex(),\n\t\t\tdensity: this.density\n\t\t};\n\n\t}\n\n}\n\nclass Fog {\n\n\tconstructor( color, near = 1, far = 1000 ) {\n\n\t\tthis.isFog = true;\n\n\t\tthis.name = '';\n\n\t\tthis.color = new Color( color );\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\n\t}\n\n\tclone() {\n\n\t\treturn new Fog( this.color, this.near, this.far );\n\n\t}\n\n\ttoJSON( /* meta */ ) {\n\n\t\treturn {\n\t\t\ttype: 'Fog',\n\t\t\tname: this.name,\n\t\t\tcolor: this.color.getHex(),\n\t\t\tnear: this.near,\n\t\t\tfar: this.far\n\t\t};\n\n\t}\n\n}\n\nclass Scene extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isScene = true;\n\n\t\tthis.type = 'Scene';\n\n\t\tthis.background = null;\n\t\tthis.environment = null;\n\t\tthis.fog = null;\n\n\t\tthis.backgroundBlurriness = 0;\n\t\tthis.backgroundIntensity = 1;\n\t\tthis.backgroundRotation = new Euler();\n\n\t\tthis.environmentIntensity = 1;\n\t\tthis.environmentRotation = new Euler();\n\n\t\tthis.overrideMaterial = null;\n\n\t\tif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\n\n\t\t\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'observe', { detail: this } ) );\n\n\t\t}\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tif ( source.background !== null ) this.background = source.background.clone();\n\t\tif ( source.environment !== null ) this.environment = source.environment.clone();\n\t\tif ( source.fog !== null ) this.fog = source.fog.clone();\n\n\t\tthis.backgroundBlurriness = source.backgroundBlurriness;\n\t\tthis.backgroundIntensity = source.backgroundIntensity;\n\t\tthis.backgroundRotation.copy( source.backgroundRotation );\n\n\t\tthis.environmentIntensity = source.environmentIntensity;\n\t\tthis.environmentRotation.copy( source.environmentRotation );\n\n\t\tif ( source.overrideMaterial !== null ) this.overrideMaterial = source.overrideMaterial.clone();\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tif ( this.fog !== null ) data.object.fog = this.fog.toJSON();\n\n\t\tif ( this.backgroundBlurriness > 0 ) data.object.backgroundBlurriness = this.backgroundBlurriness;\n\t\tif ( this.backgroundIntensity !== 1 ) data.object.backgroundIntensity = this.backgroundIntensity;\n\t\tdata.object.backgroundRotation = this.backgroundRotation.toArray();\n\n\t\tif ( this.environmentIntensity !== 1 ) data.object.environmentIntensity = this.environmentIntensity;\n\t\tdata.object.environmentRotation = this.environmentRotation.toArray();\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass InterleavedBuffer {\n\n\tconstructor( array, stride ) {\n\n\t\tthis.isInterleavedBuffer = true;\n\n\t\tthis.array = array;\n\t\tthis.stride = stride;\n\t\tthis.count = array !== undefined ? array.length / stride : 0;\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.updateRanges = [];\n\n\t\tthis.version = 0;\n\n\t\tthis.uuid = generateUUID();\n\n\t}\n\n\tonUploadCallback() {}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t}\n\n\taddUpdateRange( start, count ) {\n\n\t\tthis.updateRanges.push( { start, count } );\n\n\t}\n\n\tclearUpdateRanges() {\n\n\t\tthis.updateRanges.length = 0;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.array = new source.array.constructor( source.array );\n\t\tthis.count = source.count;\n\t\tthis.stride = source.stride;\n\t\tthis.usage = source.usage;\n\n\t\treturn this;\n\n\t}\n\n\tcopyAt( index1, attribute, index2 ) {\n\n\t\tindex1 *= this.stride;\n\t\tindex2 *= attribute.stride;\n\n\t\tfor ( let i = 0, l = this.stride; i < l; i ++ ) {\n\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tset( value, offset = 0 ) {\n\n\t\tthis.array.set( value, offset );\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tif ( data.arrayBuffers === undefined ) {\n\n\t\t\tdata.arrayBuffers = {};\n\n\t\t}\n\n\t\tif ( this.array.buffer._uuid === undefined ) {\n\n\t\t\tthis.array.buffer._uuid = generateUUID();\n\n\t\t}\n\n\t\tif ( data.arrayBuffers[ this.array.buffer._uuid ] === undefined ) {\n\n\t\t\tdata.arrayBuffers[ this.array.buffer._uuid ] = this.array.slice( 0 ).buffer;\n\n\t\t}\n\n\t\tconst array = new this.array.constructor( data.arrayBuffers[ this.array.buffer._uuid ] );\n\n\t\tconst ib = new this.constructor( array, this.stride );\n\t\tib.setUsage( this.usage );\n\n\t\treturn ib;\n\n\t}\n\n\tonUpload( callback ) {\n\n\t\tthis.onUploadCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tif ( data.arrayBuffers === undefined ) {\n\n\t\t\tdata.arrayBuffers = {};\n\n\t\t}\n\n\t\t// generate UUID for array buffer if necessary\n\n\t\tif ( this.array.buffer._uuid === undefined ) {\n\n\t\t\tthis.array.buffer._uuid = generateUUID();\n\n\t\t}\n\n\t\tif ( data.arrayBuffers[ this.array.buffer._uuid ] === undefined ) {\n\n\t\t\tdata.arrayBuffers[ this.array.buffer._uuid ] = Array.from( new Uint32Array( this.array.buffer ) );\n\n\t\t}\n\n\t\t//\n\n\t\treturn {\n\t\t\tuuid: this.uuid,\n\t\t\tbuffer: this.array.buffer._uuid,\n\t\t\ttype: this.array.constructor.name,\n\t\t\tstride: this.stride\n\t\t};\n\n\t}\n\n}\n\nconst _vector$7 = /*@__PURE__*/ new Vector3();\n\nclass InterleavedBufferAttribute {\n\n\tconstructor( interleavedBuffer, itemSize, offset, normalized = false ) {\n\n\t\tthis.isInterleavedBufferAttribute = true;\n\n\t\tthis.name = '';\n\n\t\tthis.data = interleavedBuffer;\n\t\tthis.itemSize = itemSize;\n\t\tthis.offset = offset;\n\n\t\tthis.normalized = normalized;\n\n\t}\n\n\tget count() {\n\n\t\treturn this.data.count;\n\n\t}\n\n\tget array() {\n\n\t\treturn this.data.array;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tthis.data.needsUpdate = value;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tfor ( let i = 0, l = this.data.count; i < l; i ++ ) {\n\n\t\t\t_vector$7.fromBufferAttribute( this, i );\n\n\t\t\t_vector$7.applyMatrix4( m );\n\n\t\t\tthis.setXYZ( i, _vector$7.x, _vector$7.y, _vector$7.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$7.fromBufferAttribute( this, i );\n\n\t\t\t_vector$7.applyNormalMatrix( m );\n\n\t\t\tthis.setXYZ( i, _vector$7.x, _vector$7.y, _vector$7.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$7.fromBufferAttribute( this, i );\n\n\t\t\t_vector$7.transformDirection( m );\n\n\t\t\tthis.setXYZ( i, _vector$7.x, _vector$7.y, _vector$7.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index, component ) {\n\n\t\tlet value = this.array[ index * this.data.stride + this.offset + component ];\n\n\t\tif ( this.normalized ) value = denormalize( value, this.array );\n\n\t\treturn value;\n\n\t}\n\n\tsetComponent( index, component, value ) {\n\n\t\tif ( this.normalized ) value = normalize( value, this.array );\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + component ] = value;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( index, x ) {\n\n\t\tif ( this.normalized ) x = normalize( x, this.array );\n\n\t\tthis.data.array[ index * this.data.stride + this.offset ] = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( index, y ) {\n\n\t\tif ( this.normalized ) y = normalize( y, this.array );\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( index, z ) {\n\n\t\tif ( this.normalized ) z = normalize( z, this.array );\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetW( index, w ) {\n\n\t\tif ( this.normalized ) w = normalize( w, this.array );\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tgetX( index ) {\n\n\t\tlet x = this.data.array[ index * this.data.stride + this.offset ];\n\n\t\tif ( this.normalized ) x = denormalize( x, this.array );\n\n\t\treturn x;\n\n\t}\n\n\tgetY( index ) {\n\n\t\tlet y = this.data.array[ index * this.data.stride + this.offset + 1 ];\n\n\t\tif ( this.normalized ) y = denormalize( y, this.array );\n\n\t\treturn y;\n\n\t}\n\n\tgetZ( index ) {\n\n\t\tlet z = this.data.array[ index * this.data.stride + this.offset + 2 ];\n\n\t\tif ( this.normalized ) z = denormalize( z, this.array );\n\n\t\treturn z;\n\n\t}\n\n\tgetW( index ) {\n\n\t\tlet w = this.data.array[ index * this.data.stride + this.offset + 3 ];\n\n\t\tif ( this.normalized ) w = denormalize( w, this.array );\n\n\t\treturn w;\n\n\t}\n\n\tsetXY( index, x, y ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize( x, this.array );\n\t\t\ty = normalize( y, this.array );\n\n\t\t}\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZ( index, x, y, z ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize( x, this.array );\n\t\t\ty = normalize( y, this.array );\n\t\t\tz = normalize( z, this.array );\n\n\t\t}\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZW( index, x, y, z, w ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize( x, this.array );\n\t\t\ty = normalize( y, this.array );\n\t\t\tz = normalize( z, this.array );\n\t\t\tw = normalize( w, this.array );\n\n\t\t}\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\t\tthis.data.array[ index + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconsole.log( 'THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.' );\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0; i < this.count; i ++ ) {\n\n\t\t\t\tconst index = i * this.data.stride + this.offset;\n\n\t\t\t\tfor ( let j = 0; j < this.itemSize; j ++ ) {\n\n\t\t\t\t\tarray.push( this.data.array[ index + j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new BufferAttribute( new this.array.constructor( array ), this.itemSize, this.normalized );\n\n\t\t} else {\n\n\t\t\tif ( data.interleavedBuffers === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers = {};\n\n\t\t\t}\n\n\t\t\tif ( data.interleavedBuffers[ this.data.uuid ] === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers[ this.data.uuid ] = this.data.clone( data );\n\n\t\t\t}\n\n\t\t\treturn new InterleavedBufferAttribute( data.interleavedBuffers[ this.data.uuid ], this.itemSize, this.offset, this.normalized );\n\n\t\t}\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconsole.log( 'THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.' );\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0; i < this.count; i ++ ) {\n\n\t\t\t\tconst index = i * this.data.stride + this.offset;\n\n\t\t\t\tfor ( let j = 0; j < this.itemSize; j ++ ) {\n\n\t\t\t\t\tarray.push( this.data.array[ index + j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// de-interleave data and save it as an ordinary buffer attribute for now\n\n\t\t\treturn {\n\t\t\t\titemSize: this.itemSize,\n\t\t\t\ttype: this.array.constructor.name,\n\t\t\t\tarray: array,\n\t\t\t\tnormalized: this.normalized\n\t\t\t};\n\n\t\t} else {\n\n\t\t\t// save as true interleaved attribute\n\n\t\t\tif ( data.interleavedBuffers === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers = {};\n\n\t\t\t}\n\n\t\t\tif ( data.interleavedBuffers[ this.data.uuid ] === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers[ this.data.uuid ] = this.data.toJSON( data );\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tisInterleavedBufferAttribute: true,\n\t\t\t\titemSize: this.itemSize,\n\t\t\t\tdata: this.data.uuid,\n\t\t\t\toffset: this.offset,\n\t\t\t\tnormalized: this.normalized\n\t\t\t};\n\n\t\t}\n\n\t}\n\n}\n\nclass SpriteMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isSpriteMaterial = true;\n\n\t\tthis.type = 'SpriteMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.rotation = 0;\n\n\t\tthis.sizeAttenuation = true;\n\n\t\tthis.transparent = true;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.rotation = source.rotation;\n\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nlet _geometry;\n\nconst _intersectPoint = /*@__PURE__*/ new Vector3();\nconst _worldScale = /*@__PURE__*/ new Vector3();\nconst _mvPosition = /*@__PURE__*/ new Vector3();\n\nconst _alignedPosition = /*@__PURE__*/ new Vector2();\nconst _rotatedPosition = /*@__PURE__*/ new Vector2();\nconst _viewWorldMatrix = /*@__PURE__*/ new Matrix4();\n\nconst _vA = /*@__PURE__*/ new Vector3();\nconst _vB = /*@__PURE__*/ new Vector3();\nconst _vC = /*@__PURE__*/ new Vector3();\n\nconst _uvA = /*@__PURE__*/ new Vector2();\nconst _uvB = /*@__PURE__*/ new Vector2();\nconst _uvC = /*@__PURE__*/ new Vector2();\n\nclass Sprite extends Object3D {\n\n\tconstructor( material = new SpriteMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.isSprite = true;\n\n\t\tthis.type = 'Sprite';\n\n\t\tif ( _geometry === undefined ) {\n\n\t\t\t_geometry = new BufferGeometry();\n\n\t\t\tconst float32Array = new Float32Array( [\n\t\t\t\t- 0.5, - 0.5, 0, 0, 0,\n\t\t\t\t0.5, - 0.5, 0, 1, 0,\n\t\t\t\t0.5, 0.5, 0, 1, 1,\n\t\t\t\t- 0.5, 0.5, 0, 0, 1\n\t\t\t] );\n\n\t\t\tconst interleavedBuffer = new InterleavedBuffer( float32Array, 5 );\n\n\t\t\t_geometry.setIndex( [ 0, 1, 2,\t0, 2, 3 ] );\n\t\t\t_geometry.setAttribute( 'position', new InterleavedBufferAttribute( interleavedBuffer, 3, 0, false ) );\n\t\t\t_geometry.setAttribute( 'uv', new InterleavedBufferAttribute( interleavedBuffer, 2, 3, false ) );\n\n\t\t}\n\n\t\tthis.geometry = _geometry;\n\t\tthis.material = material;\n\n\t\tthis.center = new Vector2( 0.5, 0.5 );\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tif ( raycaster.camera === null ) {\n\n\t\t\tconsole.error( 'THREE.Sprite: \"Raycaster.camera\" needs to be set in order to raycast against sprites.' );\n\n\t\t}\n\n\t\t_worldScale.setFromMatrixScale( this.matrixWorld );\n\n\t\t_viewWorldMatrix.copy( raycaster.camera.matrixWorld );\n\t\tthis.modelViewMatrix.multiplyMatrices( raycaster.camera.matrixWorldInverse, this.matrixWorld );\n\n\t\t_mvPosition.setFromMatrixPosition( this.modelViewMatrix );\n\n\t\tif ( raycaster.camera.isPerspectiveCamera && this.material.sizeAttenuation === false ) {\n\n\t\t\t_worldScale.multiplyScalar( - _mvPosition.z );\n\n\t\t}\n\n\t\tconst rotation = this.material.rotation;\n\t\tlet sin, cos;\n\n\t\tif ( rotation !== 0 ) {\n\n\t\t\tcos = Math.cos( rotation );\n\t\t\tsin = Math.sin( rotation );\n\n\t\t}\n\n\t\tconst center = this.center;\n\n\t\ttransformVertex( _vA.set( - 0.5, - 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\t\ttransformVertex( _vB.set( 0.5, - 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\t\ttransformVertex( _vC.set( 0.5, 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\n\t\t_uvA.set( 0, 0 );\n\t\t_uvB.set( 1, 0 );\n\t\t_uvC.set( 1, 1 );\n\n\t\t// check first triangle\n\t\tlet intersect = raycaster.ray.intersectTriangle( _vA, _vB, _vC, false, _intersectPoint );\n\n\t\tif ( intersect === null ) {\n\n\t\t\t// check second triangle\n\t\t\ttransformVertex( _vB.set( - 0.5, 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\t\t\t_uvB.set( 0, 1 );\n\n\t\t\tintersect = raycaster.ray.intersectTriangle( _vA, _vC, _vB, false, _intersectPoint );\n\t\t\tif ( intersect === null ) {\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst distance = raycaster.ray.origin.distanceTo( _intersectPoint );\n\n\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\n\n\t\tintersects.push( {\n\n\t\t\tdistance: distance,\n\t\t\tpoint: _intersectPoint.clone(),\n\t\t\tuv: Triangle.getInterpolation( _intersectPoint, _vA, _vB, _vC, _uvA, _uvB, _uvC, new Vector2() ),\n\t\t\tface: null,\n\t\t\tobject: this\n\n\t\t} );\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tif ( source.center !== undefined ) this.center.copy( source.center );\n\n\t\tthis.material = source.material;\n\n\t\treturn this;\n\n\t}\n\n}\n\nfunction transformVertex( vertexPosition, mvPosition, center, scale, sin, cos ) {\n\n\t// compute position in camera space\n\t_alignedPosition.subVectors( vertexPosition, center ).addScalar( 0.5 ).multiply( scale );\n\n\t// to check if rotation is not zero\n\tif ( sin !== undefined ) {\n\n\t\t_rotatedPosition.x = ( cos * _alignedPosition.x ) - ( sin * _alignedPosition.y );\n\t\t_rotatedPosition.y = ( sin * _alignedPosition.x ) + ( cos * _alignedPosition.y );\n\n\t} else {\n\n\t\t_rotatedPosition.copy( _alignedPosition );\n\n\t}\n\n\n\tvertexPosition.copy( mvPosition );\n\tvertexPosition.x += _rotatedPosition.x;\n\tvertexPosition.y += _rotatedPosition.y;\n\n\t// transform to world space\n\tvertexPosition.applyMatrix4( _viewWorldMatrix );\n\n}\n\nconst _v1$2 = /*@__PURE__*/ new Vector3();\nconst _v2$1 = /*@__PURE__*/ new Vector3();\n\nclass LOD extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis._currentLevel = 0;\n\n\t\tthis.type = 'LOD';\n\n\t\tObject.defineProperties( this, {\n\t\t\tlevels: {\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: []\n\t\t\t},\n\t\t\tisLOD: {\n\t\t\t\tvalue: true,\n\t\t\t}\n\t\t} );\n\n\t\tthis.autoUpdate = true;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source, false );\n\n\t\tconst levels = source.levels;\n\n\t\tfor ( let i = 0, l = levels.length; i < l; i ++ ) {\n\n\t\t\tconst level = levels[ i ];\n\n\t\t\tthis.addLevel( level.object.clone(), level.distance, level.hysteresis );\n\n\t\t}\n\n\t\tthis.autoUpdate = source.autoUpdate;\n\n\t\treturn this;\n\n\t}\n\n\taddLevel( object, distance = 0, hysteresis = 0 ) {\n\n\t\tdistance = Math.abs( distance );\n\n\t\tconst levels = this.levels;\n\n\t\tlet l;\n\n\t\tfor ( l = 0; l < levels.length; l ++ ) {\n\n\t\t\tif ( distance < levels[ l ].distance ) {\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tlevels.splice( l, 0, { distance: distance, hysteresis: hysteresis, object: object } );\n\n\t\tthis.add( object );\n\n\t\treturn this;\n\n\t}\n\n\tremoveLevel( distance ) {\n\n\t\tconst levels = this.levels;\n\n\t\tfor ( let i = 0; i < levels.length; i ++ ) {\n\n\t\t\tif ( levels[ i ].distance === distance ) {\n\n\t\t\t\tconst removedElements = levels.splice( i, 1 );\n\t\t\t\tthis.remove( removedElements[ 0 ].object );\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tgetCurrentLevel() {\n\n\t\treturn this._currentLevel;\n\n\t}\n\n\n\n\tgetObjectForDistance( distance ) {\n\n\t\tconst levels = this.levels;\n\n\t\tif ( levels.length > 0 ) {\n\n\t\t\tlet i, l;\n\n\t\t\tfor ( i = 1, l = levels.length; i < l; i ++ ) {\n\n\t\t\t\tlet levelDistance = levels[ i ].distance;\n\n\t\t\t\tif ( levels[ i ].object.visible ) {\n\n\t\t\t\t\tlevelDistance -= levelDistance * levels[ i ].hysteresis;\n\n\t\t\t\t}\n\n\t\t\t\tif ( distance < levelDistance ) {\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn levels[ i - 1 ].object;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst levels = this.levels;\n\n\t\tif ( levels.length > 0 ) {\n\n\t\t\t_v1$2.setFromMatrixPosition( this.matrixWorld );\n\n\t\t\tconst distance = raycaster.ray.origin.distanceTo( _v1$2 );\n\n\t\t\tthis.getObjectForDistance( distance ).raycast( raycaster, intersects );\n\n\t\t}\n\n\t}\n\n\tupdate( camera ) {\n\n\t\tconst levels = this.levels;\n\n\t\tif ( levels.length > 1 ) {\n\n\t\t\t_v1$2.setFromMatrixPosition( camera.matrixWorld );\n\t\t\t_v2$1.setFromMatrixPosition( this.matrixWorld );\n\n\t\t\tconst distance = _v1$2.distanceTo( _v2$1 ) / camera.zoom;\n\n\t\t\tlevels[ 0 ].object.visible = true;\n\n\t\t\tlet i, l;\n\n\t\t\tfor ( i = 1, l = levels.length; i < l; i ++ ) {\n\n\t\t\t\tlet levelDistance = levels[ i ].distance;\n\n\t\t\t\tif ( levels[ i ].object.visible ) {\n\n\t\t\t\t\tlevelDistance -= levelDistance * levels[ i ].hysteresis;\n\n\t\t\t\t}\n\n\t\t\t\tif ( distance >= levelDistance ) {\n\n\t\t\t\t\tlevels[ i - 1 ].object.visible = false;\n\t\t\t\t\tlevels[ i ].object.visible = true;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._currentLevel = i - 1;\n\n\t\t\tfor ( ; i < l; i ++ ) {\n\n\t\t\t\tlevels[ i ].object.visible = false;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tif ( this.autoUpdate === false ) data.object.autoUpdate = false;\n\n\t\tdata.object.levels = [];\n\n\t\tconst levels = this.levels;\n\n\t\tfor ( let i = 0, l = levels.length; i < l; i ++ ) {\n\n\t\t\tconst level = levels[ i ];\n\n\t\t\tdata.object.levels.push( {\n\t\t\t\tobject: level.object.uuid,\n\t\t\t\tdistance: level.distance,\n\t\t\t\thysteresis: level.hysteresis\n\t\t\t} );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n}\n\nconst _basePosition = /*@__PURE__*/ new Vector3();\n\nconst _skinIndex = /*@__PURE__*/ new Vector4();\nconst _skinWeight = /*@__PURE__*/ new Vector4();\n\nconst _vector3 = /*@__PURE__*/ new Vector3();\nconst _matrix4 = /*@__PURE__*/ new Matrix4();\nconst _vertex = /*@__PURE__*/ new Vector3();\n\nconst _sphere$5 = /*@__PURE__*/ new Sphere();\nconst _inverseMatrix$2 = /*@__PURE__*/ new Matrix4();\nconst _ray$2 = /*@__PURE__*/ new Ray();\n\nclass SkinnedMesh extends Mesh {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.isSkinnedMesh = true;\n\n\t\tthis.type = 'SkinnedMesh';\n\n\t\tthis.bindMode = AttachedBindMode;\n\t\tthis.bindMatrix = new Matrix4();\n\t\tthis.bindMatrixInverse = new Matrix4();\n\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t}\n\n\tcomputeBoundingBox() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( this.boundingBox === null ) {\n\n\t\t\tthis.boundingBox = new Box3();\n\n\t\t}\n\n\t\tthis.boundingBox.makeEmpty();\n\n\t\tconst positionAttribute = geometry.getAttribute( 'position' );\n\n\t\tfor ( let i = 0; i < positionAttribute.count; i ++ ) {\n\n\t\t\tthis.getVertexPosition( i, _vertex );\n\t\t\tthis.boundingBox.expandByPoint( _vertex );\n\n\t\t}\n\n\t}\n\n\tcomputeBoundingSphere() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( this.boundingSphere === null ) {\n\n\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t}\n\n\t\tthis.boundingSphere.makeEmpty();\n\n\t\tconst positionAttribute = geometry.getAttribute( 'position' );\n\n\t\tfor ( let i = 0; i < positionAttribute.count; i ++ ) {\n\n\t\t\tthis.getVertexPosition( i, _vertex );\n\t\t\tthis.boundingSphere.expandByPoint( _vertex );\n\n\t\t}\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.bindMode = source.bindMode;\n\t\tthis.bindMatrix.copy( source.bindMatrix );\n\t\tthis.bindMatrixInverse.copy( source.bindMatrixInverse );\n\n\t\tthis.skeleton = source.skeleton;\n\n\t\tif ( source.boundingBox !== null ) this.boundingBox = source.boundingBox.clone();\n\t\tif ( source.boundingSphere !== null ) this.boundingSphere = source.boundingSphere.clone();\n\n\t\treturn this;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst material = this.material;\n\t\tconst matrixWorld = this.matrixWorld;\n\n\t\tif ( material === undefined ) return;\n\n\t\t// test with bounding sphere in world space\n\n\t\tif ( this.boundingSphere === null ) this.computeBoundingSphere();\n\n\t\t_sphere$5.copy( this.boundingSphere );\n\t\t_sphere$5.applyMatrix4( matrixWorld );\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere$5 ) === false ) return;\n\n\t\t// convert ray to local space of skinned mesh\n\n\t\t_inverseMatrix$2.copy( matrixWorld ).invert();\n\t\t_ray$2.copy( raycaster.ray ).applyMatrix4( _inverseMatrix$2 );\n\n\t\t// test with bounding box in local space\n\n\t\tif ( this.boundingBox !== null ) {\n\n\t\t\tif ( _ray$2.intersectsBox( this.boundingBox ) === false ) return;\n\n\t\t}\n\n\t\t// test for intersections with geometry\n\n\t\tthis._computeIntersections( raycaster, intersects, _ray$2 );\n\n\t}\n\n\tgetVertexPosition( index, target ) {\n\n\t\tsuper.getVertexPosition( index, target );\n\n\t\tthis.applyBoneTransform( index, target );\n\n\t\treturn target;\n\n\t}\n\n\tbind( skeleton, bindMatrix ) {\n\n\t\tthis.skeleton = skeleton;\n\n\t\tif ( bindMatrix === undefined ) {\n\n\t\t\tthis.updateMatrixWorld( true );\n\n\t\t\tthis.skeleton.calculateInverses();\n\n\t\t\tbindMatrix = this.matrixWorld;\n\n\t\t}\n\n\t\tthis.bindMatrix.copy( bindMatrix );\n\t\tthis.bindMatrixInverse.copy( bindMatrix ).invert();\n\n\t}\n\n\tpose() {\n\n\t\tthis.skeleton.pose();\n\n\t}\n\n\tnormalizeSkinWeights() {\n\n\t\tconst vector = new Vector4();\n\n\t\tconst skinWeight = this.geometry.attributes.skinWeight;\n\n\t\tfor ( let i = 0, l = skinWeight.count; i < l; i ++ ) {\n\n\t\t\tvector.fromBufferAttribute( skinWeight, i );\n\n\t\t\tconst scale = 1.0 / vector.manhattanLength();\n\n\t\t\tif ( scale !== Infinity ) {\n\n\t\t\t\tvector.multiplyScalar( scale );\n\n\t\t\t} else {\n\n\t\t\t\tvector.set( 1, 0, 0, 0 ); // do something reasonable\n\n\t\t\t}\n\n\t\t\tskinWeight.setXYZW( i, vector.x, vector.y, vector.z, vector.w );\n\n\t\t}\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tif ( this.bindMode === AttachedBindMode ) {\n\n\t\t\tthis.bindMatrixInverse.copy( this.matrixWorld ).invert();\n\n\t\t} else if ( this.bindMode === DetachedBindMode ) {\n\n\t\t\tthis.bindMatrixInverse.copy( this.bindMatrix ).invert();\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.SkinnedMesh: Unrecognized bindMode: ' + this.bindMode );\n\n\t\t}\n\n\t}\n\n\tapplyBoneTransform( index, vector ) {\n\n\t\tconst skeleton = this.skeleton;\n\t\tconst geometry = this.geometry;\n\n\t\t_skinIndex.fromBufferAttribute( geometry.attributes.skinIndex, index );\n\t\t_skinWeight.fromBufferAttribute( geometry.attributes.skinWeight, index );\n\n\t\t_basePosition.copy( vector ).applyMatrix4( this.bindMatrix );\n\n\t\tvector.set( 0, 0, 0 );\n\n\t\tfor ( let i = 0; i < 4; i ++ ) {\n\n\t\t\tconst weight = _skinWeight.getComponent( i );\n\n\t\t\tif ( weight !== 0 ) {\n\n\t\t\t\tconst boneIndex = _skinIndex.getComponent( i );\n\n\t\t\t\t_matrix4.multiplyMatrices( skeleton.bones[ boneIndex ].matrixWorld, skeleton.boneInverses[ boneIndex ] );\n\n\t\t\t\tvector.addScaledVector( _vector3.copy( _basePosition ).applyMatrix4( _matrix4 ), weight );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn vector.applyMatrix4( this.bindMatrixInverse );\n\n\t}\n\n}\n\nclass Bone extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isBone = true;\n\n\t\tthis.type = 'Bone';\n\n\t}\n\n}\n\nclass DataTexture extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, format, type, mapping, wrapS, wrapT, magFilter = NearestFilter, minFilter = NearestFilter, anisotropy, colorSpace ) {\n\n\t\tsuper( null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, colorSpace );\n\n\t\tthis.isDataTexture = true;\n\n\t\tthis.image = { data: data, width: width, height: height };\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t}\n\n}\n\nconst _offsetMatrix = /*@__PURE__*/ new Matrix4();\nconst _identityMatrix = /*@__PURE__*/ new Matrix4();\n\nclass Skeleton {\n\n\tconstructor( bones = [], boneInverses = [] ) {\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.bones = bones.slice( 0 );\n\t\tthis.boneInverses = boneInverses;\n\t\tthis.boneMatrices = null;\n\n\t\tthis.boneTexture = null;\n\n\t\tthis.init();\n\n\t}\n\n\tinit() {\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\n\t\tthis.boneMatrices = new Float32Array( bones.length * 16 );\n\n\t\t// calculate inverse bone matrices if necessary\n\n\t\tif ( boneInverses.length === 0 ) {\n\n\t\t\tthis.calculateInverses();\n\n\t\t} else {\n\n\t\t\t// handle special case\n\n\t\t\tif ( bones.length !== boneInverses.length ) {\n\n\t\t\t\tconsole.warn( 'THREE.Skeleton: Number of inverse bone matrices does not match amount of bones.' );\n\n\t\t\t\tthis.boneInverses = [];\n\n\t\t\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\t\t\tthis.boneInverses.push( new Matrix4() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcalculateInverses() {\n\n\t\tthis.boneInverses.length = 0;\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst inverse = new Matrix4();\n\n\t\t\tif ( this.bones[ i ] ) {\n\n\t\t\t\tinverse.copy( this.bones[ i ].matrixWorld ).invert();\n\n\t\t\t}\n\n\t\t\tthis.boneInverses.push( inverse );\n\n\t\t}\n\n\t}\n\n\tpose() {\n\n\t\t// recover the bind-time world matrices\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone ) {\n\n\t\t\t\tbone.matrixWorld.copy( this.boneInverses[ i ] ).invert();\n\n\t\t\t}\n\n\t\t}\n\n\t\t// compute the local matrices, positions, rotations and scales\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone ) {\n\n\t\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t\tbone.matrix.copy( bone.parent.matrixWorld ).invert();\n\t\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbone.matrix.copy( bone.matrixWorld );\n\n\t\t\t\t}\n\n\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tupdate() {\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\t\tconst boneMatrices = this.boneMatrices;\n\t\tconst boneTexture = this.boneTexture;\n\n\t\t// flatten bone matrices to array\n\n\t\tfor ( let i = 0, il = bones.length; i < il; i ++ ) {\n\n\t\t\t// compute the offset between the current and the original transform\n\n\t\t\tconst matrix = bones[ i ] ? bones[ i ].matrixWorld : _identityMatrix;\n\n\t\t\t_offsetMatrix.multiplyMatrices( matrix, boneInverses[ i ] );\n\t\t\t_offsetMatrix.toArray( boneMatrices, i * 16 );\n\n\t\t}\n\n\t\tif ( boneTexture !== null ) {\n\n\t\t\tboneTexture.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new Skeleton( this.bones, this.boneInverses );\n\n\t}\n\n\tcomputeBoneTexture() {\n\n\t\t// layout (1 matrix = 4 pixels)\n\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\n\t\t//  with  8x8  pixel texture max   16 bones * 4 pixels =  (8 * 8)\n\t\t//       16x16 pixel texture max   64 bones * 4 pixels = (16 * 16)\n\t\t//       32x32 pixel texture max  256 bones * 4 pixels = (32 * 32)\n\t\t//       64x64 pixel texture max 1024 bones * 4 pixels = (64 * 64)\n\n\t\tlet size = Math.sqrt( this.bones.length * 4 ); // 4 pixels needed for 1 matrix\n\t\tsize = Math.ceil( size / 4 ) * 4;\n\t\tsize = Math.max( size, 4 );\n\n\t\tconst boneMatrices = new Float32Array( size * size * 4 ); // 4 floats per RGBA pixel\n\t\tboneMatrices.set( this.boneMatrices ); // copy current values\n\n\t\tconst boneTexture = new DataTexture( boneMatrices, size, size, RGBAFormat, FloatType );\n\t\tboneTexture.needsUpdate = true;\n\n\t\tthis.boneMatrices = boneMatrices;\n\t\tthis.boneTexture = boneTexture;\n\n\t\treturn this;\n\n\t}\n\n\tgetBoneByName( name ) {\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone.name === name ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn undefined;\n\n\t}\n\n\tdispose( ) {\n\n\t\tif ( this.boneTexture !== null ) {\n\n\t\t\tthis.boneTexture.dispose();\n\n\t\t\tthis.boneTexture = null;\n\n\t\t}\n\n\t}\n\n\tfromJSON( json, bones ) {\n\n\t\tthis.uuid = json.uuid;\n\n\t\tfor ( let i = 0, l = json.bones.length; i < l; i ++ ) {\n\n\t\t\tconst uuid = json.bones[ i ];\n\t\t\tlet bone = bones[ uuid ];\n\n\t\t\tif ( bone === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Skeleton: No bone found with UUID:', uuid );\n\t\t\t\tbone = new Bone();\n\n\t\t\t}\n\n\t\t\tthis.bones.push( bone );\n\t\t\tthis.boneInverses.push( new Matrix4().fromArray( json.boneInverses[ i ] ) );\n\n\t\t}\n\n\t\tthis.init();\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.6,\n\t\t\t\ttype: 'Skeleton',\n\t\t\t\tgenerator: 'Skeleton.toJSON'\n\t\t\t},\n\t\t\tbones: [],\n\t\t\tboneInverses: []\n\t\t};\n\n\t\tdata.uuid = this.uuid;\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\n\t\tfor ( let i = 0, l = bones.length; i < l; i ++ ) {\n\n\t\t\tconst bone = bones[ i ];\n\t\t\tdata.bones.push( bone.uuid );\n\n\t\t\tconst boneInverse = boneInverses[ i ];\n\t\t\tdata.boneInverses.push( boneInverse.toArray() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass InstancedBufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized, meshPerAttribute = 1 ) {\n\n\t\tsuper( array, itemSize, normalized );\n\n\t\tthis.isInstancedBufferAttribute = true;\n\n\t\tthis.meshPerAttribute = meshPerAttribute;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.meshPerAttribute = source.meshPerAttribute;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.meshPerAttribute = this.meshPerAttribute;\n\n\t\tdata.isInstancedBufferAttribute = true;\n\n\t\treturn data;\n\n\t}\n\n}\n\nconst _instanceLocalMatrix = /*@__PURE__*/ new Matrix4();\nconst _instanceWorldMatrix = /*@__PURE__*/ new Matrix4();\n\nconst _instanceIntersects = [];\n\nconst _box3 = /*@__PURE__*/ new Box3();\nconst _identity = /*@__PURE__*/ new Matrix4();\nconst _mesh$1 = /*@__PURE__*/ new Mesh();\nconst _sphere$4 = /*@__PURE__*/ new Sphere();\n\nclass InstancedMesh extends Mesh {\n\n\tconstructor( geometry, material, count ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.isInstancedMesh = true;\n\n\t\tthis.instanceMatrix = new InstancedBufferAttribute( new Float32Array( count * 16 ), 16 );\n\t\tthis.instanceColor = null;\n\t\tthis.morphTexture = null;\n\n\t\tthis.count = count;\n\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\tthis.setMatrixAt( i, _identity );\n\n\t\t}\n\n\t}\n\n\tcomputeBoundingBox() {\n\n\t\tconst geometry = this.geometry;\n\t\tconst count = this.count;\n\n\t\tif ( this.boundingBox === null ) {\n\n\t\t\tthis.boundingBox = new Box3();\n\n\t\t}\n\n\t\tif ( geometry.boundingBox === null ) {\n\n\t\t\tgeometry.computeBoundingBox();\n\n\t\t}\n\n\t\tthis.boundingBox.makeEmpty();\n\n\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\tthis.getMatrixAt( i, _instanceLocalMatrix );\n\n\t\t\t_box3.copy( geometry.boundingBox ).applyMatrix4( _instanceLocalMatrix );\n\n\t\t\tthis.boundingBox.union( _box3 );\n\n\t\t}\n\n\t}\n\n\tcomputeBoundingSphere() {\n\n\t\tconst geometry = this.geometry;\n\t\tconst count = this.count;\n\n\t\tif ( this.boundingSphere === null ) {\n\n\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t}\n\n\t\tif ( geometry.boundingSphere === null ) {\n\n\t\t\tgeometry.computeBoundingSphere();\n\n\t\t}\n\n\t\tthis.boundingSphere.makeEmpty();\n\n\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\tthis.getMatrixAt( i, _instanceLocalMatrix );\n\n\t\t\t_sphere$4.copy( geometry.boundingSphere ).applyMatrix4( _instanceLocalMatrix );\n\n\t\t\tthis.boundingSphere.union( _sphere$4 );\n\n\t\t}\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.instanceMatrix.copy( source.instanceMatrix );\n\n\t\tif ( source.morphTexture !== null ) this.morphTexture = source.morphTexture.clone();\n\t\tif ( source.instanceColor !== null ) this.instanceColor = source.instanceColor.clone();\n\n\t\tthis.count = source.count;\n\n\t\tif ( source.boundingBox !== null ) this.boundingBox = source.boundingBox.clone();\n\t\tif ( source.boundingSphere !== null ) this.boundingSphere = source.boundingSphere.clone();\n\n\t\treturn this;\n\n\t}\n\n\tgetColorAt( index, color ) {\n\n\t\tcolor.fromArray( this.instanceColor.array, index * 3 );\n\n\t}\n\n\tgetMatrixAt( index, matrix ) {\n\n\t\tmatrix.fromArray( this.instanceMatrix.array, index * 16 );\n\n\t}\n\n\tgetMorphAt( index, object ) {\n\n\t\tconst objectInfluences = object.morphTargetInfluences;\n\n\t\tconst array = this.morphTexture.source.data.data;\n\n\t\tconst len = objectInfluences.length + 1; // All influences + the baseInfluenceSum\n\n\t\tconst dataIndex = index * len + 1; // Skip the baseInfluenceSum at the beginning\n\n\t\tfor ( let i = 0; i < objectInfluences.length; i ++ ) {\n\n\t\t\tobjectInfluences[ i ] = array[ dataIndex + i ];\n\n\t\t}\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst raycastTimes = this.count;\n\n\t\t_mesh$1.geometry = this.geometry;\n\t\t_mesh$1.material = this.material;\n\n\t\tif ( _mesh$1.material === undefined ) return;\n\n\t\t// test with bounding sphere first\n\n\t\tif ( this.boundingSphere === null ) this.computeBoundingSphere();\n\n\t\t_sphere$4.copy( this.boundingSphere );\n\t\t_sphere$4.applyMatrix4( matrixWorld );\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere$4 ) === false ) return;\n\n\t\t// now test each instance\n\n\t\tfor ( let instanceId = 0; instanceId < raycastTimes; instanceId ++ ) {\n\n\t\t\t// calculate the world matrix for each instance\n\n\t\t\tthis.getMatrixAt( instanceId, _instanceLocalMatrix );\n\n\t\t\t_instanceWorldMatrix.multiplyMatrices( matrixWorld, _instanceLocalMatrix );\n\n\t\t\t// the mesh represents this single instance\n\n\t\t\t_mesh$1.matrixWorld = _instanceWorldMatrix;\n\n\t\t\t_mesh$1.raycast( raycaster, _instanceIntersects );\n\n\t\t\t// process the result of raycast\n\n\t\t\tfor ( let i = 0, l = _instanceIntersects.length; i < l; i ++ ) {\n\n\t\t\t\tconst intersect = _instanceIntersects[ i ];\n\t\t\t\tintersect.instanceId = instanceId;\n\t\t\t\tintersect.object = this;\n\t\t\t\tintersects.push( intersect );\n\n\t\t\t}\n\n\t\t\t_instanceIntersects.length = 0;\n\n\t\t}\n\n\t}\n\n\tsetColorAt( index, color ) {\n\n\t\tif ( this.instanceColor === null ) {\n\n\t\t\tthis.instanceColor = new InstancedBufferAttribute( new Float32Array( this.instanceMatrix.count * 3 ).fill( 1 ), 3 );\n\n\t\t}\n\n\t\tcolor.toArray( this.instanceColor.array, index * 3 );\n\n\t}\n\n\tsetMatrixAt( index, matrix ) {\n\n\t\tmatrix.toArray( this.instanceMatrix.array, index * 16 );\n\n\t}\n\n\tsetMorphAt( index, object ) {\n\n\t\tconst objectInfluences = object.morphTargetInfluences;\n\n\t\tconst len = objectInfluences.length + 1; // morphBaseInfluence + all influences\n\n\t\tif ( this.morphTexture === null ) {\n\n\t\t\tthis.morphTexture = new DataTexture( new Float32Array( len * this.count ), len, this.count, RedFormat, FloatType );\n\n\t\t}\n\n\t\tconst array = this.morphTexture.source.data.data;\n\n\t\tlet morphInfluencesSum = 0;\n\n\t\tfor ( let i = 0; i < objectInfluences.length; i ++ ) {\n\n\t\t\tmorphInfluencesSum += objectInfluences[ i ];\n\n\t\t}\n\n\t\tconst morphBaseInfluence = this.geometry.morphTargetsRelative ? 1 : 1 - morphInfluencesSum;\n\n\t\tconst dataIndex = len * index;\n\n\t\tarray[ dataIndex ] = morphBaseInfluence;\n\n\t\tarray.set( objectInfluences, dataIndex + 1 );\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t\tif ( this.morphTexture !== null ) {\n\n\t\t\tthis.morphTexture.dispose();\n\t\t\tthis.morphTexture = null;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _vector1 = /*@__PURE__*/ new Vector3();\nconst _vector2 = /*@__PURE__*/ new Vector3();\nconst _normalMatrix = /*@__PURE__*/ new Matrix3();\n\nclass Plane {\n\n\tconstructor( normal = new Vector3( 1, 0, 0 ), constant = 0 ) {\n\n\t\tthis.isPlane = true;\n\n\t\t// normal is assumed to be normalized\n\n\t\tthis.normal = normal;\n\t\tthis.constant = constant;\n\n\t}\n\n\tset( normal, constant ) {\n\n\t\tthis.normal.copy( normal );\n\t\tthis.constant = constant;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponents( x, y, z, w ) {\n\n\t\tthis.normal.set( x, y, z );\n\t\tthis.constant = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromNormalAndCoplanarPoint( normal, point ) {\n\n\t\tthis.normal.copy( normal );\n\t\tthis.constant = - point.dot( this.normal );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCoplanarPoints( a, b, c ) {\n\n\t\tconst normal = _vector1.subVectors( c, b ).cross( _vector2.subVectors( a, b ) ).normalize();\n\n\t\t// Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\n\n\t\tthis.setFromNormalAndCoplanarPoint( normal, a );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( plane ) {\n\n\t\tthis.normal.copy( plane.normal );\n\t\tthis.constant = plane.constant;\n\n\t\treturn this;\n\n\t}\n\n\tnormalize() {\n\n\t\t// Note: will lead to a divide by zero if the plane is invalid.\n\n\t\tconst inverseNormalLength = 1.0 / this.normal.length();\n\t\tthis.normal.multiplyScalar( inverseNormalLength );\n\t\tthis.constant *= inverseNormalLength;\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.constant *= - 1;\n\t\tthis.normal.negate();\n\n\t\treturn this;\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn this.normal.dot( point ) + this.constant;\n\n\t}\n\n\tdistanceToSphere( sphere ) {\n\n\t\treturn this.distanceToPoint( sphere.center ) - sphere.radius;\n\n\t}\n\n\tprojectPoint( point, target ) {\n\n\t\treturn target.copy( point ).addScaledVector( this.normal, - this.distanceToPoint( point ) );\n\n\t}\n\n\tintersectLine( line, target ) {\n\n\t\tconst direction = line.delta( _vector1 );\n\n\t\tconst denominator = this.normal.dot( direction );\n\n\t\tif ( denominator === 0 ) {\n\n\t\t\t// line is coplanar, return origin\n\t\t\tif ( this.distanceToPoint( line.start ) === 0 ) {\n\n\t\t\t\treturn target.copy( line.start );\n\n\t\t\t}\n\n\t\t\t// Unsure if this is the correct method to handle this case.\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst t = - ( line.start.dot( this.normal ) + this.constant ) / denominator;\n\n\t\tif ( t < 0 || t > 1 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn target.copy( line.start ).addScaledVector( direction, t );\n\n\t}\n\n\tintersectsLine( line ) {\n\n\t\t// Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\n\n\t\tconst startSign = this.distanceToPoint( line.start );\n\t\tconst endSign = this.distanceToPoint( line.end );\n\n\t\treturn ( startSign < 0 && endSign > 0 ) || ( endSign < 0 && startSign > 0 );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsPlane( this );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\treturn sphere.intersectsPlane( this );\n\n\t}\n\n\tcoplanarPoint( target ) {\n\n\t\treturn target.copy( this.normal ).multiplyScalar( - this.constant );\n\n\t}\n\n\tapplyMatrix4( matrix, optionalNormalMatrix ) {\n\n\t\tconst normalMatrix = optionalNormalMatrix || _normalMatrix.getNormalMatrix( matrix );\n\n\t\tconst referencePoint = this.coplanarPoint( _vector1 ).applyMatrix4( matrix );\n\n\t\tconst normal = this.normal.applyMatrix3( normalMatrix ).normalize();\n\n\t\tthis.constant = - referencePoint.dot( normal );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.constant -= offset.dot( this.normal );\n\n\t\treturn this;\n\n\t}\n\n\tequals( plane ) {\n\n\t\treturn plane.normal.equals( this.normal ) && ( plane.constant === this.constant );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nconst _sphere$3 = /*@__PURE__*/ new Sphere();\nconst _vector$6 = /*@__PURE__*/ new Vector3();\n\nclass Frustum {\n\n\tconstructor( p0 = new Plane(), p1 = new Plane(), p2 = new Plane(), p3 = new Plane(), p4 = new Plane(), p5 = new Plane() ) {\n\n\t\tthis.planes = [ p0, p1, p2, p3, p4, p5 ];\n\n\t}\n\n\tset( p0, p1, p2, p3, p4, p5 ) {\n\n\t\tconst planes = this.planes;\n\n\t\tplanes[ 0 ].copy( p0 );\n\t\tplanes[ 1 ].copy( p1 );\n\t\tplanes[ 2 ].copy( p2 );\n\t\tplanes[ 3 ].copy( p3 );\n\t\tplanes[ 4 ].copy( p4 );\n\t\tplanes[ 5 ].copy( p5 );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( frustum ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tplanes[ i ].copy( frustum.planes[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromProjectionMatrix( m, coordinateSystem = WebGLCoordinateSystem ) {\n\n\t\tconst planes = this.planes;\n\t\tconst me = m.elements;\n\t\tconst me0 = me[ 0 ], me1 = me[ 1 ], me2 = me[ 2 ], me3 = me[ 3 ];\n\t\tconst me4 = me[ 4 ], me5 = me[ 5 ], me6 = me[ 6 ], me7 = me[ 7 ];\n\t\tconst me8 = me[ 8 ], me9 = me[ 9 ], me10 = me[ 10 ], me11 = me[ 11 ];\n\t\tconst me12 = me[ 12 ], me13 = me[ 13 ], me14 = me[ 14 ], me15 = me[ 15 ];\n\n\t\tplanes[ 0 ].setComponents( me3 - me0, me7 - me4, me11 - me8, me15 - me12 ).normalize();\n\t\tplanes[ 1 ].setComponents( me3 + me0, me7 + me4, me11 + me8, me15 + me12 ).normalize();\n\t\tplanes[ 2 ].setComponents( me3 + me1, me7 + me5, me11 + me9, me15 + me13 ).normalize();\n\t\tplanes[ 3 ].setComponents( me3 - me1, me7 - me5, me11 - me9, me15 - me13 ).normalize();\n\t\tplanes[ 4 ].setComponents( me3 - me2, me7 - me6, me11 - me10, me15 - me14 ).normalize();\n\n\t\tif ( coordinateSystem === WebGLCoordinateSystem ) {\n\n\t\t\tplanes[ 5 ].setComponents( me3 + me2, me7 + me6, me11 + me10, me15 + me14 ).normalize();\n\n\t\t} else if ( coordinateSystem === WebGPUCoordinateSystem ) {\n\n\t\t\tplanes[ 5 ].setComponents( me2, me6, me10, me14 ).normalize();\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: ' + coordinateSystem );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tintersectsObject( object ) {\n\n\t\tif ( object.boundingSphere !== undefined ) {\n\n\t\t\tif ( object.boundingSphere === null ) object.computeBoundingSphere();\n\n\t\t\t_sphere$3.copy( object.boundingSphere ).applyMatrix4( object.matrixWorld );\n\n\t\t} else {\n\n\t\t\tconst geometry = object.geometry;\n\n\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t\t_sphere$3.copy( geometry.boundingSphere ).applyMatrix4( object.matrixWorld );\n\n\t\t}\n\n\t\treturn this.intersectsSphere( _sphere$3 );\n\n\t}\n\n\tintersectsSprite( sprite ) {\n\n\t\t_sphere$3.center.set( 0, 0, 0 );\n\t\t_sphere$3.radius = 0.7071067811865476;\n\t\t_sphere$3.applyMatrix4( sprite.matrixWorld );\n\n\t\treturn this.intersectsSphere( _sphere$3 );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\tconst planes = this.planes;\n\t\tconst center = sphere.center;\n\t\tconst negRadius = - sphere.radius;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst distance = planes[ i ].distanceToPoint( center );\n\n\t\t\tif ( distance < negRadius ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst plane = planes[ i ];\n\n\t\t\t// corner at max distance\n\n\t\t\t_vector$6.x = plane.normal.x > 0 ? box.max.x : box.min.x;\n\t\t\t_vector$6.y = plane.normal.y > 0 ? box.max.y : box.min.y;\n\t\t\t_vector$6.z = plane.normal.z > 0 ? box.max.z : box.min.z;\n\n\t\t\tif ( plane.distanceToPoint( _vector$6 ) < 0 ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tif ( planes[ i ].distanceToPoint( point ) < 0 ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nfunction ascIdSort( a, b ) {\n\n\treturn a - b;\n\n}\n\nfunction sortOpaque( a, b ) {\n\n\treturn a.z - b.z;\n\n}\n\nfunction sortTransparent( a, b ) {\n\n\treturn b.z - a.z;\n\n}\n\nclass MultiDrawRenderList {\n\n\tconstructor() {\n\n\t\tthis.index = 0;\n\t\tthis.pool = [];\n\t\tthis.list = [];\n\n\t}\n\n\tpush( start, count, z, index ) {\n\n\t\tconst pool = this.pool;\n\t\tconst list = this.list;\n\t\tif ( this.index >= pool.length ) {\n\n\t\t\tpool.push( {\n\n\t\t\t\tstart: - 1,\n\t\t\t\tcount: - 1,\n\t\t\t\tz: - 1,\n\t\t\t\tindex: - 1,\n\n\t\t\t} );\n\n\t\t}\n\n\t\tconst item = pool[ this.index ];\n\t\tlist.push( item );\n\t\tthis.index ++;\n\n\t\titem.start = start;\n\t\titem.count = count;\n\t\titem.z = z;\n\t\titem.index = index;\n\n\t}\n\n\treset() {\n\n\t\tthis.list.length = 0;\n\t\tthis.index = 0;\n\n\t}\n\n}\n\nconst _matrix$1 = /*@__PURE__*/ new Matrix4();\nconst _whiteColor = /*@__PURE__*/ new Color( 1, 1, 1 );\nconst _frustum = /*@__PURE__*/ new Frustum();\nconst _box$1 = /*@__PURE__*/ new Box3();\nconst _sphere$2 = /*@__PURE__*/ new Sphere();\nconst _vector$5 = /*@__PURE__*/ new Vector3();\nconst _forward = /*@__PURE__*/ new Vector3();\nconst _temp = /*@__PURE__*/ new Vector3();\nconst _renderList = /*@__PURE__*/ new MultiDrawRenderList();\nconst _mesh = /*@__PURE__*/ new Mesh();\nconst _batchIntersects = [];\n\n// copies data from attribute \"src\" into \"target\" starting at \"targetOffset\"\nfunction copyAttributeData( src, target, targetOffset = 0 ) {\n\n\tconst itemSize = target.itemSize;\n\tif ( src.isInterleavedBufferAttribute || src.array.constructor !== target.array.constructor ) {\n\n\t\t// use the component getters and setters if the array data cannot\n\t\t// be copied directly\n\t\tconst vertexCount = src.count;\n\t\tfor ( let i = 0; i < vertexCount; i ++ ) {\n\n\t\t\tfor ( let c = 0; c < itemSize; c ++ ) {\n\n\t\t\t\ttarget.setComponent( i + targetOffset, c, src.getComponent( i, c ) );\n\n\t\t\t}\n\n\t\t}\n\n\t} else {\n\n\t\t// faster copy approach using typed array set function\n\t\ttarget.array.set( src.array, targetOffset * itemSize );\n\n\t}\n\n\ttarget.needsUpdate = true;\n\n}\n\n// safely copies array contents to a potentially smaller array\nfunction copyArrayContents( src, target ) {\n\n\tif ( src.constructor !== target.constructor ) {\n\n\t\t// if arrays are of a different type (eg due to index size increasing) then data must be per-element copied\n\t\tconst len = Math.min( src.length, target.length );\n\t\tfor ( let i = 0; i < len; i ++ ) {\n\n\t\t\ttarget[ i ] = src[ i ];\n\n\t\t}\n\n\t} else {\n\n\t\t// if the arrays use the same data layout we can use a fast block copy\n\t\tconst len = Math.min( src.length, target.length );\n\t\ttarget.set( new src.constructor( src.buffer, 0, len ) );\n\n\t}\n\n}\n\nclass BatchedMesh extends Mesh {\n\n\tget maxInstanceCount() {\n\n\t\treturn this._maxInstanceCount;\n\n\t}\n\n\tget instanceCount() {\n\n\t\treturn this._instanceInfo.length - this._availableInstanceIds.length;\n\n\t}\n\n\tget unusedVertexCount() {\n\n\t\treturn this._maxVertexCount - this._nextVertexStart;\n\n\t}\n\n\tget unusedIndexCount() {\n\n\t\treturn this._maxIndexCount - this._nextIndexStart;\n\n\t}\n\n\tconstructor( maxInstanceCount, maxVertexCount, maxIndexCount = maxVertexCount * 2, material ) {\n\n\t\tsuper( new BufferGeometry(), material );\n\n\t\tthis.isBatchedMesh = true;\n\t\tthis.perObjectFrustumCulled = true;\n\t\tthis.sortObjects = true;\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\t\tthis.customSort = null;\n\n\t\t// stores visible, active, and geometry id per instance and reserved buffer ranges for geometries\n\t\tthis._instanceInfo = [];\n\t\tthis._geometryInfo = [];\n\n\t\t// instance, geometry ids that have been set as inactive, and are available to be overwritten\n\t\tthis._availableInstanceIds = [];\n\t\tthis._availableGeometryIds = [];\n\n\t\t// used to track where the next point is that geometry should be inserted\n\t\tthis._nextIndexStart = 0;\n\t\tthis._nextVertexStart = 0;\n\t\tthis._geometryCount = 0;\n\n\t\t// flags\n\t\tthis._visibilityChanged = true;\n\t\tthis._geometryInitialized = false;\n\n\t\t// cached user options\n\t\tthis._maxInstanceCount = maxInstanceCount;\n\t\tthis._maxVertexCount = maxVertexCount;\n\t\tthis._maxIndexCount = maxIndexCount;\n\n\t\t// buffers for multi draw\n\t\tthis._multiDrawCounts = new Int32Array( maxInstanceCount );\n\t\tthis._multiDrawStarts = new Int32Array( maxInstanceCount );\n\t\tthis._multiDrawCount = 0;\n\t\tthis._multiDrawInstances = null;\n\n\t\t// Local matrix per geometry by using data texture\n\t\tthis._matricesTexture = null;\n\t\tthis._indirectTexture = null;\n\t\tthis._colorsTexture = null;\n\n\t\tthis._initMatricesTexture();\n\t\tthis._initIndirectTexture();\n\n\t}\n\n\t_initMatricesTexture() {\n\n\t\t// layout (1 matrix = 4 pixels)\n\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\n\t\t//  with  8x8  pixel texture max   16 matrices * 4 pixels =  (8 * 8)\n\t\t//       16x16 pixel texture max   64 matrices * 4 pixels = (16 * 16)\n\t\t//       32x32 pixel texture max  256 matrices * 4 pixels = (32 * 32)\n\t\t//       64x64 pixel texture max 1024 matrices * 4 pixels = (64 * 64)\n\n\t\tlet size = Math.sqrt( this._maxInstanceCount * 4 ); // 4 pixels needed for 1 matrix\n\t\tsize = Math.ceil( size / 4 ) * 4;\n\t\tsize = Math.max( size, 4 );\n\n\t\tconst matricesArray = new Float32Array( size * size * 4 ); // 4 floats per RGBA pixel\n\t\tconst matricesTexture = new DataTexture( matricesArray, size, size, RGBAFormat, FloatType );\n\n\t\tthis._matricesTexture = matricesTexture;\n\n\t}\n\n\t_initIndirectTexture() {\n\n\t\tlet size = Math.sqrt( this._maxInstanceCount );\n\t\tsize = Math.ceil( size );\n\n\t\tconst indirectArray = new Uint32Array( size * size );\n\t\tconst indirectTexture = new DataTexture( indirectArray, size, size, RedIntegerFormat, UnsignedIntType );\n\n\t\tthis._indirectTexture = indirectTexture;\n\n\t}\n\n\t_initColorsTexture() {\n\n\t\tlet size = Math.sqrt( this._maxInstanceCount );\n\t\tsize = Math.ceil( size );\n\n\t\t// 4 floats per RGBA pixel initialized to white\n\t\tconst colorsArray = new Float32Array( size * size * 4 ).fill( 1 );\n\t\tconst colorsTexture = new DataTexture( colorsArray, size, size, RGBAFormat, FloatType );\n\t\tcolorsTexture.colorSpace = ColorManagement.workingColorSpace;\n\n\t\tthis._colorsTexture = colorsTexture;\n\n\t}\n\n\t_initializeGeometry( reference ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst maxVertexCount = this._maxVertexCount;\n\t\tconst maxIndexCount = this._maxIndexCount;\n\t\tif ( this._geometryInitialized === false ) {\n\n\t\t\tfor ( const attributeName in reference.attributes ) {\n\n\t\t\t\tconst srcAttribute = reference.getAttribute( attributeName );\n\t\t\t\tconst { array, itemSize, normalized } = srcAttribute;\n\n\t\t\t\tconst dstArray = new array.constructor( maxVertexCount * itemSize );\n\t\t\t\tconst dstAttribute = new BufferAttribute( dstArray, itemSize, normalized );\n\n\t\t\t\tgeometry.setAttribute( attributeName, dstAttribute );\n\n\t\t\t}\n\n\t\t\tif ( reference.getIndex() !== null ) {\n\n\t\t\t\t// Reserve last u16 index for primitive restart.\n\t\t\t\tconst indexArray = maxVertexCount > 65535\n\t\t\t\t\t? new Uint32Array( maxIndexCount )\n\t\t\t\t\t: new Uint16Array( maxIndexCount );\n\n\t\t\t\tgeometry.setIndex( new BufferAttribute( indexArray, 1 ) );\n\n\t\t\t}\n\n\t\t\tthis._geometryInitialized = true;\n\n\t\t}\n\n\t}\n\n\t// Make sure the geometry is compatible with the existing combined geometry attributes\n\t_validateGeometry( geometry ) {\n\n\t\t// check to ensure the geometries are using consistent attributes and indices\n\t\tconst batchGeometry = this.geometry;\n\t\tif ( Boolean( geometry.getIndex() ) !== Boolean( batchGeometry.getIndex() ) ) {\n\n\t\t\tthrow new Error( 'THREE.BatchedMesh: All geometries must consistently have \"index\".' );\n\n\t\t}\n\n\t\tfor ( const attributeName in batchGeometry.attributes ) {\n\n\t\t\tif ( ! geometry.hasAttribute( attributeName ) ) {\n\n\t\t\t\tthrow new Error( `THREE.BatchedMesh: Added geometry missing \"${ attributeName }\". All geometries must have consistent attributes.` );\n\n\t\t\t}\n\n\t\t\tconst srcAttribute = geometry.getAttribute( attributeName );\n\t\t\tconst dstAttribute = batchGeometry.getAttribute( attributeName );\n\t\t\tif ( srcAttribute.itemSize !== dstAttribute.itemSize || srcAttribute.normalized !== dstAttribute.normalized ) {\n\n\t\t\t\tthrow new Error( 'THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tvalidateInstanceId( instanceId ) {\n\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tif ( instanceId < 0 || instanceId >= instanceInfo.length || instanceInfo[ instanceId ].active === false ) {\n\n\t\t\tthrow new Error( `THREE.BatchedMesh: Invalid instanceId ${instanceId}. Instance is either out of range or has been deleted.` );\n\n\t\t}\n\n\t}\n\n\tvalidateGeometryId( geometryId ) {\n\n\t\tconst geometryInfoList = this._geometryInfo;\n\t\tif ( geometryId < 0 || geometryId >= geometryInfoList.length || geometryInfoList[ geometryId ].active === false ) {\n\n\t\t\tthrow new Error( `THREE.BatchedMesh: Invalid geometryId ${geometryId}. Geometry is either out of range or has been deleted.` );\n\n\t\t}\n\n\t}\n\n\n\tsetCustomSort( func ) {\n\n\t\tthis.customSort = func;\n\t\treturn this;\n\n\t}\n\n\tcomputeBoundingBox() {\n\n\t\tif ( this.boundingBox === null ) {\n\n\t\t\tthis.boundingBox = new Box3();\n\n\t\t}\n\n\t\tconst boundingBox = this.boundingBox;\n\t\tconst instanceInfo = this._instanceInfo;\n\n\t\tboundingBox.makeEmpty();\n\t\tfor ( let i = 0, l = instanceInfo.length; i < l; i ++ ) {\n\n\t\t\tif ( instanceInfo[ i ].active === false ) continue;\n\n\t\t\tconst geometryId = instanceInfo[ i ].geometryIndex;\n\t\t\tthis.getMatrixAt( i, _matrix$1 );\n\t\t\tthis.getBoundingBoxAt( geometryId, _box$1 ).applyMatrix4( _matrix$1 );\n\t\t\tboundingBox.union( _box$1 );\n\n\t\t}\n\n\t}\n\n\tcomputeBoundingSphere() {\n\n\t\tif ( this.boundingSphere === null ) {\n\n\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t}\n\n\t\tconst boundingSphere = this.boundingSphere;\n\t\tconst instanceInfo = this._instanceInfo;\n\n\t\tboundingSphere.makeEmpty();\n\t\tfor ( let i = 0, l = instanceInfo.length; i < l; i ++ ) {\n\n\t\t\tif ( instanceInfo[ i ].active === false ) continue;\n\n\t\t\tconst geometryId = instanceInfo[ i ].geometryIndex;\n\t\t\tthis.getMatrixAt( i, _matrix$1 );\n\t\t\tthis.getBoundingSphereAt( geometryId, _sphere$2 ).applyMatrix4( _matrix$1 );\n\t\t\tboundingSphere.union( _sphere$2 );\n\n\t\t}\n\n\t}\n\n\taddInstance( geometryId ) {\n\n\t\tconst atCapacity = this._instanceInfo.length >= this.maxInstanceCount;\n\n\t\t// ensure we're not over geometry\n\t\tif ( atCapacity && this._availableInstanceIds.length === 0 ) {\n\n\t\t\tthrow new Error( 'THREE.BatchedMesh: Maximum item count reached.' );\n\n\t\t}\n\n\t\tconst instanceInfo = {\n\t\t\tvisible: true,\n\t\t\tactive: true,\n\t\t\tgeometryIndex: geometryId,\n\t\t};\n\n\t\tlet drawId = null;\n\n\t\t// Prioritize using previously freed instance ids\n\t\tif ( this._availableInstanceIds.length > 0 ) {\n\n\t\t\tthis._availableInstanceIds.sort( ascIdSort );\n\n\t\t\tdrawId = this._availableInstanceIds.shift();\n\t\t\tthis._instanceInfo[ drawId ] = instanceInfo;\n\n\t\t} else {\n\n\t\t\tdrawId = this._instanceInfo.length;\n\t\t\tthis._instanceInfo.push( instanceInfo );\n\n\t\t}\n\n\t\tconst matricesTexture = this._matricesTexture;\n\t\t_matrix$1.identity().toArray( matricesTexture.image.data, drawId * 16 );\n\t\tmatricesTexture.needsUpdate = true;\n\n\t\tconst colorsTexture = this._colorsTexture;\n\t\tif ( colorsTexture ) {\n\n\t\t\t_whiteColor.toArray( colorsTexture.image.data, drawId * 4 );\n\t\t\tcolorsTexture.needsUpdate = true;\n\n\t\t}\n\n\t\tthis._visibilityChanged = true;\n\t\treturn drawId;\n\n\t}\n\n\taddGeometry( geometry, reservedVertexCount = - 1, reservedIndexCount = - 1 ) {\n\n\t\tthis._initializeGeometry( geometry );\n\n\t\tthis._validateGeometry( geometry );\n\n\t\tconst geometryInfo = {\n\t\t\t// geometry information\n\t\t\tvertexStart: - 1,\n\t\t\tvertexCount: - 1,\n\t\t\treservedVertexCount: - 1,\n\n\t\t\tindexStart: - 1,\n\t\t\tindexCount: - 1,\n\t\t\treservedIndexCount: - 1,\n\n\t\t\t// draw range information\n\t\t\tstart: - 1,\n\t\t\tcount: - 1,\n\n\t\t\t// state\n\t\t\tboundingBox: null,\n\t\t\tboundingSphere: null,\n\t\t\tactive: true,\n\t\t};\n\n\t\tconst geometryInfoList = this._geometryInfo;\n\t\tgeometryInfo.vertexStart = this._nextVertexStart;\n\t\tgeometryInfo.reservedVertexCount = reservedVertexCount === - 1 ? geometry.getAttribute( 'position' ).count : reservedVertexCount;\n\n\t\tconst index = geometry.getIndex();\n\t\tconst hasIndex = index !== null;\n\t\tif ( hasIndex ) {\n\n\t\t\tgeometryInfo.indexStart = this._nextIndexStart;\n\t\t\tgeometryInfo.reservedIndexCount = reservedIndexCount === - 1 ? index.count : reservedIndexCount;\n\n\t\t}\n\n\t\tif (\n\t\t\tgeometryInfo.indexStart !== - 1 &&\n\t\t\tgeometryInfo.indexStart + geometryInfo.reservedIndexCount > this._maxIndexCount ||\n\t\t\tgeometryInfo.vertexStart + geometryInfo.reservedVertexCount > this._maxVertexCount\n\t\t) {\n\n\t\t\tthrow new Error( 'THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.' );\n\n\t\t}\n\n\t\t// update id\n\t\tlet geometryId;\n\t\tif ( this._availableGeometryIds.length > 0 ) {\n\n\t\t\tthis._availableGeometryIds.sort( ascIdSort );\n\n\t\t\tgeometryId = this._availableGeometryIds.shift();\n\t\t\tgeometryInfoList[ geometryId ] = geometryInfo;\n\n\n\t\t} else {\n\n\t\t\tgeometryId = this._geometryCount;\n\t\t\tthis._geometryCount ++;\n\t\t\tgeometryInfoList.push( geometryInfo );\n\n\t\t}\n\n\t\t// update the geometry\n\t\tthis.setGeometryAt( geometryId, geometry );\n\n\t\t// increment the next geometry position\n\t\tthis._nextIndexStart = geometryInfo.indexStart + geometryInfo.reservedIndexCount;\n\t\tthis._nextVertexStart = geometryInfo.vertexStart + geometryInfo.reservedVertexCount;\n\n\t\treturn geometryId;\n\n\t}\n\n\tsetGeometryAt( geometryId, geometry ) {\n\n\t\tif ( geometryId >= this._geometryCount ) {\n\n\t\t\tthrow new Error( 'THREE.BatchedMesh: Maximum geometry count reached.' );\n\n\t\t}\n\n\t\tthis._validateGeometry( geometry );\n\n\t\tconst batchGeometry = this.geometry;\n\t\tconst hasIndex = batchGeometry.getIndex() !== null;\n\t\tconst dstIndex = batchGeometry.getIndex();\n\t\tconst srcIndex = geometry.getIndex();\n\t\tconst geometryInfo = this._geometryInfo[ geometryId ];\n\t\tif (\n\t\t\thasIndex &&\n\t\t\tsrcIndex.count > geometryInfo.reservedIndexCount ||\n\t\t\tgeometry.attributes.position.count > geometryInfo.reservedVertexCount\n\t\t) {\n\n\t\t\tthrow new Error( 'THREE.BatchedMesh: Reserved space not large enough for provided geometry.' );\n\n\t\t}\n\n\t\t// copy geometry buffer data over\n\t\tconst vertexStart = geometryInfo.vertexStart;\n\t\tconst reservedVertexCount = geometryInfo.reservedVertexCount;\n\t\tgeometryInfo.vertexCount = geometry.getAttribute( 'position' ).count;\n\n\t\tfor ( const attributeName in batchGeometry.attributes ) {\n\n\t\t\t// copy attribute data\n\t\t\tconst srcAttribute = geometry.getAttribute( attributeName );\n\t\t\tconst dstAttribute = batchGeometry.getAttribute( attributeName );\n\t\t\tcopyAttributeData( srcAttribute, dstAttribute, vertexStart );\n\n\t\t\t// fill the rest in with zeroes\n\t\t\tconst itemSize = srcAttribute.itemSize;\n\t\t\tfor ( let i = srcAttribute.count, l = reservedVertexCount; i < l; i ++ ) {\n\n\t\t\t\tconst index = vertexStart + i;\n\t\t\t\tfor ( let c = 0; c < itemSize; c ++ ) {\n\n\t\t\t\t\tdstAttribute.setComponent( index, c, 0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tdstAttribute.needsUpdate = true;\n\t\t\tdstAttribute.addUpdateRange( vertexStart * itemSize, reservedVertexCount * itemSize );\n\n\t\t}\n\n\t\t// copy index\n\t\tif ( hasIndex ) {\n\n\t\t\tconst indexStart = geometryInfo.indexStart;\n\t\t\tconst reservedIndexCount = geometryInfo.reservedIndexCount;\n\t\t\tgeometryInfo.indexCount = geometry.getIndex().count;\n\n\t\t\t// copy index data over\n\t\t\tfor ( let i = 0; i < srcIndex.count; i ++ ) {\n\n\t\t\t\tdstIndex.setX( indexStart + i, vertexStart + srcIndex.getX( i ) );\n\n\t\t\t}\n\n\t\t\t// fill the rest in with zeroes\n\t\t\tfor ( let i = srcIndex.count, l = reservedIndexCount; i < l; i ++ ) {\n\n\t\t\t\tdstIndex.setX( indexStart + i, vertexStart );\n\n\t\t\t}\n\n\t\t\tdstIndex.needsUpdate = true;\n\t\t\tdstIndex.addUpdateRange( indexStart, geometryInfo.reservedIndexCount );\n\n\t\t}\n\n\t\t// update the draw range\n\t\tgeometryInfo.start = hasIndex ? geometryInfo.indexStart : geometryInfo.vertexStart;\n\t\tgeometryInfo.count = hasIndex ? geometryInfo.indexCount : geometryInfo.vertexCount;\n\n\t\t// store the bounding boxes\n\t\tgeometryInfo.boundingBox = null;\n\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\tgeometryInfo.boundingBox = geometry.boundingBox.clone();\n\n\t\t}\n\n\t\tgeometryInfo.boundingSphere = null;\n\t\tif ( geometry.boundingSphere !== null ) {\n\n\t\t\tgeometryInfo.boundingSphere = geometry.boundingSphere.clone();\n\n\t\t}\n\n\t\tthis._visibilityChanged = true;\n\t\treturn geometryId;\n\n\t}\n\n\tdeleteGeometry( geometryId ) {\n\n\t\tconst geometryInfoList = this._geometryInfo;\n\t\tif ( geometryId >= geometryInfoList.length || geometryInfoList[ geometryId ].active === false ) {\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\t// delete any instances associated with this geometry\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tfor ( let i = 0, l = instanceInfo.length; i < l; i ++ ) {\n\n\t\t\tif ( instanceInfo[ i ].geometryIndex === geometryId ) {\n\n\t\t\t\tthis.deleteInstance( i );\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeometryInfoList[ geometryId ].active = false;\n\t\tthis._availableGeometryIds.push( geometryId );\n\t\tthis._visibilityChanged = true;\n\n\t\treturn this;\n\n\t}\n\n\tdeleteInstance( instanceId ) {\n\n\t\tthis.validateInstanceId( instanceId );\n\n\t\tthis._instanceInfo[ instanceId ].active = false;\n\t\tthis._availableInstanceIds.push( instanceId );\n\t\tthis._visibilityChanged = true;\n\n\t\treturn this;\n\n\t}\n\n\toptimize() {\n\n\t\t// track the next indices to copy data to\n\t\tlet nextVertexStart = 0;\n\t\tlet nextIndexStart = 0;\n\n\t\t// Iterate over all geometry ranges in order sorted from earliest in the geometry buffer to latest\n\t\t// in the geometry buffer. Because draw range objects can be reused there is no guarantee of their order.\n\t\tconst geometryInfoList = this._geometryInfo;\n\t\tconst indices = geometryInfoList\n\t\t\t.map( ( e, i ) => i )\n\t\t\t.sort( ( a, b ) => {\n\n\t\t\t\treturn geometryInfoList[ a ].vertexStart - geometryInfoList[ b ].vertexStart;\n\n\t\t\t} );\n\n\t\tconst geometry = this.geometry;\n\t\tfor ( let i = 0, l = geometryInfoList.length; i < l; i ++ ) {\n\n\t\t\t// if a geometry range is inactive then don't copy anything\n\t\t\tconst index = indices[ i ];\n\t\t\tconst geometryInfo = geometryInfoList[ index ];\n\t\t\tif ( geometryInfo.active === false ) {\n\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\t// if a geometry contains an index buffer then shift it, as well\n\t\t\tif ( geometry.index !== null ) {\n\n\t\t\t\tif ( geometryInfo.indexStart !== nextIndexStart ) {\n\n\t\t\t\t\tconst { indexStart, vertexStart, reservedIndexCount } = geometryInfo;\n\t\t\t\t\tconst index = geometry.index;\n\t\t\t\t\tconst array = index.array;\n\n\t\t\t\t\t// shift the index pointers based on how the vertex data will shift\n\t\t\t\t\t// adjusting the index must happen first so the original vertex start value is available\n\t\t\t\t\tconst elementDelta = nextVertexStart - vertexStart;\n\t\t\t\t\tfor ( let j = indexStart; j < indexStart + reservedIndexCount; j ++ ) {\n\n\t\t\t\t\t\tarray[ j ] = array[ j ] + elementDelta;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tindex.array.copyWithin( nextIndexStart, indexStart, indexStart + reservedIndexCount );\n\t\t\t\t\tindex.addUpdateRange( nextIndexStart, reservedIndexCount );\n\n\t\t\t\t\tgeometryInfo.indexStart = nextIndexStart;\n\n\t\t\t\t}\n\n\t\t\t\tnextIndexStart += geometryInfo.reservedIndexCount;\n\n\t\t\t}\n\n\t\t\t// if a geometry needs to be moved then copy attribute data to overwrite unused space\n\t\t\tif ( geometryInfo.vertexStart !== nextVertexStart ) {\n\n\t\t\t\tconst { vertexStart, reservedVertexCount } = geometryInfo;\n\t\t\t\tconst attributes = geometry.attributes;\n\t\t\t\tfor ( const key in attributes ) {\n\n\t\t\t\t\tconst attribute = attributes[ key ];\n\t\t\t\t\tconst { array, itemSize } = attribute;\n\t\t\t\t\tarray.copyWithin( nextVertexStart * itemSize, vertexStart * itemSize, ( vertexStart + reservedVertexCount ) * itemSize );\n\t\t\t\t\tattribute.addUpdateRange( nextVertexStart * itemSize, reservedVertexCount * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tgeometryInfo.vertexStart = nextVertexStart;\n\n\t\t\t}\n\n\t\t\tnextVertexStart += geometryInfo.reservedVertexCount;\n\t\t\tgeometryInfo.start = geometry.index ? geometryInfo.indexStart : geometryInfo.vertexStart;\n\n\t\t\t// step the next geometry points to the shifted position\n\t\t\tthis._nextIndexStart = geometry.index ? geometryInfo.indexStart + geometryInfo.reservedIndexCount : 0;\n\t\t\tthis._nextVertexStart = geometryInfo.vertexStart + geometryInfo.reservedVertexCount;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// get bounding box and compute it if it doesn't exist\n\tgetBoundingBoxAt( geometryId, target ) {\n\n\t\tif ( geometryId >= this._geometryCount ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// compute bounding box\n\t\tconst geometry = this.geometry;\n\t\tconst geometryInfo = this._geometryInfo[ geometryId ];\n\t\tif ( geometryInfo.boundingBox === null ) {\n\n\t\t\tconst box = new Box3();\n\t\t\tconst index = geometry.index;\n\t\t\tconst position = geometry.attributes.position;\n\t\t\tfor ( let i = geometryInfo.start, l = geometryInfo.start + geometryInfo.count; i < l; i ++ ) {\n\n\t\t\t\tlet iv = i;\n\t\t\t\tif ( index ) {\n\n\t\t\t\t\tiv = index.getX( iv );\n\n\t\t\t\t}\n\n\t\t\t\tbox.expandByPoint( _vector$5.fromBufferAttribute( position, iv ) );\n\n\t\t\t}\n\n\t\t\tgeometryInfo.boundingBox = box;\n\n\t\t}\n\n\t\ttarget.copy( geometryInfo.boundingBox );\n\t\treturn target;\n\n\t}\n\n\t// get bounding sphere and compute it if it doesn't exist\n\tgetBoundingSphereAt( geometryId, target ) {\n\n\t\tif ( geometryId >= this._geometryCount ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// compute bounding sphere\n\t\tconst geometry = this.geometry;\n\t\tconst geometryInfo = this._geometryInfo[ geometryId ];\n\t\tif ( geometryInfo.boundingSphere === null ) {\n\n\t\t\tconst sphere = new Sphere();\n\t\t\tthis.getBoundingBoxAt( geometryId, _box$1 );\n\t\t\t_box$1.getCenter( sphere.center );\n\n\t\t\tconst index = geometry.index;\n\t\t\tconst position = geometry.attributes.position;\n\n\t\t\tlet maxRadiusSq = 0;\n\t\t\tfor ( let i = geometryInfo.start, l = geometryInfo.start + geometryInfo.count; i < l; i ++ ) {\n\n\t\t\t\tlet iv = i;\n\t\t\t\tif ( index ) {\n\n\t\t\t\t\tiv = index.getX( iv );\n\n\t\t\t\t}\n\n\t\t\t\t_vector$5.fromBufferAttribute( position, iv );\n\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, sphere.center.distanceToSquared( _vector$5 ) );\n\n\t\t\t}\n\n\t\t\tsphere.radius = Math.sqrt( maxRadiusSq );\n\t\t\tgeometryInfo.boundingSphere = sphere;\n\n\t\t}\n\n\t\ttarget.copy( geometryInfo.boundingSphere );\n\t\treturn target;\n\n\t}\n\n\tsetMatrixAt( instanceId, matrix ) {\n\n\t\tthis.validateInstanceId( instanceId );\n\n\t\tconst matricesTexture = this._matricesTexture;\n\t\tconst matricesArray = this._matricesTexture.image.data;\n\t\tmatrix.toArray( matricesArray, instanceId * 16 );\n\t\tmatricesTexture.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\tgetMatrixAt( instanceId, matrix ) {\n\n\t\tthis.validateInstanceId( instanceId );\n\t\treturn matrix.fromArray( this._matricesTexture.image.data, instanceId * 16 );\n\n\t}\n\n\tsetColorAt( instanceId, color ) {\n\n\t\tthis.validateInstanceId( instanceId );\n\n\t\tif ( this._colorsTexture === null ) {\n\n\t\t\tthis._initColorsTexture();\n\n\t\t}\n\n\t\tcolor.toArray( this._colorsTexture.image.data, instanceId * 4 );\n\t\tthis._colorsTexture.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\tgetColorAt( instanceId, color ) {\n\n\t\tthis.validateInstanceId( instanceId );\n\t\treturn color.fromArray( this._colorsTexture.image.data, instanceId * 4 );\n\n\t}\n\n\tsetVisibleAt( instanceId, value ) {\n\n\t\tthis.validateInstanceId( instanceId );\n\n\t\tif ( this._instanceInfo[ instanceId ].visible === value ) {\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tthis._instanceInfo[ instanceId ].visible = value;\n\t\tthis._visibilityChanged = true;\n\n\t\treturn this;\n\n\t}\n\n\tgetVisibleAt( instanceId ) {\n\n\t\tthis.validateInstanceId( instanceId );\n\n\t\treturn this._instanceInfo[ instanceId ].visible;\n\n\t}\n\n\tsetGeometryIdAt( instanceId, geometryId ) {\n\n\t\tthis.validateInstanceId( instanceId );\n\t\tthis.validateGeometryId( geometryId );\n\n\t\tthis._instanceInfo[ instanceId ].geometryIndex = geometryId;\n\n\t\treturn this;\n\n\t}\n\n\tgetGeometryIdAt( instanceId ) {\n\n\t\tthis.validateInstanceId( instanceId );\n\n\t\treturn this._instanceInfo[ instanceId ].geometryIndex;\n\n\t}\n\n\tgetGeometryRangeAt( geometryId, target = {} ) {\n\n\t\tthis.validateGeometryId( geometryId );\n\n\t\tconst geometryInfo = this._geometryInfo[ geometryId ];\n\t\ttarget.vertexStart = geometryInfo.vertexStart;\n\t\ttarget.vertexCount = geometryInfo.vertexCount;\n\t\ttarget.reservedVertexCount = geometryInfo.reservedVertexCount;\n\n\t\ttarget.indexStart = geometryInfo.indexStart;\n\t\ttarget.indexCount = geometryInfo.indexCount;\n\t\ttarget.reservedIndexCount = geometryInfo.reservedIndexCount;\n\n\t\ttarget.start = geometryInfo.start;\n\t\ttarget.count = geometryInfo.count;\n\n\t\treturn target;\n\n\t}\n\n\tsetInstanceCount( maxInstanceCount ) {\n\n\t\t// shrink the available instances as much as possible\n\t\tconst availableInstanceIds = this._availableInstanceIds;\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tavailableInstanceIds.sort( ascIdSort );\n\t\twhile ( availableInstanceIds[ availableInstanceIds.length - 1 ] === instanceInfo.length ) {\n\n\t\t\tinstanceInfo.pop();\n\t\t\tavailableInstanceIds.pop();\n\n\t\t}\n\n\t\t// throw an error if it can't be shrunk to the desired size\n\t\tif ( maxInstanceCount < instanceInfo.length ) {\n\n\t\t\tthrow new Error( `BatchedMesh: Instance ids outside the range ${ maxInstanceCount } are being used. Cannot shrink instance count.` );\n\n\t\t}\n\n\t\t// copy the multi draw counts\n\t\tconst multiDrawCounts = new Int32Array( maxInstanceCount );\n\t\tconst multiDrawStarts = new Int32Array( maxInstanceCount );\n\t\tcopyArrayContents( this._multiDrawCounts, multiDrawCounts );\n\t\tcopyArrayContents( this._multiDrawStarts, multiDrawStarts );\n\n\t\tthis._multiDrawCounts = multiDrawCounts;\n\t\tthis._multiDrawStarts = multiDrawStarts;\n\t\tthis._maxInstanceCount = maxInstanceCount;\n\n\t\t// update texture data for instance sampling\n\t\tconst indirectTexture = this._indirectTexture;\n\t\tconst matricesTexture = this._matricesTexture;\n\t\tconst colorsTexture = this._colorsTexture;\n\n\t\tindirectTexture.dispose();\n\t\tthis._initIndirectTexture();\n\t\tcopyArrayContents( indirectTexture.image.data, this._indirectTexture.image.data );\n\n\t\tmatricesTexture.dispose();\n\t\tthis._initMatricesTexture();\n\t\tcopyArrayContents( matricesTexture.image.data, this._matricesTexture.image.data );\n\n\t\tif ( colorsTexture ) {\n\n\t\t\tcolorsTexture.dispose();\n\t\t\tthis._initColorsTexture();\n\t\t\tcopyArrayContents( colorsTexture.image.data, this._colorsTexture.image.data );\n\n\t\t}\n\n\t}\n\n\tsetGeometrySize( maxVertexCount, maxIndexCount ) {\n\n\t\t// Check if we can shrink to the requested vertex attribute size\n\t\tconst validRanges = [ ...this._geometryInfo ].filter( info => info.active );\n\t\tconst requiredVertexLength = Math.max( ...validRanges.map( range => range.vertexStart + range.reservedVertexCount ) );\n\t\tif ( requiredVertexLength > maxVertexCount ) {\n\n\t\t\tthrow new Error( `BatchedMesh: Geometry vertex values are being used outside the range ${ maxIndexCount }. Cannot shrink further.` );\n\n\t\t}\n\n\t\t// Check if we can shrink to the requested index attribute size\n\t\tif ( this.geometry.index ) {\n\n\t\t\tconst requiredIndexLength = Math.max( ...validRanges.map( range => range.indexStart + range.reservedIndexCount ) );\n\t\t\tif ( requiredIndexLength > maxIndexCount ) {\n\n\t\t\t\tthrow new Error( `BatchedMesh: Geometry index values are being used outside the range ${ maxIndexCount }. Cannot shrink further.` );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\t// dispose of the previous geometry\n\t\tconst oldGeometry = this.geometry;\n\t\toldGeometry.dispose();\n\n\t\t// recreate the geometry needed based on the previous variant\n\t\tthis._maxVertexCount = maxVertexCount;\n\t\tthis._maxIndexCount = maxIndexCount;\n\n\t\tif ( this._geometryInitialized ) {\n\n\t\t\tthis._geometryInitialized = false;\n\t\t\tthis.geometry = new BufferGeometry();\n\t\t\tthis._initializeGeometry( oldGeometry );\n\n\t\t}\n\n\t\t// copy data from the previous geometry\n\t\tconst geometry = this.geometry;\n\t\tif ( oldGeometry.index ) {\n\n\t\t\tcopyArrayContents( oldGeometry.index.array, geometry.index.array );\n\n\t\t}\n\n\t\tfor ( const key in oldGeometry.attributes ) {\n\n\t\t\tcopyArrayContents( oldGeometry.attributes[ key ].array, geometry.attributes[ key ].array );\n\n\t\t}\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tconst geometryInfoList = this._geometryInfo;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst batchGeometry = this.geometry;\n\n\t\t// iterate over each geometry\n\t\t_mesh.material = this.material;\n\t\t_mesh.geometry.index = batchGeometry.index;\n\t\t_mesh.geometry.attributes = batchGeometry.attributes;\n\t\tif ( _mesh.geometry.boundingBox === null ) {\n\n\t\t\t_mesh.geometry.boundingBox = new Box3();\n\n\t\t}\n\n\t\tif ( _mesh.geometry.boundingSphere === null ) {\n\n\t\t\t_mesh.geometry.boundingSphere = new Sphere();\n\n\t\t}\n\n\t\tfor ( let i = 0, l = instanceInfo.length; i < l; i ++ ) {\n\n\t\t\tif ( ! instanceInfo[ i ].visible || ! instanceInfo[ i ].active ) {\n\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tconst geometryId = instanceInfo[ i ].geometryIndex;\n\t\t\tconst geometryInfo = geometryInfoList[ geometryId ];\n\t\t\t_mesh.geometry.setDrawRange( geometryInfo.start, geometryInfo.count );\n\n\t\t\t// get the intersects\n\t\t\tthis.getMatrixAt( i, _mesh.matrixWorld ).premultiply( matrixWorld );\n\t\t\tthis.getBoundingBoxAt( geometryId, _mesh.geometry.boundingBox );\n\t\t\tthis.getBoundingSphereAt( geometryId, _mesh.geometry.boundingSphere );\n\t\t\t_mesh.raycast( raycaster, _batchIntersects );\n\n\t\t\t// add batch id to the intersects\n\t\t\tfor ( let j = 0, l = _batchIntersects.length; j < l; j ++ ) {\n\n\t\t\t\tconst intersect = _batchIntersects[ j ];\n\t\t\t\tintersect.object = this;\n\t\t\t\tintersect.batchId = i;\n\t\t\t\tintersects.push( intersect );\n\n\t\t\t}\n\n\t\t\t_batchIntersects.length = 0;\n\n\t\t}\n\n\t\t_mesh.material = null;\n\t\t_mesh.geometry.index = null;\n\t\t_mesh.geometry.attributes = {};\n\t\t_mesh.geometry.setDrawRange( 0, Infinity );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.geometry = source.geometry.clone();\n\t\tthis.perObjectFrustumCulled = source.perObjectFrustumCulled;\n\t\tthis.sortObjects = source.sortObjects;\n\t\tthis.boundingBox = source.boundingBox !== null ? source.boundingBox.clone() : null;\n\t\tthis.boundingSphere = source.boundingSphere !== null ? source.boundingSphere.clone() : null;\n\n\t\tthis._geometryInfo = source._geometryInfo.map( info => ( {\n\t\t\t...info,\n\n\t\t\tboundingBox: info.boundingBox !== null ? info.boundingBox.clone() : null,\n\t\t\tboundingSphere: info.boundingSphere !== null ? info.boundingSphere.clone() : null,\n\t\t} ) );\n\t\tthis._instanceInfo = source._instanceInfo.map( info => ( { ...info } ) );\n\n\t\tthis._maxInstanceCount = source._maxInstanceCount;\n\t\tthis._maxVertexCount = source._maxVertexCount;\n\t\tthis._maxIndexCount = source._maxIndexCount;\n\n\t\tthis._geometryInitialized = source._geometryInitialized;\n\t\tthis._geometryCount = source._geometryCount;\n\t\tthis._multiDrawCounts = source._multiDrawCounts.slice();\n\t\tthis._multiDrawStarts = source._multiDrawStarts.slice();\n\n\t\tthis._matricesTexture = source._matricesTexture.clone();\n\t\tthis._matricesTexture.image.data = this._matricesTexture.image.data.slice();\n\n\t\tif ( this._colorsTexture !== null ) {\n\n\t\t\tthis._colorsTexture = source._colorsTexture.clone();\n\t\t\tthis._colorsTexture.image.data = this._colorsTexture.image.data.slice();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\t// Assuming the geometry is not shared with other meshes\n\t\tthis.geometry.dispose();\n\n\t\tthis._matricesTexture.dispose();\n\t\tthis._matricesTexture = null;\n\n\t\tthis._indirectTexture.dispose();\n\t\tthis._indirectTexture = null;\n\n\t\tif ( this._colorsTexture !== null ) {\n\n\t\t\tthis._colorsTexture.dispose();\n\t\t\tthis._colorsTexture = null;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tonBeforeRender( renderer, scene, camera, geometry, material/*, _group*/ ) {\n\n\t\t// if visibility has not changed and frustum culling and object sorting is not required\n\t\t// then skip iterating over all items\n\t\tif ( ! this._visibilityChanged && ! this.perObjectFrustumCulled && ! this.sortObjects ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// the indexed version of the multi draw function requires specifying the start\n\t\t// offset in bytes.\n\t\tconst index = geometry.getIndex();\n\t\tconst bytesPerElement = index === null ? 1 : index.array.BYTES_PER_ELEMENT;\n\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tconst multiDrawStarts = this._multiDrawStarts;\n\t\tconst multiDrawCounts = this._multiDrawCounts;\n\t\tconst geometryInfoList = this._geometryInfo;\n\t\tconst perObjectFrustumCulled = this.perObjectFrustumCulled;\n\t\tconst indirectTexture = this._indirectTexture;\n\t\tconst indirectArray = indirectTexture.image.data;\n\n\t\t// prepare the frustum in the local frame\n\t\tif ( perObjectFrustumCulled ) {\n\n\t\t\t_matrix$1\n\t\t\t\t.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse )\n\t\t\t\t.multiply( this.matrixWorld );\n\t\t\t_frustum.setFromProjectionMatrix(\n\t\t\t\t_matrix$1,\n\t\t\t\trenderer.coordinateSystem\n\t\t\t);\n\n\t\t}\n\n\t\tlet multiDrawCount = 0;\n\t\tif ( this.sortObjects ) {\n\n\t\t\t// get the camera position in the local frame\n\t\t\t_matrix$1.copy( this.matrixWorld ).invert();\n\t\t\t_vector$5.setFromMatrixPosition( camera.matrixWorld ).applyMatrix4( _matrix$1 );\n\t\t\t_forward.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld ).transformDirection( _matrix$1 );\n\n\t\t\tfor ( let i = 0, l = instanceInfo.length; i < l; i ++ ) {\n\n\t\t\t\tif ( instanceInfo[ i ].visible && instanceInfo[ i ].active ) {\n\n\t\t\t\t\tconst geometryId = instanceInfo[ i ].geometryIndex;\n\n\t\t\t\t\t// get the bounds in world space\n\t\t\t\t\tthis.getMatrixAt( i, _matrix$1 );\n\t\t\t\t\tthis.getBoundingSphereAt( geometryId, _sphere$2 ).applyMatrix4( _matrix$1 );\n\n\t\t\t\t\t// determine whether the batched geometry is within the frustum\n\t\t\t\t\tlet culled = false;\n\t\t\t\t\tif ( perObjectFrustumCulled ) {\n\n\t\t\t\t\t\tculled = ! _frustum.intersectsSphere( _sphere$2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! culled ) {\n\n\t\t\t\t\t\t// get the distance from camera used for sorting\n\t\t\t\t\t\tconst geometryInfo = geometryInfoList[ geometryId ];\n\t\t\t\t\t\tconst z = _temp.subVectors( _sphere$2.center, _vector$5 ).dot( _forward );\n\t\t\t\t\t\t_renderList.push( geometryInfo.start, geometryInfo.count, z, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Sort the draw ranges and prep for rendering\n\t\t\tconst list = _renderList.list;\n\t\t\tconst customSort = this.customSort;\n\t\t\tif ( customSort === null ) {\n\n\t\t\t\tlist.sort( material.transparent ? sortTransparent : sortOpaque );\n\n\t\t\t} else {\n\n\t\t\t\tcustomSort.call( this, list, camera );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, l = list.length; i < l; i ++ ) {\n\n\t\t\t\tconst item = list[ i ];\n\t\t\t\tmultiDrawStarts[ multiDrawCount ] = item.start * bytesPerElement;\n\t\t\t\tmultiDrawCounts[ multiDrawCount ] = item.count;\n\t\t\t\tindirectArray[ multiDrawCount ] = item.index;\n\t\t\t\tmultiDrawCount ++;\n\n\t\t\t}\n\n\t\t\t_renderList.reset();\n\n\t\t} else {\n\n\t\t\tfor ( let i = 0, l = instanceInfo.length; i < l; i ++ ) {\n\n\t\t\t\tif ( instanceInfo[ i ].visible && instanceInfo[ i ].active ) {\n\n\t\t\t\t\tconst geometryId = instanceInfo[ i ].geometryIndex;\n\n\t\t\t\t\t// determine whether the batched geometry is within the frustum\n\t\t\t\t\tlet culled = false;\n\t\t\t\t\tif ( perObjectFrustumCulled ) {\n\n\t\t\t\t\t\t// get the bounds in world space\n\t\t\t\t\t\tthis.getMatrixAt( i, _matrix$1 );\n\t\t\t\t\t\tthis.getBoundingSphereAt( geometryId, _sphere$2 ).applyMatrix4( _matrix$1 );\n\t\t\t\t\t\tculled = ! _frustum.intersectsSphere( _sphere$2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! culled ) {\n\n\t\t\t\t\t\tconst geometryInfo = geometryInfoList[ geometryId ];\n\t\t\t\t\t\tmultiDrawStarts[ multiDrawCount ] = geometryInfo.start * bytesPerElement;\n\t\t\t\t\t\tmultiDrawCounts[ multiDrawCount ] = geometryInfo.count;\n\t\t\t\t\t\tindirectArray[ multiDrawCount ] = i;\n\t\t\t\t\t\tmultiDrawCount ++;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tindirectTexture.needsUpdate = true;\n\t\tthis._multiDrawCount = multiDrawCount;\n\t\tthis._visibilityChanged = false;\n\n\t}\n\n\tonBeforeShadow( renderer, object, camera, shadowCamera, geometry, depthMaterial/* , group */ ) {\n\n\t\tthis.onBeforeRender( renderer, null, shadowCamera, geometry, depthMaterial );\n\n\t}\n\n}\n\nclass LineBasicMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isLineBasicMaterial = true;\n\n\t\tthis.type = 'LineBasicMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\n\t\tthis.linewidth = 1;\n\t\tthis.linecap = 'round';\n\t\tthis.linejoin = 'round';\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.linewidth = source.linewidth;\n\t\tthis.linecap = source.linecap;\n\t\tthis.linejoin = source.linejoin;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _vStart = /*@__PURE__*/ new Vector3();\nconst _vEnd = /*@__PURE__*/ new Vector3();\n\nconst _inverseMatrix$1 = /*@__PURE__*/ new Matrix4();\nconst _ray$1 = /*@__PURE__*/ new Ray();\nconst _sphere$1 = /*@__PURE__*/ new Sphere();\n\nconst _intersectPointOnRay = /*@__PURE__*/ new Vector3();\nconst _intersectPointOnSegment = /*@__PURE__*/ new Vector3();\n\nclass Line extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new LineBasicMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.isLine = true;\n\n\t\tthis.type = 'Line';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.material = Array.isArray( source.material ) ? source.material.slice() : source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\tcomputeLineDistances() {\n\n\t\tconst geometry = this.geometry;\n\n\t\t// we assume non-indexed geometry\n\n\t\tif ( geometry.index === null ) {\n\n\t\t\tconst positionAttribute = geometry.attributes.position;\n\t\t\tconst lineDistances = [ 0 ];\n\n\t\t\tfor ( let i = 1, l = positionAttribute.count; i < l; i ++ ) {\n\n\t\t\t\t_vStart.fromBufferAttribute( positionAttribute, i - 1 );\n\t\t\t\t_vEnd.fromBufferAttribute( positionAttribute, i );\n\n\t\t\t\tlineDistances[ i ] = lineDistances[ i - 1 ];\n\t\t\t\tlineDistances[ i ] += _vStart.distanceTo( _vEnd );\n\n\t\t\t}\n\n\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst threshold = raycaster.params.Line.threshold;\n\t\tconst drawRange = geometry.drawRange;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere$1.copy( geometry.boundingSphere );\n\t\t_sphere$1.applyMatrix4( matrixWorld );\n\t\t_sphere$1.radius += threshold;\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere$1 ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix$1.copy( matrixWorld ).invert();\n\t\t_ray$1.copy( raycaster.ray ).applyMatrix4( _inverseMatrix$1 );\n\n\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\tconst localThresholdSq = localThreshold * localThreshold;\n\n\t\tconst step = this.isLineSegments ? 2 : 1;\n\n\t\tconst index = geometry.index;\n\t\tconst attributes = geometry.attributes;\n\t\tconst positionAttribute = attributes.position;\n\n\t\tif ( index !== null ) {\n\n\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( let i = start, l = end - 1; i < l; i += step ) {\n\n\t\t\t\tconst a = index.getX( i );\n\t\t\t\tconst b = index.getX( i + 1 );\n\n\t\t\t\tconst intersect = checkIntersection( this, raycaster, _ray$1, localThresholdSq, a, b );\n\n\t\t\t\tif ( intersect ) {\n\n\t\t\t\t\tintersects.push( intersect );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.isLineLoop ) {\n\n\t\t\t\tconst a = index.getX( end - 1 );\n\t\t\t\tconst b = index.getX( start );\n\n\t\t\t\tconst intersect = checkIntersection( this, raycaster, _ray$1, localThresholdSq, a, b );\n\n\t\t\t\tif ( intersect ) {\n\n\t\t\t\t\tintersects.push( intersect );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\tconst end = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( let i = start, l = end - 1; i < l; i += step ) {\n\n\t\t\t\tconst intersect = checkIntersection( this, raycaster, _ray$1, localThresholdSq, i, i + 1 );\n\n\t\t\t\tif ( intersect ) {\n\n\t\t\t\t\tintersects.push( intersect );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.isLineLoop ) {\n\n\t\t\t\tconst intersect = checkIntersection( this, raycaster, _ray$1, localThresholdSq, end - 1, start );\n\n\t\t\t\tif ( intersect ) {\n\n\t\t\t\t\tintersects.push( intersect );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tconst morphAttributes = geometry.morphAttributes;\n\t\tconst keys = Object.keys( morphAttributes );\n\n\t\tif ( keys.length > 0 ) {\n\n\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nfunction checkIntersection( object, raycaster, ray, thresholdSq, a, b ) {\n\n\tconst positionAttribute = object.geometry.attributes.position;\n\n\t_vStart.fromBufferAttribute( positionAttribute, a );\n\t_vEnd.fromBufferAttribute( positionAttribute, b );\n\n\tconst distSq = ray.distanceSqToSegment( _vStart, _vEnd, _intersectPointOnRay, _intersectPointOnSegment );\n\n\tif ( distSq > thresholdSq ) return;\n\n\t_intersectPointOnRay.applyMatrix4( object.matrixWorld ); // Move back to world space for distance calculation\n\n\tconst distance = raycaster.ray.origin.distanceTo( _intersectPointOnRay );\n\n\tif ( distance < raycaster.near || distance > raycaster.far ) return;\n\n\treturn {\n\n\t\tdistance: distance,\n\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t// point: raycaster.ray.at( distance ),\n\t\tpoint: _intersectPointOnSegment.clone().applyMatrix4( object.matrixWorld ),\n\t\tindex: a,\n\t\tface: null,\n\t\tfaceIndex: null,\n\t\tbarycoord: null,\n\t\tobject: object\n\n\t};\n\n}\n\nconst _start = /*@__PURE__*/ new Vector3();\nconst _end = /*@__PURE__*/ new Vector3();\n\nclass LineSegments extends Line {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.isLineSegments = true;\n\n\t\tthis.type = 'LineSegments';\n\n\t}\n\n\tcomputeLineDistances() {\n\n\t\tconst geometry = this.geometry;\n\n\t\t// we assume non-indexed geometry\n\n\t\tif ( geometry.index === null ) {\n\n\t\t\tconst positionAttribute = geometry.attributes.position;\n\t\t\tconst lineDistances = [];\n\n\t\t\tfor ( let i = 0, l = positionAttribute.count; i < l; i += 2 ) {\n\n\t\t\t\t_start.fromBufferAttribute( positionAttribute, i );\n\t\t\t\t_end.fromBufferAttribute( positionAttribute, i + 1 );\n\n\t\t\t\tlineDistances[ i ] = ( i === 0 ) ? 0 : lineDistances[ i - 1 ];\n\t\t\t\tlineDistances[ i + 1 ] = lineDistances[ i ] + _start.distanceTo( _end );\n\n\t\t\t}\n\n\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass LineLoop extends Line {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.isLineLoop = true;\n\n\t\tthis.type = 'LineLoop';\n\n\t}\n\n}\n\nclass PointsMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isPointsMaterial = true;\n\n\t\tthis.type = 'PointsMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.size = 1;\n\t\tthis.sizeAttenuation = true;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.size = source.size;\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _inverseMatrix = /*@__PURE__*/ new Matrix4();\nconst _ray = /*@__PURE__*/ new Ray();\nconst _sphere = /*@__PURE__*/ new Sphere();\nconst _position$2 = /*@__PURE__*/ new Vector3();\n\nclass Points extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new PointsMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.isPoints = true;\n\n\t\tthis.type = 'Points';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.material = Array.isArray( source.material ) ? source.material.slice() : source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst threshold = raycaster.params.Points.threshold;\n\t\tconst drawRange = geometry.drawRange;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere.copy( geometry.boundingSphere );\n\t\t_sphere.applyMatrix4( matrixWorld );\n\t\t_sphere.radius += threshold;\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix.copy( matrixWorld ).invert();\n\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\n\n\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\tconst localThresholdSq = localThreshold * localThreshold;\n\n\t\tconst index = geometry.index;\n\t\tconst attributes = geometry.attributes;\n\t\tconst positionAttribute = attributes.position;\n\n\t\tif ( index !== null ) {\n\n\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( let i = start, il = end; i < il; i ++ ) {\n\n\t\t\t\tconst a = index.getX( i );\n\n\t\t\t\t_position$2.fromBufferAttribute( positionAttribute, a );\n\n\t\t\t\ttestPoint( _position$2, a, localThresholdSq, matrixWorld, raycaster, intersects, this );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\tconst end = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( let i = start, l = end; i < l; i ++ ) {\n\n\t\t\t\t_position$2.fromBufferAttribute( positionAttribute, i );\n\n\t\t\t\ttestPoint( _position$2, i, localThresholdSq, matrixWorld, raycaster, intersects, this );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tconst morphAttributes = geometry.morphAttributes;\n\t\tconst keys = Object.keys( morphAttributes );\n\n\t\tif ( keys.length > 0 ) {\n\n\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nfunction testPoint( point, index, localThresholdSq, matrixWorld, raycaster, intersects, object ) {\n\n\tconst rayPointDistanceSq = _ray.distanceSqToPoint( point );\n\n\tif ( rayPointDistanceSq < localThresholdSq ) {\n\n\t\tconst intersectPoint = new Vector3();\n\n\t\t_ray.closestPointToPoint( point, intersectPoint );\n\t\tintersectPoint.applyMatrix4( matrixWorld );\n\n\t\tconst distance = raycaster.ray.origin.distanceTo( intersectPoint );\n\n\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\n\n\t\tintersects.push( {\n\n\t\t\tdistance: distance,\n\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\n\t\t\tpoint: intersectPoint,\n\t\t\tindex: index,\n\t\t\tface: null,\n\t\t\tfaceIndex: null,\n\t\t\tbarycoord: null,\n\t\t\tobject: object\n\n\t\t} );\n\n\t}\n\n}\n\nclass Group extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isGroup = true;\n\n\t\tthis.type = 'Group';\n\n\t}\n\n}\n\nclass VideoTexture extends Texture {\n\n\tconstructor( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\n\n\t\tsuper( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\t\tthis.isVideoTexture = true;\n\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : LinearFilter;\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : LinearFilter;\n\n\t\tthis.generateMipmaps = false;\n\n\t\tconst scope = this;\n\n\t\tfunction updateVideo() {\n\n\t\t\tscope.needsUpdate = true;\n\t\t\tvideo.requestVideoFrameCallback( updateVideo );\n\n\t\t}\n\n\t\tif ( 'requestVideoFrameCallback' in video ) {\n\n\t\t\tvideo.requestVideoFrameCallback( updateVideo );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.image ).copy( this );\n\n\t}\n\n\tupdate() {\n\n\t\tconst video = this.image;\n\t\tconst hasVideoFrameCallback = 'requestVideoFrameCallback' in video;\n\n\t\tif ( hasVideoFrameCallback === false && video.readyState >= video.HAVE_CURRENT_DATA ) {\n\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n}\n\nclass FramebufferTexture extends Texture {\n\n\tconstructor( width, height ) {\n\n\t\tsuper( { width, height } );\n\n\t\tthis.isFramebufferTexture = true;\n\n\t\tthis.magFilter = NearestFilter;\n\t\tthis.minFilter = NearestFilter;\n\n\t\tthis.generateMipmaps = false;\n\n\t\tthis.needsUpdate = true;\n\n\t}\n\n}\n\nclass CompressedTexture extends Texture {\n\n\tconstructor( mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, colorSpace ) {\n\n\t\tsuper( null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, colorSpace );\n\n\t\tthis.isCompressedTexture = true;\n\n\t\tthis.image = { width: width, height: height };\n\t\tthis.mipmaps = mipmaps;\n\n\t\t// no flipping for cube textures\n\t\t// (also flipping doesn't work for compressed textures )\n\n\t\tthis.flipY = false;\n\n\t\t// can't generate mipmaps for compressed textures\n\t\t// mips must be embedded in DDS files\n\n\t\tthis.generateMipmaps = false;\n\n\t}\n\n}\n\nclass CompressedArrayTexture extends CompressedTexture {\n\n\tconstructor( mipmaps, width, height, depth, format, type ) {\n\n\t\tsuper( mipmaps, width, height, format, type );\n\n\t\tthis.isCompressedArrayTexture = true;\n\t\tthis.image.depth = depth;\n\t\tthis.wrapR = ClampToEdgeWrapping;\n\n\t\tthis.layerUpdates = new Set();\n\n\t}\n\n\taddLayerUpdate( layerIndex ) {\n\n\t\tthis.layerUpdates.add( layerIndex );\n\n\t}\n\n\tclearLayerUpdates() {\n\n\t\tthis.layerUpdates.clear();\n\n\t}\n\n}\n\nclass CompressedCubeTexture extends CompressedTexture {\n\n\tconstructor( images, format, type ) {\n\n\t\tsuper( undefined, images[ 0 ].width, images[ 0 ].height, format, type, CubeReflectionMapping );\n\n\t\tthis.isCompressedCubeTexture = true;\n\t\tthis.isCubeTexture = true;\n\n\t\tthis.image = images;\n\n\t}\n\n}\n\nclass CanvasTexture extends Texture {\n\n\tconstructor( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\n\n\t\tsuper( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\t\tthis.isCanvasTexture = true;\n\n\t\tthis.needsUpdate = true;\n\n\t}\n\n}\n\nclass DepthTexture extends Texture {\n\n\tconstructor( width, height, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, format = DepthFormat ) {\n\n\t\tif ( format !== DepthFormat && format !== DepthStencilFormat ) {\n\n\t\t\tthrow new Error( 'DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat' );\n\n\t\t}\n\n\t\tif ( type === undefined && format === DepthFormat ) type = UnsignedIntType;\n\t\tif ( type === undefined && format === DepthStencilFormat ) type = UnsignedInt248Type;\n\n\t\tsuper( null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\t\tthis.isDepthTexture = true;\n\n\t\tthis.image = { width: width, height: height };\n\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : NearestFilter;\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : NearestFilter;\n\n\t\tthis.flipY = false;\n\t\tthis.generateMipmaps = false;\n\n\t\tthis.compareFunction = null;\n\n\t}\n\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.compareFunction = source.compareFunction;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tif ( this.compareFunction !== null ) data.compareFunction = this.compareFunction;\n\n\t\treturn data;\n\n\t}\n\n}\n\n/**\n * Extensible curve object.\n *\n * Some common of curve methods:\n * .getPoint( t, optionalTarget ), .getTangent( t, optionalTarget )\n * .getPointAt( u, optionalTarget ), .getTangentAt( u, optionalTarget )\n * .getPoints(), .getSpacedPoints()\n * .getLength()\n * .updateArcLengths()\n *\n * This following curves inherit from THREE.Curve:\n *\n * -- 2D curves --\n * THREE.ArcCurve\n * THREE.CubicBezierCurve\n * THREE.EllipseCurve\n * THREE.LineCurve\n * THREE.QuadraticBezierCurve\n * THREE.SplineCurve\n *\n * -- 3D curves --\n * THREE.CatmullRomCurve3\n * THREE.CubicBezierCurve3\n * THREE.LineCurve3\n * THREE.QuadraticBezierCurve3\n *\n * A series of curves can be represented as a THREE.CurvePath.\n *\n **/\n\nclass Curve {\n\n\tconstructor() {\n\n\t\tthis.type = 'Curve';\n\n\t\tthis.arcLengthDivisions = 200;\n\n\t}\n\n\t// Virtual base class method to overwrite and implement in subclasses\n\t//\t- t [0 .. 1]\n\n\tgetPoint( /* t, optionalTarget */ ) {\n\n\t\tconsole.warn( 'THREE.Curve: .getPoint() not implemented.' );\n\t\treturn null;\n\n\t}\n\n\t// Get point at relative position in curve according to arc length\n\t// - u [0 .. 1]\n\n\tgetPointAt( u, optionalTarget ) {\n\n\t\tconst t = this.getUtoTmapping( u );\n\t\treturn this.getPoint( t, optionalTarget );\n\n\t}\n\n\t// Get sequence of points using getPoint( t )\n\n\tgetPoints( divisions = 5 ) {\n\n\t\tconst points = [];\n\n\t\tfor ( let d = 0; d <= divisions; d ++ ) {\n\n\t\t\tpoints.push( this.getPoint( d / divisions ) );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\t// Get sequence of points using getPointAt( u )\n\n\tgetSpacedPoints( divisions = 5 ) {\n\n\t\tconst points = [];\n\n\t\tfor ( let d = 0; d <= divisions; d ++ ) {\n\n\t\t\tpoints.push( this.getPointAt( d / divisions ) );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\t// Get total curve arc length\n\n\tgetLength() {\n\n\t\tconst lengths = this.getLengths();\n\t\treturn lengths[ lengths.length - 1 ];\n\n\t}\n\n\t// Get list of cumulative segment lengths\n\n\tgetLengths( divisions = this.arcLengthDivisions ) {\n\n\t\tif ( this.cacheArcLengths &&\n\t\t\t( this.cacheArcLengths.length === divisions + 1 ) &&\n\t\t\t! this.needsUpdate ) {\n\n\t\t\treturn this.cacheArcLengths;\n\n\t\t}\n\n\t\tthis.needsUpdate = false;\n\n\t\tconst cache = [];\n\t\tlet current, last = this.getPoint( 0 );\n\t\tlet sum = 0;\n\n\t\tcache.push( 0 );\n\n\t\tfor ( let p = 1; p <= divisions; p ++ ) {\n\n\t\t\tcurrent = this.getPoint( p / divisions );\n\t\t\tsum += current.distanceTo( last );\n\t\t\tcache.push( sum );\n\t\t\tlast = current;\n\n\t\t}\n\n\t\tthis.cacheArcLengths = cache;\n\n\t\treturn cache; // { sums: cache, sum: sum }; Sum is in the last element.\n\n\t}\n\n\tupdateArcLengths() {\n\n\t\tthis.needsUpdate = true;\n\t\tthis.getLengths();\n\n\t}\n\n\t// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equidistant\n\n\tgetUtoTmapping( u, distance ) {\n\n\t\tconst arcLengths = this.getLengths();\n\n\t\tlet i = 0;\n\t\tconst il = arcLengths.length;\n\n\t\tlet targetArcLength; // The targeted u distance value to get\n\n\t\tif ( distance ) {\n\n\t\t\ttargetArcLength = distance;\n\n\t\t} else {\n\n\t\t\ttargetArcLength = u * arcLengths[ il - 1 ];\n\n\t\t}\n\n\t\t// binary search for the index with largest value smaller than target u distance\n\n\t\tlet low = 0, high = il - 1, comparison;\n\n\t\twhile ( low <= high ) {\n\n\t\t\ti = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\n\n\t\t\tcomparison = arcLengths[ i ] - targetArcLength;\n\n\t\t\tif ( comparison < 0 ) {\n\n\t\t\t\tlow = i + 1;\n\n\t\t\t} else if ( comparison > 0 ) {\n\n\t\t\t\thigh = i - 1;\n\n\t\t\t} else {\n\n\t\t\t\thigh = i;\n\t\t\t\tbreak;\n\n\t\t\t\t// DONE\n\n\t\t\t}\n\n\t\t}\n\n\t\ti = high;\n\n\t\tif ( arcLengths[ i ] === targetArcLength ) {\n\n\t\t\treturn i / ( il - 1 );\n\n\t\t}\n\n\t\t// we could get finer grain at lengths, or use simple interpolation between two points\n\n\t\tconst lengthBefore = arcLengths[ i ];\n\t\tconst lengthAfter = arcLengths[ i + 1 ];\n\n\t\tconst segmentLength = lengthAfter - lengthBefore;\n\n\t\t// determine where we are between the 'before' and 'after' points\n\n\t\tconst segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\n\n\t\t// add that fractional amount to t\n\n\t\tconst t = ( i + segmentFraction ) / ( il - 1 );\n\n\t\treturn t;\n\n\t}\n\n\t// Returns a unit vector tangent at t\n\t// In case any sub curve does not implement its tangent derivation,\n\t// 2 points a small delta apart will be used to find its gradient\n\t// which seems to give a reasonable approximation\n\n\tgetTangent( t, optionalTarget ) {\n\n\t\tconst delta = 0.0001;\n\t\tlet t1 = t - delta;\n\t\tlet t2 = t + delta;\n\n\t\t// Capping in case of danger\n\n\t\tif ( t1 < 0 ) t1 = 0;\n\t\tif ( t2 > 1 ) t2 = 1;\n\n\t\tconst pt1 = this.getPoint( t1 );\n\t\tconst pt2 = this.getPoint( t2 );\n\n\t\tconst tangent = optionalTarget || ( ( pt1.isVector2 ) ? new Vector2() : new Vector3() );\n\n\t\ttangent.copy( pt2 ).sub( pt1 ).normalize();\n\n\t\treturn tangent;\n\n\t}\n\n\tgetTangentAt( u, optionalTarget ) {\n\n\t\tconst t = this.getUtoTmapping( u );\n\t\treturn this.getTangent( t, optionalTarget );\n\n\t}\n\n\tcomputeFrenetFrames( segments, closed ) {\n\n\t\t// see http://www.cs.indiana.edu/pub/techreports/TR425.pdf\n\n\t\tconst normal = new Vector3();\n\n\t\tconst tangents = [];\n\t\tconst normals = [];\n\t\tconst binormals = [];\n\n\t\tconst vec = new Vector3();\n\t\tconst mat = new Matrix4();\n\n\t\t// compute the tangent vectors for each segment on the curve\n\n\t\tfor ( let i = 0; i <= segments; i ++ ) {\n\n\t\t\tconst u = i / segments;\n\n\t\t\ttangents[ i ] = this.getTangentAt( u, new Vector3() );\n\n\t\t}\n\n\t\t// select an initial normal vector perpendicular to the first tangent vector,\n\t\t// and in the direction of the minimum tangent xyz component\n\n\t\tnormals[ 0 ] = new Vector3();\n\t\tbinormals[ 0 ] = new Vector3();\n\t\tlet min = Number.MAX_VALUE;\n\t\tconst tx = Math.abs( tangents[ 0 ].x );\n\t\tconst ty = Math.abs( tangents[ 0 ].y );\n\t\tconst tz = Math.abs( tangents[ 0 ].z );\n\n\t\tif ( tx <= min ) {\n\n\t\t\tmin = tx;\n\t\t\tnormal.set( 1, 0, 0 );\n\n\t\t}\n\n\t\tif ( ty <= min ) {\n\n\t\t\tmin = ty;\n\t\t\tnormal.set( 0, 1, 0 );\n\n\t\t}\n\n\t\tif ( tz <= min ) {\n\n\t\t\tnormal.set( 0, 0, 1 );\n\n\t\t}\n\n\t\tvec.crossVectors( tangents[ 0 ], normal ).normalize();\n\n\t\tnormals[ 0 ].crossVectors( tangents[ 0 ], vec );\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] );\n\n\n\t\t// compute the slowly-varying normal and binormal vectors for each segment on the curve\n\n\t\tfor ( let i = 1; i <= segments; i ++ ) {\n\n\t\t\tnormals[ i ] = normals[ i - 1 ].clone();\n\n\t\t\tbinormals[ i ] = binormals[ i - 1 ].clone();\n\n\t\t\tvec.crossVectors( tangents[ i - 1 ], tangents[ i ] );\n\n\t\t\tif ( vec.length() > Number.EPSILON ) {\n\n\t\t\t\tvec.normalize();\n\n\t\t\t\tconst theta = Math.acos( clamp( tangents[ i - 1 ].dot( tangents[ i ] ), - 1, 1 ) ); // clamp for floating pt errors\n\n\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( vec, theta ) );\n\n\t\t\t}\n\n\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\n\n\t\t}\n\n\t\t// if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\n\n\t\tif ( closed === true ) {\n\n\t\t\tlet theta = Math.acos( clamp( normals[ 0 ].dot( normals[ segments ] ), - 1, 1 ) );\n\t\t\ttheta /= segments;\n\n\t\t\tif ( tangents[ 0 ].dot( vec.crossVectors( normals[ 0 ], normals[ segments ] ) ) > 0 ) {\n\n\t\t\t\ttheta = - theta;\n\n\t\t\t}\n\n\t\t\tfor ( let i = 1; i <= segments; i ++ ) {\n\n\t\t\t\t// twist a little...\n\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( tangents[ i ], theta * i ) );\n\t\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\ttangents: tangents,\n\t\t\tnormals: normals,\n\t\t\tbinormals: binormals\n\t\t};\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.arcLengthDivisions = source.arcLengthDivisions;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.6,\n\t\t\t\ttype: 'Curve',\n\t\t\t\tgenerator: 'Curve.toJSON'\n\t\t\t}\n\t\t};\n\n\t\tdata.arcLengthDivisions = this.arcLengthDivisions;\n\t\tdata.type = this.type;\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tthis.arcLengthDivisions = json.arcLengthDivisions;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass EllipseCurve extends Curve {\n\n\tconstructor( aX = 0, aY = 0, xRadius = 1, yRadius = 1, aStartAngle = 0, aEndAngle = Math.PI * 2, aClockwise = false, aRotation = 0 ) {\n\n\t\tsuper();\n\n\t\tthis.isEllipseCurve = true;\n\n\t\tthis.type = 'EllipseCurve';\n\n\t\tthis.aX = aX;\n\t\tthis.aY = aY;\n\n\t\tthis.xRadius = xRadius;\n\t\tthis.yRadius = yRadius;\n\n\t\tthis.aStartAngle = aStartAngle;\n\t\tthis.aEndAngle = aEndAngle;\n\n\t\tthis.aClockwise = aClockwise;\n\n\t\tthis.aRotation = aRotation;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst twoPi = Math.PI * 2;\n\t\tlet deltaAngle = this.aEndAngle - this.aStartAngle;\n\t\tconst samePoints = Math.abs( deltaAngle ) < Number.EPSILON;\n\n\t\t// ensures that deltaAngle is 0 .. 2 PI\n\t\twhile ( deltaAngle < 0 ) deltaAngle += twoPi;\n\t\twhile ( deltaAngle > twoPi ) deltaAngle -= twoPi;\n\n\t\tif ( deltaAngle < Number.EPSILON ) {\n\n\t\t\tif ( samePoints ) {\n\n\t\t\t\tdeltaAngle = 0;\n\n\t\t\t} else {\n\n\t\t\t\tdeltaAngle = twoPi;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.aClockwise === true && ! samePoints ) {\n\n\t\t\tif ( deltaAngle === twoPi ) {\n\n\t\t\t\tdeltaAngle = - twoPi;\n\n\t\t\t} else {\n\n\t\t\t\tdeltaAngle = deltaAngle - twoPi;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst angle = this.aStartAngle + t * deltaAngle;\n\t\tlet x = this.aX + this.xRadius * Math.cos( angle );\n\t\tlet y = this.aY + this.yRadius * Math.sin( angle );\n\n\t\tif ( this.aRotation !== 0 ) {\n\n\t\t\tconst cos = Math.cos( this.aRotation );\n\t\t\tconst sin = Math.sin( this.aRotation );\n\n\t\t\tconst tx = x - this.aX;\n\t\t\tconst ty = y - this.aY;\n\n\t\t\t// Rotate the point about the center of the ellipse.\n\t\t\tx = tx * cos - ty * sin + this.aX;\n\t\t\ty = tx * sin + ty * cos + this.aY;\n\n\t\t}\n\n\t\treturn point.set( x, y );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.aX = source.aX;\n\t\tthis.aY = source.aY;\n\n\t\tthis.xRadius = source.xRadius;\n\t\tthis.yRadius = source.yRadius;\n\n\t\tthis.aStartAngle = source.aStartAngle;\n\t\tthis.aEndAngle = source.aEndAngle;\n\n\t\tthis.aClockwise = source.aClockwise;\n\n\t\tthis.aRotation = source.aRotation;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.aX = this.aX;\n\t\tdata.aY = this.aY;\n\n\t\tdata.xRadius = this.xRadius;\n\t\tdata.yRadius = this.yRadius;\n\n\t\tdata.aStartAngle = this.aStartAngle;\n\t\tdata.aEndAngle = this.aEndAngle;\n\n\t\tdata.aClockwise = this.aClockwise;\n\n\t\tdata.aRotation = this.aRotation;\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.aX = json.aX;\n\t\tthis.aY = json.aY;\n\n\t\tthis.xRadius = json.xRadius;\n\t\tthis.yRadius = json.yRadius;\n\n\t\tthis.aStartAngle = json.aStartAngle;\n\t\tthis.aEndAngle = json.aEndAngle;\n\n\t\tthis.aClockwise = json.aClockwise;\n\n\t\tthis.aRotation = json.aRotation;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass ArcCurve extends EllipseCurve {\n\n\tconstructor( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tsuper( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\n\n\t\tthis.isArcCurve = true;\n\n\t\tthis.type = 'ArcCurve';\n\n\t}\n\n}\n\n/**\n * Centripetal CatmullRom Curve - which is useful for avoiding\n * cusps and self-intersections in non-uniform catmull rom curves.\n * http://www.cemyuksel.com/research/catmullrom_param/catmullrom.pdf\n *\n * curve.type accepts centripetal(default), chordal and catmullrom\n * curve.tension is used for catmullrom which defaults to 0.5\n */\n\n\n/*\nBased on an optimized c++ solution in\n - http://stackoverflow.com/questions/9489736/catmull-rom-curve-with-no-cusps-and-no-self-intersections/\n - http://ideone.com/NoEbVM\n\nThis CubicPoly class could be used for reusing some variables and calculations,\nbut for three.js curve use, it could be possible inlined and flatten into a single function call\nwhich can be placed in CurveUtils.\n*/\n\nfunction CubicPoly() {\n\n\tlet c0 = 0, c1 = 0, c2 = 0, c3 = 0;\n\n\t/*\n\t * Compute coefficients for a cubic polynomial\n\t *   p(s) = c0 + c1*s + c2*s^2 + c3*s^3\n\t * such that\n\t *   p(0) = x0, p(1) = x1\n\t *  and\n\t *   p'(0) = t0, p'(1) = t1.\n\t */\n\tfunction init( x0, x1, t0, t1 ) {\n\n\t\tc0 = x0;\n\t\tc1 = t0;\n\t\tc2 = - 3 * x0 + 3 * x1 - 2 * t0 - t1;\n\t\tc3 = 2 * x0 - 2 * x1 + t0 + t1;\n\n\t}\n\n\treturn {\n\n\t\tinitCatmullRom: function ( x0, x1, x2, x3, tension ) {\n\n\t\t\tinit( x1, x2, tension * ( x2 - x0 ), tension * ( x3 - x1 ) );\n\n\t\t},\n\n\t\tinitNonuniformCatmullRom: function ( x0, x1, x2, x3, dt0, dt1, dt2 ) {\n\n\t\t\t// compute tangents when parameterized in [t1,t2]\n\t\t\tlet t1 = ( x1 - x0 ) / dt0 - ( x2 - x0 ) / ( dt0 + dt1 ) + ( x2 - x1 ) / dt1;\n\t\t\tlet t2 = ( x2 - x1 ) / dt1 - ( x3 - x1 ) / ( dt1 + dt2 ) + ( x3 - x2 ) / dt2;\n\n\t\t\t// rescale tangents for parametrization in [0,1]\n\t\t\tt1 *= dt1;\n\t\t\tt2 *= dt1;\n\n\t\t\tinit( x1, x2, t1, t2 );\n\n\t\t},\n\n\t\tcalc: function ( t ) {\n\n\t\t\tconst t2 = t * t;\n\t\t\tconst t3 = t2 * t;\n\t\t\treturn c0 + c1 * t + c2 * t2 + c3 * t3;\n\n\t\t}\n\n\t};\n\n}\n\n//\n\nconst tmp = /*@__PURE__*/ new Vector3();\nconst px = /*@__PURE__*/ new CubicPoly();\nconst py = /*@__PURE__*/ new CubicPoly();\nconst pz = /*@__PURE__*/ new CubicPoly();\n\nclass CatmullRomCurve3 extends Curve {\n\n\tconstructor( points = [], closed = false, curveType = 'centripetal', tension = 0.5 ) {\n\n\t\tsuper();\n\n\t\tthis.isCatmullRomCurve3 = true;\n\n\t\tthis.type = 'CatmullRomCurve3';\n\n\t\tthis.points = points;\n\t\tthis.closed = closed;\n\t\tthis.curveType = curveType;\n\t\tthis.tension = tension;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst points = this.points;\n\t\tconst l = points.length;\n\n\t\tconst p = ( l - ( this.closed ? 0 : 1 ) ) * t;\n\t\tlet intPoint = Math.floor( p );\n\t\tlet weight = p - intPoint;\n\n\t\tif ( this.closed ) {\n\n\t\t\tintPoint += intPoint > 0 ? 0 : ( Math.floor( Math.abs( intPoint ) / l ) + 1 ) * l;\n\n\t\t} else if ( weight === 0 && intPoint === l - 1 ) {\n\n\t\t\tintPoint = l - 2;\n\t\t\tweight = 1;\n\n\t\t}\n\n\t\tlet p0, p3; // 4 points (p1 & p2 defined below)\n\n\t\tif ( this.closed || intPoint > 0 ) {\n\n\t\t\tp0 = points[ ( intPoint - 1 ) % l ];\n\n\t\t} else {\n\n\t\t\t// extrapolate first point\n\t\t\ttmp.subVectors( points[ 0 ], points[ 1 ] ).add( points[ 0 ] );\n\t\t\tp0 = tmp;\n\n\t\t}\n\n\t\tconst p1 = points[ intPoint % l ];\n\t\tconst p2 = points[ ( intPoint + 1 ) % l ];\n\n\t\tif ( this.closed || intPoint + 2 < l ) {\n\n\t\t\tp3 = points[ ( intPoint + 2 ) % l ];\n\n\t\t} else {\n\n\t\t\t// extrapolate last point\n\t\t\ttmp.subVectors( points[ l - 1 ], points[ l - 2 ] ).add( points[ l - 1 ] );\n\t\t\tp3 = tmp;\n\n\t\t}\n\n\t\tif ( this.curveType === 'centripetal' || this.curveType === 'chordal' ) {\n\n\t\t\t// init Centripetal / Chordal Catmull-Rom\n\t\t\tconst pow = this.curveType === 'chordal' ? 0.5 : 0.25;\n\t\t\tlet dt0 = Math.pow( p0.distanceToSquared( p1 ), pow );\n\t\t\tlet dt1 = Math.pow( p1.distanceToSquared( p2 ), pow );\n\t\t\tlet dt2 = Math.pow( p2.distanceToSquared( p3 ), pow );\n\n\t\t\t// safety check for repeated points\n\t\t\tif ( dt1 < 1e-4 ) dt1 = 1.0;\n\t\t\tif ( dt0 < 1e-4 ) dt0 = dt1;\n\t\t\tif ( dt2 < 1e-4 ) dt2 = dt1;\n\n\t\t\tpx.initNonuniformCatmullRom( p0.x, p1.x, p2.x, p3.x, dt0, dt1, dt2 );\n\t\t\tpy.initNonuniformCatmullRom( p0.y, p1.y, p2.y, p3.y, dt0, dt1, dt2 );\n\t\t\tpz.initNonuniformCatmullRom( p0.z, p1.z, p2.z, p3.z, dt0, dt1, dt2 );\n\n\t\t} else if ( this.curveType === 'catmullrom' ) {\n\n\t\t\tpx.initCatmullRom( p0.x, p1.x, p2.x, p3.x, this.tension );\n\t\t\tpy.initCatmullRom( p0.y, p1.y, p2.y, p3.y, this.tension );\n\t\t\tpz.initCatmullRom( p0.z, p1.z, p2.z, p3.z, this.tension );\n\n\t\t}\n\n\t\tpoint.set(\n\t\t\tpx.calc( weight ),\n\t\t\tpy.calc( weight ),\n\t\t\tpz.calc( weight )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = source.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = source.points[ i ];\n\n\t\t\tthis.points.push( point.clone() );\n\n\t\t}\n\n\t\tthis.closed = source.closed;\n\t\tthis.curveType = source.curveType;\n\t\tthis.tension = source.tension;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.points = [];\n\n\t\tfor ( let i = 0, l = this.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = this.points[ i ];\n\t\t\tdata.points.push( point.toArray() );\n\n\t\t}\n\n\t\tdata.closed = this.closed;\n\t\tdata.curveType = this.curveType;\n\t\tdata.tension = this.tension;\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = json.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = json.points[ i ];\n\t\t\tthis.points.push( new Vector3().fromArray( point ) );\n\n\t\t}\n\n\t\tthis.closed = json.closed;\n\t\tthis.curveType = json.curveType;\n\t\tthis.tension = json.tension;\n\n\t\treturn this;\n\n\t}\n\n}\n\n/**\n * Bezier Curves formulas obtained from\n * https://en.wikipedia.org/wiki/B%C3%A9zier_curve\n */\n\nfunction CatmullRom( t, p0, p1, p2, p3 ) {\n\n\tconst v0 = ( p2 - p0 ) * 0.5;\n\tconst v1 = ( p3 - p1 ) * 0.5;\n\tconst t2 = t * t;\n\tconst t3 = t * t2;\n\treturn ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\n\n}\n\n//\n\nfunction QuadraticBezierP0( t, p ) {\n\n\tconst k = 1 - t;\n\treturn k * k * p;\n\n}\n\nfunction QuadraticBezierP1( t, p ) {\n\n\treturn 2 * ( 1 - t ) * t * p;\n\n}\n\nfunction QuadraticBezierP2( t, p ) {\n\n\treturn t * t * p;\n\n}\n\nfunction QuadraticBezier( t, p0, p1, p2 ) {\n\n\treturn QuadraticBezierP0( t, p0 ) + QuadraticBezierP1( t, p1 ) +\n\t\tQuadraticBezierP2( t, p2 );\n\n}\n\n//\n\nfunction CubicBezierP0( t, p ) {\n\n\tconst k = 1 - t;\n\treturn k * k * k * p;\n\n}\n\nfunction CubicBezierP1( t, p ) {\n\n\tconst k = 1 - t;\n\treturn 3 * k * k * t * p;\n\n}\n\nfunction CubicBezierP2( t, p ) {\n\n\treturn 3 * ( 1 - t ) * t * t * p;\n\n}\n\nfunction CubicBezierP3( t, p ) {\n\n\treturn t * t * t * p;\n\n}\n\nfunction CubicBezier( t, p0, p1, p2, p3 ) {\n\n\treturn CubicBezierP0( t, p0 ) + CubicBezierP1( t, p1 ) + CubicBezierP2( t, p2 ) +\n\t\tCubicBezierP3( t, p3 );\n\n}\n\nclass CubicBezierCurve extends Curve {\n\n\tconstructor( v0 = new Vector2(), v1 = new Vector2(), v2 = new Vector2(), v3 = new Vector2() ) {\n\n\t\tsuper();\n\n\t\tthis.isCubicBezierCurve = true;\n\n\t\tthis.type = 'CubicBezierCurve';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\t\tthis.v3 = v3;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\n\n\t\tpoint.set(\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\t\tthis.v3.copy( source.v3 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\t\tdata.v3 = this.v3.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\t\tthis.v3.fromArray( json.v3 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass CubicBezierCurve3 extends Curve {\n\n\tconstructor( v0 = new Vector3(), v1 = new Vector3(), v2 = new Vector3(), v3 = new Vector3() ) {\n\n\t\tsuper();\n\n\t\tthis.isCubicBezierCurve3 = true;\n\n\t\tthis.type = 'CubicBezierCurve3';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\t\tthis.v3 = v3;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\n\n\t\tpoint.set(\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y ),\n\t\t\tCubicBezier( t, v0.z, v1.z, v2.z, v3.z )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\t\tthis.v3.copy( source.v3 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\t\tdata.v3 = this.v3.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\t\tthis.v3.fromArray( json.v3 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass LineCurve extends Curve {\n\n\tconstructor( v1 = new Vector2(), v2 = new Vector2() ) {\n\n\t\tsuper();\n\n\t\tthis.isLineCurve = true;\n\n\t\tthis.type = 'LineCurve';\n\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tif ( t === 1 ) {\n\n\t\t\tpoint.copy( this.v2 );\n\n\t\t} else {\n\n\t\t\tpoint.copy( this.v2 ).sub( this.v1 );\n\t\t\tpoint.multiplyScalar( t ).add( this.v1 );\n\n\t\t}\n\n\t\treturn point;\n\n\t}\n\n\t// Line curve is linear, so we can overwrite default getPointAt\n\tgetPointAt( u, optionalTarget ) {\n\n\t\treturn this.getPoint( u, optionalTarget );\n\n\t}\n\n\tgetTangent( t, optionalTarget = new Vector2() ) {\n\n\t\treturn optionalTarget.subVectors( this.v2, this.v1 ).normalize();\n\n\t}\n\n\tgetTangentAt( u, optionalTarget ) {\n\n\t\treturn this.getTangent( u, optionalTarget );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass LineCurve3 extends Curve {\n\n\tconstructor( v1 = new Vector3(), v2 = new Vector3() ) {\n\n\t\tsuper();\n\n\t\tthis.isLineCurve3 = true;\n\n\t\tthis.type = 'LineCurve3';\n\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tif ( t === 1 ) {\n\n\t\t\tpoint.copy( this.v2 );\n\n\t\t} else {\n\n\t\t\tpoint.copy( this.v2 ).sub( this.v1 );\n\t\t\tpoint.multiplyScalar( t ).add( this.v1 );\n\n\t\t}\n\n\t\treturn point;\n\n\t}\n\n\t// Line curve is linear, so we can overwrite default getPointAt\n\tgetPointAt( u, optionalTarget ) {\n\n\t\treturn this.getPoint( u, optionalTarget );\n\n\t}\n\n\tgetTangent( t, optionalTarget = new Vector3() ) {\n\n\t\treturn optionalTarget.subVectors( this.v2, this.v1 ).normalize();\n\n\t}\n\n\tgetTangentAt( u, optionalTarget ) {\n\n\t\treturn this.getTangent( u, optionalTarget );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass QuadraticBezierCurve extends Curve {\n\n\tconstructor( v0 = new Vector2(), v1 = new Vector2(), v2 = new Vector2() ) {\n\n\t\tsuper();\n\n\t\tthis.isQuadraticBezierCurve = true;\n\n\t\tthis.type = 'QuadraticBezierCurve';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2;\n\n\t\tpoint.set(\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass QuadraticBezierCurve3 extends Curve {\n\n\tconstructor( v0 = new Vector3(), v1 = new Vector3(), v2 = new Vector3() ) {\n\n\t\tsuper();\n\n\t\tthis.isQuadraticBezierCurve3 = true;\n\n\t\tthis.type = 'QuadraticBezierCurve3';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2;\n\n\t\tpoint.set(\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y ),\n\t\t\tQuadraticBezier( t, v0.z, v1.z, v2.z )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass SplineCurve extends Curve {\n\n\tconstructor( points = [] ) {\n\n\t\tsuper();\n\n\t\tthis.isSplineCurve = true;\n\n\t\tthis.type = 'SplineCurve';\n\n\t\tthis.points = points;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst points = this.points;\n\t\tconst p = ( points.length - 1 ) * t;\n\n\t\tconst intPoint = Math.floor( p );\n\t\tconst weight = p - intPoint;\n\n\t\tconst p0 = points[ intPoint === 0 ? intPoint : intPoint - 1 ];\n\t\tconst p1 = points[ intPoint ];\n\t\tconst p2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\n\t\tconst p3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\n\n\t\tpoint.set(\n\t\t\tCatmullRom( weight, p0.x, p1.x, p2.x, p3.x ),\n\t\t\tCatmullRom( weight, p0.y, p1.y, p2.y, p3.y )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = source.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = source.points[ i ];\n\n\t\t\tthis.points.push( point.clone() );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.points = [];\n\n\t\tfor ( let i = 0, l = this.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = this.points[ i ];\n\t\t\tdata.points.push( point.toArray() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = json.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = json.points[ i ];\n\t\t\tthis.points.push( new Vector2().fromArray( point ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nvar Curves = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tArcCurve: ArcCurve,\n\tCatmullRomCurve3: CatmullRomCurve3,\n\tCubicBezierCurve: CubicBezierCurve,\n\tCubicBezierCurve3: CubicBezierCurve3,\n\tEllipseCurve: EllipseCurve,\n\tLineCurve: LineCurve,\n\tLineCurve3: LineCurve3,\n\tQuadraticBezierCurve: QuadraticBezierCurve,\n\tQuadraticBezierCurve3: QuadraticBezierCurve3,\n\tSplineCurve: SplineCurve\n});\n\n/**************************************************************\n *\tCurved Path - a curve path is simply a array of connected\n *  curves, but retains the api of a curve\n **************************************************************/\n\nclass CurvePath extends Curve {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'CurvePath';\n\n\t\tthis.curves = [];\n\t\tthis.autoClose = false; // Automatically closes the path\n\n\t}\n\n\tadd( curve ) {\n\n\t\tthis.curves.push( curve );\n\n\t}\n\n\tclosePath() {\n\n\t\t// Add a line curve if start and end of lines are not connected\n\t\tconst startPoint = this.curves[ 0 ].getPoint( 0 );\n\t\tconst endPoint = this.curves[ this.curves.length - 1 ].getPoint( 1 );\n\n\t\tif ( ! startPoint.equals( endPoint ) ) {\n\n\t\t\tconst lineType = ( startPoint.isVector2 === true ) ? 'LineCurve' : 'LineCurve3';\n\t\t\tthis.curves.push( new Curves[ lineType ]( endPoint, startPoint ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// To get accurate point with reference to\n\t// entire path distance at time t,\n\t// following has to be done:\n\n\t// 1. Length of each sub path have to be known\n\t// 2. Locate and identify type of curve\n\t// 3. Get t for the curve\n\t// 4. Return curve.getPointAt(t')\n\n\tgetPoint( t, optionalTarget ) {\n\n\t\tconst d = t * this.getLength();\n\t\tconst curveLengths = this.getCurveLengths();\n\t\tlet i = 0;\n\n\t\t// To think about boundaries points.\n\n\t\twhile ( i < curveLengths.length ) {\n\n\t\t\tif ( curveLengths[ i ] >= d ) {\n\n\t\t\t\tconst diff = curveLengths[ i ] - d;\n\t\t\t\tconst curve = this.curves[ i ];\n\n\t\t\t\tconst segmentLength = curve.getLength();\n\t\t\t\tconst u = segmentLength === 0 ? 0 : 1 - diff / segmentLength;\n\n\t\t\t\treturn curve.getPointAt( u, optionalTarget );\n\n\t\t\t}\n\n\t\t\ti ++;\n\n\t\t}\n\n\t\treturn null;\n\n\t\t// loop where sum != 0, sum > d , sum+1 <d\n\n\t}\n\n\t// We cannot use the default THREE.Curve getPoint() with getLength() because in\n\t// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\n\t// getPoint() depends on getLength\n\n\tgetLength() {\n\n\t\tconst lens = this.getCurveLengths();\n\t\treturn lens[ lens.length - 1 ];\n\n\t}\n\n\t// cacheLengths must be recalculated.\n\tupdateArcLengths() {\n\n\t\tthis.needsUpdate = true;\n\t\tthis.cacheLengths = null;\n\t\tthis.getCurveLengths();\n\n\t}\n\n\t// Compute lengths and cache them\n\t// We cannot overwrite getLengths() because UtoT mapping uses it.\n\n\tgetCurveLengths() {\n\n\t\t// We use cache values if curves and cache array are same length\n\n\t\tif ( this.cacheLengths && this.cacheLengths.length === this.curves.length ) {\n\n\t\t\treturn this.cacheLengths;\n\n\t\t}\n\n\t\t// Get length of sub-curve\n\t\t// Push sums into cached array\n\n\t\tconst lengths = [];\n\t\tlet sums = 0;\n\n\t\tfor ( let i = 0, l = this.curves.length; i < l; i ++ ) {\n\n\t\t\tsums += this.curves[ i ].getLength();\n\t\t\tlengths.push( sums );\n\n\t\t}\n\n\t\tthis.cacheLengths = lengths;\n\n\t\treturn lengths;\n\n\t}\n\n\tgetSpacedPoints( divisions = 40 ) {\n\n\t\tconst points = [];\n\n\t\tfor ( let i = 0; i <= divisions; i ++ ) {\n\n\t\t\tpoints.push( this.getPoint( i / divisions ) );\n\n\t\t}\n\n\t\tif ( this.autoClose ) {\n\n\t\t\tpoints.push( points[ 0 ] );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\tgetPoints( divisions = 12 ) {\n\n\t\tconst points = [];\n\t\tlet last;\n\n\t\tfor ( let i = 0, curves = this.curves; i < curves.length; i ++ ) {\n\n\t\t\tconst curve = curves[ i ];\n\t\t\tconst resolution = curve.isEllipseCurve ? divisions * 2\n\t\t\t\t: ( curve.isLineCurve || curve.isLineCurve3 ) ? 1\n\t\t\t\t\t: curve.isSplineCurve ? divisions * curve.points.length\n\t\t\t\t\t\t: divisions;\n\n\t\t\tconst pts = curve.getPoints( resolution );\n\n\t\t\tfor ( let j = 0; j < pts.length; j ++ ) {\n\n\t\t\t\tconst point = pts[ j ];\n\n\t\t\t\tif ( last && last.equals( point ) ) continue; // ensures no consecutive points are duplicates\n\n\t\t\t\tpoints.push( point );\n\t\t\t\tlast = point;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.autoClose && points.length > 1 && ! points[ points.length - 1 ].equals( points[ 0 ] ) ) {\n\n\t\t\tpoints.push( points[ 0 ] );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.curves = [];\n\n\t\tfor ( let i = 0, l = source.curves.length; i < l; i ++ ) {\n\n\t\t\tconst curve = source.curves[ i ];\n\n\t\t\tthis.curves.push( curve.clone() );\n\n\t\t}\n\n\t\tthis.autoClose = source.autoClose;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.autoClose = this.autoClose;\n\t\tdata.curves = [];\n\n\t\tfor ( let i = 0, l = this.curves.length; i < l; i ++ ) {\n\n\t\t\tconst curve = this.curves[ i ];\n\t\t\tdata.curves.push( curve.toJSON() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.autoClose = json.autoClose;\n\t\tthis.curves = [];\n\n\t\tfor ( let i = 0, l = json.curves.length; i < l; i ++ ) {\n\n\t\t\tconst curve = json.curves[ i ];\n\t\t\tthis.curves.push( new Curves[ curve.type ]().fromJSON( curve ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass Path extends CurvePath {\n\n\tconstructor( points ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Path';\n\n\t\tthis.currentPoint = new Vector2();\n\n\t\tif ( points ) {\n\n\t\t\tthis.setFromPoints( points );\n\n\t\t}\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.moveTo( points[ 0 ].x, points[ 0 ].y );\n\n\t\tfor ( let i = 1, l = points.length; i < l; i ++ ) {\n\n\t\t\tthis.lineTo( points[ i ].x, points[ i ].y );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tmoveTo( x, y ) {\n\n\t\tthis.currentPoint.set( x, y ); // TODO consider referencing vectors instead of copying?\n\n\t\treturn this;\n\n\t}\n\n\tlineTo( x, y ) {\n\n\t\tconst curve = new LineCurve( this.currentPoint.clone(), new Vector2( x, y ) );\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.set( x, y );\n\n\t\treturn this;\n\n\t}\n\n\tquadraticCurveTo( aCPx, aCPy, aX, aY ) {\n\n\t\tconst curve = new QuadraticBezierCurve(\n\t\t\tthis.currentPoint.clone(),\n\t\t\tnew Vector2( aCPx, aCPy ),\n\t\t\tnew Vector2( aX, aY )\n\t\t);\n\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.set( aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tbezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\n\n\t\tconst curve = new CubicBezierCurve(\n\t\t\tthis.currentPoint.clone(),\n\t\t\tnew Vector2( aCP1x, aCP1y ),\n\t\t\tnew Vector2( aCP2x, aCP2y ),\n\t\t\tnew Vector2( aX, aY )\n\t\t);\n\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.set( aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tsplineThru( pts /*Array of Vector*/ ) {\n\n\t\tconst npts = [ this.currentPoint.clone() ].concat( pts );\n\n\t\tconst curve = new SplineCurve( npts );\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.copy( pts[ pts.length - 1 ] );\n\n\t\treturn this;\n\n\t}\n\n\tarc( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tconst x0 = this.currentPoint.x;\n\t\tconst y0 = this.currentPoint.y;\n\n\t\tthis.absarc( aX + x0, aY + y0, aRadius,\n\t\t\taStartAngle, aEndAngle, aClockwise );\n\n\t\treturn this;\n\n\t}\n\n\tabsarc( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tthis.absellipse( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\n\n\t\treturn this;\n\n\t}\n\n\tellipse( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\t\tconst x0 = this.currentPoint.x;\n\t\tconst y0 = this.currentPoint.y;\n\n\t\tthis.absellipse( aX + x0, aY + y0, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\n\n\t\treturn this;\n\n\t}\n\n\tabsellipse( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\t\tconst curve = new EllipseCurve( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\n\n\t\tif ( this.curves.length > 0 ) {\n\n\t\t\t// if a previous curve is present, attempt to join\n\t\t\tconst firstPoint = curve.getPoint( 0 );\n\n\t\t\tif ( ! firstPoint.equals( this.currentPoint ) ) {\n\n\t\t\t\tthis.lineTo( firstPoint.x, firstPoint.y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.curves.push( curve );\n\n\t\tconst lastPoint = curve.getPoint( 1 );\n\t\tthis.currentPoint.copy( lastPoint );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.currentPoint.copy( source.currentPoint );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.currentPoint = this.currentPoint.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.currentPoint.fromArray( json.currentPoint );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass LatheGeometry extends BufferGeometry {\n\n\tconstructor( points = [ new Vector2( 0, - 0.5 ), new Vector2( 0.5, 0 ), new Vector2( 0, 0.5 ) ], segments = 12, phiStart = 0, phiLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'LatheGeometry';\n\n\t\tthis.parameters = {\n\t\t\tpoints: points,\n\t\t\tsegments: segments,\n\t\t\tphiStart: phiStart,\n\t\t\tphiLength: phiLength\n\t\t};\n\n\t\tsegments = Math.floor( segments );\n\n\t\t// clamp phiLength so it's in range of [ 0, 2PI ]\n\n\t\tphiLength = clamp( phiLength, 0, Math.PI * 2 );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst uvs = [];\n\t\tconst initNormals = [];\n\t\tconst normals = [];\n\n\t\t// helper variables\n\n\t\tconst inverseSegments = 1.0 / segments;\n\t\tconst vertex = new Vector3();\n\t\tconst uv = new Vector2();\n\t\tconst normal = new Vector3();\n\t\tconst curNormal = new Vector3();\n\t\tconst prevNormal = new Vector3();\n\t\tlet dx = 0;\n\t\tlet dy = 0;\n\n\t\t// pre-compute normals for initial \"meridian\"\n\n\t\tfor ( let j = 0; j <= ( points.length - 1 ); j ++ ) {\n\n\t\t\tswitch ( j ) {\n\n\t\t\t\tcase 0:\t\t\t\t// special handling for 1st vertex on path\n\n\t\t\t\t\tdx = points[ j + 1 ].x - points[ j ].x;\n\t\t\t\t\tdy = points[ j + 1 ].y - points[ j ].y;\n\n\t\t\t\t\tnormal.x = dy * 1.0;\n\t\t\t\t\tnormal.y = - dx;\n\t\t\t\t\tnormal.z = dy * 0.0;\n\n\t\t\t\t\tprevNormal.copy( normal );\n\n\t\t\t\t\tnormal.normalize();\n\n\t\t\t\t\tinitNormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ( points.length - 1 ):\t// special handling for last Vertex on path\n\n\t\t\t\t\tinitNormals.push( prevNormal.x, prevNormal.y, prevNormal.z );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\t\t\t// default handling for all vertices in between\n\n\t\t\t\t\tdx = points[ j + 1 ].x - points[ j ].x;\n\t\t\t\t\tdy = points[ j + 1 ].y - points[ j ].y;\n\n\t\t\t\t\tnormal.x = dy * 1.0;\n\t\t\t\t\tnormal.y = - dx;\n\t\t\t\t\tnormal.z = dy * 0.0;\n\n\t\t\t\t\tcurNormal.copy( normal );\n\n\t\t\t\t\tnormal.x += prevNormal.x;\n\t\t\t\t\tnormal.y += prevNormal.y;\n\t\t\t\t\tnormal.z += prevNormal.z;\n\n\t\t\t\t\tnormal.normalize();\n\n\t\t\t\t\tinitNormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t\tprevNormal.copy( curNormal );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate vertices, uvs and normals\n\n\t\tfor ( let i = 0; i <= segments; i ++ ) {\n\n\t\t\tconst phi = phiStart + i * inverseSegments * phiLength;\n\n\t\t\tconst sin = Math.sin( phi );\n\t\t\tconst cos = Math.cos( phi );\n\n\t\t\tfor ( let j = 0; j <= ( points.length - 1 ); j ++ ) {\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = points[ j ].x * sin;\n\t\t\t\tvertex.y = points[ j ].y;\n\t\t\t\tvertex.z = points[ j ].x * cos;\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuv.x = i / segments;\n\t\t\t\tuv.y = j / ( points.length - 1 );\n\n\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t\t// normal\n\n\t\t\t\tconst x = initNormals[ 3 * j + 0 ] * sin;\n\t\t\t\tconst y = initNormals[ 3 * j + 1 ];\n\t\t\t\tconst z = initNormals[ 3 * j + 0 ] * cos;\n\n\t\t\t\tnormals.push( x, y, z );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let i = 0; i < segments; i ++ ) {\n\n\t\t\tfor ( let j = 0; j < ( points.length - 1 ); j ++ ) {\n\n\t\t\t\tconst base = j + i * points.length;\n\n\t\t\t\tconst a = base;\n\t\t\t\tconst b = base + points.length;\n\t\t\t\tconst c = base + points.length + 1;\n\t\t\t\tconst d = base + 1;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( c, d, b );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new LatheGeometry( data.points, data.segments, data.phiStart, data.phiLength );\n\n\t}\n\n}\n\nclass CapsuleGeometry extends LatheGeometry {\n\n\tconstructor( radius = 1, length = 1, capSegments = 4, radialSegments = 8 ) {\n\n\t\tconst path = new Path();\n\t\tpath.absarc( 0, - length / 2, radius, Math.PI * 1.5, 0 );\n\t\tpath.absarc( 0, length / 2, radius, 0, Math.PI * 0.5 );\n\n\t\tsuper( path.getPoints( capSegments ), radialSegments );\n\n\t\tthis.type = 'CapsuleGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tlength: length,\n\t\t\tcapSegments: capSegments,\n\t\t\tradialSegments: radialSegments,\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new CapsuleGeometry( data.radius, data.length, data.capSegments, data.radialSegments );\n\n\t}\n\n}\n\nclass CircleGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, segments = 32, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CircleGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tsegments: segments,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tsegments = Math.max( 3, segments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tconst vertex = new Vector3();\n\t\tconst uv = new Vector2();\n\n\t\t// center point\n\n\t\tvertices.push( 0, 0, 0 );\n\t\tnormals.push( 0, 0, 1 );\n\t\tuvs.push( 0.5, 0.5 );\n\n\t\tfor ( let s = 0, i = 3; s <= segments; s ++, i += 3 ) {\n\n\t\t\tconst segment = thetaStart + s / segments * thetaLength;\n\n\t\t\t// vertex\n\n\t\t\tvertex.x = radius * Math.cos( segment );\n\t\t\tvertex.y = radius * Math.sin( segment );\n\n\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t// normal\n\n\t\t\tnormals.push( 0, 0, 1 );\n\n\t\t\t// uvs\n\n\t\t\tuv.x = ( vertices[ i ] / radius + 1 ) / 2;\n\t\t\tuv.y = ( vertices[ i + 1 ] / radius + 1 ) / 2;\n\n\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let i = 1; i <= segments; i ++ ) {\n\n\t\t\tindices.push( i, i + 1, 0 );\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new CircleGeometry( data.radius, data.segments, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass CylinderGeometry extends BufferGeometry {\n\n\tconstructor( radiusTop = 1, radiusBottom = 1, height = 1, radialSegments = 32, heightSegments = 1, openEnded = false, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CylinderGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradiusTop: radiusTop,\n\t\t\tradiusBottom: radiusBottom,\n\t\t\theight: height,\n\t\t\tradialSegments: radialSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\topenEnded: openEnded,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tconst scope = this;\n\n\t\tradialSegments = Math.floor( radialSegments );\n\t\theightSegments = Math.floor( heightSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tlet index = 0;\n\t\tconst indexArray = [];\n\t\tconst halfHeight = height / 2;\n\t\tlet groupStart = 0;\n\n\t\t// generate geometry\n\n\t\tgenerateTorso();\n\n\t\tif ( openEnded === false ) {\n\n\t\t\tif ( radiusTop > 0 ) generateCap( true );\n\t\t\tif ( radiusBottom > 0 ) generateCap( false );\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\tfunction generateTorso() {\n\n\t\t\tconst normal = new Vector3();\n\t\t\tconst vertex = new Vector3();\n\n\t\t\tlet groupCount = 0;\n\n\t\t\t// this will be used to calculate the normal\n\t\t\tconst slope = ( radiusBottom - radiusTop ) / height;\n\n\t\t\t// generate vertices, normals and uvs\n\n\t\t\tfor ( let y = 0; y <= heightSegments; y ++ ) {\n\n\t\t\t\tconst indexRow = [];\n\n\t\t\t\tconst v = y / heightSegments;\n\n\t\t\t\t// calculate the radius of the current row\n\n\t\t\t\tconst radius = v * ( radiusBottom - radiusTop ) + radiusTop;\n\n\t\t\t\tfor ( let x = 0; x <= radialSegments; x ++ ) {\n\n\t\t\t\t\tconst u = x / radialSegments;\n\n\t\t\t\t\tconst theta = u * thetaLength + thetaStart;\n\n\t\t\t\t\tconst sinTheta = Math.sin( theta );\n\t\t\t\t\tconst cosTheta = Math.cos( theta );\n\n\t\t\t\t\t// vertex\n\n\t\t\t\t\tvertex.x = radius * sinTheta;\n\t\t\t\t\tvertex.y = - v * height + halfHeight;\n\t\t\t\t\tvertex.z = radius * cosTheta;\n\t\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t\t// normal\n\n\t\t\t\t\tnormal.set( sinTheta, slope, cosTheta ).normalize();\n\t\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t\t// uv\n\n\t\t\t\t\tuvs.push( u, 1 - v );\n\n\t\t\t\t\t// save index of vertex in respective row\n\n\t\t\t\t\tindexRow.push( index ++ );\n\n\t\t\t\t}\n\n\t\t\t\t// now save vertices of the row in our index array\n\n\t\t\t\tindexArray.push( indexRow );\n\n\t\t\t}\n\n\t\t\t// generate indices\n\n\t\t\tfor ( let x = 0; x < radialSegments; x ++ ) {\n\n\t\t\t\tfor ( let y = 0; y < heightSegments; y ++ ) {\n\n\t\t\t\t\t// we use the index array to access the correct indices\n\n\t\t\t\t\tconst a = indexArray[ y ][ x ];\n\t\t\t\t\tconst b = indexArray[ y + 1 ][ x ];\n\t\t\t\t\tconst c = indexArray[ y + 1 ][ x + 1 ];\n\t\t\t\t\tconst d = indexArray[ y ][ x + 1 ];\n\n\t\t\t\t\t// faces\n\n\t\t\t\t\tif ( radiusTop > 0 || y !== 0 ) {\n\n\t\t\t\t\t\tindices.push( a, b, d );\n\t\t\t\t\t\tgroupCount += 3;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( radiusBottom > 0 || y !== heightSegments - 1 ) {\n\n\t\t\t\t\t\tindices.push( b, c, d );\n\t\t\t\t\t\tgroupCount += 3;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\n\t\t\tscope.addGroup( groupStart, groupCount, 0 );\n\n\t\t\t// calculate new start value for groups\n\n\t\t\tgroupStart += groupCount;\n\n\t\t}\n\n\t\tfunction generateCap( top ) {\n\n\t\t\t// save the index of the first center vertex\n\t\t\tconst centerIndexStart = index;\n\n\t\t\tconst uv = new Vector2();\n\t\t\tconst vertex = new Vector3();\n\n\t\t\tlet groupCount = 0;\n\n\t\t\tconst radius = ( top === true ) ? radiusTop : radiusBottom;\n\t\t\tconst sign = ( top === true ) ? 1 : - 1;\n\n\t\t\t// first we generate the center vertex data of the cap.\n\t\t\t// because the geometry needs one set of uvs per face,\n\t\t\t// we must generate a center vertex per face/segment\n\n\t\t\tfor ( let x = 1; x <= radialSegments; x ++ ) {\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertices.push( 0, halfHeight * sign, 0 );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormals.push( 0, sign, 0 );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( 0.5, 0.5 );\n\n\t\t\t\t// increase index\n\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t\t// save the index of the last center vertex\n\t\t\tconst centerIndexEnd = index;\n\n\t\t\t// now we generate the surrounding vertices, normals and uvs\n\n\t\t\tfor ( let x = 0; x <= radialSegments; x ++ ) {\n\n\t\t\t\tconst u = x / radialSegments;\n\t\t\t\tconst theta = u * thetaLength + thetaStart;\n\n\t\t\t\tconst cosTheta = Math.cos( theta );\n\t\t\t\tconst sinTheta = Math.sin( theta );\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = radius * sinTheta;\n\t\t\t\tvertex.y = halfHeight * sign;\n\t\t\t\tvertex.z = radius * cosTheta;\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormals.push( 0, sign, 0 );\n\n\t\t\t\t// uv\n\n\t\t\t\tuv.x = ( cosTheta * 0.5 ) + 0.5;\n\t\t\t\tuv.y = ( sinTheta * 0.5 * sign ) + 0.5;\n\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t\t// increase index\n\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t\t// generate indices\n\n\t\t\tfor ( let x = 0; x < radialSegments; x ++ ) {\n\n\t\t\t\tconst c = centerIndexStart + x;\n\t\t\t\tconst i = centerIndexEnd + x;\n\n\t\t\t\tif ( top === true ) {\n\n\t\t\t\t\t// face top\n\n\t\t\t\t\tindices.push( i, i + 1, c );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// face bottom\n\n\t\t\t\t\tindices.push( i + 1, i, c );\n\n\t\t\t\t}\n\n\t\t\t\tgroupCount += 3;\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\n\t\t\tscope.addGroup( groupStart, groupCount, top === true ? 1 : 2 );\n\n\t\t\t// calculate new start value for groups\n\n\t\t\tgroupStart += groupCount;\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new CylinderGeometry( data.radiusTop, data.radiusBottom, data.height, data.radialSegments, data.heightSegments, data.openEnded, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass ConeGeometry extends CylinderGeometry {\n\n\tconstructor( radius = 1, height = 1, radialSegments = 32, heightSegments = 1, openEnded = false, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper( 0, radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength );\n\n\t\tthis.type = 'ConeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\theight: height,\n\t\t\tradialSegments: radialSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\topenEnded: openEnded,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new ConeGeometry( data.radius, data.height, data.radialSegments, data.heightSegments, data.openEnded, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass PolyhedronGeometry extends BufferGeometry {\n\n\tconstructor( vertices = [], indices = [], radius = 1, detail = 0 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'PolyhedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tvertices: vertices,\n\t\t\tindices: indices,\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t\t// default buffer data\n\n\t\tconst vertexBuffer = [];\n\t\tconst uvBuffer = [];\n\n\t\t// the subdivision creates the vertex buffer data\n\n\t\tsubdivide( detail );\n\n\t\t// all vertices should lie on a conceptual sphere with a given radius\n\n\t\tapplyRadius( radius );\n\n\t\t// finally, create the uv data\n\n\t\tgenerateUVs();\n\n\t\t// build non-indexed geometry\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertexBuffer, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( vertexBuffer.slice(), 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvBuffer, 2 ) );\n\n\t\tif ( detail === 0 ) {\n\n\t\t\tthis.computeVertexNormals(); // flat normals\n\n\t\t} else {\n\n\t\t\tthis.normalizeNormals(); // smooth normals\n\n\t\t}\n\n\t\t// helper functions\n\n\t\tfunction subdivide( detail ) {\n\n\t\t\tconst a = new Vector3();\n\t\t\tconst b = new Vector3();\n\t\t\tconst c = new Vector3();\n\n\t\t\t// iterate over all faces and apply a subdivision with the given detail value\n\n\t\t\tfor ( let i = 0; i < indices.length; i += 3 ) {\n\n\t\t\t\t// get the vertices of the face\n\n\t\t\t\tgetVertexByIndex( indices[ i + 0 ], a );\n\t\t\t\tgetVertexByIndex( indices[ i + 1 ], b );\n\t\t\t\tgetVertexByIndex( indices[ i + 2 ], c );\n\n\t\t\t\t// perform subdivision\n\n\t\t\t\tsubdivideFace( a, b, c, detail );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction subdivideFace( a, b, c, detail ) {\n\n\t\t\tconst cols = detail + 1;\n\n\t\t\t// we use this multidimensional array as a data structure for creating the subdivision\n\n\t\t\tconst v = [];\n\n\t\t\t// construct all of the vertices for this subdivision\n\n\t\t\tfor ( let i = 0; i <= cols; i ++ ) {\n\n\t\t\t\tv[ i ] = [];\n\n\t\t\t\tconst aj = a.clone().lerp( c, i / cols );\n\t\t\t\tconst bj = b.clone().lerp( c, i / cols );\n\n\t\t\t\tconst rows = cols - i;\n\n\t\t\t\tfor ( let j = 0; j <= rows; j ++ ) {\n\n\t\t\t\t\tif ( j === 0 && i === cols ) {\n\n\t\t\t\t\t\tv[ i ][ j ] = aj;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tv[ i ][ j ] = aj.clone().lerp( bj, j / rows );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// construct all of the faces\n\n\t\t\tfor ( let i = 0; i < cols; i ++ ) {\n\n\t\t\t\tfor ( let j = 0; j < 2 * ( cols - i ) - 1; j ++ ) {\n\n\t\t\t\t\tconst k = Math.floor( j / 2 );\n\n\t\t\t\t\tif ( j % 2 === 0 ) {\n\n\t\t\t\t\t\tpushVertex( v[ i ][ k + 1 ] );\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k ] );\n\t\t\t\t\t\tpushVertex( v[ i ][ k ] );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tpushVertex( v[ i ][ k + 1 ] );\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k + 1 ] );\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction applyRadius( radius ) {\n\n\t\t\tconst vertex = new Vector3();\n\n\t\t\t// iterate over the entire buffer and apply the radius to each vertex\n\n\t\t\tfor ( let i = 0; i < vertexBuffer.length; i += 3 ) {\n\n\t\t\t\tvertex.x = vertexBuffer[ i + 0 ];\n\t\t\t\tvertex.y = vertexBuffer[ i + 1 ];\n\t\t\t\tvertex.z = vertexBuffer[ i + 2 ];\n\n\t\t\t\tvertex.normalize().multiplyScalar( radius );\n\n\t\t\t\tvertexBuffer[ i + 0 ] = vertex.x;\n\t\t\t\tvertexBuffer[ i + 1 ] = vertex.y;\n\t\t\t\tvertexBuffer[ i + 2 ] = vertex.z;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction generateUVs() {\n\n\t\t\tconst vertex = new Vector3();\n\n\t\t\tfor ( let i = 0; i < vertexBuffer.length; i += 3 ) {\n\n\t\t\t\tvertex.x = vertexBuffer[ i + 0 ];\n\t\t\t\tvertex.y = vertexBuffer[ i + 1 ];\n\t\t\t\tvertex.z = vertexBuffer[ i + 2 ];\n\n\t\t\t\tconst u = azimuth( vertex ) / 2 / Math.PI + 0.5;\n\t\t\t\tconst v = inclination( vertex ) / Math.PI + 0.5;\n\t\t\t\tuvBuffer.push( u, 1 - v );\n\n\t\t\t}\n\n\t\t\tcorrectUVs();\n\n\t\t\tcorrectSeam();\n\n\t\t}\n\n\t\tfunction correctSeam() {\n\n\t\t\t// handle case when face straddles the seam, see #3269\n\n\t\t\tfor ( let i = 0; i < uvBuffer.length; i += 6 ) {\n\n\t\t\t\t// uv data of a single face\n\n\t\t\t\tconst x0 = uvBuffer[ i + 0 ];\n\t\t\t\tconst x1 = uvBuffer[ i + 2 ];\n\t\t\t\tconst x2 = uvBuffer[ i + 4 ];\n\n\t\t\t\tconst max = Math.max( x0, x1, x2 );\n\t\t\t\tconst min = Math.min( x0, x1, x2 );\n\n\t\t\t\t// 0.9 is somewhat arbitrary\n\n\t\t\t\tif ( max > 0.9 && min < 0.1 ) {\n\n\t\t\t\t\tif ( x0 < 0.2 ) uvBuffer[ i + 0 ] += 1;\n\t\t\t\t\tif ( x1 < 0.2 ) uvBuffer[ i + 2 ] += 1;\n\t\t\t\t\tif ( x2 < 0.2 ) uvBuffer[ i + 4 ] += 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction pushVertex( vertex ) {\n\n\t\t\tvertexBuffer.push( vertex.x, vertex.y, vertex.z );\n\n\t\t}\n\n\t\tfunction getVertexByIndex( index, vertex ) {\n\n\t\t\tconst stride = index * 3;\n\n\t\t\tvertex.x = vertices[ stride + 0 ];\n\t\t\tvertex.y = vertices[ stride + 1 ];\n\t\t\tvertex.z = vertices[ stride + 2 ];\n\n\t\t}\n\n\t\tfunction correctUVs() {\n\n\t\t\tconst a = new Vector3();\n\t\t\tconst b = new Vector3();\n\t\t\tconst c = new Vector3();\n\n\t\t\tconst centroid = new Vector3();\n\n\t\t\tconst uvA = new Vector2();\n\t\t\tconst uvB = new Vector2();\n\t\t\tconst uvC = new Vector2();\n\n\t\t\tfor ( let i = 0, j = 0; i < vertexBuffer.length; i += 9, j += 6 ) {\n\n\t\t\t\ta.set( vertexBuffer[ i + 0 ], vertexBuffer[ i + 1 ], vertexBuffer[ i + 2 ] );\n\t\t\t\tb.set( vertexBuffer[ i + 3 ], vertexBuffer[ i + 4 ], vertexBuffer[ i + 5 ] );\n\t\t\t\tc.set( vertexBuffer[ i + 6 ], vertexBuffer[ i + 7 ], vertexBuffer[ i + 8 ] );\n\n\t\t\t\tuvA.set( uvBuffer[ j + 0 ], uvBuffer[ j + 1 ] );\n\t\t\t\tuvB.set( uvBuffer[ j + 2 ], uvBuffer[ j + 3 ] );\n\t\t\t\tuvC.set( uvBuffer[ j + 4 ], uvBuffer[ j + 5 ] );\n\n\t\t\t\tcentroid.copy( a ).add( b ).add( c ).divideScalar( 3 );\n\n\t\t\t\tconst azi = azimuth( centroid );\n\n\t\t\t\tcorrectUV( uvA, j + 0, a, azi );\n\t\t\t\tcorrectUV( uvB, j + 2, b, azi );\n\t\t\t\tcorrectUV( uvC, j + 4, c, azi );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction correctUV( uv, stride, vector, azimuth ) {\n\n\t\t\tif ( ( azimuth < 0 ) && ( uv.x === 1 ) ) {\n\n\t\t\t\tuvBuffer[ stride ] = uv.x - 1;\n\n\t\t\t}\n\n\t\t\tif ( ( vector.x === 0 ) && ( vector.z === 0 ) ) {\n\n\t\t\t\tuvBuffer[ stride ] = azimuth / 2 / Math.PI + 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Angle around the Y axis, counter-clockwise when looking from above.\n\n\t\tfunction azimuth( vector ) {\n\n\t\t\treturn Math.atan2( vector.z, - vector.x );\n\n\t\t}\n\n\n\t\t// Angle above the XZ plane.\n\n\t\tfunction inclination( vector ) {\n\n\t\t\treturn Math.atan2( - vector.y, Math.sqrt( ( vector.x * vector.x ) + ( vector.z * vector.z ) ) );\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new PolyhedronGeometry( data.vertices, data.indices, data.radius, data.details );\n\n\t}\n\n}\n\nclass DodecahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst t = ( 1 + Math.sqrt( 5 ) ) / 2;\n\t\tconst r = 1 / t;\n\n\t\tconst vertices = [\n\n\t\t\t// (±1, ±1, ±1)\n\t\t\t- 1, - 1, - 1,\t- 1, - 1, 1,\n\t\t\t- 1, 1, - 1, - 1, 1, 1,\n\t\t\t1, - 1, - 1, 1, - 1, 1,\n\t\t\t1, 1, - 1, 1, 1, 1,\n\n\t\t\t// (0, ±1/φ, ±φ)\n\t\t\t0, - r, - t, 0, - r, t,\n\t\t\t0, r, - t, 0, r, t,\n\n\t\t\t// (±1/φ, ±φ, 0)\n\t\t\t- r, - t, 0, - r, t, 0,\n\t\t\tr, - t, 0, r, t, 0,\n\n\t\t\t// (±φ, 0, ±1/φ)\n\t\t\t- t, 0, - r, t, 0, - r,\n\t\t\t- t, 0, r, t, 0, r\n\t\t];\n\n\t\tconst indices = [\n\t\t\t3, 11, 7, \t3, 7, 15, \t3, 15, 13,\n\t\t\t7, 19, 17, \t7, 17, 6, \t7, 6, 15,\n\t\t\t17, 4, 8, \t17, 8, 10, \t17, 10, 6,\n\t\t\t8, 0, 16, \t8, 16, 2, \t8, 2, 10,\n\t\t\t0, 12, 1, \t0, 1, 18, \t0, 18, 16,\n\t\t\t6, 10, 2, \t6, 2, 13, \t6, 13, 15,\n\t\t\t2, 16, 18, \t2, 18, 3, \t2, 3, 13,\n\t\t\t18, 1, 9, \t18, 9, 11, \t18, 11, 3,\n\t\t\t4, 14, 12, \t4, 12, 0, \t4, 0, 8,\n\t\t\t11, 9, 5, \t11, 5, 19, \t11, 19, 7,\n\t\t\t19, 5, 14, \t19, 14, 4, \t19, 4, 17,\n\t\t\t1, 12, 14, \t1, 14, 5, \t1, 5, 9\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'DodecahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new DodecahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nconst _v0 = /*@__PURE__*/ new Vector3();\nconst _v1$1 = /*@__PURE__*/ new Vector3();\nconst _normal = /*@__PURE__*/ new Vector3();\nconst _triangle = /*@__PURE__*/ new Triangle();\n\nclass EdgesGeometry extends BufferGeometry {\n\n\tconstructor( geometry = null, thresholdAngle = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'EdgesGeometry';\n\n\t\tthis.parameters = {\n\t\t\tgeometry: geometry,\n\t\t\tthresholdAngle: thresholdAngle\n\t\t};\n\n\t\tif ( geometry !== null ) {\n\n\t\t\tconst precisionPoints = 4;\n\t\t\tconst precision = Math.pow( 10, precisionPoints );\n\t\t\tconst thresholdDot = Math.cos( DEG2RAD * thresholdAngle );\n\n\t\t\tconst indexAttr = geometry.getIndex();\n\t\t\tconst positionAttr = geometry.getAttribute( 'position' );\n\t\t\tconst indexCount = indexAttr ? indexAttr.count : positionAttr.count;\n\n\t\t\tconst indexArr = [ 0, 0, 0 ];\n\t\t\tconst vertKeys = [ 'a', 'b', 'c' ];\n\t\t\tconst hashes = new Array( 3 );\n\n\t\t\tconst edgeData = {};\n\t\t\tconst vertices = [];\n\t\t\tfor ( let i = 0; i < indexCount; i += 3 ) {\n\n\t\t\t\tif ( indexAttr ) {\n\n\t\t\t\t\tindexArr[ 0 ] = indexAttr.getX( i );\n\t\t\t\t\tindexArr[ 1 ] = indexAttr.getX( i + 1 );\n\t\t\t\t\tindexArr[ 2 ] = indexAttr.getX( i + 2 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tindexArr[ 0 ] = i;\n\t\t\t\t\tindexArr[ 1 ] = i + 1;\n\t\t\t\t\tindexArr[ 2 ] = i + 2;\n\n\t\t\t\t}\n\n\t\t\t\tconst { a, b, c } = _triangle;\n\t\t\t\ta.fromBufferAttribute( positionAttr, indexArr[ 0 ] );\n\t\t\t\tb.fromBufferAttribute( positionAttr, indexArr[ 1 ] );\n\t\t\t\tc.fromBufferAttribute( positionAttr, indexArr[ 2 ] );\n\t\t\t\t_triangle.getNormal( _normal );\n\n\t\t\t\t// create hashes for the edge from the vertices\n\t\t\t\thashes[ 0 ] = `${ Math.round( a.x * precision ) },${ Math.round( a.y * precision ) },${ Math.round( a.z * precision ) }`;\n\t\t\t\thashes[ 1 ] = `${ Math.round( b.x * precision ) },${ Math.round( b.y * precision ) },${ Math.round( b.z * precision ) }`;\n\t\t\t\thashes[ 2 ] = `${ Math.round( c.x * precision ) },${ Math.round( c.y * precision ) },${ Math.round( c.z * precision ) }`;\n\n\t\t\t\t// skip degenerate triangles\n\t\t\t\tif ( hashes[ 0 ] === hashes[ 1 ] || hashes[ 1 ] === hashes[ 2 ] || hashes[ 2 ] === hashes[ 0 ] ) {\n\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\t// iterate over every edge\n\t\t\t\tfor ( let j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t// get the first and next vertex making up the edge\n\t\t\t\t\tconst jNext = ( j + 1 ) % 3;\n\t\t\t\t\tconst vecHash0 = hashes[ j ];\n\t\t\t\t\tconst vecHash1 = hashes[ jNext ];\n\t\t\t\t\tconst v0 = _triangle[ vertKeys[ j ] ];\n\t\t\t\t\tconst v1 = _triangle[ vertKeys[ jNext ] ];\n\n\t\t\t\t\tconst hash = `${ vecHash0 }_${ vecHash1 }`;\n\t\t\t\t\tconst reverseHash = `${ vecHash1 }_${ vecHash0 }`;\n\n\t\t\t\t\tif ( reverseHash in edgeData && edgeData[ reverseHash ] ) {\n\n\t\t\t\t\t\t// if we found a sibling edge add it into the vertex array if\n\t\t\t\t\t\t// it meets the angle threshold and delete the edge from the map.\n\t\t\t\t\t\tif ( _normal.dot( edgeData[ reverseHash ].normal ) <= thresholdDot ) {\n\n\t\t\t\t\t\t\tvertices.push( v0.x, v0.y, v0.z );\n\t\t\t\t\t\t\tvertices.push( v1.x, v1.y, v1.z );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tedgeData[ reverseHash ] = null;\n\n\t\t\t\t\t} else if ( ! ( hash in edgeData ) ) {\n\n\t\t\t\t\t\t// if we've already got an edge here then skip adding a new one\n\t\t\t\t\t\tedgeData[ hash ] = {\n\n\t\t\t\t\t\t\tindex0: indexArr[ j ],\n\t\t\t\t\t\t\tindex1: indexArr[ jNext ],\n\t\t\t\t\t\t\tnormal: _normal.clone(),\n\n\t\t\t\t\t\t};\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// iterate over all remaining, unmatched edges and add them to the vertex array\n\t\t\tfor ( const key in edgeData ) {\n\n\t\t\t\tif ( edgeData[ key ] ) {\n\n\t\t\t\t\tconst { index0, index1 } = edgeData[ key ];\n\t\t\t\t\t_v0.fromBufferAttribute( positionAttr, index0 );\n\t\t\t\t\t_v1$1.fromBufferAttribute( positionAttr, index1 );\n\n\t\t\t\t\tvertices.push( _v0.x, _v0.y, _v0.z );\n\t\t\t\t\tvertices.push( _v1$1.x, _v1$1.y, _v1$1.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass Shape extends Path {\n\n\tconstructor( points ) {\n\n\t\tsuper( points );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.type = 'Shape';\n\n\t\tthis.holes = [];\n\n\t}\n\n\tgetPointsHoles( divisions ) {\n\n\t\tconst holesPts = [];\n\n\t\tfor ( let i = 0, l = this.holes.length; i < l; i ++ ) {\n\n\t\t\tholesPts[ i ] = this.holes[ i ].getPoints( divisions );\n\n\t\t}\n\n\t\treturn holesPts;\n\n\t}\n\n\t// get points of shape and holes (keypoints based on segments parameter)\n\n\textractPoints( divisions ) {\n\n\t\treturn {\n\n\t\t\tshape: this.getPoints( divisions ),\n\t\t\tholes: this.getPointsHoles( divisions )\n\n\t\t};\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.holes = [];\n\n\t\tfor ( let i = 0, l = source.holes.length; i < l; i ++ ) {\n\n\t\t\tconst hole = source.holes[ i ];\n\n\t\t\tthis.holes.push( hole.clone() );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.uuid = this.uuid;\n\t\tdata.holes = [];\n\n\t\tfor ( let i = 0, l = this.holes.length; i < l; i ++ ) {\n\n\t\t\tconst hole = this.holes[ i ];\n\t\t\tdata.holes.push( hole.toJSON() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.uuid = json.uuid;\n\t\tthis.holes = [];\n\n\t\tfor ( let i = 0, l = json.holes.length; i < l; i ++ ) {\n\n\t\t\tconst hole = json.holes[ i ];\n\t\t\tthis.holes.push( new Path().fromJSON( hole ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\n/**\n * Port from https://github.com/mapbox/earcut (v2.2.4)\n */\n\nconst Earcut = {\n\n\ttriangulate: function ( data, holeIndices, dim = 2 ) {\n\n\t\tconst hasHoles = holeIndices && holeIndices.length;\n\t\tconst outerLen = hasHoles ? holeIndices[ 0 ] * dim : data.length;\n\t\tlet outerNode = linkedList( data, 0, outerLen, dim, true );\n\t\tconst triangles = [];\n\n\t\tif ( ! outerNode || outerNode.next === outerNode.prev ) return triangles;\n\n\t\tlet minX, minY, maxX, maxY, x, y, invSize;\n\n\t\tif ( hasHoles ) outerNode = eliminateHoles( data, holeIndices, outerNode, dim );\n\n\t\t// if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n\t\tif ( data.length > 80 * dim ) {\n\n\t\t\tminX = maxX = data[ 0 ];\n\t\t\tminY = maxY = data[ 1 ];\n\n\t\t\tfor ( let i = dim; i < outerLen; i += dim ) {\n\n\t\t\t\tx = data[ i ];\n\t\t\t\ty = data[ i + 1 ];\n\t\t\t\tif ( x < minX ) minX = x;\n\t\t\t\tif ( y < minY ) minY = y;\n\t\t\t\tif ( x > maxX ) maxX = x;\n\t\t\t\tif ( y > maxY ) maxY = y;\n\n\t\t\t}\n\n\t\t\t// minX, minY and invSize are later used to transform coords into integers for z-order calculation\n\t\t\tinvSize = Math.max( maxX - minX, maxY - minY );\n\t\t\tinvSize = invSize !== 0 ? 32767 / invSize : 0;\n\n\t\t}\n\n\t\tearcutLinked( outerNode, triangles, dim, minX, minY, invSize, 0 );\n\n\t\treturn triangles;\n\n\t}\n\n};\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList( data, start, end, dim, clockwise ) {\n\n\tlet i, last;\n\n\tif ( clockwise === ( signedArea( data, start, end, dim ) > 0 ) ) {\n\n\t\tfor ( i = start; i < end; i += dim ) last = insertNode( i, data[ i ], data[ i + 1 ], last );\n\n\t} else {\n\n\t\tfor ( i = end - dim; i >= start; i -= dim ) last = insertNode( i, data[ i ], data[ i + 1 ], last );\n\n\t}\n\n\tif ( last && equals( last, last.next ) ) {\n\n\t\tremoveNode( last );\n\t\tlast = last.next;\n\n\t}\n\n\treturn last;\n\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints( start, end ) {\n\n\tif ( ! start ) return start;\n\tif ( ! end ) end = start;\n\n\tlet p = start,\n\t\tagain;\n\tdo {\n\n\t\tagain = false;\n\n\t\tif ( ! p.steiner && ( equals( p, p.next ) || area( p.prev, p, p.next ) === 0 ) ) {\n\n\t\t\tremoveNode( p );\n\t\t\tp = end = p.prev;\n\t\t\tif ( p === p.next ) break;\n\t\t\tagain = true;\n\n\t\t} else {\n\n\t\t\tp = p.next;\n\n\t\t}\n\n\t} while ( again || p !== end );\n\n\treturn end;\n\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked( ear, triangles, dim, minX, minY, invSize, pass ) {\n\n\tif ( ! ear ) return;\n\n\t// interlink polygon nodes in z-order\n\tif ( ! pass && invSize ) indexCurve( ear, minX, minY, invSize );\n\n\tlet stop = ear,\n\t\tprev, next;\n\n\t// iterate through ears, slicing them one by one\n\twhile ( ear.prev !== ear.next ) {\n\n\t\tprev = ear.prev;\n\t\tnext = ear.next;\n\n\t\tif ( invSize ? isEarHashed( ear, minX, minY, invSize ) : isEar( ear ) ) {\n\n\t\t\t// cut off the triangle\n\t\t\ttriangles.push( prev.i / dim | 0 );\n\t\t\ttriangles.push( ear.i / dim | 0 );\n\t\t\ttriangles.push( next.i / dim | 0 );\n\n\t\t\tremoveNode( ear );\n\n\t\t\t// skipping the next vertex leads to less sliver triangles\n\t\t\tear = next.next;\n\t\t\tstop = next.next;\n\n\t\t\tcontinue;\n\n\t\t}\n\n\t\tear = next;\n\n\t\t// if we looped through the whole remaining polygon and can't find any more ears\n\t\tif ( ear === stop ) {\n\n\t\t\t// try filtering points and slicing again\n\t\t\tif ( ! pass ) {\n\n\t\t\t\tearcutLinked( filterPoints( ear ), triangles, dim, minX, minY, invSize, 1 );\n\n\t\t\t\t// if this didn't work, try curing all small self-intersections locally\n\n\t\t\t} else if ( pass === 1 ) {\n\n\t\t\t\tear = cureLocalIntersections( filterPoints( ear ), triangles, dim );\n\t\t\t\tearcutLinked( ear, triangles, dim, minX, minY, invSize, 2 );\n\n\t\t\t\t// as a last resort, try splitting the remaining polygon into two\n\n\t\t\t} else if ( pass === 2 ) {\n\n\t\t\t\tsplitEarcut( ear, triangles, dim, minX, minY, invSize );\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar( ear ) {\n\n\tconst a = ear.prev,\n\t\tb = ear,\n\t\tc = ear.next;\n\n\tif ( area( a, b, c ) >= 0 ) return false; // reflex, can't be an ear\n\n\t// now make sure we don't have other points inside the potential ear\n\tconst ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n\t// triangle bbox; min & max are calculated like this for speed\n\tconst x0 = ax < bx ? ( ax < cx ? ax : cx ) : ( bx < cx ? bx : cx ),\n\t\ty0 = ay < by ? ( ay < cy ? ay : cy ) : ( by < cy ? by : cy ),\n\t\tx1 = ax > bx ? ( ax > cx ? ax : cx ) : ( bx > cx ? bx : cx ),\n\t\ty1 = ay > by ? ( ay > cy ? ay : cy ) : ( by > cy ? by : cy );\n\n\tlet p = c.next;\n\twhile ( p !== a ) {\n\n\t\tif ( p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 &&\n\t\t\tpointInTriangle( ax, ay, bx, by, cx, cy, p.x, p.y ) &&\n\t\t\tarea( p.prev, p, p.next ) >= 0 ) return false;\n\t\tp = p.next;\n\n\t}\n\n\treturn true;\n\n}\n\nfunction isEarHashed( ear, minX, minY, invSize ) {\n\n\tconst a = ear.prev,\n\t\tb = ear,\n\t\tc = ear.next;\n\n\tif ( area( a, b, c ) >= 0 ) return false; // reflex, can't be an ear\n\n\tconst ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n\t// triangle bbox; min & max are calculated like this for speed\n\tconst x0 = ax < bx ? ( ax < cx ? ax : cx ) : ( bx < cx ? bx : cx ),\n\t\ty0 = ay < by ? ( ay < cy ? ay : cy ) : ( by < cy ? by : cy ),\n\t\tx1 = ax > bx ? ( ax > cx ? ax : cx ) : ( bx > cx ? bx : cx ),\n\t\ty1 = ay > by ? ( ay > cy ? ay : cy ) : ( by > cy ? by : cy );\n\n\t// z-order range for the current triangle bbox;\n\tconst minZ = zOrder( x0, y0, minX, minY, invSize ),\n\t\tmaxZ = zOrder( x1, y1, minX, minY, invSize );\n\n\tlet p = ear.prevZ,\n\t\tn = ear.nextZ;\n\n\t// look for points inside the triangle in both directions\n\twhile ( p && p.z >= minZ && n && n.z <= maxZ ) {\n\n\t\tif ( p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n\t\t\tpointInTriangle( ax, ay, bx, by, cx, cy, p.x, p.y ) && area( p.prev, p, p.next ) >= 0 ) return false;\n\t\tp = p.prevZ;\n\n\t\tif ( n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n\t\t\tpointInTriangle( ax, ay, bx, by, cx, cy, n.x, n.y ) && area( n.prev, n, n.next ) >= 0 ) return false;\n\t\tn = n.nextZ;\n\n\t}\n\n\t// look for remaining points in decreasing z-order\n\twhile ( p && p.z >= minZ ) {\n\n\t\tif ( p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n\t\t\tpointInTriangle( ax, ay, bx, by, cx, cy, p.x, p.y ) && area( p.prev, p, p.next ) >= 0 ) return false;\n\t\tp = p.prevZ;\n\n\t}\n\n\t// look for remaining points in increasing z-order\n\twhile ( n && n.z <= maxZ ) {\n\n\t\tif ( n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n\t\t\tpointInTriangle( ax, ay, bx, by, cx, cy, n.x, n.y ) && area( n.prev, n, n.next ) >= 0 ) return false;\n\t\tn = n.nextZ;\n\n\t}\n\n\treturn true;\n\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections( start, triangles, dim ) {\n\n\tlet p = start;\n\tdo {\n\n\t\tconst a = p.prev,\n\t\t\tb = p.next.next;\n\n\t\tif ( ! equals( a, b ) && intersects( a, p, p.next, b ) && locallyInside( a, b ) && locallyInside( b, a ) ) {\n\n\t\t\ttriangles.push( a.i / dim | 0 );\n\t\t\ttriangles.push( p.i / dim | 0 );\n\t\t\ttriangles.push( b.i / dim | 0 );\n\n\t\t\t// remove two nodes involved\n\t\t\tremoveNode( p );\n\t\t\tremoveNode( p.next );\n\n\t\t\tp = start = b;\n\n\t\t}\n\n\t\tp = p.next;\n\n\t} while ( p !== start );\n\n\treturn filterPoints( p );\n\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut( start, triangles, dim, minX, minY, invSize ) {\n\n\t// look for a valid diagonal that divides the polygon into two\n\tlet a = start;\n\tdo {\n\n\t\tlet b = a.next.next;\n\t\twhile ( b !== a.prev ) {\n\n\t\t\tif ( a.i !== b.i && isValidDiagonal( a, b ) ) {\n\n\t\t\t\t// split the polygon in two by the diagonal\n\t\t\t\tlet c = splitPolygon( a, b );\n\n\t\t\t\t// filter colinear points around the cuts\n\t\t\t\ta = filterPoints( a, a.next );\n\t\t\t\tc = filterPoints( c, c.next );\n\n\t\t\t\t// run earcut on each half\n\t\t\t\tearcutLinked( a, triangles, dim, minX, minY, invSize, 0 );\n\t\t\t\tearcutLinked( c, triangles, dim, minX, minY, invSize, 0 );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tb = b.next;\n\n\t\t}\n\n\t\ta = a.next;\n\n\t} while ( a !== start );\n\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles( data, holeIndices, outerNode, dim ) {\n\n\tconst queue = [];\n\tlet i, len, start, end, list;\n\n\tfor ( i = 0, len = holeIndices.length; i < len; i ++ ) {\n\n\t\tstart = holeIndices[ i ] * dim;\n\t\tend = i < len - 1 ? holeIndices[ i + 1 ] * dim : data.length;\n\t\tlist = linkedList( data, start, end, dim, false );\n\t\tif ( list === list.next ) list.steiner = true;\n\t\tqueue.push( getLeftmost( list ) );\n\n\t}\n\n\tqueue.sort( compareX );\n\n\t// process holes from left to right\n\tfor ( i = 0; i < queue.length; i ++ ) {\n\n\t\touterNode = eliminateHole( queue[ i ], outerNode );\n\n\t}\n\n\treturn outerNode;\n\n}\n\nfunction compareX( a, b ) {\n\n\treturn a.x - b.x;\n\n}\n\n// find a bridge between vertices that connects hole with an outer ring and link it\nfunction eliminateHole( hole, outerNode ) {\n\n\tconst bridge = findHoleBridge( hole, outerNode );\n\tif ( ! bridge ) {\n\n\t\treturn outerNode;\n\n\t}\n\n\tconst bridgeReverse = splitPolygon( bridge, hole );\n\n\t// filter collinear points around the cuts\n\tfilterPoints( bridgeReverse, bridgeReverse.next );\n\treturn filterPoints( bridge, bridge.next );\n\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge( hole, outerNode ) {\n\n\tlet p = outerNode,\n\t\tqx = - Infinity,\n\t\tm;\n\n\tconst hx = hole.x, hy = hole.y;\n\n\t// find a segment intersected by a ray from the hole's leftmost point to the left;\n\t// segment's endpoint with lesser x will be potential connection point\n\tdo {\n\n\t\tif ( hy <= p.y && hy >= p.next.y && p.next.y !== p.y ) {\n\n\t\t\tconst x = p.x + ( hy - p.y ) * ( p.next.x - p.x ) / ( p.next.y - p.y );\n\t\t\tif ( x <= hx && x > qx ) {\n\n\t\t\t\tqx = x;\n\t\t\t\tm = p.x < p.next.x ? p : p.next;\n\t\t\t\tif ( x === hx ) return m; // hole touches outer segment; pick leftmost endpoint\n\n\t\t\t}\n\n\t\t}\n\n\t\tp = p.next;\n\n\t} while ( p !== outerNode );\n\n\tif ( ! m ) return null;\n\n\t// look for points inside the triangle of hole point, segment intersection and endpoint;\n\t// if there are no points found, we have a valid connection;\n\t// otherwise choose the point of the minimum angle with the ray as connection point\n\n\tconst stop = m,\n\t\tmx = m.x,\n\t\tmy = m.y;\n\tlet tanMin = Infinity, tan;\n\n\tp = m;\n\n\tdo {\n\n\t\tif ( hx >= p.x && p.x >= mx && hx !== p.x &&\n\t\t\t\tpointInTriangle( hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y ) ) {\n\n\t\t\ttan = Math.abs( hy - p.y ) / ( hx - p.x ); // tangential\n\n\t\t\tif ( locallyInside( p, hole ) && ( tan < tanMin || ( tan === tanMin && ( p.x > m.x || ( p.x === m.x && sectorContainsSector( m, p ) ) ) ) ) ) {\n\n\t\t\t\tm = p;\n\t\t\t\ttanMin = tan;\n\n\t\t\t}\n\n\t\t}\n\n\t\tp = p.next;\n\n\t} while ( p !== stop );\n\n\treturn m;\n\n}\n\n// whether sector in vertex m contains sector in vertex p in the same coordinates\nfunction sectorContainsSector( m, p ) {\n\n\treturn area( m.prev, m, p.prev ) < 0 && area( p.next, m, m.next ) < 0;\n\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve( start, minX, minY, invSize ) {\n\n\tlet p = start;\n\tdo {\n\n\t\tif ( p.z === 0 ) p.z = zOrder( p.x, p.y, minX, minY, invSize );\n\t\tp.prevZ = p.prev;\n\t\tp.nextZ = p.next;\n\t\tp = p.next;\n\n\t} while ( p !== start );\n\n\tp.prevZ.nextZ = null;\n\tp.prevZ = null;\n\n\tsortLinked( p );\n\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked( list ) {\n\n\tlet i, p, q, e, tail, numMerges, pSize, qSize,\n\t\tinSize = 1;\n\n\tdo {\n\n\t\tp = list;\n\t\tlist = null;\n\t\ttail = null;\n\t\tnumMerges = 0;\n\n\t\twhile ( p ) {\n\n\t\t\tnumMerges ++;\n\t\t\tq = p;\n\t\t\tpSize = 0;\n\t\t\tfor ( i = 0; i < inSize; i ++ ) {\n\n\t\t\t\tpSize ++;\n\t\t\t\tq = q.nextZ;\n\t\t\t\tif ( ! q ) break;\n\n\t\t\t}\n\n\t\t\tqSize = inSize;\n\n\t\t\twhile ( pSize > 0 || ( qSize > 0 && q ) ) {\n\n\t\t\t\tif ( pSize !== 0 && ( qSize === 0 || ! q || p.z <= q.z ) ) {\n\n\t\t\t\t\te = p;\n\t\t\t\t\tp = p.nextZ;\n\t\t\t\t\tpSize --;\n\n\t\t\t\t} else {\n\n\t\t\t\t\te = q;\n\t\t\t\t\tq = q.nextZ;\n\t\t\t\t\tqSize --;\n\n\t\t\t\t}\n\n\t\t\t\tif ( tail ) tail.nextZ = e;\n\t\t\t\telse list = e;\n\n\t\t\t\te.prevZ = tail;\n\t\t\t\ttail = e;\n\n\t\t\t}\n\n\t\t\tp = q;\n\n\t\t}\n\n\t\ttail.nextZ = null;\n\t\tinSize *= 2;\n\n\t} while ( numMerges > 1 );\n\n\treturn list;\n\n}\n\n// z-order of a point given coords and inverse of the longer side of data bbox\nfunction zOrder( x, y, minX, minY, invSize ) {\n\n\t// coords are transformed into non-negative 15-bit integer range\n\tx = ( x - minX ) * invSize | 0;\n\ty = ( y - minY ) * invSize | 0;\n\n\tx = ( x | ( x << 8 ) ) & 0x00FF00FF;\n\tx = ( x | ( x << 4 ) ) & 0x0F0F0F0F;\n\tx = ( x | ( x << 2 ) ) & 0x33333333;\n\tx = ( x | ( x << 1 ) ) & 0x55555555;\n\n\ty = ( y | ( y << 8 ) ) & 0x00FF00FF;\n\ty = ( y | ( y << 4 ) ) & 0x0F0F0F0F;\n\ty = ( y | ( y << 2 ) ) & 0x33333333;\n\ty = ( y | ( y << 1 ) ) & 0x55555555;\n\n\treturn x | ( y << 1 );\n\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost( start ) {\n\n\tlet p = start,\n\t\tleftmost = start;\n\tdo {\n\n\t\tif ( p.x < leftmost.x || ( p.x === leftmost.x && p.y < leftmost.y ) ) leftmost = p;\n\t\tp = p.next;\n\n\t} while ( p !== start );\n\n\treturn leftmost;\n\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle( ax, ay, bx, by, cx, cy, px, py ) {\n\n\treturn ( cx - px ) * ( ay - py ) >= ( ax - px ) * ( cy - py ) &&\n           ( ax - px ) * ( by - py ) >= ( bx - px ) * ( ay - py ) &&\n           ( bx - px ) * ( cy - py ) >= ( cx - px ) * ( by - py );\n\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal( a, b ) {\n\n\treturn a.next.i !== b.i && a.prev.i !== b.i && ! intersectsPolygon( a, b ) && // dones't intersect other edges\n           ( locallyInside( a, b ) && locallyInside( b, a ) && middleInside( a, b ) && // locally visible\n            ( area( a.prev, a, b.prev ) || area( a, b.prev, b ) ) || // does not create opposite-facing sectors\n            equals( a, b ) && area( a.prev, a, a.next ) > 0 && area( b.prev, b, b.next ) > 0 ); // special zero-length case\n\n}\n\n// signed area of a triangle\nfunction area( p, q, r ) {\n\n\treturn ( q.y - p.y ) * ( r.x - q.x ) - ( q.x - p.x ) * ( r.y - q.y );\n\n}\n\n// check if two points are equal\nfunction equals( p1, p2 ) {\n\n\treturn p1.x === p2.x && p1.y === p2.y;\n\n}\n\n// check if two segments intersect\nfunction intersects( p1, q1, p2, q2 ) {\n\n\tconst o1 = sign( area( p1, q1, p2 ) );\n\tconst o2 = sign( area( p1, q1, q2 ) );\n\tconst o3 = sign( area( p2, q2, p1 ) );\n\tconst o4 = sign( area( p2, q2, q1 ) );\n\n\tif ( o1 !== o2 && o3 !== o4 ) return true; // general case\n\n\tif ( o1 === 0 && onSegment( p1, p2, q1 ) ) return true; // p1, q1 and p2 are collinear and p2 lies on p1q1\n\tif ( o2 === 0 && onSegment( p1, q2, q1 ) ) return true; // p1, q1 and q2 are collinear and q2 lies on p1q1\n\tif ( o3 === 0 && onSegment( p2, p1, q2 ) ) return true; // p2, q2 and p1 are collinear and p1 lies on p2q2\n\tif ( o4 === 0 && onSegment( p2, q1, q2 ) ) return true; // p2, q2 and q1 are collinear and q1 lies on p2q2\n\n\treturn false;\n\n}\n\n// for collinear points p, q, r, check if point q lies on segment pr\nfunction onSegment( p, q, r ) {\n\n\treturn q.x <= Math.max( p.x, r.x ) && q.x >= Math.min( p.x, r.x ) && q.y <= Math.max( p.y, r.y ) && q.y >= Math.min( p.y, r.y );\n\n}\n\nfunction sign( num ) {\n\n\treturn num > 0 ? 1 : num < 0 ? - 1 : 0;\n\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon( a, b ) {\n\n\tlet p = a;\n\tdo {\n\n\t\tif ( p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n\t\t\tintersects( p, p.next, a, b ) ) return true;\n\t\tp = p.next;\n\n\t} while ( p !== a );\n\n\treturn false;\n\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside( a, b ) {\n\n\treturn area( a.prev, a, a.next ) < 0 ?\n\t\tarea( a, b, a.next ) >= 0 && area( a, a.prev, b ) >= 0 :\n\t\tarea( a, b, a.prev ) < 0 || area( a, a.next, b ) < 0;\n\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside( a, b ) {\n\n\tlet p = a,\n\t\tinside = false;\n\tconst px = ( a.x + b.x ) / 2,\n\t\tpy = ( a.y + b.y ) / 2;\n\tdo {\n\n\t\tif ( ( ( p.y > py ) !== ( p.next.y > py ) ) && p.next.y !== p.y &&\n\t\t\t( px < ( p.next.x - p.x ) * ( py - p.y ) / ( p.next.y - p.y ) + p.x ) )\n\t\t\tinside = ! inside;\n\t\tp = p.next;\n\n\t} while ( p !== a );\n\n\treturn inside;\n\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon( a, b ) {\n\n\tconst a2 = new Node( a.i, a.x, a.y ),\n\t\tb2 = new Node( b.i, b.x, b.y ),\n\t\tan = a.next,\n\t\tbp = b.prev;\n\n\ta.next = b;\n\tb.prev = a;\n\n\ta2.next = an;\n\tan.prev = a2;\n\n\tb2.next = a2;\n\ta2.prev = b2;\n\n\tbp.next = b2;\n\tb2.prev = bp;\n\n\treturn b2;\n\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode( i, x, y, last ) {\n\n\tconst p = new Node( i, x, y );\n\n\tif ( ! last ) {\n\n\t\tp.prev = p;\n\t\tp.next = p;\n\n\t} else {\n\n\t\tp.next = last.next;\n\t\tp.prev = last;\n\t\tlast.next.prev = p;\n\t\tlast.next = p;\n\n\t}\n\n\treturn p;\n\n}\n\nfunction removeNode( p ) {\n\n\tp.next.prev = p.prev;\n\tp.prev.next = p.next;\n\n\tif ( p.prevZ ) p.prevZ.nextZ = p.nextZ;\n\tif ( p.nextZ ) p.nextZ.prevZ = p.prevZ;\n\n}\n\nfunction Node( i, x, y ) {\n\n\t// vertex index in coordinates array\n\tthis.i = i;\n\n\t// vertex coordinates\n\tthis.x = x;\n\tthis.y = y;\n\n\t// previous and next vertex nodes in a polygon ring\n\tthis.prev = null;\n\tthis.next = null;\n\n\t// z-order curve value\n\tthis.z = 0;\n\n\t// previous and next nodes in z-order\n\tthis.prevZ = null;\n\tthis.nextZ = null;\n\n\t// indicates whether this is a steiner point\n\tthis.steiner = false;\n\n}\n\nfunction signedArea( data, start, end, dim ) {\n\n\tlet sum = 0;\n\tfor ( let i = start, j = end - dim; i < end; i += dim ) {\n\n\t\tsum += ( data[ j ] - data[ i ] ) * ( data[ i + 1 ] + data[ j + 1 ] );\n\t\tj = i;\n\n\t}\n\n\treturn sum;\n\n}\n\nclass ShapeUtils {\n\n\t// calculate area of the contour polygon\n\n\tstatic area( contour ) {\n\n\t\tconst n = contour.length;\n\t\tlet a = 0.0;\n\n\t\tfor ( let p = n - 1, q = 0; q < n; p = q ++ ) {\n\n\t\t\ta += contour[ p ].x * contour[ q ].y - contour[ q ].x * contour[ p ].y;\n\n\t\t}\n\n\t\treturn a * 0.5;\n\n\t}\n\n\tstatic isClockWise( pts ) {\n\n\t\treturn ShapeUtils.area( pts ) < 0;\n\n\t}\n\n\tstatic triangulateShape( contour, holes ) {\n\n\t\tconst vertices = []; // flat array of vertices like [ x0,y0, x1,y1, x2,y2, ... ]\n\t\tconst holeIndices = []; // array of hole indices\n\t\tconst faces = []; // final array of vertex indices like [ [ a,b,d ], [ b,c,d ] ]\n\n\t\tremoveDupEndPts( contour );\n\t\taddContour( vertices, contour );\n\n\t\t//\n\n\t\tlet holeIndex = contour.length;\n\n\t\tholes.forEach( removeDupEndPts );\n\n\t\tfor ( let i = 0; i < holes.length; i ++ ) {\n\n\t\t\tholeIndices.push( holeIndex );\n\t\t\tholeIndex += holes[ i ].length;\n\t\t\taddContour( vertices, holes[ i ] );\n\n\t\t}\n\n\t\t//\n\n\t\tconst triangles = Earcut.triangulate( vertices, holeIndices );\n\n\t\t//\n\n\t\tfor ( let i = 0; i < triangles.length; i += 3 ) {\n\n\t\t\tfaces.push( triangles.slice( i, i + 3 ) );\n\n\t\t}\n\n\t\treturn faces;\n\n\t}\n\n}\n\nfunction removeDupEndPts( points ) {\n\n\tconst l = points.length;\n\n\tif ( l > 2 && points[ l - 1 ].equals( points[ 0 ] ) ) {\n\n\t\tpoints.pop();\n\n\t}\n\n}\n\nfunction addContour( vertices, contour ) {\n\n\tfor ( let i = 0; i < contour.length; i ++ ) {\n\n\t\tvertices.push( contour[ i ].x );\n\t\tvertices.push( contour[ i ].y );\n\n\t}\n\n}\n\n/**\n * Creates extruded geometry from a path shape.\n *\n * parameters = {\n *\n *  curveSegments: <int>, // number of points on the curves\n *  steps: <int>, // number of points for z-side extrusions / used for subdividing segments of extrude spline too\n *  depth: <float>, // Depth to extrude the shape\n *\n *  bevelEnabled: <bool>, // turn on bevel\n *  bevelThickness: <float>, // how deep into the original shape bevel goes\n *  bevelSize: <float>, // how far from shape outline (including bevelOffset) is bevel\n *  bevelOffset: <float>, // how far from shape outline does bevel start\n *  bevelSegments: <int>, // number of bevel layers\n *\n *  extrudePath: <THREE.Curve> // curve to extrude shape along\n *\n *  UVGenerator: <Object> // object that provides UV generator functions\n *\n * }\n */\n\n\nclass ExtrudeGeometry extends BufferGeometry {\n\n\tconstructor( shapes = new Shape( [ new Vector2( 0.5, 0.5 ), new Vector2( - 0.5, 0.5 ), new Vector2( - 0.5, - 0.5 ), new Vector2( 0.5, - 0.5 ) ] ), options = {} ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ExtrudeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tshapes: shapes,\n\t\t\toptions: options\n\t\t};\n\n\t\tshapes = Array.isArray( shapes ) ? shapes : [ shapes ];\n\n\t\tconst scope = this;\n\n\t\tconst verticesArray = [];\n\t\tconst uvArray = [];\n\n\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\tconst shape = shapes[ i ];\n\t\t\taddShape( shape );\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( verticesArray, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvArray, 2 ) );\n\n\t\tthis.computeVertexNormals();\n\n\t\t// functions\n\n\t\tfunction addShape( shape ) {\n\n\t\t\tconst placeholder = [];\n\n\t\t\t// options\n\n\t\t\tconst curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\n\t\t\tconst steps = options.steps !== undefined ? options.steps : 1;\n\t\t\tconst depth = options.depth !== undefined ? options.depth : 1;\n\n\t\t\tlet bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true;\n\t\t\tlet bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 0.2;\n\t\t\tlet bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 0.1;\n\t\t\tlet bevelOffset = options.bevelOffset !== undefined ? options.bevelOffset : 0;\n\t\t\tlet bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\n\n\t\t\tconst extrudePath = options.extrudePath;\n\n\t\t\tconst uvgen = options.UVGenerator !== undefined ? options.UVGenerator : WorldUVGenerator;\n\n\t\t\t//\n\n\t\t\tlet extrudePts, extrudeByPath = false;\n\t\t\tlet splineTube, binormal, normal, position2;\n\n\t\t\tif ( extrudePath ) {\n\n\t\t\t\textrudePts = extrudePath.getSpacedPoints( steps );\n\n\t\t\t\textrudeByPath = true;\n\t\t\t\tbevelEnabled = false; // bevels not supported for path extrusion\n\n\t\t\t\t// SETUP TNB variables\n\n\t\t\t\t// TODO1 - have a .isClosed in spline?\n\n\t\t\t\tsplineTube = extrudePath.computeFrenetFrames( steps, false );\n\n\t\t\t\t// console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\n\n\t\t\t\tbinormal = new Vector3();\n\t\t\t\tnormal = new Vector3();\n\t\t\t\tposition2 = new Vector3();\n\n\t\t\t}\n\n\t\t\t// Safeguards if bevels are not enabled\n\n\t\t\tif ( ! bevelEnabled ) {\n\n\t\t\t\tbevelSegments = 0;\n\t\t\t\tbevelThickness = 0;\n\t\t\t\tbevelSize = 0;\n\t\t\t\tbevelOffset = 0;\n\n\t\t\t}\n\n\t\t\t// Variables initialization\n\n\t\t\tconst shapePoints = shape.extractPoints( curveSegments );\n\n\t\t\tlet vertices = shapePoints.shape;\n\t\t\tconst holes = shapePoints.holes;\n\n\t\t\tconst reverse = ! ShapeUtils.isClockWise( vertices );\n\n\t\t\tif ( reverse ) {\n\n\t\t\t\tvertices = vertices.reverse();\n\n\t\t\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe ...\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\n\t\t\t\t\tif ( ShapeUtils.isClockWise( ahole ) ) {\n\n\t\t\t\t\t\tholes[ h ] = ahole.reverse();\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\tconst faces = ShapeUtils.triangulateShape( vertices, holes );\n\n\t\t\t/* Vertices */\n\n\t\t\tconst contour = vertices; // vertices has all points but contour has only points of circumference\n\n\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tconst ahole = holes[ h ];\n\n\t\t\t\tvertices = vertices.concat( ahole );\n\n\t\t\t}\n\n\n\t\t\tfunction scalePt2( pt, vec, size ) {\n\n\t\t\t\tif ( ! vec ) console.error( 'THREE.ExtrudeGeometry: vec does not exist' );\n\n\t\t\t\treturn pt.clone().addScaledVector( vec, size );\n\n\t\t\t}\n\n\t\t\tconst vlen = vertices.length, flen = faces.length;\n\n\n\t\t\t// Find directions for point movement\n\n\n\t\t\tfunction getBevelVec( inPt, inPrev, inNext ) {\n\n\t\t\t\t// computes for inPt the corresponding point inPt' on a new contour\n\t\t\t\t//   shifted by 1 unit (length of normalized vector) to the left\n\t\t\t\t// if we walk along contour clockwise, this new contour is outside the old one\n\t\t\t\t//\n\t\t\t\t// inPt' is the intersection of the two lines parallel to the two\n\t\t\t\t//  adjacent edges of inPt at a distance of 1 unit on the left side.\n\n\t\t\t\tlet v_trans_x, v_trans_y, shrink_by; // resulting translation vector for inPt\n\n\t\t\t\t// good reading for geometry algorithms (here: line-line intersection)\n\t\t\t\t// http://geomalgorithms.com/a05-_intersect-1.html\n\n\t\t\t\tconst v_prev_x = inPt.x - inPrev.x,\n\t\t\t\t\tv_prev_y = inPt.y - inPrev.y;\n\t\t\t\tconst v_next_x = inNext.x - inPt.x,\n\t\t\t\t\tv_next_y = inNext.y - inPt.y;\n\n\t\t\t\tconst v_prev_lensq = ( v_prev_x * v_prev_x + v_prev_y * v_prev_y );\n\n\t\t\t\t// check for collinear edges\n\t\t\t\tconst collinear0 = ( v_prev_x * v_next_y - v_prev_y * v_next_x );\n\n\t\t\t\tif ( Math.abs( collinear0 ) > Number.EPSILON ) {\n\n\t\t\t\t\t// not collinear\n\n\t\t\t\t\t// length of vectors for normalizing\n\n\t\t\t\t\tconst v_prev_len = Math.sqrt( v_prev_lensq );\n\t\t\t\t\tconst v_next_len = Math.sqrt( v_next_x * v_next_x + v_next_y * v_next_y );\n\n\t\t\t\t\t// shift adjacent points by unit vectors to the left\n\n\t\t\t\t\tconst ptPrevShift_x = ( inPrev.x - v_prev_y / v_prev_len );\n\t\t\t\t\tconst ptPrevShift_y = ( inPrev.y + v_prev_x / v_prev_len );\n\n\t\t\t\t\tconst ptNextShift_x = ( inNext.x - v_next_y / v_next_len );\n\t\t\t\t\tconst ptNextShift_y = ( inNext.y + v_next_x / v_next_len );\n\n\t\t\t\t\t// scaling factor for v_prev to intersection point\n\n\t\t\t\t\tconst sf = ( ( ptNextShift_x - ptPrevShift_x ) * v_next_y -\n\t\t\t\t\t\t\t( ptNextShift_y - ptPrevShift_y ) * v_next_x ) /\n\t\t\t\t\t\t( v_prev_x * v_next_y - v_prev_y * v_next_x );\n\n\t\t\t\t\t// vector from inPt to intersection point\n\n\t\t\t\t\tv_trans_x = ( ptPrevShift_x + v_prev_x * sf - inPt.x );\n\t\t\t\t\tv_trans_y = ( ptPrevShift_y + v_prev_y * sf - inPt.y );\n\n\t\t\t\t\t// Don't normalize!, otherwise sharp corners become ugly\n\t\t\t\t\t//  but prevent crazy spikes\n\t\t\t\t\tconst v_trans_lensq = ( v_trans_x * v_trans_x + v_trans_y * v_trans_y );\n\t\t\t\t\tif ( v_trans_lensq <= 2 ) {\n\n\t\t\t\t\t\treturn new Vector2( v_trans_x, v_trans_y );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_trans_lensq / 2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// handle special case of collinear edges\n\n\t\t\t\t\tlet direction_eq = false; // assumes: opposite\n\n\t\t\t\t\tif ( v_prev_x > Number.EPSILON ) {\n\n\t\t\t\t\t\tif ( v_next_x > Number.EPSILON ) {\n\n\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( v_prev_x < - Number.EPSILON ) {\n\n\t\t\t\t\t\t\tif ( v_next_x < - Number.EPSILON ) {\n\n\t\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tif ( Math.sign( v_prev_y ) === Math.sign( v_next_y ) ) {\n\n\t\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( direction_eq ) {\n\n\t\t\t\t\t\t// console.log(\"Warning: lines are a straight sequence\");\n\t\t\t\t\t\tv_trans_x = - v_prev_y;\n\t\t\t\t\t\tv_trans_y = v_prev_x;\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// console.log(\"Warning: lines are a straight spike\");\n\t\t\t\t\t\tv_trans_x = v_prev_x;\n\t\t\t\t\t\tv_trans_y = v_prev_y;\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq / 2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn new Vector2( v_trans_x / shrink_by, v_trans_y / shrink_by );\n\n\t\t\t}\n\n\n\t\t\tconst contourMovements = [];\n\n\t\t\tfor ( let i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\n\n\t\t\t\tif ( j === il ) j = 0;\n\t\t\t\tif ( k === il ) k = 0;\n\n\t\t\t\t//  (j)---(i)---(k)\n\t\t\t\t// console.log('i,j,k', i, j , k)\n\n\t\t\t\tcontourMovements[ i ] = getBevelVec( contour[ i ], contour[ j ], contour[ k ] );\n\n\t\t\t}\n\n\t\t\tconst holesMovements = [];\n\t\t\tlet oneHoleMovements, verticesMovements = contourMovements.concat();\n\n\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tconst ahole = holes[ h ];\n\n\t\t\t\toneHoleMovements = [];\n\n\t\t\t\tfor ( let i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\n\n\t\t\t\t\tif ( j === il ) j = 0;\n\t\t\t\t\tif ( k === il ) k = 0;\n\n\t\t\t\t\t//  (j)---(i)---(k)\n\t\t\t\t\toneHoleMovements[ i ] = getBevelVec( ahole[ i ], ahole[ j ], ahole[ k ] );\n\n\t\t\t\t}\n\n\t\t\t\tholesMovements.push( oneHoleMovements );\n\t\t\t\tverticesMovements = verticesMovements.concat( oneHoleMovements );\n\n\t\t\t}\n\n\n\t\t\t// Loop bevelSegments, 1 for the front, 1 for the back\n\n\t\t\tfor ( let b = 0; b < bevelSegments; b ++ ) {\n\n\t\t\t\t//for ( b = bevelSegments; b > 0; b -- ) {\n\n\t\t\t\tconst t = b / bevelSegments;\n\t\t\t\tconst z = bevelThickness * Math.cos( t * Math.PI / 2 );\n\t\t\t\tconst bs = bevelSize * Math.sin( t * Math.PI / 2 ) + bevelOffset;\n\n\t\t\t\t// contract shape\n\n\t\t\t\tfor ( let i = 0, il = contour.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst vert = scalePt2( contour[ i ], contourMovements[ i ], bs );\n\n\t\t\t\t\tv( vert.x, vert.y, - z );\n\n\t\t\t\t}\n\n\t\t\t\t// expand holes\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\t\t\t\t\toneHoleMovements = holesMovements[ h ];\n\n\t\t\t\t\tfor ( let i = 0, il = ahole.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst vert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\n\n\t\t\t\t\t\tv( vert.x, vert.y, - z );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst bs = bevelSize + bevelOffset;\n\n\t\t\t// Back facing vertices\n\n\t\t\tfor ( let i = 0; i < vlen; i ++ ) {\n\n\t\t\t\tconst vert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\n\n\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\tv( vert.x, vert.y, 0 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\n\n\t\t\t\t\tnormal.copy( splineTube.normals[ 0 ] ).multiplyScalar( vert.x );\n\t\t\t\t\tbinormal.copy( splineTube.binormals[ 0 ] ).multiplyScalar( vert.y );\n\n\t\t\t\t\tposition2.copy( extrudePts[ 0 ] ).add( normal ).add( binormal );\n\n\t\t\t\t\tv( position2.x, position2.y, position2.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Add stepped vertices...\n\t\t\t// Including front facing vertices\n\n\t\t\tfor ( let s = 1; s <= steps; s ++ ) {\n\n\t\t\t\tfor ( let i = 0; i < vlen; i ++ ) {\n\n\t\t\t\t\tconst vert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\n\n\t\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\t\tv( vert.x, vert.y, depth / steps * s );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\n\n\t\t\t\t\t\tnormal.copy( splineTube.normals[ s ] ).multiplyScalar( vert.x );\n\t\t\t\t\t\tbinormal.copy( splineTube.binormals[ s ] ).multiplyScalar( vert.y );\n\n\t\t\t\t\t\tposition2.copy( extrudePts[ s ] ).add( normal ).add( binormal );\n\n\t\t\t\t\t\tv( position2.x, position2.y, position2.z );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\t// Add bevel segments planes\n\n\t\t\t//for ( b = 1; b <= bevelSegments; b ++ ) {\n\t\t\tfor ( let b = bevelSegments - 1; b >= 0; b -- ) {\n\n\t\t\t\tconst t = b / bevelSegments;\n\t\t\t\tconst z = bevelThickness * Math.cos( t * Math.PI / 2 );\n\t\t\t\tconst bs = bevelSize * Math.sin( t * Math.PI / 2 ) + bevelOffset;\n\n\t\t\t\t// contract shape\n\n\t\t\t\tfor ( let i = 0, il = contour.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst vert = scalePt2( contour[ i ], contourMovements[ i ], bs );\n\t\t\t\t\tv( vert.x, vert.y, depth + z );\n\n\t\t\t\t}\n\n\t\t\t\t// expand holes\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\t\t\t\t\toneHoleMovements = holesMovements[ h ];\n\n\t\t\t\t\tfor ( let i = 0, il = ahole.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst vert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\n\n\t\t\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\t\t\tv( vert.x, vert.y, depth + z );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tv( vert.x, vert.y + extrudePts[ steps - 1 ].y, extrudePts[ steps - 1 ].x + z );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t/* Faces */\n\n\t\t\t// Top and bottom faces\n\n\t\t\tbuildLidFaces();\n\n\t\t\t// Sides faces\n\n\t\t\tbuildSideFaces();\n\n\n\t\t\t/////  Internal functions\n\n\t\t\tfunction buildLidFaces() {\n\n\t\t\t\tconst start = verticesArray.length / 3;\n\n\t\t\t\tif ( bevelEnabled ) {\n\n\t\t\t\t\tlet layer = 0; // steps + 1\n\t\t\t\t\tlet offset = vlen * layer;\n\n\t\t\t\t\t// Bottom faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 2 ] + offset, face[ 1 ] + offset, face[ 0 ] + offset );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlayer = steps + bevelSegments * 2;\n\t\t\t\t\toffset = vlen * layer;\n\n\t\t\t\t\t// Top faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 0 ] + offset, face[ 1 ] + offset, face[ 2 ] + offset );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Bottom faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 2 ], face[ 1 ], face[ 0 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Top faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 0 ] + vlen * steps, face[ 1 ] + vlen * steps, face[ 2 ] + vlen * steps );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tscope.addGroup( start, verticesArray.length / 3 - start, 0 );\n\n\t\t\t}\n\n\t\t\t// Create faces for the z-sides of the shape\n\n\t\t\tfunction buildSideFaces() {\n\n\t\t\t\tconst start = verticesArray.length / 3;\n\t\t\t\tlet layeroffset = 0;\n\t\t\t\tsidewalls( contour, layeroffset );\n\t\t\t\tlayeroffset += contour.length;\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\t\t\t\t\tsidewalls( ahole, layeroffset );\n\n\t\t\t\t\t//, true\n\t\t\t\t\tlayeroffset += ahole.length;\n\n\t\t\t\t}\n\n\n\t\t\t\tscope.addGroup( start, verticesArray.length / 3 - start, 1 );\n\n\n\t\t\t}\n\n\t\t\tfunction sidewalls( contour, layeroffset ) {\n\n\t\t\t\tlet i = contour.length;\n\n\t\t\t\twhile ( -- i >= 0 ) {\n\n\t\t\t\t\tconst j = i;\n\t\t\t\t\tlet k = i - 1;\n\t\t\t\t\tif ( k < 0 ) k = contour.length - 1;\n\n\t\t\t\t\t//console.log('b', i,j, i-1, k,vertices.length);\n\n\t\t\t\t\tfor ( let s = 0, sl = ( steps + bevelSegments * 2 ); s < sl; s ++ ) {\n\n\t\t\t\t\t\tconst slen1 = vlen * s;\n\t\t\t\t\t\tconst slen2 = vlen * ( s + 1 );\n\n\t\t\t\t\t\tconst a = layeroffset + j + slen1,\n\t\t\t\t\t\t\tb = layeroffset + k + slen1,\n\t\t\t\t\t\t\tc = layeroffset + k + slen2,\n\t\t\t\t\t\t\td = layeroffset + j + slen2;\n\n\t\t\t\t\t\tf4( a, b, c, d );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfunction v( x, y, z ) {\n\n\t\t\t\tplaceholder.push( x );\n\t\t\t\tplaceholder.push( y );\n\t\t\t\tplaceholder.push( z );\n\n\t\t\t}\n\n\n\t\t\tfunction f3( a, b, c ) {\n\n\t\t\t\taddVertex( a );\n\t\t\t\taddVertex( b );\n\t\t\t\taddVertex( c );\n\n\t\t\t\tconst nextIndex = verticesArray.length / 3;\n\t\t\t\tconst uvs = uvgen.generateTopUV( scope, verticesArray, nextIndex - 3, nextIndex - 2, nextIndex - 1 );\n\n\t\t\t\taddUV( uvs[ 0 ] );\n\t\t\t\taddUV( uvs[ 1 ] );\n\t\t\t\taddUV( uvs[ 2 ] );\n\n\t\t\t}\n\n\t\t\tfunction f4( a, b, c, d ) {\n\n\t\t\t\taddVertex( a );\n\t\t\t\taddVertex( b );\n\t\t\t\taddVertex( d );\n\n\t\t\t\taddVertex( b );\n\t\t\t\taddVertex( c );\n\t\t\t\taddVertex( d );\n\n\n\t\t\t\tconst nextIndex = verticesArray.length / 3;\n\t\t\t\tconst uvs = uvgen.generateSideWallUV( scope, verticesArray, nextIndex - 6, nextIndex - 3, nextIndex - 2, nextIndex - 1 );\n\n\t\t\t\taddUV( uvs[ 0 ] );\n\t\t\t\taddUV( uvs[ 1 ] );\n\t\t\t\taddUV( uvs[ 3 ] );\n\n\t\t\t\taddUV( uvs[ 1 ] );\n\t\t\t\taddUV( uvs[ 2 ] );\n\t\t\t\taddUV( uvs[ 3 ] );\n\n\t\t\t}\n\n\t\t\tfunction addVertex( index ) {\n\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 0 ] );\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 1 ] );\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 2 ] );\n\n\t\t\t}\n\n\n\t\t\tfunction addUV( vector2 ) {\n\n\t\t\t\tuvArray.push( vector2.x );\n\t\t\t\tuvArray.push( vector2.y );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tconst shapes = this.parameters.shapes;\n\t\tconst options = this.parameters.options;\n\n\t\treturn toJSON$1( shapes, options, data );\n\n\t}\n\n\tstatic fromJSON( data, shapes ) {\n\n\t\tconst geometryShapes = [];\n\n\t\tfor ( let j = 0, jl = data.shapes.length; j < jl; j ++ ) {\n\n\t\t\tconst shape = shapes[ data.shapes[ j ] ];\n\n\t\t\tgeometryShapes.push( shape );\n\n\t\t}\n\n\t\tconst extrudePath = data.options.extrudePath;\n\n\t\tif ( extrudePath !== undefined ) {\n\n\t\t\tdata.options.extrudePath = new Curves[ extrudePath.type ]().fromJSON( extrudePath );\n\n\t\t}\n\n\t\treturn new ExtrudeGeometry( geometryShapes, data.options );\n\n\t}\n\n}\n\nconst WorldUVGenerator = {\n\n\tgenerateTopUV: function ( geometry, vertices, indexA, indexB, indexC ) {\n\n\t\tconst a_x = vertices[ indexA * 3 ];\n\t\tconst a_y = vertices[ indexA * 3 + 1 ];\n\t\tconst b_x = vertices[ indexB * 3 ];\n\t\tconst b_y = vertices[ indexB * 3 + 1 ];\n\t\tconst c_x = vertices[ indexC * 3 ];\n\t\tconst c_y = vertices[ indexC * 3 + 1 ];\n\n\t\treturn [\n\t\t\tnew Vector2( a_x, a_y ),\n\t\t\tnew Vector2( b_x, b_y ),\n\t\t\tnew Vector2( c_x, c_y )\n\t\t];\n\n\t},\n\n\tgenerateSideWallUV: function ( geometry, vertices, indexA, indexB, indexC, indexD ) {\n\n\t\tconst a_x = vertices[ indexA * 3 ];\n\t\tconst a_y = vertices[ indexA * 3 + 1 ];\n\t\tconst a_z = vertices[ indexA * 3 + 2 ];\n\t\tconst b_x = vertices[ indexB * 3 ];\n\t\tconst b_y = vertices[ indexB * 3 + 1 ];\n\t\tconst b_z = vertices[ indexB * 3 + 2 ];\n\t\tconst c_x = vertices[ indexC * 3 ];\n\t\tconst c_y = vertices[ indexC * 3 + 1 ];\n\t\tconst c_z = vertices[ indexC * 3 + 2 ];\n\t\tconst d_x = vertices[ indexD * 3 ];\n\t\tconst d_y = vertices[ indexD * 3 + 1 ];\n\t\tconst d_z = vertices[ indexD * 3 + 2 ];\n\n\t\tif ( Math.abs( a_y - b_y ) < Math.abs( a_x - b_x ) ) {\n\n\t\t\treturn [\n\t\t\t\tnew Vector2( a_x, 1 - a_z ),\n\t\t\t\tnew Vector2( b_x, 1 - b_z ),\n\t\t\t\tnew Vector2( c_x, 1 - c_z ),\n\t\t\t\tnew Vector2( d_x, 1 - d_z )\n\t\t\t];\n\n\t\t} else {\n\n\t\t\treturn [\n\t\t\t\tnew Vector2( a_y, 1 - a_z ),\n\t\t\t\tnew Vector2( b_y, 1 - b_z ),\n\t\t\t\tnew Vector2( c_y, 1 - c_z ),\n\t\t\t\tnew Vector2( d_y, 1 - d_z )\n\t\t\t];\n\n\t\t}\n\n\t}\n\n};\n\nfunction toJSON$1( shapes, options, data ) {\n\n\tdata.shapes = [];\n\n\tif ( Array.isArray( shapes ) ) {\n\n\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\tconst shape = shapes[ i ];\n\n\t\t\tdata.shapes.push( shape.uuid );\n\n\t\t}\n\n\t} else {\n\n\t\tdata.shapes.push( shapes.uuid );\n\n\t}\n\n\tdata.options = Object.assign( {}, options );\n\n\tif ( options.extrudePath !== undefined ) data.options.extrudePath = options.extrudePath.toJSON();\n\n\treturn data;\n\n}\n\nclass IcosahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst t = ( 1 + Math.sqrt( 5 ) ) / 2;\n\n\t\tconst vertices = [\n\t\t\t- 1, t, 0, \t1, t, 0, \t- 1, - t, 0, \t1, - t, 0,\n\t\t\t0, - 1, t, \t0, 1, t,\t0, - 1, - t, \t0, 1, - t,\n\t\t\tt, 0, - 1, \tt, 0, 1, \t- t, 0, - 1, \t- t, 0, 1\n\t\t];\n\n\t\tconst indices = [\n\t\t\t0, 11, 5, \t0, 5, 1, \t0, 1, 7, \t0, 7, 10, \t0, 10, 11,\n\t\t\t1, 5, 9, \t5, 11, 4,\t11, 10, 2,\t10, 7, 6,\t7, 1, 8,\n\t\t\t3, 9, 4, \t3, 4, 2,\t3, 2, 6,\t3, 6, 8,\t3, 8, 9,\n\t\t\t4, 9, 5, \t2, 4, 11,\t6, 2, 10,\t8, 6, 7,\t9, 8, 1\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'IcosahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new IcosahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nclass OctahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst vertices = [\n\t\t\t1, 0, 0, \t- 1, 0, 0,\t0, 1, 0,\n\t\t\t0, - 1, 0, \t0, 0, 1,\t0, 0, - 1\n\t\t];\n\n\t\tconst indices = [\n\t\t\t0, 2, 4,\t0, 4, 3,\t0, 3, 5,\n\t\t\t0, 5, 2,\t1, 2, 5,\t1, 5, 3,\n\t\t\t1, 3, 4,\t1, 4, 2\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'OctahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new OctahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nclass PlaneGeometry extends BufferGeometry {\n\n\tconstructor( width = 1, height = 1, widthSegments = 1, heightSegments = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'PlaneGeometry';\n\n\t\tthis.parameters = {\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments\n\t\t};\n\n\t\tconst width_half = width / 2;\n\t\tconst height_half = height / 2;\n\n\t\tconst gridX = Math.floor( widthSegments );\n\t\tconst gridY = Math.floor( heightSegments );\n\n\t\tconst gridX1 = gridX + 1;\n\t\tconst gridY1 = gridY + 1;\n\n\t\tconst segment_width = width / gridX;\n\t\tconst segment_height = height / gridY;\n\n\t\t//\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\tfor ( let iy = 0; iy < gridY1; iy ++ ) {\n\n\t\t\tconst y = iy * segment_height - height_half;\n\n\t\t\tfor ( let ix = 0; ix < gridX1; ix ++ ) {\n\n\t\t\t\tconst x = ix * segment_width - width_half;\n\n\t\t\t\tvertices.push( x, - y, 0 );\n\n\t\t\t\tnormals.push( 0, 0, 1 );\n\n\t\t\t\tuvs.push( ix / gridX );\n\t\t\t\tuvs.push( 1 - ( iy / gridY ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( let iy = 0; iy < gridY; iy ++ ) {\n\n\t\t\tfor ( let ix = 0; ix < gridX; ix ++ ) {\n\n\t\t\t\tconst a = ix + gridX1 * iy;\n\t\t\t\tconst b = ix + gridX1 * ( iy + 1 );\n\t\t\t\tconst c = ( ix + 1 ) + gridX1 * ( iy + 1 );\n\t\t\t\tconst d = ( ix + 1 ) + gridX1 * iy;\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new PlaneGeometry( data.width, data.height, data.widthSegments, data.heightSegments );\n\n\t}\n\n}\n\nclass RingGeometry extends BufferGeometry {\n\n\tconstructor( innerRadius = 0.5, outerRadius = 1, thetaSegments = 32, phiSegments = 1, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'RingGeometry';\n\n\t\tthis.parameters = {\n\t\t\tinnerRadius: innerRadius,\n\t\t\touterRadius: outerRadius,\n\t\t\tthetaSegments: thetaSegments,\n\t\t\tphiSegments: phiSegments,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tthetaSegments = Math.max( 3, thetaSegments );\n\t\tphiSegments = Math.max( 1, phiSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// some helper variables\n\n\t\tlet radius = innerRadius;\n\t\tconst radiusStep = ( ( outerRadius - innerRadius ) / phiSegments );\n\t\tconst vertex = new Vector3();\n\t\tconst uv = new Vector2();\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let j = 0; j <= phiSegments; j ++ ) {\n\n\t\t\tfor ( let i = 0; i <= thetaSegments; i ++ ) {\n\n\t\t\t\t// values are generate from the inside of the ring to the outside\n\n\t\t\t\tconst segment = thetaStart + i / thetaSegments * thetaLength;\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = radius * Math.cos( segment );\n\t\t\t\tvertex.y = radius * Math.sin( segment );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormals.push( 0, 0, 1 );\n\n\t\t\t\t// uv\n\n\t\t\t\tuv.x = ( vertex.x / outerRadius + 1 ) / 2;\n\t\t\t\tuv.y = ( vertex.y / outerRadius + 1 ) / 2;\n\n\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t}\n\n\t\t\t// increase the radius for next row of vertices\n\n\t\t\tradius += radiusStep;\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let j = 0; j < phiSegments; j ++ ) {\n\n\t\t\tconst thetaSegmentLevel = j * ( thetaSegments + 1 );\n\n\t\t\tfor ( let i = 0; i < thetaSegments; i ++ ) {\n\n\t\t\t\tconst segment = i + thetaSegmentLevel;\n\n\t\t\t\tconst a = segment;\n\t\t\t\tconst b = segment + thetaSegments + 1;\n\t\t\t\tconst c = segment + thetaSegments + 2;\n\t\t\t\tconst d = segment + 1;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new RingGeometry( data.innerRadius, data.outerRadius, data.thetaSegments, data.phiSegments, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass ShapeGeometry extends BufferGeometry {\n\n\tconstructor( shapes = new Shape( [ new Vector2( 0, 0.5 ), new Vector2( - 0.5, - 0.5 ), new Vector2( 0.5, - 0.5 ) ] ), curveSegments = 12 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ShapeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tshapes: shapes,\n\t\t\tcurveSegments: curveSegments\n\t\t};\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tlet groupStart = 0;\n\t\tlet groupCount = 0;\n\n\t\t// allow single and array values for \"shapes\" parameter\n\n\t\tif ( Array.isArray( shapes ) === false ) {\n\n\t\t\taddShape( shapes );\n\n\t\t} else {\n\n\t\t\tfor ( let i = 0; i < shapes.length; i ++ ) {\n\n\t\t\t\taddShape( shapes[ i ] );\n\n\t\t\t\tthis.addGroup( groupStart, groupCount, i ); // enables MultiMaterial support\n\n\t\t\t\tgroupStart += groupCount;\n\t\t\t\tgroupCount = 0;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\n\t\t// helper functions\n\n\t\tfunction addShape( shape ) {\n\n\t\t\tconst indexOffset = vertices.length / 3;\n\t\t\tconst points = shape.extractPoints( curveSegments );\n\n\t\t\tlet shapeVertices = points.shape;\n\t\t\tconst shapeHoles = points.holes;\n\n\t\t\t// check direction of vertices\n\n\t\t\tif ( ShapeUtils.isClockWise( shapeVertices ) === false ) {\n\n\t\t\t\tshapeVertices = shapeVertices.reverse();\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, l = shapeHoles.length; i < l; i ++ ) {\n\n\t\t\t\tconst shapeHole = shapeHoles[ i ];\n\n\t\t\t\tif ( ShapeUtils.isClockWise( shapeHole ) === true ) {\n\n\t\t\t\t\tshapeHoles[ i ] = shapeHole.reverse();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst faces = ShapeUtils.triangulateShape( shapeVertices, shapeHoles );\n\n\t\t\t// join vertices of inner and outer paths to a single array\n\n\t\t\tfor ( let i = 0, l = shapeHoles.length; i < l; i ++ ) {\n\n\t\t\t\tconst shapeHole = shapeHoles[ i ];\n\t\t\t\tshapeVertices = shapeVertices.concat( shapeHole );\n\n\t\t\t}\n\n\t\t\t// vertices, normals, uvs\n\n\t\t\tfor ( let i = 0, l = shapeVertices.length; i < l; i ++ ) {\n\n\t\t\t\tconst vertex = shapeVertices[ i ];\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, 0 );\n\t\t\t\tnormals.push( 0, 0, 1 );\n\t\t\t\tuvs.push( vertex.x, vertex.y ); // world uvs\n\n\t\t\t}\n\n\t\t\t// indices\n\n\t\t\tfor ( let i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\t\t\tconst face = faces[ i ];\n\n\t\t\t\tconst a = face[ 0 ] + indexOffset;\n\t\t\t\tconst b = face[ 1 ] + indexOffset;\n\t\t\t\tconst c = face[ 2 ] + indexOffset;\n\n\t\t\t\tindices.push( a, b, c );\n\t\t\t\tgroupCount += 3;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tconst shapes = this.parameters.shapes;\n\n\t\treturn toJSON( shapes, data );\n\n\t}\n\n\tstatic fromJSON( data, shapes ) {\n\n\t\tconst geometryShapes = [];\n\n\t\tfor ( let j = 0, jl = data.shapes.length; j < jl; j ++ ) {\n\n\t\t\tconst shape = shapes[ data.shapes[ j ] ];\n\n\t\t\tgeometryShapes.push( shape );\n\n\t\t}\n\n\t\treturn new ShapeGeometry( geometryShapes, data.curveSegments );\n\n\t}\n\n}\n\nfunction toJSON( shapes, data ) {\n\n\tdata.shapes = [];\n\n\tif ( Array.isArray( shapes ) ) {\n\n\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\tconst shape = shapes[ i ];\n\n\t\t\tdata.shapes.push( shape.uuid );\n\n\t\t}\n\n\t} else {\n\n\t\tdata.shapes.push( shapes.uuid );\n\n\t}\n\n\treturn data;\n\n}\n\nclass SphereGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, widthSegments = 32, heightSegments = 16, phiStart = 0, phiLength = Math.PI * 2, thetaStart = 0, thetaLength = Math.PI ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'SphereGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\tphiStart: phiStart,\n\t\t\tphiLength: phiLength,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\twidthSegments = Math.max( 3, Math.floor( widthSegments ) );\n\t\theightSegments = Math.max( 2, Math.floor( heightSegments ) );\n\n\t\tconst thetaEnd = Math.min( thetaStart + thetaLength, Math.PI );\n\n\t\tlet index = 0;\n\t\tconst grid = [];\n\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let iy = 0; iy <= heightSegments; iy ++ ) {\n\n\t\t\tconst verticesRow = [];\n\n\t\t\tconst v = iy / heightSegments;\n\n\t\t\t// special case for the poles\n\n\t\t\tlet uOffset = 0;\n\n\t\t\tif ( iy === 0 && thetaStart === 0 ) {\n\n\t\t\t\tuOffset = 0.5 / widthSegments;\n\n\t\t\t} else if ( iy === heightSegments && thetaEnd === Math.PI ) {\n\n\t\t\t\tuOffset = - 0.5 / widthSegments;\n\n\t\t\t}\n\n\t\t\tfor ( let ix = 0; ix <= widthSegments; ix ++ ) {\n\n\t\t\t\tconst u = ix / widthSegments;\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = - radius * Math.cos( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\n\t\t\t\tvertex.y = radius * Math.cos( thetaStart + v * thetaLength );\n\t\t\t\tvertex.z = radius * Math.sin( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormal.copy( vertex ).normalize();\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( u + uOffset, 1 - v );\n\n\t\t\t\tverticesRow.push( index ++ );\n\n\t\t\t}\n\n\t\t\tgrid.push( verticesRow );\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let iy = 0; iy < heightSegments; iy ++ ) {\n\n\t\t\tfor ( let ix = 0; ix < widthSegments; ix ++ ) {\n\n\t\t\t\tconst a = grid[ iy ][ ix + 1 ];\n\t\t\t\tconst b = grid[ iy ][ ix ];\n\t\t\t\tconst c = grid[ iy + 1 ][ ix ];\n\t\t\t\tconst d = grid[ iy + 1 ][ ix + 1 ];\n\n\t\t\t\tif ( iy !== 0 || thetaStart > 0 ) indices.push( a, b, d );\n\t\t\t\tif ( iy !== heightSegments - 1 || thetaEnd < Math.PI ) indices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new SphereGeometry( data.radius, data.widthSegments, data.heightSegments, data.phiStart, data.phiLength, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass TetrahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst vertices = [\n\t\t\t1, 1, 1, \t- 1, - 1, 1, \t- 1, 1, - 1, \t1, - 1, - 1\n\t\t];\n\n\t\tconst indices = [\n\t\t\t2, 1, 0, \t0, 3, 2,\t1, 3, 0,\t2, 3, 1\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'TetrahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new TetrahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nclass TorusGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, tube = 0.4, radialSegments = 12, tubularSegments = 48, arc = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'TorusGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\ttube: tube,\n\t\t\tradialSegments: radialSegments,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tarc: arc\n\t\t};\n\n\t\tradialSegments = Math.floor( radialSegments );\n\t\ttubularSegments = Math.floor( tubularSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tconst center = new Vector3();\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let j = 0; j <= radialSegments; j ++ ) {\n\n\t\t\tfor ( let i = 0; i <= tubularSegments; i ++ ) {\n\n\t\t\t\tconst u = i / tubularSegments * arc;\n\t\t\t\tconst v = j / radialSegments * Math.PI * 2;\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = ( radius + tube * Math.cos( v ) ) * Math.cos( u );\n\t\t\t\tvertex.y = ( radius + tube * Math.cos( v ) ) * Math.sin( u );\n\t\t\t\tvertex.z = tube * Math.sin( v );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tcenter.x = radius * Math.cos( u );\n\t\t\t\tcenter.y = radius * Math.sin( u );\n\t\t\t\tnormal.subVectors( vertex, center ).normalize();\n\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( i / tubularSegments );\n\t\t\t\tuvs.push( j / radialSegments );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate indices\n\n\t\tfor ( let j = 1; j <= radialSegments; j ++ ) {\n\n\t\t\tfor ( let i = 1; i <= tubularSegments; i ++ ) {\n\n\t\t\t\t// indices\n\n\t\t\t\tconst a = ( tubularSegments + 1 ) * j + i - 1;\n\t\t\t\tconst b = ( tubularSegments + 1 ) * ( j - 1 ) + i - 1;\n\t\t\t\tconst c = ( tubularSegments + 1 ) * ( j - 1 ) + i;\n\t\t\t\tconst d = ( tubularSegments + 1 ) * j + i;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new TorusGeometry( data.radius, data.tube, data.radialSegments, data.tubularSegments, data.arc );\n\n\t}\n\n}\n\nclass TorusKnotGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, tube = 0.4, tubularSegments = 64, radialSegments = 8, p = 2, q = 3 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'TorusKnotGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\ttube: tube,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tradialSegments: radialSegments,\n\t\t\tp: p,\n\t\t\tq: q\n\t\t};\n\n\t\ttubularSegments = Math.floor( tubularSegments );\n\t\tradialSegments = Math.floor( radialSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\n\t\tconst P1 = new Vector3();\n\t\tconst P2 = new Vector3();\n\n\t\tconst B = new Vector3();\n\t\tconst T = new Vector3();\n\t\tconst N = new Vector3();\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let i = 0; i <= tubularSegments; ++ i ) {\n\n\t\t\t// the radian \"u\" is used to calculate the position on the torus curve of the current tubular segment\n\n\t\t\tconst u = i / tubularSegments * p * Math.PI * 2;\n\n\t\t\t// now we calculate two points. P1 is our current position on the curve, P2 is a little farther ahead.\n\t\t\t// these points are used to create a special \"coordinate space\", which is necessary to calculate the correct vertex positions\n\n\t\t\tcalculatePositionOnCurve( u, p, q, radius, P1 );\n\t\t\tcalculatePositionOnCurve( u + 0.01, p, q, radius, P2 );\n\n\t\t\t// calculate orthonormal basis\n\n\t\t\tT.subVectors( P2, P1 );\n\t\t\tN.addVectors( P2, P1 );\n\t\t\tB.crossVectors( T, N );\n\t\t\tN.crossVectors( B, T );\n\n\t\t\t// normalize B, N. T can be ignored, we don't use it\n\n\t\t\tB.normalize();\n\t\t\tN.normalize();\n\n\t\t\tfor ( let j = 0; j <= radialSegments; ++ j ) {\n\n\t\t\t\t// now calculate the vertices. they are nothing more than an extrusion of the torus curve.\n\t\t\t\t// because we extrude a shape in the xy-plane, there is no need to calculate a z-value.\n\n\t\t\t\tconst v = j / radialSegments * Math.PI * 2;\n\t\t\t\tconst cx = - tube * Math.cos( v );\n\t\t\t\tconst cy = tube * Math.sin( v );\n\n\t\t\t\t// now calculate the final vertex position.\n\t\t\t\t// first we orient the extrusion with our basis vectors, then we add it to the current position on the curve\n\n\t\t\t\tvertex.x = P1.x + ( cx * N.x + cy * B.x );\n\t\t\t\tvertex.y = P1.y + ( cx * N.y + cy * B.y );\n\t\t\t\tvertex.z = P1.z + ( cx * N.z + cy * B.z );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal (P1 is always the center/origin of the extrusion, thus we can use it to calculate the normal)\n\n\t\t\t\tnormal.subVectors( vertex, P1 ).normalize();\n\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( i / tubularSegments );\n\t\t\t\tuvs.push( j / radialSegments );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate indices\n\n\t\tfor ( let j = 1; j <= tubularSegments; j ++ ) {\n\n\t\t\tfor ( let i = 1; i <= radialSegments; i ++ ) {\n\n\t\t\t\t// indices\n\n\t\t\t\tconst a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\n\t\t\t\tconst b = ( radialSegments + 1 ) * j + ( i - 1 );\n\t\t\t\tconst c = ( radialSegments + 1 ) * j + i;\n\t\t\t\tconst d = ( radialSegments + 1 ) * ( j - 1 ) + i;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\t// this function calculates the current position on the torus curve\n\n\t\tfunction calculatePositionOnCurve( u, p, q, radius, position ) {\n\n\t\t\tconst cu = Math.cos( u );\n\t\t\tconst su = Math.sin( u );\n\t\t\tconst quOverP = q / p * u;\n\t\t\tconst cs = Math.cos( quOverP );\n\n\t\t\tposition.x = radius * ( 2 + cs ) * 0.5 * cu;\n\t\t\tposition.y = radius * ( 2 + cs ) * su * 0.5;\n\t\t\tposition.z = radius * Math.sin( quOverP ) * 0.5;\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new TorusKnotGeometry( data.radius, data.tube, data.tubularSegments, data.radialSegments, data.p, data.q );\n\n\t}\n\n}\n\nclass TubeGeometry extends BufferGeometry {\n\n\tconstructor( path = new QuadraticBezierCurve3( new Vector3( - 1, - 1, 0 ), new Vector3( - 1, 1, 0 ), new Vector3( 1, 1, 0 ) ), tubularSegments = 64, radius = 1, radialSegments = 8, closed = false ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'TubeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tpath: path,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tradius: radius,\n\t\t\tradialSegments: radialSegments,\n\t\t\tclosed: closed\n\t\t};\n\n\t\tconst frames = path.computeFrenetFrames( tubularSegments, closed );\n\n\t\t// expose internals\n\n\t\tthis.tangents = frames.tangents;\n\t\tthis.normals = frames.normals;\n\t\tthis.binormals = frames.binormals;\n\n\t\t// helper variables\n\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\t\tconst uv = new Vector2();\n\t\tlet P = new Vector3();\n\n\t\t// buffer\n\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\t\tconst indices = [];\n\n\t\t// create buffer data\n\n\t\tgenerateBufferData();\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\t// functions\n\n\t\tfunction generateBufferData() {\n\n\t\t\tfor ( let i = 0; i < tubularSegments; i ++ ) {\n\n\t\t\t\tgenerateSegment( i );\n\n\t\t\t}\n\n\t\t\t// if the geometry is not closed, generate the last row of vertices and normals\n\t\t\t// at the regular position on the given path\n\t\t\t//\n\t\t\t// if the geometry is closed, duplicate the first row of vertices and normals (uvs will differ)\n\n\t\t\tgenerateSegment( ( closed === false ) ? tubularSegments : 0 );\n\n\t\t\t// uvs are generated in a separate function.\n\t\t\t// this makes it easy compute correct values for closed geometries\n\n\t\t\tgenerateUVs();\n\n\t\t\t// finally create faces\n\n\t\t\tgenerateIndices();\n\n\t\t}\n\n\t\tfunction generateSegment( i ) {\n\n\t\t\t// we use getPointAt to sample evenly distributed points from the given path\n\n\t\t\tP = path.getPointAt( i / tubularSegments, P );\n\n\t\t\t// retrieve corresponding normal and binormal\n\n\t\t\tconst N = frames.normals[ i ];\n\t\t\tconst B = frames.binormals[ i ];\n\n\t\t\t// generate normals and vertices for the current segment\n\n\t\t\tfor ( let j = 0; j <= radialSegments; j ++ ) {\n\n\t\t\t\tconst v = j / radialSegments * Math.PI * 2;\n\n\t\t\t\tconst sin = Math.sin( v );\n\t\t\t\tconst cos = - Math.cos( v );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormal.x = ( cos * N.x + sin * B.x );\n\t\t\t\tnormal.y = ( cos * N.y + sin * B.y );\n\t\t\t\tnormal.z = ( cos * N.z + sin * B.z );\n\t\t\t\tnormal.normalize();\n\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = P.x + radius * normal.x;\n\t\t\t\tvertex.y = P.y + radius * normal.y;\n\t\t\t\tvertex.z = P.z + radius * normal.z;\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction generateIndices() {\n\n\t\t\tfor ( let j = 1; j <= tubularSegments; j ++ ) {\n\n\t\t\t\tfor ( let i = 1; i <= radialSegments; i ++ ) {\n\n\t\t\t\t\tconst a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\n\t\t\t\t\tconst b = ( radialSegments + 1 ) * j + ( i - 1 );\n\t\t\t\t\tconst c = ( radialSegments + 1 ) * j + i;\n\t\t\t\t\tconst d = ( radialSegments + 1 ) * ( j - 1 ) + i;\n\n\t\t\t\t\t// faces\n\n\t\t\t\t\tindices.push( a, b, d );\n\t\t\t\t\tindices.push( b, c, d );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction generateUVs() {\n\n\t\t\tfor ( let i = 0; i <= tubularSegments; i ++ ) {\n\n\t\t\t\tfor ( let j = 0; j <= radialSegments; j ++ ) {\n\n\t\t\t\t\tuv.x = i / tubularSegments;\n\t\t\t\t\tuv.y = j / radialSegments;\n\n\t\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.path = this.parameters.path.toJSON();\n\n\t\treturn data;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\t// This only works for built-in curves (e.g. CatmullRomCurve3).\n\t\t// User defined curves or instances of CurvePath will not be deserialized.\n\t\treturn new TubeGeometry(\n\t\t\tnew Curves[ data.path.type ]().fromJSON( data.path ),\n\t\t\tdata.tubularSegments,\n\t\t\tdata.radius,\n\t\t\tdata.radialSegments,\n\t\t\tdata.closed\n\t\t);\n\n\t}\n\n}\n\nclass WireframeGeometry extends BufferGeometry {\n\n\tconstructor( geometry = null ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'WireframeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tgeometry: geometry\n\t\t};\n\n\t\tif ( geometry !== null ) {\n\n\t\t\t// buffer\n\n\t\t\tconst vertices = [];\n\t\t\tconst edges = new Set();\n\n\t\t\t// helper variables\n\n\t\t\tconst start = new Vector3();\n\t\t\tconst end = new Vector3();\n\n\t\t\tif ( geometry.index !== null ) {\n\n\t\t\t\t// indexed BufferGeometry\n\n\t\t\t\tconst position = geometry.attributes.position;\n\t\t\t\tconst indices = geometry.index;\n\t\t\t\tlet groups = geometry.groups;\n\n\t\t\t\tif ( groups.length === 0 ) {\n\n\t\t\t\t\tgroups = [ { start: 0, count: indices.count, materialIndex: 0 } ];\n\n\t\t\t\t}\n\n\t\t\t\t// create a data structure that contains all edges without duplicates\n\n\t\t\t\tfor ( let o = 0, ol = groups.length; o < ol; ++ o ) {\n\n\t\t\t\t\tconst group = groups[ o ];\n\n\t\t\t\t\tconst groupStart = group.start;\n\t\t\t\t\tconst groupCount = group.count;\n\n\t\t\t\t\tfor ( let i = groupStart, l = ( groupStart + groupCount ); i < l; i += 3 ) {\n\n\t\t\t\t\t\tfor ( let j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t\t\tconst index1 = indices.getX( i + j );\n\t\t\t\t\t\t\tconst index2 = indices.getX( i + ( j + 1 ) % 3 );\n\n\t\t\t\t\t\t\tstart.fromBufferAttribute( position, index1 );\n\t\t\t\t\t\t\tend.fromBufferAttribute( position, index2 );\n\n\t\t\t\t\t\t\tif ( isUniqueEdge( start, end, edges ) === true ) {\n\n\t\t\t\t\t\t\t\tvertices.push( start.x, start.y, start.z );\n\t\t\t\t\t\t\t\tvertices.push( end.x, end.y, end.z );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// non-indexed BufferGeometry\n\n\t\t\t\tconst position = geometry.attributes.position;\n\n\t\t\t\tfor ( let i = 0, l = ( position.count / 3 ); i < l; i ++ ) {\n\n\t\t\t\t\tfor ( let j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t\t// three edges per triangle, an edge is represented as (index1, index2)\n\t\t\t\t\t\t// e.g. the first triangle has the following edges: (0,1),(1,2),(2,0)\n\n\t\t\t\t\t\tconst index1 = 3 * i + j;\n\t\t\t\t\t\tconst index2 = 3 * i + ( ( j + 1 ) % 3 );\n\n\t\t\t\t\t\tstart.fromBufferAttribute( position, index1 );\n\t\t\t\t\t\tend.fromBufferAttribute( position, index2 );\n\n\t\t\t\t\t\tif ( isUniqueEdge( start, end, edges ) === true ) {\n\n\t\t\t\t\t\t\tvertices.push( start.x, start.y, start.z );\n\t\t\t\t\t\t\tvertices.push( end.x, end.y, end.z );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// build geometry\n\n\t\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n}\n\nfunction isUniqueEdge( start, end, edges ) {\n\n\tconst hash1 = `${start.x},${start.y},${start.z}-${end.x},${end.y},${end.z}`;\n\tconst hash2 = `${end.x},${end.y},${end.z}-${start.x},${start.y},${start.z}`; // coincident edge\n\n\tif ( edges.has( hash1 ) === true || edges.has( hash2 ) === true ) {\n\n\t\treturn false;\n\n\t} else {\n\n\t\tedges.add( hash1 );\n\t\tedges.add( hash2 );\n\t\treturn true;\n\n\t}\n\n}\n\nvar Geometries = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tBoxGeometry: BoxGeometry,\n\tCapsuleGeometry: CapsuleGeometry,\n\tCircleGeometry: CircleGeometry,\n\tConeGeometry: ConeGeometry,\n\tCylinderGeometry: CylinderGeometry,\n\tDodecahedronGeometry: DodecahedronGeometry,\n\tEdgesGeometry: EdgesGeometry,\n\tExtrudeGeometry: ExtrudeGeometry,\n\tIcosahedronGeometry: IcosahedronGeometry,\n\tLatheGeometry: LatheGeometry,\n\tOctahedronGeometry: OctahedronGeometry,\n\tPlaneGeometry: PlaneGeometry,\n\tPolyhedronGeometry: PolyhedronGeometry,\n\tRingGeometry: RingGeometry,\n\tShapeGeometry: ShapeGeometry,\n\tSphereGeometry: SphereGeometry,\n\tTetrahedronGeometry: TetrahedronGeometry,\n\tTorusGeometry: TorusGeometry,\n\tTorusKnotGeometry: TorusKnotGeometry,\n\tTubeGeometry: TubeGeometry,\n\tWireframeGeometry: WireframeGeometry\n});\n\nclass ShadowMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isShadowMaterial = true;\n\n\t\tthis.type = 'ShadowMaterial';\n\n\t\tthis.color = new Color( 0x000000 );\n\t\tthis.transparent = true;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass RawShaderMaterial extends ShaderMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper( parameters );\n\n\t\tthis.isRawShaderMaterial = true;\n\n\t\tthis.type = 'RawShaderMaterial';\n\n\t}\n\n}\n\nclass MeshStandardMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshStandardMaterial = true;\n\n\t\tthis.type = 'MeshStandardMaterial';\n\n\t\tthis.defines = { 'STANDARD': '' };\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\t\tthis.roughness = 1.0;\n\t\tthis.metalness = 0.0;\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.roughnessMap = null;\n\n\t\tthis.metalnessMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.envMapRotation = new Euler();\n\t\tthis.envMapIntensity = 1.0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.flatShading = false;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = { 'STANDARD': '' };\n\n\t\tthis.color.copy( source.color );\n\t\tthis.roughness = source.roughness;\n\t\tthis.metalness = source.metalness;\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.roughnessMap = source.roughnessMap;\n\n\t\tthis.metalnessMap = source.metalnessMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.envMapRotation.copy( source.envMapRotation );\n\t\tthis.envMapIntensity = source.envMapIntensity;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshPhysicalMaterial extends MeshStandardMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshPhysicalMaterial = true;\n\n\t\tthis.defines = {\n\n\t\t\t'STANDARD': '',\n\t\t\t'PHYSICAL': ''\n\n\t\t};\n\n\t\tthis.type = 'MeshPhysicalMaterial';\n\n\t\tthis.anisotropyRotation = 0;\n\t\tthis.anisotropyMap = null;\n\n\t\tthis.clearcoatMap = null;\n\t\tthis.clearcoatRoughness = 0.0;\n\t\tthis.clearcoatRoughnessMap = null;\n\t\tthis.clearcoatNormalScale = new Vector2( 1, 1 );\n\t\tthis.clearcoatNormalMap = null;\n\n\t\tthis.ior = 1.5;\n\n\t\tObject.defineProperty( this, 'reflectivity', {\n\t\t\tget: function () {\n\n\t\t\t\treturn ( clamp( 2.5 * ( this.ior - 1 ) / ( this.ior + 1 ), 0, 1 ) );\n\n\t\t\t},\n\t\t\tset: function ( reflectivity ) {\n\n\t\t\t\tthis.ior = ( 1 + 0.4 * reflectivity ) / ( 1 - 0.4 * reflectivity );\n\n\t\t\t}\n\t\t} );\n\n\t\tthis.iridescenceMap = null;\n\t\tthis.iridescenceIOR = 1.3;\n\t\tthis.iridescenceThicknessRange = [ 100, 400 ];\n\t\tthis.iridescenceThicknessMap = null;\n\n\t\tthis.sheenColor = new Color( 0x000000 );\n\t\tthis.sheenColorMap = null;\n\t\tthis.sheenRoughness = 1.0;\n\t\tthis.sheenRoughnessMap = null;\n\n\t\tthis.transmissionMap = null;\n\n\t\tthis.thickness = 0;\n\t\tthis.thicknessMap = null;\n\t\tthis.attenuationDistance = Infinity;\n\t\tthis.attenuationColor = new Color( 1, 1, 1 );\n\n\t\tthis.specularIntensity = 1.0;\n\t\tthis.specularIntensityMap = null;\n\t\tthis.specularColor = new Color( 1, 1, 1 );\n\t\tthis.specularColorMap = null;\n\n\t\tthis._anisotropy = 0;\n\t\tthis._clearcoat = 0;\n\t\tthis._dispersion = 0;\n\t\tthis._iridescence = 0;\n\t\tthis._sheen = 0.0;\n\t\tthis._transmission = 0;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tget anisotropy() {\n\n\t\treturn this._anisotropy;\n\n\t}\n\n\tset anisotropy( value ) {\n\n\t\tif ( this._anisotropy > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._anisotropy = value;\n\n\t}\n\n\tget clearcoat() {\n\n\t\treturn this._clearcoat;\n\n\t}\n\n\tset clearcoat( value ) {\n\n\t\tif ( this._clearcoat > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._clearcoat = value;\n\n\t}\n\n\tget iridescence() {\n\n\t\treturn this._iridescence;\n\n\t}\n\n\tset iridescence( value ) {\n\n\t\tif ( this._iridescence > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._iridescence = value;\n\n\t}\n\n\tget dispersion() {\n\n\t\treturn this._dispersion;\n\n\t}\n\n\tset dispersion( value ) {\n\n\t\tif ( this._dispersion > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._dispersion = value;\n\n\t}\n\n\tget sheen() {\n\n\t\treturn this._sheen;\n\n\t}\n\n\tset sheen( value ) {\n\n\t\tif ( this._sheen > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._sheen = value;\n\n\t}\n\n\tget transmission() {\n\n\t\treturn this._transmission;\n\n\t}\n\n\tset transmission( value ) {\n\n\t\tif ( this._transmission > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._transmission = value;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = {\n\n\t\t\t'STANDARD': '',\n\t\t\t'PHYSICAL': ''\n\n\t\t};\n\n\t\tthis.anisotropy = source.anisotropy;\n\t\tthis.anisotropyRotation = source.anisotropyRotation;\n\t\tthis.anisotropyMap = source.anisotropyMap;\n\n\t\tthis.clearcoat = source.clearcoat;\n\t\tthis.clearcoatMap = source.clearcoatMap;\n\t\tthis.clearcoatRoughness = source.clearcoatRoughness;\n\t\tthis.clearcoatRoughnessMap = source.clearcoatRoughnessMap;\n\t\tthis.clearcoatNormalMap = source.clearcoatNormalMap;\n\t\tthis.clearcoatNormalScale.copy( source.clearcoatNormalScale );\n\n\t\tthis.dispersion = source.dispersion;\n\t\tthis.ior = source.ior;\n\n\t\tthis.iridescence = source.iridescence;\n\t\tthis.iridescenceMap = source.iridescenceMap;\n\t\tthis.iridescenceIOR = source.iridescenceIOR;\n\t\tthis.iridescenceThicknessRange = [ ...source.iridescenceThicknessRange ];\n\t\tthis.iridescenceThicknessMap = source.iridescenceThicknessMap;\n\n\t\tthis.sheen = source.sheen;\n\t\tthis.sheenColor.copy( source.sheenColor );\n\t\tthis.sheenColorMap = source.sheenColorMap;\n\t\tthis.sheenRoughness = source.sheenRoughness;\n\t\tthis.sheenRoughnessMap = source.sheenRoughnessMap;\n\n\t\tthis.transmission = source.transmission;\n\t\tthis.transmissionMap = source.transmissionMap;\n\n\t\tthis.thickness = source.thickness;\n\t\tthis.thicknessMap = source.thicknessMap;\n\t\tthis.attenuationDistance = source.attenuationDistance;\n\t\tthis.attenuationColor.copy( source.attenuationColor );\n\n\t\tthis.specularIntensity = source.specularIntensity;\n\t\tthis.specularIntensityMap = source.specularIntensityMap;\n\t\tthis.specularColor.copy( source.specularColor );\n\t\tthis.specularColorMap = source.specularColorMap;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshPhongMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshPhongMaterial = true;\n\n\t\tthis.type = 'MeshPhongMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\t\tthis.specular = new Color( 0x111111 );\n\t\tthis.shininess = 30;\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.envMapRotation = new Euler();\n\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.flatShading = false;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\t\tthis.specular.copy( source.specular );\n\t\tthis.shininess = source.shininess;\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.envMapRotation.copy( source.envMapRotation );\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshToonMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshToonMaterial = true;\n\n\t\tthis.defines = { 'TOON': '' };\n\n\t\tthis.type = 'MeshToonMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\t\tthis.gradientMap = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\t\tthis.gradientMap = source.gradientMap;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshNormalMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshNormalMaterial = true;\n\n\t\tthis.type = 'MeshNormalMaterial';\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.flatShading = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshLambertMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshLambertMaterial = true;\n\n\t\tthis.type = 'MeshLambertMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.envMapRotation = new Euler();\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.flatShading = false;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.envMapRotation.copy( source.envMapRotation );\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshDepthMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshDepthMaterial = true;\n\n\t\tthis.type = 'MeshDepthMaterial';\n\n\t\tthis.depthPacking = BasicDepthPacking;\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.depthPacking = source.depthPacking;\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshDistanceMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshDistanceMaterial = true;\n\n\t\tthis.type = 'MeshDistanceMaterial';\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshMatcapMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshMatcapMaterial = true;\n\n\t\tthis.defines = { 'MATCAP': '' };\n\n\t\tthis.type = 'MeshMatcapMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\n\t\tthis.matcap = null;\n\n\t\tthis.map = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.flatShading = false;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = { 'MATCAP': '' };\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.matcap = source.matcap;\n\n\t\tthis.map = source.map;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass LineDashedMaterial extends LineBasicMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isLineDashedMaterial = true;\n\t\tthis.type = 'LineDashedMaterial';\n\n\t\tthis.scale = 1;\n\t\tthis.dashSize = 3;\n\t\tthis.gapSize = 1;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.scale = source.scale;\n\t\tthis.dashSize = source.dashSize;\n\t\tthis.gapSize = source.gapSize;\n\n\t\treturn this;\n\n\t}\n\n}\n\n// converts an array to a specific type\nfunction convertArray( array, type, forceClone ) {\n\n\tif ( ! array || // let 'undefined' and 'null' pass\n\t\t! forceClone && array.constructor === type ) return array;\n\n\tif ( typeof type.BYTES_PER_ELEMENT === 'number' ) {\n\n\t\treturn new type( array ); // create typed array\n\n\t}\n\n\treturn Array.prototype.slice.call( array ); // create Array\n\n}\n\nfunction isTypedArray( object ) {\n\n\treturn ArrayBuffer.isView( object ) &&\n\t\t! ( object instanceof DataView );\n\n}\n\n// returns an array by which times and values can be sorted\nfunction getKeyframeOrder( times ) {\n\n\tfunction compareTime( i, j ) {\n\n\t\treturn times[ i ] - times[ j ];\n\n\t}\n\n\tconst n = times.length;\n\tconst result = new Array( n );\n\tfor ( let i = 0; i !== n; ++ i ) result[ i ] = i;\n\n\tresult.sort( compareTime );\n\n\treturn result;\n\n}\n\n// uses the array previously returned by 'getKeyframeOrder' to sort data\nfunction sortedArray( values, stride, order ) {\n\n\tconst nValues = values.length;\n\tconst result = new values.constructor( nValues );\n\n\tfor ( let i = 0, dstOffset = 0; dstOffset !== nValues; ++ i ) {\n\n\t\tconst srcOffset = order[ i ] * stride;\n\n\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\tresult[ dstOffset ++ ] = values[ srcOffset + j ];\n\n\t\t}\n\n\t}\n\n\treturn result;\n\n}\n\n// function for parsing AOS keyframe formats\nfunction flattenJSON( jsonKeys, times, values, valuePropertyName ) {\n\n\tlet i = 1, key = jsonKeys[ 0 ];\n\n\twhile ( key !== undefined && key[ valuePropertyName ] === undefined ) {\n\n\t\tkey = jsonKeys[ i ++ ];\n\n\t}\n\n\tif ( key === undefined ) return; // no data\n\n\tlet value = key[ valuePropertyName ];\n\tif ( value === undefined ) return; // no data\n\n\tif ( Array.isArray( value ) ) {\n\n\t\tdo {\n\n\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\tif ( value !== undefined ) {\n\n\t\t\t\ttimes.push( key.time );\n\t\t\t\tvalues.push.apply( values, value ); // push all elements\n\n\t\t\t}\n\n\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t} while ( key !== undefined );\n\n\t} else if ( value.toArray !== undefined ) {\n\n\t\t// ...assume THREE.Math-ish\n\n\t\tdo {\n\n\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\tif ( value !== undefined ) {\n\n\t\t\t\ttimes.push( key.time );\n\t\t\t\tvalue.toArray( values, values.length );\n\n\t\t\t}\n\n\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t} while ( key !== undefined );\n\n\t} else {\n\n\t\t// otherwise push as-is\n\n\t\tdo {\n\n\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\tif ( value !== undefined ) {\n\n\t\t\t\ttimes.push( key.time );\n\t\t\t\tvalues.push( value );\n\n\t\t\t}\n\n\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t} while ( key !== undefined );\n\n\t}\n\n}\n\nfunction subclip( sourceClip, name, startFrame, endFrame, fps = 30 ) {\n\n\tconst clip = sourceClip.clone();\n\n\tclip.name = name;\n\n\tconst tracks = [];\n\n\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\tconst track = clip.tracks[ i ];\n\t\tconst valueSize = track.getValueSize();\n\n\t\tconst times = [];\n\t\tconst values = [];\n\n\t\tfor ( let j = 0; j < track.times.length; ++ j ) {\n\n\t\t\tconst frame = track.times[ j ] * fps;\n\n\t\t\tif ( frame < startFrame || frame >= endFrame ) continue;\n\n\t\t\ttimes.push( track.times[ j ] );\n\n\t\t\tfor ( let k = 0; k < valueSize; ++ k ) {\n\n\t\t\t\tvalues.push( track.values[ j * valueSize + k ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( times.length === 0 ) continue;\n\n\t\ttrack.times = convertArray( times, track.times.constructor );\n\t\ttrack.values = convertArray( values, track.values.constructor );\n\n\t\ttracks.push( track );\n\n\t}\n\n\tclip.tracks = tracks;\n\n\t// find minimum .times value across all tracks in the trimmed clip\n\n\tlet minStartTime = Infinity;\n\n\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\tif ( minStartTime > clip.tracks[ i ].times[ 0 ] ) {\n\n\t\t\tminStartTime = clip.tracks[ i ].times[ 0 ];\n\n\t\t}\n\n\t}\n\n\t// shift all tracks such that clip begins at t=0\n\n\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\tclip.tracks[ i ].shift( - 1 * minStartTime );\n\n\t}\n\n\tclip.resetDuration();\n\n\treturn clip;\n\n}\n\nfunction makeClipAdditive( targetClip, referenceFrame = 0, referenceClip = targetClip, fps = 30 ) {\n\n\tif ( fps <= 0 ) fps = 30;\n\n\tconst numTracks = referenceClip.tracks.length;\n\tconst referenceTime = referenceFrame / fps;\n\n\t// Make each track's values relative to the values at the reference frame\n\tfor ( let i = 0; i < numTracks; ++ i ) {\n\n\t\tconst referenceTrack = referenceClip.tracks[ i ];\n\t\tconst referenceTrackType = referenceTrack.ValueTypeName;\n\n\t\t// Skip this track if it's non-numeric\n\t\tif ( referenceTrackType === 'bool' || referenceTrackType === 'string' ) continue;\n\n\t\t// Find the track in the target clip whose name and type matches the reference track\n\t\tconst targetTrack = targetClip.tracks.find( function ( track ) {\n\n\t\t\treturn track.name === referenceTrack.name\n\t\t\t\t&& track.ValueTypeName === referenceTrackType;\n\n\t\t} );\n\n\t\tif ( targetTrack === undefined ) continue;\n\n\t\tlet referenceOffset = 0;\n\t\tconst referenceValueSize = referenceTrack.getValueSize();\n\n\t\tif ( referenceTrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline ) {\n\n\t\t\treferenceOffset = referenceValueSize / 3;\n\n\t\t}\n\n\t\tlet targetOffset = 0;\n\t\tconst targetValueSize = targetTrack.getValueSize();\n\n\t\tif ( targetTrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline ) {\n\n\t\t\ttargetOffset = targetValueSize / 3;\n\n\t\t}\n\n\t\tconst lastIndex = referenceTrack.times.length - 1;\n\t\tlet referenceValue;\n\n\t\t// Find the value to subtract out of the track\n\t\tif ( referenceTime <= referenceTrack.times[ 0 ] ) {\n\n\t\t\t// Reference frame is earlier than the first keyframe, so just use the first keyframe\n\t\t\tconst startIndex = referenceOffset;\n\t\t\tconst endIndex = referenceValueSize - referenceOffset;\n\t\t\treferenceValue = referenceTrack.values.slice( startIndex, endIndex );\n\n\t\t} else if ( referenceTime >= referenceTrack.times[ lastIndex ] ) {\n\n\t\t\t// Reference frame is after the last keyframe, so just use the last keyframe\n\t\t\tconst startIndex = lastIndex * referenceValueSize + referenceOffset;\n\t\t\tconst endIndex = startIndex + referenceValueSize - referenceOffset;\n\t\t\treferenceValue = referenceTrack.values.slice( startIndex, endIndex );\n\n\t\t} else {\n\n\t\t\t// Interpolate to the reference value\n\t\t\tconst interpolant = referenceTrack.createInterpolant();\n\t\t\tconst startIndex = referenceOffset;\n\t\t\tconst endIndex = referenceValueSize - referenceOffset;\n\t\t\tinterpolant.evaluate( referenceTime );\n\t\t\treferenceValue = interpolant.resultBuffer.slice( startIndex, endIndex );\n\n\t\t}\n\n\t\t// Conjugate the quaternion\n\t\tif ( referenceTrackType === 'quaternion' ) {\n\n\t\t\tconst referenceQuat = new Quaternion().fromArray( referenceValue ).normalize().conjugate();\n\t\t\treferenceQuat.toArray( referenceValue );\n\n\t\t}\n\n\t\t// Subtract the reference value from all of the track values\n\n\t\tconst numTimes = targetTrack.times.length;\n\t\tfor ( let j = 0; j < numTimes; ++ j ) {\n\n\t\t\tconst valueStart = j * targetValueSize + targetOffset;\n\n\t\t\tif ( referenceTrackType === 'quaternion' ) {\n\n\t\t\t\t// Multiply the conjugate for quaternion track types\n\t\t\t\tQuaternion.multiplyQuaternionsFlat(\n\t\t\t\t\ttargetTrack.values,\n\t\t\t\t\tvalueStart,\n\t\t\t\t\treferenceValue,\n\t\t\t\t\t0,\n\t\t\t\t\ttargetTrack.values,\n\t\t\t\t\tvalueStart\n\t\t\t\t);\n\n\t\t\t} else {\n\n\t\t\t\tconst valueEnd = targetValueSize - targetOffset * 2;\n\n\t\t\t\t// Subtract each value for all other numeric track types\n\t\t\t\tfor ( let k = 0; k < valueEnd; ++ k ) {\n\n\t\t\t\t\ttargetTrack.values[ valueStart + k ] -= referenceValue[ k ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttargetClip.blendMode = AdditiveAnimationBlendMode;\n\n\treturn targetClip;\n\n}\n\nconst AnimationUtils = {\n\tconvertArray: convertArray,\n\tisTypedArray: isTypedArray,\n\tgetKeyframeOrder: getKeyframeOrder,\n\tsortedArray: sortedArray,\n\tflattenJSON: flattenJSON,\n\tsubclip: subclip,\n\tmakeClipAdditive: makeClipAdditive\n};\n\n/**\n * Abstract base class of interpolants over parametric samples.\n *\n * The parameter domain is one dimensional, typically the time or a path\n * along a curve defined by the data.\n *\n * The sample values can have any dimensionality and derived classes may\n * apply special interpretations to the data.\n *\n * This class provides the interval seek in a Template Method, deferring\n * the actual interpolation to derived classes.\n *\n * Time complexity is O(1) for linear access crossing at most two points\n * and O(log N) for random access, where N is the number of positions.\n *\n * References:\n *\n * \t\thttp://www.oodesign.com/template-method-pattern.html\n *\n */\n\nclass Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tthis.parameterPositions = parameterPositions;\n\t\tthis._cachedIndex = 0;\n\n\t\tthis.resultBuffer = resultBuffer !== undefined ?\n\t\t\tresultBuffer : new sampleValues.constructor( sampleSize );\n\t\tthis.sampleValues = sampleValues;\n\t\tthis.valueSize = sampleSize;\n\n\t\tthis.settings = null;\n\t\tthis.DefaultSettings_ = {};\n\n\t}\n\n\tevaluate( t ) {\n\n\t\tconst pp = this.parameterPositions;\n\t\tlet i1 = this._cachedIndex,\n\t\t\tt1 = pp[ i1 ],\n\t\t\tt0 = pp[ i1 - 1 ];\n\n\t\tvalidate_interval: {\n\n\t\t\tseek: {\n\n\t\t\t\tlet right;\n\n\t\t\t\tlinear_scan: {\n\n\t\t\t\t\t//- See http://jsperf.com/comparison-to-undefined/3\n\t\t\t\t\t//- slower code:\n\t\t\t\t\t//-\n\t\t\t\t\t//- \t\t\t\tif ( t >= t1 || t1 === undefined ) {\n\t\t\t\t\tforward_scan: if ( ! ( t < t1 ) ) {\n\n\t\t\t\t\t\tfor ( let giveUpAt = i1 + 2; ; ) {\n\n\t\t\t\t\t\t\tif ( t1 === undefined ) {\n\n\t\t\t\t\t\t\t\tif ( t < t0 ) break forward_scan;\n\n\t\t\t\t\t\t\t\t// after end\n\n\t\t\t\t\t\t\t\ti1 = pp.length;\n\t\t\t\t\t\t\t\tthis._cachedIndex = i1;\n\t\t\t\t\t\t\t\treturn this.copySampleValue_( i1 - 1 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\n\n\t\t\t\t\t\t\tt0 = t1;\n\t\t\t\t\t\t\tt1 = pp[ ++ i1 ];\n\n\t\t\t\t\t\t\tif ( t < t1 ) {\n\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\n\t\t\t\t\t\t\t\tbreak seek;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// prepare binary search on the right side of the index\n\t\t\t\t\t\tright = pp.length;\n\t\t\t\t\t\tbreak linear_scan;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t//- slower code:\n\t\t\t\t\t//-\t\t\t\t\tif ( t < t0 || t0 === undefined ) {\n\t\t\t\t\tif ( ! ( t >= t0 ) ) {\n\n\t\t\t\t\t\t// looping?\n\n\t\t\t\t\t\tconst t1global = pp[ 1 ];\n\n\t\t\t\t\t\tif ( t < t1global ) {\n\n\t\t\t\t\t\t\ti1 = 2; // + 1, using the scan for the details\n\t\t\t\t\t\t\tt0 = t1global;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// linear reverse scan\n\n\t\t\t\t\t\tfor ( let giveUpAt = i1 - 2; ; ) {\n\n\t\t\t\t\t\t\tif ( t0 === undefined ) {\n\n\t\t\t\t\t\t\t\t// before start\n\n\t\t\t\t\t\t\t\tthis._cachedIndex = 0;\n\t\t\t\t\t\t\t\treturn this.copySampleValue_( 0 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\n\n\t\t\t\t\t\t\tt1 = t0;\n\t\t\t\t\t\t\tt0 = pp[ -- i1 - 1 ];\n\n\t\t\t\t\t\t\tif ( t >= t0 ) {\n\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\n\t\t\t\t\t\t\t\tbreak seek;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// prepare binary search on the left side of the index\n\t\t\t\t\t\tright = i1;\n\t\t\t\t\t\ti1 = 0;\n\t\t\t\t\t\tbreak linear_scan;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// the interval is valid\n\n\t\t\t\t\tbreak validate_interval;\n\n\t\t\t\t} // linear scan\n\n\t\t\t\t// binary search\n\n\t\t\t\twhile ( i1 < right ) {\n\n\t\t\t\t\tconst mid = ( i1 + right ) >>> 1;\n\n\t\t\t\t\tif ( t < pp[ mid ] ) {\n\n\t\t\t\t\t\tright = mid;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ti1 = mid + 1;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tt1 = pp[ i1 ];\n\t\t\t\tt0 = pp[ i1 - 1 ];\n\n\t\t\t\t// check boundary cases, again\n\n\t\t\t\tif ( t0 === undefined ) {\n\n\t\t\t\t\tthis._cachedIndex = 0;\n\t\t\t\t\treturn this.copySampleValue_( 0 );\n\n\t\t\t\t}\n\n\t\t\t\tif ( t1 === undefined ) {\n\n\t\t\t\t\ti1 = pp.length;\n\t\t\t\t\tthis._cachedIndex = i1;\n\t\t\t\t\treturn this.copySampleValue_( i1 - 1 );\n\n\t\t\t\t}\n\n\t\t\t} // seek\n\n\t\t\tthis._cachedIndex = i1;\n\n\t\t\tthis.intervalChanged_( i1, t0, t1 );\n\n\t\t} // validate_interval\n\n\t\treturn this.interpolate_( i1, t0, t, t1 );\n\n\t}\n\n\tgetSettings_() {\n\n\t\treturn this.settings || this.DefaultSettings_;\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// copies a sample value to the result buffer\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\t\t\toffset = index * stride;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\t// Template methods for derived classes:\n\n\tinterpolate_( /* i1, t0, t, t1 */ ) {\n\n\t\tthrow new Error( 'call to abstract method' );\n\t\t// implementations shall return this.resultBuffer\n\n\t}\n\n\tintervalChanged_( /* i1, t0, t1 */ ) {\n\n\t\t// empty\n\n\t}\n\n}\n\n/**\n * Fast and simple cubic spline interpolant.\n *\n * It was derived from a Hermitian construction setting the first derivative\n * at each sample position to the linear slope between neighboring positions\n * over their parameter interval.\n */\n\nclass CubicInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t\tthis._weightPrev = - 0;\n\t\tthis._offsetPrev = - 0;\n\t\tthis._weightNext = - 0;\n\t\tthis._offsetNext = - 0;\n\n\t\tthis.DefaultSettings_ = {\n\n\t\t\tendingStart: ZeroCurvatureEnding,\n\t\t\tendingEnd: ZeroCurvatureEnding\n\n\t\t};\n\n\t}\n\n\tintervalChanged_( i1, t0, t1 ) {\n\n\t\tconst pp = this.parameterPositions;\n\t\tlet iPrev = i1 - 2,\n\t\t\tiNext = i1 + 1,\n\n\t\t\ttPrev = pp[ iPrev ],\n\t\t\ttNext = pp[ iNext ];\n\n\t\tif ( tPrev === undefined ) {\n\n\t\t\tswitch ( this.getSettings_().endingStart ) {\n\n\t\t\t\tcase ZeroSlopeEnding:\n\n\t\t\t\t\t// f'(t0) = 0\n\t\t\t\t\tiPrev = i1;\n\t\t\t\t\ttPrev = 2 * t0 - t1;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase WrapAroundEnding:\n\n\t\t\t\t\t// use the other end of the curve\n\t\t\t\t\tiPrev = pp.length - 2;\n\t\t\t\t\ttPrev = t0 + pp[ iPrev ] - pp[ iPrev + 1 ];\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault: // ZeroCurvatureEnding\n\n\t\t\t\t\t// f''(t0) = 0 a.k.a. Natural Spline\n\t\t\t\t\tiPrev = i1;\n\t\t\t\t\ttPrev = t1;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( tNext === undefined ) {\n\n\t\t\tswitch ( this.getSettings_().endingEnd ) {\n\n\t\t\t\tcase ZeroSlopeEnding:\n\n\t\t\t\t\t// f'(tN) = 0\n\t\t\t\t\tiNext = i1;\n\t\t\t\t\ttNext = 2 * t1 - t0;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase WrapAroundEnding:\n\n\t\t\t\t\t// use the other end of the curve\n\t\t\t\t\tiNext = 1;\n\t\t\t\t\ttNext = t1 + pp[ 1 ] - pp[ 0 ];\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault: // ZeroCurvatureEnding\n\n\t\t\t\t\t// f''(tN) = 0, a.k.a. Natural Spline\n\t\t\t\t\tiNext = i1 - 1;\n\t\t\t\t\ttNext = t0;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst halfDt = ( t1 - t0 ) * 0.5,\n\t\t\tstride = this.valueSize;\n\n\t\tthis._weightPrev = halfDt / ( t0 - tPrev );\n\t\tthis._weightNext = halfDt / ( tNext - t1 );\n\t\tthis._offsetPrev = iPrev * stride;\n\t\tthis._offsetNext = iNext * stride;\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\to1 = i1 * stride,\t\to0 = o1 - stride,\n\t\t\toP = this._offsetPrev, \toN = this._offsetNext,\n\t\t\twP = this._weightPrev,\twN = this._weightNext,\n\n\t\t\tp = ( t - t0 ) / ( t1 - t0 ),\n\t\t\tpp = p * p,\n\t\t\tppp = pp * p;\n\n\t\t// evaluate polynomials\n\n\t\tconst sP = - wP * ppp + 2 * wP * pp - wP * p;\n\t\tconst s0 = ( 1 + wP ) * ppp + ( - 1.5 - 2 * wP ) * pp + ( - 0.5 + wP ) * p + 1;\n\t\tconst s1 = ( - 1 - wN ) * ppp + ( 1.5 + wN ) * pp + 0.5 * p;\n\t\tconst sN = wN * ppp - wN * pp;\n\n\t\t// combine data linearly\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] =\n\t\t\t\t\tsP * values[ oP + i ] +\n\t\t\t\t\ts0 * values[ o0 + i ] +\n\t\t\t\t\ts1 * values[ o1 + i ] +\n\t\t\t\t\tsN * values[ oN + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nclass LinearInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\toffset1 = i1 * stride,\n\t\t\toffset0 = offset1 - stride,\n\n\t\t\tweight1 = ( t - t0 ) / ( t1 - t0 ),\n\t\t\tweight0 = 1 - weight1;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] =\n\t\t\t\t\tvalues[ offset0 + i ] * weight0 +\n\t\t\t\t\tvalues[ offset1 + i ] * weight1;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\n/**\n *\n * Interpolant that evaluates to the sample value at the position preceding\n * the parameter.\n */\n\nclass DiscreteInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1 /*, t0, t, t1 */ ) {\n\n\t\treturn this.copySampleValue_( i1 - 1 );\n\n\t}\n\n}\n\nclass KeyframeTrack {\n\n\tconstructor( name, times, values, interpolation ) {\n\n\t\tif ( name === undefined ) throw new Error( 'THREE.KeyframeTrack: track name is undefined' );\n\t\tif ( times === undefined || times.length === 0 ) throw new Error( 'THREE.KeyframeTrack: no keyframes in track named ' + name );\n\n\t\tthis.name = name;\n\n\t\tthis.times = convertArray( times, this.TimeBufferType );\n\t\tthis.values = convertArray( values, this.ValueBufferType );\n\n\t\tthis.setInterpolation( interpolation || this.DefaultInterpolation );\n\n\t}\n\n\t// Serialization (in static context, because of constructor invocation\n\t// and automatic invocation of .toJSON):\n\n\tstatic toJSON( track ) {\n\n\t\tconst trackType = track.constructor;\n\n\t\tlet json;\n\n\t\t// derived classes can define a static toJSON method\n\t\tif ( trackType.toJSON !== this.toJSON ) {\n\n\t\t\tjson = trackType.toJSON( track );\n\n\t\t} else {\n\n\t\t\t// by default, we assume the data can be serialized as-is\n\t\t\tjson = {\n\n\t\t\t\t'name': track.name,\n\t\t\t\t'times': convertArray( track.times, Array ),\n\t\t\t\t'values': convertArray( track.values, Array )\n\n\t\t\t};\n\n\t\t\tconst interpolation = track.getInterpolation();\n\n\t\t\tif ( interpolation !== track.DefaultInterpolation ) {\n\n\t\t\t\tjson.interpolation = interpolation;\n\n\t\t\t}\n\n\t\t}\n\n\t\tjson.type = track.ValueTypeName; // mandatory\n\n\t\treturn json;\n\n\t}\n\n\tInterpolantFactoryMethodDiscrete( result ) {\n\n\t\treturn new DiscreteInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tInterpolantFactoryMethodLinear( result ) {\n\n\t\treturn new LinearInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tInterpolantFactoryMethodSmooth( result ) {\n\n\t\treturn new CubicInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tsetInterpolation( interpolation ) {\n\n\t\tlet factoryMethod;\n\n\t\tswitch ( interpolation ) {\n\n\t\t\tcase InterpolateDiscrete:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodDiscrete;\n\n\t\t\t\tbreak;\n\n\t\t\tcase InterpolateLinear:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodLinear;\n\n\t\t\t\tbreak;\n\n\t\t\tcase InterpolateSmooth:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodSmooth;\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( factoryMethod === undefined ) {\n\n\t\t\tconst message = 'unsupported interpolation for ' +\n\t\t\t\tthis.ValueTypeName + ' keyframe track named ' + this.name;\n\n\t\t\tif ( this.createInterpolant === undefined ) {\n\n\t\t\t\t// fall back to default, unless the default itself is messed up\n\t\t\t\tif ( interpolation !== this.DefaultInterpolation ) {\n\n\t\t\t\t\tthis.setInterpolation( this.DefaultInterpolation );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( message ); // fatal, in this case\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconsole.warn( 'THREE.KeyframeTrack:', message );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tthis.createInterpolant = factoryMethod;\n\n\t\treturn this;\n\n\t}\n\n\tgetInterpolation() {\n\n\t\tswitch ( this.createInterpolant ) {\n\n\t\t\tcase this.InterpolantFactoryMethodDiscrete:\n\n\t\t\t\treturn InterpolateDiscrete;\n\n\t\t\tcase this.InterpolantFactoryMethodLinear:\n\n\t\t\t\treturn InterpolateLinear;\n\n\t\t\tcase this.InterpolantFactoryMethodSmooth:\n\n\t\t\t\treturn InterpolateSmooth;\n\n\t\t}\n\n\t}\n\n\tgetValueSize() {\n\n\t\treturn this.values.length / this.times.length;\n\n\t}\n\n\t// move all keyframes either forwards or backwards in time\n\tshift( timeOffset ) {\n\n\t\tif ( timeOffset !== 0.0 ) {\n\n\t\t\tconst times = this.times;\n\n\t\t\tfor ( let i = 0, n = times.length; i !== n; ++ i ) {\n\n\t\t\t\ttimes[ i ] += timeOffset;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// scale all keyframe times by a factor (useful for frame <-> seconds conversions)\n\tscale( timeScale ) {\n\n\t\tif ( timeScale !== 1.0 ) {\n\n\t\t\tconst times = this.times;\n\n\t\t\tfor ( let i = 0, n = times.length; i !== n; ++ i ) {\n\n\t\t\t\ttimes[ i ] *= timeScale;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// removes keyframes before and after animation without changing any values within the range [startTime, endTime].\n\t// IMPORTANT: We do not shift around keys to the start of the track time, because for interpolated keys this will change their values\n\ttrim( startTime, endTime ) {\n\n\t\tconst times = this.times,\n\t\t\tnKeys = times.length;\n\n\t\tlet from = 0,\n\t\t\tto = nKeys - 1;\n\n\t\twhile ( from !== nKeys && times[ from ] < startTime ) {\n\n\t\t\t++ from;\n\n\t\t}\n\n\t\twhile ( to !== - 1 && times[ to ] > endTime ) {\n\n\t\t\t-- to;\n\n\t\t}\n\n\t\t++ to; // inclusive -> exclusive bound\n\n\t\tif ( from !== 0 || to !== nKeys ) {\n\n\t\t\t// empty tracks are forbidden, so keep at least one keyframe\n\t\t\tif ( from >= to ) {\n\n\t\t\t\tto = Math.max( to, 1 );\n\t\t\t\tfrom = to - 1;\n\n\t\t\t}\n\n\t\t\tconst stride = this.getValueSize();\n\t\t\tthis.times = times.slice( from, to );\n\t\t\tthis.values = this.values.slice( from * stride, to * stride );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// ensure we do not get a GarbageInGarbageOut situation, make sure tracks are at least minimally viable\n\tvalidate() {\n\n\t\tlet valid = true;\n\n\t\tconst valueSize = this.getValueSize();\n\t\tif ( valueSize - Math.floor( valueSize ) !== 0 ) {\n\n\t\t\tconsole.error( 'THREE.KeyframeTrack: Invalid value size in track.', this );\n\t\t\tvalid = false;\n\n\t\t}\n\n\t\tconst times = this.times,\n\t\t\tvalues = this.values,\n\n\t\t\tnKeys = times.length;\n\n\t\tif ( nKeys === 0 ) {\n\n\t\t\tconsole.error( 'THREE.KeyframeTrack: Track is empty.', this );\n\t\t\tvalid = false;\n\n\t\t}\n\n\t\tlet prevTime = null;\n\n\t\tfor ( let i = 0; i !== nKeys; i ++ ) {\n\n\t\t\tconst currTime = times[ i ];\n\n\t\t\tif ( typeof currTime === 'number' && isNaN( currTime ) ) {\n\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Time is not a valid number.', this, i, currTime );\n\t\t\t\tvalid = false;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( prevTime !== null && prevTime > currTime ) {\n\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Out of order keys.', this, i, currTime, prevTime );\n\t\t\t\tvalid = false;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tprevTime = currTime;\n\n\t\t}\n\n\t\tif ( values !== undefined ) {\n\n\t\t\tif ( isTypedArray( values ) ) {\n\n\t\t\t\tfor ( let i = 0, n = values.length; i !== n; ++ i ) {\n\n\t\t\t\t\tconst value = values[ i ];\n\n\t\t\t\t\tif ( isNaN( value ) ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Value is not a valid number.', this, i, value );\n\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn valid;\n\n\t}\n\n\t// removes equivalent sequential keys as common in morph target sequences\n\t// (0,0,0,0,1,1,1,0,0,0,0,0,0,0) --> (0,0,1,1,0,0)\n\toptimize() {\n\n\t\t// times or values may be shared with other tracks, so overwriting is unsafe\n\t\tconst times = this.times.slice(),\n\t\t\tvalues = this.values.slice(),\n\t\t\tstride = this.getValueSize(),\n\n\t\t\tsmoothInterpolation = this.getInterpolation() === InterpolateSmooth,\n\n\t\t\tlastIndex = times.length - 1;\n\n\t\tlet writeIndex = 1;\n\n\t\tfor ( let i = 1; i < lastIndex; ++ i ) {\n\n\t\t\tlet keep = false;\n\n\t\t\tconst time = times[ i ];\n\t\t\tconst timeNext = times[ i + 1 ];\n\n\t\t\t// remove adjacent keyframes scheduled at the same time\n\n\t\t\tif ( time !== timeNext && ( i !== 1 || time !== times[ 0 ] ) ) {\n\n\t\t\t\tif ( ! smoothInterpolation ) {\n\n\t\t\t\t\t// remove unnecessary keyframes same as their neighbors\n\n\t\t\t\t\tconst offset = i * stride,\n\t\t\t\t\t\toffsetP = offset - stride,\n\t\t\t\t\t\toffsetN = offset + stride;\n\n\t\t\t\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\t\t\t\tconst value = values[ offset + j ];\n\n\t\t\t\t\t\tif ( value !== values[ offsetP + j ] ||\n\t\t\t\t\t\t\tvalue !== values[ offsetN + j ] ) {\n\n\t\t\t\t\t\t\tkeep = true;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tkeep = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// in-place compaction\n\n\t\t\tif ( keep ) {\n\n\t\t\t\tif ( i !== writeIndex ) {\n\n\t\t\t\t\ttimes[ writeIndex ] = times[ i ];\n\n\t\t\t\t\tconst readOffset = i * stride,\n\t\t\t\t\t\twriteOffset = writeIndex * stride;\n\n\t\t\t\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t++ writeIndex;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// flush last keyframe (compaction looks ahead)\n\n\t\tif ( lastIndex > 0 ) {\n\n\t\t\ttimes[ writeIndex ] = times[ lastIndex ];\n\n\t\t\tfor ( let readOffset = lastIndex * stride, writeOffset = writeIndex * stride, j = 0; j !== stride; ++ j ) {\n\n\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\n\n\t\t\t}\n\n\t\t\t++ writeIndex;\n\n\t\t}\n\n\t\tif ( writeIndex !== times.length ) {\n\n\t\t\tthis.times = times.slice( 0, writeIndex );\n\t\t\tthis.values = values.slice( 0, writeIndex * stride );\n\n\t\t} else {\n\n\t\t\tthis.times = times;\n\t\t\tthis.values = values;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\tconst times = this.times.slice();\n\t\tconst values = this.values.slice();\n\n\t\tconst TypedKeyframeTrack = this.constructor;\n\t\tconst track = new TypedKeyframeTrack( this.name, times, values );\n\n\t\t// Interpolant argument to constructor is not saved, so copy the factory method directly.\n\t\ttrack.createInterpolant = this.createInterpolant;\n\n\t\treturn track;\n\n\t}\n\n}\n\nKeyframeTrack.prototype.TimeBufferType = Float32Array;\nKeyframeTrack.prototype.ValueBufferType = Float32Array;\nKeyframeTrack.prototype.DefaultInterpolation = InterpolateLinear;\n\n/**\n * A Track of Boolean keyframe values.\n */\nclass BooleanKeyframeTrack extends KeyframeTrack {\n\n\t// No interpolation parameter because only InterpolateDiscrete is valid.\n\tconstructor( name, times, values ) {\n\n\t\tsuper( name, times, values );\n\n\t}\n\n}\n\nBooleanKeyframeTrack.prototype.ValueTypeName = 'bool';\nBooleanKeyframeTrack.prototype.ValueBufferType = Array;\nBooleanKeyframeTrack.prototype.DefaultInterpolation = InterpolateDiscrete;\nBooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear = undefined;\nBooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\n/**\n * A Track of keyframe values that represent color.\n */\nclass ColorKeyframeTrack extends KeyframeTrack {}\n\nColorKeyframeTrack.prototype.ValueTypeName = 'color';\n\n/**\n * A Track of numeric keyframe values.\n */\nclass NumberKeyframeTrack extends KeyframeTrack {}\n\nNumberKeyframeTrack.prototype.ValueTypeName = 'number';\n\n/**\n * Spherical linear unit quaternion interpolant.\n */\n\nclass QuaternionLinearInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\talpha = ( t - t0 ) / ( t1 - t0 );\n\n\t\tlet offset = i1 * stride;\n\n\t\tfor ( let end = offset + stride; offset !== end; offset += 4 ) {\n\n\t\t\tQuaternion.slerpFlat( result, 0, values, offset - stride, values, offset, alpha );\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\n/**\n * A Track of quaternion keyframe values.\n */\nclass QuaternionKeyframeTrack extends KeyframeTrack {\n\n\tInterpolantFactoryMethodLinear( result ) {\n\n\t\treturn new QuaternionLinearInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n}\n\nQuaternionKeyframeTrack.prototype.ValueTypeName = 'quaternion';\n// ValueBufferType is inherited\n// DefaultInterpolation is inherited;\nQuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\n/**\n * A Track that interpolates Strings\n */\nclass StringKeyframeTrack extends KeyframeTrack {\n\n\t// No interpolation parameter because only InterpolateDiscrete is valid.\n\tconstructor( name, times, values ) {\n\n\t\tsuper( name, times, values );\n\n\t}\n\n}\n\nStringKeyframeTrack.prototype.ValueTypeName = 'string';\nStringKeyframeTrack.prototype.ValueBufferType = Array;\nStringKeyframeTrack.prototype.DefaultInterpolation = InterpolateDiscrete;\nStringKeyframeTrack.prototype.InterpolantFactoryMethodLinear = undefined;\nStringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\n/**\n * A Track of vectored keyframe values.\n */\nclass VectorKeyframeTrack extends KeyframeTrack {}\n\nVectorKeyframeTrack.prototype.ValueTypeName = 'vector';\n\nclass AnimationClip {\n\n\tconstructor( name = '', duration = - 1, tracks = [], blendMode = NormalAnimationBlendMode ) {\n\n\t\tthis.name = name;\n\t\tthis.tracks = tracks;\n\t\tthis.duration = duration;\n\t\tthis.blendMode = blendMode;\n\n\t\tthis.uuid = generateUUID();\n\n\t\t// this means it should figure out its duration by scanning the tracks\n\t\tif ( this.duration < 0 ) {\n\n\t\t\tthis.resetDuration();\n\n\t\t}\n\n\t}\n\n\n\tstatic parse( json ) {\n\n\t\tconst tracks = [],\n\t\t\tjsonTracks = json.tracks,\n\t\t\tframeTime = 1.0 / ( json.fps || 1.0 );\n\n\t\tfor ( let i = 0, n = jsonTracks.length; i !== n; ++ i ) {\n\n\t\t\ttracks.push( parseKeyframeTrack( jsonTracks[ i ] ).scale( frameTime ) );\n\n\t\t}\n\n\t\tconst clip = new this( json.name, json.duration, tracks, json.blendMode );\n\t\tclip.uuid = json.uuid;\n\n\t\treturn clip;\n\n\t}\n\n\tstatic toJSON( clip ) {\n\n\t\tconst tracks = [],\n\t\t\tclipTracks = clip.tracks;\n\n\t\tconst json = {\n\n\t\t\t'name': clip.name,\n\t\t\t'duration': clip.duration,\n\t\t\t'tracks': tracks,\n\t\t\t'uuid': clip.uuid,\n\t\t\t'blendMode': clip.blendMode\n\n\t\t};\n\n\t\tfor ( let i = 0, n = clipTracks.length; i !== n; ++ i ) {\n\n\t\t\ttracks.push( KeyframeTrack.toJSON( clipTracks[ i ] ) );\n\n\t\t}\n\n\t\treturn json;\n\n\t}\n\n\tstatic CreateFromMorphTargetSequence( name, morphTargetSequence, fps, noLoop ) {\n\n\t\tconst numMorphTargets = morphTargetSequence.length;\n\t\tconst tracks = [];\n\n\t\tfor ( let i = 0; i < numMorphTargets; i ++ ) {\n\n\t\t\tlet times = [];\n\t\t\tlet values = [];\n\n\t\t\ttimes.push(\n\t\t\t\t( i + numMorphTargets - 1 ) % numMorphTargets,\n\t\t\t\ti,\n\t\t\t\t( i + 1 ) % numMorphTargets );\n\n\t\t\tvalues.push( 0, 1, 0 );\n\n\t\t\tconst order = getKeyframeOrder( times );\n\t\t\ttimes = sortedArray( times, 1, order );\n\t\t\tvalues = sortedArray( values, 1, order );\n\n\t\t\t// if there is a key at the first frame, duplicate it as the\n\t\t\t// last frame as well for perfect loop.\n\t\t\tif ( ! noLoop && times[ 0 ] === 0 ) {\n\n\t\t\t\ttimes.push( numMorphTargets );\n\t\t\t\tvalues.push( values[ 0 ] );\n\n\t\t\t}\n\n\t\t\ttracks.push(\n\t\t\t\tnew NumberKeyframeTrack(\n\t\t\t\t\t'.morphTargetInfluences[' + morphTargetSequence[ i ].name + ']',\n\t\t\t\t\ttimes, values\n\t\t\t\t).scale( 1.0 / fps ) );\n\n\t\t}\n\n\t\treturn new this( name, - 1, tracks );\n\n\t}\n\n\tstatic findByName( objectOrClipArray, name ) {\n\n\t\tlet clipArray = objectOrClipArray;\n\n\t\tif ( ! Array.isArray( objectOrClipArray ) ) {\n\n\t\t\tconst o = objectOrClipArray;\n\t\t\tclipArray = o.geometry && o.geometry.animations || o.animations;\n\n\t\t}\n\n\t\tfor ( let i = 0; i < clipArray.length; i ++ ) {\n\n\t\t\tif ( clipArray[ i ].name === name ) {\n\n\t\t\t\treturn clipArray[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tstatic CreateClipsFromMorphTargetSequences( morphTargets, fps, noLoop ) {\n\n\t\tconst animationToMorphTargets = {};\n\n\t\t// tested with https://regex101.com/ on trick sequences\n\t\t// such flamingo_flyA_003, flamingo_run1_003, crdeath0059\n\t\tconst pattern = /^([\\w-]*?)([\\d]+)$/;\n\n\t\t// sort morph target names into animation groups based\n\t\t// patterns like Walk_001, Walk_002, Run_001, Run_002\n\t\tfor ( let i = 0, il = morphTargets.length; i < il; i ++ ) {\n\n\t\t\tconst morphTarget = morphTargets[ i ];\n\t\t\tconst parts = morphTarget.name.match( pattern );\n\n\t\t\tif ( parts && parts.length > 1 ) {\n\n\t\t\t\tconst name = parts[ 1 ];\n\n\t\t\t\tlet animationMorphTargets = animationToMorphTargets[ name ];\n\n\t\t\t\tif ( ! animationMorphTargets ) {\n\n\t\t\t\t\tanimationToMorphTargets[ name ] = animationMorphTargets = [];\n\n\t\t\t\t}\n\n\t\t\t\tanimationMorphTargets.push( morphTarget );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst clips = [];\n\n\t\tfor ( const name in animationToMorphTargets ) {\n\n\t\t\tclips.push( this.CreateFromMorphTargetSequence( name, animationToMorphTargets[ name ], fps, noLoop ) );\n\n\t\t}\n\n\t\treturn clips;\n\n\t}\n\n\t// parse the animation.hierarchy format\n\tstatic parseAnimation( animation, bones ) {\n\n\t\tif ( ! animation ) {\n\n\t\t\tconsole.error( 'THREE.AnimationClip: No animation in JSONLoader data.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst addNonemptyTrack = function ( trackType, trackName, animationKeys, propertyName, destTracks ) {\n\n\t\t\t// only return track if there are actually keys.\n\t\t\tif ( animationKeys.length !== 0 ) {\n\n\t\t\t\tconst times = [];\n\t\t\t\tconst values = [];\n\n\t\t\t\tflattenJSON( animationKeys, times, values, propertyName );\n\n\t\t\t\t// empty keys are filtered out, so check again\n\t\t\t\tif ( times.length !== 0 ) {\n\n\t\t\t\t\tdestTracks.push( new trackType( trackName, times, values ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tconst tracks = [];\n\n\t\tconst clipName = animation.name || 'default';\n\t\tconst fps = animation.fps || 30;\n\t\tconst blendMode = animation.blendMode;\n\n\t\t// automatic length determination in AnimationClip.\n\t\tlet duration = animation.length || - 1;\n\n\t\tconst hierarchyTracks = animation.hierarchy || [];\n\n\t\tfor ( let h = 0; h < hierarchyTracks.length; h ++ ) {\n\n\t\t\tconst animationKeys = hierarchyTracks[ h ].keys;\n\n\t\t\t// skip empty tracks\n\t\t\tif ( ! animationKeys || animationKeys.length === 0 ) continue;\n\n\t\t\t// process morph targets\n\t\t\tif ( animationKeys[ 0 ].morphTargets ) {\n\n\t\t\t\t// figure out all morph targets used in this track\n\t\t\t\tconst morphTargetNames = {};\n\n\t\t\t\tlet k;\n\n\t\t\t\tfor ( k = 0; k < animationKeys.length; k ++ ) {\n\n\t\t\t\t\tif ( animationKeys[ k ].morphTargets ) {\n\n\t\t\t\t\t\tfor ( let m = 0; m < animationKeys[ k ].morphTargets.length; m ++ ) {\n\n\t\t\t\t\t\t\tmorphTargetNames[ animationKeys[ k ].morphTargets[ m ] ] = - 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// create a track for each morph target with all zero\n\t\t\t\t// morphTargetInfluences except for the keys in which\n\t\t\t\t// the morphTarget is named.\n\t\t\t\tfor ( const morphTargetName in morphTargetNames ) {\n\n\t\t\t\t\tconst times = [];\n\t\t\t\t\tconst values = [];\n\n\t\t\t\t\tfor ( let m = 0; m !== animationKeys[ k ].morphTargets.length; ++ m ) {\n\n\t\t\t\t\t\tconst animationKey = animationKeys[ k ];\n\n\t\t\t\t\t\ttimes.push( animationKey.time );\n\t\t\t\t\t\tvalues.push( ( animationKey.morphTarget === morphTargetName ) ? 1 : 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttracks.push( new NumberKeyframeTrack( '.morphTargetInfluence[' + morphTargetName + ']', times, values ) );\n\n\t\t\t\t}\n\n\t\t\t\tduration = morphTargetNames.length * fps;\n\n\t\t\t} else {\n\n\t\t\t\t// ...assume skeletal animation\n\n\t\t\t\tconst boneName = '.bones[' + bones[ h ].name + ']';\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tVectorKeyframeTrack, boneName + '.position',\n\t\t\t\t\tanimationKeys, 'pos', tracks );\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tQuaternionKeyframeTrack, boneName + '.quaternion',\n\t\t\t\t\tanimationKeys, 'rot', tracks );\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tVectorKeyframeTrack, boneName + '.scale',\n\t\t\t\t\tanimationKeys, 'scl', tracks );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( tracks.length === 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst clip = new this( clipName, duration, tracks, blendMode );\n\n\t\treturn clip;\n\n\t}\n\n\tresetDuration() {\n\n\t\tconst tracks = this.tracks;\n\t\tlet duration = 0;\n\n\t\tfor ( let i = 0, n = tracks.length; i !== n; ++ i ) {\n\n\t\t\tconst track = this.tracks[ i ];\n\n\t\t\tduration = Math.max( duration, track.times[ track.times.length - 1 ] );\n\n\t\t}\n\n\t\tthis.duration = duration;\n\n\t\treturn this;\n\n\t}\n\n\ttrim() {\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tthis.tracks[ i ].trim( 0, this.duration );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tvalidate() {\n\n\t\tlet valid = true;\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tvalid = valid && this.tracks[ i ].validate();\n\n\t\t}\n\n\t\treturn valid;\n\n\t}\n\n\toptimize() {\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tthis.tracks[ i ].optimize();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\tconst tracks = [];\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\ttracks.push( this.tracks[ i ].clone() );\n\n\t\t}\n\n\t\treturn new this.constructor( this.name, this.duration, tracks, this.blendMode );\n\n\t}\n\n\ttoJSON() {\n\n\t\treturn this.constructor.toJSON( this );\n\n\t}\n\n}\n\nfunction getTrackTypeForValueTypeName( typeName ) {\n\n\tswitch ( typeName.toLowerCase() ) {\n\n\t\tcase 'scalar':\n\t\tcase 'double':\n\t\tcase 'float':\n\t\tcase 'number':\n\t\tcase 'integer':\n\n\t\t\treturn NumberKeyframeTrack;\n\n\t\tcase 'vector':\n\t\tcase 'vector2':\n\t\tcase 'vector3':\n\t\tcase 'vector4':\n\n\t\t\treturn VectorKeyframeTrack;\n\n\t\tcase 'color':\n\n\t\t\treturn ColorKeyframeTrack;\n\n\t\tcase 'quaternion':\n\n\t\t\treturn QuaternionKeyframeTrack;\n\n\t\tcase 'bool':\n\t\tcase 'boolean':\n\n\t\t\treturn BooleanKeyframeTrack;\n\n\t\tcase 'string':\n\n\t\t\treturn StringKeyframeTrack;\n\n\t}\n\n\tthrow new Error( 'THREE.KeyframeTrack: Unsupported typeName: ' + typeName );\n\n}\n\nfunction parseKeyframeTrack( json ) {\n\n\tif ( json.type === undefined ) {\n\n\t\tthrow new Error( 'THREE.KeyframeTrack: track type undefined, can not parse' );\n\n\t}\n\n\tconst trackType = getTrackTypeForValueTypeName( json.type );\n\n\tif ( json.times === undefined ) {\n\n\t\tconst times = [], values = [];\n\n\t\tflattenJSON( json.keys, times, values, 'value' );\n\n\t\tjson.times = times;\n\t\tjson.values = values;\n\n\t}\n\n\t// derived classes can define a static parse method\n\tif ( trackType.parse !== undefined ) {\n\n\t\treturn trackType.parse( json );\n\n\t} else {\n\n\t\t// by default, we assume a constructor compatible with the base\n\t\treturn new trackType( json.name, json.times, json.values, json.interpolation );\n\n\t}\n\n}\n\nconst Cache = {\n\n\tenabled: false,\n\n\tfiles: {},\n\n\tadd: function ( key, file ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\n\n\t\tthis.files[ key ] = file;\n\n\t},\n\n\tget: function ( key ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\n\n\t\treturn this.files[ key ];\n\n\t},\n\n\tremove: function ( key ) {\n\n\t\tdelete this.files[ key ];\n\n\t},\n\n\tclear: function () {\n\n\t\tthis.files = {};\n\n\t}\n\n};\n\nclass LoadingManager {\n\n\tconstructor( onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tlet isLoading = false;\n\t\tlet itemsLoaded = 0;\n\t\tlet itemsTotal = 0;\n\t\tlet urlModifier = undefined;\n\t\tconst handlers = [];\n\n\t\t// Refer to #5689 for the reason why we don't set .onStart\n\t\t// in the constructor\n\n\t\tthis.onStart = undefined;\n\t\tthis.onLoad = onLoad;\n\t\tthis.onProgress = onProgress;\n\t\tthis.onError = onError;\n\n\t\tthis.itemStart = function ( url ) {\n\n\t\t\titemsTotal ++;\n\n\t\t\tif ( isLoading === false ) {\n\n\t\t\t\tif ( scope.onStart !== undefined ) {\n\n\t\t\t\t\tscope.onStart( url, itemsLoaded, itemsTotal );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tisLoading = true;\n\n\t\t};\n\n\t\tthis.itemEnd = function ( url ) {\n\n\t\t\titemsLoaded ++;\n\n\t\t\tif ( scope.onProgress !== undefined ) {\n\n\t\t\t\tscope.onProgress( url, itemsLoaded, itemsTotal );\n\n\t\t\t}\n\n\t\t\tif ( itemsLoaded === itemsTotal ) {\n\n\t\t\t\tisLoading = false;\n\n\t\t\t\tif ( scope.onLoad !== undefined ) {\n\n\t\t\t\t\tscope.onLoad();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.itemError = function ( url ) {\n\n\t\t\tif ( scope.onError !== undefined ) {\n\n\t\t\t\tscope.onError( url );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.resolveURL = function ( url ) {\n\n\t\t\tif ( urlModifier ) {\n\n\t\t\t\treturn urlModifier( url );\n\n\t\t\t}\n\n\t\t\treturn url;\n\n\t\t};\n\n\t\tthis.setURLModifier = function ( transform ) {\n\n\t\t\turlModifier = transform;\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.addHandler = function ( regex, loader ) {\n\n\t\t\thandlers.push( regex, loader );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.removeHandler = function ( regex ) {\n\n\t\t\tconst index = handlers.indexOf( regex );\n\n\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\thandlers.splice( index, 2 );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.getHandler = function ( file ) {\n\n\t\t\tfor ( let i = 0, l = handlers.length; i < l; i += 2 ) {\n\n\t\t\t\tconst regex = handlers[ i ];\n\t\t\t\tconst loader = handlers[ i + 1 ];\n\n\t\t\t\tif ( regex.global ) regex.lastIndex = 0; // see #17920\n\n\t\t\t\tif ( regex.test( file ) ) {\n\n\t\t\t\t\treturn loader;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn null;\n\n\t\t};\n\n\t}\n\n}\n\nconst DefaultLoadingManager = /*@__PURE__*/ new LoadingManager();\n\nclass Loader {\n\n\tconstructor( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t\tthis.crossOrigin = 'anonymous';\n\t\tthis.withCredentials = false;\n\t\tthis.path = '';\n\t\tthis.resourcePath = '';\n\t\tthis.requestHeader = {};\n\n\t}\n\n\tload( /* url, onLoad, onProgress, onError */ ) {}\n\n\tloadAsync( url, onProgress ) {\n\n\t\tconst scope = this;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tscope.load( url, resolve, onProgress, reject );\n\n\t\t} );\n\n\t}\n\n\tparse( /* data */ ) {}\n\n\tsetCrossOrigin( crossOrigin ) {\n\n\t\tthis.crossOrigin = crossOrigin;\n\t\treturn this;\n\n\t}\n\n\tsetWithCredentials( value ) {\n\n\t\tthis.withCredentials = value;\n\t\treturn this;\n\n\t}\n\n\tsetPath( path ) {\n\n\t\tthis.path = path;\n\t\treturn this;\n\n\t}\n\n\tsetResourcePath( resourcePath ) {\n\n\t\tthis.resourcePath = resourcePath;\n\t\treturn this;\n\n\t}\n\n\tsetRequestHeader( requestHeader ) {\n\n\t\tthis.requestHeader = requestHeader;\n\t\treturn this;\n\n\t}\n\n}\n\nLoader.DEFAULT_MATERIAL_NAME = '__DEFAULT';\n\nconst loading = {};\n\nclass HttpError extends Error {\n\n\tconstructor( message, response ) {\n\n\t\tsuper( message );\n\t\tthis.response = response;\n\n\t}\n\n}\n\nclass FileLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( url === undefined ) url = '';\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tthis.manager.itemStart( url );\n\n\t\t\tsetTimeout( () => {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tthis.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\t// Check if request is duplicate\n\n\t\tif ( loading[ url ] !== undefined ) {\n\n\t\t\tloading[ url ].push( {\n\n\t\t\t\tonLoad: onLoad,\n\t\t\t\tonProgress: onProgress,\n\t\t\t\tonError: onError\n\n\t\t\t} );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Initialise array for duplicate requests\n\t\tloading[ url ] = [];\n\n\t\tloading[ url ].push( {\n\t\t\tonLoad: onLoad,\n\t\t\tonProgress: onProgress,\n\t\t\tonError: onError,\n\t\t} );\n\n\t\t// create request\n\t\tconst req = new Request( url, {\n\t\t\theaders: new Headers( this.requestHeader ),\n\t\t\tcredentials: this.withCredentials ? 'include' : 'same-origin',\n\t\t\t// An abort controller could be added within a future PR\n\t\t} );\n\n\t\t// record states ( avoid data race )\n\t\tconst mimeType = this.mimeType;\n\t\tconst responseType = this.responseType;\n\n\t\t// start the fetch\n\t\tfetch( req )\n\t\t\t.then( response => {\n\n\t\t\t\tif ( response.status === 200 || response.status === 0 ) {\n\n\t\t\t\t\t// Some browsers return HTTP Status 0 when using non-http protocol\n\t\t\t\t\t// e.g. 'file://' or 'data://'. Handle as success.\n\n\t\t\t\t\tif ( response.status === 0 ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.FileLoader: HTTP Status 0 received.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Workaround: Checking if response.body === undefined for Alipay browser #23548\n\n\t\t\t\t\tif ( typeof ReadableStream === 'undefined' || response.body === undefined || response.body.getReader === undefined ) {\n\n\t\t\t\t\t\treturn response;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst callbacks = loading[ url ];\n\t\t\t\t\tconst reader = response.body.getReader();\n\n\t\t\t\t\t// Nginx needs X-File-Size check\n\t\t\t\t\t// https://serverfault.com/questions/482875/why-does-nginx-remove-content-length-header-for-chunked-content\n\t\t\t\t\tconst contentLength = response.headers.get( 'X-File-Size' ) || response.headers.get( 'Content-Length' );\n\t\t\t\t\tconst total = contentLength ? parseInt( contentLength ) : 0;\n\t\t\t\t\tconst lengthComputable = total !== 0;\n\t\t\t\t\tlet loaded = 0;\n\n\t\t\t\t\t// periodically read data into the new stream tracking while download progress\n\t\t\t\t\tconst stream = new ReadableStream( {\n\t\t\t\t\t\tstart( controller ) {\n\n\t\t\t\t\t\t\treadData();\n\n\t\t\t\t\t\t\tfunction readData() {\n\n\t\t\t\t\t\t\t\treader.read().then( ( { done, value } ) => {\n\n\t\t\t\t\t\t\t\t\tif ( done ) {\n\n\t\t\t\t\t\t\t\t\t\tcontroller.close();\n\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\tloaded += value.byteLength;\n\n\t\t\t\t\t\t\t\t\t\tconst event = new ProgressEvent( 'progress', { lengthComputable, loaded, total } );\n\t\t\t\t\t\t\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\t\t\t\t\t\t\tif ( callback.onProgress ) callback.onProgress( event );\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tcontroller.enqueue( value );\n\t\t\t\t\t\t\t\t\t\treadData();\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}, ( e ) => {\n\n\t\t\t\t\t\t\t\t\tcontroller.error( e );\n\n\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t\treturn new Response( stream );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new HttpError( `fetch for \"${response.url}\" responded with ${response.status}: ${response.statusText}`, response );\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.then( response => {\n\n\t\t\t\tswitch ( responseType ) {\n\n\t\t\t\t\tcase 'arraybuffer':\n\n\t\t\t\t\t\treturn response.arrayBuffer();\n\n\t\t\t\t\tcase 'blob':\n\n\t\t\t\t\t\treturn response.blob();\n\n\t\t\t\t\tcase 'document':\n\n\t\t\t\t\t\treturn response.text()\n\t\t\t\t\t\t\t.then( text => {\n\n\t\t\t\t\t\t\t\tconst parser = new DOMParser();\n\t\t\t\t\t\t\t\treturn parser.parseFromString( text, mimeType );\n\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\tcase 'json':\n\n\t\t\t\t\t\treturn response.json();\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( mimeType === undefined ) {\n\n\t\t\t\t\t\t\treturn response.text();\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// sniff encoding\n\t\t\t\t\t\t\tconst re = /charset=\"?([^;\"\\s]*)\"?/i;\n\t\t\t\t\t\t\tconst exec = re.exec( mimeType );\n\t\t\t\t\t\t\tconst label = exec && exec[ 1 ] ? exec[ 1 ].toLowerCase() : undefined;\n\t\t\t\t\t\t\tconst decoder = new TextDecoder( label );\n\t\t\t\t\t\t\treturn response.arrayBuffer().then( ab => decoder.decode( ab ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.then( data => {\n\n\t\t\t\t// Add to cache only on HTTP success, so that we do not cache\n\t\t\t\t// error response bodies as proper responses to requests.\n\t\t\t\tCache.add( url, data );\n\n\t\t\t\tconst callbacks = loading[ url ];\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onLoad ) callback.onLoad( data );\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.catch( err => {\n\n\t\t\t\t// Abort errors and other errors are handled the same\n\n\t\t\t\tconst callbacks = loading[ url ];\n\n\t\t\t\tif ( callbacks === undefined ) {\n\n\t\t\t\t\t// When onLoad was called and url was deleted in `loading`\n\t\t\t\t\tthis.manager.itemError( url );\n\t\t\t\t\tthrow err;\n\n\t\t\t\t}\n\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onError ) callback.onError( err );\n\n\t\t\t\t}\n\n\t\t\t\tthis.manager.itemError( url );\n\n\t\t\t} )\n\t\t\t.finally( () => {\n\n\t\t\t\tthis.manager.itemEnd( url );\n\n\t\t\t} );\n\n\t\tthis.manager.itemStart( url );\n\n\t}\n\n\tsetResponseType( value ) {\n\n\t\tthis.responseType = value;\n\t\treturn this;\n\n\t}\n\n\tsetMimeType( value ) {\n\n\t\tthis.mimeType = value;\n\t\treturn this;\n\n\t}\n\n}\n\nclass AnimationLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst animations = [];\n\n\t\tfor ( let i = 0; i < json.length; i ++ ) {\n\n\t\t\tconst clip = AnimationClip.parse( json[ i ] );\n\n\t\t\tanimations.push( clip );\n\n\t\t}\n\n\t\treturn animations;\n\n\t}\n\n}\n\n/**\n * Abstract Base class to block based textures loader (dds, pvr, ...)\n *\n * Sub classes have to implement the parse() method which will be used in load().\n */\n\nclass CompressedTextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst images = [];\n\n\t\tconst texture = new CompressedTexture();\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\n\t\tlet loaded = 0;\n\n\t\tfunction loadTexture( i ) {\n\n\t\t\tloader.load( url[ i ], function ( buffer ) {\n\n\t\t\t\tconst texDatas = scope.parse( buffer, true );\n\n\t\t\t\timages[ i ] = {\n\t\t\t\t\twidth: texDatas.width,\n\t\t\t\t\theight: texDatas.height,\n\t\t\t\t\tformat: texDatas.format,\n\t\t\t\t\tmipmaps: texDatas.mipmaps\n\t\t\t\t};\n\n\t\t\t\tloaded += 1;\n\n\t\t\t\tif ( loaded === 6 ) {\n\n\t\t\t\t\tif ( texDatas.mipmapCount === 1 ) texture.minFilter = LinearFilter;\n\n\t\t\t\t\ttexture.image = images;\n\t\t\t\t\ttexture.format = texDatas.format;\n\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t\t}\n\n\t\t\t}, onProgress, onError );\n\n\t\t}\n\n\t\tif ( Array.isArray( url ) ) {\n\n\t\t\tfor ( let i = 0, il = url.length; i < il; ++ i ) {\n\n\t\t\t\tloadTexture( i );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// compressed cubemap texture stored in a single DDS file\n\n\t\t\tloader.load( url, function ( buffer ) {\n\n\t\t\t\tconst texDatas = scope.parse( buffer, true );\n\n\t\t\t\tif ( texDatas.isCubemap ) {\n\n\t\t\t\t\tconst faces = texDatas.mipmaps.length / texDatas.mipmapCount;\n\n\t\t\t\t\tfor ( let f = 0; f < faces; f ++ ) {\n\n\t\t\t\t\t\timages[ f ] = { mipmaps: [] };\n\n\t\t\t\t\t\tfor ( let i = 0; i < texDatas.mipmapCount; i ++ ) {\n\n\t\t\t\t\t\t\timages[ f ].mipmaps.push( texDatas.mipmaps[ f * texDatas.mipmapCount + i ] );\n\t\t\t\t\t\t\timages[ f ].format = texDatas.format;\n\t\t\t\t\t\t\timages[ f ].width = texDatas.width;\n\t\t\t\t\t\t\timages[ f ].height = texDatas.height;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttexture.image = images;\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttexture.image.width = texDatas.width;\n\t\t\t\t\ttexture.image.height = texDatas.height;\n\t\t\t\t\ttexture.mipmaps = texDatas.mipmaps;\n\n\t\t\t\t}\n\n\t\t\t\tif ( texDatas.mipmapCount === 1 ) {\n\n\t\t\t\t\ttexture.minFilter = LinearFilter;\n\n\t\t\t\t}\n\n\t\t\t\ttexture.format = texDatas.format;\n\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t}, onProgress, onError );\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n}\n\nclass ImageLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst scope = this;\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tconst image = createElementNS( 'img' );\n\n\t\tfunction onImageLoad() {\n\n\t\t\tremoveEventListeners();\n\n\t\t\tCache.add( url, this );\n\n\t\t\tif ( onLoad ) onLoad( this );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}\n\n\t\tfunction onImageError( event ) {\n\n\t\t\tremoveEventListeners();\n\n\t\t\tif ( onError ) onError( event );\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}\n\n\t\tfunction removeEventListeners() {\n\n\t\t\timage.removeEventListener( 'load', onImageLoad, false );\n\t\t\timage.removeEventListener( 'error', onImageError, false );\n\n\t\t}\n\n\t\timage.addEventListener( 'load', onImageLoad, false );\n\t\timage.addEventListener( 'error', onImageError, false );\n\n\t\tif ( url.slice( 0, 5 ) !== 'data:' ) {\n\n\t\t\tif ( this.crossOrigin !== undefined ) image.crossOrigin = this.crossOrigin;\n\n\t\t}\n\n\t\tscope.manager.itemStart( url );\n\n\t\timage.src = url;\n\n\t\treturn image;\n\n\t}\n\n}\n\nclass CubeTextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( urls, onLoad, onProgress, onError ) {\n\n\t\tconst texture = new CubeTexture();\n\t\ttexture.colorSpace = SRGBColorSpace;\n\n\t\tconst loader = new ImageLoader( this.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.setPath( this.path );\n\n\t\tlet loaded = 0;\n\n\t\tfunction loadTexture( i ) {\n\n\t\t\tloader.load( urls[ i ], function ( image ) {\n\n\t\t\t\ttexture.images[ i ] = image;\n\n\t\t\t\tloaded ++;\n\n\t\t\t\tif ( loaded === 6 ) {\n\n\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t\t}\n\n\t\t\t}, undefined, onError );\n\n\t\t}\n\n\t\tfor ( let i = 0; i < urls.length; ++ i ) {\n\n\t\t\tloadTexture( i );\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n}\n\n/**\n * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\n *\n * Sub classes have to implement the parse() method which will be used in load().\n */\n\nclass DataTextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst texture = new DataTexture();\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setPath( this.path );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\tlet texData;\n\n\t\t\ttry {\n\n\t\t\t\ttexData = scope.parse( buffer );\n\n\t\t\t} catch ( error ) {\n\n\t\t\t\tif ( onError !== undefined ) {\n\n\t\t\t\t\tonError( error );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( error );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( texData.image !== undefined ) {\n\n\t\t\t\ttexture.image = texData.image;\n\n\t\t\t} else if ( texData.data !== undefined ) {\n\n\t\t\t\ttexture.image.width = texData.width;\n\t\t\t\ttexture.image.height = texData.height;\n\t\t\t\ttexture.image.data = texData.data;\n\n\t\t\t}\n\n\t\t\ttexture.wrapS = texData.wrapS !== undefined ? texData.wrapS : ClampToEdgeWrapping;\n\t\t\ttexture.wrapT = texData.wrapT !== undefined ? texData.wrapT : ClampToEdgeWrapping;\n\n\t\t\ttexture.magFilter = texData.magFilter !== undefined ? texData.magFilter : LinearFilter;\n\t\t\ttexture.minFilter = texData.minFilter !== undefined ? texData.minFilter : LinearFilter;\n\n\t\t\ttexture.anisotropy = texData.anisotropy !== undefined ? texData.anisotropy : 1;\n\n\t\t\tif ( texData.colorSpace !== undefined ) {\n\n\t\t\t\ttexture.colorSpace = texData.colorSpace;\n\n\t\t\t}\n\n\t\t\tif ( texData.flipY !== undefined ) {\n\n\t\t\t\ttexture.flipY = texData.flipY;\n\n\t\t\t}\n\n\t\t\tif ( texData.format !== undefined ) {\n\n\t\t\t\ttexture.format = texData.format;\n\n\t\t\t}\n\n\t\t\tif ( texData.type !== undefined ) {\n\n\t\t\t\ttexture.type = texData.type;\n\n\t\t\t}\n\n\t\t\tif ( texData.mipmaps !== undefined ) {\n\n\t\t\t\ttexture.mipmaps = texData.mipmaps;\n\t\t\t\ttexture.minFilter = LinearMipmapLinearFilter; // presumably...\n\n\t\t\t}\n\n\t\t\tif ( texData.mipmapCount === 1 ) {\n\n\t\t\t\ttexture.minFilter = LinearFilter;\n\n\t\t\t}\n\n\t\t\tif ( texData.generateMipmaps !== undefined ) {\n\n\t\t\t\ttexture.generateMipmaps = texData.generateMipmaps;\n\n\t\t\t}\n\n\t\t\ttexture.needsUpdate = true;\n\n\t\t\tif ( onLoad ) onLoad( texture, texData );\n\n\t\t}, onProgress, onError );\n\n\n\t\treturn texture;\n\n\t}\n\n}\n\nclass TextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst texture = new Texture();\n\n\t\tconst loader = new ImageLoader( this.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.setPath( this.path );\n\n\t\tloader.load( url, function ( image ) {\n\n\t\t\ttexture.image = image;\n\t\t\ttexture.needsUpdate = true;\n\n\t\t\tif ( onLoad !== undefined ) {\n\n\t\t\t\tonLoad( texture );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t\treturn texture;\n\n\t}\n\n}\n\nclass Light extends Object3D {\n\n\tconstructor( color, intensity = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.isLight = true;\n\n\t\tthis.type = 'Light';\n\n\t\tthis.color = new Color( color );\n\t\tthis.intensity = intensity;\n\n\t}\n\n\tdispose() {\n\n\t\t// Empty here in base class; some subclasses override.\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.color.copy( source.color );\n\t\tthis.intensity = source.intensity;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.color = this.color.getHex();\n\t\tdata.object.intensity = this.intensity;\n\n\t\tif ( this.groundColor !== undefined ) data.object.groundColor = this.groundColor.getHex();\n\n\t\tif ( this.distance !== undefined ) data.object.distance = this.distance;\n\t\tif ( this.angle !== undefined ) data.object.angle = this.angle;\n\t\tif ( this.decay !== undefined ) data.object.decay = this.decay;\n\t\tif ( this.penumbra !== undefined ) data.object.penumbra = this.penumbra;\n\n\t\tif ( this.shadow !== undefined ) data.object.shadow = this.shadow.toJSON();\n\t\tif ( this.target !== undefined ) data.object.target = this.target.uuid;\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass HemisphereLight extends Light {\n\n\tconstructor( skyColor, groundColor, intensity ) {\n\n\t\tsuper( skyColor, intensity );\n\n\t\tthis.isHemisphereLight = true;\n\n\t\tthis.type = 'HemisphereLight';\n\n\t\tthis.position.copy( Object3D.DEFAULT_UP );\n\t\tthis.updateMatrix();\n\n\t\tthis.groundColor = new Color( groundColor );\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.groundColor.copy( source.groundColor );\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _projScreenMatrix$1 = /*@__PURE__*/ new Matrix4();\nconst _lightPositionWorld$1 = /*@__PURE__*/ new Vector3();\nconst _lookTarget$1 = /*@__PURE__*/ new Vector3();\n\nclass LightShadow {\n\n\tconstructor( camera ) {\n\n\t\tthis.camera = camera;\n\n\t\tthis.intensity = 1;\n\n\t\tthis.bias = 0;\n\t\tthis.normalBias = 0;\n\t\tthis.radius = 1;\n\t\tthis.blurSamples = 8;\n\n\t\tthis.mapSize = new Vector2( 512, 512 );\n\n\t\tthis.map = null;\n\t\tthis.mapPass = null;\n\t\tthis.matrix = new Matrix4();\n\n\t\tthis.autoUpdate = true;\n\t\tthis.needsUpdate = false;\n\n\t\tthis._frustum = new Frustum();\n\t\tthis._frameExtents = new Vector2( 1, 1 );\n\n\t\tthis._viewportCount = 1;\n\n\t\tthis._viewports = [\n\n\t\t\tnew Vector4( 0, 0, 1, 1 )\n\n\t\t];\n\n\t}\n\n\tgetViewportCount() {\n\n\t\treturn this._viewportCount;\n\n\t}\n\n\tgetFrustum() {\n\n\t\treturn this._frustum;\n\n\t}\n\n\tupdateMatrices( light ) {\n\n\t\tconst shadowCamera = this.camera;\n\t\tconst shadowMatrix = this.matrix;\n\n\t\t_lightPositionWorld$1.setFromMatrixPosition( light.matrixWorld );\n\t\tshadowCamera.position.copy( _lightPositionWorld$1 );\n\n\t\t_lookTarget$1.setFromMatrixPosition( light.target.matrixWorld );\n\t\tshadowCamera.lookAt( _lookTarget$1 );\n\t\tshadowCamera.updateMatrixWorld();\n\n\t\t_projScreenMatrix$1.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\n\t\tthis._frustum.setFromProjectionMatrix( _projScreenMatrix$1 );\n\n\t\tshadowMatrix.set(\n\t\t\t0.5, 0.0, 0.0, 0.5,\n\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t0.0, 0.0, 0.0, 1.0\n\t\t);\n\n\t\tshadowMatrix.multiply( _projScreenMatrix$1 );\n\n\t}\n\n\tgetViewport( viewportIndex ) {\n\n\t\treturn this._viewports[ viewportIndex ];\n\n\t}\n\n\tgetFrameExtents() {\n\n\t\treturn this._frameExtents;\n\n\t}\n\n\tdispose() {\n\n\t\tif ( this.map ) {\n\n\t\t\tthis.map.dispose();\n\n\t\t}\n\n\t\tif ( this.mapPass ) {\n\n\t\t\tthis.mapPass.dispose();\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.camera = source.camera.clone();\n\n\t\tthis.intensity = source.intensity;\n\n\t\tthis.bias = source.bias;\n\t\tthis.radius = source.radius;\n\n\t\tthis.mapSize.copy( source.mapSize );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst object = {};\n\n\t\tif ( this.intensity !== 1 ) object.intensity = this.intensity;\n\t\tif ( this.bias !== 0 ) object.bias = this.bias;\n\t\tif ( this.normalBias !== 0 ) object.normalBias = this.normalBias;\n\t\tif ( this.radius !== 1 ) object.radius = this.radius;\n\t\tif ( this.mapSize.x !== 512 || this.mapSize.y !== 512 ) object.mapSize = this.mapSize.toArray();\n\n\t\tobject.camera = this.camera.toJSON( false ).object;\n\t\tdelete object.camera.matrix;\n\n\t\treturn object;\n\n\t}\n\n}\n\nclass SpotLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new PerspectiveCamera( 50, 1, 0.5, 500 ) );\n\n\t\tthis.isSpotLightShadow = true;\n\n\t\tthis.focus = 1;\n\n\t}\n\n\tupdateMatrices( light ) {\n\n\t\tconst camera = this.camera;\n\n\t\tconst fov = RAD2DEG * 2 * light.angle * this.focus;\n\t\tconst aspect = this.mapSize.width / this.mapSize.height;\n\t\tconst far = light.distance || camera.far;\n\n\t\tif ( fov !== camera.fov || aspect !== camera.aspect || far !== camera.far ) {\n\n\t\t\tcamera.fov = fov;\n\t\t\tcamera.aspect = aspect;\n\t\t\tcamera.far = far;\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t\tsuper.updateMatrices( light );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.focus = source.focus;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass SpotLight extends Light {\n\n\tconstructor( color, intensity, distance = 0, angle = Math.PI / 3, penumbra = 0, decay = 2 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.isSpotLight = true;\n\n\t\tthis.type = 'SpotLight';\n\n\t\tthis.position.copy( Object3D.DEFAULT_UP );\n\t\tthis.updateMatrix();\n\n\t\tthis.target = new Object3D();\n\n\t\tthis.distance = distance;\n\t\tthis.angle = angle;\n\t\tthis.penumbra = penumbra;\n\t\tthis.decay = decay;\n\n\t\tthis.map = null;\n\n\t\tthis.shadow = new SpotLightShadow();\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in candela)\n\t\t// by convention for a spotlight, luminous power (lm) = π * luminous intensity (cd)\n\t\treturn this.intensity * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in candela) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / Math.PI;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.distance = source.distance;\n\t\tthis.angle = source.angle;\n\t\tthis.penumbra = source.penumbra;\n\t\tthis.decay = source.decay;\n\n\t\tthis.target = source.target.clone();\n\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _projScreenMatrix = /*@__PURE__*/ new Matrix4();\nconst _lightPositionWorld = /*@__PURE__*/ new Vector3();\nconst _lookTarget = /*@__PURE__*/ new Vector3();\n\nclass PointLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new PerspectiveCamera( 90, 1, 0.5, 500 ) );\n\n\t\tthis.isPointLightShadow = true;\n\n\t\tthis._frameExtents = new Vector2( 4, 2 );\n\n\t\tthis._viewportCount = 6;\n\n\t\tthis._viewports = [\n\t\t\t// These viewports map a cube-map onto a 2D texture with the\n\t\t\t// following orientation:\n\t\t\t//\n\t\t\t//  xzXZ\n\t\t\t//   y Y\n\t\t\t//\n\t\t\t// X - Positive x direction\n\t\t\t// x - Negative x direction\n\t\t\t// Y - Positive y direction\n\t\t\t// y - Negative y direction\n\t\t\t// Z - Positive z direction\n\t\t\t// z - Negative z direction\n\n\t\t\t// positive X\n\t\t\tnew Vector4( 2, 1, 1, 1 ),\n\t\t\t// negative X\n\t\t\tnew Vector4( 0, 1, 1, 1 ),\n\t\t\t// positive Z\n\t\t\tnew Vector4( 3, 1, 1, 1 ),\n\t\t\t// negative Z\n\t\t\tnew Vector4( 1, 1, 1, 1 ),\n\t\t\t// positive Y\n\t\t\tnew Vector4( 3, 0, 1, 1 ),\n\t\t\t// negative Y\n\t\t\tnew Vector4( 1, 0, 1, 1 )\n\t\t];\n\n\t\tthis._cubeDirections = [\n\t\t\tnew Vector3( 1, 0, 0 ), new Vector3( - 1, 0, 0 ), new Vector3( 0, 0, 1 ),\n\t\t\tnew Vector3( 0, 0, - 1 ), new Vector3( 0, 1, 0 ), new Vector3( 0, - 1, 0 )\n\t\t];\n\n\t\tthis._cubeUps = [\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ),\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 0, 1 ),\tnew Vector3( 0, 0, - 1 )\n\t\t];\n\n\t}\n\n\tupdateMatrices( light, viewportIndex = 0 ) {\n\n\t\tconst camera = this.camera;\n\t\tconst shadowMatrix = this.matrix;\n\n\t\tconst far = light.distance || camera.far;\n\n\t\tif ( far !== camera.far ) {\n\n\t\t\tcamera.far = far;\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t\t_lightPositionWorld.setFromMatrixPosition( light.matrixWorld );\n\t\tcamera.position.copy( _lightPositionWorld );\n\n\t\t_lookTarget.copy( camera.position );\n\t\t_lookTarget.add( this._cubeDirections[ viewportIndex ] );\n\t\tcamera.up.copy( this._cubeUps[ viewportIndex ] );\n\t\tcamera.lookAt( _lookTarget );\n\t\tcamera.updateMatrixWorld();\n\n\t\tshadowMatrix.makeTranslation( - _lightPositionWorld.x, - _lightPositionWorld.y, - _lightPositionWorld.z );\n\n\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\n\t\tthis._frustum.setFromProjectionMatrix( _projScreenMatrix );\n\n\t}\n\n}\n\nclass PointLight extends Light {\n\n\tconstructor( color, intensity, distance = 0, decay = 2 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.isPointLight = true;\n\n\t\tthis.type = 'PointLight';\n\n\t\tthis.distance = distance;\n\t\tthis.decay = decay;\n\n\t\tthis.shadow = new PointLightShadow();\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in candela)\n\t\t// for an isotropic light source, luminous power (lm) = 4 π luminous intensity (cd)\n\t\treturn this.intensity * 4 * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in candela) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / ( 4 * Math.PI );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.distance = source.distance;\n\t\tthis.decay = source.decay;\n\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass OrthographicCamera extends Camera {\n\n\tconstructor( left = - 1, right = 1, top = 1, bottom = - 1, near = 0.1, far = 2000 ) {\n\n\t\tsuper();\n\n\t\tthis.isOrthographicCamera = true;\n\n\t\tthis.type = 'OrthographicCamera';\n\n\t\tthis.zoom = 1;\n\t\tthis.view = null;\n\n\t\tthis.left = left;\n\t\tthis.right = right;\n\t\tthis.top = top;\n\t\tthis.bottom = bottom;\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.left = source.left;\n\t\tthis.right = source.right;\n\t\tthis.top = source.top;\n\t\tthis.bottom = source.bottom;\n\t\tthis.near = source.near;\n\t\tthis.far = source.far;\n\n\t\tthis.zoom = source.zoom;\n\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\n\t\treturn this;\n\n\t}\n\n\tsetViewOffset( fullWidth, fullHeight, x, y, width, height ) {\n\n\t\tif ( this.view === null ) {\n\n\t\t\tthis.view = {\n\t\t\t\tenabled: true,\n\t\t\t\tfullWidth: 1,\n\t\t\t\tfullHeight: 1,\n\t\t\t\toffsetX: 0,\n\t\t\t\toffsetY: 0,\n\t\t\t\twidth: 1,\n\t\t\t\theight: 1\n\t\t\t};\n\n\t\t}\n\n\t\tthis.view.enabled = true;\n\t\tthis.view.fullWidth = fullWidth;\n\t\tthis.view.fullHeight = fullHeight;\n\t\tthis.view.offsetX = x;\n\t\tthis.view.offsetY = y;\n\t\tthis.view.width = width;\n\t\tthis.view.height = height;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tclearViewOffset() {\n\n\t\tif ( this.view !== null ) {\n\n\t\t\tthis.view.enabled = false;\n\n\t\t}\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tupdateProjectionMatrix() {\n\n\t\tconst dx = ( this.right - this.left ) / ( 2 * this.zoom );\n\t\tconst dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\n\t\tconst cx = ( this.right + this.left ) / 2;\n\t\tconst cy = ( this.top + this.bottom ) / 2;\n\n\t\tlet left = cx - dx;\n\t\tlet right = cx + dx;\n\t\tlet top = cy + dy;\n\t\tlet bottom = cy - dy;\n\n\t\tif ( this.view !== null && this.view.enabled ) {\n\n\t\t\tconst scaleW = ( this.right - this.left ) / this.view.fullWidth / this.zoom;\n\t\t\tconst scaleH = ( this.top - this.bottom ) / this.view.fullHeight / this.zoom;\n\n\t\t\tleft += scaleW * this.view.offsetX;\n\t\t\tright = left + scaleW * this.view.width;\n\t\t\ttop -= scaleH * this.view.offsetY;\n\t\t\tbottom = top - scaleH * this.view.height;\n\n\t\t}\n\n\t\tthis.projectionMatrix.makeOrthographic( left, right, top, bottom, this.near, this.far, this.coordinateSystem );\n\n\t\tthis.projectionMatrixInverse.copy( this.projectionMatrix ).invert();\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.zoom = this.zoom;\n\t\tdata.object.left = this.left;\n\t\tdata.object.right = this.right;\n\t\tdata.object.top = this.top;\n\t\tdata.object.bottom = this.bottom;\n\t\tdata.object.near = this.near;\n\t\tdata.object.far = this.far;\n\n\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass DirectionalLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new OrthographicCamera( - 5, 5, 5, - 5, 0.5, 500 ) );\n\n\t\tthis.isDirectionalLightShadow = true;\n\n\t}\n\n}\n\nclass DirectionalLight extends Light {\n\n\tconstructor( color, intensity ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.isDirectionalLight = true;\n\n\t\tthis.type = 'DirectionalLight';\n\n\t\tthis.position.copy( Object3D.DEFAULT_UP );\n\t\tthis.updateMatrix();\n\n\t\tthis.target = new Object3D();\n\n\t\tthis.shadow = new DirectionalLightShadow();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.target = source.target.clone();\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass AmbientLight extends Light {\n\n\tconstructor( color, intensity ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.isAmbientLight = true;\n\n\t\tthis.type = 'AmbientLight';\n\n\t}\n\n}\n\nclass RectAreaLight extends Light {\n\n\tconstructor( color, intensity, width = 10, height = 10 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.isRectAreaLight = true;\n\n\t\tthis.type = 'RectAreaLight';\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in nits)\n\t\treturn this.intensity * this.width * this.height * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in nits) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / ( this.width * this.height * Math.PI );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.width = source.width;\n\t\tthis.height = source.height;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.width = this.width;\n\t\tdata.object.height = this.height;\n\n\t\treturn data;\n\n\t}\n\n}\n\n/**\n * Primary reference:\n *   https://graphics.stanford.edu/papers/envmap/envmap.pdf\n *\n * Secondary reference:\n *   https://www.ppsloan.org/publications/StupidSH36.pdf\n */\n\n// 3-band SH defined by 9 coefficients\n\nclass SphericalHarmonics3 {\n\n\tconstructor() {\n\n\t\tthis.isSphericalHarmonics3 = true;\n\n\t\tthis.coefficients = [];\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients.push( new Vector3() );\n\n\t\t}\n\n\t}\n\n\tset( coefficients ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].copy( coefficients[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tzero() {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].set( 0, 0, 0 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// get the radiance in the direction of the normal\n\t// target is a Vector3\n\tgetAt( normal, target ) {\n\n\t\t// normal is assumed to be unit length\n\n\t\tconst x = normal.x, y = normal.y, z = normal.z;\n\n\t\tconst coeff = this.coefficients;\n\n\t\t// band 0\n\t\ttarget.copy( coeff[ 0 ] ).multiplyScalar( 0.282095 );\n\n\t\t// band 1\n\t\ttarget.addScaledVector( coeff[ 1 ], 0.488603 * y );\n\t\ttarget.addScaledVector( coeff[ 2 ], 0.488603 * z );\n\t\ttarget.addScaledVector( coeff[ 3 ], 0.488603 * x );\n\n\t\t// band 2\n\t\ttarget.addScaledVector( coeff[ 4 ], 1.092548 * ( x * y ) );\n\t\ttarget.addScaledVector( coeff[ 5 ], 1.092548 * ( y * z ) );\n\t\ttarget.addScaledVector( coeff[ 6 ], 0.315392 * ( 3.0 * z * z - 1.0 ) );\n\t\ttarget.addScaledVector( coeff[ 7 ], 1.092548 * ( x * z ) );\n\t\ttarget.addScaledVector( coeff[ 8 ], 0.546274 * ( x * x - y * y ) );\n\n\t\treturn target;\n\n\t}\n\n\t// get the irradiance (radiance convolved with cosine lobe) in the direction of the normal\n\t// target is a Vector3\n\t// https://graphics.stanford.edu/papers/envmap/envmap.pdf\n\tgetIrradianceAt( normal, target ) {\n\n\t\t// normal is assumed to be unit length\n\n\t\tconst x = normal.x, y = normal.y, z = normal.z;\n\n\t\tconst coeff = this.coefficients;\n\n\t\t// band 0\n\t\ttarget.copy( coeff[ 0 ] ).multiplyScalar( 0.886227 ); // π * 0.282095\n\n\t\t// band 1\n\t\ttarget.addScaledVector( coeff[ 1 ], 2.0 * 0.511664 * y ); // ( 2 * π / 3 ) * 0.488603\n\t\ttarget.addScaledVector( coeff[ 2 ], 2.0 * 0.511664 * z );\n\t\ttarget.addScaledVector( coeff[ 3 ], 2.0 * 0.511664 * x );\n\n\t\t// band 2\n\t\ttarget.addScaledVector( coeff[ 4 ], 2.0 * 0.429043 * x * y ); // ( π / 4 ) * 1.092548\n\t\ttarget.addScaledVector( coeff[ 5 ], 2.0 * 0.429043 * y * z );\n\t\ttarget.addScaledVector( coeff[ 6 ], 0.743125 * z * z - 0.247708 ); // ( π / 4 ) * 0.315392 * 3\n\t\ttarget.addScaledVector( coeff[ 7 ], 2.0 * 0.429043 * x * z );\n\t\ttarget.addScaledVector( coeff[ 8 ], 0.429043 * ( x * x - y * y ) ); // ( π / 4 ) * 0.546274\n\n\t\treturn target;\n\n\t}\n\n\tadd( sh ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].add( sh.coefficients[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\taddScaledSH( sh, s ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].addScaledVector( sh.coefficients[ i ], s );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tscale( s ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].multiplyScalar( s );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tlerp( sh, alpha ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].lerp( sh.coefficients[ i ], alpha );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tequals( sh ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tif ( ! this.coefficients[ i ].equals( sh.coefficients[ i ] ) ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tcopy( sh ) {\n\n\t\treturn this.set( sh.coefficients );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tconst coefficients = this.coefficients;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tcoefficients[ i ].fromArray( array, offset + ( i * 3 ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst coefficients = this.coefficients;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tcoefficients[ i ].toArray( array, offset + ( i * 3 ) );\n\n\t\t}\n\n\t\treturn array;\n\n\t}\n\n\t// evaluate the basis functions\n\t// shBasis is an Array[ 9 ]\n\tstatic getBasisAt( normal, shBasis ) {\n\n\t\t// normal is assumed to be unit length\n\n\t\tconst x = normal.x, y = normal.y, z = normal.z;\n\n\t\t// band 0\n\t\tshBasis[ 0 ] = 0.282095;\n\n\t\t// band 1\n\t\tshBasis[ 1 ] = 0.488603 * y;\n\t\tshBasis[ 2 ] = 0.488603 * z;\n\t\tshBasis[ 3 ] = 0.488603 * x;\n\n\t\t// band 2\n\t\tshBasis[ 4 ] = 1.092548 * x * y;\n\t\tshBasis[ 5 ] = 1.092548 * y * z;\n\t\tshBasis[ 6 ] = 0.315392 * ( 3 * z * z - 1 );\n\t\tshBasis[ 7 ] = 1.092548 * x * z;\n\t\tshBasis[ 8 ] = 0.546274 * ( x * x - y * y );\n\n\t}\n\n}\n\nclass LightProbe extends Light {\n\n\tconstructor( sh = new SphericalHarmonics3(), intensity = 1 ) {\n\n\t\tsuper( undefined, intensity );\n\n\t\tthis.isLightProbe = true;\n\n\t\tthis.sh = sh;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.sh.copy( source.sh );\n\n\t\treturn this;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tthis.intensity = json.intensity; // TODO: Move this bit to Light.fromJSON();\n\t\tthis.sh.fromArray( json.sh );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.sh = this.sh.toArray();\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass MaterialLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\t\tthis.textures = {};\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( scope.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst textures = this.textures;\n\n\t\tfunction getTexture( name ) {\n\n\t\t\tif ( textures[ name ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.MaterialLoader: Undefined texture', name );\n\n\t\t\t}\n\n\t\t\treturn textures[ name ];\n\n\t\t}\n\n\t\tconst material = this.createMaterialFromType( json.type );\n\n\t\tif ( json.uuid !== undefined ) material.uuid = json.uuid;\n\t\tif ( json.name !== undefined ) material.name = json.name;\n\t\tif ( json.color !== undefined && material.color !== undefined ) material.color.setHex( json.color );\n\t\tif ( json.roughness !== undefined ) material.roughness = json.roughness;\n\t\tif ( json.metalness !== undefined ) material.metalness = json.metalness;\n\t\tif ( json.sheen !== undefined ) material.sheen = json.sheen;\n\t\tif ( json.sheenColor !== undefined ) material.sheenColor = new Color().setHex( json.sheenColor );\n\t\tif ( json.sheenRoughness !== undefined ) material.sheenRoughness = json.sheenRoughness;\n\t\tif ( json.emissive !== undefined && material.emissive !== undefined ) material.emissive.setHex( json.emissive );\n\t\tif ( json.specular !== undefined && material.specular !== undefined ) material.specular.setHex( json.specular );\n\t\tif ( json.specularIntensity !== undefined ) material.specularIntensity = json.specularIntensity;\n\t\tif ( json.specularColor !== undefined && material.specularColor !== undefined ) material.specularColor.setHex( json.specularColor );\n\t\tif ( json.shininess !== undefined ) material.shininess = json.shininess;\n\t\tif ( json.clearcoat !== undefined ) material.clearcoat = json.clearcoat;\n\t\tif ( json.clearcoatRoughness !== undefined ) material.clearcoatRoughness = json.clearcoatRoughness;\n\t\tif ( json.dispersion !== undefined ) material.dispersion = json.dispersion;\n\t\tif ( json.iridescence !== undefined ) material.iridescence = json.iridescence;\n\t\tif ( json.iridescenceIOR !== undefined ) material.iridescenceIOR = json.iridescenceIOR;\n\t\tif ( json.iridescenceThicknessRange !== undefined ) material.iridescenceThicknessRange = json.iridescenceThicknessRange;\n\t\tif ( json.transmission !== undefined ) material.transmission = json.transmission;\n\t\tif ( json.thickness !== undefined ) material.thickness = json.thickness;\n\t\tif ( json.attenuationDistance !== undefined ) material.attenuationDistance = json.attenuationDistance;\n\t\tif ( json.attenuationColor !== undefined && material.attenuationColor !== undefined ) material.attenuationColor.setHex( json.attenuationColor );\n\t\tif ( json.anisotropy !== undefined ) material.anisotropy = json.anisotropy;\n\t\tif ( json.anisotropyRotation !== undefined ) material.anisotropyRotation = json.anisotropyRotation;\n\t\tif ( json.fog !== undefined ) material.fog = json.fog;\n\t\tif ( json.flatShading !== undefined ) material.flatShading = json.flatShading;\n\t\tif ( json.blending !== undefined ) material.blending = json.blending;\n\t\tif ( json.combine !== undefined ) material.combine = json.combine;\n\t\tif ( json.side !== undefined ) material.side = json.side;\n\t\tif ( json.shadowSide !== undefined ) material.shadowSide = json.shadowSide;\n\t\tif ( json.opacity !== undefined ) material.opacity = json.opacity;\n\t\tif ( json.transparent !== undefined ) material.transparent = json.transparent;\n\t\tif ( json.alphaTest !== undefined ) material.alphaTest = json.alphaTest;\n\t\tif ( json.alphaHash !== undefined ) material.alphaHash = json.alphaHash;\n\t\tif ( json.depthFunc !== undefined ) material.depthFunc = json.depthFunc;\n\t\tif ( json.depthTest !== undefined ) material.depthTest = json.depthTest;\n\t\tif ( json.depthWrite !== undefined ) material.depthWrite = json.depthWrite;\n\t\tif ( json.colorWrite !== undefined ) material.colorWrite = json.colorWrite;\n\t\tif ( json.blendSrc !== undefined ) material.blendSrc = json.blendSrc;\n\t\tif ( json.blendDst !== undefined ) material.blendDst = json.blendDst;\n\t\tif ( json.blendEquation !== undefined ) material.blendEquation = json.blendEquation;\n\t\tif ( json.blendSrcAlpha !== undefined ) material.blendSrcAlpha = json.blendSrcAlpha;\n\t\tif ( json.blendDstAlpha !== undefined ) material.blendDstAlpha = json.blendDstAlpha;\n\t\tif ( json.blendEquationAlpha !== undefined ) material.blendEquationAlpha = json.blendEquationAlpha;\n\t\tif ( json.blendColor !== undefined && material.blendColor !== undefined ) material.blendColor.setHex( json.blendColor );\n\t\tif ( json.blendAlpha !== undefined ) material.blendAlpha = json.blendAlpha;\n\t\tif ( json.stencilWriteMask !== undefined ) material.stencilWriteMask = json.stencilWriteMask;\n\t\tif ( json.stencilFunc !== undefined ) material.stencilFunc = json.stencilFunc;\n\t\tif ( json.stencilRef !== undefined ) material.stencilRef = json.stencilRef;\n\t\tif ( json.stencilFuncMask !== undefined ) material.stencilFuncMask = json.stencilFuncMask;\n\t\tif ( json.stencilFail !== undefined ) material.stencilFail = json.stencilFail;\n\t\tif ( json.stencilZFail !== undefined ) material.stencilZFail = json.stencilZFail;\n\t\tif ( json.stencilZPass !== undefined ) material.stencilZPass = json.stencilZPass;\n\t\tif ( json.stencilWrite !== undefined ) material.stencilWrite = json.stencilWrite;\n\n\t\tif ( json.wireframe !== undefined ) material.wireframe = json.wireframe;\n\t\tif ( json.wireframeLinewidth !== undefined ) material.wireframeLinewidth = json.wireframeLinewidth;\n\t\tif ( json.wireframeLinecap !== undefined ) material.wireframeLinecap = json.wireframeLinecap;\n\t\tif ( json.wireframeLinejoin !== undefined ) material.wireframeLinejoin = json.wireframeLinejoin;\n\n\t\tif ( json.rotation !== undefined ) material.rotation = json.rotation;\n\n\t\tif ( json.linewidth !== undefined ) material.linewidth = json.linewidth;\n\t\tif ( json.dashSize !== undefined ) material.dashSize = json.dashSize;\n\t\tif ( json.gapSize !== undefined ) material.gapSize = json.gapSize;\n\t\tif ( json.scale !== undefined ) material.scale = json.scale;\n\n\t\tif ( json.polygonOffset !== undefined ) material.polygonOffset = json.polygonOffset;\n\t\tif ( json.polygonOffsetFactor !== undefined ) material.polygonOffsetFactor = json.polygonOffsetFactor;\n\t\tif ( json.polygonOffsetUnits !== undefined ) material.polygonOffsetUnits = json.polygonOffsetUnits;\n\n\t\tif ( json.dithering !== undefined ) material.dithering = json.dithering;\n\n\t\tif ( json.alphaToCoverage !== undefined ) material.alphaToCoverage = json.alphaToCoverage;\n\t\tif ( json.premultipliedAlpha !== undefined ) material.premultipliedAlpha = json.premultipliedAlpha;\n\t\tif ( json.forceSinglePass !== undefined ) material.forceSinglePass = json.forceSinglePass;\n\n\t\tif ( json.visible !== undefined ) material.visible = json.visible;\n\n\t\tif ( json.toneMapped !== undefined ) material.toneMapped = json.toneMapped;\n\n\t\tif ( json.userData !== undefined ) material.userData = json.userData;\n\n\t\tif ( json.vertexColors !== undefined ) {\n\n\t\t\tif ( typeof json.vertexColors === 'number' ) {\n\n\t\t\t\tmaterial.vertexColors = ( json.vertexColors > 0 ) ? true : false;\n\n\t\t\t} else {\n\n\t\t\t\tmaterial.vertexColors = json.vertexColors;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Shader Material\n\n\t\tif ( json.uniforms !== undefined ) {\n\n\t\t\tfor ( const name in json.uniforms ) {\n\n\t\t\t\tconst uniform = json.uniforms[ name ];\n\n\t\t\t\tmaterial.uniforms[ name ] = {};\n\n\t\t\t\tswitch ( uniform.type ) {\n\n\t\t\t\t\tcase 't':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = getTexture( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'c':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Color().setHex( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'v2':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector2().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'v3':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector3().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'v4':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector4().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'm3':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Matrix3().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'm4':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Matrix4().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = uniform.value;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( json.defines !== undefined ) material.defines = json.defines;\n\t\tif ( json.vertexShader !== undefined ) material.vertexShader = json.vertexShader;\n\t\tif ( json.fragmentShader !== undefined ) material.fragmentShader = json.fragmentShader;\n\t\tif ( json.glslVersion !== undefined ) material.glslVersion = json.glslVersion;\n\n\t\tif ( json.extensions !== undefined ) {\n\n\t\t\tfor ( const key in json.extensions ) {\n\n\t\t\t\tmaterial.extensions[ key ] = json.extensions[ key ];\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( json.lights !== undefined ) material.lights = json.lights;\n\t\tif ( json.clipping !== undefined ) material.clipping = json.clipping;\n\n\t\t// for PointsMaterial\n\n\t\tif ( json.size !== undefined ) material.size = json.size;\n\t\tif ( json.sizeAttenuation !== undefined ) material.sizeAttenuation = json.sizeAttenuation;\n\n\t\t// maps\n\n\t\tif ( json.map !== undefined ) material.map = getTexture( json.map );\n\t\tif ( json.matcap !== undefined ) material.matcap = getTexture( json.matcap );\n\n\t\tif ( json.alphaMap !== undefined ) material.alphaMap = getTexture( json.alphaMap );\n\n\t\tif ( json.bumpMap !== undefined ) material.bumpMap = getTexture( json.bumpMap );\n\t\tif ( json.bumpScale !== undefined ) material.bumpScale = json.bumpScale;\n\n\t\tif ( json.normalMap !== undefined ) material.normalMap = getTexture( json.normalMap );\n\t\tif ( json.normalMapType !== undefined ) material.normalMapType = json.normalMapType;\n\t\tif ( json.normalScale !== undefined ) {\n\n\t\t\tlet normalScale = json.normalScale;\n\n\t\t\tif ( Array.isArray( normalScale ) === false ) {\n\n\t\t\t\t// Blender exporter used to export a scalar. See #7459\n\n\t\t\t\tnormalScale = [ normalScale, normalScale ];\n\n\t\t\t}\n\n\t\t\tmaterial.normalScale = new Vector2().fromArray( normalScale );\n\n\t\t}\n\n\t\tif ( json.displacementMap !== undefined ) material.displacementMap = getTexture( json.displacementMap );\n\t\tif ( json.displacementScale !== undefined ) material.displacementScale = json.displacementScale;\n\t\tif ( json.displacementBias !== undefined ) material.displacementBias = json.displacementBias;\n\n\t\tif ( json.roughnessMap !== undefined ) material.roughnessMap = getTexture( json.roughnessMap );\n\t\tif ( json.metalnessMap !== undefined ) material.metalnessMap = getTexture( json.metalnessMap );\n\n\t\tif ( json.emissiveMap !== undefined ) material.emissiveMap = getTexture( json.emissiveMap );\n\t\tif ( json.emissiveIntensity !== undefined ) material.emissiveIntensity = json.emissiveIntensity;\n\n\t\tif ( json.specularMap !== undefined ) material.specularMap = getTexture( json.specularMap );\n\t\tif ( json.specularIntensityMap !== undefined ) material.specularIntensityMap = getTexture( json.specularIntensityMap );\n\t\tif ( json.specularColorMap !== undefined ) material.specularColorMap = getTexture( json.specularColorMap );\n\n\t\tif ( json.envMap !== undefined ) material.envMap = getTexture( json.envMap );\n\t\tif ( json.envMapRotation !== undefined ) material.envMapRotation.fromArray( json.envMapRotation );\n\t\tif ( json.envMapIntensity !== undefined ) material.envMapIntensity = json.envMapIntensity;\n\n\t\tif ( json.reflectivity !== undefined ) material.reflectivity = json.reflectivity;\n\t\tif ( json.refractionRatio !== undefined ) material.refractionRatio = json.refractionRatio;\n\n\t\tif ( json.lightMap !== undefined ) material.lightMap = getTexture( json.lightMap );\n\t\tif ( json.lightMapIntensity !== undefined ) material.lightMapIntensity = json.lightMapIntensity;\n\n\t\tif ( json.aoMap !== undefined ) material.aoMap = getTexture( json.aoMap );\n\t\tif ( json.aoMapIntensity !== undefined ) material.aoMapIntensity = json.aoMapIntensity;\n\n\t\tif ( json.gradientMap !== undefined ) material.gradientMap = getTexture( json.gradientMap );\n\n\t\tif ( json.clearcoatMap !== undefined ) material.clearcoatMap = getTexture( json.clearcoatMap );\n\t\tif ( json.clearcoatRoughnessMap !== undefined ) material.clearcoatRoughnessMap = getTexture( json.clearcoatRoughnessMap );\n\t\tif ( json.clearcoatNormalMap !== undefined ) material.clearcoatNormalMap = getTexture( json.clearcoatNormalMap );\n\t\tif ( json.clearcoatNormalScale !== undefined ) material.clearcoatNormalScale = new Vector2().fromArray( json.clearcoatNormalScale );\n\n\t\tif ( json.iridescenceMap !== undefined ) material.iridescenceMap = getTexture( json.iridescenceMap );\n\t\tif ( json.iridescenceThicknessMap !== undefined ) material.iridescenceThicknessMap = getTexture( json.iridescenceThicknessMap );\n\n\t\tif ( json.transmissionMap !== undefined ) material.transmissionMap = getTexture( json.transmissionMap );\n\t\tif ( json.thicknessMap !== undefined ) material.thicknessMap = getTexture( json.thicknessMap );\n\n\t\tif ( json.anisotropyMap !== undefined ) material.anisotropyMap = getTexture( json.anisotropyMap );\n\n\t\tif ( json.sheenColorMap !== undefined ) material.sheenColorMap = getTexture( json.sheenColorMap );\n\t\tif ( json.sheenRoughnessMap !== undefined ) material.sheenRoughnessMap = getTexture( json.sheenRoughnessMap );\n\n\t\treturn material;\n\n\t}\n\n\tsetTextures( value ) {\n\n\t\tthis.textures = value;\n\t\treturn this;\n\n\t}\n\n\tcreateMaterialFromType( type ) {\n\n\t\treturn MaterialLoader.createMaterialFromType( type );\n\n\t}\n\n\tstatic createMaterialFromType( type ) {\n\n\t\tconst materialLib = {\n\t\t\tShadowMaterial,\n\t\t\tSpriteMaterial,\n\t\t\tRawShaderMaterial,\n\t\t\tShaderMaterial,\n\t\t\tPointsMaterial,\n\t\t\tMeshPhysicalMaterial,\n\t\t\tMeshStandardMaterial,\n\t\t\tMeshPhongMaterial,\n\t\t\tMeshToonMaterial,\n\t\t\tMeshNormalMaterial,\n\t\t\tMeshLambertMaterial,\n\t\t\tMeshDepthMaterial,\n\t\t\tMeshDistanceMaterial,\n\t\t\tMeshBasicMaterial,\n\t\t\tMeshMatcapMaterial,\n\t\t\tLineDashedMaterial,\n\t\t\tLineBasicMaterial,\n\t\t\tMaterial\n\t\t};\n\n\t\treturn new materialLib[ type ]();\n\n\t}\n\n}\n\nclass LoaderUtils {\n\n\tstatic decodeText( array ) { // @deprecated, r165\n\n\t\tconsole.warn( 'THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead.' );\n\n\t\tif ( typeof TextDecoder !== 'undefined' ) {\n\n\t\t\treturn new TextDecoder().decode( array );\n\n\t\t}\n\n\t\t// Avoid the String.fromCharCode.apply(null, array) shortcut, which\n\t\t// throws a \"maximum call stack size exceeded\" error for large arrays.\n\n\t\tlet s = '';\n\n\t\tfor ( let i = 0, il = array.length; i < il; i ++ ) {\n\n\t\t\t// Implicitly assumes little-endian.\n\t\t\ts += String.fromCharCode( array[ i ] );\n\n\t\t}\n\n\t\ttry {\n\n\t\t\t// merges multi-byte utf-8 characters.\n\n\t\t\treturn decodeURIComponent( escape( s ) );\n\n\t\t} catch ( e ) { // see #16358\n\n\t\t\treturn s;\n\n\t\t}\n\n\t}\n\n\tstatic extractUrlBase( url ) {\n\n\t\tconst index = url.lastIndexOf( '/' );\n\n\t\tif ( index === - 1 ) return './';\n\n\t\treturn url.slice( 0, index + 1 );\n\n\t}\n\n\tstatic resolveURL( url, path ) {\n\n\t\t// Invalid URL\n\t\tif ( typeof url !== 'string' || url === '' ) return '';\n\n\t\t// Host Relative URL\n\t\tif ( /^https?:\\/\\//i.test( path ) && /^\\//.test( url ) ) {\n\n\t\t\tpath = path.replace( /(^https?:\\/\\/[^\\/]+).*/i, '$1' );\n\n\t\t}\n\n\t\t// Absolute URL http://,https://,//\n\t\tif ( /^(https?:)?\\/\\//i.test( url ) ) return url;\n\n\t\t// Data URI\n\t\tif ( /^data:.*,.*$/i.test( url ) ) return url;\n\n\t\t// Blob URL\n\t\tif ( /^blob:.*$/i.test( url ) ) return url;\n\n\t\t// Relative URL\n\t\treturn path + url;\n\n\t}\n\n}\n\nclass InstancedBufferGeometry extends BufferGeometry {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isInstancedBufferGeometry = true;\n\n\t\tthis.type = 'InstancedBufferGeometry';\n\t\tthis.instanceCount = Infinity;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.instanceCount = source.instanceCount;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.instanceCount = this.instanceCount;\n\n\t\tdata.isInstancedBufferGeometry = true;\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass BufferGeometryLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( scope.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst interleavedBufferMap = {};\n\t\tconst arrayBufferMap = {};\n\n\t\tfunction getInterleavedBuffer( json, uuid ) {\n\n\t\t\tif ( interleavedBufferMap[ uuid ] !== undefined ) return interleavedBufferMap[ uuid ];\n\n\t\t\tconst interleavedBuffers = json.interleavedBuffers;\n\t\t\tconst interleavedBuffer = interleavedBuffers[ uuid ];\n\n\t\t\tconst buffer = getArrayBuffer( json, interleavedBuffer.buffer );\n\n\t\t\tconst array = getTypedArray( interleavedBuffer.type, buffer );\n\t\t\tconst ib = new InterleavedBuffer( array, interleavedBuffer.stride );\n\t\t\tib.uuid = interleavedBuffer.uuid;\n\n\t\t\tinterleavedBufferMap[ uuid ] = ib;\n\n\t\t\treturn ib;\n\n\t\t}\n\n\t\tfunction getArrayBuffer( json, uuid ) {\n\n\t\t\tif ( arrayBufferMap[ uuid ] !== undefined ) return arrayBufferMap[ uuid ];\n\n\t\t\tconst arrayBuffers = json.arrayBuffers;\n\t\t\tconst arrayBuffer = arrayBuffers[ uuid ];\n\n\t\t\tconst ab = new Uint32Array( arrayBuffer ).buffer;\n\n\t\t\tarrayBufferMap[ uuid ] = ab;\n\n\t\t\treturn ab;\n\n\t\t}\n\n\t\tconst geometry = json.isInstancedBufferGeometry ? new InstancedBufferGeometry() : new BufferGeometry();\n\n\t\tconst index = json.data.index;\n\n\t\tif ( index !== undefined ) {\n\n\t\t\tconst typedArray = getTypedArray( index.type, index.array );\n\t\t\tgeometry.setIndex( new BufferAttribute( typedArray, 1 ) );\n\n\t\t}\n\n\t\tconst attributes = json.data.attributes;\n\n\t\tfor ( const key in attributes ) {\n\n\t\t\tconst attribute = attributes[ key ];\n\t\t\tlet bufferAttribute;\n\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\tconst interleavedBuffer = getInterleavedBuffer( json.data, attribute.data );\n\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( interleavedBuffer, attribute.itemSize, attribute.offset, attribute.normalized );\n\n\t\t\t} else {\n\n\t\t\t\tconst typedArray = getTypedArray( attribute.type, attribute.array );\n\t\t\t\tconst bufferAttributeConstr = attribute.isInstancedBufferAttribute ? InstancedBufferAttribute : BufferAttribute;\n\t\t\t\tbufferAttribute = new bufferAttributeConstr( typedArray, attribute.itemSize, attribute.normalized );\n\n\t\t\t}\n\n\t\t\tif ( attribute.name !== undefined ) bufferAttribute.name = attribute.name;\n\t\t\tif ( attribute.usage !== undefined ) bufferAttribute.setUsage( attribute.usage );\n\n\t\t\tgeometry.setAttribute( key, bufferAttribute );\n\n\t\t}\n\n\t\tconst morphAttributes = json.data.morphAttributes;\n\n\t\tif ( morphAttributes ) {\n\n\t\t\tfor ( const key in morphAttributes ) {\n\n\t\t\t\tconst attributeArray = morphAttributes[ key ];\n\n\t\t\t\tconst array = [];\n\n\t\t\t\tfor ( let i = 0, il = attributeArray.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst attribute = attributeArray[ i ];\n\t\t\t\t\tlet bufferAttribute;\n\n\t\t\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\t\t\tconst interleavedBuffer = getInterleavedBuffer( json.data, attribute.data );\n\t\t\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( interleavedBuffer, attribute.itemSize, attribute.offset, attribute.normalized );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconst typedArray = getTypedArray( attribute.type, attribute.array );\n\t\t\t\t\t\tbufferAttribute = new BufferAttribute( typedArray, attribute.itemSize, attribute.normalized );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attribute.name !== undefined ) bufferAttribute.name = attribute.name;\n\t\t\t\t\tarray.push( bufferAttribute );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.morphAttributes[ key ] = array;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst morphTargetsRelative = json.data.morphTargetsRelative;\n\n\t\tif ( morphTargetsRelative ) {\n\n\t\t\tgeometry.morphTargetsRelative = true;\n\n\t\t}\n\n\t\tconst groups = json.data.groups || json.data.drawcalls || json.data.offsets;\n\n\t\tif ( groups !== undefined ) {\n\n\t\t\tfor ( let i = 0, n = groups.length; i !== n; ++ i ) {\n\n\t\t\t\tconst group = groups[ i ];\n\n\t\t\t\tgeometry.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst boundingSphere = json.data.boundingSphere;\n\n\t\tif ( boundingSphere !== undefined ) {\n\n\t\t\tconst center = new Vector3();\n\n\t\t\tif ( boundingSphere.center !== undefined ) {\n\n\t\t\t\tcenter.fromArray( boundingSphere.center );\n\n\t\t\t}\n\n\t\t\tgeometry.boundingSphere = new Sphere( center, boundingSphere.radius );\n\n\t\t}\n\n\t\tif ( json.name ) geometry.name = json.name;\n\t\tif ( json.userData ) geometry.userData = json.userData;\n\n\t\treturn geometry;\n\n\t}\n\n}\n\nclass ObjectLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( this.path === '' ) ? LoaderUtils.extractUrlBase( url ) : this.path;\n\t\tthis.resourcePath = this.resourcePath || path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\tlet json = null;\n\n\t\t\ttry {\n\n\t\t\t\tjson = JSON.parse( text );\n\n\t\t\t} catch ( error ) {\n\n\t\t\t\tif ( onError !== undefined ) onError( error );\n\n\t\t\t\tconsole.error( 'THREE:ObjectLoader: Can\\'t parse ' + url + '.', error.message );\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tconst metadata = json.metadata;\n\n\t\t\tif ( metadata === undefined || metadata.type === undefined || metadata.type.toLowerCase() === 'geometry' ) {\n\n\t\t\t\tif ( onError !== undefined ) onError( new Error( 'THREE.ObjectLoader: Can\\'t load ' + url ) );\n\n\t\t\t\tconsole.error( 'THREE.ObjectLoader: Can\\'t load ' + url );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tscope.parse( json, onLoad );\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tasync loadAsync( url, onProgress ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( this.path === '' ) ? LoaderUtils.extractUrlBase( url ) : this.path;\n\t\tthis.resourcePath = this.resourcePath || path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tconst text = await loader.loadAsync( url, onProgress );\n\n\t\tconst json = JSON.parse( text );\n\n\t\tconst metadata = json.metadata;\n\n\t\tif ( metadata === undefined || metadata.type === undefined || metadata.type.toLowerCase() === 'geometry' ) {\n\n\t\t\tthrow new Error( 'THREE.ObjectLoader: Can\\'t load ' + url );\n\n\t\t}\n\n\t\treturn await scope.parseAsync( json );\n\n\t}\n\n\tparse( json, onLoad ) {\n\n\t\tconst animations = this.parseAnimations( json.animations );\n\t\tconst shapes = this.parseShapes( json.shapes );\n\t\tconst geometries = this.parseGeometries( json.geometries, shapes );\n\n\t\tconst images = this.parseImages( json.images, function () {\n\n\t\t\tif ( onLoad !== undefined ) onLoad( object );\n\n\t\t} );\n\n\t\tconst textures = this.parseTextures( json.textures, images );\n\t\tconst materials = this.parseMaterials( json.materials, textures );\n\n\t\tconst object = this.parseObject( json.object, geometries, materials, textures, animations );\n\t\tconst skeletons = this.parseSkeletons( json.skeletons, object );\n\n\t\tthis.bindSkeletons( object, skeletons );\n\t\tthis.bindLightTargets( object );\n\n\t\t//\n\n\t\tif ( onLoad !== undefined ) {\n\n\t\t\tlet hasImages = false;\n\n\t\t\tfor ( const uuid in images ) {\n\n\t\t\t\tif ( images[ uuid ].data instanceof HTMLImageElement ) {\n\n\t\t\t\t\thasImages = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( hasImages === false ) onLoad( object );\n\n\t\t}\n\n\t\treturn object;\n\n\t}\n\n\tasync parseAsync( json ) {\n\n\t\tconst animations = this.parseAnimations( json.animations );\n\t\tconst shapes = this.parseShapes( json.shapes );\n\t\tconst geometries = this.parseGeometries( json.geometries, shapes );\n\n\t\tconst images = await this.parseImagesAsync( json.images );\n\n\t\tconst textures = this.parseTextures( json.textures, images );\n\t\tconst materials = this.parseMaterials( json.materials, textures );\n\n\t\tconst object = this.parseObject( json.object, geometries, materials, textures, animations );\n\t\tconst skeletons = this.parseSkeletons( json.skeletons, object );\n\n\t\tthis.bindSkeletons( object, skeletons );\n\t\tthis.bindLightTargets( object );\n\n\t\treturn object;\n\n\t}\n\n\tparseShapes( json ) {\n\n\t\tconst shapes = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst shape = new Shape().fromJSON( json[ i ] );\n\n\t\t\t\tshapes[ shape.uuid ] = shape;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn shapes;\n\n\t}\n\n\tparseSkeletons( json, object ) {\n\n\t\tconst skeletons = {};\n\t\tconst bones = {};\n\n\t\t// generate bone lookup table\n\n\t\tobject.traverse( function ( child ) {\n\n\t\t\tif ( child.isBone ) bones[ child.uuid ] = child;\n\n\t\t} );\n\n\t\t// create skeletons\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst skeleton = new Skeleton().fromJSON( json[ i ], bones );\n\n\t\t\t\tskeletons[ skeleton.uuid ] = skeleton;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn skeletons;\n\n\t}\n\n\tparseGeometries( json, shapes ) {\n\n\t\tconst geometries = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tconst bufferGeometryLoader = new BufferGeometryLoader();\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tlet geometry;\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tswitch ( data.type ) {\n\n\t\t\t\t\tcase 'BufferGeometry':\n\t\t\t\t\tcase 'InstancedBufferGeometry':\n\n\t\t\t\t\t\tgeometry = bufferGeometryLoader.parse( data );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( data.type in Geometries ) {\n\n\t\t\t\t\t\t\tgeometry = Geometries[ data.type ].fromJSON( data, shapes );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tconsole.warn( `THREE.ObjectLoader: Unsupported geometry type \"${ data.type }\"` );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.uuid = data.uuid;\n\n\t\t\t\tif ( data.name !== undefined ) geometry.name = data.name;\n\t\t\t\tif ( data.userData !== undefined ) geometry.userData = data.userData;\n\n\t\t\t\tgeometries[ data.uuid ] = geometry;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn geometries;\n\n\t}\n\n\tparseMaterials( json, textures ) {\n\n\t\tconst cache = {}; // MultiMaterial\n\t\tconst materials = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tconst loader = new MaterialLoader();\n\t\t\tloader.setTextures( textures );\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tif ( cache[ data.uuid ] === undefined ) {\n\n\t\t\t\t\tcache[ data.uuid ] = loader.parse( data );\n\n\t\t\t\t}\n\n\t\t\t\tmaterials[ data.uuid ] = cache[ data.uuid ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn materials;\n\n\t}\n\n\tparseAnimations( json ) {\n\n\t\tconst animations = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0; i < json.length; i ++ ) {\n\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tconst clip = AnimationClip.parse( data );\n\n\t\t\t\tanimations[ clip.uuid ] = clip;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn animations;\n\n\t}\n\n\tparseImages( json, onLoad ) {\n\n\t\tconst scope = this;\n\t\tconst images = {};\n\n\t\tlet loader;\n\n\t\tfunction loadImage( url ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\treturn loader.load( url, function () {\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, undefined, function () {\n\n\t\t\t\tscope.manager.itemError( url );\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t} );\n\n\t\t}\n\n\t\tfunction deserializeImage( image ) {\n\n\t\t\tif ( typeof image === 'string' ) {\n\n\t\t\t\tconst url = image;\n\n\t\t\t\tconst path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( url ) ? url : scope.resourcePath + url;\n\n\t\t\t\treturn loadImage( path );\n\n\t\t\t} else {\n\n\t\t\t\tif ( image.data ) {\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdata: getTypedArray( image.type, image.data ),\n\t\t\t\t\t\twidth: image.width,\n\t\t\t\t\t\theight: image.height\n\t\t\t\t\t};\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( json !== undefined && json.length > 0 ) {\n\n\t\t\tconst manager = new LoadingManager( onLoad );\n\n\t\t\tloader = new ImageLoader( manager );\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\n\n\t\t\tfor ( let i = 0, il = json.length; i < il; i ++ ) {\n\n\t\t\t\tconst image = json[ i ];\n\t\t\t\tconst url = image.url;\n\n\t\t\t\tif ( Array.isArray( url ) ) {\n\n\t\t\t\t\t// load array of images e.g CubeTexture\n\n\t\t\t\t\tconst imageArray = [];\n\n\t\t\t\t\tfor ( let j = 0, jl = url.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tconst currentUrl = url[ j ];\n\n\t\t\t\t\t\tconst deserializedImage = deserializeImage( currentUrl );\n\n\t\t\t\t\t\tif ( deserializedImage !== null ) {\n\n\t\t\t\t\t\t\tif ( deserializedImage instanceof HTMLImageElement ) {\n\n\t\t\t\t\t\t\t\timageArray.push( deserializedImage );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t// special case: handle array of data textures for cube textures\n\n\t\t\t\t\t\t\t\timageArray.push( new DataTexture( deserializedImage.data, deserializedImage.width, deserializedImage.height ) );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\timages[ image.uuid ] = new Source( imageArray );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// load single image\n\n\t\t\t\t\tconst deserializedImage = deserializeImage( image.url );\n\t\t\t\t\timages[ image.uuid ] = new Source( deserializedImage );\n\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn images;\n\n\t}\n\n\tasync parseImagesAsync( json ) {\n\n\t\tconst scope = this;\n\t\tconst images = {};\n\n\t\tlet loader;\n\n\t\tasync function deserializeImage( image ) {\n\n\t\t\tif ( typeof image === 'string' ) {\n\n\t\t\t\tconst url = image;\n\n\t\t\t\tconst path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( url ) ? url : scope.resourcePath + url;\n\n\t\t\t\treturn await loader.loadAsync( path );\n\n\t\t\t} else {\n\n\t\t\t\tif ( image.data ) {\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdata: getTypedArray( image.type, image.data ),\n\t\t\t\t\t\twidth: image.width,\n\t\t\t\t\t\theight: image.height\n\t\t\t\t\t};\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( json !== undefined && json.length > 0 ) {\n\n\t\t\tloader = new ImageLoader( this.manager );\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\n\n\t\t\tfor ( let i = 0, il = json.length; i < il; i ++ ) {\n\n\t\t\t\tconst image = json[ i ];\n\t\t\t\tconst url = image.url;\n\n\t\t\t\tif ( Array.isArray( url ) ) {\n\n\t\t\t\t\t// load array of images e.g CubeTexture\n\n\t\t\t\t\tconst imageArray = [];\n\n\t\t\t\t\tfor ( let j = 0, jl = url.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tconst currentUrl = url[ j ];\n\n\t\t\t\t\t\tconst deserializedImage = await deserializeImage( currentUrl );\n\n\t\t\t\t\t\tif ( deserializedImage !== null ) {\n\n\t\t\t\t\t\t\tif ( deserializedImage instanceof HTMLImageElement ) {\n\n\t\t\t\t\t\t\t\timageArray.push( deserializedImage );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t// special case: handle array of data textures for cube textures\n\n\t\t\t\t\t\t\t\timageArray.push( new DataTexture( deserializedImage.data, deserializedImage.width, deserializedImage.height ) );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\timages[ image.uuid ] = new Source( imageArray );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// load single image\n\n\t\t\t\t\tconst deserializedImage = await deserializeImage( image.url );\n\t\t\t\t\timages[ image.uuid ] = new Source( deserializedImage );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn images;\n\n\t}\n\n\tparseTextures( json, images ) {\n\n\t\tfunction parseConstant( value, type ) {\n\n\t\t\tif ( typeof value === 'number' ) return value;\n\n\t\t\tconsole.warn( 'THREE.ObjectLoader.parseTexture: Constant should be in numeric form.', value );\n\n\t\t\treturn type[ value ];\n\n\t\t}\n\n\t\tconst textures = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tif ( data.image === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No \"image\" specified for', data.uuid );\n\n\t\t\t\t}\n\n\t\t\t\tif ( images[ data.image ] === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined image', data.image );\n\n\t\t\t\t}\n\n\t\t\t\tconst source = images[ data.image ];\n\t\t\t\tconst image = source.data;\n\n\t\t\t\tlet texture;\n\n\t\t\t\tif ( Array.isArray( image ) ) {\n\n\t\t\t\t\ttexture = new CubeTexture();\n\n\t\t\t\t\tif ( image.length === 6 ) texture.needsUpdate = true;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( image && image.data ) {\n\n\t\t\t\t\t\ttexture = new DataTexture();\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttexture = new Texture();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( image ) texture.needsUpdate = true; // textures can have undefined image data\n\n\t\t\t\t}\n\n\t\t\t\ttexture.source = source;\n\n\t\t\t\ttexture.uuid = data.uuid;\n\n\t\t\t\tif ( data.name !== undefined ) texture.name = data.name;\n\n\t\t\t\tif ( data.mapping !== undefined ) texture.mapping = parseConstant( data.mapping, TEXTURE_MAPPING );\n\t\t\t\tif ( data.channel !== undefined ) texture.channel = data.channel;\n\n\t\t\t\tif ( data.offset !== undefined ) texture.offset.fromArray( data.offset );\n\t\t\t\tif ( data.repeat !== undefined ) texture.repeat.fromArray( data.repeat );\n\t\t\t\tif ( data.center !== undefined ) texture.center.fromArray( data.center );\n\t\t\t\tif ( data.rotation !== undefined ) texture.rotation = data.rotation;\n\n\t\t\t\tif ( data.wrap !== undefined ) {\n\n\t\t\t\t\ttexture.wrapS = parseConstant( data.wrap[ 0 ], TEXTURE_WRAPPING );\n\t\t\t\t\ttexture.wrapT = parseConstant( data.wrap[ 1 ], TEXTURE_WRAPPING );\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.format !== undefined ) texture.format = data.format;\n\t\t\t\tif ( data.internalFormat !== undefined ) texture.internalFormat = data.internalFormat;\n\t\t\t\tif ( data.type !== undefined ) texture.type = data.type;\n\t\t\t\tif ( data.colorSpace !== undefined ) texture.colorSpace = data.colorSpace;\n\n\t\t\t\tif ( data.minFilter !== undefined ) texture.minFilter = parseConstant( data.minFilter, TEXTURE_FILTER );\n\t\t\t\tif ( data.magFilter !== undefined ) texture.magFilter = parseConstant( data.magFilter, TEXTURE_FILTER );\n\t\t\t\tif ( data.anisotropy !== undefined ) texture.anisotropy = data.anisotropy;\n\n\t\t\t\tif ( data.flipY !== undefined ) texture.flipY = data.flipY;\n\n\t\t\t\tif ( data.generateMipmaps !== undefined ) texture.generateMipmaps = data.generateMipmaps;\n\t\t\t\tif ( data.premultiplyAlpha !== undefined ) texture.premultiplyAlpha = data.premultiplyAlpha;\n\t\t\t\tif ( data.unpackAlignment !== undefined ) texture.unpackAlignment = data.unpackAlignment;\n\t\t\t\tif ( data.compareFunction !== undefined ) texture.compareFunction = data.compareFunction;\n\n\t\t\t\tif ( data.userData !== undefined ) texture.userData = data.userData;\n\n\t\t\t\ttextures[ data.uuid ] = texture;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn textures;\n\n\t}\n\n\tparseObject( data, geometries, materials, textures, animations ) {\n\n\t\tlet object;\n\n\t\tfunction getGeometry( name ) {\n\n\t\t\tif ( geometries[ name ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined geometry', name );\n\n\t\t\t}\n\n\t\t\treturn geometries[ name ];\n\n\t\t}\n\n\t\tfunction getMaterial( name ) {\n\n\t\t\tif ( name === undefined ) return undefined;\n\n\t\t\tif ( Array.isArray( name ) ) {\n\n\t\t\t\tconst array = [];\n\n\t\t\t\tfor ( let i = 0, l = name.length; i < l; i ++ ) {\n\n\t\t\t\t\tconst uuid = name[ i ];\n\n\t\t\t\t\tif ( materials[ uuid ] === undefined ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', uuid );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tarray.push( materials[ uuid ] );\n\n\t\t\t\t}\n\n\t\t\t\treturn array;\n\n\t\t\t}\n\n\t\t\tif ( materials[ name ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', name );\n\n\t\t\t}\n\n\t\t\treturn materials[ name ];\n\n\t\t}\n\n\t\tfunction getTexture( uuid ) {\n\n\t\t\tif ( textures[ uuid ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined texture', uuid );\n\n\t\t\t}\n\n\t\t\treturn textures[ uuid ];\n\n\t\t}\n\n\t\tlet geometry, material;\n\n\t\tswitch ( data.type ) {\n\n\t\t\tcase 'Scene':\n\n\t\t\t\tobject = new Scene();\n\n\t\t\t\tif ( data.background !== undefined ) {\n\n\t\t\t\t\tif ( Number.isInteger( data.background ) ) {\n\n\t\t\t\t\t\tobject.background = new Color( data.background );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tobject.background = getTexture( data.background );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.environment !== undefined ) {\n\n\t\t\t\t\tobject.environment = getTexture( data.environment );\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.fog !== undefined ) {\n\n\t\t\t\t\tif ( data.fog.type === 'Fog' ) {\n\n\t\t\t\t\t\tobject.fog = new Fog( data.fog.color, data.fog.near, data.fog.far );\n\n\t\t\t\t\t} else if ( data.fog.type === 'FogExp2' ) {\n\n\t\t\t\t\t\tobject.fog = new FogExp2( data.fog.color, data.fog.density );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( data.fog.name !== '' ) {\n\n\t\t\t\t\t\tobject.fog.name = data.fog.name;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.backgroundBlurriness !== undefined ) object.backgroundBlurriness = data.backgroundBlurriness;\n\t\t\t\tif ( data.backgroundIntensity !== undefined ) object.backgroundIntensity = data.backgroundIntensity;\n\t\t\t\tif ( data.backgroundRotation !== undefined ) object.backgroundRotation.fromArray( data.backgroundRotation );\n\n\t\t\t\tif ( data.environmentIntensity !== undefined ) object.environmentIntensity = data.environmentIntensity;\n\t\t\t\tif ( data.environmentRotation !== undefined ) object.environmentRotation.fromArray( data.environmentRotation );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'PerspectiveCamera':\n\n\t\t\t\tobject = new PerspectiveCamera( data.fov, data.aspect, data.near, data.far );\n\n\t\t\t\tif ( data.focus !== undefined ) object.focus = data.focus;\n\t\t\t\tif ( data.zoom !== undefined ) object.zoom = data.zoom;\n\t\t\t\tif ( data.filmGauge !== undefined ) object.filmGauge = data.filmGauge;\n\t\t\t\tif ( data.filmOffset !== undefined ) object.filmOffset = data.filmOffset;\n\t\t\t\tif ( data.view !== undefined ) object.view = Object.assign( {}, data.view );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'OrthographicCamera':\n\n\t\t\t\tobject = new OrthographicCamera( data.left, data.right, data.top, data.bottom, data.near, data.far );\n\n\t\t\t\tif ( data.zoom !== undefined ) object.zoom = data.zoom;\n\t\t\t\tif ( data.view !== undefined ) object.view = Object.assign( {}, data.view );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'AmbientLight':\n\n\t\t\t\tobject = new AmbientLight( data.color, data.intensity );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'DirectionalLight':\n\n\t\t\t\tobject = new DirectionalLight( data.color, data.intensity );\n\t\t\t\tobject.target = data.target || '';\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'PointLight':\n\n\t\t\t\tobject = new PointLight( data.color, data.intensity, data.distance, data.decay );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'RectAreaLight':\n\n\t\t\t\tobject = new RectAreaLight( data.color, data.intensity, data.width, data.height );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'SpotLight':\n\n\t\t\t\tobject = new SpotLight( data.color, data.intensity, data.distance, data.angle, data.penumbra, data.decay );\n\t\t\t\tobject.target = data.target || '';\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'HemisphereLight':\n\n\t\t\t\tobject = new HemisphereLight( data.color, data.groundColor, data.intensity );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LightProbe':\n\n\t\t\t\tobject = new LightProbe().fromJSON( data );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'SkinnedMesh':\n\n\t\t\t\tgeometry = getGeometry( data.geometry );\n\t\t\t \tmaterial = getMaterial( data.material );\n\n\t\t\t\tobject = new SkinnedMesh( geometry, material );\n\n\t\t\t\tif ( data.bindMode !== undefined ) object.bindMode = data.bindMode;\n\t\t\t\tif ( data.bindMatrix !== undefined ) object.bindMatrix.fromArray( data.bindMatrix );\n\t\t\t\tif ( data.skeleton !== undefined ) object.skeleton = data.skeleton;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Mesh':\n\n\t\t\t\tgeometry = getGeometry( data.geometry );\n\t\t\t\tmaterial = getMaterial( data.material );\n\n\t\t\t\tobject = new Mesh( geometry, material );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'InstancedMesh':\n\n\t\t\t\tgeometry = getGeometry( data.geometry );\n\t\t\t\tmaterial = getMaterial( data.material );\n\t\t\t\tconst count = data.count;\n\t\t\t\tconst instanceMatrix = data.instanceMatrix;\n\t\t\t\tconst instanceColor = data.instanceColor;\n\n\t\t\t\tobject = new InstancedMesh( geometry, material, count );\n\t\t\t\tobject.instanceMatrix = new InstancedBufferAttribute( new Float32Array( instanceMatrix.array ), 16 );\n\t\t\t\tif ( instanceColor !== undefined ) object.instanceColor = new InstancedBufferAttribute( new Float32Array( instanceColor.array ), instanceColor.itemSize );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'BatchedMesh':\n\n\t\t\t\tgeometry = getGeometry( data.geometry );\n\t\t\t\tmaterial = getMaterial( data.material );\n\n\t\t\t\tobject = new BatchedMesh( data.maxInstanceCount, data.maxVertexCount, data.maxIndexCount, material );\n\t\t\t\tobject.geometry = geometry;\n\t\t\t\tobject.perObjectFrustumCulled = data.perObjectFrustumCulled;\n\t\t\t\tobject.sortObjects = data.sortObjects;\n\n\t\t\t\tobject._drawRanges = data.drawRanges;\n\t\t\t\tobject._reservedRanges = data.reservedRanges;\n\n\t\t\t\tobject._visibility = data.visibility;\n\t\t\t\tobject._active = data.active;\n\t\t\t\tobject._bounds = data.bounds.map( bound => {\n\n\t\t\t\t\tconst box = new Box3();\n\t\t\t\t\tbox.min.fromArray( bound.boxMin );\n\t\t\t\t\tbox.max.fromArray( bound.boxMax );\n\n\t\t\t\t\tconst sphere = new Sphere();\n\t\t\t\t\tsphere.radius = bound.sphereRadius;\n\t\t\t\t\tsphere.center.fromArray( bound.sphereCenter );\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tboxInitialized: bound.boxInitialized,\n\t\t\t\t\t\tbox: box,\n\n\t\t\t\t\t\tsphereInitialized: bound.sphereInitialized,\n\t\t\t\t\t\tsphere: sphere\n\t\t\t\t\t};\n\n\t\t\t\t} );\n\n\t\t\t\tobject._maxInstanceCount = data.maxInstanceCount;\n\t\t\t\tobject._maxVertexCount = data.maxVertexCount;\n\t\t\t\tobject._maxIndexCount = data.maxIndexCount;\n\n\t\t\t\tobject._geometryInitialized = data.geometryInitialized;\n\t\t\t\tobject._geometryCount = data.geometryCount;\n\n\t\t\t\tobject._matricesTexture = getTexture( data.matricesTexture.uuid );\n\t\t\t\tif ( data.colorsTexture !== undefined ) object._colorsTexture = getTexture( data.colorsTexture.uuid );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LOD':\n\n\t\t\t\tobject = new LOD();\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Line':\n\n\t\t\t\tobject = new Line( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LineLoop':\n\n\t\t\t\tobject = new LineLoop( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LineSegments':\n\n\t\t\t\tobject = new LineSegments( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'PointCloud':\n\t\t\tcase 'Points':\n\n\t\t\t\tobject = new Points( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Sprite':\n\n\t\t\t\tobject = new Sprite( getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Group':\n\n\t\t\t\tobject = new Group();\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Bone':\n\n\t\t\t\tobject = new Bone();\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tobject = new Object3D();\n\n\t\t}\n\n\t\tobject.uuid = data.uuid;\n\n\t\tif ( data.name !== undefined ) object.name = data.name;\n\n\t\tif ( data.matrix !== undefined ) {\n\n\t\t\tobject.matrix.fromArray( data.matrix );\n\n\t\t\tif ( data.matrixAutoUpdate !== undefined ) object.matrixAutoUpdate = data.matrixAutoUpdate;\n\t\t\tif ( object.matrixAutoUpdate ) object.matrix.decompose( object.position, object.quaternion, object.scale );\n\n\t\t} else {\n\n\t\t\tif ( data.position !== undefined ) object.position.fromArray( data.position );\n\t\t\tif ( data.rotation !== undefined ) object.rotation.fromArray( data.rotation );\n\t\t\tif ( data.quaternion !== undefined ) object.quaternion.fromArray( data.quaternion );\n\t\t\tif ( data.scale !== undefined ) object.scale.fromArray( data.scale );\n\n\t\t}\n\n\t\tif ( data.up !== undefined ) object.up.fromArray( data.up );\n\n\t\tif ( data.castShadow !== undefined ) object.castShadow = data.castShadow;\n\t\tif ( data.receiveShadow !== undefined ) object.receiveShadow = data.receiveShadow;\n\n\t\tif ( data.shadow ) {\n\n\t\t\tif ( data.shadow.intensity !== undefined ) object.shadow.intensity = data.shadow.intensity;\n\t\t\tif ( data.shadow.bias !== undefined ) object.shadow.bias = data.shadow.bias;\n\t\t\tif ( data.shadow.normalBias !== undefined ) object.shadow.normalBias = data.shadow.normalBias;\n\t\t\tif ( data.shadow.radius !== undefined ) object.shadow.radius = data.shadow.radius;\n\t\t\tif ( data.shadow.mapSize !== undefined ) object.shadow.mapSize.fromArray( data.shadow.mapSize );\n\t\t\tif ( data.shadow.camera !== undefined ) object.shadow.camera = this.parseObject( data.shadow.camera );\n\n\t\t}\n\n\t\tif ( data.visible !== undefined ) object.visible = data.visible;\n\t\tif ( data.frustumCulled !== undefined ) object.frustumCulled = data.frustumCulled;\n\t\tif ( data.renderOrder !== undefined ) object.renderOrder = data.renderOrder;\n\t\tif ( data.userData !== undefined ) object.userData = data.userData;\n\t\tif ( data.layers !== undefined ) object.layers.mask = data.layers;\n\n\t\tif ( data.children !== undefined ) {\n\n\t\t\tconst children = data.children;\n\n\t\t\tfor ( let i = 0; i < children.length; i ++ ) {\n\n\t\t\t\tobject.add( this.parseObject( children[ i ], geometries, materials, textures, animations ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( data.animations !== undefined ) {\n\n\t\t\tconst objectAnimations = data.animations;\n\n\t\t\tfor ( let i = 0; i < objectAnimations.length; i ++ ) {\n\n\t\t\t\tconst uuid = objectAnimations[ i ];\n\n\t\t\t\tobject.animations.push( animations[ uuid ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( data.type === 'LOD' ) {\n\n\t\t\tif ( data.autoUpdate !== undefined ) object.autoUpdate = data.autoUpdate;\n\n\t\t\tconst levels = data.levels;\n\n\t\t\tfor ( let l = 0; l < levels.length; l ++ ) {\n\n\t\t\t\tconst level = levels[ l ];\n\t\t\t\tconst child = object.getObjectByProperty( 'uuid', level.object );\n\n\t\t\t\tif ( child !== undefined ) {\n\n\t\t\t\t\tobject.addLevel( child, level.distance, level.hysteresis );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn object;\n\n\t}\n\n\tbindSkeletons( object, skeletons ) {\n\n\t\tif ( Object.keys( skeletons ).length === 0 ) return;\n\n\t\tobject.traverse( function ( child ) {\n\n\t\t\tif ( child.isSkinnedMesh === true && child.skeleton !== undefined ) {\n\n\t\t\t\tconst skeleton = skeletons[ child.skeleton ];\n\n\t\t\t\tif ( skeleton === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No skeleton found with UUID:', child.skeleton );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tchild.bind( skeleton, child.bindMatrix );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\tbindLightTargets( object ) {\n\n\t\tobject.traverse( function ( child ) {\n\n\t\t\tif ( child.isDirectionalLight || child.isSpotLight ) {\n\n\t\t\t\tconst uuid = child.target;\n\n\t\t\t\tconst target = object.getObjectByProperty( 'uuid', uuid );\n\n\t\t\t\tif ( target !== undefined ) {\n\n\t\t\t\t\tchild.target = target;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tchild.target = new Object3D();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n}\n\nconst TEXTURE_MAPPING = {\n\tUVMapping: UVMapping,\n\tCubeReflectionMapping: CubeReflectionMapping,\n\tCubeRefractionMapping: CubeRefractionMapping,\n\tEquirectangularReflectionMapping: EquirectangularReflectionMapping,\n\tEquirectangularRefractionMapping: EquirectangularRefractionMapping,\n\tCubeUVReflectionMapping: CubeUVReflectionMapping\n};\n\nconst TEXTURE_WRAPPING = {\n\tRepeatWrapping: RepeatWrapping,\n\tClampToEdgeWrapping: ClampToEdgeWrapping,\n\tMirroredRepeatWrapping: MirroredRepeatWrapping\n};\n\nconst TEXTURE_FILTER = {\n\tNearestFilter: NearestFilter,\n\tNearestMipmapNearestFilter: NearestMipmapNearestFilter,\n\tNearestMipmapLinearFilter: NearestMipmapLinearFilter,\n\tLinearFilter: LinearFilter,\n\tLinearMipmapNearestFilter: LinearMipmapNearestFilter,\n\tLinearMipmapLinearFilter: LinearMipmapLinearFilter\n};\n\nclass ImageBitmapLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.isImageBitmapLoader = true;\n\n\t\tif ( typeof createImageBitmap === 'undefined' ) {\n\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: createImageBitmap() not supported.' );\n\n\t\t}\n\n\t\tif ( typeof fetch === 'undefined' ) {\n\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: fetch() not supported.' );\n\n\t\t}\n\n\t\tthis.options = { premultiplyAlpha: 'none' };\n\n\t}\n\n\tsetOptions( options ) {\n\n\t\tthis.options = options;\n\n\t\treturn this;\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( url === undefined ) url = '';\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst scope = this;\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\t// If cached is a promise, wait for it to resolve\n\t\t\tif ( cached.then ) {\n\n\t\t\t\tcached.then( imageBitmap => {\n\n\t\t\t\t\tif ( onLoad ) onLoad( imageBitmap );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t} ).catch( e => {\n\n\t\t\t\t\tif ( onError ) onError( e );\n\n\t\t\t\t} );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\t// If cached is not a promise (i.e., it's already an imageBitmap)\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tconst fetchOptions = {};\n\t\tfetchOptions.credentials = ( this.crossOrigin === 'anonymous' ) ? 'same-origin' : 'include';\n\t\tfetchOptions.headers = this.requestHeader;\n\n\t\tconst promise = fetch( url, fetchOptions ).then( function ( res ) {\n\n\t\t\treturn res.blob();\n\n\t\t} ).then( function ( blob ) {\n\n\t\t\treturn createImageBitmap( blob, Object.assign( scope.options, { colorSpaceConversion: 'none' } ) );\n\n\t\t} ).then( function ( imageBitmap ) {\n\n\t\t\tCache.add( url, imageBitmap );\n\n\t\t\tif ( onLoad ) onLoad( imageBitmap );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t\treturn imageBitmap;\n\n\t\t} ).catch( function ( e ) {\n\n\t\t\tif ( onError ) onError( e );\n\n\t\t\tCache.remove( url );\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t} );\n\n\t\tCache.add( url, promise );\n\t\tscope.manager.itemStart( url );\n\n\t}\n\n}\n\nlet _context;\n\nclass AudioContext {\n\n\tstatic getContext() {\n\n\t\tif ( _context === undefined ) {\n\n\t\t\t_context = new ( window.AudioContext || window.webkitAudioContext )();\n\n\t\t}\n\n\t\treturn _context;\n\n\t}\n\n\tstatic setContext( value ) {\n\n\t\t_context = value;\n\n\t}\n\n}\n\nclass AudioLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\ttry {\n\n\t\t\t\t// Create a copy of the buffer. The `decodeAudioData` method\n\t\t\t\t// detaches the buffer when complete, preventing reuse.\n\t\t\t\tconst bufferCopy = buffer.slice( 0 );\n\n\t\t\t\tconst context = AudioContext.getContext();\n\t\t\t\tcontext.decodeAudioData( bufferCopy, function ( audioBuffer ) {\n\n\t\t\t\t\tonLoad( audioBuffer );\n\n\t\t\t\t} ).catch( handleError );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\thandleError( e );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t\tfunction handleError( e ) {\n\n\t\t\tif ( onError ) {\n\n\t\t\t\tonError( e );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( e );\n\n\t\t\t}\n\n\t\t\tscope.manager.itemError( url );\n\n\t\t}\n\n\t}\n\n}\n\nconst _eyeRight = /*@__PURE__*/ new Matrix4();\nconst _eyeLeft = /*@__PURE__*/ new Matrix4();\nconst _projectionMatrix = /*@__PURE__*/ new Matrix4();\n\nclass StereoCamera {\n\n\tconstructor() {\n\n\t\tthis.type = 'StereoCamera';\n\n\t\tthis.aspect = 1;\n\n\t\tthis.eyeSep = 0.064;\n\n\t\tthis.cameraL = new PerspectiveCamera();\n\t\tthis.cameraL.layers.enable( 1 );\n\t\tthis.cameraL.matrixAutoUpdate = false;\n\n\t\tthis.cameraR = new PerspectiveCamera();\n\t\tthis.cameraR.layers.enable( 2 );\n\t\tthis.cameraR.matrixAutoUpdate = false;\n\n\t\tthis._cache = {\n\t\t\tfocus: null,\n\t\t\tfov: null,\n\t\t\taspect: null,\n\t\t\tnear: null,\n\t\t\tfar: null,\n\t\t\tzoom: null,\n\t\t\teyeSep: null\n\t\t};\n\n\t}\n\n\tupdate( camera ) {\n\n\t\tconst cache = this._cache;\n\n\t\tconst needsUpdate = cache.focus !== camera.focus || cache.fov !== camera.fov ||\n\t\t\tcache.aspect !== camera.aspect * this.aspect || cache.near !== camera.near ||\n\t\t\tcache.far !== camera.far || cache.zoom !== camera.zoom || cache.eyeSep !== this.eyeSep;\n\n\t\tif ( needsUpdate ) {\n\n\t\t\tcache.focus = camera.focus;\n\t\t\tcache.fov = camera.fov;\n\t\t\tcache.aspect = camera.aspect * this.aspect;\n\t\t\tcache.near = camera.near;\n\t\t\tcache.far = camera.far;\n\t\t\tcache.zoom = camera.zoom;\n\t\t\tcache.eyeSep = this.eyeSep;\n\n\t\t\t// Off-axis stereoscopic effect based on\n\t\t\t// http://paulbourke.net/stereographics/stereorender/\n\n\t\t\t_projectionMatrix.copy( camera.projectionMatrix );\n\t\t\tconst eyeSepHalf = cache.eyeSep / 2;\n\t\t\tconst eyeSepOnProjection = eyeSepHalf * cache.near / cache.focus;\n\t\t\tconst ymax = ( cache.near * Math.tan( DEG2RAD * cache.fov * 0.5 ) ) / cache.zoom;\n\t\t\tlet xmin, xmax;\n\n\t\t\t// translate xOffset\n\n\t\t\t_eyeLeft.elements[ 12 ] = - eyeSepHalf;\n\t\t\t_eyeRight.elements[ 12 ] = eyeSepHalf;\n\n\t\t\t// for left eye\n\n\t\t\txmin = - ymax * cache.aspect + eyeSepOnProjection;\n\t\t\txmax = ymax * cache.aspect + eyeSepOnProjection;\n\n\t\t\t_projectionMatrix.elements[ 0 ] = 2 * cache.near / ( xmax - xmin );\n\t\t\t_projectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\n\n\t\t\tthis.cameraL.projectionMatrix.copy( _projectionMatrix );\n\n\t\t\t// for right eye\n\n\t\t\txmin = - ymax * cache.aspect - eyeSepOnProjection;\n\t\t\txmax = ymax * cache.aspect - eyeSepOnProjection;\n\n\t\t\t_projectionMatrix.elements[ 0 ] = 2 * cache.near / ( xmax - xmin );\n\t\t\t_projectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\n\n\t\t\tthis.cameraR.projectionMatrix.copy( _projectionMatrix );\n\n\t\t}\n\n\t\tthis.cameraL.matrixWorld.copy( camera.matrixWorld ).multiply( _eyeLeft );\n\t\tthis.cameraR.matrixWorld.copy( camera.matrixWorld ).multiply( _eyeRight );\n\n\t}\n\n}\n\nclass ArrayCamera extends PerspectiveCamera {\n\n\tconstructor( array = [] ) {\n\n\t\tsuper();\n\n\t\tthis.isArrayCamera = true;\n\n\t\tthis.cameras = array;\n\n\t}\n\n}\n\nclass Clock {\n\n\tconstructor( autoStart = true ) {\n\n\t\tthis.autoStart = autoStart;\n\n\t\tthis.startTime = 0;\n\t\tthis.oldTime = 0;\n\t\tthis.elapsedTime = 0;\n\n\t\tthis.running = false;\n\n\t}\n\n\tstart() {\n\n\t\tthis.startTime = now();\n\n\t\tthis.oldTime = this.startTime;\n\t\tthis.elapsedTime = 0;\n\t\tthis.running = true;\n\n\t}\n\n\tstop() {\n\n\t\tthis.getElapsedTime();\n\t\tthis.running = false;\n\t\tthis.autoStart = false;\n\n\t}\n\n\tgetElapsedTime() {\n\n\t\tthis.getDelta();\n\t\treturn this.elapsedTime;\n\n\t}\n\n\tgetDelta() {\n\n\t\tlet diff = 0;\n\n\t\tif ( this.autoStart && ! this.running ) {\n\n\t\t\tthis.start();\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tif ( this.running ) {\n\n\t\t\tconst newTime = now();\n\n\t\t\tdiff = ( newTime - this.oldTime ) / 1000;\n\t\t\tthis.oldTime = newTime;\n\n\t\t\tthis.elapsedTime += diff;\n\n\t\t}\n\n\t\treturn diff;\n\n\t}\n\n}\n\nfunction now() {\n\n\treturn performance.now();\n\n}\n\nconst _position$1 = /*@__PURE__*/ new Vector3();\nconst _quaternion$1 = /*@__PURE__*/ new Quaternion();\nconst _scale$1 = /*@__PURE__*/ new Vector3();\nconst _orientation$1 = /*@__PURE__*/ new Vector3();\n\nclass AudioListener extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'AudioListener';\n\n\t\tthis.context = AudioContext.getContext();\n\n\t\tthis.gain = this.context.createGain();\n\t\tthis.gain.connect( this.context.destination );\n\n\t\tthis.filter = null;\n\n\t\tthis.timeDelta = 0;\n\n\t\t// private\n\n\t\tthis._clock = new Clock();\n\n\t}\n\n\tgetInput() {\n\n\t\treturn this.gain;\n\n\t}\n\n\tremoveFilter() {\n\n\t\tif ( this.filter !== null ) {\n\n\t\t\tthis.gain.disconnect( this.filter );\n\t\t\tthis.filter.disconnect( this.context.destination );\n\t\t\tthis.gain.connect( this.context.destination );\n\t\t\tthis.filter = null;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetFilter() {\n\n\t\treturn this.filter;\n\n\t}\n\n\tsetFilter( value ) {\n\n\t\tif ( this.filter !== null ) {\n\n\t\t\tthis.gain.disconnect( this.filter );\n\t\t\tthis.filter.disconnect( this.context.destination );\n\n\t\t} else {\n\n\t\t\tthis.gain.disconnect( this.context.destination );\n\n\t\t}\n\n\t\tthis.filter = value;\n\t\tthis.gain.connect( this.filter );\n\t\tthis.filter.connect( this.context.destination );\n\n\t\treturn this;\n\n\t}\n\n\tgetMasterVolume() {\n\n\t\treturn this.gain.gain.value;\n\n\t}\n\n\tsetMasterVolume( value ) {\n\n\t\tthis.gain.gain.setTargetAtTime( value, this.context.currentTime, 0.01 );\n\n\t\treturn this;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tconst listener = this.context.listener;\n\t\tconst up = this.up;\n\n\t\tthis.timeDelta = this._clock.getDelta();\n\n\t\tthis.matrixWorld.decompose( _position$1, _quaternion$1, _scale$1 );\n\n\t\t_orientation$1.set( 0, 0, - 1 ).applyQuaternion( _quaternion$1 );\n\n\t\tif ( listener.positionX ) {\n\n\t\t\t// code path for Chrome (see #14393)\n\n\t\t\tconst endTime = this.context.currentTime + this.timeDelta;\n\n\t\t\tlistener.positionX.linearRampToValueAtTime( _position$1.x, endTime );\n\t\t\tlistener.positionY.linearRampToValueAtTime( _position$1.y, endTime );\n\t\t\tlistener.positionZ.linearRampToValueAtTime( _position$1.z, endTime );\n\t\t\tlistener.forwardX.linearRampToValueAtTime( _orientation$1.x, endTime );\n\t\t\tlistener.forwardY.linearRampToValueAtTime( _orientation$1.y, endTime );\n\t\t\tlistener.forwardZ.linearRampToValueAtTime( _orientation$1.z, endTime );\n\t\t\tlistener.upX.linearRampToValueAtTime( up.x, endTime );\n\t\t\tlistener.upY.linearRampToValueAtTime( up.y, endTime );\n\t\t\tlistener.upZ.linearRampToValueAtTime( up.z, endTime );\n\n\t\t} else {\n\n\t\t\tlistener.setPosition( _position$1.x, _position$1.y, _position$1.z );\n\t\t\tlistener.setOrientation( _orientation$1.x, _orientation$1.y, _orientation$1.z, up.x, up.y, up.z );\n\n\t\t}\n\n\t}\n\n}\n\nclass Audio extends Object3D {\n\n\tconstructor( listener ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Audio';\n\n\t\tthis.listener = listener;\n\t\tthis.context = listener.context;\n\n\t\tthis.gain = this.context.createGain();\n\t\tthis.gain.connect( listener.getInput() );\n\n\t\tthis.autoplay = false;\n\n\t\tthis.buffer = null;\n\t\tthis.detune = 0;\n\t\tthis.loop = false;\n\t\tthis.loopStart = 0;\n\t\tthis.loopEnd = 0;\n\t\tthis.offset = 0;\n\t\tthis.duration = undefined;\n\t\tthis.playbackRate = 1;\n\t\tthis.isPlaying = false;\n\t\tthis.hasPlaybackControl = true;\n\t\tthis.source = null;\n\t\tthis.sourceType = 'empty';\n\n\t\tthis._startedAt = 0;\n\t\tthis._progress = 0;\n\t\tthis._connected = false;\n\n\t\tthis.filters = [];\n\n\t}\n\n\tgetOutput() {\n\n\t\treturn this.gain;\n\n\t}\n\n\tsetNodeSource( audioNode ) {\n\n\t\tthis.hasPlaybackControl = false;\n\t\tthis.sourceType = 'audioNode';\n\t\tthis.source = audioNode;\n\t\tthis.connect();\n\n\t\treturn this;\n\n\t}\n\n\tsetMediaElementSource( mediaElement ) {\n\n\t\tthis.hasPlaybackControl = false;\n\t\tthis.sourceType = 'mediaNode';\n\t\tthis.source = this.context.createMediaElementSource( mediaElement );\n\t\tthis.connect();\n\n\t\treturn this;\n\n\t}\n\n\tsetMediaStreamSource( mediaStream ) {\n\n\t\tthis.hasPlaybackControl = false;\n\t\tthis.sourceType = 'mediaStreamNode';\n\t\tthis.source = this.context.createMediaStreamSource( mediaStream );\n\t\tthis.connect();\n\n\t\treturn this;\n\n\t}\n\n\tsetBuffer( audioBuffer ) {\n\n\t\tthis.buffer = audioBuffer;\n\t\tthis.sourceType = 'buffer';\n\n\t\tif ( this.autoplay ) this.play();\n\n\t\treturn this;\n\n\t}\n\n\tplay( delay = 0 ) {\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: Audio is already playing.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis._startedAt = this.context.currentTime + delay;\n\n\t\tconst source = this.context.createBufferSource();\n\t\tsource.buffer = this.buffer;\n\t\tsource.loop = this.loop;\n\t\tsource.loopStart = this.loopStart;\n\t\tsource.loopEnd = this.loopEnd;\n\t\tsource.onended = this.onEnded.bind( this );\n\t\tsource.start( this._startedAt, this._progress + this.offset, this.duration );\n\n\t\tthis.isPlaying = true;\n\n\t\tthis.source = source;\n\n\t\tthis.setDetune( this.detune );\n\t\tthis.setPlaybackRate( this.playbackRate );\n\n\t\treturn this.connect();\n\n\t}\n\n\tpause() {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\t// update current progress\n\n\t\t\tthis._progress += Math.max( this.context.currentTime - this._startedAt, 0 ) * this.playbackRate;\n\n\t\t\tif ( this.loop === true ) {\n\n\t\t\t\t// ensure _progress does not exceed duration with looped audios\n\n\t\t\t\tthis._progress = this._progress % ( this.duration || this.buffer.duration );\n\n\t\t\t}\n\n\t\t\tthis.source.stop();\n\t\t\tthis.source.onended = null;\n\n\t\t\tthis.isPlaying = false;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tstop( delay = 0 ) {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis._progress = 0;\n\n\t\tif ( this.source !== null ) {\n\n\t\t\tthis.source.stop( this.context.currentTime + delay );\n\t\t\tthis.source.onended = null;\n\n\t\t}\n\n\t\tthis.isPlaying = false;\n\n\t\treturn this;\n\n\t}\n\n\tconnect() {\n\n\t\tif ( this.filters.length > 0 ) {\n\n\t\t\tthis.source.connect( this.filters[ 0 ] );\n\n\t\t\tfor ( let i = 1, l = this.filters.length; i < l; i ++ ) {\n\n\t\t\t\tthis.filters[ i - 1 ].connect( this.filters[ i ] );\n\n\t\t\t}\n\n\t\t\tthis.filters[ this.filters.length - 1 ].connect( this.getOutput() );\n\n\t\t} else {\n\n\t\t\tthis.source.connect( this.getOutput() );\n\n\t\t}\n\n\t\tthis._connected = true;\n\n\t\treturn this;\n\n\t}\n\n\tdisconnect() {\n\n\t\tif ( this._connected === false ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( this.filters.length > 0 ) {\n\n\t\t\tthis.source.disconnect( this.filters[ 0 ] );\n\n\t\t\tfor ( let i = 1, l = this.filters.length; i < l; i ++ ) {\n\n\t\t\t\tthis.filters[ i - 1 ].disconnect( this.filters[ i ] );\n\n\t\t\t}\n\n\t\t\tthis.filters[ this.filters.length - 1 ].disconnect( this.getOutput() );\n\n\t\t} else {\n\n\t\t\tthis.source.disconnect( this.getOutput() );\n\n\t\t}\n\n\t\tthis._connected = false;\n\n\t\treturn this;\n\n\t}\n\n\tgetFilters() {\n\n\t\treturn this.filters;\n\n\t}\n\n\tsetFilters( value ) {\n\n\t\tif ( ! value ) value = [];\n\n\t\tif ( this._connected === true ) {\n\n\t\t\tthis.disconnect();\n\t\t\tthis.filters = value.slice();\n\t\t\tthis.connect();\n\n\t\t} else {\n\n\t\t\tthis.filters = value.slice();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetDetune( value ) {\n\n\t\tthis.detune = value;\n\n\t\tif ( this.isPlaying === true && this.source.detune !== undefined ) {\n\n\t\t\tthis.source.detune.setTargetAtTime( this.detune, this.context.currentTime, 0.01 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetDetune() {\n\n\t\treturn this.detune;\n\n\t}\n\n\tgetFilter() {\n\n\t\treturn this.getFilters()[ 0 ];\n\n\t}\n\n\tsetFilter( filter ) {\n\n\t\treturn this.setFilters( filter ? [ filter ] : [] );\n\n\t}\n\n\tsetPlaybackRate( value ) {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.playbackRate = value;\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\tthis.source.playbackRate.setTargetAtTime( this.playbackRate, this.context.currentTime, 0.01 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetPlaybackRate() {\n\n\t\treturn this.playbackRate;\n\n\t}\n\n\tonEnded() {\n\n\t\tthis.isPlaying = false;\n\t\tthis._progress = 0;\n\n\t}\n\n\tgetLoop() {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn false;\n\n\t\t}\n\n\t\treturn this.loop;\n\n\t}\n\n\tsetLoop( value ) {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.loop = value;\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\tthis.source.loop = this.loop;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetLoopStart( value ) {\n\n\t\tthis.loopStart = value;\n\n\t\treturn this;\n\n\t}\n\n\tsetLoopEnd( value ) {\n\n\t\tthis.loopEnd = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetVolume() {\n\n\t\treturn this.gain.gain.value;\n\n\t}\n\n\tsetVolume( value ) {\n\n\t\tthis.gain.gain.setTargetAtTime( value, this.context.currentTime, 0.01 );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tif ( source.sourceType !== 'buffer' ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: Audio source type cannot be copied.' );\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tthis.autoplay = source.autoplay;\n\n\t\tthis.buffer = source.buffer;\n\t\tthis.detune = source.detune;\n\t\tthis.loop = source.loop;\n\t\tthis.loopStart = source.loopStart;\n\t\tthis.loopEnd = source.loopEnd;\n\t\tthis.offset = source.offset;\n\t\tthis.duration = source.duration;\n\t\tthis.playbackRate = source.playbackRate;\n\t\tthis.hasPlaybackControl = source.hasPlaybackControl;\n\t\tthis.sourceType = source.sourceType;\n\n\t\tthis.filters = source.filters.slice();\n\n\t\treturn this;\n\n\t}\n\n\tclone( recursive ) {\n\n\t\treturn new this.constructor( this.listener ).copy( this, recursive );\n\n\t}\n\n}\n\nconst _position = /*@__PURE__*/ new Vector3();\nconst _quaternion = /*@__PURE__*/ new Quaternion();\nconst _scale = /*@__PURE__*/ new Vector3();\nconst _orientation = /*@__PURE__*/ new Vector3();\n\nclass PositionalAudio extends Audio {\n\n\tconstructor( listener ) {\n\n\t\tsuper( listener );\n\n\t\tthis.panner = this.context.createPanner();\n\t\tthis.panner.panningModel = 'HRTF';\n\t\tthis.panner.connect( this.gain );\n\n\t}\n\n\tconnect() {\n\n\t\tsuper.connect();\n\n\t\tthis.panner.connect( this.gain );\n\n\t}\n\n\tdisconnect() {\n\n\t\tsuper.disconnect();\n\n\t\tthis.panner.disconnect( this.gain );\n\n\t}\n\n\tgetOutput() {\n\n\t\treturn this.panner;\n\n\t}\n\n\tgetRefDistance() {\n\n\t\treturn this.panner.refDistance;\n\n\t}\n\n\tsetRefDistance( value ) {\n\n\t\tthis.panner.refDistance = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetRolloffFactor() {\n\n\t\treturn this.panner.rolloffFactor;\n\n\t}\n\n\tsetRolloffFactor( value ) {\n\n\t\tthis.panner.rolloffFactor = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetDistanceModel() {\n\n\t\treturn this.panner.distanceModel;\n\n\t}\n\n\tsetDistanceModel( value ) {\n\n\t\tthis.panner.distanceModel = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetMaxDistance() {\n\n\t\treturn this.panner.maxDistance;\n\n\t}\n\n\tsetMaxDistance( value ) {\n\n\t\tthis.panner.maxDistance = value;\n\n\t\treturn this;\n\n\t}\n\n\tsetDirectionalCone( coneInnerAngle, coneOuterAngle, coneOuterGain ) {\n\n\t\tthis.panner.coneInnerAngle = coneInnerAngle;\n\t\tthis.panner.coneOuterAngle = coneOuterAngle;\n\t\tthis.panner.coneOuterGain = coneOuterGain;\n\n\t\treturn this;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tif ( this.hasPlaybackControl === true && this.isPlaying === false ) return;\n\n\t\tthis.matrixWorld.decompose( _position, _quaternion, _scale );\n\n\t\t_orientation.set( 0, 0, 1 ).applyQuaternion( _quaternion );\n\n\t\tconst panner = this.panner;\n\n\t\tif ( panner.positionX ) {\n\n\t\t\t// code path for Chrome and Firefox (see #14393)\n\n\t\t\tconst endTime = this.context.currentTime + this.listener.timeDelta;\n\n\t\t\tpanner.positionX.linearRampToValueAtTime( _position.x, endTime );\n\t\t\tpanner.positionY.linearRampToValueAtTime( _position.y, endTime );\n\t\t\tpanner.positionZ.linearRampToValueAtTime( _position.z, endTime );\n\t\t\tpanner.orientationX.linearRampToValueAtTime( _orientation.x, endTime );\n\t\t\tpanner.orientationY.linearRampToValueAtTime( _orientation.y, endTime );\n\t\t\tpanner.orientationZ.linearRampToValueAtTime( _orientation.z, endTime );\n\n\t\t} else {\n\n\t\t\tpanner.setPosition( _position.x, _position.y, _position.z );\n\t\t\tpanner.setOrientation( _orientation.x, _orientation.y, _orientation.z );\n\n\t\t}\n\n\t}\n\n}\n\nclass AudioAnalyser {\n\n\tconstructor( audio, fftSize = 2048 ) {\n\n\t\tthis.analyser = audio.context.createAnalyser();\n\t\tthis.analyser.fftSize = fftSize;\n\n\t\tthis.data = new Uint8Array( this.analyser.frequencyBinCount );\n\n\t\taudio.getOutput().connect( this.analyser );\n\n\t}\n\n\n\tgetFrequencyData() {\n\n\t\tthis.analyser.getByteFrequencyData( this.data );\n\n\t\treturn this.data;\n\n\t}\n\n\tgetAverageFrequency() {\n\n\t\tlet value = 0;\n\t\tconst data = this.getFrequencyData();\n\n\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\tvalue += data[ i ];\n\n\t\t}\n\n\t\treturn value / data.length;\n\n\t}\n\n}\n\nclass PropertyMixer {\n\n\tconstructor( binding, typeName, valueSize ) {\n\n\t\tthis.binding = binding;\n\t\tthis.valueSize = valueSize;\n\n\t\tlet mixFunction,\n\t\t\tmixFunctionAdditive,\n\t\t\tsetIdentity;\n\n\t\t// buffer layout: [ incoming | accu0 | accu1 | orig | addAccu | (optional work) ]\n\t\t//\n\t\t// interpolators can use .buffer as their .result\n\t\t// the data then goes to 'incoming'\n\t\t//\n\t\t// 'accu0' and 'accu1' are used frame-interleaved for\n\t\t// the cumulative result and are compared to detect\n\t\t// changes\n\t\t//\n\t\t// 'orig' stores the original state of the property\n\t\t//\n\t\t// 'add' is used for additive cumulative results\n\t\t//\n\t\t// 'work' is optional and is only present for quaternion types. It is used\n\t\t// to store intermediate quaternion multiplication results\n\n\t\tswitch ( typeName ) {\n\n\t\t\tcase 'quaternion':\n\t\t\t\tmixFunction = this._slerp;\n\t\t\t\tmixFunctionAdditive = this._slerpAdditive;\n\t\t\t\tsetIdentity = this._setAdditiveIdentityQuaternion;\n\n\t\t\t\tthis.buffer = new Float64Array( valueSize * 6 );\n\t\t\t\tthis._workIndex = 5;\n\t\t\t\tbreak;\n\n\t\t\tcase 'string':\n\t\t\tcase 'bool':\n\t\t\t\tmixFunction = this._select;\n\n\t\t\t\t// Use the regular mix function and for additive on these types,\n\t\t\t\t// additive is not relevant for non-numeric types\n\t\t\t\tmixFunctionAdditive = this._select;\n\n\t\t\t\tsetIdentity = this._setAdditiveIdentityOther;\n\n\t\t\t\tthis.buffer = new Array( valueSize * 5 );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tmixFunction = this._lerp;\n\t\t\t\tmixFunctionAdditive = this._lerpAdditive;\n\t\t\t\tsetIdentity = this._setAdditiveIdentityNumeric;\n\n\t\t\t\tthis.buffer = new Float64Array( valueSize * 5 );\n\n\t\t}\n\n\t\tthis._mixBufferRegion = mixFunction;\n\t\tthis._mixBufferRegionAdditive = mixFunctionAdditive;\n\t\tthis._setIdentity = setIdentity;\n\t\tthis._origIndex = 3;\n\t\tthis._addIndex = 4;\n\n\t\tthis.cumulativeWeight = 0;\n\t\tthis.cumulativeWeightAdditive = 0;\n\n\t\tthis.useCount = 0;\n\t\tthis.referenceCount = 0;\n\n\t}\n\n\t// accumulate data in the 'incoming' region into 'accu<i>'\n\taccumulate( accuIndex, weight ) {\n\n\t\t// note: happily accumulating nothing when weight = 0, the caller knows\n\t\t// the weight and shouldn't have made the call in the first place\n\n\t\tconst buffer = this.buffer,\n\t\t\tstride = this.valueSize,\n\t\t\toffset = accuIndex * stride + stride;\n\n\t\tlet currentWeight = this.cumulativeWeight;\n\n\t\tif ( currentWeight === 0 ) {\n\n\t\t\t// accuN := incoming * weight\n\n\t\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\t\tbuffer[ offset + i ] = buffer[ i ];\n\n\t\t\t}\n\n\t\t\tcurrentWeight = weight;\n\n\t\t} else {\n\n\t\t\t// accuN := accuN + incoming * weight\n\n\t\t\tcurrentWeight += weight;\n\t\t\tconst mix = weight / currentWeight;\n\t\t\tthis._mixBufferRegion( buffer, offset, 0, mix, stride );\n\n\t\t}\n\n\t\tthis.cumulativeWeight = currentWeight;\n\n\t}\n\n\t// accumulate data in the 'incoming' region into 'add'\n\taccumulateAdditive( weight ) {\n\n\t\tconst buffer = this.buffer,\n\t\t\tstride = this.valueSize,\n\t\t\toffset = stride * this._addIndex;\n\n\t\tif ( this.cumulativeWeightAdditive === 0 ) {\n\n\t\t\t// add = identity\n\n\t\t\tthis._setIdentity();\n\n\t\t}\n\n\t\t// add := add + incoming * weight\n\n\t\tthis._mixBufferRegionAdditive( buffer, offset, 0, weight, stride );\n\t\tthis.cumulativeWeightAdditive += weight;\n\n\t}\n\n\t// apply the state of 'accu<i>' to the binding when accus differ\n\tapply( accuIndex ) {\n\n\t\tconst stride = this.valueSize,\n\t\t\tbuffer = this.buffer,\n\t\t\toffset = accuIndex * stride + stride,\n\n\t\t\tweight = this.cumulativeWeight,\n\t\t\tweightAdditive = this.cumulativeWeightAdditive,\n\n\t\t\tbinding = this.binding;\n\n\t\tthis.cumulativeWeight = 0;\n\t\tthis.cumulativeWeightAdditive = 0;\n\n\t\tif ( weight < 1 ) {\n\n\t\t\t// accuN := accuN + original * ( 1 - cumulativeWeight )\n\n\t\t\tconst originalValueOffset = stride * this._origIndex;\n\n\t\t\tthis._mixBufferRegion(\n\t\t\t\tbuffer, offset, originalValueOffset, 1 - weight, stride );\n\n\t\t}\n\n\t\tif ( weightAdditive > 0 ) {\n\n\t\t\t// accuN := accuN + additive accuN\n\n\t\t\tthis._mixBufferRegionAdditive( buffer, offset, this._addIndex * stride, 1, stride );\n\n\t\t}\n\n\t\tfor ( let i = stride, e = stride + stride; i !== e; ++ i ) {\n\n\t\t\tif ( buffer[ i ] !== buffer[ i + stride ] ) {\n\n\t\t\t\t// value has changed -> update scene graph\n\n\t\t\t\tbinding.setValue( buffer, offset );\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// remember the state of the bound property and copy it to both accus\n\tsaveOriginalState() {\n\n\t\tconst binding = this.binding;\n\n\t\tconst buffer = this.buffer,\n\t\t\tstride = this.valueSize,\n\n\t\t\toriginalValueOffset = stride * this._origIndex;\n\n\t\tbinding.getValue( buffer, originalValueOffset );\n\n\t\t// accu[0..1] := orig -- initially detect changes against the original\n\t\tfor ( let i = stride, e = originalValueOffset; i !== e; ++ i ) {\n\n\t\t\tbuffer[ i ] = buffer[ originalValueOffset + ( i % stride ) ];\n\n\t\t}\n\n\t\t// Add to identity for additive\n\t\tthis._setIdentity();\n\n\t\tthis.cumulativeWeight = 0;\n\t\tthis.cumulativeWeightAdditive = 0;\n\n\t}\n\n\t// apply the state previously taken via 'saveOriginalState' to the binding\n\trestoreOriginalState() {\n\n\t\tconst originalValueOffset = this.valueSize * 3;\n\t\tthis.binding.setValue( this.buffer, originalValueOffset );\n\n\t}\n\n\t_setAdditiveIdentityNumeric() {\n\n\t\tconst startIndex = this._addIndex * this.valueSize;\n\t\tconst endIndex = startIndex + this.valueSize;\n\n\t\tfor ( let i = startIndex; i < endIndex; i ++ ) {\n\n\t\t\tthis.buffer[ i ] = 0;\n\n\t\t}\n\n\t}\n\n\t_setAdditiveIdentityQuaternion() {\n\n\t\tthis._setAdditiveIdentityNumeric();\n\t\tthis.buffer[ this._addIndex * this.valueSize + 3 ] = 1;\n\n\t}\n\n\t_setAdditiveIdentityOther() {\n\n\t\tconst startIndex = this._origIndex * this.valueSize;\n\t\tconst targetIndex = this._addIndex * this.valueSize;\n\n\t\tfor ( let i = 0; i < this.valueSize; i ++ ) {\n\n\t\t\tthis.buffer[ targetIndex + i ] = this.buffer[ startIndex + i ];\n\n\t\t}\n\n\t}\n\n\n\t// mix functions\n\n\t_select( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tif ( t >= 0.5 ) {\n\n\t\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\t\tbuffer[ dstOffset + i ] = buffer[ srcOffset + i ];\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_slerp( buffer, dstOffset, srcOffset, t ) {\n\n\t\tQuaternion.slerpFlat( buffer, dstOffset, buffer, dstOffset, buffer, srcOffset, t );\n\n\t}\n\n\t_slerpAdditive( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tconst workOffset = this._workIndex * stride;\n\n\t\t// Store result in intermediate buffer offset\n\t\tQuaternion.multiplyQuaternionsFlat( buffer, workOffset, buffer, dstOffset, buffer, srcOffset );\n\n\t\t// Slerp to the intermediate result\n\t\tQuaternion.slerpFlat( buffer, dstOffset, buffer, dstOffset, buffer, workOffset, t );\n\n\t}\n\n\t_lerp( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tconst s = 1 - t;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tconst j = dstOffset + i;\n\n\t\t\tbuffer[ j ] = buffer[ j ] * s + buffer[ srcOffset + i ] * t;\n\n\t\t}\n\n\t}\n\n\t_lerpAdditive( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tconst j = dstOffset + i;\n\n\t\t\tbuffer[ j ] = buffer[ j ] + buffer[ srcOffset + i ] * t;\n\n\t\t}\n\n\t}\n\n}\n\n// Characters [].:/ are reserved for track binding syntax.\nconst _RESERVED_CHARS_RE = '\\\\[\\\\]\\\\.:\\\\/';\nconst _reservedRe = new RegExp( '[' + _RESERVED_CHARS_RE + ']', 'g' );\n\n// Attempts to allow node names from any language. ES5's `\\w` regexp matches\n// only latin characters, and the unicode \\p{L} is not yet supported. So\n// instead, we exclude reserved characters and match everything else.\nconst _wordChar = '[^' + _RESERVED_CHARS_RE + ']';\nconst _wordCharOrDot = '[^' + _RESERVED_CHARS_RE.replace( '\\\\.', '' ) + ']';\n\n// Parent directories, delimited by '/' or ':'. Currently unused, but must\n// be matched to parse the rest of the track name.\nconst _directoryRe = /*@__PURE__*/ /((?:WC+[\\/:])*)/.source.replace( 'WC', _wordChar );\n\n// Target node. May contain word characters (a-zA-Z0-9_) and '.' or '-'.\nconst _nodeRe = /*@__PURE__*/ /(WCOD+)?/.source.replace( 'WCOD', _wordCharOrDot );\n\n// Object on target node, and accessor. May not contain reserved\n// characters. Accessor may contain any character except closing bracket.\nconst _objectRe = /*@__PURE__*/ /(?:\\.(WC+)(?:\\[(.+)\\])?)?/.source.replace( 'WC', _wordChar );\n\n// Property and accessor. May not contain reserved characters. Accessor may\n// contain any non-bracket characters.\nconst _propertyRe = /*@__PURE__*/ /\\.(WC+)(?:\\[(.+)\\])?/.source.replace( 'WC', _wordChar );\n\nconst _trackRe = new RegExp( ''\n\t+ '^'\n\t+ _directoryRe\n\t+ _nodeRe\n\t+ _objectRe\n\t+ _propertyRe\n\t+ '$'\n);\n\nconst _supportedObjectNames = [ 'material', 'materials', 'bones', 'map' ];\n\nclass Composite {\n\n\tconstructor( targetGroup, path, optionalParsedPath ) {\n\n\t\tconst parsedPath = optionalParsedPath || PropertyBinding.parseTrackName( path );\n\n\t\tthis._targetGroup = targetGroup;\n\t\tthis._bindings = targetGroup.subscribe_( path, parsedPath );\n\n\t}\n\n\tgetValue( array, offset ) {\n\n\t\tthis.bind(); // bind all binding\n\n\t\tconst firstValidIndex = this._targetGroup.nCachedObjects_,\n\t\t\tbinding = this._bindings[ firstValidIndex ];\n\n\t\t// and only call .getValue on the first\n\t\tif ( binding !== undefined ) binding.getValue( array, offset );\n\n\t}\n\n\tsetValue( array, offset ) {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].setValue( array, offset );\n\n\t\t}\n\n\t}\n\n\tbind() {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].bind();\n\n\t\t}\n\n\t}\n\n\tunbind() {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].unbind();\n\n\t\t}\n\n\t}\n\n}\n\n// Note: This class uses a State pattern on a per-method basis:\n// 'bind' sets 'this.getValue' / 'setValue' and shadows the\n// prototype version of these methods with one that represents\n// the bound state. When the property is not found, the methods\n// become no-ops.\nclass PropertyBinding {\n\n\tconstructor( rootNode, path, parsedPath ) {\n\n\t\tthis.path = path;\n\t\tthis.parsedPath = parsedPath || PropertyBinding.parseTrackName( path );\n\n\t\tthis.node = PropertyBinding.findNode( rootNode, this.parsedPath.nodeName );\n\n\t\tthis.rootNode = rootNode;\n\n\t\t// initial state of these methods that calls 'bind'\n\t\tthis.getValue = this._getValue_unbound;\n\t\tthis.setValue = this._setValue_unbound;\n\n\t}\n\n\n\tstatic create( root, path, parsedPath ) {\n\n\t\tif ( ! ( root && root.isAnimationObjectGroup ) ) {\n\n\t\t\treturn new PropertyBinding( root, path, parsedPath );\n\n\t\t} else {\n\n\t\t\treturn new PropertyBinding.Composite( root, path, parsedPath );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Replaces spaces with underscores and removes unsupported characters from\n\t * node names, to ensure compatibility with parseTrackName().\n\t *\n\t * @param {string} name Node name to be sanitized.\n\t * @return {string}\n\t */\n\tstatic sanitizeNodeName( name ) {\n\n\t\treturn name.replace( /\\s/g, '_' ).replace( _reservedRe, '' );\n\n\t}\n\n\tstatic parseTrackName( trackName ) {\n\n\t\tconst matches = _trackRe.exec( trackName );\n\n\t\tif ( matches === null ) {\n\n\t\t\tthrow new Error( 'PropertyBinding: Cannot parse trackName: ' + trackName );\n\n\t\t}\n\n\t\tconst results = {\n\t\t\t// directoryName: matches[ 1 ], // (tschw) currently unused\n\t\t\tnodeName: matches[ 2 ],\n\t\t\tobjectName: matches[ 3 ],\n\t\t\tobjectIndex: matches[ 4 ],\n\t\t\tpropertyName: matches[ 5 ], // required\n\t\t\tpropertyIndex: matches[ 6 ]\n\t\t};\n\n\t\tconst lastDot = results.nodeName && results.nodeName.lastIndexOf( '.' );\n\n\t\tif ( lastDot !== undefined && lastDot !== - 1 ) {\n\n\t\t\tconst objectName = results.nodeName.substring( lastDot + 1 );\n\n\t\t\t// Object names must be checked against an allowlist. Otherwise, there\n\t\t\t// is no way to parse 'foo.bar.baz': 'baz' must be a property, but\n\t\t\t// 'bar' could be the objectName, or part of a nodeName (which can\n\t\t\t// include '.' characters).\n\t\t\tif ( _supportedObjectNames.indexOf( objectName ) !== - 1 ) {\n\n\t\t\t\tresults.nodeName = results.nodeName.substring( 0, lastDot );\n\t\t\t\tresults.objectName = objectName;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( results.propertyName === null || results.propertyName.length === 0 ) {\n\n\t\t\tthrow new Error( 'PropertyBinding: can not parse propertyName from trackName: ' + trackName );\n\n\t\t}\n\n\t\treturn results;\n\n\t}\n\n\tstatic findNode( root, nodeName ) {\n\n\t\tif ( nodeName === undefined || nodeName === '' || nodeName === '.' || nodeName === - 1 || nodeName === root.name || nodeName === root.uuid ) {\n\n\t\t\treturn root;\n\n\t\t}\n\n\t\t// search into skeleton bones.\n\t\tif ( root.skeleton ) {\n\n\t\t\tconst bone = root.skeleton.getBoneByName( nodeName );\n\n\t\t\tif ( bone !== undefined ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// search into node subtree.\n\t\tif ( root.children ) {\n\n\t\t\tconst searchNodeSubtree = function ( children ) {\n\n\t\t\t\tfor ( let i = 0; i < children.length; i ++ ) {\n\n\t\t\t\t\tconst childNode = children[ i ];\n\n\t\t\t\t\tif ( childNode.name === nodeName || childNode.uuid === nodeName ) {\n\n\t\t\t\t\t\treturn childNode;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst result = searchNodeSubtree( childNode.children );\n\n\t\t\t\t\tif ( result ) return result;\n\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\n\t\t\t};\n\n\t\t\tconst subTreeNode = searchNodeSubtree( root.children );\n\n\t\t\tif ( subTreeNode ) {\n\n\t\t\t\treturn subTreeNode;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t// these are used to \"bind\" a nonexistent property\n\t_getValue_unavailable() {}\n\t_setValue_unavailable() {}\n\n\t// Getters\n\n\t_getValue_direct( buffer, offset ) {\n\n\t\tbuffer[ offset ] = this.targetObject[ this.propertyName ];\n\n\t}\n\n\t_getValue_array( buffer, offset ) {\n\n\t\tconst source = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = source.length; i !== n; ++ i ) {\n\n\t\t\tbuffer[ offset ++ ] = source[ i ];\n\n\t\t}\n\n\t}\n\n\t_getValue_arrayElement( buffer, offset ) {\n\n\t\tbuffer[ offset ] = this.resolvedProperty[ this.propertyIndex ];\n\n\t}\n\n\t_getValue_toArray( buffer, offset ) {\n\n\t\tthis.resolvedProperty.toArray( buffer, offset );\n\n\t}\n\n\t// Direct\n\n\t_setValue_direct( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\n\t}\n\n\t_setValue_direct_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_direct_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// EntireArray\n\n\t_setValue_array( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t}\n\n\t_setValue_array_setNeedsUpdate( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_array_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// ArrayElement\n\n\t_setValue_arrayElement( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\n\t}\n\n\t_setValue_arrayElement_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_arrayElement_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// HasToFromArray\n\n\t_setValue_fromArray( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\n\t}\n\n\t_setValue_fromArray_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_fromArray_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t_getValue_unbound( targetArray, offset ) {\n\n\t\tthis.bind();\n\t\tthis.getValue( targetArray, offset );\n\n\t}\n\n\t_setValue_unbound( sourceArray, offset ) {\n\n\t\tthis.bind();\n\t\tthis.setValue( sourceArray, offset );\n\n\t}\n\n\t// create getter / setter pair for a property in the scene graph\n\tbind() {\n\n\t\tlet targetObject = this.node;\n\t\tconst parsedPath = this.parsedPath;\n\n\t\tconst objectName = parsedPath.objectName;\n\t\tconst propertyName = parsedPath.propertyName;\n\t\tlet propertyIndex = parsedPath.propertyIndex;\n\n\t\tif ( ! targetObject ) {\n\n\t\t\ttargetObject = PropertyBinding.findNode( this.rootNode, parsedPath.nodeName );\n\n\t\t\tthis.node = targetObject;\n\n\t\t}\n\n\t\t// set fail state so we can just 'return' on error\n\t\tthis.getValue = this._getValue_unavailable;\n\t\tthis.setValue = this._setValue_unavailable;\n\n\t\t// ensure there is a value node\n\t\tif ( ! targetObject ) {\n\n\t\t\tconsole.warn( 'THREE.PropertyBinding: No target node found for track: ' + this.path + '.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( objectName ) {\n\n\t\t\tlet objectIndex = parsedPath.objectIndex;\n\n\t\t\t// special cases were we need to reach deeper into the hierarchy to get the face materials....\n\t\t\tswitch ( objectName ) {\n\n\t\t\t\tcase 'materials':\n\n\t\t\t\t\tif ( ! targetObject.material ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material as node does not have a material.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! targetObject.material.materials ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject.material.materials;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bones':\n\n\t\t\t\t\tif ( ! targetObject.skeleton ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// potential future optimization: skip this if propertyIndex is already an integer\n\t\t\t\t\t// and convert the integer string to a true integer.\n\n\t\t\t\t\ttargetObject = targetObject.skeleton.bones;\n\n\t\t\t\t\t// support resolving morphTarget names into indices.\n\t\t\t\t\tfor ( let i = 0; i < targetObject.length; i ++ ) {\n\n\t\t\t\t\t\tif ( targetObject[ i ].name === objectIndex ) {\n\n\t\t\t\t\t\t\tobjectIndex = i;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'map':\n\n\t\t\t\t\tif ( 'map' in targetObject ) {\n\n\t\t\t\t\t\ttargetObject = targetObject.map;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! targetObject.material ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material as node does not have a material.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! targetObject.material.map ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject.material.map;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tif ( targetObject[ objectName ] === undefined ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to objectName of node undefined.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject[ objectName ];\n\n\t\t\t}\n\n\n\t\t\tif ( objectIndex !== undefined ) {\n\n\t\t\t\tif ( targetObject[ objectIndex ] === undefined ) {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.', this, targetObject );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\ttargetObject = targetObject[ objectIndex ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// resolve property\n\t\tconst nodeProperty = targetObject[ propertyName ];\n\n\t\tif ( nodeProperty === undefined ) {\n\n\t\t\tconst nodeName = parsedPath.nodeName;\n\n\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to update property for track: ' + nodeName +\n\t\t\t\t'.' + propertyName + ' but it wasn\\'t found.', targetObject );\n\t\t\treturn;\n\n\t\t}\n\n\t\t// determine versioning scheme\n\t\tlet versioning = this.Versioning.None;\n\n\t\tthis.targetObject = targetObject;\n\n\t\tif ( targetObject.needsUpdate !== undefined ) { // material\n\n\t\t\tversioning = this.Versioning.NeedsUpdate;\n\n\t\t} else if ( targetObject.matrixWorldNeedsUpdate !== undefined ) { // node transform\n\n\t\t\tversioning = this.Versioning.MatrixWorldNeedsUpdate;\n\n\t\t}\n\n\t\t// determine how the property gets bound\n\t\tlet bindingType = this.BindingType.Direct;\n\n\t\tif ( propertyIndex !== undefined ) {\n\n\t\t\t// access a sub element of the property array (only primitives are supported right now)\n\n\t\t\tif ( propertyName === 'morphTargetInfluences' ) {\n\n\t\t\t\t// potential optimization, skip this if propertyIndex is already an integer, and convert the integer string to a true integer.\n\n\t\t\t\t// support resolving morphTarget names into indices.\n\t\t\t\tif ( ! targetObject.geometry ) {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.', this );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( ! targetObject.geometry.morphAttributes ) {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.', this );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( targetObject.morphTargetDictionary[ propertyIndex ] !== undefined ) {\n\n\t\t\t\t\tpropertyIndex = targetObject.morphTargetDictionary[ propertyIndex ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tbindingType = this.BindingType.ArrayElement;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\t\t\tthis.propertyIndex = propertyIndex;\n\n\t\t} else if ( nodeProperty.fromArray !== undefined && nodeProperty.toArray !== undefined ) {\n\n\t\t\t// must use copy for Object3D.Euler/Quaternion\n\n\t\t\tbindingType = this.BindingType.HasFromToArray;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\n\t\t} else if ( Array.isArray( nodeProperty ) ) {\n\n\t\t\tbindingType = this.BindingType.EntireArray;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\n\t\t} else {\n\n\t\t\tthis.propertyName = propertyName;\n\n\t\t}\n\n\t\t// select getter / setter\n\t\tthis.getValue = this.GetterByBindingType[ bindingType ];\n\t\tthis.setValue = this.SetterByBindingTypeAndVersioning[ bindingType ][ versioning ];\n\n\t}\n\n\tunbind() {\n\n\t\tthis.node = null;\n\n\t\t// back to the prototype version of getValue / setValue\n\t\t// note: avoiding to mutate the shape of 'this' via 'delete'\n\t\tthis.getValue = this._getValue_unbound;\n\t\tthis.setValue = this._setValue_unbound;\n\n\t}\n\n}\n\nPropertyBinding.Composite = Composite;\n\nPropertyBinding.prototype.BindingType = {\n\tDirect: 0,\n\tEntireArray: 1,\n\tArrayElement: 2,\n\tHasFromToArray: 3\n};\n\nPropertyBinding.prototype.Versioning = {\n\tNone: 0,\n\tNeedsUpdate: 1,\n\tMatrixWorldNeedsUpdate: 2\n};\n\nPropertyBinding.prototype.GetterByBindingType = [\n\n\tPropertyBinding.prototype._getValue_direct,\n\tPropertyBinding.prototype._getValue_array,\n\tPropertyBinding.prototype._getValue_arrayElement,\n\tPropertyBinding.prototype._getValue_toArray,\n\n];\n\nPropertyBinding.prototype.SetterByBindingTypeAndVersioning = [\n\n\t[\n\t\t// Direct\n\t\tPropertyBinding.prototype._setValue_direct,\n\t\tPropertyBinding.prototype._setValue_direct_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// EntireArray\n\n\t\tPropertyBinding.prototype._setValue_array,\n\t\tPropertyBinding.prototype._setValue_array_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// ArrayElement\n\t\tPropertyBinding.prototype._setValue_arrayElement,\n\t\tPropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// HasToFromArray\n\t\tPropertyBinding.prototype._setValue_fromArray,\n\t\tPropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate,\n\n\t]\n\n];\n\n/**\n *\n * A group of objects that receives a shared animation state.\n *\n * Usage:\n *\n *  - Add objects you would otherwise pass as 'root' to the\n *    constructor or the .clipAction method of AnimationMixer.\n *\n *  - Instead pass this object as 'root'.\n *\n *  - You can also add and remove objects later when the mixer\n *    is running.\n *\n * Note:\n *\n *    Objects of this class appear as one object to the mixer,\n *    so cache control of the individual objects must be done\n *    on the group.\n *\n * Limitation:\n *\n *  - The animated properties must be compatible among the\n *    all objects in the group.\n *\n *  - A single property can either be controlled through a\n *    target group or directly, but not both.\n */\n\nclass AnimationObjectGroup {\n\n\tconstructor() {\n\n\t\tthis.isAnimationObjectGroup = true;\n\n\t\tthis.uuid = generateUUID();\n\n\t\t// cached objects followed by the active ones\n\t\tthis._objects = Array.prototype.slice.call( arguments );\n\n\t\tthis.nCachedObjects_ = 0; // threshold\n\t\t// note: read by PropertyBinding.Composite\n\n\t\tconst indices = {};\n\t\tthis._indicesByUUID = indices; // for bookkeeping\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tindices[ arguments[ i ].uuid ] = i;\n\n\t\t}\n\n\t\tthis._paths = []; // inside: string\n\t\tthis._parsedPaths = []; // inside: { we don't care, here }\n\t\tthis._bindings = []; // inside: Array< PropertyBinding >\n\t\tthis._bindingsIndicesByPath = {}; // inside: indices in these arrays\n\n\t\tconst scope = this;\n\n\t\tthis.stats = {\n\n\t\t\tobjects: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._objects.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn this.total - scope.nCachedObjects_;\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tget bindingsPerObject() {\n\n\t\t\t\treturn scope._bindings.length;\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\tadd() {\n\n\t\tconst objects = this._objects,\n\t\t\tindicesByUUID = this._indicesByUUID,\n\t\t\tpaths = this._paths,\n\t\t\tparsedPaths = this._parsedPaths,\n\t\t\tbindings = this._bindings,\n\t\t\tnBindings = bindings.length;\n\n\t\tlet knownObject = undefined,\n\t\t\tnObjects = objects.length,\n\t\t\tnCachedObjects = this.nCachedObjects_;\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tconst object = arguments[ i ],\n\t\t\t\tuuid = object.uuid;\n\t\t\tlet index = indicesByUUID[ uuid ];\n\n\t\t\tif ( index === undefined ) {\n\n\t\t\t\t// unknown object -> add it to the ACTIVE region\n\n\t\t\t\tindex = nObjects ++;\n\t\t\t\tindicesByUUID[ uuid ] = index;\n\t\t\t\tobjects.push( object );\n\n\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\tbindings[ j ].push( new PropertyBinding( object, paths[ j ], parsedPaths[ j ] ) );\n\n\t\t\t\t}\n\n\t\t\t} else if ( index < nCachedObjects ) {\n\n\t\t\t\tknownObject = objects[ index ];\n\n\t\t\t\t// move existing object to the ACTIVE region\n\n\t\t\t\tconst firstActiveIndex = -- nCachedObjects,\n\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ];\n\n\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\n\t\t\t\tobjects[ index ] = lastCachedObject;\n\n\t\t\t\tindicesByUUID[ uuid ] = firstActiveIndex;\n\t\t\t\tobjects[ firstActiveIndex ] = object;\n\n\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\tconst bindingsForPath = bindings[ j ],\n\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ];\n\n\t\t\t\t\tlet binding = bindingsForPath[ index ];\n\n\t\t\t\t\tbindingsForPath[ index ] = lastCached;\n\n\t\t\t\t\tif ( binding === undefined ) {\n\n\t\t\t\t\t\t// since we do not bother to create new bindings\n\t\t\t\t\t\t// for objects that are cached, the binding may\n\t\t\t\t\t\t// or may not exist\n\n\t\t\t\t\t\tbinding = new PropertyBinding( object, paths[ j ], parsedPaths[ j ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = binding;\n\n\t\t\t\t}\n\n\t\t\t} else if ( objects[ index ] !== knownObject ) {\n\n\t\t\t\tconsole.error( 'THREE.AnimationObjectGroup: Different objects with the same UUID ' +\n\t\t\t\t\t'detected. Clean the caches or recreate your infrastructure when reloading scenes.' );\n\n\t\t\t} // else the object is already where we want it to be\n\n\t\t} // for arguments\n\n\t\tthis.nCachedObjects_ = nCachedObjects;\n\n\t}\n\n\tremove() {\n\n\t\tconst objects = this._objects,\n\t\t\tindicesByUUID = this._indicesByUUID,\n\t\t\tbindings = this._bindings,\n\t\t\tnBindings = bindings.length;\n\n\t\tlet nCachedObjects = this.nCachedObjects_;\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tconst object = arguments[ i ],\n\t\t\t\tuuid = object.uuid,\n\t\t\t\tindex = indicesByUUID[ uuid ];\n\n\t\t\tif ( index !== undefined && index >= nCachedObjects ) {\n\n\t\t\t\t// move existing object into the CACHED region\n\n\t\t\t\tconst lastCachedIndex = nCachedObjects ++,\n\t\t\t\t\tfirstActiveObject = objects[ lastCachedIndex ];\n\n\t\t\t\tindicesByUUID[ firstActiveObject.uuid ] = index;\n\t\t\t\tobjects[ index ] = firstActiveObject;\n\n\t\t\t\tindicesByUUID[ uuid ] = lastCachedIndex;\n\t\t\t\tobjects[ lastCachedIndex ] = object;\n\n\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\tconst bindingsForPath = bindings[ j ],\n\t\t\t\t\t\tfirstActive = bindingsForPath[ lastCachedIndex ],\n\t\t\t\t\t\tbinding = bindingsForPath[ index ];\n\n\t\t\t\t\tbindingsForPath[ index ] = firstActive;\n\t\t\t\t\tbindingsForPath[ lastCachedIndex ] = binding;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} // for arguments\n\n\t\tthis.nCachedObjects_ = nCachedObjects;\n\n\t}\n\n\t// remove & forget\n\tuncache() {\n\n\t\tconst objects = this._objects,\n\t\t\tindicesByUUID = this._indicesByUUID,\n\t\t\tbindings = this._bindings,\n\t\t\tnBindings = bindings.length;\n\n\t\tlet nCachedObjects = this.nCachedObjects_,\n\t\t\tnObjects = objects.length;\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tconst object = arguments[ i ],\n\t\t\t\tuuid = object.uuid,\n\t\t\t\tindex = indicesByUUID[ uuid ];\n\n\t\t\tif ( index !== undefined ) {\n\n\t\t\t\tdelete indicesByUUID[ uuid ];\n\n\t\t\t\tif ( index < nCachedObjects ) {\n\n\t\t\t\t\t// object is cached, shrink the CACHED region\n\n\t\t\t\t\tconst firstActiveIndex = -- nCachedObjects,\n\t\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ],\n\t\t\t\t\t\tlastIndex = -- nObjects,\n\t\t\t\t\t\tlastObject = objects[ lastIndex ];\n\n\t\t\t\t\t// last cached object takes this object's place\n\t\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\n\t\t\t\t\tobjects[ index ] = lastCachedObject;\n\n\t\t\t\t\t// last object goes to the activated slot and pop\n\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = firstActiveIndex;\n\t\t\t\t\tobjects[ firstActiveIndex ] = lastObject;\n\t\t\t\t\tobjects.pop();\n\n\t\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\t\tconst bindingsForPath = bindings[ j ],\n\t\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ],\n\t\t\t\t\t\t\tlast = bindingsForPath[ lastIndex ];\n\n\t\t\t\t\t\tbindingsForPath[ index ] = lastCached;\n\t\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = last;\n\t\t\t\t\t\tbindingsForPath.pop();\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// object is active, just swap with the last and pop\n\n\t\t\t\t\tconst lastIndex = -- nObjects,\n\t\t\t\t\t\tlastObject = objects[ lastIndex ];\n\n\t\t\t\t\tif ( lastIndex > 0 ) {\n\n\t\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = index;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tobjects[ index ] = lastObject;\n\t\t\t\t\tobjects.pop();\n\n\t\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\t\tconst bindingsForPath = bindings[ j ];\n\n\t\t\t\t\t\tbindingsForPath[ index ] = bindingsForPath[ lastIndex ];\n\t\t\t\t\t\tbindingsForPath.pop();\n\n\t\t\t\t\t}\n\n\t\t\t\t} // cached or active\n\n\t\t\t} // if object is known\n\n\t\t} // for arguments\n\n\t\tthis.nCachedObjects_ = nCachedObjects;\n\n\t}\n\n\t// Internal interface used by befriended PropertyBinding.Composite:\n\n\tsubscribe_( path, parsedPath ) {\n\n\t\t// returns an array of bindings for the given path that is changed\n\t\t// according to the contained objects in the group\n\n\t\tconst indicesByPath = this._bindingsIndicesByPath;\n\t\tlet index = indicesByPath[ path ];\n\t\tconst bindings = this._bindings;\n\n\t\tif ( index !== undefined ) return bindings[ index ];\n\n\t\tconst paths = this._paths,\n\t\t\tparsedPaths = this._parsedPaths,\n\t\t\tobjects = this._objects,\n\t\t\tnObjects = objects.length,\n\t\t\tnCachedObjects = this.nCachedObjects_,\n\t\t\tbindingsForPath = new Array( nObjects );\n\n\t\tindex = bindings.length;\n\n\t\tindicesByPath[ path ] = index;\n\n\t\tpaths.push( path );\n\t\tparsedPaths.push( parsedPath );\n\t\tbindings.push( bindingsForPath );\n\n\t\tfor ( let i = nCachedObjects, n = objects.length; i !== n; ++ i ) {\n\n\t\t\tconst object = objects[ i ];\n\t\t\tbindingsForPath[ i ] = new PropertyBinding( object, path, parsedPath );\n\n\t\t}\n\n\t\treturn bindingsForPath;\n\n\t}\n\n\tunsubscribe_( path ) {\n\n\t\t// tells the group to forget about a property path and no longer\n\t\t// update the array previously obtained with 'subscribe_'\n\n\t\tconst indicesByPath = this._bindingsIndicesByPath,\n\t\t\tindex = indicesByPath[ path ];\n\n\t\tif ( index !== undefined ) {\n\n\t\t\tconst paths = this._paths,\n\t\t\t\tparsedPaths = this._parsedPaths,\n\t\t\t\tbindings = this._bindings,\n\t\t\t\tlastBindingsIndex = bindings.length - 1,\n\t\t\t\tlastBindings = bindings[ lastBindingsIndex ],\n\t\t\t\tlastBindingsPath = path[ lastBindingsIndex ];\n\n\t\t\tindicesByPath[ lastBindingsPath ] = index;\n\n\t\t\tbindings[ index ] = lastBindings;\n\t\t\tbindings.pop();\n\n\t\t\tparsedPaths[ index ] = parsedPaths[ lastBindingsIndex ];\n\t\t\tparsedPaths.pop();\n\n\t\t\tpaths[ index ] = paths[ lastBindingsIndex ];\n\t\t\tpaths.pop();\n\n\t\t}\n\n\t}\n\n}\n\nclass AnimationAction {\n\n\tconstructor( mixer, clip, localRoot = null, blendMode = clip.blendMode ) {\n\n\t\tthis._mixer = mixer;\n\t\tthis._clip = clip;\n\t\tthis._localRoot = localRoot;\n\t\tthis.blendMode = blendMode;\n\n\t\tconst tracks = clip.tracks,\n\t\t\tnTracks = tracks.length,\n\t\t\tinterpolants = new Array( nTracks );\n\n\t\tconst interpolantSettings = {\n\t\t\tendingStart: ZeroCurvatureEnding,\n\t\t\tendingEnd: ZeroCurvatureEnding\n\t\t};\n\n\t\tfor ( let i = 0; i !== nTracks; ++ i ) {\n\n\t\t\tconst interpolant = tracks[ i ].createInterpolant( null );\n\t\t\tinterpolants[ i ] = interpolant;\n\t\t\tinterpolant.settings = interpolantSettings;\n\n\t\t}\n\n\t\tthis._interpolantSettings = interpolantSettings;\n\n\t\tthis._interpolants = interpolants; // bound by the mixer\n\n\t\t// inside: PropertyMixer (managed by the mixer)\n\t\tthis._propertyBindings = new Array( nTracks );\n\n\t\tthis._cacheIndex = null; // for the memory manager\n\t\tthis._byClipCacheIndex = null; // for the memory manager\n\n\t\tthis._timeScaleInterpolant = null;\n\t\tthis._weightInterpolant = null;\n\n\t\tthis.loop = LoopRepeat;\n\t\tthis._loopCount = - 1;\n\n\t\t// global mixer time when the action is to be started\n\t\t// it's set back to 'null' upon start of the action\n\t\tthis._startTime = null;\n\n\t\t// scaled local time of the action\n\t\t// gets clamped or wrapped to 0..clip.duration according to loop\n\t\tthis.time = 0;\n\n\t\tthis.timeScale = 1;\n\t\tthis._effectiveTimeScale = 1;\n\n\t\tthis.weight = 1;\n\t\tthis._effectiveWeight = 1;\n\n\t\tthis.repetitions = Infinity; // no. of repetitions when looping\n\n\t\tthis.paused = false; // true -> zero effective time scale\n\t\tthis.enabled = true; // false -> zero effective weight\n\n\t\tthis.clampWhenFinished = false;// keep feeding the last frame?\n\n\t\tthis.zeroSlopeAtStart = true;// for smooth interpolation w/o separate\n\t\tthis.zeroSlopeAtEnd = true;// clips for start, loop and end\n\n\t}\n\n\t// State & Scheduling\n\n\tplay() {\n\n\t\tthis._mixer._activateAction( this );\n\n\t\treturn this;\n\n\t}\n\n\tstop() {\n\n\t\tthis._mixer._deactivateAction( this );\n\n\t\treturn this.reset();\n\n\t}\n\n\treset() {\n\n\t\tthis.paused = false;\n\t\tthis.enabled = true;\n\n\t\tthis.time = 0; // restart clip\n\t\tthis._loopCount = - 1;// forget previous loops\n\t\tthis._startTime = null;// forget scheduling\n\n\t\treturn this.stopFading().stopWarping();\n\n\t}\n\n\tisRunning() {\n\n\t\treturn this.enabled && ! this.paused && this.timeScale !== 0 &&\n\t\t\tthis._startTime === null && this._mixer._isActiveAction( this );\n\n\t}\n\n\t// return true when play has been called\n\tisScheduled() {\n\n\t\treturn this._mixer._isActiveAction( this );\n\n\t}\n\n\tstartAt( time ) {\n\n\t\tthis._startTime = time;\n\n\t\treturn this;\n\n\t}\n\n\tsetLoop( mode, repetitions ) {\n\n\t\tthis.loop = mode;\n\t\tthis.repetitions = repetitions;\n\n\t\treturn this;\n\n\t}\n\n\t// Weight\n\n\t// set the weight stopping any scheduled fading\n\t// although .enabled = false yields an effective weight of zero, this\n\t// method does *not* change .enabled, because it would be confusing\n\tsetEffectiveWeight( weight ) {\n\n\t\tthis.weight = weight;\n\n\t\t// note: same logic as when updated at runtime\n\t\tthis._effectiveWeight = this.enabled ? weight : 0;\n\n\t\treturn this.stopFading();\n\n\t}\n\n\t// return the weight considering fading and .enabled\n\tgetEffectiveWeight() {\n\n\t\treturn this._effectiveWeight;\n\n\t}\n\n\tfadeIn( duration ) {\n\n\t\treturn this._scheduleFading( duration, 0, 1 );\n\n\t}\n\n\tfadeOut( duration ) {\n\n\t\treturn this._scheduleFading( duration, 1, 0 );\n\n\t}\n\n\tcrossFadeFrom( fadeOutAction, duration, warp ) {\n\n\t\tfadeOutAction.fadeOut( duration );\n\t\tthis.fadeIn( duration );\n\n\t\tif ( warp ) {\n\n\t\t\tconst fadeInDuration = this._clip.duration,\n\t\t\t\tfadeOutDuration = fadeOutAction._clip.duration,\n\n\t\t\t\tstartEndRatio = fadeOutDuration / fadeInDuration,\n\t\t\t\tendStartRatio = fadeInDuration / fadeOutDuration;\n\n\t\t\tfadeOutAction.warp( 1.0, startEndRatio, duration );\n\t\t\tthis.warp( endStartRatio, 1.0, duration );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcrossFadeTo( fadeInAction, duration, warp ) {\n\n\t\treturn fadeInAction.crossFadeFrom( this, duration, warp );\n\n\t}\n\n\tstopFading() {\n\n\t\tconst weightInterpolant = this._weightInterpolant;\n\n\t\tif ( weightInterpolant !== null ) {\n\n\t\t\tthis._weightInterpolant = null;\n\t\t\tthis._mixer._takeBackControlInterpolant( weightInterpolant );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Time Scale Control\n\n\t// set the time scale stopping any scheduled warping\n\t// although .paused = true yields an effective time scale of zero, this\n\t// method does *not* change .paused, because it would be confusing\n\tsetEffectiveTimeScale( timeScale ) {\n\n\t\tthis.timeScale = timeScale;\n\t\tthis._effectiveTimeScale = this.paused ? 0 : timeScale;\n\n\t\treturn this.stopWarping();\n\n\t}\n\n\t// return the time scale considering warping and .paused\n\tgetEffectiveTimeScale() {\n\n\t\treturn this._effectiveTimeScale;\n\n\t}\n\n\tsetDuration( duration ) {\n\n\t\tthis.timeScale = this._clip.duration / duration;\n\n\t\treturn this.stopWarping();\n\n\t}\n\n\tsyncWith( action ) {\n\n\t\tthis.time = action.time;\n\t\tthis.timeScale = action.timeScale;\n\n\t\treturn this.stopWarping();\n\n\t}\n\n\thalt( duration ) {\n\n\t\treturn this.warp( this._effectiveTimeScale, 0, duration );\n\n\t}\n\n\twarp( startTimeScale, endTimeScale, duration ) {\n\n\t\tconst mixer = this._mixer,\n\t\t\tnow = mixer.time,\n\t\t\ttimeScale = this.timeScale;\n\n\t\tlet interpolant = this._timeScaleInterpolant;\n\n\t\tif ( interpolant === null ) {\n\n\t\t\tinterpolant = mixer._lendControlInterpolant();\n\t\t\tthis._timeScaleInterpolant = interpolant;\n\n\t\t}\n\n\t\tconst times = interpolant.parameterPositions,\n\t\t\tvalues = interpolant.sampleValues;\n\n\t\ttimes[ 0 ] = now;\n\t\ttimes[ 1 ] = now + duration;\n\n\t\tvalues[ 0 ] = startTimeScale / timeScale;\n\t\tvalues[ 1 ] = endTimeScale / timeScale;\n\n\t\treturn this;\n\n\t}\n\n\tstopWarping() {\n\n\t\tconst timeScaleInterpolant = this._timeScaleInterpolant;\n\n\t\tif ( timeScaleInterpolant !== null ) {\n\n\t\t\tthis._timeScaleInterpolant = null;\n\t\t\tthis._mixer._takeBackControlInterpolant( timeScaleInterpolant );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Object Accessors\n\n\tgetMixer() {\n\n\t\treturn this._mixer;\n\n\t}\n\n\tgetClip() {\n\n\t\treturn this._clip;\n\n\t}\n\n\tgetRoot() {\n\n\t\treturn this._localRoot || this._mixer._root;\n\n\t}\n\n\t// Interna\n\n\t_update( time, deltaTime, timeDirection, accuIndex ) {\n\n\t\t// called by the mixer\n\n\t\tif ( ! this.enabled ) {\n\n\t\t\t// call ._updateWeight() to update ._effectiveWeight\n\n\t\t\tthis._updateWeight( time );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst startTime = this._startTime;\n\n\t\tif ( startTime !== null ) {\n\n\t\t\t// check for scheduled start of action\n\n\t\t\tconst timeRunning = ( time - startTime ) * timeDirection;\n\t\t\tif ( timeRunning < 0 || timeDirection === 0 ) {\n\n\t\t\t\tdeltaTime = 0;\n\n\t\t\t} else {\n\n\n\t\t\t\tthis._startTime = null; // unschedule\n\t\t\t\tdeltaTime = timeDirection * timeRunning;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// apply time scale and advance time\n\n\t\tdeltaTime *= this._updateTimeScale( time );\n\t\tconst clipTime = this._updateTime( deltaTime );\n\n\t\t// note: _updateTime may disable the action resulting in\n\t\t// an effective weight of 0\n\n\t\tconst weight = this._updateWeight( time );\n\n\t\tif ( weight > 0 ) {\n\n\t\t\tconst interpolants = this._interpolants;\n\t\t\tconst propertyMixers = this._propertyBindings;\n\n\t\t\tswitch ( this.blendMode ) {\n\n\t\t\t\tcase AdditiveAnimationBlendMode:\n\n\t\t\t\t\tfor ( let j = 0, m = interpolants.length; j !== m; ++ j ) {\n\n\t\t\t\t\t\tinterpolants[ j ].evaluate( clipTime );\n\t\t\t\t\t\tpropertyMixers[ j ].accumulateAdditive( weight );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase NormalAnimationBlendMode:\n\t\t\t\tdefault:\n\n\t\t\t\t\tfor ( let j = 0, m = interpolants.length; j !== m; ++ j ) {\n\n\t\t\t\t\t\tinterpolants[ j ].evaluate( clipTime );\n\t\t\t\t\t\tpropertyMixers[ j ].accumulate( accuIndex, weight );\n\n\t\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_updateWeight( time ) {\n\n\t\tlet weight = 0;\n\n\t\tif ( this.enabled ) {\n\n\t\t\tweight = this.weight;\n\t\t\tconst interpolant = this._weightInterpolant;\n\n\t\t\tif ( interpolant !== null ) {\n\n\t\t\t\tconst interpolantValue = interpolant.evaluate( time )[ 0 ];\n\n\t\t\t\tweight *= interpolantValue;\n\n\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\n\n\t\t\t\t\tthis.stopFading();\n\n\t\t\t\t\tif ( interpolantValue === 0 ) {\n\n\t\t\t\t\t\t// faded out, disable\n\t\t\t\t\t\tthis.enabled = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis._effectiveWeight = weight;\n\t\treturn weight;\n\n\t}\n\n\t_updateTimeScale( time ) {\n\n\t\tlet timeScale = 0;\n\n\t\tif ( ! this.paused ) {\n\n\t\t\ttimeScale = this.timeScale;\n\n\t\t\tconst interpolant = this._timeScaleInterpolant;\n\n\t\t\tif ( interpolant !== null ) {\n\n\t\t\t\tconst interpolantValue = interpolant.evaluate( time )[ 0 ];\n\n\t\t\t\ttimeScale *= interpolantValue;\n\n\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\n\n\t\t\t\t\tthis.stopWarping();\n\n\t\t\t\t\tif ( timeScale === 0 ) {\n\n\t\t\t\t\t\t// motion has halted, pause\n\t\t\t\t\t\tthis.paused = true;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// warp done - apply final time scale\n\t\t\t\t\t\tthis.timeScale = timeScale;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis._effectiveTimeScale = timeScale;\n\t\treturn timeScale;\n\n\t}\n\n\t_updateTime( deltaTime ) {\n\n\t\tconst duration = this._clip.duration;\n\t\tconst loop = this.loop;\n\n\t\tlet time = this.time + deltaTime;\n\t\tlet loopCount = this._loopCount;\n\n\t\tconst pingPong = ( loop === LoopPingPong );\n\n\t\tif ( deltaTime === 0 ) {\n\n\t\t\tif ( loopCount === - 1 ) return time;\n\n\t\t\treturn ( pingPong && ( loopCount & 1 ) === 1 ) ? duration - time : time;\n\n\t\t}\n\n\t\tif ( loop === LoopOnce ) {\n\n\t\t\tif ( loopCount === - 1 ) {\n\n\t\t\t\t// just started\n\n\t\t\t\tthis._loopCount = 0;\n\t\t\t\tthis._setEndings( true, true, false );\n\n\t\t\t}\n\n\t\t\thandle_stop: {\n\n\t\t\t\tif ( time >= duration ) {\n\n\t\t\t\t\ttime = duration;\n\n\t\t\t\t} else if ( time < 0 ) {\n\n\t\t\t\t\ttime = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.time = time;\n\n\t\t\t\t\tbreak handle_stop;\n\n\t\t\t\t}\n\n\t\t\t\tif ( this.clampWhenFinished ) this.paused = true;\n\t\t\t\telse this.enabled = false;\n\n\t\t\t\tthis.time = time;\n\n\t\t\t\tthis._mixer.dispatchEvent( {\n\t\t\t\t\ttype: 'finished', action: this,\n\t\t\t\t\tdirection: deltaTime < 0 ? - 1 : 1\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t} else { // repetitive Repeat or PingPong\n\n\t\t\tif ( loopCount === - 1 ) {\n\n\t\t\t\t// just started\n\n\t\t\t\tif ( deltaTime >= 0 ) {\n\n\t\t\t\t\tloopCount = 0;\n\n\t\t\t\t\tthis._setEndings( true, this.repetitions === 0, pingPong );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// when looping in reverse direction, the initial\n\t\t\t\t\t// transition through zero counts as a repetition,\n\t\t\t\t\t// so leave loopCount at -1\n\n\t\t\t\t\tthis._setEndings( this.repetitions === 0, true, pingPong );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( time >= duration || time < 0 ) {\n\n\t\t\t\t// wrap around\n\n\t\t\t\tconst loopDelta = Math.floor( time / duration ); // signed\n\t\t\t\ttime -= duration * loopDelta;\n\n\t\t\t\tloopCount += Math.abs( loopDelta );\n\n\t\t\t\tconst pending = this.repetitions - loopCount;\n\n\t\t\t\tif ( pending <= 0 ) {\n\n\t\t\t\t\t// have to stop (switch state, clamp time, fire event)\n\n\t\t\t\t\tif ( this.clampWhenFinished ) this.paused = true;\n\t\t\t\t\telse this.enabled = false;\n\n\t\t\t\t\ttime = deltaTime > 0 ? duration : 0;\n\n\t\t\t\t\tthis.time = time;\n\n\t\t\t\t\tthis._mixer.dispatchEvent( {\n\t\t\t\t\t\ttype: 'finished', action: this,\n\t\t\t\t\t\tdirection: deltaTime > 0 ? 1 : - 1\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// keep running\n\n\t\t\t\t\tif ( pending === 1 ) {\n\n\t\t\t\t\t\t// entering the last round\n\n\t\t\t\t\t\tconst atStart = deltaTime < 0;\n\t\t\t\t\t\tthis._setEndings( atStart, ! atStart, pingPong );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthis._setEndings( false, false, pingPong );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._loopCount = loopCount;\n\n\t\t\t\t\tthis.time = time;\n\n\t\t\t\t\tthis._mixer.dispatchEvent( {\n\t\t\t\t\t\ttype: 'loop', action: this, loopDelta: loopDelta\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tthis.time = time;\n\n\t\t\t}\n\n\t\t\tif ( pingPong && ( loopCount & 1 ) === 1 ) {\n\n\t\t\t\t// invert time for the \"pong round\"\n\n\t\t\t\treturn duration - time;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn time;\n\n\t}\n\n\t_setEndings( atStart, atEnd, pingPong ) {\n\n\t\tconst settings = this._interpolantSettings;\n\n\t\tif ( pingPong ) {\n\n\t\t\tsettings.endingStart = ZeroSlopeEnding;\n\t\t\tsettings.endingEnd = ZeroSlopeEnding;\n\n\t\t} else {\n\n\t\t\t// assuming for LoopOnce atStart == atEnd == true\n\n\t\t\tif ( atStart ) {\n\n\t\t\t\tsettings.endingStart = this.zeroSlopeAtStart ? ZeroSlopeEnding : ZeroCurvatureEnding;\n\n\t\t\t} else {\n\n\t\t\t\tsettings.endingStart = WrapAroundEnding;\n\n\t\t\t}\n\n\t\t\tif ( atEnd ) {\n\n\t\t\t\tsettings.endingEnd = this.zeroSlopeAtEnd ? ZeroSlopeEnding : ZeroCurvatureEnding;\n\n\t\t\t} else {\n\n\t\t\t\tsettings.endingEnd \t = WrapAroundEnding;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_scheduleFading( duration, weightNow, weightThen ) {\n\n\t\tconst mixer = this._mixer, now = mixer.time;\n\t\tlet interpolant = this._weightInterpolant;\n\n\t\tif ( interpolant === null ) {\n\n\t\t\tinterpolant = mixer._lendControlInterpolant();\n\t\t\tthis._weightInterpolant = interpolant;\n\n\t\t}\n\n\t\tconst times = interpolant.parameterPositions,\n\t\t\tvalues = interpolant.sampleValues;\n\n\t\ttimes[ 0 ] = now;\n\t\tvalues[ 0 ] = weightNow;\n\t\ttimes[ 1 ] = now + duration;\n\t\tvalues[ 1 ] = weightThen;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _controlInterpolantsResultBuffer = new Float32Array( 1 );\n\n\nclass AnimationMixer extends EventDispatcher {\n\n\tconstructor( root ) {\n\n\t\tsuper();\n\n\t\tthis._root = root;\n\t\tthis._initMemoryManager();\n\t\tthis._accuIndex = 0;\n\t\tthis.time = 0;\n\t\tthis.timeScale = 1.0;\n\n\t}\n\n\t_bindAction( action, prototypeAction ) {\n\n\t\tconst root = action._localRoot || this._root,\n\t\t\ttracks = action._clip.tracks,\n\t\t\tnTracks = tracks.length,\n\t\t\tbindings = action._propertyBindings,\n\t\t\tinterpolants = action._interpolants,\n\t\t\trootUuid = root.uuid,\n\t\t\tbindingsByRoot = this._bindingsByRootAndName;\n\n\t\tlet bindingsByName = bindingsByRoot[ rootUuid ];\n\n\t\tif ( bindingsByName === undefined ) {\n\n\t\t\tbindingsByName = {};\n\t\t\tbindingsByRoot[ rootUuid ] = bindingsByName;\n\n\t\t}\n\n\t\tfor ( let i = 0; i !== nTracks; ++ i ) {\n\n\t\t\tconst track = tracks[ i ],\n\t\t\t\ttrackName = track.name;\n\n\t\t\tlet binding = bindingsByName[ trackName ];\n\n\t\t\tif ( binding !== undefined ) {\n\n\t\t\t\t++ binding.referenceCount;\n\t\t\t\tbindings[ i ] = binding;\n\n\t\t\t} else {\n\n\t\t\t\tbinding = bindings[ i ];\n\n\t\t\t\tif ( binding !== undefined ) {\n\n\t\t\t\t\t// existing binding, make sure the cache knows\n\n\t\t\t\t\tif ( binding._cacheIndex === null ) {\n\n\t\t\t\t\t\t++ binding.referenceCount;\n\t\t\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\tconst path = prototypeAction && prototypeAction.\n\t\t\t\t\t_propertyBindings[ i ].binding.parsedPath;\n\n\t\t\t\tbinding = new PropertyMixer(\n\t\t\t\t\tPropertyBinding.create( root, trackName, path ),\n\t\t\t\t\ttrack.ValueTypeName, track.getValueSize() );\n\n\t\t\t\t++ binding.referenceCount;\n\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\n\n\t\t\t\tbindings[ i ] = binding;\n\n\t\t\t}\n\n\t\t\tinterpolants[ i ].resultBuffer = binding.buffer;\n\n\t\t}\n\n\t}\n\n\t_activateAction( action ) {\n\n\t\tif ( ! this._isActiveAction( action ) ) {\n\n\t\t\tif ( action._cacheIndex === null ) {\n\n\t\t\t\t// this action has been forgotten by the cache, but the user\n\t\t\t\t// appears to be still using it -> rebind\n\n\t\t\t\tconst rootUuid = ( action._localRoot || this._root ).uuid,\n\t\t\t\t\tclipUuid = action._clip.uuid,\n\t\t\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\n\n\t\t\t\tthis._bindAction( action,\n\t\t\t\t\tactionsForClip && actionsForClip.knownActions[ 0 ] );\n\n\t\t\t\tthis._addInactiveAction( action, clipUuid, rootUuid );\n\n\t\t\t}\n\n\t\t\tconst bindings = action._propertyBindings;\n\n\t\t\t// increment reference counts / sort out state\n\t\t\tfor ( let i = 0, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\t\tconst binding = bindings[ i ];\n\n\t\t\t\tif ( binding.useCount ++ === 0 ) {\n\n\t\t\t\t\tthis._lendBinding( binding );\n\t\t\t\t\tbinding.saveOriginalState();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._lendAction( action );\n\n\t\t}\n\n\t}\n\n\t_deactivateAction( action ) {\n\n\t\tif ( this._isActiveAction( action ) ) {\n\n\t\t\tconst bindings = action._propertyBindings;\n\n\t\t\t// decrement reference counts / sort out state\n\t\t\tfor ( let i = 0, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\t\tconst binding = bindings[ i ];\n\n\t\t\t\tif ( -- binding.useCount === 0 ) {\n\n\t\t\t\t\tbinding.restoreOriginalState();\n\t\t\t\t\tthis._takeBackBinding( binding );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._takeBackAction( action );\n\n\t\t}\n\n\t}\n\n\t// Memory manager\n\n\t_initMemoryManager() {\n\n\t\tthis._actions = []; // 'nActiveActions' followed by inactive ones\n\t\tthis._nActiveActions = 0;\n\n\t\tthis._actionsByClip = {};\n\t\t// inside:\n\t\t// {\n\t\t// \tknownActions: Array< AnimationAction > - used as prototypes\n\t\t// \tactionByRoot: AnimationAction - lookup\n\t\t// }\n\n\n\t\tthis._bindings = []; // 'nActiveBindings' followed by inactive ones\n\t\tthis._nActiveBindings = 0;\n\n\t\tthis._bindingsByRootAndName = {}; // inside: Map< name, PropertyMixer >\n\n\n\t\tthis._controlInterpolants = []; // same game as above\n\t\tthis._nActiveControlInterpolants = 0;\n\n\t\tconst scope = this;\n\n\t\tthis.stats = {\n\n\t\t\tactions: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._actions.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn scope._nActiveActions;\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tbindings: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._bindings.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn scope._nActiveBindings;\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tcontrolInterpolants: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._controlInterpolants.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn scope._nActiveControlInterpolants;\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t// Memory management for AnimationAction objects\n\n\t_isActiveAction( action ) {\n\n\t\tconst index = action._cacheIndex;\n\t\treturn index !== null && index < this._nActiveActions;\n\n\t}\n\n\t_addInactiveAction( action, clipUuid, rootUuid ) {\n\n\t\tconst actions = this._actions,\n\t\t\tactionsByClip = this._actionsByClip;\n\n\t\tlet actionsForClip = actionsByClip[ clipUuid ];\n\n\t\tif ( actionsForClip === undefined ) {\n\n\t\t\tactionsForClip = {\n\n\t\t\t\tknownActions: [ action ],\n\t\t\t\tactionByRoot: {}\n\n\t\t\t};\n\n\t\t\taction._byClipCacheIndex = 0;\n\n\t\t\tactionsByClip[ clipUuid ] = actionsForClip;\n\n\t\t} else {\n\n\t\t\tconst knownActions = actionsForClip.knownActions;\n\n\t\t\taction._byClipCacheIndex = knownActions.length;\n\t\t\tknownActions.push( action );\n\n\t\t}\n\n\t\taction._cacheIndex = actions.length;\n\t\tactions.push( action );\n\n\t\tactionsForClip.actionByRoot[ rootUuid ] = action;\n\n\t}\n\n\t_removeInactiveAction( action ) {\n\n\t\tconst actions = this._actions,\n\t\t\tlastInactiveAction = actions[ actions.length - 1 ],\n\t\t\tcacheIndex = action._cacheIndex;\n\n\t\tlastInactiveAction._cacheIndex = cacheIndex;\n\t\tactions[ cacheIndex ] = lastInactiveAction;\n\t\tactions.pop();\n\n\t\taction._cacheIndex = null;\n\n\n\t\tconst clipUuid = action._clip.uuid,\n\t\t\tactionsByClip = this._actionsByClip,\n\t\t\tactionsForClip = actionsByClip[ clipUuid ],\n\t\t\tknownActionsForClip = actionsForClip.knownActions,\n\n\t\t\tlastKnownAction =\n\t\t\t\tknownActionsForClip[ knownActionsForClip.length - 1 ],\n\n\t\t\tbyClipCacheIndex = action._byClipCacheIndex;\n\n\t\tlastKnownAction._byClipCacheIndex = byClipCacheIndex;\n\t\tknownActionsForClip[ byClipCacheIndex ] = lastKnownAction;\n\t\tknownActionsForClip.pop();\n\n\t\taction._byClipCacheIndex = null;\n\n\n\t\tconst actionByRoot = actionsForClip.actionByRoot,\n\t\t\trootUuid = ( action._localRoot || this._root ).uuid;\n\n\t\tdelete actionByRoot[ rootUuid ];\n\n\t\tif ( knownActionsForClip.length === 0 ) {\n\n\t\t\tdelete actionsByClip[ clipUuid ];\n\n\t\t}\n\n\t\tthis._removeInactiveBindingsForAction( action );\n\n\t}\n\n\t_removeInactiveBindingsForAction( action ) {\n\n\t\tconst bindings = action._propertyBindings;\n\n\t\tfor ( let i = 0, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tconst binding = bindings[ i ];\n\n\t\t\tif ( -- binding.referenceCount === 0 ) {\n\n\t\t\t\tthis._removeInactiveBinding( binding );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_lendAction( action ) {\n\n\t\t// [ active actions |  inactive actions  ]\n\t\t// [  active actions >| inactive actions ]\n\t\t//                 s        a\n\t\t//                  <-swap->\n\t\t//                 a        s\n\n\t\tconst actions = this._actions,\n\t\t\tprevIndex = action._cacheIndex,\n\n\t\t\tlastActiveIndex = this._nActiveActions ++,\n\n\t\t\tfirstInactiveAction = actions[ lastActiveIndex ];\n\n\t\taction._cacheIndex = lastActiveIndex;\n\t\tactions[ lastActiveIndex ] = action;\n\n\t\tfirstInactiveAction._cacheIndex = prevIndex;\n\t\tactions[ prevIndex ] = firstInactiveAction;\n\n\t}\n\n\t_takeBackAction( action ) {\n\n\t\t// [  active actions  | inactive actions ]\n\t\t// [ active actions |< inactive actions  ]\n\t\t//        a        s\n\t\t//         <-swap->\n\t\t//        s        a\n\n\t\tconst actions = this._actions,\n\t\t\tprevIndex = action._cacheIndex,\n\n\t\t\tfirstInactiveIndex = -- this._nActiveActions,\n\n\t\t\tlastActiveAction = actions[ firstInactiveIndex ];\n\n\t\taction._cacheIndex = firstInactiveIndex;\n\t\tactions[ firstInactiveIndex ] = action;\n\n\t\tlastActiveAction._cacheIndex = prevIndex;\n\t\tactions[ prevIndex ] = lastActiveAction;\n\n\t}\n\n\t// Memory management for PropertyMixer objects\n\n\t_addInactiveBinding( binding, rootUuid, trackName ) {\n\n\t\tconst bindingsByRoot = this._bindingsByRootAndName,\n\t\t\tbindings = this._bindings;\n\n\t\tlet bindingByName = bindingsByRoot[ rootUuid ];\n\n\t\tif ( bindingByName === undefined ) {\n\n\t\t\tbindingByName = {};\n\t\t\tbindingsByRoot[ rootUuid ] = bindingByName;\n\n\t\t}\n\n\t\tbindingByName[ trackName ] = binding;\n\n\t\tbinding._cacheIndex = bindings.length;\n\t\tbindings.push( binding );\n\n\t}\n\n\t_removeInactiveBinding( binding ) {\n\n\t\tconst bindings = this._bindings,\n\t\t\tpropBinding = binding.binding,\n\t\t\trootUuid = propBinding.rootNode.uuid,\n\t\t\ttrackName = propBinding.path,\n\t\t\tbindingsByRoot = this._bindingsByRootAndName,\n\t\t\tbindingByName = bindingsByRoot[ rootUuid ],\n\n\t\t\tlastInactiveBinding = bindings[ bindings.length - 1 ],\n\t\t\tcacheIndex = binding._cacheIndex;\n\n\t\tlastInactiveBinding._cacheIndex = cacheIndex;\n\t\tbindings[ cacheIndex ] = lastInactiveBinding;\n\t\tbindings.pop();\n\n\t\tdelete bindingByName[ trackName ];\n\n\t\tif ( Object.keys( bindingByName ).length === 0 ) {\n\n\t\t\tdelete bindingsByRoot[ rootUuid ];\n\n\t\t}\n\n\t}\n\n\t_lendBinding( binding ) {\n\n\t\tconst bindings = this._bindings,\n\t\t\tprevIndex = binding._cacheIndex,\n\n\t\t\tlastActiveIndex = this._nActiveBindings ++,\n\n\t\t\tfirstInactiveBinding = bindings[ lastActiveIndex ];\n\n\t\tbinding._cacheIndex = lastActiveIndex;\n\t\tbindings[ lastActiveIndex ] = binding;\n\n\t\tfirstInactiveBinding._cacheIndex = prevIndex;\n\t\tbindings[ prevIndex ] = firstInactiveBinding;\n\n\t}\n\n\t_takeBackBinding( binding ) {\n\n\t\tconst bindings = this._bindings,\n\t\t\tprevIndex = binding._cacheIndex,\n\n\t\t\tfirstInactiveIndex = -- this._nActiveBindings,\n\n\t\t\tlastActiveBinding = bindings[ firstInactiveIndex ];\n\n\t\tbinding._cacheIndex = firstInactiveIndex;\n\t\tbindings[ firstInactiveIndex ] = binding;\n\n\t\tlastActiveBinding._cacheIndex = prevIndex;\n\t\tbindings[ prevIndex ] = lastActiveBinding;\n\n\t}\n\n\n\t// Memory management of Interpolants for weight and time scale\n\n\t_lendControlInterpolant() {\n\n\t\tconst interpolants = this._controlInterpolants,\n\t\t\tlastActiveIndex = this._nActiveControlInterpolants ++;\n\n\t\tlet interpolant = interpolants[ lastActiveIndex ];\n\n\t\tif ( interpolant === undefined ) {\n\n\t\t\tinterpolant = new LinearInterpolant(\n\t\t\t\tnew Float32Array( 2 ), new Float32Array( 2 ),\n\t\t\t\t1, _controlInterpolantsResultBuffer );\n\n\t\t\tinterpolant.__cacheIndex = lastActiveIndex;\n\t\t\tinterpolants[ lastActiveIndex ] = interpolant;\n\n\t\t}\n\n\t\treturn interpolant;\n\n\t}\n\n\t_takeBackControlInterpolant( interpolant ) {\n\n\t\tconst interpolants = this._controlInterpolants,\n\t\t\tprevIndex = interpolant.__cacheIndex,\n\n\t\t\tfirstInactiveIndex = -- this._nActiveControlInterpolants,\n\n\t\t\tlastActiveInterpolant = interpolants[ firstInactiveIndex ];\n\n\t\tinterpolant.__cacheIndex = firstInactiveIndex;\n\t\tinterpolants[ firstInactiveIndex ] = interpolant;\n\n\t\tlastActiveInterpolant.__cacheIndex = prevIndex;\n\t\tinterpolants[ prevIndex ] = lastActiveInterpolant;\n\n\t}\n\n\t// return an action for a clip optionally using a custom root target\n\t// object (this method allocates a lot of dynamic memory in case a\n\t// previously unknown clip/root combination is specified)\n\tclipAction( clip, optionalRoot, blendMode ) {\n\n\t\tconst root = optionalRoot || this._root,\n\t\t\trootUuid = root.uuid;\n\n\t\tlet clipObject = typeof clip === 'string' ? AnimationClip.findByName( root, clip ) : clip;\n\n\t\tconst clipUuid = clipObject !== null ? clipObject.uuid : clip;\n\n\t\tconst actionsForClip = this._actionsByClip[ clipUuid ];\n\t\tlet prototypeAction = null;\n\n\t\tif ( blendMode === undefined ) {\n\n\t\t\tif ( clipObject !== null ) {\n\n\t\t\t\tblendMode = clipObject.blendMode;\n\n\t\t\t} else {\n\n\t\t\t\tblendMode = NormalAnimationBlendMode;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( actionsForClip !== undefined ) {\n\n\t\t\tconst existingAction = actionsForClip.actionByRoot[ rootUuid ];\n\n\t\t\tif ( existingAction !== undefined && existingAction.blendMode === blendMode ) {\n\n\t\t\t\treturn existingAction;\n\n\t\t\t}\n\n\t\t\t// we know the clip, so we don't have to parse all\n\t\t\t// the bindings again but can just copy\n\t\t\tprototypeAction = actionsForClip.knownActions[ 0 ];\n\n\t\t\t// also, take the clip from the prototype action\n\t\t\tif ( clipObject === null )\n\t\t\t\tclipObject = prototypeAction._clip;\n\n\t\t}\n\n\t\t// clip must be known when specified via string\n\t\tif ( clipObject === null ) return null;\n\n\t\t// allocate all resources required to run it\n\t\tconst newAction = new AnimationAction( this, clipObject, optionalRoot, blendMode );\n\n\t\tthis._bindAction( newAction, prototypeAction );\n\n\t\t// and make the action known to the memory manager\n\t\tthis._addInactiveAction( newAction, clipUuid, rootUuid );\n\n\t\treturn newAction;\n\n\t}\n\n\t// get an existing action\n\texistingAction( clip, optionalRoot ) {\n\n\t\tconst root = optionalRoot || this._root,\n\t\t\trootUuid = root.uuid,\n\n\t\t\tclipObject = typeof clip === 'string' ?\n\t\t\t\tAnimationClip.findByName( root, clip ) : clip,\n\n\t\t\tclipUuid = clipObject ? clipObject.uuid : clip,\n\n\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\n\n\t\tif ( actionsForClip !== undefined ) {\n\n\t\t\treturn actionsForClip.actionByRoot[ rootUuid ] || null;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t// deactivates all previously scheduled actions\n\tstopAllAction() {\n\n\t\tconst actions = this._actions,\n\t\t\tnActions = this._nActiveActions;\n\n\t\tfor ( let i = nActions - 1; i >= 0; -- i ) {\n\n\t\t\tactions[ i ].stop();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// advance the time and update apply the animation\n\tupdate( deltaTime ) {\n\n\t\tdeltaTime *= this.timeScale;\n\n\t\tconst actions = this._actions,\n\t\t\tnActions = this._nActiveActions,\n\n\t\t\ttime = this.time += deltaTime,\n\t\t\ttimeDirection = Math.sign( deltaTime ),\n\n\t\t\taccuIndex = this._accuIndex ^= 1;\n\n\t\t// run active actions\n\n\t\tfor ( let i = 0; i !== nActions; ++ i ) {\n\n\t\t\tconst action = actions[ i ];\n\n\t\t\taction._update( time, deltaTime, timeDirection, accuIndex );\n\n\t\t}\n\n\t\t// update scene graph\n\n\t\tconst bindings = this._bindings,\n\t\t\tnBindings = this._nActiveBindings;\n\n\t\tfor ( let i = 0; i !== nBindings; ++ i ) {\n\n\t\t\tbindings[ i ].apply( accuIndex );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Allows you to seek to a specific time in an animation.\n\tsetTime( timeInSeconds ) {\n\n\t\tthis.time = 0; // Zero out time attribute for AnimationMixer object;\n\t\tfor ( let i = 0; i < this._actions.length; i ++ ) {\n\n\t\t\tthis._actions[ i ].time = 0; // Zero out time attribute for all associated AnimationAction objects.\n\n\t\t}\n\n\t\treturn this.update( timeInSeconds ); // Update used to set exact time. Returns \"this\" AnimationMixer object.\n\n\t}\n\n\t// return this mixer's root target object\n\tgetRoot() {\n\n\t\treturn this._root;\n\n\t}\n\n\t// free all resources specific to a particular clip\n\tuncacheClip( clip ) {\n\n\t\tconst actions = this._actions,\n\t\t\tclipUuid = clip.uuid,\n\t\t\tactionsByClip = this._actionsByClip,\n\t\t\tactionsForClip = actionsByClip[ clipUuid ];\n\n\t\tif ( actionsForClip !== undefined ) {\n\n\t\t\t// note: just calling _removeInactiveAction would mess up the\n\t\t\t// iteration state and also require updating the state we can\n\t\t\t// just throw away\n\n\t\t\tconst actionsToRemove = actionsForClip.knownActions;\n\n\t\t\tfor ( let i = 0, n = actionsToRemove.length; i !== n; ++ i ) {\n\n\t\t\t\tconst action = actionsToRemove[ i ];\n\n\t\t\t\tthis._deactivateAction( action );\n\n\t\t\t\tconst cacheIndex = action._cacheIndex,\n\t\t\t\t\tlastInactiveAction = actions[ actions.length - 1 ];\n\n\t\t\t\taction._cacheIndex = null;\n\t\t\t\taction._byClipCacheIndex = null;\n\n\t\t\t\tlastInactiveAction._cacheIndex = cacheIndex;\n\t\t\t\tactions[ cacheIndex ] = lastInactiveAction;\n\t\t\t\tactions.pop();\n\n\t\t\t\tthis._removeInactiveBindingsForAction( action );\n\n\t\t\t}\n\n\t\t\tdelete actionsByClip[ clipUuid ];\n\n\t\t}\n\n\t}\n\n\t// free all resources specific to a particular root target object\n\tuncacheRoot( root ) {\n\n\t\tconst rootUuid = root.uuid,\n\t\t\tactionsByClip = this._actionsByClip;\n\n\t\tfor ( const clipUuid in actionsByClip ) {\n\n\t\t\tconst actionByRoot = actionsByClip[ clipUuid ].actionByRoot,\n\t\t\t\taction = actionByRoot[ rootUuid ];\n\n\t\t\tif ( action !== undefined ) {\n\n\t\t\t\tthis._deactivateAction( action );\n\t\t\t\tthis._removeInactiveAction( action );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst bindingsByRoot = this._bindingsByRootAndName,\n\t\t\tbindingByName = bindingsByRoot[ rootUuid ];\n\n\t\tif ( bindingByName !== undefined ) {\n\n\t\t\tfor ( const trackName in bindingByName ) {\n\n\t\t\t\tconst binding = bindingByName[ trackName ];\n\t\t\t\tbinding.restoreOriginalState();\n\t\t\t\tthis._removeInactiveBinding( binding );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// remove a targeted clip from the cache\n\tuncacheAction( clip, optionalRoot ) {\n\n\t\tconst action = this.existingAction( clip, optionalRoot );\n\n\t\tif ( action !== null ) {\n\n\t\t\tthis._deactivateAction( action );\n\t\t\tthis._removeInactiveAction( action );\n\n\t\t}\n\n\t}\n\n}\n\nclass Uniform {\n\n\tconstructor( value ) {\n\n\t\tthis.value = value;\n\n\t}\n\n\tclone() {\n\n\t\treturn new Uniform( this.value.clone === undefined ? this.value : this.value.clone() );\n\n\t}\n\n}\n\nlet _id = 0;\n\nclass UniformsGroup extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isUniformsGroup = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _id ++ } );\n\n\t\tthis.name = '';\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.uniforms = [];\n\n\t}\n\n\tadd( uniform ) {\n\n\t\tthis.uniforms.push( uniform );\n\n\t\treturn this;\n\n\t}\n\n\tremove( uniform ) {\n\n\t\tconst index = this.uniforms.indexOf( uniform );\n\n\t\tif ( index !== - 1 ) this.uniforms.splice( index, 1 );\n\n\t\treturn this;\n\n\t}\n\n\tsetName( name ) {\n\n\t\tthis.name = name;\n\n\t\treturn this;\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\t\tthis.usage = source.usage;\n\n\t\tconst uniformsSource = source.uniforms;\n\n\t\tthis.uniforms.length = 0;\n\n\t\tfor ( let i = 0, l = uniformsSource.length; i < l; i ++ ) {\n\n\t\t\tconst uniforms = Array.isArray( uniformsSource[ i ] ) ? uniformsSource[ i ] : [ uniformsSource[ i ] ];\n\n\t\t\tfor ( let j = 0; j < uniforms.length; j ++ ) {\n\n\t\t\t\tthis.uniforms.push( uniforms[ j ].clone() );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nclass InstancedInterleavedBuffer extends InterleavedBuffer {\n\n\tconstructor( array, stride, meshPerAttribute = 1 ) {\n\n\t\tsuper( array, stride );\n\n\t\tthis.isInstancedInterleavedBuffer = true;\n\n\t\tthis.meshPerAttribute = meshPerAttribute;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.meshPerAttribute = source.meshPerAttribute;\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tconst ib = super.clone( data );\n\n\t\tib.meshPerAttribute = this.meshPerAttribute;\n\n\t\treturn ib;\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tconst json = super.toJSON( data );\n\n\t\tjson.isInstancedInterleavedBuffer = true;\n\t\tjson.meshPerAttribute = this.meshPerAttribute;\n\n\t\treturn json;\n\n\t}\n\n}\n\nclass GLBufferAttribute {\n\n\tconstructor( buffer, type, itemSize, elementSize, count ) {\n\n\t\tthis.isGLBufferAttribute = true;\n\n\t\tthis.name = '';\n\n\t\tthis.buffer = buffer;\n\t\tthis.type = type;\n\t\tthis.itemSize = itemSize;\n\t\tthis.elementSize = elementSize;\n\t\tthis.count = count;\n\n\t\tthis.version = 0;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetBuffer( buffer ) {\n\n\t\tthis.buffer = buffer;\n\n\t\treturn this;\n\n\t}\n\n\tsetType( type, elementSize ) {\n\n\t\tthis.type = type;\n\t\tthis.elementSize = elementSize;\n\n\t\treturn this;\n\n\t}\n\n\tsetItemSize( itemSize ) {\n\n\t\tthis.itemSize = itemSize;\n\n\t\treturn this;\n\n\t}\n\n\tsetCount( count ) {\n\n\t\tthis.count = count;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _matrix = /*@__PURE__*/ new Matrix4();\n\nclass Raycaster {\n\n\tconstructor( origin, direction, near = 0, far = Infinity ) {\n\n\t\tthis.ray = new Ray( origin, direction );\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\t\tthis.camera = null;\n\t\tthis.layers = new Layers();\n\n\t\tthis.params = {\n\t\t\tMesh: {},\n\t\t\tLine: { threshold: 1 },\n\t\t\tLOD: {},\n\t\t\tPoints: { threshold: 1 },\n\t\t\tSprite: {}\n\t\t};\n\n\t}\n\n\tset( origin, direction ) {\n\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\n\n\t\tthis.ray.set( origin, direction );\n\n\t}\n\n\tsetFromCamera( coords, camera ) {\n\n\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\tthis.ray.origin.setFromMatrixPosition( camera.matrixWorld );\n\t\t\tthis.ray.direction.set( coords.x, coords.y, 0.5 ).unproject( camera ).sub( this.ray.origin ).normalize();\n\t\t\tthis.camera = camera;\n\n\t\t} else if ( camera.isOrthographicCamera ) {\n\n\t\t\tthis.ray.origin.set( coords.x, coords.y, ( camera.near + camera.far ) / ( camera.near - camera.far ) ).unproject( camera ); // set origin in plane of camera\n\t\t\tthis.ray.direction.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld );\n\t\t\tthis.camera = camera;\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Raycaster: Unsupported camera type: ' + camera.type );\n\n\t\t}\n\n\t}\n\n\tsetFromXRController( controller ) {\n\n\t\t_matrix.identity().extractRotation( controller.matrixWorld );\n\n\t\tthis.ray.origin.setFromMatrixPosition( controller.matrixWorld );\n\t\tthis.ray.direction.set( 0, 0, - 1 ).applyMatrix4( _matrix );\n\n\t\treturn this;\n\n\t}\n\n\tintersectObject( object, recursive = true, intersects = [] ) {\n\n\t\tintersect( object, this, intersects, recursive );\n\n\t\tintersects.sort( ascSort );\n\n\t\treturn intersects;\n\n\t}\n\n\tintersectObjects( objects, recursive = true, intersects = [] ) {\n\n\t\tfor ( let i = 0, l = objects.length; i < l; i ++ ) {\n\n\t\t\tintersect( objects[ i ], this, intersects, recursive );\n\n\t\t}\n\n\t\tintersects.sort( ascSort );\n\n\t\treturn intersects;\n\n\t}\n\n}\n\nfunction ascSort( a, b ) {\n\n\treturn a.distance - b.distance;\n\n}\n\nfunction intersect( object, raycaster, intersects, recursive ) {\n\n\tlet propagate = true;\n\n\tif ( object.layers.test( raycaster.layers ) ) {\n\n\t\tconst result = object.raycast( raycaster, intersects );\n\n\t\tif ( result === false ) propagate = false;\n\n\t}\n\n\tif ( propagate === true && recursive === true ) {\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tintersect( children[ i ], raycaster, intersects, true );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * Ref: https://en.wikipedia.org/wiki/Spherical_coordinate_system\n *\n * phi (the polar angle) is measured from the positive y-axis. The positive y-axis is up.\n * theta (the azimuthal angle) is measured from the positive z-axis.\n */\nclass Spherical {\n\n\tconstructor( radius = 1, phi = 0, theta = 0 ) {\n\n\t\tthis.radius = radius;\n\t\tthis.phi = phi; // polar angle\n\t\tthis.theta = theta; // azimuthal angle\n\n\t\treturn this;\n\n\t}\n\n\tset( radius, phi, theta ) {\n\n\t\tthis.radius = radius;\n\t\tthis.phi = phi;\n\t\tthis.theta = theta;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( other ) {\n\n\t\tthis.radius = other.radius;\n\t\tthis.phi = other.phi;\n\t\tthis.theta = other.theta;\n\n\t\treturn this;\n\n\t}\n\n\t// restrict phi to be between EPS and PI-EPS\n\tmakeSafe() {\n\n\t\tconst EPS = 0.000001;\n\t\tthis.phi = clamp( this.phi, EPS, Math.PI - EPS );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromVector3( v ) {\n\n\t\treturn this.setFromCartesianCoords( v.x, v.y, v.z );\n\n\t}\n\n\tsetFromCartesianCoords( x, y, z ) {\n\n\t\tthis.radius = Math.sqrt( x * x + y * y + z * z );\n\n\t\tif ( this.radius === 0 ) {\n\n\t\t\tthis.theta = 0;\n\t\t\tthis.phi = 0;\n\n\t\t} else {\n\n\t\t\tthis.theta = Math.atan2( x, z );\n\t\t\tthis.phi = Math.acos( clamp( y / this.radius, - 1, 1 ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\n/**\n * Ref: https://en.wikipedia.org/wiki/Cylindrical_coordinate_system\n */\n\nclass Cylindrical {\n\n\tconstructor( radius = 1, theta = 0, y = 0 ) {\n\n\t\tthis.radius = radius; // distance from the origin to a point in the x-z plane\n\t\tthis.theta = theta; // counterclockwise angle in the x-z plane measured in radians from the positive z-axis\n\t\tthis.y = y; // height above the x-z plane\n\n\t\treturn this;\n\n\t}\n\n\tset( radius, theta, y ) {\n\n\t\tthis.radius = radius;\n\t\tthis.theta = theta;\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( other ) {\n\n\t\tthis.radius = other.radius;\n\t\tthis.theta = other.theta;\n\t\tthis.y = other.y;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromVector3( v ) {\n\n\t\treturn this.setFromCartesianCoords( v.x, v.y, v.z );\n\n\t}\n\n\tsetFromCartesianCoords( x, y, z ) {\n\n\t\tthis.radius = Math.sqrt( x * x + z * z );\n\t\tthis.theta = Math.atan2( x, z );\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nclass Matrix2 {\n\n\tconstructor( n11, n12, n21, n22 ) {\n\n\t\tMatrix2.prototype.isMatrix2 = true;\n\n\t\tthis.elements = [\n\t\t\t1, 0,\n\t\t\t0, 1,\n\t\t];\n\n\t\tif ( n11 !== undefined ) {\n\n\t\t\tthis.set( n11, n12, n21, n22 );\n\n\t\t}\n\n\t}\n\n\tidentity() {\n\n\t\tthis.set(\n\t\t\t1, 0,\n\t\t\t0, 1,\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tfor ( let i = 0; i < 4; i ++ ) {\n\n\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tset( n11, n12, n21, n22 ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 2 ] = n12;\n\t\tte[ 1 ] = n21; te[ 3 ] = n22;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _vector$4 = /*@__PURE__*/ new Vector2();\n\nclass Box2 {\n\n\tconstructor( min = new Vector2( + Infinity, + Infinity ), max = new Vector2( - Infinity, - Infinity ) ) {\n\n\t\tthis.isBox2 = true;\n\n\t\tthis.min = min;\n\t\tthis.max = max;\n\n\t}\n\n\tset( min, max ) {\n\n\t\tthis.min.copy( min );\n\t\tthis.max.copy( max );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tthis.expandByPoint( points[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCenterAndSize( center, size ) {\n\n\t\tconst halfSize = _vector$4.copy( size ).multiplyScalar( 0.5 );\n\t\tthis.min.copy( center ).sub( halfSize );\n\t\tthis.max.copy( center ).add( halfSize );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( box ) {\n\n\t\tthis.min.copy( box.min );\n\t\tthis.max.copy( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.min.x = this.min.y = + Infinity;\n\t\tthis.max.x = this.max.y = - Infinity;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y );\n\n\t}\n\n\tgetCenter( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0 ) : target.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\n\n\t}\n\n\tgetSize( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0 ) : target.subVectors( this.max, this.min );\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\tthis.min.min( point );\n\t\tthis.max.max( point );\n\n\t\treturn this;\n\n\t}\n\n\texpandByVector( vector ) {\n\n\t\tthis.min.sub( vector );\n\t\tthis.max.add( vector );\n\n\t\treturn this;\n\n\t}\n\n\texpandByScalar( scalar ) {\n\n\t\tthis.min.addScalar( - scalar );\n\t\tthis.max.addScalar( scalar );\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn point.x >= this.min.x && point.x <= this.max.x &&\n\t\t\tpoint.y >= this.min.y && point.y <= this.max.y;\n\n\t}\n\n\tcontainsBox( box ) {\n\n\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\n\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y;\n\n\t}\n\n\tgetParameter( point, target ) {\n\n\t\t// This can potentially have a divide by zero if the box\n\t\t// has a size dimension of 0.\n\n\t\treturn target.set(\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y )\n\t\t);\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\t// using 4 splitting planes to rule out intersections\n\n\t\treturn box.max.x >= this.min.x && box.min.x <= this.max.x &&\n\t\t\tbox.max.y >= this.min.y && box.min.y <= this.max.y;\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\treturn target.copy( point ).clamp( this.min, this.max );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn this.clampPoint( point, _vector$4 ).distanceTo( point );\n\n\t}\n\n\tintersect( box ) {\n\n\t\tthis.min.max( box.min );\n\t\tthis.max.min( box.max );\n\n\t\tif ( this.isEmpty() ) this.makeEmpty();\n\n\t\treturn this;\n\n\t}\n\n\tunion( box ) {\n\n\t\tthis.min.min( box.min );\n\t\tthis.max.max( box.max );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.min.add( offset );\n\t\tthis.max.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\tequals( box ) {\n\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\n\n\t}\n\n}\n\nconst _startP = /*@__PURE__*/ new Vector3();\nconst _startEnd = /*@__PURE__*/ new Vector3();\n\nclass Line3 {\n\n\tconstructor( start = new Vector3(), end = new Vector3() ) {\n\n\t\tthis.start = start;\n\t\tthis.end = end;\n\n\t}\n\n\tset( start, end ) {\n\n\t\tthis.start.copy( start );\n\t\tthis.end.copy( end );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( line ) {\n\n\t\tthis.start.copy( line.start );\n\t\tthis.end.copy( line.end );\n\n\t\treturn this;\n\n\t}\n\n\tgetCenter( target ) {\n\n\t\treturn target.addVectors( this.start, this.end ).multiplyScalar( 0.5 );\n\n\t}\n\n\tdelta( target ) {\n\n\t\treturn target.subVectors( this.end, this.start );\n\n\t}\n\n\tdistanceSq() {\n\n\t\treturn this.start.distanceToSquared( this.end );\n\n\t}\n\n\tdistance() {\n\n\t\treturn this.start.distanceTo( this.end );\n\n\t}\n\n\tat( t, target ) {\n\n\t\treturn this.delta( target ).multiplyScalar( t ).add( this.start );\n\n\t}\n\n\tclosestPointToPointParameter( point, clampToLine ) {\n\n\t\t_startP.subVectors( point, this.start );\n\t\t_startEnd.subVectors( this.end, this.start );\n\n\t\tconst startEnd2 = _startEnd.dot( _startEnd );\n\t\tconst startEnd_startP = _startEnd.dot( _startP );\n\n\t\tlet t = startEnd_startP / startEnd2;\n\n\t\tif ( clampToLine ) {\n\n\t\t\tt = clamp( t, 0, 1 );\n\n\t\t}\n\n\t\treturn t;\n\n\t}\n\n\tclosestPointToPoint( point, clampToLine, target ) {\n\n\t\tconst t = this.closestPointToPointParameter( point, clampToLine );\n\n\t\treturn this.delta( target ).multiplyScalar( t ).add( this.start );\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tthis.start.applyMatrix4( matrix );\n\t\tthis.end.applyMatrix4( matrix );\n\n\t\treturn this;\n\n\t}\n\n\tequals( line ) {\n\n\t\treturn line.start.equals( this.start ) && line.end.equals( this.end );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nconst _vector$3 = /*@__PURE__*/ new Vector3();\n\nclass SpotLightHelper extends Object3D {\n\n\tconstructor( light, color ) {\n\n\t\tsuper();\n\n\t\tthis.light = light;\n\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.color = color;\n\n\t\tthis.type = 'SpotLightHelper';\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tconst positions = [\n\t\t\t0, 0, 0, \t0, 0, 1,\n\t\t\t0, 0, 0, \t1, 0, 1,\n\t\t\t0, 0, 0,\t- 1, 0, 1,\n\t\t\t0, 0, 0, \t0, 1, 1,\n\t\t\t0, 0, 0, \t0, - 1, 1\n\t\t];\n\n\t\tfor ( let i = 0, j = 1, l = 32; i < l; i ++, j ++ ) {\n\n\t\t\tconst p1 = ( i / l ) * Math.PI * 2;\n\t\t\tconst p2 = ( j / l ) * Math.PI * 2;\n\n\t\t\tpositions.push(\n\t\t\t\tMath.cos( p1 ), Math.sin( p1 ), 1,\n\t\t\t\tMath.cos( p2 ), Math.sin( p2 ), 1\n\t\t\t);\n\n\t\t}\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { fog: false, toneMapped: false } );\n\n\t\tthis.cone = new LineSegments( geometry, material );\n\t\tthis.add( this.cone );\n\n\t\tthis.update();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.cone.geometry.dispose();\n\t\tthis.cone.material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\tthis.light.updateWorldMatrix( true, false );\n\t\tthis.light.target.updateWorldMatrix( true, false );\n\n\t\t// update the local matrix based on the parent and light target transforms\n\t\tif ( this.parent ) {\n\n\t\t\tthis.parent.updateWorldMatrix( true );\n\n\t\t\tthis.matrix\n\t\t\t\t.copy( this.parent.matrixWorld )\n\t\t\t\t.invert()\n\t\t\t\t.multiply( this.light.matrixWorld );\n\n\t\t} else {\n\n\t\t\tthis.matrix.copy( this.light.matrixWorld );\n\n\t\t}\n\n\t\tthis.matrixWorld.copy( this.light.matrixWorld );\n\n\t\tconst coneLength = this.light.distance ? this.light.distance : 1000;\n\t\tconst coneWidth = coneLength * Math.tan( this.light.angle );\n\n\t\tthis.cone.scale.set( coneWidth, coneWidth, coneLength );\n\n\t\t_vector$3.setFromMatrixPosition( this.light.target.matrixWorld );\n\n\t\tthis.cone.lookAt( _vector$3 );\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.cone.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tthis.cone.material.color.copy( this.light.color );\n\n\t\t}\n\n\t}\n\n}\n\nconst _vector$2 = /*@__PURE__*/ new Vector3();\nconst _boneMatrix = /*@__PURE__*/ new Matrix4();\nconst _matrixWorldInv = /*@__PURE__*/ new Matrix4();\n\n\nclass SkeletonHelper extends LineSegments {\n\n\tconstructor( object ) {\n\n\t\tconst bones = getBoneList( object );\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tconst vertices = [];\n\t\tconst colors = [];\n\n\t\tconst color1 = new Color( 0, 0, 1 );\n\t\tconst color2 = new Color( 0, 1, 0 );\n\n\t\tfor ( let i = 0; i < bones.length; i ++ ) {\n\n\t\t\tconst bone = bones[ i ];\n\n\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\tvertices.push( 0, 0, 0 );\n\t\t\t\tvertices.push( 0, 0, 0 );\n\t\t\t\tcolors.push( color1.r, color1.g, color1.b );\n\t\t\t\tcolors.push( color2.r, color2.g, color2.b );\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, depthTest: false, depthWrite: false, toneMapped: false, transparent: true } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.isSkeletonHelper = true;\n\n\t\tthis.type = 'SkeletonHelper';\n\n\t\tthis.root = object;\n\t\tthis.bones = bones;\n\n\t\tthis.matrix = object.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tconst bones = this.bones;\n\n\t\tconst geometry = this.geometry;\n\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\t_matrixWorldInv.copy( this.root.matrixWorld ).invert();\n\n\t\tfor ( let i = 0, j = 0; i < bones.length; i ++ ) {\n\n\t\t\tconst bone = bones[ i ];\n\n\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t_boneMatrix.multiplyMatrices( _matrixWorldInv, bone.matrixWorld );\n\t\t\t\t_vector$2.setFromMatrixPosition( _boneMatrix );\n\t\t\t\tposition.setXYZ( j, _vector$2.x, _vector$2.y, _vector$2.z );\n\n\t\t\t\t_boneMatrix.multiplyMatrices( _matrixWorldInv, bone.parent.matrixWorld );\n\t\t\t\t_vector$2.setFromMatrixPosition( _boneMatrix );\n\t\t\t\tposition.setXYZ( j + 1, _vector$2.x, _vector$2.y, _vector$2.z );\n\n\t\t\t\tj += 2;\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeometry.getAttribute( 'position' ).needsUpdate = true;\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\n\nfunction getBoneList( object ) {\n\n\tconst boneList = [];\n\n\tif ( object.isBone === true ) {\n\n\t\tboneList.push( object );\n\n\t}\n\n\tfor ( let i = 0; i < object.children.length; i ++ ) {\n\n\t\tboneList.push.apply( boneList, getBoneList( object.children[ i ] ) );\n\n\t}\n\n\treturn boneList;\n\n}\n\nclass PointLightHelper extends Mesh {\n\n\tconstructor( light, sphereSize, color ) {\n\n\t\tconst geometry = new SphereGeometry( sphereSize, 4, 2 );\n\t\tconst material = new MeshBasicMaterial( { wireframe: true, fog: false, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.light = light;\n\n\t\tthis.color = color;\n\n\t\tthis.type = 'PointLightHelper';\n\n\t\tthis.matrix = this.light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.update();\n\n\n\t\t/*\n\t// TODO: delete this comment?\n\tconst distanceGeometry = new THREE.IcosahedronGeometry( 1, 2 );\n\tconst distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\n\n\tthis.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\n\tthis.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\n\n\tconst d = light.distance;\n\n\tif ( d === 0.0 ) {\n\n\t\tthis.lightDistance.visible = false;\n\n\t} else {\n\n\t\tthis.lightDistance.scale.set( d, d, d );\n\n\t}\n\n\tthis.add( this.lightDistance );\n\t*/\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\tthis.light.updateWorldMatrix( true, false );\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tthis.material.color.copy( this.light.color );\n\n\t\t}\n\n\t\t/*\n\t\tconst d = this.light.distance;\n\n\t\tif ( d === 0.0 ) {\n\n\t\t\tthis.lightDistance.visible = false;\n\n\t\t} else {\n\n\t\t\tthis.lightDistance.visible = true;\n\t\t\tthis.lightDistance.scale.set( d, d, d );\n\n\t\t}\n\t\t*/\n\n\t}\n\n}\n\nconst _vector$1 = /*@__PURE__*/ new Vector3();\nconst _color1 = /*@__PURE__*/ new Color();\nconst _color2 = /*@__PURE__*/ new Color();\n\nclass HemisphereLightHelper extends Object3D {\n\n\tconstructor( light, size, color ) {\n\n\t\tsuper();\n\n\t\tthis.light = light;\n\n\t\tthis.matrix = light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.color = color;\n\n\t\tthis.type = 'HemisphereLightHelper';\n\n\t\tconst geometry = new OctahedronGeometry( size );\n\t\tgeometry.rotateY( Math.PI * 0.5 );\n\n\t\tthis.material = new MeshBasicMaterial( { wireframe: true, fog: false, toneMapped: false } );\n\t\tif ( this.color === undefined ) this.material.vertexColors = true;\n\n\t\tconst position = geometry.getAttribute( 'position' );\n\t\tconst colors = new Float32Array( position.count * 3 );\n\n\t\tgeometry.setAttribute( 'color', new BufferAttribute( colors, 3 ) );\n\n\t\tthis.add( new Mesh( geometry, this.material ) );\n\n\t\tthis.update();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.children[ 0 ].geometry.dispose();\n\t\tthis.children[ 0 ].material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\tconst mesh = this.children[ 0 ];\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tconst colors = mesh.geometry.getAttribute( 'color' );\n\n\t\t\t_color1.copy( this.light.color );\n\t\t\t_color2.copy( this.light.groundColor );\n\n\t\t\tfor ( let i = 0, l = colors.count; i < l; i ++ ) {\n\n\t\t\t\tconst color = ( i < ( l / 2 ) ) ? _color1 : _color2;\n\n\t\t\t\tcolors.setXYZ( i, color.r, color.g, color.b );\n\n\t\t\t}\n\n\t\t\tcolors.needsUpdate = true;\n\n\t\t}\n\n\t\tthis.light.updateWorldMatrix( true, false );\n\n\t\tmesh.lookAt( _vector$1.setFromMatrixPosition( this.light.matrixWorld ).negate() );\n\n\t}\n\n}\n\nclass GridHelper extends LineSegments {\n\n\tconstructor( size = 10, divisions = 10, color1 = 0x444444, color2 = 0x888888 ) {\n\n\t\tcolor1 = new Color( color1 );\n\t\tcolor2 = new Color( color2 );\n\n\t\tconst center = divisions / 2;\n\t\tconst step = size / divisions;\n\t\tconst halfSize = size / 2;\n\n\t\tconst vertices = [], colors = [];\n\n\t\tfor ( let i = 0, j = 0, k = - halfSize; i <= divisions; i ++, k += step ) {\n\n\t\t\tvertices.push( - halfSize, 0, k, halfSize, 0, k );\n\t\t\tvertices.push( k, 0, - halfSize, k, 0, halfSize );\n\n\t\t\tconst color = i === center ? color1 : color2;\n\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\n\t\t}\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'GridHelper';\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nclass PolarGridHelper extends LineSegments {\n\n\tconstructor( radius = 10, sectors = 16, rings = 8, divisions = 64, color1 = 0x444444, color2 = 0x888888 ) {\n\n\t\tcolor1 = new Color( color1 );\n\t\tcolor2 = new Color( color2 );\n\n\t\tconst vertices = [];\n\t\tconst colors = [];\n\n\t\t// create the sectors\n\n\t\tif ( sectors > 1 ) {\n\n\t\t\tfor ( let i = 0; i < sectors; i ++ ) {\n\n\t\t\t\tconst v = ( i / sectors ) * ( Math.PI * 2 );\n\n\t\t\t\tconst x = Math.sin( v ) * radius;\n\t\t\t\tconst z = Math.cos( v ) * radius;\n\n\t\t\t\tvertices.push( 0, 0, 0 );\n\t\t\t\tvertices.push( x, 0, z );\n\n\t\t\t\tconst color = ( i & 1 ) ? color1 : color2;\n\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// create the rings\n\n\t\tfor ( let i = 0; i < rings; i ++ ) {\n\n\t\t\tconst color = ( i & 1 ) ? color1 : color2;\n\n\t\t\tconst r = radius - ( radius / rings * i );\n\n\t\t\tfor ( let j = 0; j < divisions; j ++ ) {\n\n\t\t\t\t// first vertex\n\n\t\t\t\tlet v = ( j / divisions ) * ( Math.PI * 2 );\n\n\t\t\t\tlet x = Math.sin( v ) * r;\n\t\t\t\tlet z = Math.cos( v ) * r;\n\n\t\t\t\tvertices.push( x, 0, z );\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t\t\t// second vertex\n\n\t\t\t\tv = ( ( j + 1 ) / divisions ) * ( Math.PI * 2 );\n\n\t\t\t\tx = Math.sin( v ) * r;\n\t\t\t\tz = Math.cos( v ) * r;\n\n\t\t\t\tvertices.push( x, 0, z );\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'PolarGridHelper';\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nconst _v1 = /*@__PURE__*/ new Vector3();\nconst _v2 = /*@__PURE__*/ new Vector3();\nconst _v3 = /*@__PURE__*/ new Vector3();\n\nclass DirectionalLightHelper extends Object3D {\n\n\tconstructor( light, size, color ) {\n\n\t\tsuper();\n\n\t\tthis.light = light;\n\n\t\tthis.matrix = light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.color = color;\n\n\t\tthis.type = 'DirectionalLightHelper';\n\n\t\tif ( size === undefined ) size = 1;\n\n\t\tlet geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( [\n\t\t\t- size, size, 0,\n\t\t\tsize, size, 0,\n\t\t\tsize, - size, 0,\n\t\t\t- size, - size, 0,\n\t\t\t- size, size, 0\n\t\t], 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { fog: false, toneMapped: false } );\n\n\t\tthis.lightPlane = new Line( geometry, material );\n\t\tthis.add( this.lightPlane );\n\n\t\tgeometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 0, 0, 1 ], 3 ) );\n\n\t\tthis.targetLine = new Line( geometry, material );\n\t\tthis.add( this.targetLine );\n\n\t\tthis.update();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.lightPlane.geometry.dispose();\n\t\tthis.lightPlane.material.dispose();\n\t\tthis.targetLine.geometry.dispose();\n\t\tthis.targetLine.material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\tthis.light.updateWorldMatrix( true, false );\n\t\tthis.light.target.updateWorldMatrix( true, false );\n\n\t\t_v1.setFromMatrixPosition( this.light.matrixWorld );\n\t\t_v2.setFromMatrixPosition( this.light.target.matrixWorld );\n\t\t_v3.subVectors( _v2, _v1 );\n\n\t\tthis.lightPlane.lookAt( _v2 );\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.lightPlane.material.color.set( this.color );\n\t\t\tthis.targetLine.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tthis.lightPlane.material.color.copy( this.light.color );\n\t\t\tthis.targetLine.material.color.copy( this.light.color );\n\n\t\t}\n\n\t\tthis.targetLine.lookAt( _v2 );\n\t\tthis.targetLine.scale.z = _v3.length();\n\n\t}\n\n}\n\nconst _vector = /*@__PURE__*/ new Vector3();\nconst _camera = /*@__PURE__*/ new Camera();\n\n/**\n *\t- shows frustum, line of sight and up of the camera\n *\t- suitable for fast updates\n * \t- based on frustum visualization in lightgl.js shadowmap example\n *\t\thttps://github.com/evanw/lightgl.js/blob/master/tests/shadowmap.html\n */\n\nclass CameraHelper extends LineSegments {\n\n\tconstructor( camera ) {\n\n\t\tconst geometry = new BufferGeometry();\n\t\tconst material = new LineBasicMaterial( { color: 0xffffff, vertexColors: true, toneMapped: false } );\n\n\t\tconst vertices = [];\n\t\tconst colors = [];\n\n\t\tconst pointMap = {};\n\n\t\t// near\n\n\t\taddLine( 'n1', 'n2' );\n\t\taddLine( 'n2', 'n4' );\n\t\taddLine( 'n4', 'n3' );\n\t\taddLine( 'n3', 'n1' );\n\n\t\t// far\n\n\t\taddLine( 'f1', 'f2' );\n\t\taddLine( 'f2', 'f4' );\n\t\taddLine( 'f4', 'f3' );\n\t\taddLine( 'f3', 'f1' );\n\n\t\t// sides\n\n\t\taddLine( 'n1', 'f1' );\n\t\taddLine( 'n2', 'f2' );\n\t\taddLine( 'n3', 'f3' );\n\t\taddLine( 'n4', 'f4' );\n\n\t\t// cone\n\n\t\taddLine( 'p', 'n1' );\n\t\taddLine( 'p', 'n2' );\n\t\taddLine( 'p', 'n3' );\n\t\taddLine( 'p', 'n4' );\n\n\t\t// up\n\n\t\taddLine( 'u1', 'u2' );\n\t\taddLine( 'u2', 'u3' );\n\t\taddLine( 'u3', 'u1' );\n\n\t\t// target\n\n\t\taddLine( 'c', 't' );\n\t\taddLine( 'p', 'c' );\n\n\t\t// cross\n\n\t\taddLine( 'cn1', 'cn2' );\n\t\taddLine( 'cn3', 'cn4' );\n\n\t\taddLine( 'cf1', 'cf2' );\n\t\taddLine( 'cf3', 'cf4' );\n\n\t\tfunction addLine( a, b ) {\n\n\t\t\taddPoint( a );\n\t\t\taddPoint( b );\n\n\t\t}\n\n\t\tfunction addPoint( id ) {\n\n\t\t\tvertices.push( 0, 0, 0 );\n\t\t\tcolors.push( 0, 0, 0 );\n\n\t\t\tif ( pointMap[ id ] === undefined ) {\n\n\t\t\t\tpointMap[ id ] = [];\n\n\t\t\t}\n\n\t\t\tpointMap[ id ].push( ( vertices.length / 3 ) - 1 );\n\n\t\t}\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'CameraHelper';\n\n\t\tthis.camera = camera;\n\t\tif ( this.camera.updateProjectionMatrix ) this.camera.updateProjectionMatrix();\n\n\t\tthis.matrix = camera.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.pointMap = pointMap;\n\n\t\tthis.update();\n\n\t\t// colors\n\n\t\tconst colorFrustum = new Color( 0xffaa00 );\n\t\tconst colorCone = new Color( 0xff0000 );\n\t\tconst colorUp = new Color( 0x00aaff );\n\t\tconst colorTarget = new Color( 0xffffff );\n\t\tconst colorCross = new Color( 0x333333 );\n\n\t\tthis.setColors( colorFrustum, colorCone, colorUp, colorTarget, colorCross );\n\n\t}\n\n\tsetColors( frustum, cone, up, target, cross ) {\n\n\t\tconst geometry = this.geometry;\n\n\t\tconst colorAttribute = geometry.getAttribute( 'color' );\n\n\t\t// near\n\n\t\tcolorAttribute.setXYZ( 0, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 1, frustum.r, frustum.g, frustum.b ); // n1, n2\n\t\tcolorAttribute.setXYZ( 2, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 3, frustum.r, frustum.g, frustum.b ); // n2, n4\n\t\tcolorAttribute.setXYZ( 4, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 5, frustum.r, frustum.g, frustum.b ); // n4, n3\n\t\tcolorAttribute.setXYZ( 6, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 7, frustum.r, frustum.g, frustum.b ); // n3, n1\n\n\t\t// far\n\n\t\tcolorAttribute.setXYZ( 8, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 9, frustum.r, frustum.g, frustum.b ); // f1, f2\n\t\tcolorAttribute.setXYZ( 10, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 11, frustum.r, frustum.g, frustum.b ); // f2, f4\n\t\tcolorAttribute.setXYZ( 12, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 13, frustum.r, frustum.g, frustum.b ); // f4, f3\n\t\tcolorAttribute.setXYZ( 14, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 15, frustum.r, frustum.g, frustum.b ); // f3, f1\n\n\t\t// sides\n\n\t\tcolorAttribute.setXYZ( 16, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 17, frustum.r, frustum.g, frustum.b ); // n1, f1\n\t\tcolorAttribute.setXYZ( 18, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 19, frustum.r, frustum.g, frustum.b ); // n2, f2\n\t\tcolorAttribute.setXYZ( 20, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 21, frustum.r, frustum.g, frustum.b ); // n3, f3\n\t\tcolorAttribute.setXYZ( 22, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 23, frustum.r, frustum.g, frustum.b ); // n4, f4\n\n\t\t// cone\n\n\t\tcolorAttribute.setXYZ( 24, cone.r, cone.g, cone.b ); colorAttribute.setXYZ( 25, cone.r, cone.g, cone.b ); // p, n1\n\t\tcolorAttribute.setXYZ( 26, cone.r, cone.g, cone.b ); colorAttribute.setXYZ( 27, cone.r, cone.g, cone.b ); // p, n2\n\t\tcolorAttribute.setXYZ( 28, cone.r, cone.g, cone.b ); colorAttribute.setXYZ( 29, cone.r, cone.g, cone.b ); // p, n3\n\t\tcolorAttribute.setXYZ( 30, cone.r, cone.g, cone.b ); colorAttribute.setXYZ( 31, cone.r, cone.g, cone.b ); // p, n4\n\n\t\t// up\n\n\t\tcolorAttribute.setXYZ( 32, up.r, up.g, up.b ); colorAttribute.setXYZ( 33, up.r, up.g, up.b ); // u1, u2\n\t\tcolorAttribute.setXYZ( 34, up.r, up.g, up.b ); colorAttribute.setXYZ( 35, up.r, up.g, up.b ); // u2, u3\n\t\tcolorAttribute.setXYZ( 36, up.r, up.g, up.b ); colorAttribute.setXYZ( 37, up.r, up.g, up.b ); // u3, u1\n\n\t\t// target\n\n\t\tcolorAttribute.setXYZ( 38, target.r, target.g, target.b ); colorAttribute.setXYZ( 39, target.r, target.g, target.b ); // c, t\n\t\tcolorAttribute.setXYZ( 40, cross.r, cross.g, cross.b ); colorAttribute.setXYZ( 41, cross.r, cross.g, cross.b ); // p, c\n\n\t\t// cross\n\n\t\tcolorAttribute.setXYZ( 42, cross.r, cross.g, cross.b ); colorAttribute.setXYZ( 43, cross.r, cross.g, cross.b ); // cn1, cn2\n\t\tcolorAttribute.setXYZ( 44, cross.r, cross.g, cross.b ); colorAttribute.setXYZ( 45, cross.r, cross.g, cross.b ); // cn3, cn4\n\n\t\tcolorAttribute.setXYZ( 46, cross.r, cross.g, cross.b ); colorAttribute.setXYZ( 47, cross.r, cross.g, cross.b ); // cf1, cf2\n\t\tcolorAttribute.setXYZ( 48, cross.r, cross.g, cross.b ); colorAttribute.setXYZ( 49, cross.r, cross.g, cross.b ); // cf3, cf4\n\n\t\tcolorAttribute.needsUpdate = true;\n\n\t}\n\n\tupdate() {\n\n\t\tconst geometry = this.geometry;\n\t\tconst pointMap = this.pointMap;\n\n\t\tconst w = 1, h = 1;\n\n\t\t// we need just camera projection matrix inverse\n\t\t// world matrix must be identity\n\n\t\t_camera.projectionMatrixInverse.copy( this.camera.projectionMatrixInverse );\n\n\t\t// center / target\n\n\t\tsetPoint( 'c', pointMap, geometry, _camera, 0, 0, - 1 );\n\t\tsetPoint( 't', pointMap, geometry, _camera, 0, 0, 1 );\n\n\t\t// near\n\n\t\tsetPoint( 'n1', pointMap, geometry, _camera, - w, - h, - 1 );\n\t\tsetPoint( 'n2', pointMap, geometry, _camera, w, - h, - 1 );\n\t\tsetPoint( 'n3', pointMap, geometry, _camera, - w, h, - 1 );\n\t\tsetPoint( 'n4', pointMap, geometry, _camera, w, h, - 1 );\n\n\t\t// far\n\n\t\tsetPoint( 'f1', pointMap, geometry, _camera, - w, - h, 1 );\n\t\tsetPoint( 'f2', pointMap, geometry, _camera, w, - h, 1 );\n\t\tsetPoint( 'f3', pointMap, geometry, _camera, - w, h, 1 );\n\t\tsetPoint( 'f4', pointMap, geometry, _camera, w, h, 1 );\n\n\t\t// up\n\n\t\tsetPoint( 'u1', pointMap, geometry, _camera, w * 0.7, h * 1.1, - 1 );\n\t\tsetPoint( 'u2', pointMap, geometry, _camera, - w * 0.7, h * 1.1, - 1 );\n\t\tsetPoint( 'u3', pointMap, geometry, _camera, 0, h * 2, - 1 );\n\n\t\t// cross\n\n\t\tsetPoint( 'cf1', pointMap, geometry, _camera, - w, 0, 1 );\n\t\tsetPoint( 'cf2', pointMap, geometry, _camera, w, 0, 1 );\n\t\tsetPoint( 'cf3', pointMap, geometry, _camera, 0, - h, 1 );\n\t\tsetPoint( 'cf4', pointMap, geometry, _camera, 0, h, 1 );\n\n\t\tsetPoint( 'cn1', pointMap, geometry, _camera, - w, 0, - 1 );\n\t\tsetPoint( 'cn2', pointMap, geometry, _camera, w, 0, - 1 );\n\t\tsetPoint( 'cn3', pointMap, geometry, _camera, 0, - h, - 1 );\n\t\tsetPoint( 'cn4', pointMap, geometry, _camera, 0, h, - 1 );\n\n\t\tgeometry.getAttribute( 'position' ).needsUpdate = true;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\n\nfunction setPoint( point, pointMap, geometry, camera, x, y, z ) {\n\n\t_vector.set( x, y, z ).unproject( camera );\n\n\tconst points = pointMap[ point ];\n\n\tif ( points !== undefined ) {\n\n\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\tfor ( let i = 0, l = points.length; i < l; i ++ ) {\n\n\t\t\tposition.setXYZ( points[ i ], _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t}\n\n}\n\nconst _box = /*@__PURE__*/ new Box3();\n\nclass BoxHelper extends LineSegments {\n\n\tconstructor( object, color = 0xffff00 ) {\n\n\t\tconst indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\n\t\tconst positions = new Float32Array( 8 * 3 );\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setIndex( new BufferAttribute( indices, 1 ) );\n\t\tgeometry.setAttribute( 'position', new BufferAttribute( positions, 3 ) );\n\n\t\tsuper( geometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\n\t\tthis.object = object;\n\t\tthis.type = 'BoxHelper';\n\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.update();\n\n\t}\n\n\tupdate( object ) {\n\n\t\tif ( object !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.BoxHelper: .update() has no longer arguments.' );\n\n\t\t}\n\n\t\tif ( this.object !== undefined ) {\n\n\t\t\t_box.setFromObject( this.object );\n\n\t\t}\n\n\t\tif ( _box.isEmpty() ) return;\n\n\t\tconst min = _box.min;\n\t\tconst max = _box.max;\n\n\t\t/*\n\t\t\t5____4\n\t\t1/___0/|\n\t\t| 6__|_7\n\t\t2/___3/\n\n\t\t0: max.x, max.y, max.z\n\t\t1: min.x, max.y, max.z\n\t\t2: min.x, min.y, max.z\n\t\t3: max.x, min.y, max.z\n\t\t4: max.x, max.y, min.z\n\t\t5: min.x, max.y, min.z\n\t\t6: min.x, min.y, min.z\n\t\t7: max.x, min.y, min.z\n\t\t*/\n\n\t\tconst position = this.geometry.attributes.position;\n\t\tconst array = position.array;\n\n\t\tarray[ 0 ] = max.x; array[ 1 ] = max.y; array[ 2 ] = max.z;\n\t\tarray[ 3 ] = min.x; array[ 4 ] = max.y; array[ 5 ] = max.z;\n\t\tarray[ 6 ] = min.x; array[ 7 ] = min.y; array[ 8 ] = max.z;\n\t\tarray[ 9 ] = max.x; array[ 10 ] = min.y; array[ 11 ] = max.z;\n\t\tarray[ 12 ] = max.x; array[ 13 ] = max.y; array[ 14 ] = min.z;\n\t\tarray[ 15 ] = min.x; array[ 16 ] = max.y; array[ 17 ] = min.z;\n\t\tarray[ 18 ] = min.x; array[ 19 ] = min.y; array[ 20 ] = min.z;\n\t\tarray[ 21 ] = max.x; array[ 22 ] = min.y; array[ 23 ] = min.z;\n\n\t\tposition.needsUpdate = true;\n\n\t\tthis.geometry.computeBoundingSphere();\n\n\t}\n\n\tsetFromObject( object ) {\n\n\t\tthis.object = object;\n\t\tthis.update();\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.object = source.object;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nclass Box3Helper extends LineSegments {\n\n\tconstructor( box, color = 0xffff00 ) {\n\n\t\tconst indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\n\n\t\tconst positions = [ 1, 1, 1, - 1, 1, 1, - 1, - 1, 1, 1, - 1, 1, 1, 1, - 1, - 1, 1, - 1, - 1, - 1, - 1, 1, - 1, - 1 ];\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tgeometry.setIndex( new BufferAttribute( indices, 1 ) );\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\n\t\tsuper( geometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\n\t\tthis.box = box;\n\n\t\tthis.type = 'Box3Helper';\n\n\t\tthis.geometry.computeBoundingSphere();\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tconst box = this.box;\n\n\t\tif ( box.isEmpty() ) return;\n\n\t\tbox.getCenter( this.position );\n\n\t\tbox.getSize( this.scale );\n\n\t\tthis.scale.multiplyScalar( 0.5 );\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nclass PlaneHelper extends Line {\n\n\tconstructor( plane, size = 1, hex = 0xffff00 ) {\n\n\t\tconst color = hex;\n\n\t\tconst positions = [ 1, - 1, 0, - 1, 1, 0, - 1, - 1, 0, 1, 1, 0, - 1, 1, 0, - 1, - 1, 0, 1, - 1, 0, 1, 1, 0 ];\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\t\tgeometry.computeBoundingSphere();\n\n\t\tsuper( geometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\n\t\tthis.type = 'PlaneHelper';\n\n\t\tthis.plane = plane;\n\n\t\tthis.size = size;\n\n\t\tconst positions2 = [ 1, 1, 0, - 1, 1, 0, - 1, - 1, 0, 1, 1, 0, - 1, - 1, 0, 1, - 1, 0 ];\n\n\t\tconst geometry2 = new BufferGeometry();\n\t\tgeometry2.setAttribute( 'position', new Float32BufferAttribute( positions2, 3 ) );\n\t\tgeometry2.computeBoundingSphere();\n\n\t\tthis.add( new Mesh( geometry2, new MeshBasicMaterial( { color: color, opacity: 0.2, transparent: true, depthWrite: false, toneMapped: false } ) ) );\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tthis.position.set( 0, 0, 0 );\n\n\t\tthis.scale.set( 0.5 * this.size, 0.5 * this.size, 1 );\n\n\t\tthis.lookAt( this.plane.normal );\n\n\t\tthis.translateZ( - this.plane.constant );\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\t\tthis.children[ 0 ].geometry.dispose();\n\t\tthis.children[ 0 ].material.dispose();\n\n\t}\n\n}\n\nconst _axis = /*@__PURE__*/ new Vector3();\nlet _lineGeometry, _coneGeometry;\n\nclass ArrowHelper extends Object3D {\n\n\t// dir is assumed to be normalized\n\n\tconstructor( dir = new Vector3( 0, 0, 1 ), origin = new Vector3( 0, 0, 0 ), length = 1, color = 0xffff00, headLength = length * 0.2, headWidth = headLength * 0.2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ArrowHelper';\n\n\t\tif ( _lineGeometry === undefined ) {\n\n\t\t\t_lineGeometry = new BufferGeometry();\n\t\t\t_lineGeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 0, 1, 0 ], 3 ) );\n\n\t\t\t_coneGeometry = new CylinderGeometry( 0, 0.5, 1, 5, 1 );\n\t\t\t_coneGeometry.translate( 0, - 0.5, 0 );\n\n\t\t}\n\n\t\tthis.position.copy( origin );\n\n\t\tthis.line = new Line( _lineGeometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\t\tthis.line.matrixAutoUpdate = false;\n\t\tthis.add( this.line );\n\n\t\tthis.cone = new Mesh( _coneGeometry, new MeshBasicMaterial( { color: color, toneMapped: false } ) );\n\t\tthis.cone.matrixAutoUpdate = false;\n\t\tthis.add( this.cone );\n\n\t\tthis.setDirection( dir );\n\t\tthis.setLength( length, headLength, headWidth );\n\n\t}\n\n\tsetDirection( dir ) {\n\n\t\t// dir is assumed to be normalized\n\n\t\tif ( dir.y > 0.99999 ) {\n\n\t\t\tthis.quaternion.set( 0, 0, 0, 1 );\n\n\t\t} else if ( dir.y < - 0.99999 ) {\n\n\t\t\tthis.quaternion.set( 1, 0, 0, 0 );\n\n\t\t} else {\n\n\t\t\t_axis.set( dir.z, 0, - dir.x ).normalize();\n\n\t\t\tconst radians = Math.acos( dir.y );\n\n\t\t\tthis.quaternion.setFromAxisAngle( _axis, radians );\n\n\t\t}\n\n\t}\n\n\tsetLength( length, headLength = length * 0.2, headWidth = headLength * 0.2 ) {\n\n\t\tthis.line.scale.set( 1, Math.max( 0.0001, length - headLength ), 1 ); // see #17458\n\t\tthis.line.updateMatrix();\n\n\t\tthis.cone.scale.set( headWidth, headLength, headWidth );\n\t\tthis.cone.position.y = length;\n\t\tthis.cone.updateMatrix();\n\n\t}\n\n\tsetColor( color ) {\n\n\t\tthis.line.material.color.set( color );\n\t\tthis.cone.material.color.set( color );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source, false );\n\n\t\tthis.line.copy( source.line );\n\t\tthis.cone.copy( source.cone );\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.line.geometry.dispose();\n\t\tthis.line.material.dispose();\n\t\tthis.cone.geometry.dispose();\n\t\tthis.cone.material.dispose();\n\n\t}\n\n}\n\nclass AxesHelper extends LineSegments {\n\n\tconstructor( size = 1 ) {\n\n\t\tconst vertices = [\n\t\t\t0, 0, 0,\tsize, 0, 0,\n\t\t\t0, 0, 0,\t0, size, 0,\n\t\t\t0, 0, 0,\t0, 0, size\n\t\t];\n\n\t\tconst colors = [\n\t\t\t1, 0, 0,\t1, 0.6, 0,\n\t\t\t0, 1, 0,\t0.6, 1, 0,\n\t\t\t0, 0, 1,\t0, 0.6, 1\n\t\t];\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'AxesHelper';\n\n\t}\n\n\tsetColors( xAxisColor, yAxisColor, zAxisColor ) {\n\n\t\tconst color = new Color();\n\t\tconst array = this.geometry.attributes.color.array;\n\n\t\tcolor.set( xAxisColor );\n\t\tcolor.toArray( array, 0 );\n\t\tcolor.toArray( array, 3 );\n\n\t\tcolor.set( yAxisColor );\n\t\tcolor.toArray( array, 6 );\n\t\tcolor.toArray( array, 9 );\n\n\t\tcolor.set( zAxisColor );\n\t\tcolor.toArray( array, 12 );\n\t\tcolor.toArray( array, 15 );\n\n\t\tthis.geometry.attributes.color.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nclass ShapePath {\n\n\tconstructor() {\n\n\t\tthis.type = 'ShapePath';\n\n\t\tthis.color = new Color();\n\n\t\tthis.subPaths = [];\n\t\tthis.currentPath = null;\n\n\t}\n\n\tmoveTo( x, y ) {\n\n\t\tthis.currentPath = new Path();\n\t\tthis.subPaths.push( this.currentPath );\n\t\tthis.currentPath.moveTo( x, y );\n\n\t\treturn this;\n\n\t}\n\n\tlineTo( x, y ) {\n\n\t\tthis.currentPath.lineTo( x, y );\n\n\t\treturn this;\n\n\t}\n\n\tquadraticCurveTo( aCPx, aCPy, aX, aY ) {\n\n\t\tthis.currentPath.quadraticCurveTo( aCPx, aCPy, aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tbezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\n\n\t\tthis.currentPath.bezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tsplineThru( pts ) {\n\n\t\tthis.currentPath.splineThru( pts );\n\n\t\treturn this;\n\n\t}\n\n\ttoShapes( isCCW ) {\n\n\t\tfunction toShapesNoHoles( inSubpaths ) {\n\n\t\t\tconst shapes = [];\n\n\t\t\tfor ( let i = 0, l = inSubpaths.length; i < l; i ++ ) {\n\n\t\t\t\tconst tmpPath = inSubpaths[ i ];\n\n\t\t\t\tconst tmpShape = new Shape();\n\t\t\t\ttmpShape.curves = tmpPath.curves;\n\n\t\t\t\tshapes.push( tmpShape );\n\n\t\t\t}\n\n\t\t\treturn shapes;\n\n\t\t}\n\n\t\tfunction isPointInsidePolygon( inPt, inPolygon ) {\n\n\t\t\tconst polyLen = inPolygon.length;\n\n\t\t\t// inPt on polygon contour => immediate success    or\n\t\t\t// toggling of inside/outside at every single! intersection point of an edge\n\t\t\t//  with the horizontal line through inPt, left of inPt\n\t\t\t//  not counting lowerY endpoints of edges and whole edges on that line\n\t\t\tlet inside = false;\n\t\t\tfor ( let p = polyLen - 1, q = 0; q < polyLen; p = q ++ ) {\n\n\t\t\t\tlet edgeLowPt = inPolygon[ p ];\n\t\t\t\tlet edgeHighPt = inPolygon[ q ];\n\n\t\t\t\tlet edgeDx = edgeHighPt.x - edgeLowPt.x;\n\t\t\t\tlet edgeDy = edgeHighPt.y - edgeLowPt.y;\n\n\t\t\t\tif ( Math.abs( edgeDy ) > Number.EPSILON ) {\n\n\t\t\t\t\t// not parallel\n\t\t\t\t\tif ( edgeDy < 0 ) {\n\n\t\t\t\t\t\tedgeLowPt = inPolygon[ q ]; edgeDx = - edgeDx;\n\t\t\t\t\t\tedgeHighPt = inPolygon[ p ]; edgeDy = - edgeDy;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ( inPt.y < edgeLowPt.y ) || ( inPt.y > edgeHighPt.y ) ) \t\tcontinue;\n\n\t\t\t\t\tif ( inPt.y === edgeLowPt.y ) {\n\n\t\t\t\t\t\tif ( inPt.x === edgeLowPt.x )\t\treturn\ttrue;\t\t// inPt is on contour ?\n\t\t\t\t\t\t// continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconst perpEdge = edgeDy * ( inPt.x - edgeLowPt.x ) - edgeDx * ( inPt.y - edgeLowPt.y );\n\t\t\t\t\t\tif ( perpEdge === 0 )\t\t\t\treturn\ttrue;\t\t// inPt is on contour ?\n\t\t\t\t\t\tif ( perpEdge < 0 ) \t\t\t\tcontinue;\n\t\t\t\t\t\tinside = ! inside;\t\t// true intersection left of inPt\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// parallel or collinear\n\t\t\t\t\tif ( inPt.y !== edgeLowPt.y ) \t\tcontinue;\t\t\t// parallel\n\t\t\t\t\t// edge lies on the same horizontal line as inPt\n\t\t\t\t\tif ( ( ( edgeHighPt.x <= inPt.x ) && ( inPt.x <= edgeLowPt.x ) ) ||\n\t\t\t\t\t\t ( ( edgeLowPt.x <= inPt.x ) && ( inPt.x <= edgeHighPt.x ) ) )\t\treturn\ttrue;\t// inPt: Point on contour !\n\t\t\t\t\t// continue;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn\tinside;\n\n\t\t}\n\n\t\tconst isClockWise = ShapeUtils.isClockWise;\n\n\t\tconst subPaths = this.subPaths;\n\t\tif ( subPaths.length === 0 ) return [];\n\n\t\tlet solid, tmpPath, tmpShape;\n\t\tconst shapes = [];\n\n\t\tif ( subPaths.length === 1 ) {\n\n\t\t\ttmpPath = subPaths[ 0 ];\n\t\t\ttmpShape = new Shape();\n\t\t\ttmpShape.curves = tmpPath.curves;\n\t\t\tshapes.push( tmpShape );\n\t\t\treturn shapes;\n\n\t\t}\n\n\t\tlet holesFirst = ! isClockWise( subPaths[ 0 ].getPoints() );\n\t\tholesFirst = isCCW ? ! holesFirst : holesFirst;\n\n\t\t// console.log(\"Holes first\", holesFirst);\n\n\t\tconst betterShapeHoles = [];\n\t\tconst newShapes = [];\n\t\tlet newShapeHoles = [];\n\t\tlet mainIdx = 0;\n\t\tlet tmpPoints;\n\n\t\tnewShapes[ mainIdx ] = undefined;\n\t\tnewShapeHoles[ mainIdx ] = [];\n\n\t\tfor ( let i = 0, l = subPaths.length; i < l; i ++ ) {\n\n\t\t\ttmpPath = subPaths[ i ];\n\t\t\ttmpPoints = tmpPath.getPoints();\n\t\t\tsolid = isClockWise( tmpPoints );\n\t\t\tsolid = isCCW ? ! solid : solid;\n\n\t\t\tif ( solid ) {\n\n\t\t\t\tif ( ( ! holesFirst ) && ( newShapes[ mainIdx ] ) )\tmainIdx ++;\n\n\t\t\t\tnewShapes[ mainIdx ] = { s: new Shape(), p: tmpPoints };\n\t\t\t\tnewShapes[ mainIdx ].s.curves = tmpPath.curves;\n\n\t\t\t\tif ( holesFirst )\tmainIdx ++;\n\t\t\t\tnewShapeHoles[ mainIdx ] = [];\n\n\t\t\t\t//console.log('cw', i);\n\n\t\t\t} else {\n\n\t\t\t\tnewShapeHoles[ mainIdx ].push( { h: tmpPath, p: tmpPoints[ 0 ] } );\n\n\t\t\t\t//console.log('ccw', i);\n\n\t\t\t}\n\n\t\t}\n\n\t\t// only Holes? -> probably all Shapes with wrong orientation\n\t\tif ( ! newShapes[ 0 ] )\treturn\ttoShapesNoHoles( subPaths );\n\n\n\t\tif ( newShapes.length > 1 ) {\n\n\t\t\tlet ambiguous = false;\n\t\t\tlet toChange = 0;\n\n\t\t\tfor ( let sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\n\n\t\t\t\tbetterShapeHoles[ sIdx ] = [];\n\n\t\t\t}\n\n\t\t\tfor ( let sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\n\n\t\t\t\tconst sho = newShapeHoles[ sIdx ];\n\n\t\t\t\tfor ( let hIdx = 0; hIdx < sho.length; hIdx ++ ) {\n\n\t\t\t\t\tconst ho = sho[ hIdx ];\n\t\t\t\t\tlet hole_unassigned = true;\n\n\t\t\t\t\tfor ( let s2Idx = 0; s2Idx < newShapes.length; s2Idx ++ ) {\n\n\t\t\t\t\t\tif ( isPointInsidePolygon( ho.p, newShapes[ s2Idx ].p ) ) {\n\n\t\t\t\t\t\t\tif ( sIdx !== s2Idx )\ttoChange ++;\n\n\t\t\t\t\t\t\tif ( hole_unassigned ) {\n\n\t\t\t\t\t\t\t\thole_unassigned = false;\n\t\t\t\t\t\t\t\tbetterShapeHoles[ s2Idx ].push( ho );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tambiguous = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( hole_unassigned ) {\n\n\t\t\t\t\t\tbetterShapeHoles[ sIdx ].push( ho );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( toChange > 0 && ambiguous === false ) {\n\n\t\t\t\tnewShapeHoles = betterShapeHoles;\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet tmpHoles;\n\n\t\tfor ( let i = 0, il = newShapes.length; i < il; i ++ ) {\n\n\t\t\ttmpShape = newShapes[ i ].s;\n\t\t\tshapes.push( tmpShape );\n\t\t\ttmpHoles = newShapeHoles[ i ];\n\n\t\t\tfor ( let j = 0, jl = tmpHoles.length; j < jl; j ++ ) {\n\n\t\t\t\ttmpShape.holes.push( tmpHoles[ j ].h );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//console.log(\"shape\", shapes);\n\n\t\treturn shapes;\n\n\t}\n\n}\n\nclass Controls extends EventDispatcher {\n\n\tconstructor( object, domElement = null ) {\n\n\t\tsuper();\n\n\t\tthis.object = object;\n\t\tthis.domElement = domElement;\n\n\t\tthis.enabled = true;\n\n\t\tthis.state = - 1;\n\n\t\tthis.keys = {};\n\t\tthis.mouseButtons = { LEFT: null, MIDDLE: null, RIGHT: null };\n\t\tthis.touches = { ONE: null, TWO: null };\n\n\t}\n\n\tconnect() {}\n\n\tdisconnect() {}\n\n\tdispose() {}\n\n\tupdate( /* delta */ ) {}\n\n}\n\nfunction contain( texture, aspect ) {\n\n\tconst imageAspect = ( texture.image && texture.image.width ) ? texture.image.width / texture.image.height : 1;\n\n\tif ( imageAspect > aspect ) {\n\n\t\ttexture.repeat.x = 1;\n\t\ttexture.repeat.y = imageAspect / aspect;\n\n\t\ttexture.offset.x = 0;\n\t\ttexture.offset.y = ( 1 - texture.repeat.y ) / 2;\n\n\t} else {\n\n\t\ttexture.repeat.x = aspect / imageAspect;\n\t\ttexture.repeat.y = 1;\n\n\t\ttexture.offset.x = ( 1 - texture.repeat.x ) / 2;\n\t\ttexture.offset.y = 0;\n\n\t}\n\n\treturn texture;\n\n}\n\nfunction cover( texture, aspect ) {\n\n\tconst imageAspect = ( texture.image && texture.image.width ) ? texture.image.width / texture.image.height : 1;\n\n\tif ( imageAspect > aspect ) {\n\n\t\ttexture.repeat.x = aspect / imageAspect;\n\t\ttexture.repeat.y = 1;\n\n\t\ttexture.offset.x = ( 1 - texture.repeat.x ) / 2;\n\t\ttexture.offset.y = 0;\n\n\t} else {\n\n\t\ttexture.repeat.x = 1;\n\t\ttexture.repeat.y = imageAspect / aspect;\n\n\t\ttexture.offset.x = 0;\n\t\ttexture.offset.y = ( 1 - texture.repeat.y ) / 2;\n\n\t}\n\n\treturn texture;\n\n}\n\nfunction fill( texture ) {\n\n\ttexture.repeat.x = 1;\n\ttexture.repeat.y = 1;\n\n\ttexture.offset.x = 0;\n\ttexture.offset.y = 0;\n\n\treturn texture;\n\n}\n\n\n\n/**\n * Given the width, height, format, and type of a texture. Determines how many\n * bytes must be used to represent the texture.\n */\nfunction getByteLength( width, height, format, type ) {\n\n\tconst typeByteLength = getTextureTypeByteLength( type );\n\n\tswitch ( format ) {\n\n\t\t// https://registry.khronos.org/OpenGL-Refpages/es3.0/html/glTexImage2D.xhtml\n\t\tcase AlphaFormat:\n\t\t\treturn width * height;\n\t\tcase LuminanceFormat:\n\t\t\treturn width * height;\n\t\tcase LuminanceAlphaFormat:\n\t\t\treturn width * height * 2;\n\t\tcase RedFormat:\n\t\t\treturn ( ( width * height ) / typeByteLength.components ) * typeByteLength.byteLength;\n\t\tcase RedIntegerFormat:\n\t\t\treturn ( ( width * height ) / typeByteLength.components ) * typeByteLength.byteLength;\n\t\tcase RGFormat:\n\t\t\treturn ( ( width * height * 2 ) / typeByteLength.components ) * typeByteLength.byteLength;\n\t\tcase RGIntegerFormat:\n\t\t\treturn ( ( width * height * 2 ) / typeByteLength.components ) * typeByteLength.byteLength;\n\t\tcase RGBFormat:\n\t\t\treturn ( ( width * height * 3 ) / typeByteLength.components ) * typeByteLength.byteLength;\n\t\tcase RGBAFormat:\n\t\t\treturn ( ( width * height * 4 ) / typeByteLength.components ) * typeByteLength.byteLength;\n\t\tcase RGBAIntegerFormat:\n\t\t\treturn ( ( width * height * 4 ) / typeByteLength.components ) * typeByteLength.byteLength;\n\n\t\t// https://registry.khronos.org/webgl/extensions/WEBGL_compressed_texture_s3tc_srgb/\n\t\tcase RGB_S3TC_DXT1_Format:\n\t\tcase RGBA_S3TC_DXT1_Format:\n\t\t\treturn Math.floor( ( width + 3 ) / 4 ) * Math.floor( ( height + 3 ) / 4 ) * 8;\n\t\tcase RGBA_S3TC_DXT3_Format:\n\t\tcase RGBA_S3TC_DXT5_Format:\n\t\t\treturn Math.floor( ( width + 3 ) / 4 ) * Math.floor( ( height + 3 ) / 4 ) * 16;\n\n\t\t// https://registry.khronos.org/webgl/extensions/WEBGL_compressed_texture_pvrtc/\n\t\tcase RGB_PVRTC_2BPPV1_Format:\n\t\tcase RGBA_PVRTC_2BPPV1_Format:\n\t\t\treturn ( Math.max( width, 16 ) * Math.max( height, 8 ) ) / 4;\n\t\tcase RGB_PVRTC_4BPPV1_Format:\n\t\tcase RGBA_PVRTC_4BPPV1_Format:\n\t\t\treturn ( Math.max( width, 8 ) * Math.max( height, 8 ) ) / 2;\n\n\t\t// https://registry.khronos.org/webgl/extensions/WEBGL_compressed_texture_etc/\n\t\tcase RGB_ETC1_Format:\n\t\tcase RGB_ETC2_Format:\n\t\t\treturn Math.floor( ( width + 3 ) / 4 ) * Math.floor( ( height + 3 ) / 4 ) * 8;\n\t\tcase RGBA_ETC2_EAC_Format:\n\t\t\treturn Math.floor( ( width + 3 ) / 4 ) * Math.floor( ( height + 3 ) / 4 ) * 16;\n\n\t\t// https://registry.khronos.org/webgl/extensions/WEBGL_compressed_texture_astc/\n\t\tcase RGBA_ASTC_4x4_Format:\n\t\t\treturn Math.floor( ( width + 3 ) / 4 ) * Math.floor( ( height + 3 ) / 4 ) * 16;\n\t\tcase RGBA_ASTC_5x4_Format:\n\t\t\treturn Math.floor( ( width + 4 ) / 5 ) * Math.floor( ( height + 3 ) / 4 ) * 16;\n\t\tcase RGBA_ASTC_5x5_Format:\n\t\t\treturn Math.floor( ( width + 4 ) / 5 ) * Math.floor( ( height + 4 ) / 5 ) * 16;\n\t\tcase RGBA_ASTC_6x5_Format:\n\t\t\treturn Math.floor( ( width + 5 ) / 6 ) * Math.floor( ( height + 4 ) / 5 ) * 16;\n\t\tcase RGBA_ASTC_6x6_Format:\n\t\t\treturn Math.floor( ( width + 5 ) / 6 ) * Math.floor( ( height + 5 ) / 6 ) * 16;\n\t\tcase RGBA_ASTC_8x5_Format:\n\t\t\treturn Math.floor( ( width + 7 ) / 8 ) * Math.floor( ( height + 4 ) / 5 ) * 16;\n\t\tcase RGBA_ASTC_8x6_Format:\n\t\t\treturn Math.floor( ( width + 7 ) / 8 ) * Math.floor( ( height + 5 ) / 6 ) * 16;\n\t\tcase RGBA_ASTC_8x8_Format:\n\t\t\treturn Math.floor( ( width + 7 ) / 8 ) * Math.floor( ( height + 7 ) / 8 ) * 16;\n\t\tcase RGBA_ASTC_10x5_Format:\n\t\t\treturn Math.floor( ( width + 9 ) / 10 ) * Math.floor( ( height + 4 ) / 5 ) * 16;\n\t\tcase RGBA_ASTC_10x6_Format:\n\t\t\treturn Math.floor( ( width + 9 ) / 10 ) * Math.floor( ( height + 5 ) / 6 ) * 16;\n\t\tcase RGBA_ASTC_10x8_Format:\n\t\t\treturn Math.floor( ( width + 9 ) / 10 ) * Math.floor( ( height + 7 ) / 8 ) * 16;\n\t\tcase RGBA_ASTC_10x10_Format:\n\t\t\treturn Math.floor( ( width + 9 ) / 10 ) * Math.floor( ( height + 9 ) / 10 ) * 16;\n\t\tcase RGBA_ASTC_12x10_Format:\n\t\t\treturn Math.floor( ( width + 11 ) / 12 ) * Math.floor( ( height + 9 ) / 10 ) * 16;\n\t\tcase RGBA_ASTC_12x12_Format:\n\t\t\treturn Math.floor( ( width + 11 ) / 12 ) * Math.floor( ( height + 11 ) / 12 ) * 16;\n\n\t\t// https://registry.khronos.org/webgl/extensions/EXT_texture_compression_bptc/\n\t\tcase RGBA_BPTC_Format:\n\t\tcase RGB_BPTC_SIGNED_Format:\n\t\tcase RGB_BPTC_UNSIGNED_Format:\n\t\t\treturn Math.ceil( width / 4 ) * Math.ceil( height / 4 ) * 16;\n\n\t\t// https://registry.khronos.org/webgl/extensions/EXT_texture_compression_rgtc/\n\t\tcase RED_RGTC1_Format:\n\t\tcase SIGNED_RED_RGTC1_Format:\n\t\t\treturn Math.ceil( width / 4 ) * Math.ceil( height / 4 ) * 8;\n\t\tcase RED_GREEN_RGTC2_Format:\n\t\tcase SIGNED_RED_GREEN_RGTC2_Format:\n\t\t\treturn Math.ceil( width / 4 ) * Math.ceil( height / 4 ) * 16;\n\n\t}\n\n\tthrow new Error(\n\t\t`Unable to determine texture byte length for ${format} format.`,\n\t);\n\n}\n\nfunction getTextureTypeByteLength( type ) {\n\n\tswitch ( type ) {\n\n\t\tcase UnsignedByteType:\n\t\tcase ByteType:\n\t\t\treturn { byteLength: 1, components: 1 };\n\t\tcase UnsignedShortType:\n\t\tcase ShortType:\n\t\tcase HalfFloatType:\n\t\t\treturn { byteLength: 2, components: 1 };\n\t\tcase UnsignedShort4444Type:\n\t\tcase UnsignedShort5551Type:\n\t\t\treturn { byteLength: 2, components: 4 };\n\t\tcase UnsignedIntType:\n\t\tcase IntType:\n\t\tcase FloatType:\n\t\t\treturn { byteLength: 4, components: 1 };\n\t\tcase UnsignedInt5999Type:\n\t\t\treturn { byteLength: 4, components: 3 };\n\n\t}\n\n\tthrow new Error( `Unknown texture type ${type}.` );\n\n}\n\nconst TextureUtils = {\n\tcontain,\n\tcover,\n\tfill,\n\tgetByteLength\n};\n\nclass WebGLMultipleRenderTargets extends WebGLRenderTarget { // @deprecated, r162\n\n\tconstructor( width = 1, height = 1, count = 1, options = {} ) {\n\n\t\tconsole.warn( 'THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the \"count\" parameter to enable MRT.' );\n\n\t\tsuper( width, height, { ...options, count } );\n\n\t\tthis.isWebGLMultipleRenderTargets = true;\n\n\t}\n\n\tget texture() {\n\n\t\treturn this.textures;\n\n\t}\n\n}\n\nif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\n\n\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'register', { detail: {\n\t\trevision: REVISION,\n\t} } ) );\n\n}\n\nif ( typeof window !== 'undefined' ) {\n\n\tif ( window.__THREE__ ) {\n\n\t\tconsole.warn( 'WARNING: Multiple instances of Three.js being imported.' );\n\n\t} else {\n\n\t\twindow.__THREE__ = REVISION;\n\n\t}\n\n}\n\nexport { ACESFilmicToneMapping, AddEquation, AddOperation, AdditiveAnimationBlendMode, AdditiveBlending, AgXToneMapping, AlphaFormat, AlwaysCompare, AlwaysDepth, AlwaysStencilFunc, AmbientLight, AnimationAction, AnimationClip, AnimationLoader, AnimationMixer, AnimationObjectGroup, AnimationUtils, ArcCurve, ArrayCamera, ArrowHelper, AttachedBindMode, Audio, AudioAnalyser, AudioContext, AudioListener, AudioLoader, AxesHelper, BackSide, BasicDepthPacking, BasicShadowMap, BatchedMesh, Bone, BooleanKeyframeTrack, Box2, Box3, Box3Helper, BoxGeometry, BoxHelper, BufferAttribute, BufferGeometry, BufferGeometryLoader, ByteType, Cache, Camera, CameraHelper, CanvasTexture, CapsuleGeometry, CatmullRomCurve3, CineonToneMapping, CircleGeometry, ClampToEdgeWrapping, Clock, Color, ColorKeyframeTrack, ColorManagement, CompressedArrayTexture, CompressedCubeTexture, CompressedTexture, CompressedTextureLoader, ConeGeometry, ConstantAlphaFactor, ConstantColorFactor, Controls, CubeCamera, CubeReflectionMapping, CubeRefractionMapping, CubeTexture, CubeTextureLoader, CubeUVReflectionMapping, CubicBezierCurve, CubicBezierCurve3, CubicInterpolant, CullFaceBack, CullFaceFront, CullFaceFrontBack, CullFaceNone, Curve, CurvePath, CustomBlending, CustomToneMapping, CylinderGeometry, Cylindrical, Data3DTexture, DataArrayTexture, DataTexture, DataTextureLoader, DataUtils, DecrementStencilOp, DecrementWrapStencilOp, DefaultLoadingManager, DepthFormat, DepthStencilFormat, DepthTexture, DetachedBindMode, DirectionalLight, DirectionalLightHelper, DiscreteInterpolant, DodecahedronGeometry, DoubleSide, DstAlphaFactor, DstColorFactor, DynamicCopyUsage, DynamicDrawUsage, DynamicReadUsage, EdgesGeometry, EllipseCurve, EqualCompare, EqualDepth, EqualStencilFunc, EquirectangularReflectionMapping, EquirectangularRefractionMapping, Euler, EventDispatcher, ExtrudeGeometry, FileLoader, Float16BufferAttribute, Float32BufferAttribute, FloatType, Fog, FogExp2, FramebufferTexture, FrontSide, Frustum, GLBufferAttribute, GLSL1, GLSL3, GreaterCompare, GreaterDepth, GreaterEqualCompare, GreaterEqualDepth, GreaterEqualStencilFunc, GreaterStencilFunc, GridHelper, Group, HalfFloatType, HemisphereLight, HemisphereLightHelper, IcosahedronGeometry, ImageBitmapLoader, ImageLoader, ImageUtils, IncrementStencilOp, IncrementWrapStencilOp, InstancedBufferAttribute, InstancedBufferGeometry, InstancedInterleavedBuffer, InstancedMesh, Int16BufferAttribute, Int32BufferAttribute, Int8BufferAttribute, IntType, InterleavedBuffer, InterleavedBufferAttribute, Interpolant, InterpolateDiscrete, InterpolateLinear, InterpolateSmooth, InvertStencilOp, KeepStencilOp, KeyframeTrack, LOD, LatheGeometry, Layers, LessCompare, LessDepth, LessEqualCompare, LessEqualDepth, LessEqualStencilFunc, LessStencilFunc, Light, LightProbe, Line, Line3, LineBasicMaterial, LineCurve, LineCurve3, LineDashedMaterial, LineLoop, LineSegments, LinearFilter, LinearInterpolant, LinearMipMapLinearFilter, LinearMipMapNearestFilter, LinearMipmapLinearFilter, LinearMipmapNearestFilter, LinearSRGBColorSpace, LinearToneMapping, LinearTransfer, Loader, LoaderUtils, LoadingManager, LoopOnce, LoopPingPong, LoopRepeat, LuminanceAlphaFormat, LuminanceFormat, MOUSE, Material, MaterialLoader, MathUtils, Matrix2, Matrix3, Matrix4, MaxEquation, Mesh, MeshBasicMaterial, MeshDepthMaterial, MeshDistanceMaterial, MeshLambertMaterial, MeshMatcapMaterial, MeshNormalMaterial, MeshPhongMaterial, MeshPhysicalMaterial, MeshStandardMaterial, MeshToonMaterial, MinEquation, MirroredRepeatWrapping, MixOperation, MultiplyBlending, MultiplyOperation, NearestFilter, NearestMipMapLinearFilter, NearestMipMapNearestFilter, NearestMipmapLinearFilter, NearestMipmapNearestFilter, NeutralToneMapping, NeverCompare, NeverDepth, NeverStencilFunc, NoBlending, NoColorSpace, NoToneMapping, NormalAnimationBlendMode, NormalBlending, NotEqualCompare, NotEqualDepth, NotEqualStencilFunc, NumberKeyframeTrack, Object3D, ObjectLoader, ObjectSpaceNormalMap, OctahedronGeometry, OneFactor, OneMinusConstantAlphaFactor, OneMinusConstantColorFactor, OneMinusDstAlphaFactor, OneMinusDstColorFactor, OneMinusSrcAlphaFactor, OneMinusSrcColorFactor, OrthographicCamera, PCFShadowMap, PCFSoftShadowMap, Path, PerspectiveCamera, Plane, PlaneGeometry, PlaneHelper, PointLight, PointLightHelper, Points, PointsMaterial, PolarGridHelper, PolyhedronGeometry, PositionalAudio, PropertyBinding, PropertyMixer, QuadraticBezierCurve, QuadraticBezierCurve3, Quaternion, QuaternionKeyframeTrack, QuaternionLinearInterpolant, RAD2DEG, RED_GREEN_RGTC2_Format, RED_RGTC1_Format, REVISION, RGBADepthPacking, RGBAFormat, RGBAIntegerFormat, RGBA_ASTC_10x10_Format, RGBA_ASTC_10x5_Format, RGBA_ASTC_10x6_Format, RGBA_ASTC_10x8_Format, RGBA_ASTC_12x10_Format, RGBA_ASTC_12x12_Format, RGBA_ASTC_4x4_Format, RGBA_ASTC_5x4_Format, RGBA_ASTC_5x5_Format, RGBA_ASTC_6x5_Format, RGBA_ASTC_6x6_Format, RGBA_ASTC_8x5_Format, RGBA_ASTC_8x6_Format, RGBA_ASTC_8x8_Format, RGBA_BPTC_Format, RGBA_ETC2_EAC_Format, RGBA_PVRTC_2BPPV1_Format, RGBA_PVRTC_4BPPV1_Format, RGBA_S3TC_DXT1_Format, RGBA_S3TC_DXT3_Format, RGBA_S3TC_DXT5_Format, RGBDepthPacking, RGBFormat, RGBIntegerFormat, RGB_BPTC_SIGNED_Format, RGB_BPTC_UNSIGNED_Format, RGB_ETC1_Format, RGB_ETC2_Format, RGB_PVRTC_2BPPV1_Format, RGB_PVRTC_4BPPV1_Format, RGB_S3TC_DXT1_Format, RGDepthPacking, RGFormat, RGIntegerFormat, RawShaderMaterial, Ray, Raycaster, RectAreaLight, RedFormat, RedIntegerFormat, ReinhardToneMapping, RenderTarget, RepeatWrapping, ReplaceStencilOp, ReverseSubtractEquation, RingGeometry, SIGNED_RED_GREEN_RGTC2_Format, SIGNED_RED_RGTC1_Format, SRGBColorSpace, SRGBTransfer, Scene, ShaderMaterial, ShadowMaterial, Shape, ShapeGeometry, ShapePath, ShapeUtils, ShortType, Skeleton, SkeletonHelper, SkinnedMesh, Source, Sphere, SphereGeometry, Spherical, SphericalHarmonics3, SplineCurve, SpotLight, SpotLightHelper, Sprite, SpriteMaterial, SrcAlphaFactor, SrcAlphaSaturateFactor, SrcColorFactor, StaticCopyUsage, StaticDrawUsage, StaticReadUsage, StereoCamera, StreamCopyUsage, StreamDrawUsage, StreamReadUsage, StringKeyframeTrack, SubtractEquation, SubtractiveBlending, TOUCH, TangentSpaceNormalMap, TetrahedronGeometry, Texture, TextureLoader, TextureUtils, TorusGeometry, TorusKnotGeometry, Triangle, TriangleFanDrawMode, TriangleStripDrawMode, TrianglesDrawMode, TubeGeometry, UVMapping, Uint16BufferAttribute, Uint32BufferAttribute, Uint8BufferAttribute, Uint8ClampedBufferAttribute, Uniform, UniformsGroup, UniformsUtils, UnsignedByteType, UnsignedInt248Type, UnsignedInt5999Type, UnsignedIntType, UnsignedShort4444Type, UnsignedShort5551Type, UnsignedShortType, VSMShadowMap, Vector2, Vector3, Vector4, VectorKeyframeTrack, VideoTexture, WebGL3DRenderTarget, WebGLArrayRenderTarget, WebGLCoordinateSystem, WebGLCubeRenderTarget, WebGLMultipleRenderTargets, WebGLRenderTarget, WebGPUCoordinateSystem, WireframeGeometry, WrapAroundEnding, ZeroCurvatureEnding, ZeroFactor, ZeroSlopeEnding, ZeroStencilOp, arrayNeedsUint32, cloneUniforms, createCanvasElement, createElementNS, getByteLength, getUnlitUniformColorSpace, mergeUniforms, probeAsync, toNormalizedProjectionMatrix, toReversedProjectionMatrix, warnOnce };\n","/**\n * @license\n * Copyright 2010-2024 Three.js Authors\n * SPDX-License-Identifier: MIT\n */\nimport { Color, Vector2, Vector3, Vector4, Matrix3, Matrix4, EventDispatcher, MathUtils, ColorManagement, SRGBTransfer, NoToneMapping, StaticDrawUsage, InterleavedBuffer, DynamicDrawUsage, InterleavedBufferAttribute, NoColorSpace, UnsignedIntType, IntType, WebGLCoordinateSystem, BackSide, CubeReflectionMapping, CubeRefractionMapping, WebGPUCoordinateSystem, TangentSpaceNormalMap, ObjectSpaceNormalMap, InstancedInterleavedBuffer, InstancedBufferAttribute, DataArrayTexture, FloatType, FramebufferTexture, LinearMipmapLinearFilter, DepthTexture, Material, NormalBlending, PointsMaterial, LineBasicMaterial, LineDashedMaterial, NoBlending, MeshNormalMaterial, WebGLCubeRenderTarget, BoxGeometry, Mesh, Scene, LinearFilter, CubeCamera, CubeTexture, EquirectangularReflectionMapping, EquirectangularRefractionMapping, AddOperation, MixOperation, MultiplyOperation, MeshBasicMaterial, MeshLambertMaterial, MeshPhongMaterial, Texture, MeshStandardMaterial, MeshPhysicalMaterial, MeshToonMaterial, MeshMatcapMaterial, SpriteMaterial, ShadowMaterial, Uint32BufferAttribute, Uint16BufferAttribute, DoubleSide, DepthStencilFormat, DepthFormat, UnsignedInt248Type, UnsignedByteType, RenderTarget, Plane, Object3D, HalfFloatType, LinearMipMapLinearFilter, OrthographicCamera, BufferGeometry, Float32BufferAttribute, BufferAttribute, UVMapping, Euler, LinearSRGBColorSpace, LessCompare, VSMShadowMap, RGFormat, BasicShadowMap, SphereGeometry, CubeUVReflectionMapping, PerspectiveCamera, RGBAFormat, LinearMipmapNearestFilter, NearestMipmapLinearFilter, Float16BufferAttribute, REVISION, SRGBColorSpace, PCFShadowMap, FrontSide, Frustum, DataTexture, RedIntegerFormat, RedFormat, RGIntegerFormat, RGBIntegerFormat, RGBFormat, RGBAIntegerFormat, UnsignedShortType, ByteType, ShortType, createCanvasElement, AddEquation, SubtractEquation, ReverseSubtractEquation, ZeroFactor, OneFactor, SrcColorFactor, SrcAlphaFactor, SrcAlphaSaturateFactor, DstColorFactor, DstAlphaFactor, OneMinusSrcColorFactor, OneMinusSrcAlphaFactor, OneMinusDstColorFactor, OneMinusDstAlphaFactor, CullFaceNone, CullFaceBack, CullFaceFront, CustomBlending, MultiplyBlending, SubtractiveBlending, AdditiveBlending, NotEqualDepth, GreaterDepth, GreaterEqualDepth, EqualDepth, LessEqualDepth, LessDepth, AlwaysDepth, NeverDepth, UnsignedShort4444Type, UnsignedShort5551Type, UnsignedInt5999Type, AlphaFormat, LuminanceFormat, LuminanceAlphaFormat, RGB_S3TC_DXT1_Format, RGBA_S3TC_DXT1_Format, RGBA_S3TC_DXT3_Format, RGBA_S3TC_DXT5_Format, RGB_PVRTC_4BPPV1_Format, RGB_PVRTC_2BPPV1_Format, RGBA_PVRTC_4BPPV1_Format, RGBA_PVRTC_2BPPV1_Format, RGB_ETC1_Format, RGB_ETC2_Format, RGBA_ETC2_EAC_Format, RGBA_ASTC_4x4_Format, RGBA_ASTC_5x4_Format, RGBA_ASTC_5x5_Format, RGBA_ASTC_6x5_Format, RGBA_ASTC_6x6_Format, RGBA_ASTC_8x5_Format, RGBA_ASTC_8x6_Format, RGBA_ASTC_8x8_Format, RGBA_ASTC_10x5_Format, RGBA_ASTC_10x6_Format, RGBA_ASTC_10x8_Format, RGBA_ASTC_10x10_Format, RGBA_ASTC_12x10_Format, RGBA_ASTC_12x12_Format, RGBA_BPTC_Format, RED_RGTC1_Format, SIGNED_RED_RGTC1_Format, RED_GREEN_RGTC2_Format, SIGNED_RED_GREEN_RGTC2_Format, RepeatWrapping, ClampToEdgeWrapping, MirroredRepeatWrapping, NearestFilter, NearestMipmapNearestFilter, NeverCompare, AlwaysCompare, LessEqualCompare, EqualCompare, GreaterEqualCompare, GreaterCompare, NotEqualCompare, warnOnce, NotEqualStencilFunc, GreaterStencilFunc, GreaterEqualStencilFunc, EqualStencilFunc, LessEqualStencilFunc, LessStencilFunc, AlwaysStencilFunc, NeverStencilFunc, DecrementWrapStencilOp, IncrementWrapStencilOp, DecrementStencilOp, IncrementStencilOp, InvertStencilOp, ReplaceStencilOp, ZeroStencilOp, KeepStencilOp, MaxEquation, MinEquation, SpotLight, PointLight, DirectionalLight, RectAreaLight, AmbientLight, HemisphereLight, LightProbe, LinearToneMapping, ReinhardToneMapping, CineonToneMapping, ACESFilmicToneMapping, AgXToneMapping, NeutralToneMapping, Group, Loader, FileLoader, MaterialLoader, ObjectLoader } from './three.core.js';\nexport { AdditiveAnimationBlendMode, AnimationAction, AnimationClip, AnimationLoader, AnimationMixer, AnimationObjectGroup, AnimationUtils, ArcCurve, ArrayCamera, ArrowHelper, AttachedBindMode, Audio, AudioAnalyser, AudioContext, AudioListener, AudioLoader, AxesHelper, BasicDepthPacking, BatchedMesh, Bone, BooleanKeyframeTrack, Box2, Box3, Box3Helper, BoxHelper, BufferGeometryLoader, Cache, Camera, CameraHelper, CanvasTexture, CapsuleGeometry, CatmullRomCurve3, CircleGeometry, Clock, ColorKeyframeTrack, CompressedArrayTexture, CompressedCubeTexture, CompressedTexture, CompressedTextureLoader, ConeGeometry, ConstantAlphaFactor, ConstantColorFactor, Controls, CubeTextureLoader, CubicBezierCurve, CubicBezierCurve3, CubicInterpolant, CullFaceFrontBack, Curve, CurvePath, CustomToneMapping, CylinderGeometry, Cylindrical, Data3DTexture, DataTextureLoader, DataUtils, DefaultLoadingManager, DetachedBindMode, DirectionalLightHelper, DiscreteInterpolant, DodecahedronGeometry, DynamicCopyUsage, DynamicReadUsage, EdgesGeometry, EllipseCurve, ExtrudeGeometry, Fog, FogExp2, GLBufferAttribute, GLSL1, GLSL3, GridHelper, HemisphereLightHelper, IcosahedronGeometry, ImageBitmapLoader, ImageLoader, ImageUtils, InstancedBufferGeometry, InstancedMesh, Int16BufferAttribute, Int32BufferAttribute, Int8BufferAttribute, Interpolant, InterpolateDiscrete, InterpolateLinear, InterpolateSmooth, KeyframeTrack, LOD, LatheGeometry, Layers, Light, Line, Line3, LineCurve, LineCurve3, LineLoop, LineSegments, LinearInterpolant, LinearMipMapNearestFilter, LinearTransfer, LoaderUtils, LoadingManager, LoopOnce, LoopPingPong, LoopRepeat, MOUSE, Matrix2, MeshDepthMaterial, MeshDistanceMaterial, NearestMipMapLinearFilter, NearestMipMapNearestFilter, NormalAnimationBlendMode, NumberKeyframeTrack, OctahedronGeometry, OneMinusConstantAlphaFactor, OneMinusConstantColorFactor, PCFSoftShadowMap, Path, PlaneGeometry, PlaneHelper, PointLightHelper, Points, PolarGridHelper, PolyhedronGeometry, PositionalAudio, PropertyBinding, PropertyMixer, QuadraticBezierCurve, QuadraticBezierCurve3, Quaternion, QuaternionKeyframeTrack, QuaternionLinearInterpolant, RGBADepthPacking, RGBDepthPacking, RGB_BPTC_SIGNED_Format, RGB_BPTC_UNSIGNED_Format, RGDepthPacking, RawShaderMaterial, Ray, Raycaster, RingGeometry, ShaderMaterial, Shape, ShapeGeometry, ShapePath, ShapeUtils, Skeleton, SkeletonHelper, SkinnedMesh, Source, Sphere, Spherical, SphericalHarmonics3, SplineCurve, SpotLightHelper, Sprite, StaticCopyUsage, StaticReadUsage, StereoCamera, StreamCopyUsage, StreamDrawUsage, StreamReadUsage, StringKeyframeTrack, TOUCH, TetrahedronGeometry, TextureLoader, TextureUtils, TorusGeometry, TorusKnotGeometry, Triangle, TriangleFanDrawMode, TriangleStripDrawMode, TrianglesDrawMode, TubeGeometry, Uint8BufferAttribute, Uint8ClampedBufferAttribute, Uniform, UniformsGroup, VectorKeyframeTrack, VideoTexture, WebGL3DRenderTarget, WebGLArrayRenderTarget, WebGLMultipleRenderTargets, WebGLRenderTarget, WireframeGeometry, WrapAroundEnding, ZeroCurvatureEnding, ZeroSlopeEnding } from './three.core.js';\n\nconst refreshUniforms = [\n\t'alphaMap',\n\t'alphaTest',\n\t'anisotropy',\n\t'anisotropyMap',\n\t'anisotropyRotation',\n\t'aoMap',\n\t'attenuationColor',\n\t'attenuationDistance',\n\t'bumpMap',\n\t'clearcoat',\n\t'clearcoatMap',\n\t'clearcoatNormalMap',\n\t'clearcoatNormalScale',\n\t'clearcoatRoughness',\n\t'color',\n\t'dispersion',\n\t'displacementMap',\n\t'emissive',\n\t'emissiveMap',\n\t'envMap',\n\t'gradientMap',\n\t'ior',\n\t'iridescence',\n\t'iridescenceIOR',\n\t'iridescenceMap',\n\t'iridescenceThicknessMap',\n\t'lightMap',\n\t'map',\n\t'matcap',\n\t'metalness',\n\t'metalnessMap',\n\t'normalMap',\n\t'normalScale',\n\t'opacity',\n\t'roughness',\n\t'roughnessMap',\n\t'sheen',\n\t'sheenColor',\n\t'sheenColorMap',\n\t'sheenRoughnessMap',\n\t'shininess',\n\t'specular',\n\t'specularColor',\n\t'specularColorMap',\n\t'specularIntensity',\n\t'specularIntensityMap',\n\t'specularMap',\n\t'thickness',\n\t'transmission',\n\t'transmissionMap'\n];\n\nclass NodeMaterialObserver {\n\n\tconstructor( builder ) {\n\n\t\tthis.renderObjects = new WeakMap();\n\t\tthis.hasNode = this.containsNode( builder );\n\t\tthis.hasAnimation = builder.object.isSkinnedMesh === true;\n\t\tthis.refreshUniforms = refreshUniforms;\n\t\tthis.renderId = 0;\n\n\t}\n\n\tfirstInitialization( renderObject ) {\n\n\t\tconst hasInitialized = this.renderObjects.has( renderObject );\n\n\t\tif ( hasInitialized === false ) {\n\n\t\t\tthis.getRenderObjectData( renderObject );\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tgetRenderObjectData( renderObject ) {\n\n\t\tlet data = this.renderObjects.get( renderObject );\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconst { geometry, material, object } = renderObject;\n\n\t\t\tdata = {\n\t\t\t\tmaterial: this.getMaterialData( material ),\n\t\t\t\tgeometry: {\n\t\t\t\t\tattributes: this.getAttributesData( geometry.attributes ),\n\t\t\t\t\tindexVersion: geometry.index ? geometry.index.version : null,\n\t\t\t\t\tdrawRange: { start: geometry.drawRange.start, count: geometry.drawRange.count }\n\t\t\t\t},\n\t\t\t\tworldMatrix: object.matrixWorld.clone()\n\t\t\t};\n\n\t\t\tif ( object.center ) {\n\n\t\t\t\tdata.center = object.center.clone();\n\n\t\t\t}\n\n\t\t\tif ( object.morphTargetInfluences ) {\n\n\t\t\t\tdata.morphTargetInfluences = object.morphTargetInfluences.slice();\n\n\t\t\t}\n\n\t\t\tif ( renderObject.bundle !== null ) {\n\n\t\t\t\tdata.version = renderObject.bundle.version;\n\n\t\t\t}\n\n\t\t\tif ( data.material.transmission > 0 ) {\n\n\t\t\t\tconst { width, height } = renderObject.context;\n\n\t\t\t\tdata.bufferWidth = width;\n\t\t\t\tdata.bufferHeight = height;\n\n\t\t\t}\n\n\t\t\tthis.renderObjects.set( renderObject, data );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tgetAttributesData( attributes ) {\n\n\t\tconst attributesData = {};\n\n\t\tfor ( const name in attributes ) {\n\n\t\t\tconst attribute = attributes[ name ];\n\n\t\t\tattributesData[ name ] = {\n\t\t\t\tversion: attribute.version\n\t\t\t};\n\n\t\t}\n\n\t\treturn attributesData;\n\n\t}\n\n\tcontainsNode( builder ) {\n\n\t\tconst material = builder.material;\n\n\t\tfor ( const property in material ) {\n\n\t\t\tif ( material[ property ] && material[ property ].isNode )\n\t\t\t\treturn true;\n\n\t\t}\n\n\t\tif ( builder.renderer.nodes.modelViewMatrix !== null || builder.renderer.nodes.modelNormalViewMatrix !== null )\n\t\t\treturn true;\n\n\t\treturn false;\n\n\t}\n\n\tgetMaterialData( material ) {\n\n\t\tconst data = {};\n\n\t\tfor ( const property of this.refreshUniforms ) {\n\n\t\t\tconst value = material[ property ];\n\n\t\t\tif ( value === null || value === undefined ) continue;\n\n\t\t\tif ( typeof value === 'object' && value.clone !== undefined ) {\n\n\t\t\t\tif ( value.isTexture === true ) {\n\n\t\t\t\t\tdata[ property ] = { id: value.id, version: value.version };\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdata[ property ] = value.clone();\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tdata[ property ] = value;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tequals( renderObject ) {\n\n\t\tconst { object, material, geometry } = renderObject;\n\n\t\tconst renderObjectData = this.getRenderObjectData( renderObject );\n\n\t\t// world matrix\n\n\t\tif ( renderObjectData.worldMatrix.equals( object.matrixWorld ) !== true ) {\n\n\t\t\trenderObjectData.worldMatrix.copy( object.matrixWorld );\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// material\n\n\t\tconst materialData = renderObjectData.material;\n\n\t\tfor ( const property in materialData ) {\n\n\t\t\tconst value = materialData[ property ];\n\t\t\tconst mtlValue = material[ property ];\n\n\t\t\tif ( value.equals !== undefined ) {\n\n\t\t\t\tif ( value.equals( mtlValue ) === false ) {\n\n\t\t\t\t\tvalue.copy( mtlValue );\n\n\t\t\t\t\treturn false;\n\n\t\t\t\t}\n\n\t\t\t} else if ( mtlValue.isTexture === true ) {\n\n\t\t\t\tif ( value.id !== mtlValue.id || value.version !== mtlValue.version ) {\n\n\t\t\t\t\tvalue.id = mtlValue.id;\n\t\t\t\t\tvalue.version = mtlValue.version;\n\n\t\t\t\t\treturn false;\n\n\t\t\t\t}\n\n\t\t\t} else if ( value !== mtlValue ) {\n\n\t\t\t\tmaterialData[ property ] = mtlValue;\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialData.transmission > 0 ) {\n\n\t\t\tconst { width, height } = renderObject.context;\n\n\t\t\tif ( renderObjectData.bufferWidth !== width || renderObjectData.bufferHeight !== height ) {\n\n\t\t\t\trenderObjectData.bufferWidth = width;\n\t\t\t\trenderObjectData.bufferHeight = height;\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// geometry\n\n\t\tconst storedGeometryData = renderObjectData.geometry;\n\t\tconst attributes = geometry.attributes;\n\t\tconst storedAttributes = storedGeometryData.attributes;\n\n\t\tconst storedAttributeNames = Object.keys( storedAttributes );\n\t\tconst currentAttributeNames = Object.keys( attributes );\n\n\t\tif ( storedAttributeNames.length !== currentAttributeNames.length ) {\n\n\t\t\trenderObjectData.geometry.attributes = this.getAttributesData( attributes );\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// compare each attribute\n\n\t\tfor ( const name of storedAttributeNames ) {\n\n\t\t\tconst storedAttributeData = storedAttributes[ name ];\n\t\t\tconst attribute = attributes[ name ];\n\n\t\t\tif ( attribute === undefined ) {\n\n\t\t\t\t// attribute was removed\n\t\t\t\tdelete storedAttributes[ name ];\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t\tif ( storedAttributeData.version !== attribute.version ) {\n\n\t\t\t\tstoredAttributeData.version = attribute.version;\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// check index\n\n\t\tconst index = geometry.index;\n\t\tconst storedIndexVersion = storedGeometryData.indexVersion;\n\t\tconst currentIndexVersion = index ? index.version : null;\n\n\t\tif ( storedIndexVersion !== currentIndexVersion ) {\n\n\t\t\tstoredGeometryData.indexVersion = currentIndexVersion;\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// check drawRange\n\n\t\tif ( storedGeometryData.drawRange.start !== geometry.drawRange.start || storedGeometryData.drawRange.count !== geometry.drawRange.count ) {\n\n\t\t\tstoredGeometryData.drawRange.start = geometry.drawRange.start;\n\t\t\tstoredGeometryData.drawRange.count = geometry.drawRange.count;\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// morph targets\n\n\t\tif ( renderObjectData.morphTargetInfluences ) {\n\n\t\t\tlet morphChanged = false;\n\n\t\t\tfor ( let i = 0; i < renderObjectData.morphTargetInfluences.length; i ++ ) {\n\n\t\t\t\tif ( renderObjectData.morphTargetInfluences[ i ] !== object.morphTargetInfluences[ i ] ) {\n\n\t\t\t\t\tmorphChanged = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( morphChanged ) return true;\n\n\t\t}\n\n\t\t// center\n\n\t\tif ( renderObjectData.center ) {\n\n\t\t\tif ( renderObjectData.center.equals( object.center ) === false ) {\n\n\t\t\t\trenderObjectData.center.copy( object.center );\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// bundle\n\n\t\tif ( renderObject.bundle !== null ) {\n\n\t\t\trenderObjectData.version = renderObject.bundle.version;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tneedsRefresh( renderObject, nodeFrame ) {\n\n\t\tif ( this.hasNode || this.hasAnimation || this.firstInitialization( renderObject ) )\n\t\t\treturn true;\n\n\t\tconst { renderId } = nodeFrame;\n\n\t\tif ( this.renderId !== renderId ) {\n\n\t\t\tthis.renderId = renderId;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\tconst isStatic = renderObject.object.static === true;\n\t\tconst isBundle = renderObject.bundle !== null && renderObject.bundle.static === true && this.getRenderObjectData( renderObject ).version === renderObject.bundle.version;\n\n\t\tif ( isStatic || isBundle )\n\t\t\treturn false;\n\n\t\tconst notEqual = this.equals( renderObject ) !== true;\n\n\t\treturn notEqual;\n\n\t}\n\n}\n\n// cyrb53 (c) 2018 bryc (github.com/bryc). License: Public domain. Attribution appreciated.\n// A fast and simple 64-bit (or 53-bit) string hash function with decent collision resistance.\n// Largely inspired by MurmurHash2/3, but with a focus on speed/simplicity.\n// See https://stackoverflow.com/questions/7616461/generate-a-hash-from-string-in-javascript/52171480#52171480\n// https://github.com/bryc/code/blob/master/jshash/experimental/cyrb53.js\nfunction cyrb53( value, seed = 0 ) {\n\n\tlet h1 = 0xdeadbeef ^ seed, h2 = 0x41c6ce57 ^ seed;\n\n\tif ( value instanceof Array ) {\n\n\t\tfor ( let i = 0, val; i < value.length; i ++ ) {\n\n\t\t\tval = value[ i ];\n\t\t\th1 = Math.imul( h1 ^ val, 2654435761 );\n\t\t\th2 = Math.imul( h2 ^ val, 1597334677 );\n\n\t\t}\n\n\t} else {\n\n\t\tfor ( let i = 0, ch; i < value.length; i ++ ) {\n\n\t\t\tch = value.charCodeAt( i );\n\t\t\th1 = Math.imul( h1 ^ ch, 2654435761 );\n\t\t\th2 = Math.imul( h2 ^ ch, 1597334677 );\n\n\t\t}\n\n\t}\n\n\th1 = Math.imul( h1 ^ ( h1 >>> 16 ), 2246822507 );\n\th1 ^= Math.imul( h2 ^ ( h2 >>> 13 ), 3266489909 );\n\th2 = Math.imul( h2 ^ ( h2 >>> 16 ), 2246822507 );\n\th2 ^= Math.imul( h1 ^ ( h1 >>> 13 ), 3266489909 );\n\n\treturn 4294967296 * ( 2097151 & h2 ) + ( h1 >>> 0 );\n\n}\n\nconst hashString = ( str ) => cyrb53( str );\nconst hashArray = ( array ) => cyrb53( array );\nconst hash$1 = ( ...params ) => cyrb53( params );\n\nfunction getCacheKey$1( object, force = false ) {\n\n\tconst values = [];\n\n\tif ( object.isNode === true ) {\n\n\t\tvalues.push( object.id );\n\t\tobject = object.getSelf();\n\n\t}\n\n\tfor ( const { property, childNode } of getNodeChildren( object ) ) {\n\n\t\tvalues.push( values, cyrb53( property.slice( 0, - 4 ) ), childNode.getCacheKey( force ) );\n\n\t}\n\n\treturn cyrb53( values );\n\n}\n\nfunction* getNodeChildren( node, toJSON = false ) {\n\n\tfor ( const property in node ) {\n\n\t\t// Ignore private properties.\n\t\tif ( property.startsWith( '_' ) === true ) continue;\n\n\t\tconst object = node[ property ];\n\n\t\tif ( Array.isArray( object ) === true ) {\n\n\t\t\tfor ( let i = 0; i < object.length; i ++ ) {\n\n\t\t\t\tconst child = object[ i ];\n\n\t\t\t\tif ( child && ( child.isNode === true || toJSON && typeof child.toJSON === 'function' ) ) {\n\n\t\t\t\t\tyield { property, index: i, childNode: child };\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( object && object.isNode === true ) {\n\n\t\t\tyield { property, childNode: object };\n\n\t\t} else if ( typeof object === 'object' ) {\n\n\t\t\tfor ( const subProperty in object ) {\n\n\t\t\t\tconst child = object[ subProperty ];\n\n\t\t\t\tif ( child && ( child.isNode === true || toJSON && typeof child.toJSON === 'function' ) ) {\n\n\t\t\t\t\tyield { property, index: subProperty, childNode: child };\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nconst typeFromLength = /*@__PURE__*/ new Map( [\n\t[ 1, 'float' ],\n\t[ 2, 'vec2' ],\n\t[ 3, 'vec3' ],\n\t[ 4, 'vec4' ],\n\t[ 9, 'mat3' ],\n\t[ 16, 'mat4' ]\n] );\n\nfunction getTypeFromLength( length ) {\n\n\treturn typeFromLength.get( length );\n\n}\n\nfunction getLengthFromType( type ) {\n\n\tif ( /float|int|uint/.test( type ) ) return 1;\n\tif ( /vec2/.test( type ) ) return 2;\n\tif ( /vec3/.test( type ) ) return 3;\n\tif ( /vec4/.test( type ) ) return 4;\n\tif ( /mat3/.test( type ) ) return 9;\n\tif ( /mat4/.test( type ) ) return 16;\n\n\tconsole.error( 'THREE.TSL: Unsupported type:', type );\n\n}\n\nfunction getValueType( value ) {\n\n\tif ( value === undefined || value === null ) return null;\n\n\tconst typeOf = typeof value;\n\n\tif ( value.isNode === true ) {\n\n\t\treturn 'node';\n\n\t} else if ( typeOf === 'number' ) {\n\n\t\treturn 'float';\n\n\t} else if ( typeOf === 'boolean' ) {\n\n\t\treturn 'bool';\n\n\t} else if ( typeOf === 'string' ) {\n\n\t\treturn 'string';\n\n\t} else if ( typeOf === 'function' ) {\n\n\t\treturn 'shader';\n\n\t} else if ( value.isVector2 === true ) {\n\n\t\treturn 'vec2';\n\n\t} else if ( value.isVector3 === true ) {\n\n\t\treturn 'vec3';\n\n\t} else if ( value.isVector4 === true ) {\n\n\t\treturn 'vec4';\n\n\t} else if ( value.isMatrix3 === true ) {\n\n\t\treturn 'mat3';\n\n\t} else if ( value.isMatrix4 === true ) {\n\n\t\treturn 'mat4';\n\n\t} else if ( value.isColor === true ) {\n\n\t\treturn 'color';\n\n\t} else if ( value instanceof ArrayBuffer ) {\n\n\t\treturn 'ArrayBuffer';\n\n\t}\n\n\treturn null;\n\n}\n\nfunction getValueFromType( type, ...params ) {\n\n\tconst last4 = type ? type.slice( - 4 ) : undefined;\n\n\tif ( params.length === 1 ) { // ensure same behaviour as in NodeBuilder.format()\n\n\t\tif ( last4 === 'vec2' ) params = [ params[ 0 ], params[ 0 ] ];\n\t\telse if ( last4 === 'vec3' ) params = [ params[ 0 ], params[ 0 ], params[ 0 ] ];\n\t\telse if ( last4 === 'vec4' ) params = [ params[ 0 ], params[ 0 ], params[ 0 ], params[ 0 ] ];\n\n\t}\n\n\tif ( type === 'color' ) {\n\n\t\treturn new Color( ...params );\n\n\t} else if ( last4 === 'vec2' ) {\n\n\t\treturn new Vector2( ...params );\n\n\t} else if ( last4 === 'vec3' ) {\n\n\t\treturn new Vector3( ...params );\n\n\t} else if ( last4 === 'vec4' ) {\n\n\t\treturn new Vector4( ...params );\n\n\t} else if ( last4 === 'mat3' ) {\n\n\t\treturn new Matrix3( ...params );\n\n\t} else if ( last4 === 'mat4' ) {\n\n\t\treturn new Matrix4( ...params );\n\n\t} else if ( type === 'bool' ) {\n\n\t\treturn params[ 0 ] || false;\n\n\t} else if ( ( type === 'float' ) || ( type === 'int' ) || ( type === 'uint' ) ) {\n\n\t\treturn params[ 0 ] || 0;\n\n\t} else if ( type === 'string' ) {\n\n\t\treturn params[ 0 ] || '';\n\n\t} else if ( type === 'ArrayBuffer' ) {\n\n\t\treturn base64ToArrayBuffer( params[ 0 ] );\n\n\t}\n\n\treturn null;\n\n}\n\nfunction arrayBufferToBase64( arrayBuffer ) {\n\n\tlet chars = '';\n\n\tconst array = new Uint8Array( arrayBuffer );\n\n\tfor ( let i = 0; i < array.length; i ++ ) {\n\n\t\tchars += String.fromCharCode( array[ i ] );\n\n\t}\n\n\treturn btoa( chars );\n\n}\n\nfunction base64ToArrayBuffer( base64 ) {\n\n\treturn Uint8Array.from( atob( base64 ), c => c.charCodeAt( 0 ) ).buffer;\n\n}\n\nvar NodeUtils = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tarrayBufferToBase64: arrayBufferToBase64,\n\tbase64ToArrayBuffer: base64ToArrayBuffer,\n\tgetCacheKey: getCacheKey$1,\n\tgetLengthFromType: getLengthFromType,\n\tgetNodeChildren: getNodeChildren,\n\tgetTypeFromLength: getTypeFromLength,\n\tgetValueFromType: getValueFromType,\n\tgetValueType: getValueType,\n\thash: hash$1,\n\thashArray: hashArray,\n\thashString: hashString\n});\n\nconst NodeShaderStage = {\n\tVERTEX: 'vertex',\n\tFRAGMENT: 'fragment'\n};\n\nconst NodeUpdateType = {\n\tNONE: 'none',\n\tFRAME: 'frame',\n\tRENDER: 'render',\n\tOBJECT: 'object'\n};\n\nconst NodeType = {\n\tBOOLEAN: 'bool',\n\tINTEGER: 'int',\n\tFLOAT: 'float',\n\tVECTOR2: 'vec2',\n\tVECTOR3: 'vec3',\n\tVECTOR4: 'vec4',\n\tMATRIX2: 'mat2',\n\tMATRIX3: 'mat3',\n\tMATRIX4: 'mat4'\n};\n\nconst NodeAccess = {\n\tREAD_ONLY: 'readOnly',\n\tWRITE_ONLY: 'writeOnly',\n\tREAD_WRITE: 'readWrite',\n};\n\nconst defaultShaderStages = [ 'fragment', 'vertex' ];\nconst defaultBuildStages = [ 'setup', 'analyze', 'generate' ];\nconst shaderStages = [ ...defaultShaderStages, 'compute' ];\nconst vectorComponents = [ 'x', 'y', 'z', 'w' ];\n\nlet _nodeId = 0;\n\nclass Node extends EventDispatcher {\n\n\tstatic get type() {\n\n\t\treturn 'Node';\n\n\t}\n\n\tconstructor( nodeType = null ) {\n\n\t\tsuper();\n\n\t\tthis.nodeType = nodeType;\n\n\t\tthis.updateType = NodeUpdateType.NONE;\n\t\tthis.updateBeforeType = NodeUpdateType.NONE;\n\t\tthis.updateAfterType = NodeUpdateType.NONE;\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.version = 0;\n\n\t\tthis._cacheKey = null;\n\t\tthis._cacheKeyVersion = 0;\n\n\t\tthis.global = false;\n\n\t\tthis.isNode = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _nodeId ++ } );\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t}\n\n\tget type() {\n\n\t\treturn this.constructor.type;\n\n\t}\n\n\tonUpdate( callback, updateType ) {\n\n\t\tthis.updateType = updateType;\n\t\tthis.update = callback.bind( this.getSelf() );\n\n\t\treturn this;\n\n\t}\n\n\tonFrameUpdate( callback ) {\n\n\t\treturn this.onUpdate( callback, NodeUpdateType.FRAME );\n\n\t}\n\n\tonRenderUpdate( callback ) {\n\n\t\treturn this.onUpdate( callback, NodeUpdateType.RENDER );\n\n\t}\n\n\tonObjectUpdate( callback ) {\n\n\t\treturn this.onUpdate( callback, NodeUpdateType.OBJECT );\n\n\t}\n\n\tonReference( callback ) {\n\n\t\tthis.updateReference = callback.bind( this.getSelf() );\n\n\t\treturn this;\n\n\t}\n\n\tgetSelf() {\n\n\t\t// Returns non-node object.\n\n\t\treturn this.self || this;\n\n\t}\n\n\tupdateReference( /*state*/ ) {\n\n\t\treturn this;\n\n\t}\n\n\tisGlobal( /*builder*/ ) {\n\n\t\treturn this.global;\n\n\t}\n\n\t* getChildren() {\n\n\t\tfor ( const { childNode } of getNodeChildren( this ) ) {\n\n\t\t\tyield childNode;\n\n\t\t}\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\ttraverse( callback ) {\n\n\t\tcallback( this );\n\n\t\tfor ( const childNode of this.getChildren() ) {\n\n\t\t\tchildNode.traverse( callback );\n\n\t\t}\n\n\t}\n\n\tgetCacheKey( force = false ) {\n\n\t\tforce = force || this.version !== this._cacheKeyVersion;\n\n\t\tif ( force === true || this._cacheKey === null ) {\n\n\t\t\tthis._cacheKey = getCacheKey$1( this, force );\n\t\t\tthis._cacheKeyVersion = this.version;\n\n\t\t}\n\n\t\treturn this._cacheKey;\n\n\t}\n\n\tgetScope() {\n\n\t\treturn this;\n\n\t}\n\n\tgetHash( /*builder*/ ) {\n\n\t\treturn this.uuid;\n\n\t}\n\n\tgetUpdateType() {\n\n\t\treturn this.updateType;\n\n\t}\n\n\tgetUpdateBeforeType() {\n\n\t\treturn this.updateBeforeType;\n\n\t}\n\n\tgetUpdateAfterType() {\n\n\t\treturn this.updateAfterType;\n\n\t}\n\n\tgetElementType( builder ) {\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst elementType = builder.getElementType( type );\n\n\t\treturn elementType;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst nodeProperties = builder.getNodeProperties( this );\n\n\t\tif ( nodeProperties.outputNode ) {\n\n\t\t\treturn nodeProperties.outputNode.getNodeType( builder );\n\n\t\t}\n\n\t\treturn this.nodeType;\n\n\t}\n\n\tgetShared( builder ) {\n\n\t\tconst hash = this.getHash( builder );\n\t\tconst nodeFromHash = builder.getNodeFromHash( hash );\n\n\t\treturn nodeFromHash || this;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst nodeProperties = builder.getNodeProperties( this );\n\n\t\tlet index = 0;\n\n\t\tfor ( const childNode of this.getChildren() ) {\n\n\t\t\tnodeProperties[ 'node' + index ++ ] = childNode;\n\n\t\t}\n\n\t\t// return a outputNode if exists\n\t\treturn null;\n\n\t}\n\n\tanalyze( builder ) {\n\n\t\tconst usageCount = builder.increaseUsage( this );\n\n\t\tif ( usageCount === 1 ) {\n\n\t\t\t// node flow children\n\n\t\t\tconst nodeProperties = builder.getNodeProperties( this );\n\n\t\t\tfor ( const childNode of Object.values( nodeProperties ) ) {\n\n\t\t\t\tif ( childNode && childNode.isNode === true ) {\n\n\t\t\t\t\tchildNode.build( builder );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst { outputNode } = builder.getNodeProperties( this );\n\n\t\tif ( outputNode && outputNode.isNode === true ) {\n\n\t\t\treturn outputNode.build( builder, output );\n\n\t\t}\n\n\t}\n\n\tupdateBefore( /*frame*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tupdateAfter( /*frame*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tbuild( builder, output = null ) {\n\n\t\tconst refNode = this.getShared( builder );\n\n\t\tif ( this !== refNode ) {\n\n\t\t\treturn refNode.build( builder, output );\n\n\t\t}\n\n\t\tbuilder.addNode( this );\n\t\tbuilder.addChain( this );\n\n\t\t/* Build stages expected results:\n\t\t\t- \"setup\"\t\t-> Node\n\t\t\t- \"analyze\"\t\t-> null\n\t\t\t- \"generate\"\t-> String\n\t\t*/\n\t\tlet result = null;\n\n\t\tconst buildStage = builder.getBuildStage();\n\n\t\tif ( buildStage === 'setup' ) {\n\n\t\t\tthis.updateReference( builder );\n\n\t\t\tconst properties = builder.getNodeProperties( this );\n\n\t\t\tif ( properties.initialized !== true ) {\n\n\t\t\t\tconst stackNodesBeforeSetup = builder.stack.nodes.length;\n\n\t\t\t\tproperties.initialized = true;\n\t\t\t\tproperties.outputNode = this.setup( builder );\n\n\t\t\t\tif ( properties.outputNode !== null && builder.stack.nodes.length !== stackNodesBeforeSetup ) ;\n\n\t\t\t\tfor ( const childNode of Object.values( properties ) ) {\n\n\t\t\t\t\tif ( childNode && childNode.isNode === true ) {\n\n\t\t\t\t\t\tchildNode.build( builder );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( buildStage === 'analyze' ) {\n\n\t\t\tthis.analyze( builder );\n\n\t\t} else if ( buildStage === 'generate' ) {\n\n\t\t\tconst isGenerateOnce = this.generate.length === 1;\n\n\t\t\tif ( isGenerateOnce ) {\n\n\t\t\t\tconst type = this.getNodeType( builder );\n\t\t\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\t\t\tresult = nodeData.snippet;\n\n\t\t\t\tif ( result === undefined ) {\n\n\t\t\t\t\tresult = this.generate( builder ) || '';\n\n\t\t\t\t\tnodeData.snippet = result;\n\n\t\t\t\t} else if ( nodeData.flowCodes !== undefined && builder.context.nodeBlock !== undefined ) {\n\n\t\t\t\t\tbuilder.addFlowCodeHierarchy( this, builder.context.nodeBlock );\n\n\t\t\t\t}\n\n\t\t\t\tresult = builder.format( result, type, output );\n\n\t\t\t} else {\n\n\t\t\t\tresult = this.generate( builder, output ) || '';\n\n\t\t\t}\n\n\t\t}\n\n\t\tbuilder.removeChain( this );\n\t\tbuilder.addSequentialNode( this );\n\n\t\treturn result;\n\n\t}\n\n\tgetSerializeChildren() {\n\n\t\treturn getNodeChildren( this );\n\n\t}\n\n\tserialize( json ) {\n\n\t\tconst nodeChildren = this.getSerializeChildren();\n\n\t\tconst inputNodes = {};\n\n\t\tfor ( const { property, index, childNode } of nodeChildren ) {\n\n\t\t\tif ( index !== undefined ) {\n\n\t\t\t\tif ( inputNodes[ property ] === undefined ) {\n\n\t\t\t\t\tinputNodes[ property ] = Number.isInteger( index ) ? [] : {};\n\n\t\t\t\t}\n\n\t\t\t\tinputNodes[ property ][ index ] = childNode.toJSON( json.meta ).uuid;\n\n\t\t\t} else {\n\n\t\t\t\tinputNodes[ property ] = childNode.toJSON( json.meta ).uuid;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( Object.keys( inputNodes ).length > 0 ) {\n\n\t\t\tjson.inputNodes = inputNodes;\n\n\t\t}\n\n\t}\n\n\tdeserialize( json ) {\n\n\t\tif ( json.inputNodes !== undefined ) {\n\n\t\t\tconst nodes = json.meta.nodes;\n\n\t\t\tfor ( const property in json.inputNodes ) {\n\n\t\t\t\tif ( Array.isArray( json.inputNodes[ property ] ) ) {\n\n\t\t\t\t\tconst inputArray = [];\n\n\t\t\t\t\tfor ( const uuid of json.inputNodes[ property ] ) {\n\n\t\t\t\t\t\tinputArray.push( nodes[ uuid ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis[ property ] = inputArray;\n\n\t\t\t\t} else if ( typeof json.inputNodes[ property ] === 'object' ) {\n\n\t\t\t\t\tconst inputObject = {};\n\n\t\t\t\t\tfor ( const subProperty in json.inputNodes[ property ] ) {\n\n\t\t\t\t\t\tconst uuid = json.inputNodes[ property ][ subProperty ];\n\n\t\t\t\t\t\tinputObject[ subProperty ] = nodes[ uuid ];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis[ property ] = inputObject;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst uuid = json.inputNodes[ property ];\n\n\t\t\t\t\tthis[ property ] = nodes[ uuid ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst { uuid, type } = this;\n\t\tconst isRoot = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( isRoot ) {\n\n\t\t\tmeta = {\n\t\t\t\ttextures: {},\n\t\t\t\timages: {},\n\t\t\t\tnodes: {}\n\t\t\t};\n\n\t\t}\n\n\t\t// serialize\n\n\t\tlet data = meta.nodes[ uuid ];\n\n\t\tif ( data === undefined ) {\n\n\t\t\tdata = {\n\t\t\t\tuuid,\n\t\t\t\ttype,\n\t\t\t\tmeta,\n\t\t\t\tmetadata: {\n\t\t\t\t\tversion: 4.6,\n\t\t\t\t\ttype: 'Node',\n\t\t\t\t\tgenerator: 'Node.toJSON'\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif ( isRoot !== true ) meta.nodes[ data.uuid ] = data;\n\n\t\t\tthis.serialize( data );\n\n\t\t\tdelete data.meta;\n\n\t\t}\n\n\t\t// TODO: Copied from Object3D.toJSON\n\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t\tif ( isRoot ) {\n\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\t\t\tconst nodes = extractFromCache( meta.nodes );\n\n\t\t\tif ( textures.length > 0 ) data.textures = textures;\n\t\t\tif ( images.length > 0 ) data.images = images;\n\t\t\tif ( nodes.length > 0 ) data.nodes = nodes;\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass ArrayElementNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ArrayElementNode';\n\n\t} // @TODO: If extending from TempNode it breaks webgpu_compute\n\n\tconstructor( node, indexNode ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.indexNode = indexNode;\n\n\t\tthis.isArrayElementNode = true;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.node.getElementType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst nodeSnippet = this.node.build( builder );\n\t\tconst indexSnippet = this.indexNode.build( builder, 'uint' );\n\n\t\treturn `${nodeSnippet}[ ${indexSnippet} ]`;\n\n\t}\n\n}\n\nclass ConvertNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ConvertNode';\n\n\t}\n\n\tconstructor( node, convertTo ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.convertTo = convertTo;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst requestType = this.node.getNodeType( builder );\n\n\t\tlet convertTo = null;\n\n\t\tfor ( const overloadingType of this.convertTo.split( '|' ) ) {\n\n\t\t\tif ( convertTo === null || builder.getTypeLength( requestType ) === builder.getTypeLength( overloadingType ) ) {\n\n\t\t\t\tconvertTo = overloadingType;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn convertTo;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.convertTo = this.convertTo;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.convertTo = data.convertTo;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst node = this.node;\n\t\tconst type = this.getNodeType( builder );\n\n\t\tconst snippet = node.build( builder, type );\n\n\t\treturn builder.format( snippet, type, output );\n\n\t}\n\n}\n\nclass TempNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'TempNode';\n\n\t}\n\n\tconstructor( type ) {\n\n\t\tsuper( type );\n\n\t\tthis.isTempNode = true;\n\n\t}\n\n\thasDependencies( builder ) {\n\n\t\treturn builder.getDataFromNode( this ).usageCount > 1;\n\n\t}\n\n\tbuild( builder, output ) {\n\n\t\tconst buildStage = builder.getBuildStage();\n\n\t\tif ( buildStage === 'generate' ) {\n\n\t\t\tconst type = builder.getVectorType( this.getNodeType( builder, output ) );\n\t\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\t\tif ( nodeData.propertyName !== undefined ) {\n\n\t\t\t\treturn builder.format( nodeData.propertyName, type, output );\n\n\t\t\t} else if ( type !== 'void' && output !== 'void' && this.hasDependencies( builder ) ) {\n\n\t\t\t\tconst snippet = super.build( builder, type );\n\n\t\t\t\tconst nodeVar = builder.getVarFromNode( this, null, type );\n\t\t\t\tconst propertyName = builder.getPropertyName( nodeVar );\n\n\t\t\t\tbuilder.addLineFlowCode( `${propertyName} = ${snippet}`, this );\n\n\t\t\t\tnodeData.snippet = snippet;\n\t\t\t\tnodeData.propertyName = propertyName;\n\n\t\t\t\treturn builder.format( nodeData.propertyName, type, output );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn super.build( builder, output );\n\n\t}\n\n}\n\nclass JoinNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'JoinNode';\n\n\t}\n\n\tconstructor( nodes = [], nodeType = null ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.nodes = nodes;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tif ( this.nodeType !== null ) {\n\n\t\t\treturn builder.getVectorType( this.nodeType );\n\n\t\t}\n\n\t\treturn builder.getTypeFromLength( this.nodes.reduce( ( count, cur ) => count + builder.getTypeLength( cur.getNodeType( builder ) ), 0 ) );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst nodes = this.nodes;\n\n\t\tconst primitiveType = builder.getComponentType( type );\n\n\t\tconst snippetValues = [];\n\n\t\tfor ( const input of nodes ) {\n\n\t\t\tlet inputSnippet = input.build( builder );\n\n\t\t\tconst inputPrimitiveType = builder.getComponentType( input.getNodeType( builder ) );\n\n\t\t\tif ( inputPrimitiveType !== primitiveType ) {\n\n\t\t\t\tinputSnippet = builder.format( inputSnippet, inputPrimitiveType, primitiveType );\n\n\t\t\t}\n\n\t\t\tsnippetValues.push( inputSnippet );\n\n\t\t}\n\n\t\tconst snippet = `${ builder.getType( type ) }( ${ snippetValues.join( ', ' ) } )`;\n\n\t\treturn builder.format( snippet, type, output );\n\n\t}\n\n}\n\nconst stringVectorComponents = vectorComponents.join( '' );\n\nclass SplitNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'SplitNode';\n\n\t}\n\n\tconstructor( node, components = 'x' ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.components = components;\n\n\t\tthis.isSplitNode = true;\n\n\t}\n\n\tgetVectorLength() {\n\n\t\tlet vectorLength = this.components.length;\n\n\t\tfor ( const c of this.components ) {\n\n\t\t\tvectorLength = Math.max( vectorComponents.indexOf( c ) + 1, vectorLength );\n\n\t\t}\n\n\t\treturn vectorLength;\n\n\t}\n\n\tgetComponentType( builder ) {\n\n\t\treturn builder.getComponentType( this.node.getNodeType( builder ) );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn builder.getTypeFromLength( this.components.length, this.getComponentType( builder ) );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst node = this.node;\n\t\tconst nodeTypeLength = builder.getTypeLength( node.getNodeType( builder ) );\n\n\t\tlet snippet = null;\n\n\t\tif ( nodeTypeLength > 1 ) {\n\n\t\t\tlet type = null;\n\n\t\t\tconst componentsLength = this.getVectorLength();\n\n\t\t\tif ( componentsLength >= nodeTypeLength ) {\n\n\t\t\t\t// needed expand the input node\n\n\t\t\t\ttype = builder.getTypeFromLength( this.getVectorLength(), this.getComponentType( builder ) );\n\n\t\t\t}\n\n\t\t\tconst nodeSnippet = node.build( builder, type );\n\n\t\t\tif ( this.components.length === nodeTypeLength && this.components === stringVectorComponents.slice( 0, this.components.length ) ) {\n\n\t\t\t\t// unnecessary swizzle\n\n\t\t\t\tsnippet = builder.format( nodeSnippet, type, output );\n\n\t\t\t} else {\n\n\t\t\t\tsnippet = builder.format( `${nodeSnippet}.${this.components}`, this.getNodeType( builder ), output );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// ignore .components if .node returns float/integer\n\n\t\t\tsnippet = node.build( builder, output );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.components = this.components;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.components = data.components;\n\n\t}\n\n}\n\nclass SetNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'SetNode';\n\n\t}\n\n\tconstructor( sourceNode, components, targetNode ) {\n\n\t\tsuper();\n\n\t\tthis.sourceNode = sourceNode;\n\t\tthis.components = components;\n\t\tthis.targetNode = targetNode;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.sourceNode.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { sourceNode, components, targetNode } = this;\n\n\t\tconst sourceType = this.getNodeType( builder );\n\t\tconst targetType = builder.getTypeFromLength( components.length, targetNode.getNodeType( builder ) );\n\n\t\tconst targetSnippet = targetNode.build( builder, targetType );\n\t\tconst sourceSnippet = sourceNode.build( builder, sourceType );\n\n\t\tconst length = builder.getTypeLength( sourceType );\n\t\tconst snippetValues = [];\n\n\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\tconst component = vectorComponents[ i ];\n\n\t\t\tif ( component === components[ 0 ] ) {\n\n\t\t\t\tsnippetValues.push( targetSnippet );\n\n\t\t\t\ti += components.length - 1;\n\n\t\t\t} else {\n\n\t\t\t\tsnippetValues.push( sourceSnippet + '.' + component );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn `${ builder.getType( sourceType ) }( ${ snippetValues.join( ', ' ) } )`;\n\n\t}\n\n}\n\nclass FlipNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'FlipNode';\n\n\t}\n\n\tconstructor( sourceNode, components ) {\n\n\t\tsuper();\n\n\t\tthis.sourceNode = sourceNode;\n\t\tthis.components = components;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.sourceNode.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { components, sourceNode } = this;\n\n\t\tconst sourceType = this.getNodeType( builder );\n\t\tconst sourceSnippet = sourceNode.build( builder );\n\n\t\tconst sourceCache = builder.getVarFromNode( this );\n\t\tconst sourceProperty = builder.getPropertyName( sourceCache );\n\n\t\tbuilder.addLineFlowCode( sourceProperty + ' = ' + sourceSnippet, this );\n\n\t\tconst length = builder.getTypeLength( sourceType );\n\t\tconst snippetValues = [];\n\n\t\tlet componentIndex = 0;\n\n\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\tconst component = vectorComponents[ i ];\n\n\t\t\tif ( component === components[ componentIndex ] ) {\n\n\t\t\t\tsnippetValues.push( '1.0 - ' + ( sourceProperty + '.' + component ) );\n\n\t\t\t\tcomponentIndex ++;\n\n\t\t\t} else {\n\n\t\t\t\tsnippetValues.push( sourceProperty + '.' + component );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn `${ builder.getType( sourceType ) }( ${ snippetValues.join( ', ' ) } )`;\n\n\t}\n\n}\n\nclass InputNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'InputNode';\n\n\t}\n\n\tconstructor( value, nodeType = null ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.isInputNode = true;\n\n\t\tthis.value = value;\n\t\tthis.precision = null;\n\n\t}\n\n\tgetNodeType( /*builder*/ ) {\n\n\t\tif ( this.nodeType === null ) {\n\n\t\t\treturn getValueType( this.value );\n\n\t\t}\n\n\t\treturn this.nodeType;\n\n\t}\n\n\tgetInputType( builder ) {\n\n\t\treturn this.getNodeType( builder );\n\n\t}\n\n\tsetPrecision( precision ) {\n\n\t\tthis.precision = precision;\n\n\t\treturn this;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.value = this.value;\n\n\t\tif ( this.value && this.value.toArray ) data.value = this.value.toArray();\n\n\t\tdata.valueType = getValueType( this.value );\n\t\tdata.nodeType = this.nodeType;\n\n\t\tif ( data.valueType === 'ArrayBuffer' ) data.value = arrayBufferToBase64( data.value );\n\n\t\tdata.precision = this.precision;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.nodeType = data.nodeType;\n\t\tthis.value = Array.isArray( data.value ) ? getValueFromType( data.valueType, ...data.value ) : data.value;\n\n\t\tthis.precision = data.precision || null;\n\n\t\tif ( this.value && this.value.fromArray ) this.value = this.value.fromArray( data.value );\n\n\t}\n\n\tgenerate( /*builder, output*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n}\n\nclass ConstNode extends InputNode {\n\n\tstatic get type() {\n\n\t\treturn 'ConstNode';\n\n\t}\n\n\tconstructor( value, nodeType = null ) {\n\n\t\tsuper( value, nodeType );\n\n\t\tthis.isConstNode = true;\n\n\t}\n\n\tgenerateConst( builder ) {\n\n\t\treturn builder.generateConst( this.getNodeType( builder ), this.value );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst type = this.getNodeType( builder );\n\n\t\treturn builder.format( this.generateConst( builder ), type, output );\n\n\t}\n\n}\n\n//\n\nlet currentStack = null;\n\nconst NodeElements = new Map();\n\nfunction addMethodChaining( name, nodeElement ) {\n\n\tif ( NodeElements.has( name ) ) {\n\n\t\tconsole.warn( `Redefinition of method chaining ${ name }` );\n\t\treturn;\n\n\t}\n\n\tif ( typeof nodeElement !== 'function' ) throw new Error( `Node element ${ name } is not a function` );\n\n\tNodeElements.set( name, nodeElement );\n\n}\n\nconst parseSwizzle = ( props ) => props.replace( /r|s/g, 'x' ).replace( /g|t/g, 'y' ).replace( /b|p/g, 'z' ).replace( /a|q/g, 'w' );\nconst parseSwizzleAndSort = ( props ) => parseSwizzle( props ).split( '' ).sort().join( '' );\n\nconst shaderNodeHandler = {\n\n\tsetup( NodeClosure, params ) {\n\n\t\tconst inputs = params.shift();\n\n\t\treturn NodeClosure( nodeObjects( inputs ), ...params );\n\n\t},\n\n\tget( node, prop, nodeObj ) {\n\n\t\tif ( typeof prop === 'string' && node[ prop ] === undefined ) {\n\n\t\t\tif ( node.isStackNode !== true && prop === 'assign' ) {\n\n\t\t\t\treturn ( ...params ) => {\n\n\t\t\t\t\tcurrentStack.assign( nodeObj, ...params );\n\n\t\t\t\t\treturn nodeObj;\n\n\t\t\t\t};\n\n\t\t\t} else if ( NodeElements.has( prop ) ) {\n\n\t\t\t\tconst nodeElement = NodeElements.get( prop );\n\n\t\t\t\treturn node.isStackNode ? ( ...params ) => nodeObj.add( nodeElement( ...params ) ) : ( ...params ) => nodeElement( nodeObj, ...params );\n\n\t\t\t} else if ( prop === 'self' ) {\n\n\t\t\t\treturn node;\n\n\t\t\t} else if ( prop.endsWith( 'Assign' ) && NodeElements.has( prop.slice( 0, prop.length - 'Assign'.length ) ) ) {\n\n\t\t\t\tconst nodeElement = NodeElements.get( prop.slice( 0, prop.length - 'Assign'.length ) );\n\n\t\t\t\treturn node.isStackNode ? ( ...params ) => nodeObj.assign( params[ 0 ], nodeElement( ...params ) ) : ( ...params ) => nodeObj.assign( nodeElement( nodeObj, ...params ) );\n\n\t\t\t} else if ( /^[xyzwrgbastpq]{1,4}$/.test( prop ) === true ) {\n\n\t\t\t\t// accessing properties ( swizzle )\n\n\t\t\t\tprop = parseSwizzle( prop );\n\n\t\t\t\treturn nodeObject( new SplitNode( nodeObj, prop ) );\n\n\t\t\t} else if ( /^set[XYZWRGBASTPQ]{1,4}$/.test( prop ) === true ) {\n\n\t\t\t\t// set properties ( swizzle ) and sort to xyzw sequence\n\n\t\t\t\tprop = parseSwizzleAndSort( prop.slice( 3 ).toLowerCase() );\n\n\t\t\t\treturn ( value ) => nodeObject( new SetNode( node, prop, value ) );\n\n\t\t\t} else if ( /^flip[XYZWRGBASTPQ]{1,4}$/.test( prop ) === true ) {\n\n\t\t\t\t// set properties ( swizzle ) and sort to xyzw sequence\n\n\t\t\t\tprop = parseSwizzleAndSort( prop.slice( 4 ).toLowerCase() );\n\n\t\t\t\treturn () => nodeObject( new FlipNode( nodeObject( node ), prop ) );\n\n\t\t\t} else if ( prop === 'width' || prop === 'height' || prop === 'depth' ) {\n\n\t\t\t\t// accessing property\n\n\t\t\t\tif ( prop === 'width' ) prop = 'x';\n\t\t\t\telse if ( prop === 'height' ) prop = 'y';\n\t\t\t\telse if ( prop === 'depth' ) prop = 'z';\n\n\t\t\t\treturn nodeObject( new SplitNode( node, prop ) );\n\n\t\t\t} else if ( /^\\d+$/.test( prop ) === true ) {\n\n\t\t\t\t// accessing array\n\n\t\t\t\treturn nodeObject( new ArrayElementNode( nodeObj, new ConstNode( Number( prop ), 'uint' ) ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Reflect.get( node, prop, nodeObj );\n\n\t},\n\n\tset( node, prop, value, nodeObj ) {\n\n\t\tif ( typeof prop === 'string' && node[ prop ] === undefined ) {\n\n\t\t\t// setting properties\n\n\t\t\tif ( /^[xyzwrgbastpq]{1,4}$/.test( prop ) === true || prop === 'width' || prop === 'height' || prop === 'depth' || /^\\d+$/.test( prop ) === true ) {\n\n\t\t\t\tnodeObj[ prop ].assign( value );\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Reflect.set( node, prop, value, nodeObj );\n\n\t}\n\n};\n\nconst nodeObjectsCacheMap = new WeakMap();\nconst nodeBuilderFunctionsCacheMap = new WeakMap();\n\nconst ShaderNodeObject = function ( obj, altType = null ) {\n\n\tconst type = getValueType( obj );\n\n\tif ( type === 'node' ) {\n\n\t\tlet nodeObject = nodeObjectsCacheMap.get( obj );\n\n\t\tif ( nodeObject === undefined ) {\n\n\t\t\tnodeObject = new Proxy( obj, shaderNodeHandler );\n\n\t\t\tnodeObjectsCacheMap.set( obj, nodeObject );\n\t\t\tnodeObjectsCacheMap.set( nodeObject, nodeObject );\n\n\t\t}\n\n\t\treturn nodeObject;\n\n\t} else if ( ( altType === null && ( type === 'float' || type === 'boolean' ) ) || ( type && type !== 'shader' && type !== 'string' ) ) {\n\n\t\treturn nodeObject( getConstNode( obj, altType ) );\n\n\t} else if ( type === 'shader' ) {\n\n\t\treturn Fn( obj );\n\n\t}\n\n\treturn obj;\n\n};\n\nconst ShaderNodeObjects = function ( objects, altType = null ) {\n\n\tfor ( const name in objects ) {\n\n\t\tobjects[ name ] = nodeObject( objects[ name ], altType );\n\n\t}\n\n\treturn objects;\n\n};\n\nconst ShaderNodeArray = function ( array, altType = null ) {\n\n\tconst len = array.length;\n\n\tfor ( let i = 0; i < len; i ++ ) {\n\n\t\tarray[ i ] = nodeObject( array[ i ], altType );\n\n\t}\n\n\treturn array;\n\n};\n\nconst ShaderNodeProxy = function ( NodeClass, scope = null, factor = null, settings = null ) {\n\n\tconst assignNode = ( node ) => nodeObject( settings !== null ? Object.assign( node, settings ) : node );\n\n\tif ( scope === null ) {\n\n\t\treturn ( ...params ) => {\n\n\t\t\treturn assignNode( new NodeClass( ...nodeArray( params ) ) );\n\n\t\t};\n\n\t} else if ( factor !== null ) {\n\n\t\tfactor = nodeObject( factor );\n\n\t\treturn ( ...params ) => {\n\n\t\t\treturn assignNode( new NodeClass( scope, ...nodeArray( params ), factor ) );\n\n\t\t};\n\n\t} else {\n\n\t\treturn ( ...params ) => {\n\n\t\t\treturn assignNode( new NodeClass( scope, ...nodeArray( params ) ) );\n\n\t\t};\n\n\t}\n\n};\n\nconst ShaderNodeImmutable = function ( NodeClass, ...params ) {\n\n\treturn nodeObject( new NodeClass( ...nodeArray( params ) ) );\n\n};\n\nclass ShaderCallNodeInternal extends Node {\n\n\tconstructor( shaderNode, inputNodes ) {\n\n\t\tsuper();\n\n\t\tthis.shaderNode = shaderNode;\n\t\tthis.inputNodes = inputNodes;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.shaderNode.nodeType || this.getOutputNode( builder ).getNodeType( builder );\n\n\t}\n\n\tcall( builder ) {\n\n\t\tconst { shaderNode, inputNodes } = this;\n\n\t\tconst properties = builder.getNodeProperties( shaderNode );\n\t\tif ( properties.onceOutput ) return properties.onceOutput;\n\n\t\t//\n\n\t\tlet result = null;\n\n\t\tif ( shaderNode.layout ) {\n\n\t\t\tlet functionNodesCacheMap = nodeBuilderFunctionsCacheMap.get( builder.constructor );\n\n\t\t\tif ( functionNodesCacheMap === undefined ) {\n\n\t\t\t\tfunctionNodesCacheMap = new WeakMap();\n\n\t\t\t\tnodeBuilderFunctionsCacheMap.set( builder.constructor, functionNodesCacheMap );\n\n\t\t\t}\n\n\t\t\tlet functionNode = functionNodesCacheMap.get( shaderNode );\n\n\t\t\tif ( functionNode === undefined ) {\n\n\t\t\t\tfunctionNode = nodeObject( builder.buildFunctionNode( shaderNode ) );\n\n\t\t\t\tfunctionNodesCacheMap.set( shaderNode, functionNode );\n\n\t\t\t}\n\n\t\t\tif ( builder.currentFunctionNode !== null ) {\n\n\t\t\t\tbuilder.currentFunctionNode.includes.push( functionNode );\n\n\t\t\t}\n\n\t\t\tresult = nodeObject( functionNode.call( inputNodes ) );\n\n\t\t} else {\n\n\t\t\tconst jsFunc = shaderNode.jsFunc;\n\t\t\tconst outputNode = inputNodes !== null ? jsFunc( inputNodes, builder ) : jsFunc( builder );\n\n\t\t\tresult = nodeObject( outputNode );\n\n\t\t}\n\n\t\tif ( shaderNode.once ) {\n\n\t\t\tproperties.onceOutput = result;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tgetOutputNode( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\tif ( properties.outputNode === null ) {\n\n\t\t\tproperties.outputNode = this.setupOutput( builder );\n\n\t\t}\n\n\t\treturn properties.outputNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\treturn this.getOutputNode( builder );\n\n\t}\n\n\tsetupOutput( builder ) {\n\n\t\tbuilder.addStack();\n\n\t\tbuilder.stack.outputNode = this.call( builder );\n\n\t\treturn builder.removeStack();\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst outputNode = this.getOutputNode( builder );\n\n\t\treturn outputNode.build( builder, output );\n\n\t}\n\n}\n\nclass ShaderNodeInternal extends Node {\n\n\tconstructor( jsFunc, nodeType ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.jsFunc = jsFunc;\n\t\tthis.layout = null;\n\n\t\tthis.global = true;\n\n\t\tthis.once = false;\n\n\t}\n\n\tsetLayout( layout ) {\n\n\t\tthis.layout = layout;\n\n\t\treturn this;\n\n\t}\n\n\tcall( inputs = null ) {\n\n\t\tnodeObjects( inputs );\n\n\t\treturn nodeObject( new ShaderCallNodeInternal( this, inputs ) );\n\n\t}\n\n\tsetup() {\n\n\t\treturn this.call();\n\n\t}\n\n}\n\nconst bools = [ false, true ];\nconst uints = [ 0, 1, 2, 3 ];\nconst ints = [ - 1, - 2 ];\nconst floats = [ 0.5, 1.5, 1 / 3, 1e-6, 1e6, Math.PI, Math.PI * 2, 1 / Math.PI, 2 / Math.PI, 1 / ( Math.PI * 2 ), Math.PI / 2 ];\n\nconst boolsCacheMap = new Map();\nfor ( const bool of bools ) boolsCacheMap.set( bool, new ConstNode( bool ) );\n\nconst uintsCacheMap = new Map();\nfor ( const uint of uints ) uintsCacheMap.set( uint, new ConstNode( uint, 'uint' ) );\n\nconst intsCacheMap = new Map( [ ...uintsCacheMap ].map( el => new ConstNode( el.value, 'int' ) ) );\nfor ( const int of ints ) intsCacheMap.set( int, new ConstNode( int, 'int' ) );\n\nconst floatsCacheMap = new Map( [ ...intsCacheMap ].map( el => new ConstNode( el.value ) ) );\nfor ( const float of floats ) floatsCacheMap.set( float, new ConstNode( float ) );\nfor ( const float of floats ) floatsCacheMap.set( - float, new ConstNode( - float ) );\n\nconst cacheMaps = { bool: boolsCacheMap, uint: uintsCacheMap, ints: intsCacheMap, float: floatsCacheMap };\n\nconst constNodesCacheMap = new Map( [ ...boolsCacheMap, ...floatsCacheMap ] );\n\nconst getConstNode = ( value, type ) => {\n\n\tif ( constNodesCacheMap.has( value ) ) {\n\n\t\treturn constNodesCacheMap.get( value );\n\n\t} else if ( value.isNode === true ) {\n\n\t\treturn value;\n\n\t} else {\n\n\t\treturn new ConstNode( value, type );\n\n\t}\n\n};\n\nconst safeGetNodeType = ( node ) => {\n\n\ttry {\n\n\t\treturn node.getNodeType();\n\n\t} catch ( _ ) {\n\n\t\treturn undefined;\n\n\t}\n\n};\n\nconst ConvertType = function ( type, cacheMap = null ) {\n\n\treturn ( ...params ) => {\n\n\t\tif ( params.length === 0 || ( ! [ 'bool', 'float', 'int', 'uint' ].includes( type ) && params.every( param => typeof param !== 'object' ) ) ) {\n\n\t\t\tparams = [ getValueFromType( type, ...params ) ];\n\n\t\t}\n\n\t\tif ( params.length === 1 && cacheMap !== null && cacheMap.has( params[ 0 ] ) ) {\n\n\t\t\treturn nodeObject( cacheMap.get( params[ 0 ] ) );\n\n\t\t}\n\n\t\tif ( params.length === 1 ) {\n\n\t\t\tconst node = getConstNode( params[ 0 ], type );\n\t\t\tif ( safeGetNodeType( node ) === type ) return nodeObject( node );\n\t\t\treturn nodeObject( new ConvertNode( node, type ) );\n\n\t\t}\n\n\t\tconst nodes = params.map( param => getConstNode( param ) );\n\t\treturn nodeObject( new JoinNode( nodes, type ) );\n\n\t};\n\n};\n\n// exports\n\nconst defined = ( v ) => typeof v === 'object' && v !== null ? v.value : v; // TODO: remove boolean conversion and defined function\n\n// utils\n\nconst getConstNodeType = ( value ) => ( value !== undefined && value !== null ) ? ( value.nodeType || value.convertTo || ( typeof value === 'string' ? value : null ) ) : null;\n\n// shader node base\n\nfunction ShaderNode( jsFunc, nodeType ) {\n\n\treturn new Proxy( new ShaderNodeInternal( jsFunc, nodeType ), shaderNodeHandler );\n\n}\n\nconst nodeObject = ( val, altType = null ) => /* new */ ShaderNodeObject( val, altType );\nconst nodeObjects = ( val, altType = null ) => new ShaderNodeObjects( val, altType );\nconst nodeArray = ( val, altType = null ) => new ShaderNodeArray( val, altType );\nconst nodeProxy = ( ...params ) => new ShaderNodeProxy( ...params );\nconst nodeImmutable = ( ...params ) => new ShaderNodeImmutable( ...params );\n\nconst Fn = ( jsFunc, nodeType ) => {\n\n\tconst shaderNode = new ShaderNode( jsFunc, nodeType );\n\n\tconst fn = ( ...params ) => {\n\n\t\tlet inputs;\n\n\t\tnodeObjects( params );\n\n\t\tif ( params[ 0 ] && params[ 0 ].isNode ) {\n\n\t\t\tinputs = [ ...params ];\n\n\t\t} else {\n\n\t\t\tinputs = params[ 0 ];\n\n\t\t}\n\n\t\treturn shaderNode.call( inputs );\n\n\t};\n\n\tfn.shaderNode = shaderNode;\n\n\tfn.setLayout = ( layout ) => {\n\n\t\tshaderNode.setLayout( layout );\n\n\t\treturn fn;\n\n\t};\n\n\tfn.once = () => {\n\n\t\tshaderNode.once = true;\n\n\t\treturn fn;\n\n\t};\n\n\treturn fn;\n\n};\n\nconst tslFn = ( ...params ) => { // @deprecated, r168\n\n\tconsole.warn( 'TSL.ShaderNode: tslFn() has been renamed to Fn().' );\n\treturn Fn( ...params );\n\n};\n\n//\n\naddMethodChaining( 'toGlobal', ( node ) => {\n\n\tnode.global = true;\n\n\treturn node;\n\n} );\n\n//\n\nconst setCurrentStack = ( stack ) => {\n\n\tcurrentStack = stack;\n\n};\n\nconst getCurrentStack = () => currentStack;\n\nconst If = ( ...params ) => currentStack.If( ...params );\n\nfunction append( node ) {\n\n\tif ( currentStack ) currentStack.add( node );\n\n\treturn node;\n\n}\n\naddMethodChaining( 'append', append );\n\n// types\n\nconst color = new ConvertType( 'color' );\n\nconst float = new ConvertType( 'float', cacheMaps.float );\nconst int = new ConvertType( 'int', cacheMaps.ints );\nconst uint = new ConvertType( 'uint', cacheMaps.uint );\nconst bool = new ConvertType( 'bool', cacheMaps.bool );\n\nconst vec2 = new ConvertType( 'vec2' );\nconst ivec2 = new ConvertType( 'ivec2' );\nconst uvec2 = new ConvertType( 'uvec2' );\nconst bvec2 = new ConvertType( 'bvec2' );\n\nconst vec3 = new ConvertType( 'vec3' );\nconst ivec3 = new ConvertType( 'ivec3' );\nconst uvec3 = new ConvertType( 'uvec3' );\nconst bvec3 = new ConvertType( 'bvec3' );\n\nconst vec4 = new ConvertType( 'vec4' );\nconst ivec4 = new ConvertType( 'ivec4' );\nconst uvec4 = new ConvertType( 'uvec4' );\nconst bvec4 = new ConvertType( 'bvec4' );\n\nconst mat2 = new ConvertType( 'mat2' );\nconst mat3 = new ConvertType( 'mat3' );\nconst mat4 = new ConvertType( 'mat4' );\n\nconst string = ( value = '' ) => nodeObject( new ConstNode( value, 'string' ) );\nconst arrayBuffer = ( value ) => nodeObject( new ConstNode( value, 'ArrayBuffer' ) );\n\naddMethodChaining( 'toColor', color );\naddMethodChaining( 'toFloat', float );\naddMethodChaining( 'toInt', int );\naddMethodChaining( 'toUint', uint );\naddMethodChaining( 'toBool', bool );\naddMethodChaining( 'toVec2', vec2 );\naddMethodChaining( 'toIVec2', ivec2 );\naddMethodChaining( 'toUVec2', uvec2 );\naddMethodChaining( 'toBVec2', bvec2 );\naddMethodChaining( 'toVec3', vec3 );\naddMethodChaining( 'toIVec3', ivec3 );\naddMethodChaining( 'toUVec3', uvec3 );\naddMethodChaining( 'toBVec3', bvec3 );\naddMethodChaining( 'toVec4', vec4 );\naddMethodChaining( 'toIVec4', ivec4 );\naddMethodChaining( 'toUVec4', uvec4 );\naddMethodChaining( 'toBVec4', bvec4 );\naddMethodChaining( 'toMat2', mat2 );\naddMethodChaining( 'toMat3', mat3 );\naddMethodChaining( 'toMat4', mat4 );\n\n// basic nodes\n\nconst element = /*@__PURE__*/ nodeProxy( ArrayElementNode );\nconst convert = ( node, types ) => nodeObject( new ConvertNode( nodeObject( node ), types ) );\nconst split = ( node, channels ) => nodeObject( new SplitNode( nodeObject( node ), channels ) );\n\naddMethodChaining( 'element', element );\naddMethodChaining( 'convert', convert );\n\nclass UniformGroupNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'UniformGroupNode';\n\n\t}\n\n\tconstructor( name, shared = false, order = 1 ) {\n\n\t\tsuper( 'string' );\n\n\t\tthis.name = name;\n\t\tthis.version = 0;\n\n\t\tthis.shared = shared;\n\t\tthis.order = order;\n\t\tthis.isUniformGroup = true;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.name = this.name;\n\t\tdata.version = this.version;\n\t\tdata.shared = this.shared;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.name = data.name;\n\t\tthis.version = data.version;\n\t\tthis.shared = data.shared;\n\n\t}\n\n}\n\nconst uniformGroup = ( name ) => new UniformGroupNode( name );\nconst sharedUniformGroup = ( name, order = 0 ) => new UniformGroupNode( name, true, order );\n\nconst frameGroup = /*@__PURE__*/ sharedUniformGroup( 'frame' );\nconst renderGroup = /*@__PURE__*/ sharedUniformGroup( 'render' );\nconst objectGroup = /*@__PURE__*/ uniformGroup( 'object' );\n\nclass UniformNode extends InputNode {\n\n\tstatic get type() {\n\n\t\treturn 'UniformNode';\n\n\t}\n\n\tconstructor( value, nodeType = null ) {\n\n\t\tsuper( value, nodeType );\n\n\t\tthis.isUniformNode = true;\n\n\t\tthis.name = '';\n\t\tthis.groupNode = objectGroup;\n\n\t}\n\n\tlabel( name ) {\n\n\t\tthis.name = name;\n\n\t\treturn this;\n\n\t}\n\n\tsetGroup( group ) {\n\n\t\tthis.groupNode = group;\n\n\t\treturn this;\n\n\t}\n\n\tgetGroup() {\n\n\t\treturn this.groupNode;\n\n\t}\n\n\tgetUniformHash( builder ) {\n\n\t\treturn this.getHash( builder );\n\n\t}\n\n\tonUpdate( callback, updateType ) {\n\n\t\tconst self = this.getSelf();\n\n\t\tcallback = callback.bind( self );\n\n\t\treturn super.onUpdate( ( frame ) => {\n\n\t\t\tconst value = callback( frame, self );\n\n\t\t\tif ( value !== undefined ) {\n\n\t\t\t\tthis.value = value;\n\n\t\t\t}\n\n\t \t}, updateType );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst type = this.getNodeType( builder );\n\n\t\tconst hash = this.getUniformHash( builder );\n\n\t\tlet sharedNode = builder.getNodeFromHash( hash );\n\n\t\tif ( sharedNode === undefined ) {\n\n\t\t\tbuilder.setHashNode( this, hash );\n\n\t\t\tsharedNode = this;\n\n\t\t}\n\n\t\tconst sharedNodeType = sharedNode.getInputType( builder );\n\n\t\tconst nodeUniform = builder.getUniformFromNode( sharedNode, sharedNodeType, builder.shaderStage, this.name || builder.context.label );\n\t\tconst propertyName = builder.getPropertyName( nodeUniform );\n\n\t\tif ( builder.context.label !== undefined ) delete builder.context.label;\n\n\t\treturn builder.format( propertyName, type, output );\n\n\t}\n\n}\n\nconst uniform = ( arg1, arg2 ) => {\n\n\tconst nodeType = getConstNodeType( arg2 || arg1 );\n\n\t// @TODO: get ConstNode from .traverse() in the future\n\tconst value = ( arg1 && arg1.isNode === true ) ? ( arg1.node && arg1.node.value ) || arg1.value : arg1;\n\n\treturn nodeObject( new UniformNode( value, nodeType ) );\n\n};\n\nclass PropertyNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'PropertyNode';\n\n\t}\n\n\tconstructor( nodeType, name = null, varying = false ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.name = name;\n\t\tthis.varying = varying;\n\n\t\tthis.isPropertyNode = true;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\treturn this.name || super.getHash( builder );\n\n\t}\n\n\tisGlobal( /*builder*/ ) {\n\n\t\treturn true;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tlet nodeVar;\n\n\t\tif ( this.varying === true ) {\n\n\t\t\tnodeVar = builder.getVaryingFromNode( this, this.name );\n\t\t\tnodeVar.needsInterpolation = true;\n\n\t\t} else {\n\n\t\t\tnodeVar = builder.getVarFromNode( this, this.name );\n\n\t\t}\n\n\t\treturn builder.getPropertyName( nodeVar );\n\n\t}\n\n}\n\nconst property = ( type, name ) => nodeObject( new PropertyNode( type, name ) );\nconst varyingProperty = ( type, name ) => nodeObject( new PropertyNode( type, name, true ) );\n\nconst diffuseColor = /*@__PURE__*/ nodeImmutable( PropertyNode, 'vec4', 'DiffuseColor' );\nconst emissive = /*@__PURE__*/ nodeImmutable( PropertyNode, 'vec3', 'EmissiveColor' );\nconst roughness = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Roughness' );\nconst metalness = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Metalness' );\nconst clearcoat = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Clearcoat' );\nconst clearcoatRoughness = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'ClearcoatRoughness' );\nconst sheen = /*@__PURE__*/ nodeImmutable( PropertyNode, 'vec3', 'Sheen' );\nconst sheenRoughness = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'SheenRoughness' );\nconst iridescence = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Iridescence' );\nconst iridescenceIOR = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'IridescenceIOR' );\nconst iridescenceThickness = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'IridescenceThickness' );\nconst alphaT = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'AlphaT' );\nconst anisotropy = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Anisotropy' );\nconst anisotropyT = /*@__PURE__*/ nodeImmutable( PropertyNode, 'vec3', 'AnisotropyT' );\nconst anisotropyB = /*@__PURE__*/ nodeImmutable( PropertyNode, 'vec3', 'AnisotropyB' );\nconst specularColor = /*@__PURE__*/ nodeImmutable( PropertyNode, 'color', 'SpecularColor' );\nconst specularF90 = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'SpecularF90' );\nconst shininess = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Shininess' );\nconst output = /*@__PURE__*/ nodeImmutable( PropertyNode, 'vec4', 'Output' );\nconst dashSize = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'dashSize' );\nconst gapSize = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'gapSize' );\nconst pointWidth = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'pointWidth' );\nconst ior = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'IOR' );\nconst transmission = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Transmission' );\nconst thickness = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Thickness' );\nconst attenuationDistance = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'AttenuationDistance' );\nconst attenuationColor = /*@__PURE__*/ nodeImmutable( PropertyNode, 'color', 'AttenuationColor' );\nconst dispersion = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Dispersion' );\n\nclass AssignNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'AssignNode';\n\n\t}\n\n\tconstructor( targetNode, sourceNode ) {\n\n\t\tsuper();\n\n\t\tthis.targetNode = targetNode;\n\t\tthis.sourceNode = sourceNode;\n\n\t}\n\n\thasDependencies() {\n\n\t\treturn false;\n\n\t}\n\n\tgetNodeType( builder, output ) {\n\n\t\treturn output !== 'void' ? this.targetNode.getNodeType( builder ) : 'void';\n\n\t}\n\n\tneedsSplitAssign( builder ) {\n\n\t\tconst { targetNode } = this;\n\n\t\tif ( builder.isAvailable( 'swizzleAssign' ) === false && targetNode.isSplitNode && targetNode.components.length > 1 ) {\n\n\t\t\tconst targetLength = builder.getTypeLength( targetNode.node.getNodeType( builder ) );\n\t\t\tconst assignDiferentVector = vectorComponents.join( '' ).slice( 0, targetLength ) !== targetNode.components;\n\n\t\t\treturn assignDiferentVector;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst { targetNode, sourceNode } = this;\n\n\t\tconst needsSplitAssign = this.needsSplitAssign( builder );\n\n\t\tconst targetType = targetNode.getNodeType( builder );\n\n\t\tconst target = targetNode.context( { assign: true } ).build( builder );\n\t\tconst source = sourceNode.build( builder, targetType );\n\n\t\tconst sourceType = sourceNode.getNodeType( builder );\n\n\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\t//\n\n\t\tlet snippet;\n\n\t\tif ( nodeData.initialized === true ) {\n\n\t\t\tif ( output !== 'void' ) {\n\n\t\t\t\tsnippet = target;\n\n\t\t\t}\n\n\t\t} else if ( needsSplitAssign ) {\n\n\t\t\tconst sourceVar = builder.getVarFromNode( this, null, targetType );\n\t\t\tconst sourceProperty = builder.getPropertyName( sourceVar );\n\n\t\t\tbuilder.addLineFlowCode( `${ sourceProperty } = ${ source }`, this );\n\n\t\t\tconst targetRoot = targetNode.node.context( { assign: true } ).build( builder );\n\n\t\t\tfor ( let i = 0; i < targetNode.components.length; i ++ ) {\n\n\t\t\t\tconst component = targetNode.components[ i ];\n\n\t\t\t\tbuilder.addLineFlowCode( `${ targetRoot }.${ component } = ${ sourceProperty }[ ${ i } ]`, this );\n\n\t\t\t}\n\n\t\t\tif ( output !== 'void' ) {\n\n\t\t\t\tsnippet = target;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tsnippet = `${ target } = ${ source }`;\n\n\t\t\tif ( output === 'void' || sourceType === 'void' ) {\n\n\t\t\t\tbuilder.addLineFlowCode( snippet, this );\n\n\t\t\t\tif ( output !== 'void' ) {\n\n\t\t\t\t\tsnippet = target;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tnodeData.initialized = true;\n\n\t\treturn builder.format( snippet, targetType, output );\n\n\t}\n\n}\n\nconst assign = /*@__PURE__*/ nodeProxy( AssignNode );\n\naddMethodChaining( 'assign', assign );\n\nclass FunctionCallNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'FunctionCallNode';\n\n\t}\n\n\tconstructor( functionNode = null, parameters = {} ) {\n\n\t\tsuper();\n\n\t\tthis.functionNode = functionNode;\n\t\tthis.parameters = parameters;\n\n\t}\n\n\tsetParameters( parameters ) {\n\n\t\tthis.parameters = parameters;\n\n\t\treturn this;\n\n\t}\n\n\tgetParameters() {\n\n\t\treturn this.parameters;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.functionNode.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst params = [];\n\n\t\tconst functionNode = this.functionNode;\n\n\t\tconst inputs = functionNode.getInputs( builder );\n\t\tconst parameters = this.parameters;\n\n\t\tconst generateInput = ( node, inputNode ) => {\n\n\t\t\tconst type = inputNode.type;\n\t\t\tconst pointer = type === 'pointer';\n\n\t\t\tlet output;\n\n\t\t\tif ( pointer ) output = '&' + node.build( builder );\n\t\t\telse output = node.build( builder, type );\n\n\t\t\treturn output;\n\n\t\t};\n\n\t\tif ( Array.isArray( parameters ) ) {\n\n\t\t\tfor ( let i = 0; i < parameters.length; i ++ ) {\n\n\t\t\t\tparams.push( generateInput( parameters[ i ], inputs[ i ] ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tfor ( const inputNode of inputs ) {\n\n\t\t\t\tconst node = parameters[ inputNode.name ];\n\n\t\t\t\tif ( node !== undefined ) {\n\n\t\t\t\t\tparams.push( generateInput( node, inputNode ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( `FunctionCallNode: Input '${inputNode.name}' not found in FunctionNode.` );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst functionName = functionNode.build( builder, 'property' );\n\n\t\treturn `${functionName}( ${params.join( ', ' )} )`;\n\n\t}\n\n}\n\nconst call = ( func, ...params ) => {\n\n\tparams = params.length > 1 || ( params[ 0 ] && params[ 0 ].isNode === true ) ? nodeArray( params ) : nodeObjects( params[ 0 ] );\n\n\treturn nodeObject( new FunctionCallNode( nodeObject( func ), params ) );\n\n};\n\naddMethodChaining( 'call', call );\n\nclass OperatorNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'OperatorNode';\n\n\t}\n\n\tconstructor( op, aNode, bNode, ...params ) {\n\n\t\tsuper();\n\n\t\tif ( params.length > 0 ) {\n\n\t\t\tlet finalOp = new OperatorNode( op, aNode, bNode );\n\n\t\t\tfor ( let i = 0; i < params.length - 1; i ++ ) {\n\n\t\t\t\tfinalOp = new OperatorNode( op, finalOp, params[ i ] );\n\n\t\t\t}\n\n\t\t\taNode = finalOp;\n\t\t\tbNode = params[ params.length - 1 ];\n\n\t\t}\n\n\t\tthis.op = op;\n\t\tthis.aNode = aNode;\n\t\tthis.bNode = bNode;\n\n\t}\n\n\tgetNodeType( builder, output ) {\n\n\t\tconst op = this.op;\n\n\t\tconst aNode = this.aNode;\n\t\tconst bNode = this.bNode;\n\n\t\tconst typeA = aNode.getNodeType( builder );\n\t\tconst typeB = typeof bNode !== 'undefined' ? bNode.getNodeType( builder ) : null;\n\n\t\tif ( typeA === 'void' || typeB === 'void' ) {\n\n\t\t\treturn 'void';\n\n\t\t} else if ( op === '%' ) {\n\n\t\t\treturn typeA;\n\n\t\t} else if ( op === '~' || op === '&' || op === '|' || op === '^' || op === '>>' || op === '<<' ) {\n\n\t\t\treturn builder.getIntegerType( typeA );\n\n\t\t} else if ( op === '!' || op === '==' || op === '&&' || op === '||' || op === '^^' ) {\n\n\t\t\treturn 'bool';\n\n\t\t} else if ( op === '<' || op === '>' || op === '<=' || op === '>=' ) {\n\n\t\t\tconst typeLength = output ? builder.getTypeLength( output ) : Math.max( builder.getTypeLength( typeA ), builder.getTypeLength( typeB ) );\n\n\t\t\treturn typeLength > 1 ? `bvec${ typeLength }` : 'bool';\n\n\t\t} else {\n\n\t\t\tif ( typeA === 'float' && builder.isMatrix( typeB ) ) {\n\n\t\t\t\treturn typeB;\n\n\t\t\t} else if ( builder.isMatrix( typeA ) && builder.isVector( typeB ) ) {\n\n\t\t\t\t// matrix x vector\n\n\t\t\t\treturn builder.getVectorFromMatrix( typeA );\n\n\t\t\t} else if ( builder.isVector( typeA ) && builder.isMatrix( typeB ) ) {\n\n\t\t\t\t// vector x matrix\n\n\t\t\t\treturn builder.getVectorFromMatrix( typeB );\n\n\t\t\t} else if ( builder.getTypeLength( typeB ) > builder.getTypeLength( typeA ) ) {\n\n\t\t\t\t// anytype x anytype: use the greater length vector\n\n\t\t\t\treturn typeB;\n\n\t\t\t}\n\n\t\t\treturn typeA;\n\n\t\t}\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst op = this.op;\n\n\t\tconst aNode = this.aNode;\n\t\tconst bNode = this.bNode;\n\n\t\tconst type = this.getNodeType( builder, output );\n\n\t\tlet typeA = null;\n\t\tlet typeB = null;\n\n\t\tif ( type !== 'void' ) {\n\n\t\t\ttypeA = aNode.getNodeType( builder );\n\t\t\ttypeB = typeof bNode !== 'undefined' ? bNode.getNodeType( builder ) : null;\n\n\t\t\tif ( op === '<' || op === '>' || op === '<=' || op === '>=' || op === '==' ) {\n\n\t\t\t\tif ( builder.isVector( typeA ) ) {\n\n\t\t\t\t\ttypeB = typeA;\n\n\t\t\t\t} else if ( typeA !== typeB ) {\n\n\t\t\t\t\ttypeA = typeB = 'float';\n\n\t\t\t\t}\n\n\t\t\t} else if ( op === '>>' || op === '<<' ) {\n\n\t\t\t\ttypeA = type;\n\t\t\t\ttypeB = builder.changeComponentType( typeB, 'uint' );\n\n\t\t\t} else if ( builder.isMatrix( typeA ) && builder.isVector( typeB ) ) {\n\n\t\t\t\t// matrix x vector\n\n\t\t\t\ttypeB = builder.getVectorFromMatrix( typeA );\n\n\t\t\t} else if ( builder.isVector( typeA ) && builder.isMatrix( typeB ) ) {\n\n\t\t\t\t// vector x matrix\n\n\t\t\t\ttypeA = builder.getVectorFromMatrix( typeB );\n\n\t\t\t} else {\n\n\t\t\t\t// anytype x anytype\n\n\t\t\t\ttypeA = typeB = type;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\ttypeA = typeB = type;\n\n\t\t}\n\n\t\tconst a = aNode.build( builder, typeA );\n\t\tconst b = typeof bNode !== 'undefined' ? bNode.build( builder, typeB ) : null;\n\n\t\tconst outputLength = builder.getTypeLength( output );\n\t\tconst fnOpSnippet = builder.getFunctionOperator( op );\n\n\t\tif ( output !== 'void' ) {\n\n\t\t\tif ( op === '<' && outputLength > 1 ) {\n\n\t\t\t\tif ( builder.useComparisonMethod ) {\n\n\t\t\t\t\treturn builder.format( `${ builder.getMethod( 'lessThan', output ) }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn builder.format( `( ${ a } < ${ b } )`, type, output );\n\n\t\t\t\t}\n\n\t\t\t} else if ( op === '<=' && outputLength > 1 ) {\n\n\t\t\t\tif ( builder.useComparisonMethod ) {\n\n\t\t\t\t\treturn builder.format( `${ builder.getMethod( 'lessThanEqual', output ) }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn builder.format( `( ${ a } <= ${ b } )`, type, output );\n\n\t\t\t\t}\n\n\t\t\t} else if ( op === '>' && outputLength > 1 ) {\n\n\t\t\t\tif ( builder.useComparisonMethod ) {\n\n\t\t\t\t\treturn builder.format( `${ builder.getMethod( 'greaterThan', output ) }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn builder.format( `( ${ a } > ${ b } )`, type, output );\n\n\t\t\t\t}\n\n\t\t\t} else if ( op === '>=' && outputLength > 1 ) {\n\n\t\t\t\tif ( builder.useComparisonMethod ) {\n\n\t\t\t\t\treturn builder.format( `${ builder.getMethod( 'greaterThanEqual', output ) }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn builder.format( `( ${ a } >= ${ b } )`, type, output );\n\n\t\t\t\t}\n\n\t\t\t} else if ( op === '!' || op === '~' ) {\n\n\t\t\t\treturn builder.format( `(${op}${a})`, typeA, output );\n\n\t\t\t} else if ( fnOpSnippet ) {\n\n\t\t\t\treturn builder.format( `${ fnOpSnippet }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t} else {\n\n\t\t\t\treturn builder.format( `( ${ a } ${ op } ${ b } )`, type, output );\n\n\t\t\t}\n\n\t\t} else if ( typeA !== 'void' ) {\n\n\t\t\tif ( fnOpSnippet ) {\n\n\t\t\t\treturn builder.format( `${ fnOpSnippet }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t} else {\n\n\t\t\t\treturn builder.format( `${ a } ${ op } ${ b }`, type, output );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.op = this.op;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.op = data.op;\n\n\t}\n\n}\n\nconst add = /*@__PURE__*/ nodeProxy( OperatorNode, '+' );\nconst sub = /*@__PURE__*/ nodeProxy( OperatorNode, '-' );\nconst mul = /*@__PURE__*/ nodeProxy( OperatorNode, '*' );\nconst div = /*@__PURE__*/ nodeProxy( OperatorNode, '/' );\nconst modInt = /*@__PURE__*/ nodeProxy( OperatorNode, '%' );\nconst equal = /*@__PURE__*/ nodeProxy( OperatorNode, '==' );\nconst notEqual = /*@__PURE__*/ nodeProxy( OperatorNode, '!=' );\nconst lessThan = /*@__PURE__*/ nodeProxy( OperatorNode, '<' );\nconst greaterThan = /*@__PURE__*/ nodeProxy( OperatorNode, '>' );\nconst lessThanEqual = /*@__PURE__*/ nodeProxy( OperatorNode, '<=' );\nconst greaterThanEqual = /*@__PURE__*/ nodeProxy( OperatorNode, '>=' );\nconst and = /*@__PURE__*/ nodeProxy( OperatorNode, '&&' );\nconst or = /*@__PURE__*/ nodeProxy( OperatorNode, '||' );\nconst not = /*@__PURE__*/ nodeProxy( OperatorNode, '!' );\nconst xor = /*@__PURE__*/ nodeProxy( OperatorNode, '^^' );\nconst bitAnd = /*@__PURE__*/ nodeProxy( OperatorNode, '&' );\nconst bitNot = /*@__PURE__*/ nodeProxy( OperatorNode, '~' );\nconst bitOr = /*@__PURE__*/ nodeProxy( OperatorNode, '|' );\nconst bitXor = /*@__PURE__*/ nodeProxy( OperatorNode, '^' );\nconst shiftLeft = /*@__PURE__*/ nodeProxy( OperatorNode, '<<' );\nconst shiftRight = /*@__PURE__*/ nodeProxy( OperatorNode, '>>' );\n\naddMethodChaining( 'add', add );\naddMethodChaining( 'sub', sub );\naddMethodChaining( 'mul', mul );\naddMethodChaining( 'div', div );\naddMethodChaining( 'modInt', modInt );\naddMethodChaining( 'equal', equal );\naddMethodChaining( 'notEqual', notEqual );\naddMethodChaining( 'lessThan', lessThan );\naddMethodChaining( 'greaterThan', greaterThan );\naddMethodChaining( 'lessThanEqual', lessThanEqual );\naddMethodChaining( 'greaterThanEqual', greaterThanEqual );\naddMethodChaining( 'and', and );\naddMethodChaining( 'or', or );\naddMethodChaining( 'not', not );\naddMethodChaining( 'xor', xor );\naddMethodChaining( 'bitAnd', bitAnd );\naddMethodChaining( 'bitNot', bitNot );\naddMethodChaining( 'bitOr', bitOr );\naddMethodChaining( 'bitXor', bitXor );\naddMethodChaining( 'shiftLeft', shiftLeft );\naddMethodChaining( 'shiftRight', shiftRight );\n\n\nconst remainder = ( ...params ) => { // @deprecated, r168\n\n\tconsole.warn( 'TSL.OperatorNode: .remainder() has been renamed to .modInt().' );\n\treturn modInt( ...params );\n\n};\n\naddMethodChaining( 'remainder', remainder );\n\nclass MathNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'MathNode';\n\n\t}\n\n\tconstructor( method, aNode, bNode = null, cNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.method = method;\n\n\t\tthis.aNode = aNode;\n\t\tthis.bNode = bNode;\n\t\tthis.cNode = cNode;\n\n\t}\n\n\tgetInputType( builder ) {\n\n\t\tconst aType = this.aNode.getNodeType( builder );\n\t\tconst bType = this.bNode ? this.bNode.getNodeType( builder ) : null;\n\t\tconst cType = this.cNode ? this.cNode.getNodeType( builder ) : null;\n\n\t\tconst aLen = builder.isMatrix( aType ) ? 0 : builder.getTypeLength( aType );\n\t\tconst bLen = builder.isMatrix( bType ) ? 0 : builder.getTypeLength( bType );\n\t\tconst cLen = builder.isMatrix( cType ) ? 0 : builder.getTypeLength( cType );\n\n\t\tif ( aLen > bLen && aLen > cLen ) {\n\n\t\t\treturn aType;\n\n\t\t} else if ( bLen > cLen ) {\n\n\t\t\treturn bType;\n\n\t\t} else if ( cLen > aLen ) {\n\n\t\t\treturn cType;\n\n\t\t}\n\n\t\treturn aType;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst method = this.method;\n\n\t\tif ( method === MathNode.LENGTH || method === MathNode.DISTANCE || method === MathNode.DOT ) {\n\n\t\t\treturn 'float';\n\n\t\t} else if ( method === MathNode.CROSS ) {\n\n\t\t\treturn 'vec3';\n\n\t\t} else if ( method === MathNode.ALL ) {\n\n\t\t\treturn 'bool';\n\n\t\t} else if ( method === MathNode.EQUALS ) {\n\n\t\t\treturn builder.changeComponentType( this.aNode.getNodeType( builder ), 'bool' );\n\n\t\t} else if ( method === MathNode.MOD ) {\n\n\t\t\treturn this.aNode.getNodeType( builder );\n\n\t\t} else {\n\n\t\t\treturn this.getInputType( builder );\n\n\t\t}\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst method = this.method;\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst inputType = this.getInputType( builder );\n\n\t\tconst a = this.aNode;\n\t\tconst b = this.bNode;\n\t\tconst c = this.cNode;\n\n\t\tconst isWebGL = builder.renderer.isWebGLRenderer === true;\n\n\t\tif ( method === MathNode.TRANSFORM_DIRECTION ) {\n\n\t\t\t// dir can be either a direction vector or a normal vector\n\t\t\t// upper-left 3x3 of matrix is assumed to be orthogonal\n\n\t\t\tlet tA = a;\n\t\t\tlet tB = b;\n\n\t\t\tif ( builder.isMatrix( tA.getNodeType( builder ) ) ) {\n\n\t\t\t\ttB = vec4( vec3( tB ), 0.0 );\n\n\t\t\t} else {\n\n\t\t\t\ttA = vec4( vec3( tA ), 0.0 );\n\n\t\t\t}\n\n\t\t\tconst mulNode = mul( tA, tB ).xyz;\n\n\t\t\treturn normalize( mulNode ).build( builder, output );\n\n\t\t} else if ( method === MathNode.NEGATE ) {\n\n\t\t\treturn builder.format( '( - ' + a.build( builder, inputType ) + ' )', type, output );\n\n\t\t} else if ( method === MathNode.ONE_MINUS ) {\n\n\t\t\treturn sub( 1.0, a ).build( builder, output );\n\n\t\t} else if ( method === MathNode.RECIPROCAL ) {\n\n\t\t\treturn div( 1.0, a ).build( builder, output );\n\n\t\t} else if ( method === MathNode.DIFFERENCE ) {\n\n\t\t\treturn abs( sub( a, b ) ).build( builder, output );\n\n\t\t} else {\n\n\t\t\tconst params = [];\n\n\t\t\tif ( method === MathNode.CROSS || method === MathNode.MOD ) {\n\n\t\t\t\tparams.push(\n\t\t\t\t\ta.build( builder, type ),\n\t\t\t\t\tb.build( builder, type )\n\t\t\t\t);\n\n\t\t\t} else if ( isWebGL && method === MathNode.STEP ) {\n\n\t\t\t\tparams.push(\n\t\t\t\t\ta.build( builder, builder.getTypeLength( a.getNodeType( builder ) ) === 1 ? 'float' : inputType ),\n\t\t\t\t\tb.build( builder, inputType )\n\t\t\t\t);\n\n\t\t\t} else if ( ( isWebGL && ( method === MathNode.MIN || method === MathNode.MAX ) ) || method === MathNode.MOD ) {\n\n\t\t\t\tparams.push(\n\t\t\t\t\ta.build( builder, inputType ),\n\t\t\t\t\tb.build( builder, builder.getTypeLength( b.getNodeType( builder ) ) === 1 ? 'float' : inputType )\n\t\t\t\t);\n\n\t\t\t} else if ( method === MathNode.REFRACT ) {\n\n\t\t\t\tparams.push(\n\t\t\t\t\ta.build( builder, inputType ),\n\t\t\t\t\tb.build( builder, inputType ),\n\t\t\t\t\tc.build( builder, 'float' )\n\t\t\t\t);\n\n\t\t\t} else if ( method === MathNode.MIX ) {\n\n\t\t\t\tparams.push(\n\t\t\t\t\ta.build( builder, inputType ),\n\t\t\t\t\tb.build( builder, inputType ),\n\t\t\t\t\tc.build( builder, builder.getTypeLength( c.getNodeType( builder ) ) === 1 ? 'float' : inputType )\n\t\t\t\t);\n\n\t\t\t} else {\n\n\t\t\t\tparams.push( a.build( builder, inputType ) );\n\t\t\t\tif ( b !== null ) params.push( b.build( builder, inputType ) );\n\t\t\t\tif ( c !== null ) params.push( c.build( builder, inputType ) );\n\n\t\t\t}\n\n\t\t\treturn builder.format( `${ builder.getMethod( method, type ) }( ${params.join( ', ' )} )`, type, output );\n\n\t\t}\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.method = this.method;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.method = data.method;\n\n\t}\n\n}\n\n// 1 input\n\nMathNode.ALL = 'all';\nMathNode.ANY = 'any';\nMathNode.EQUALS = 'equals';\n\nMathNode.RADIANS = 'radians';\nMathNode.DEGREES = 'degrees';\nMathNode.EXP = 'exp';\nMathNode.EXP2 = 'exp2';\nMathNode.LOG = 'log';\nMathNode.LOG2 = 'log2';\nMathNode.SQRT = 'sqrt';\nMathNode.INVERSE_SQRT = 'inversesqrt';\nMathNode.FLOOR = 'floor';\nMathNode.CEIL = 'ceil';\nMathNode.NORMALIZE = 'normalize';\nMathNode.FRACT = 'fract';\nMathNode.SIN = 'sin';\nMathNode.COS = 'cos';\nMathNode.TAN = 'tan';\nMathNode.ASIN = 'asin';\nMathNode.ACOS = 'acos';\nMathNode.ATAN = 'atan';\nMathNode.ABS = 'abs';\nMathNode.SIGN = 'sign';\nMathNode.LENGTH = 'length';\nMathNode.NEGATE = 'negate';\nMathNode.ONE_MINUS = 'oneMinus';\nMathNode.DFDX = 'dFdx';\nMathNode.DFDY = 'dFdy';\nMathNode.ROUND = 'round';\nMathNode.RECIPROCAL = 'reciprocal';\nMathNode.TRUNC = 'trunc';\nMathNode.FWIDTH = 'fwidth';\nMathNode.BITCAST = 'bitcast';\nMathNode.TRANSPOSE = 'transpose';\n\n// 2 inputs\n\nMathNode.ATAN2 = 'atan2';\nMathNode.MIN = 'min';\nMathNode.MAX = 'max';\nMathNode.MOD = 'mod';\nMathNode.STEP = 'step';\nMathNode.REFLECT = 'reflect';\nMathNode.DISTANCE = 'distance';\nMathNode.DIFFERENCE = 'difference';\nMathNode.DOT = 'dot';\nMathNode.CROSS = 'cross';\nMathNode.POW = 'pow';\nMathNode.TRANSFORM_DIRECTION = 'transformDirection';\n\n// 3 inputs\n\nMathNode.MIX = 'mix';\nMathNode.CLAMP = 'clamp';\nMathNode.REFRACT = 'refract';\nMathNode.SMOOTHSTEP = 'smoothstep';\nMathNode.FACEFORWARD = 'faceforward';\n\nconst EPSILON = /*@__PURE__*/ float( 1e-6 );\nconst INFINITY = /*@__PURE__*/ float( 1e6 );\nconst PI = /*@__PURE__*/ float( Math.PI );\nconst PI2 = /*@__PURE__*/ float( Math.PI * 2 );\n\nconst all = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ALL );\nconst any = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ANY );\nconst equals = /*@__PURE__*/ nodeProxy( MathNode, MathNode.EQUALS );\n\nconst radians = /*@__PURE__*/ nodeProxy( MathNode, MathNode.RADIANS );\nconst degrees = /*@__PURE__*/ nodeProxy( MathNode, MathNode.DEGREES );\nconst exp = /*@__PURE__*/ nodeProxy( MathNode, MathNode.EXP );\nconst exp2 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.EXP2 );\nconst log = /*@__PURE__*/ nodeProxy( MathNode, MathNode.LOG );\nconst log2 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.LOG2 );\nconst sqrt = /*@__PURE__*/ nodeProxy( MathNode, MathNode.SQRT );\nconst inverseSqrt = /*@__PURE__*/ nodeProxy( MathNode, MathNode.INVERSE_SQRT );\nconst floor = /*@__PURE__*/ nodeProxy( MathNode, MathNode.FLOOR );\nconst ceil = /*@__PURE__*/ nodeProxy( MathNode, MathNode.CEIL );\nconst normalize = /*@__PURE__*/ nodeProxy( MathNode, MathNode.NORMALIZE );\nconst fract = /*@__PURE__*/ nodeProxy( MathNode, MathNode.FRACT );\nconst sin = /*@__PURE__*/ nodeProxy( MathNode, MathNode.SIN );\nconst cos = /*@__PURE__*/ nodeProxy( MathNode, MathNode.COS );\nconst tan = /*@__PURE__*/ nodeProxy( MathNode, MathNode.TAN );\nconst asin = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ASIN );\nconst acos = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ACOS );\nconst atan = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ATAN );\nconst abs = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ABS );\nconst sign = /*@__PURE__*/ nodeProxy( MathNode, MathNode.SIGN );\nconst length = /*@__PURE__*/ nodeProxy( MathNode, MathNode.LENGTH );\nconst negate = /*@__PURE__*/ nodeProxy( MathNode, MathNode.NEGATE );\nconst oneMinus = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ONE_MINUS );\nconst dFdx = /*@__PURE__*/ nodeProxy( MathNode, MathNode.DFDX );\nconst dFdy = /*@__PURE__*/ nodeProxy( MathNode, MathNode.DFDY );\nconst round = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ROUND );\nconst reciprocal = /*@__PURE__*/ nodeProxy( MathNode, MathNode.RECIPROCAL );\nconst trunc = /*@__PURE__*/ nodeProxy( MathNode, MathNode.TRUNC );\nconst fwidth = /*@__PURE__*/ nodeProxy( MathNode, MathNode.FWIDTH );\nconst bitcast = /*@__PURE__*/ nodeProxy( MathNode, MathNode.BITCAST );\nconst transpose = /*@__PURE__*/ nodeProxy( MathNode, MathNode.TRANSPOSE );\n\nconst atan2 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ATAN2 );\nconst min$1 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.MIN );\nconst max$1 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.MAX );\nconst mod = /*@__PURE__*/ nodeProxy( MathNode, MathNode.MOD );\nconst step = /*@__PURE__*/ nodeProxy( MathNode, MathNode.STEP );\nconst reflect = /*@__PURE__*/ nodeProxy( MathNode, MathNode.REFLECT );\nconst distance = /*@__PURE__*/ nodeProxy( MathNode, MathNode.DISTANCE );\nconst difference = /*@__PURE__*/ nodeProxy( MathNode, MathNode.DIFFERENCE );\nconst dot = /*@__PURE__*/ nodeProxy( MathNode, MathNode.DOT );\nconst cross = /*@__PURE__*/ nodeProxy( MathNode, MathNode.CROSS );\nconst pow = /*@__PURE__*/ nodeProxy( MathNode, MathNode.POW );\nconst pow2 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.POW, 2 );\nconst pow3 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.POW, 3 );\nconst pow4 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.POW, 4 );\nconst transformDirection = /*@__PURE__*/ nodeProxy( MathNode, MathNode.TRANSFORM_DIRECTION );\n\nconst cbrt = ( a ) => mul( sign( a ), pow( abs( a ), 1.0 / 3.0 ) );\nconst lengthSq = ( a ) => dot( a, a );\nconst mix = /*@__PURE__*/ nodeProxy( MathNode, MathNode.MIX );\nconst clamp = ( value, low = 0, high = 1 ) => nodeObject( new MathNode( MathNode.CLAMP, nodeObject( value ), nodeObject( low ), nodeObject( high ) ) );\nconst saturate = ( value ) => clamp( value );\nconst refract = /*@__PURE__*/ nodeProxy( MathNode, MathNode.REFRACT );\nconst smoothstep = /*@__PURE__*/ nodeProxy( MathNode, MathNode.SMOOTHSTEP );\nconst faceForward = /*@__PURE__*/ nodeProxy( MathNode, MathNode.FACEFORWARD );\n\nconst rand = /*@__PURE__*/ Fn( ( [ uv ] ) => {\n\n\tconst a = 12.9898, b = 78.233, c = 43758.5453;\n\tconst dt = dot( uv.xy, vec2( a, b ) ), sn = mod( dt, PI );\n\n\treturn fract( sin( sn ).mul( c ) );\n\n} );\n\nconst mixElement = ( t, e1, e2 ) => mix( e1, e2, t );\nconst smoothstepElement = ( x, low, high ) => smoothstep( low, high, x );\n\naddMethodChaining( 'all', all );\naddMethodChaining( 'any', any );\naddMethodChaining( 'equals', equals );\n\naddMethodChaining( 'radians', radians );\naddMethodChaining( 'degrees', degrees );\naddMethodChaining( 'exp', exp );\naddMethodChaining( 'exp2', exp2 );\naddMethodChaining( 'log', log );\naddMethodChaining( 'log2', log2 );\naddMethodChaining( 'sqrt', sqrt );\naddMethodChaining( 'inverseSqrt', inverseSqrt );\naddMethodChaining( 'floor', floor );\naddMethodChaining( 'ceil', ceil );\naddMethodChaining( 'normalize', normalize );\naddMethodChaining( 'fract', fract );\naddMethodChaining( 'sin', sin );\naddMethodChaining( 'cos', cos );\naddMethodChaining( 'tan', tan );\naddMethodChaining( 'asin', asin );\naddMethodChaining( 'acos', acos );\naddMethodChaining( 'atan', atan );\naddMethodChaining( 'abs', abs );\naddMethodChaining( 'sign', sign );\naddMethodChaining( 'length', length );\naddMethodChaining( 'lengthSq', lengthSq );\naddMethodChaining( 'negate', negate );\naddMethodChaining( 'oneMinus', oneMinus );\naddMethodChaining( 'dFdx', dFdx );\naddMethodChaining( 'dFdy', dFdy );\naddMethodChaining( 'round', round );\naddMethodChaining( 'reciprocal', reciprocal );\naddMethodChaining( 'trunc', trunc );\naddMethodChaining( 'fwidth', fwidth );\naddMethodChaining( 'atan2', atan2 );\naddMethodChaining( 'min', min$1 );\naddMethodChaining( 'max', max$1 );\naddMethodChaining( 'mod', mod );\naddMethodChaining( 'step', step );\naddMethodChaining( 'reflect', reflect );\naddMethodChaining( 'distance', distance );\naddMethodChaining( 'dot', dot );\naddMethodChaining( 'cross', cross );\naddMethodChaining( 'pow', pow );\naddMethodChaining( 'pow2', pow2 );\naddMethodChaining( 'pow3', pow3 );\naddMethodChaining( 'pow4', pow4 );\naddMethodChaining( 'transformDirection', transformDirection );\naddMethodChaining( 'mix', mixElement );\naddMethodChaining( 'clamp', clamp );\naddMethodChaining( 'refract', refract );\naddMethodChaining( 'smoothstep', smoothstepElement );\naddMethodChaining( 'faceForward', faceForward );\naddMethodChaining( 'difference', difference );\naddMethodChaining( 'saturate', saturate );\naddMethodChaining( 'cbrt', cbrt );\naddMethodChaining( 'transpose', transpose );\naddMethodChaining( 'rand', rand );\n\nclass ConditionalNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ConditionalNode';\n\n\t}\n\n\tconstructor( condNode, ifNode, elseNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.condNode = condNode;\n\n\t\tthis.ifNode = ifNode;\n\t\tthis.elseNode = elseNode;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst ifType = this.ifNode.getNodeType( builder );\n\n\t\tif ( this.elseNode !== null ) {\n\n\t\t\tconst elseType = this.elseNode.getNodeType( builder );\n\n\t\t\tif ( builder.getTypeLength( elseType ) > builder.getTypeLength( ifType ) ) {\n\n\t\t\t\treturn elseType;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn ifType;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst condNode = this.condNode.cache();\n\t\tconst ifNode = this.ifNode.cache();\n\t\tconst elseNode = this.elseNode ? this.elseNode.cache() : null;\n\n\t\t//\n\n\t\tconst currentNodeBlock = builder.context.nodeBlock;\n\n\t\tbuilder.getDataFromNode( ifNode ).parentNodeBlock = currentNodeBlock;\n\t\tif ( elseNode !== null ) builder.getDataFromNode( elseNode ).parentNodeBlock = currentNodeBlock;\n\n\t\t//\n\n\t\tconst properties = builder.getNodeProperties( this );\n\t\tproperties.condNode = condNode;\n\t\tproperties.ifNode = ifNode.context( { nodeBlock: ifNode } );\n\t\tproperties.elseNode = elseNode ? elseNode.context( { nodeBlock: elseNode } ) : null;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst type = this.getNodeType( builder );\n\n\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\tif ( nodeData.nodeProperty !== undefined ) {\n\n\t\t\treturn nodeData.nodeProperty;\n\n\t\t}\n\n\t\tconst { condNode, ifNode, elseNode } = builder.getNodeProperties( this );\n\n\t\tconst needsOutput = output !== 'void';\n\t\tconst nodeProperty = needsOutput ? property( type ).build( builder ) : '';\n\n\t\tnodeData.nodeProperty = nodeProperty;\n\n\t\tconst nodeSnippet = condNode.build( builder, 'bool' );\n\n\t\tbuilder.addFlowCode( `\\n${ builder.tab }if ( ${ nodeSnippet } ) {\\n\\n` ).addFlowTab();\n\n\t\tlet ifSnippet = ifNode.build( builder, type );\n\n\t\tif ( ifSnippet ) {\n\n\t\t\tif ( needsOutput ) {\n\n\t\t\t\tifSnippet = nodeProperty + ' = ' + ifSnippet + ';';\n\n\t\t\t} else {\n\n\t\t\t\tifSnippet = 'return ' + ifSnippet + ';';\n\n\t\t\t}\n\n\t\t}\n\n\t\tbuilder.removeFlowTab().addFlowCode( builder.tab + '\\t' + ifSnippet + '\\n\\n' + builder.tab + '}' );\n\n\t\tif ( elseNode !== null ) {\n\n\t\t\tbuilder.addFlowCode( ' else {\\n\\n' ).addFlowTab();\n\n\t\t\tlet elseSnippet = elseNode.build( builder, type );\n\n\t\t\tif ( elseSnippet ) {\n\n\t\t\t\tif ( needsOutput ) {\n\n\t\t\t\t\telseSnippet = nodeProperty + ' = ' + elseSnippet + ';';\n\n\t\t\t\t} else {\n\n\t\t\t\t\telseSnippet = 'return ' + elseSnippet + ';';\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tbuilder.removeFlowTab().addFlowCode( builder.tab + '\\t' + elseSnippet + '\\n\\n' + builder.tab + '}\\n\\n' );\n\n\t\t} else {\n\n\t\t\tbuilder.addFlowCode( '\\n\\n' );\n\n\t\t}\n\n\t\treturn builder.format( nodeProperty, type, output );\n\n\t}\n\n}\n\nconst select = /*@__PURE__*/ nodeProxy( ConditionalNode );\n\naddMethodChaining( 'select', select );\n\n//\n\nconst cond = ( ...params ) => { // @deprecated, r168\n\n\tconsole.warn( 'TSL.ConditionalNode: cond() has been renamed to select().' );\n\treturn select( ...params );\n\n};\n\naddMethodChaining( 'cond', cond );\n\nclass ContextNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ContextNode';\n\n\t}\n\n\tconstructor( node, value = {} ) {\n\n\t\tsuper();\n\n\t\tthis.isContextNode = true;\n\n\t\tthis.node = node;\n\t\tthis.value = value;\n\n\t}\n\n\tgetScope() {\n\n\t\treturn this.node.getScope();\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tanalyze( builder ) {\n\n\t\tthis.node.build( builder );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst previousContext = builder.getContext();\n\n\t\tbuilder.setContext( { ...builder.context, ...this.value } );\n\n\t\tconst node = this.node.build( builder );\n\n\t\tbuilder.setContext( previousContext );\n\n\t\treturn node;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst previousContext = builder.getContext();\n\n\t\tbuilder.setContext( { ...builder.context, ...this.value } );\n\n\t\tconst snippet = this.node.build( builder, output );\n\n\t\tbuilder.setContext( previousContext );\n\n\t\treturn snippet;\n\n\t}\n\n}\n\nconst context = /*@__PURE__*/ nodeProxy( ContextNode );\nconst label = ( node, name ) => context( node, { label: name } );\n\naddMethodChaining( 'context', context );\naddMethodChaining( 'label', label );\n\nclass VarNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'VarNode';\n\n\t}\n\n\tconstructor( node, name = null ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.name = name;\n\n\t\tthis.global = true;\n\n\t\tthis.isVarNode = true;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\treturn this.name || super.getHash( builder );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { node, name } = this;\n\n\t\tconst nodeVar = builder.getVarFromNode( this, name, builder.getVectorType( this.getNodeType( builder ) ) );\n\n\t\tconst propertyName = builder.getPropertyName( nodeVar );\n\n\t\tconst snippet = node.build( builder, nodeVar.type );\n\n\t\tbuilder.addLineFlowCode( `${propertyName} = ${snippet}`, this );\n\n\t\treturn propertyName;\n\n\t}\n\n}\n\nconst createVar = /*@__PURE__*/ nodeProxy( VarNode );\n\naddMethodChaining( 'toVar', ( ...params ) => createVar( ...params ).append() );\n\n// Deprecated\n\nconst temp = ( node ) => { // @deprecated, r170\n\n\tconsole.warn( 'TSL: \"temp\" is deprecated. Use \".toVar()\" instead.' );\n\n\treturn createVar( node );\n\n};\n\naddMethodChaining( 'temp', temp );\n\nclass VaryingNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'VaryingNode';\n\n\t}\n\n\tconstructor( node, name = null ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.name = name;\n\n\t\tthis.isVaryingNode = true;\n\n\t}\n\n\tisGlobal() {\n\n\t\treturn true;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\treturn this.name || super.getHash( builder );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\t// VaryingNode is auto type\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tsetupVarying( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\tlet varying = properties.varying;\n\n\t\tif ( varying === undefined ) {\n\n\t\t\tconst name = this.name;\n\t\t\tconst type = this.getNodeType( builder );\n\n\t\t\tproperties.varying = varying = builder.getVaryingFromNode( this, name, type );\n\t\t\tproperties.node = this.node;\n\n\t\t}\n\n\t\t// this property can be used to check if the varying can be optimized for a variable\n\t\tvarying.needsInterpolation || ( varying.needsInterpolation = ( builder.shaderStage === 'fragment' ) );\n\n\t\treturn varying;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.setupVarying( builder );\n\n\t}\n\n\tanalyze( builder ) {\n\n\t\tthis.setupVarying( builder );\n\n\t\treturn this.node.analyze( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\t\tconst varying = this.setupVarying( builder );\n\n\t\tif ( properties.propertyName === undefined ) {\n\n\t\t\tconst type = this.getNodeType( builder );\n\t\t\tconst propertyName = builder.getPropertyName( varying, NodeShaderStage.VERTEX );\n\n\t\t\t// force node run in vertex stage\n\t\t\tbuilder.flowNodeFromShaderStage( NodeShaderStage.VERTEX, this.node, type, propertyName );\n\n\t\t\tproperties.propertyName = propertyName;\n\n\t\t}\n\n\t\treturn builder.getPropertyName( varying );\n\n\t}\n\n}\n\nconst varying = /*@__PURE__*/ nodeProxy( VaryingNode );\n\naddMethodChaining( 'varying', varying );\n\nconst sRGBTransferEOTF = /*@__PURE__*/ Fn( ( [ color ] ) => {\n\n\tconst a = color.mul( 0.9478672986 ).add( 0.0521327014 ).pow( 2.4 );\n\tconst b = color.mul( 0.0773993808 );\n\tconst factor = color.lessThanEqual( 0.04045 );\n\n\tconst rgbResult = mix( a, b, factor );\n\n\treturn rgbResult;\n\n} ).setLayout( {\n\tname: 'sRGBTransferEOTF',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' }\n\t]\n} );\n\nconst sRGBTransferOETF = /*@__PURE__*/ Fn( ( [ color ] ) => {\n\n\tconst a = color.pow( 0.41666 ).mul( 1.055 ).sub( 0.055 );\n\tconst b = color.mul( 12.92 );\n\tconst factor = color.lessThanEqual( 0.0031308 );\n\n\tconst rgbResult = mix( a, b, factor );\n\n\treturn rgbResult;\n\n} ).setLayout( {\n\tname: 'sRGBTransferOETF',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' }\n\t]\n} );\n\nconst WORKING_COLOR_SPACE = 'WorkingColorSpace';\nconst OUTPUT_COLOR_SPACE = 'OutputColorSpace';\n\nclass ColorSpaceNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'ColorSpaceNode';\n\n\t}\n\n\tconstructor( colorNode, source, target ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.colorNode = colorNode;\n\t\tthis.source = source;\n\t\tthis.target = target;\n\n\t}\n\n\tresolveColorSpace( builder, colorSpace ) {\n\n\t\tif ( colorSpace === WORKING_COLOR_SPACE ) {\n\n\t\t\treturn ColorManagement.workingColorSpace;\n\n\t\t} else if ( colorSpace === OUTPUT_COLOR_SPACE ) {\n\n\t\t\treturn builder.context.outputColorSpace || builder.renderer.outputColorSpace;\n\n\t\t}\n\n\t\treturn colorSpace;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { colorNode } = this;\n\n\t\tconst source = this.resolveColorSpace( builder, this.source );\n\t\tconst target = this.resolveColorSpace( builder, this.target );\n\n\t\tlet outputNode = colorNode;\n\n\t\tif ( ColorManagement.enabled === false || source === target || ! source || ! target ) {\n\n\t\t\treturn outputNode;\n\n\t\t}\n\n\t\tif ( ColorManagement.getTransfer( source ) === SRGBTransfer ) {\n\n\t\t\toutputNode = vec4( sRGBTransferEOTF( outputNode.rgb ), outputNode.a );\n\n\t\t}\n\n\t\tif ( ColorManagement.getPrimaries( source ) !== ColorManagement.getPrimaries( target ) ) {\n\n\t\t\toutputNode = vec4(\n\t\t\t\tmat3( ColorManagement._getMatrix( new Matrix3(), source, target ) ).mul( outputNode.rgb ),\n\t\t\t\toutputNode.a\n\t\t\t);\n\n\t\t}\n\n\t\tif ( ColorManagement.getTransfer( target ) === SRGBTransfer ) {\n\n\t\t\toutputNode = vec4( sRGBTransferOETF( outputNode.rgb ), outputNode.a );\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n}\n\nconst toOutputColorSpace = ( node ) => nodeObject( new ColorSpaceNode( nodeObject( node ), WORKING_COLOR_SPACE, OUTPUT_COLOR_SPACE ) );\nconst toWorkingColorSpace = ( node ) => nodeObject( new ColorSpaceNode( nodeObject( node ), OUTPUT_COLOR_SPACE, WORKING_COLOR_SPACE ) );\n\nconst workingToColorSpace = ( node, colorSpace ) => nodeObject( new ColorSpaceNode( nodeObject( node ), WORKING_COLOR_SPACE, colorSpace ) );\nconst colorSpaceToWorking = ( node, colorSpace ) => nodeObject( new ColorSpaceNode( nodeObject( node ), colorSpace, WORKING_COLOR_SPACE ) );\n\nconst convertColorSpace = ( node, sourceColorSpace, targetColorSpace ) => nodeObject( new ColorSpaceNode( nodeObject( node ), sourceColorSpace, targetColorSpace ) );\n\naddMethodChaining( 'toOutputColorSpace', toOutputColorSpace );\naddMethodChaining( 'toWorkingColorSpace', toWorkingColorSpace );\n\naddMethodChaining( 'workingToColorSpace', workingToColorSpace );\naddMethodChaining( 'colorSpaceToWorking', colorSpaceToWorking );\n\nlet ReferenceElementNode$1 = class ReferenceElementNode extends ArrayElementNode {\n\n\tstatic get type() {\n\n\t\treturn 'ReferenceElementNode';\n\n\t}\n\n\tconstructor( referenceNode, indexNode ) {\n\n\t\tsuper( referenceNode, indexNode );\n\n\t\tthis.referenceNode = referenceNode;\n\n\t\tthis.isReferenceElementNode = true;\n\n\t}\n\n\tgetNodeType() {\n\n\t\treturn this.referenceNode.uniformType;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst snippet = super.generate( builder );\n\t\tconst arrayType = this.referenceNode.getNodeType();\n\t\tconst elementType = this.getNodeType();\n\n\t\treturn builder.format( snippet, arrayType, elementType );\n\n\t}\n\n};\n\nclass ReferenceBaseNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ReferenceBaseNode';\n\n\t}\n\n\tconstructor( property, uniformType, object = null, count = null ) {\n\n\t\tsuper();\n\n\t\tthis.property = property;\n\t\tthis.uniformType = uniformType;\n\t\tthis.object = object;\n\t\tthis.count = count;\n\n\t\tthis.properties = property.split( '.' );\n\t\tthis.reference = object;\n\t\tthis.node = null;\n\t\tthis.group = null;\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\n\t}\n\n\tsetGroup( group ) {\n\n\t\tthis.group = group;\n\n\t\treturn this;\n\n\t}\n\n\telement( indexNode ) {\n\n\t\treturn nodeObject( new ReferenceElementNode$1( this, nodeObject( indexNode ) ) );\n\n\t}\n\n\tsetNodeType( uniformType ) {\n\n\t\tconst node = uniform( null, uniformType ).getSelf();\n\n\t\tif ( this.group !== null ) {\n\n\t\t\tnode.setGroup( this.group );\n\n\t\t}\n\n\t\tthis.node = node;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tif ( this.node === null ) {\n\n\t\t\tthis.updateReference( builder );\n\t\t\tthis.updateValue();\n\n\t\t}\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tgetValueFromReference( object = this.reference ) {\n\n\t\tconst { properties } = this;\n\n\t\tlet value = object[ properties[ 0 ] ];\n\n\t\tfor ( let i = 1; i < properties.length; i ++ ) {\n\n\t\t\tvalue = value[ properties[ i ] ];\n\n\t\t}\n\n\t\treturn value;\n\n\t}\n\n\tupdateReference( state ) {\n\n\t\tthis.reference = this.object !== null ? this.object : state.object;\n\n\t\treturn this.reference;\n\n\t}\n\n\tsetup() {\n\n\t\tthis.updateValue();\n\n\t\treturn this.node;\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tthis.updateValue();\n\n\t}\n\n\tupdateValue() {\n\n\t\tif ( this.node === null ) this.setNodeType( this.uniformType );\n\n\t\tconst value = this.getValueFromReference();\n\n\t\tif ( Array.isArray( value ) ) {\n\n\t\t\tthis.node.array = value;\n\n\t\t} else {\n\n\t\t\tthis.node.value = value;\n\n\t\t}\n\n\t}\n\n}\n\nconst reference$1 = ( name, type, object ) => nodeObject( new ReferenceBaseNode( name, type, object ) );\n\nclass RendererReferenceNode extends ReferenceBaseNode {\n\n\tstatic get type() {\n\n\t\treturn 'RendererReferenceNode';\n\n\t}\n\n\tconstructor( property, inputType, renderer = null ) {\n\n\t\tsuper( property, inputType, renderer );\n\n\t\tthis.renderer = renderer;\n\n\t\tthis.setGroup( renderGroup );\n\n\t}\n\n\tupdateReference( state ) {\n\n\t\tthis.reference = this.renderer !== null ? this.renderer : state.renderer;\n\n\t\treturn this.reference;\n\n\t}\n\n}\n\nconst rendererReference = ( name, type, renderer ) => nodeObject( new RendererReferenceNode( name, type, renderer ) );\n\nclass ToneMappingNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'ToneMappingNode';\n\n\t}\n\n\tconstructor( toneMapping, exposureNode = toneMappingExposure, colorNode = null ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.toneMapping = toneMapping;\n\n\t\tthis.exposureNode = exposureNode;\n\t\tthis.colorNode = colorNode;\n\n\t}\n\n\tgetCacheKey() {\n\n\t\treturn hash$1( super.getCacheKey(), this.toneMapping );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst colorNode = this.colorNode || builder.context.color;\n\t\tconst toneMapping = this.toneMapping;\n\n\t\tif ( toneMapping === NoToneMapping ) return colorNode;\n\n\t\tlet outputNode = null;\n\n\t\tconst toneMappingFn = builder.renderer.library.getToneMappingFunction( toneMapping );\n\n\t\tif ( toneMappingFn !== null ) {\n\n\t\t\toutputNode = vec4( toneMappingFn( colorNode.rgb, this.exposureNode ), colorNode.a );\n\n\t\t} else {\n\n\t\t\tconsole.error( 'ToneMappingNode: Unsupported Tone Mapping configuration.', toneMapping );\n\n\t\t\toutputNode = colorNode;\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n}\n\nconst toneMapping = ( mapping, exposure, color ) => nodeObject( new ToneMappingNode( mapping, nodeObject( exposure ), nodeObject( color ) ) );\nconst toneMappingExposure = /*@__PURE__*/ rendererReference( 'toneMappingExposure', 'float' );\n\naddMethodChaining( 'toneMapping', ( color, mapping, exposure ) => toneMapping( mapping, exposure, color ) );\n\nclass BufferAttributeNode extends InputNode {\n\n\tstatic get type() {\n\n\t\treturn 'BufferAttributeNode';\n\n\t}\n\n\tconstructor( value, bufferType = null, bufferStride = 0, bufferOffset = 0 ) {\n\n\t\tsuper( value, bufferType );\n\n\t\tthis.isBufferNode = true;\n\n\t\tthis.bufferType = bufferType;\n\t\tthis.bufferStride = bufferStride;\n\t\tthis.bufferOffset = bufferOffset;\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.instanced = false;\n\n\t\tthis.attribute = null;\n\n\t\tthis.global = true;\n\n\t\tif ( value && value.isBufferAttribute === true ) {\n\n\t\t\tthis.attribute = value;\n\t\t\tthis.usage = value.usage;\n\t\t\tthis.instanced = value.isInstancedBufferAttribute;\n\n\t\t}\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\tif ( this.bufferStride === 0 && this.bufferOffset === 0 ) {\n\n\t\t\tlet bufferData = builder.globalCache.getData( this.value );\n\n\t\t\tif ( bufferData === undefined ) {\n\n\t\t\t\tbufferData = {\n\t\t\t\t\tnode: this\n\t\t\t\t};\n\n\t\t\t\tbuilder.globalCache.setData( this.value, bufferData );\n\n\t\t\t}\n\n\t\t\treturn bufferData.node.uuid;\n\n\t\t}\n\n\t\treturn this.uuid;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tif ( this.bufferType === null ) {\n\n\t\t\tthis.bufferType = builder.getTypeFromAttribute( this.attribute );\n\n\t\t}\n\n\t\treturn this.bufferType;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( this.attribute !== null ) return;\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst array = this.value;\n\t\tconst itemSize = builder.getTypeLength( type );\n\t\tconst stride = this.bufferStride || itemSize;\n\t\tconst offset = this.bufferOffset;\n\n\t\tconst buffer = array.isInterleavedBuffer === true ? array : new InterleavedBuffer( array, stride );\n\t\tconst bufferAttribute = new InterleavedBufferAttribute( buffer, itemSize, offset );\n\n\t\tbuffer.setUsage( this.usage );\n\n\t\tthis.attribute = bufferAttribute;\n\t\tthis.attribute.isInstancedBufferAttribute = this.instanced; // @TODO: Add a possible: InstancedInterleavedBufferAttribute\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst nodeType = this.getNodeType( builder );\n\n\t\tconst nodeAttribute = builder.getBufferAttributeFromNode( this, nodeType );\n\t\tconst propertyName = builder.getPropertyName( nodeAttribute );\n\n\t\tlet output = null;\n\n\t\tif ( builder.shaderStage === 'vertex' || builder.shaderStage === 'compute' ) {\n\n\t\t\tthis.name = propertyName;\n\n\t\t\toutput = propertyName;\n\n\t\t} else {\n\n\t\t\tconst nodeVarying = varying( this );\n\n\t\t\toutput = nodeVarying.build( builder, nodeType );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'bufferAttribute';\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\tif ( this.attribute && this.attribute.isBufferAttribute === true ) {\n\n\t\t\tthis.attribute.usage = value;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetInstanced( value ) {\n\n\t\tthis.instanced = value;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst bufferAttribute = ( array, type, stride, offset ) => nodeObject( new BufferAttributeNode( array, type, stride, offset ) );\nconst dynamicBufferAttribute = ( array, type, stride, offset ) => bufferAttribute( array, type, stride, offset ).setUsage( DynamicDrawUsage );\n\nconst instancedBufferAttribute = ( array, type, stride, offset ) => bufferAttribute( array, type, stride, offset ).setInstanced( true );\nconst instancedDynamicBufferAttribute = ( array, type, stride, offset ) => dynamicBufferAttribute( array, type, stride, offset ).setInstanced( true );\n\naddMethodChaining( 'toAttribute', ( bufferNode ) => bufferAttribute( bufferNode.value ) );\n\nclass ComputeNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ComputeNode';\n\n\t}\n\n\tconstructor( computeNode, count, workgroupSize = [ 64 ] ) {\n\n\t\tsuper( 'void' );\n\n\t\tthis.isComputeNode = true;\n\n\t\tthis.computeNode = computeNode;\n\n\t\tthis.count = count;\n\t\tthis.workgroupSize = workgroupSize;\n\t\tthis.dispatchCount = 0;\n\n\t\tthis.version = 1;\n\t\tthis.updateBeforeType = NodeUpdateType.OBJECT;\n\n\t\tthis.onInitFunction = null;\n\n\t\tthis.updateDispatchCount();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tupdateDispatchCount() {\n\n\t\tconst { count, workgroupSize } = this;\n\n\t\tlet size = workgroupSize[ 0 ];\n\n\t\tfor ( let i = 1; i < workgroupSize.length; i ++ )\n\t\t\tsize *= workgroupSize[ i ];\n\n\t\tthis.dispatchCount = Math.ceil( count / size );\n\n\t}\n\n\tonInit( callback ) {\n\n\t\tthis.onInitFunction = callback;\n\n\t\treturn this;\n\n\t}\n\n\tupdateBefore( { renderer } ) {\n\n\t\trenderer.compute( this );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { shaderStage } = builder;\n\n\t\tif ( shaderStage === 'compute' ) {\n\n\t\t\tconst snippet = this.computeNode.build( builder, 'void' );\n\n\t\t\tif ( snippet !== '' ) {\n\n\t\t\t\tbuilder.addLineFlowCode( snippet, this );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nconst compute = ( node, count, workgroupSize ) => nodeObject( new ComputeNode( nodeObject( node ), count, workgroupSize ) );\n\naddMethodChaining( 'compute', compute );\n\nclass CacheNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'CacheNode';\n\n\t}\n\n\tconstructor( node, parent = true ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.parent = parent;\n\n\t\tthis.isCacheNode = true;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tbuild( builder, ...params ) {\n\n\t\tconst previousCache = builder.getCache();\n\t\tconst cache = builder.getCacheFromNode( this, this.parent );\n\n\t\tbuilder.setCache( cache );\n\n\t\tconst data = this.node.build( builder, ...params );\n\n\t\tbuilder.setCache( previousCache );\n\n\t\treturn data;\n\n\t}\n\n}\n\nconst cache = ( node, ...params ) => nodeObject( new CacheNode( nodeObject( node ), ...params ) );\n\naddMethodChaining( 'cache', cache );\n\nclass BypassNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'BypassNode';\n\n\t}\n\n\tconstructor( returnNode, callNode ) {\n\n\t\tsuper();\n\n\t\tthis.isBypassNode = true;\n\n\t\tthis.outputNode = returnNode;\n\t\tthis.callNode = callNode;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.outputNode.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst snippet = this.callNode.build( builder, 'void' );\n\n\t\tif ( snippet !== '' ) {\n\n\t\t\tbuilder.addLineFlowCode( snippet, this );\n\n\t\t}\n\n\t\treturn this.outputNode.build( builder );\n\n\t}\n\n}\n\nconst bypass = /*@__PURE__*/ nodeProxy( BypassNode );\n\naddMethodChaining( 'bypass', bypass );\n\nclass RemapNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'RemapNode';\n\n\t}\n\n\tconstructor( node, inLowNode, inHighNode, outLowNode = float( 0 ), outHighNode = float( 1 ) ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.inLowNode = inLowNode;\n\t\tthis.inHighNode = inHighNode;\n\t\tthis.outLowNode = outLowNode;\n\t\tthis.outHighNode = outHighNode;\n\n\t\tthis.doClamp = true;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { node, inLowNode, inHighNode, outLowNode, outHighNode, doClamp } = this;\n\n\t\tlet t = node.sub( inLowNode ).div( inHighNode.sub( inLowNode ) );\n\n\t\tif ( doClamp === true ) t = t.clamp();\n\n\t\treturn t.mul( outHighNode.sub( outLowNode ) ).add( outLowNode );\n\n\t}\n\n}\n\nconst remap = /*@__PURE__*/ nodeProxy( RemapNode, null, null, { doClamp: false } );\nconst remapClamp = /*@__PURE__*/ nodeProxy( RemapNode );\n\naddMethodChaining( 'remap', remap );\naddMethodChaining( 'remapClamp', remapClamp );\n\nclass ExpressionNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ExpressionNode';\n\n\t}\n\n\tconstructor( snippet = '', nodeType = 'void' ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.snippet = snippet;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst snippet = this.snippet;\n\n\t\tif ( type === 'void' ) {\n\n\t\t\tbuilder.addLineFlowCode( snippet, this );\n\n\t\t} else {\n\n\t\t\treturn builder.format( `( ${ snippet } )`, type, output );\n\n\t\t}\n\n\t}\n\n}\n\nconst expression = /*@__PURE__*/ nodeProxy( ExpressionNode );\n\nconst Discard = ( conditional ) => ( conditional ? select( conditional, expression( 'discard' ) ) : expression( 'discard' ) ).append();\nconst Return = () => expression( 'return' ).append();\n\naddMethodChaining( 'discard', Discard );\n\nclass RenderOutputNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'RenderOutputNode';\n\n\t}\n\n\tconstructor( colorNode, toneMapping, outputColorSpace ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.colorNode = colorNode;\n\t\tthis.toneMapping = toneMapping;\n\t\tthis.outputColorSpace = outputColorSpace;\n\n\t\tthis.isRenderOutput = true;\n\n\t}\n\n\tsetup( { context } ) {\n\n\t\tlet outputNode = this.colorNode || context.color;\n\n\t\t// tone mapping\n\n\t\tconst toneMapping = ( this.toneMapping !== null ? this.toneMapping : context.toneMapping ) || NoToneMapping;\n\t\tconst outputColorSpace = ( this.outputColorSpace !== null ? this.outputColorSpace : context.outputColorSpace ) || NoColorSpace;\n\n\t\tif ( toneMapping !== NoToneMapping ) {\n\n\t\t\toutputNode = outputNode.toneMapping( toneMapping );\n\n\t\t}\n\n\t\t// working to output color space\n\n\t\tif ( outputColorSpace !== NoColorSpace && outputColorSpace !== ColorManagement.workingColorSpace ) {\n\n\t\t\toutputNode = outputNode.workingToColorSpace( outputColorSpace );\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n}\n\nconst renderOutput = ( color, toneMapping = null, outputColorSpace = null ) => nodeObject( new RenderOutputNode( nodeObject( color ), toneMapping, outputColorSpace ) );\n\naddMethodChaining( 'renderOutput', renderOutput );\n\n// Non-PURE exports list, side-effects are required here.\n// TSL Base Syntax\n\n\nfunction addNodeElement( name/*, nodeElement*/ ) {\n\n\tconsole.warn( 'THREE.TSLBase: AddNodeElement has been removed in favor of tree-shaking. Trying add', name );\n\n}\n\nclass AttributeNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'AttributeNode';\n\n\t}\n\n\tconstructor( attributeName, nodeType = null ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.global = true;\n\n\t\tthis._attributeName = attributeName;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\treturn this.getAttributeName( builder );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tlet nodeType = this.nodeType;\n\n\t\tif ( nodeType === null ) {\n\n\t\t\tconst attributeName = this.getAttributeName( builder );\n\n\t\t\tif ( builder.hasGeometryAttribute( attributeName ) ) {\n\n\t\t\t\tconst attribute = builder.geometry.getAttribute( attributeName );\n\n\t\t\t\tnodeType = builder.getTypeFromAttribute( attribute );\n\n\t\t\t} else {\n\n\t\t\t\tnodeType = 'float';\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn nodeType;\n\n\t}\n\n\tsetAttributeName( attributeName ) {\n\n\t\tthis._attributeName = attributeName;\n\n\t\treturn this;\n\n\t}\n\n\tgetAttributeName( /*builder*/ ) {\n\n\t\treturn this._attributeName;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst attributeName = this.getAttributeName( builder );\n\t\tconst nodeType = this.getNodeType( builder );\n\t\tconst geometryAttribute = builder.hasGeometryAttribute( attributeName );\n\n\t\tif ( geometryAttribute === true ) {\n\n\t\t\tconst attribute = builder.geometry.getAttribute( attributeName );\n\t\t\tconst attributeType = builder.getTypeFromAttribute( attribute );\n\n\t\t\tconst nodeAttribute = builder.getAttribute( attributeName, attributeType );\n\n\t\t\tif ( builder.shaderStage === 'vertex' ) {\n\n\t\t\t\treturn builder.format( nodeAttribute.name, attributeType, nodeType );\n\n\t\t\t} else {\n\n\t\t\t\tconst nodeVarying = varying( this );\n\n\t\t\t\treturn nodeVarying.build( builder, nodeType );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( `AttributeNode: Vertex attribute \"${ attributeName }\" not found on geometry.` );\n\n\t\t\treturn builder.generateConst( nodeType );\n\n\t\t}\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.global = this.global;\n\t\tdata._attributeName = this._attributeName;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.global = data.global;\n\t\tthis._attributeName = data._attributeName;\n\n\t}\n\n}\n\nconst attribute = ( name, nodeType ) => nodeObject( new AttributeNode( name, nodeType ) );\n\nconst uv = ( index ) => attribute( 'uv' + ( index > 0 ? index : '' ), 'vec2' );\n\nclass TextureSizeNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'TextureSizeNode';\n\n\t}\n\n\tconstructor( textureNode, levelNode = null ) {\n\n\t\tsuper( 'uvec2' );\n\n\t\tthis.isTextureSizeNode = true;\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.levelNode = levelNode;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst textureProperty = this.textureNode.build( builder, 'property' );\n\t\tconst level = this.levelNode === null ? '0' : this.levelNode.build( builder, 'int' );\n\n\t\treturn builder.format( `${ builder.getMethod( 'textureDimensions' ) }( ${ textureProperty }, ${ level } )`, this.getNodeType( builder ), output );\n\n\t}\n\n}\n\nconst textureSize = /*@__PURE__*/ nodeProxy( TextureSizeNode );\n\nclass MaxMipLevelNode extends UniformNode {\n\n\tstatic get type() {\n\n\t\treturn 'MaxMipLevelNode';\n\n\t}\n\n\tconstructor( textureNode ) {\n\n\t\tsuper( 0 );\n\n\t\tthis._textureNode = textureNode;\n\n\t\tthis.updateType = NodeUpdateType.FRAME;\n\n\t}\n\n\tget textureNode() {\n\n\t\treturn this._textureNode;\n\n\t}\n\n\tget texture() {\n\n\t\treturn this._textureNode.value;\n\n\t}\n\n\tupdate() {\n\n\t\tconst texture = this.texture;\n\t\tconst images = texture.images;\n\t\tconst image = ( images && images.length > 0 ) ? ( ( images[ 0 ] && images[ 0 ].image ) || images[ 0 ] ) : texture.image;\n\n\t\tif ( image && image.width !== undefined ) {\n\n\t\t\tconst { width, height } = image;\n\n\t\t\tthis.value = Math.log2( Math.max( width, height ) );\n\n\t\t}\n\n\t}\n\n}\n\nconst maxMipLevel = /*@__PURE__*/ nodeProxy( MaxMipLevelNode );\n\nclass TextureNode extends UniformNode {\n\n\tstatic get type() {\n\n\t\treturn 'TextureNode';\n\n\t}\n\n\tconstructor( value, uvNode = null, levelNode = null, biasNode = null ) {\n\n\t\tsuper( value );\n\n\t\tthis.isTextureNode = true;\n\n\t\tthis.uvNode = uvNode;\n\t\tthis.levelNode = levelNode;\n\t\tthis.biasNode = biasNode;\n\t\tthis.compareNode = null;\n\t\tthis.depthNode = null;\n\t\tthis.gradNode = null;\n\n\t\tthis.sampler = true;\n\t\tthis.updateMatrix = false;\n\t\tthis.updateType = NodeUpdateType.NONE;\n\n\t\tthis.referenceNode = null;\n\n\t\tthis._value = value;\n\t\tthis._matrixUniform = null;\n\n\t\tthis.setUpdateMatrix( uvNode === null );\n\n\t}\n\n\tset value( value ) {\n\n\t\tif ( this.referenceNode ) {\n\n\t\t\tthis.referenceNode.value = value;\n\n\t\t} else {\n\n\t\t\tthis._value = value;\n\n\t\t}\n\n\t}\n\n\tget value() {\n\n\t\treturn this.referenceNode ? this.referenceNode.value : this._value;\n\n\t}\n\n\tgetUniformHash( /*builder*/ ) {\n\n\t\treturn this.value.uuid;\n\n\t}\n\n\tgetNodeType( /*builder*/ ) {\n\n\t\tif ( this.value.isDepthTexture === true ) return 'float';\n\n\t\tif ( this.value.type === UnsignedIntType ) {\n\n\t\t\treturn 'uvec4';\n\n\t\t} else if ( this.value.type === IntType ) {\n\n\t\t\treturn 'ivec4';\n\n\t\t}\n\n\t\treturn 'vec4';\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'texture';\n\n\t}\n\n\tgetDefaultUV() {\n\n\t\treturn uv( this.value.channel );\n\n\t}\n\n\tupdateReference( /*state*/ ) {\n\n\t\treturn this.value;\n\n\t}\n\n\tgetTransformedUV( uvNode ) {\n\n\t\tif ( this._matrixUniform === null ) this._matrixUniform = uniform( this.value.matrix );\n\n\t\treturn this._matrixUniform.mul( vec3( uvNode, 1 ) ).xy;\n\n\t}\n\n\tsetUpdateMatrix( value ) {\n\n\t\tthis.updateMatrix = value;\n\t\tthis.updateType = value ? NodeUpdateType.FRAME : NodeUpdateType.NONE;\n\n\t\treturn this;\n\n\t}\n\n\tsetupUV( builder, uvNode ) {\n\n\t\tconst texture = this.value;\n\n\t\tif ( builder.isFlipY() && ( ( texture.image instanceof ImageBitmap && texture.flipY === true ) || texture.isRenderTargetTexture === true || texture.isFramebufferTexture === true || texture.isDepthTexture === true ) ) {\n\n\t\t\tif ( this.sampler ) {\n\n\t\t\t\tuvNode = uvNode.flipY();\n\n\t\t\t} else {\n\n\t\t\t\tuvNode = uvNode.setY( int( textureSize( this, this.levelNode ).y ).sub( uvNode.y ).sub( 1 ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn uvNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\t\tproperties.referenceNode = this.referenceNode;\n\n\t\t//\n\n\t\tlet uvNode = this.uvNode;\n\n\t\tif ( ( uvNode === null || builder.context.forceUVContext === true ) && builder.context.getUV ) {\n\n\t\t\tuvNode = builder.context.getUV( this );\n\n\t\t}\n\n\t\tif ( ! uvNode ) uvNode = this.getDefaultUV();\n\n\t\tif ( this.updateMatrix === true ) {\n\n\t\t\tuvNode = this.getTransformedUV( uvNode );\n\n\t\t}\n\n\t\tuvNode = this.setupUV( builder, uvNode );\n\n\t\t//\n\n\t\tlet levelNode = this.levelNode;\n\n\t\tif ( levelNode === null && builder.context.getTextureLevel ) {\n\n\t\t\tlevelNode = builder.context.getTextureLevel( this );\n\n\t\t}\n\n\t\t//\n\n\t\tproperties.uvNode = uvNode;\n\t\tproperties.levelNode = levelNode;\n\t\tproperties.biasNode = this.biasNode;\n\t\tproperties.compareNode = this.compareNode;\n\t\tproperties.gradNode = this.gradNode;\n\t\tproperties.depthNode = this.depthNode;\n\n\t}\n\n\tgenerateUV( builder, uvNode ) {\n\n\t\treturn uvNode.build( builder, this.sampler === true ? 'vec2' : 'ivec2' );\n\n\t}\n\n\tgenerateSnippet( builder, textureProperty, uvSnippet, levelSnippet, biasSnippet, depthSnippet, compareSnippet, gradSnippet ) {\n\n\t\tconst texture = this.value;\n\n\t\tlet snippet;\n\n\t\tif ( levelSnippet ) {\n\n\t\t\tsnippet = builder.generateTextureLevel( texture, textureProperty, uvSnippet, levelSnippet, depthSnippet );\n\n\t\t} else if ( biasSnippet ) {\n\n\t\t\tsnippet = builder.generateTextureBias( texture, textureProperty, uvSnippet, biasSnippet, depthSnippet );\n\n\t\t} else if ( gradSnippet ) {\n\n\t\t\tsnippet = builder.generateTextureGrad( texture, textureProperty, uvSnippet, gradSnippet, depthSnippet );\n\n\t\t} else if ( compareSnippet ) {\n\n\t\t\tsnippet = builder.generateTextureCompare( texture, textureProperty, uvSnippet, compareSnippet, depthSnippet );\n\n\t\t} else if ( this.sampler === false ) {\n\n\t\t\tsnippet = builder.generateTextureLoad( texture, textureProperty, uvSnippet, depthSnippet );\n\n\t\t} else {\n\n\t\t\tsnippet = builder.generateTexture( texture, textureProperty, uvSnippet, depthSnippet );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\tconst texture = this.value;\n\n\t\tif ( ! texture || texture.isTexture !== true ) {\n\n\t\t\tthrow new Error( 'TextureNode: Need a three.js texture.' );\n\n\t\t}\n\n\t\tconst textureProperty = super.generate( builder, 'property' );\n\n\t\tif ( output === 'sampler' ) {\n\n\t\t\treturn textureProperty + '_sampler';\n\n\t\t} else if ( builder.isReference( output ) ) {\n\n\t\t\treturn textureProperty;\n\n\t\t} else {\n\n\t\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\t\tlet propertyName = nodeData.propertyName;\n\n\t\t\tif ( propertyName === undefined ) {\n\n\t\t\t\tconst { uvNode, levelNode, biasNode, compareNode, depthNode, gradNode } = properties;\n\n\t\t\t\tconst uvSnippet = this.generateUV( builder, uvNode );\n\t\t\t\tconst levelSnippet = levelNode ? levelNode.build( builder, 'float' ) : null;\n\t\t\t\tconst biasSnippet = biasNode ? biasNode.build( builder, 'float' ) : null;\n\t\t\t\tconst depthSnippet = depthNode ? depthNode.build( builder, 'int' ) : null;\n\t\t\t\tconst compareSnippet = compareNode ? compareNode.build( builder, 'float' ) : null;\n\t\t\t\tconst gradSnippet = gradNode ? [ gradNode[ 0 ].build( builder, 'vec2' ), gradNode[ 1 ].build( builder, 'vec2' ) ] : null;\n\n\t\t\t\tconst nodeVar = builder.getVarFromNode( this );\n\n\t\t\t\tpropertyName = builder.getPropertyName( nodeVar );\n\n\t\t\t\tconst snippet = this.generateSnippet( builder, textureProperty, uvSnippet, levelSnippet, biasSnippet, depthSnippet, compareSnippet, gradSnippet );\n\n\t\t\t\tbuilder.addLineFlowCode( `${propertyName} = ${snippet}`, this );\n\n\t\t\t\tnodeData.snippet = snippet;\n\t\t\t\tnodeData.propertyName = propertyName;\n\n\t\t\t}\n\n\t\t\tlet snippet = propertyName;\n\t\t\tconst nodeType = this.getNodeType( builder );\n\n\t\t\tif ( builder.needsToWorkingColorSpace( texture ) ) {\n\n\t\t\t\tsnippet = colorSpaceToWorking( expression( snippet, nodeType ), texture.colorSpace ).setup( builder ).build( builder, nodeType );\n\n\t\t\t}\n\n\t\t\treturn builder.format( snippet, nodeType, output );\n\n\t\t}\n\n\t}\n\n\tsetSampler( value ) {\n\n\t\tthis.sampler = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetSampler() {\n\n\t\treturn this.sampler;\n\n\t}\n\n\t// @TODO: Move to TSL\n\n\tuv( uvNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.uvNode = nodeObject( uvNode );\n\t\ttextureNode.referenceNode = this.getSelf();\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tblur( amountNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.biasNode = nodeObject( amountNode ).mul( maxMipLevel( textureNode ) );\n\t\ttextureNode.referenceNode = this.getSelf();\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tlevel( levelNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.levelNode = nodeObject( levelNode );\n\t\ttextureNode.referenceNode = this.getSelf();\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tsize( levelNode ) {\n\n\t\treturn textureSize( this, levelNode );\n\n\t}\n\n\tbias( biasNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.biasNode = nodeObject( biasNode );\n\t\ttextureNode.referenceNode = this.getSelf();\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tcompare( compareNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.compareNode = nodeObject( compareNode );\n\t\ttextureNode.referenceNode = this.getSelf();\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tgrad( gradNodeX, gradNodeY ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.gradNode = [ nodeObject( gradNodeX ), nodeObject( gradNodeY ) ];\n\t\ttextureNode.referenceNode = this.getSelf();\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tdepth( depthNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.depthNode = nodeObject( depthNode );\n\t\ttextureNode.referenceNode = this.getSelf();\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\t// --\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.value = this.value.toJSON( data.meta ).uuid;\n\t\tdata.sampler = this.sampler;\n\t\tdata.updateMatrix = this.updateMatrix;\n\t\tdata.updateType = this.updateType;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.value = data.meta.textures[ data.value ];\n\t\tthis.sampler = data.sampler;\n\t\tthis.updateMatrix = data.updateMatrix;\n\t\tthis.updateType = data.updateType;\n\n\t}\n\n\tupdate() {\n\n\t\tconst texture = this.value;\n\t\tconst matrixUniform = this._matrixUniform;\n\n\t\tif ( matrixUniform !== null ) matrixUniform.value = texture.matrix;\n\n\t\tif ( texture.matrixAutoUpdate === true ) {\n\n\t\t\ttexture.updateMatrix();\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\tconst newNode = new this.constructor( this.value, this.uvNode, this.levelNode, this.biasNode );\n\t\tnewNode.sampler = this.sampler;\n\n\t\treturn newNode;\n\n\t}\n\n}\n\nconst texture = /*@__PURE__*/ nodeProxy( TextureNode );\nconst textureLoad = ( ...params ) => texture( ...params ).setSampler( false );\n\n//export const textureLevel = ( value, uv, level ) => texture( value, uv ).level( level );\n\nconst sampler = ( aTexture ) => ( aTexture.isNode === true ? aTexture : texture( aTexture ) ).convert( 'sampler' );\n\nconst cameraNear = /*@__PURE__*/ uniform( 'float' ).label( 'cameraNear' ).setGroup( renderGroup ).onRenderUpdate( ( { camera } ) => camera.near );\nconst cameraFar = /*@__PURE__*/ uniform( 'float' ).label( 'cameraFar' ).setGroup( renderGroup ).onRenderUpdate( ( { camera } ) => camera.far );\nconst cameraProjectionMatrix = /*@__PURE__*/ uniform( 'mat4' ).label( 'cameraProjectionMatrix' ).setGroup( renderGroup ).onRenderUpdate( ( { camera } ) => camera.projectionMatrix );\nconst cameraProjectionMatrixInverse = /*@__PURE__*/ uniform( 'mat4' ).label( 'cameraProjectionMatrixInverse' ).setGroup( renderGroup ).onRenderUpdate( ( { camera } ) => camera.projectionMatrixInverse );\nconst cameraViewMatrix = /*@__PURE__*/ uniform( 'mat4' ).label( 'cameraViewMatrix' ).setGroup( renderGroup ).onRenderUpdate( ( { camera } ) => camera.matrixWorldInverse );\nconst cameraWorldMatrix = /*@__PURE__*/ uniform( 'mat4' ).label( 'cameraWorldMatrix' ).setGroup( renderGroup ).onRenderUpdate( ( { camera } ) => camera.matrixWorld );\nconst cameraNormalMatrix = /*@__PURE__*/ uniform( 'mat3' ).label( 'cameraNormalMatrix' ).setGroup( renderGroup ).onRenderUpdate( ( { camera } ) => camera.normalMatrix );\nconst cameraPosition = /*@__PURE__*/ uniform( new Vector3() ).label( 'cameraPosition' ).setGroup( renderGroup ).onRenderUpdate( ( { camera }, self ) => self.value.setFromMatrixPosition( camera.matrixWorld ) );\n\nclass Object3DNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'Object3DNode';\n\n\t}\n\n\tconstructor( scope, object3d = null ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\t\tthis.object3d = object3d;\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\n\t\tthis._uniformNode = new UniformNode( null );\n\n\t}\n\n\tgetNodeType() {\n\n\t\tconst scope = this.scope;\n\n\t\tif ( scope === Object3DNode.WORLD_MATRIX ) {\n\n\t\t\treturn 'mat4';\n\n\t\t} else if ( scope === Object3DNode.POSITION || scope === Object3DNode.VIEW_POSITION || scope === Object3DNode.DIRECTION || scope === Object3DNode.SCALE ) {\n\n\t\t\treturn 'vec3';\n\n\t\t}\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tconst object = this.object3d;\n\t\tconst uniformNode = this._uniformNode;\n\t\tconst scope = this.scope;\n\n\t\tif ( scope === Object3DNode.WORLD_MATRIX ) {\n\n\t\t\tuniformNode.value = object.matrixWorld;\n\n\t\t} else if ( scope === Object3DNode.POSITION ) {\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\n\t\t\tuniformNode.value.setFromMatrixPosition( object.matrixWorld );\n\n\t\t} else if ( scope === Object3DNode.SCALE ) {\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\n\t\t\tuniformNode.value.setFromMatrixScale( object.matrixWorld );\n\n\t\t} else if ( scope === Object3DNode.DIRECTION ) {\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\n\t\t\tobject.getWorldDirection( uniformNode.value );\n\n\t\t} else if ( scope === Object3DNode.VIEW_POSITION ) {\n\n\t\t\tconst camera = frame.camera;\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\t\t\tuniformNode.value.setFromMatrixPosition( object.matrixWorld );\n\n\t\t\tuniformNode.value.applyMatrix4( camera.matrixWorldInverse );\n\n\t\t}\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst scope = this.scope;\n\n\t\tif ( scope === Object3DNode.WORLD_MATRIX ) {\n\n\t\t\tthis._uniformNode.nodeType = 'mat4';\n\n\t\t} else if ( scope === Object3DNode.POSITION || scope === Object3DNode.VIEW_POSITION || scope === Object3DNode.DIRECTION || scope === Object3DNode.SCALE ) {\n\n\t\t\tthis._uniformNode.nodeType = 'vec3';\n\n\t\t}\n\n\t\treturn this._uniformNode.build( builder );\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.scope = this.scope;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.scope = data.scope;\n\n\t}\n\n}\n\nObject3DNode.WORLD_MATRIX = 'worldMatrix';\nObject3DNode.POSITION = 'position';\nObject3DNode.SCALE = 'scale';\nObject3DNode.VIEW_POSITION = 'viewPosition';\nObject3DNode.DIRECTION = 'direction';\n\nconst objectDirection = /*@__PURE__*/ nodeProxy( Object3DNode, Object3DNode.DIRECTION );\nconst objectWorldMatrix = /*@__PURE__*/ nodeProxy( Object3DNode, Object3DNode.WORLD_MATRIX );\nconst objectPosition = /*@__PURE__*/ nodeProxy( Object3DNode, Object3DNode.POSITION );\nconst objectScale = /*@__PURE__*/ nodeProxy( Object3DNode, Object3DNode.SCALE );\nconst objectViewPosition = /*@__PURE__*/ nodeProxy( Object3DNode, Object3DNode.VIEW_POSITION );\n\nclass ModelNode extends Object3DNode {\n\n\tstatic get type() {\n\n\t\treturn 'ModelNode';\n\n\t}\n\n\tconstructor( scope ) {\n\n\t\tsuper( scope );\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tthis.object3d = frame.object;\n\n\t\tsuper.update( frame );\n\n\t}\n\n}\n\nconst modelDirection = /*@__PURE__*/ nodeImmutable( ModelNode, ModelNode.DIRECTION );\nconst modelWorldMatrix = /*@__PURE__*/ nodeImmutable( ModelNode, ModelNode.WORLD_MATRIX );\nconst modelPosition = /*@__PURE__*/ nodeImmutable( ModelNode, ModelNode.POSITION );\nconst modelScale = /*@__PURE__*/ nodeImmutable( ModelNode, ModelNode.SCALE );\nconst modelViewPosition = /*@__PURE__*/ nodeImmutable( ModelNode, ModelNode.VIEW_POSITION );\nconst modelNormalMatrix = /*@__PURE__*/ uniform( new Matrix3() ).onObjectUpdate( ( { object }, self ) => self.value.getNormalMatrix( object.matrixWorld ) );\nconst modelWorldMatrixInverse = /*@__PURE__*/ uniform( new Matrix4() ).onObjectUpdate( ( { object }, self ) => self.value.copy( object.matrixWorld ).invert() );\nconst modelViewMatrix = /*@__PURE__*/ cameraViewMatrix.mul( modelWorldMatrix ).toVar( 'modelViewMatrix' );\n\nconst highPrecisionModelViewMatrix = /*@__PURE__*/ ( Fn( ( builder ) => {\n\n\tbuilder.context.isHighPrecisionModelViewMatrix = true;\n\n\treturn uniform( 'mat4' ).onObjectUpdate( ( { object, camera } ) => {\n\n\t\treturn object.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\n\n\t} );\n\n} ).once() )().toVar( 'highPrecisionModelViewMatrix' );\n\nconst highPrecisionModelNormalViewMatrix = /*@__PURE__*/ ( Fn( ( builder ) => {\n\n\tconst isHighPrecisionModelViewMatrix = builder.context.isHighPrecisionModelViewMatrix;\n\n\treturn uniform( 'mat3' ).onObjectUpdate( ( { object, camera } ) => {\n\n\t\tif ( isHighPrecisionModelViewMatrix !== true ) {\n\n\t\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\n\n\t\t}\n\n\t\treturn object.normalMatrix.getNormalMatrix( object.modelViewMatrix );\n\n\t} );\n\n} ).once() )().toVar( 'highPrecisionModelNormalMatrix' );\n\nconst positionGeometry = /*@__PURE__*/ attribute( 'position', 'vec3' );\nconst positionLocal = /*@__PURE__*/ positionGeometry.varying( 'positionLocal' );\nconst positionPrevious = /*@__PURE__*/ positionGeometry.varying( 'positionPrevious' );\nconst positionWorld = /*@__PURE__*/ modelWorldMatrix.mul( positionLocal ).xyz.varying( 'v_positionWorld' );\nconst positionWorldDirection = /*@__PURE__*/ positionLocal.transformDirection( modelWorldMatrix ).varying( 'v_positionWorldDirection' ).normalize().toVar( 'positionWorldDirection' );\nconst positionView = /*@__PURE__*/ modelViewMatrix.mul( positionLocal ).xyz.varying( 'v_positionView' );\nconst positionViewDirection = /*@__PURE__*/ positionView.negate().varying( 'v_positionViewDirection' ).normalize().toVar( 'positionViewDirection' );\n\nclass FrontFacingNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'FrontFacingNode';\n\n\t}\n\n\tconstructor() {\n\n\t\tsuper( 'bool' );\n\n\t\tthis.isFrontFacingNode = true;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { renderer, material } = builder;\n\n\t\tif ( renderer.coordinateSystem === WebGLCoordinateSystem ) {\n\n\t\t\tif ( material.side === BackSide ) {\n\n\t\t\t\treturn 'false';\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn builder.getFrontFacing();\n\n\t}\n\n}\n\nconst frontFacing = /*@__PURE__*/ nodeImmutable( FrontFacingNode );\nconst faceDirection = /*@__PURE__*/ float( frontFacing ).mul( 2.0 ).sub( 1.0 );\n\nconst normalGeometry = /*@__PURE__*/ attribute( 'normal', 'vec3' );\n\nconst normalLocal = /*@__PURE__*/ ( Fn( ( builder ) => {\n\n\tif ( builder.geometry.hasAttribute( 'normal' ) === false ) {\n\n\t\tconsole.warn( 'TSL.NormalNode: Vertex attribute \"normal\" not found on geometry.' );\n\n\t\treturn vec3( 0, 1, 0 );\n\n\t}\n\n\treturn normalGeometry;\n\n}, 'vec3' ).once() )().toVar( 'normalLocal' );\n\nconst normalFlat = /*@__PURE__*/ positionView.dFdx().cross( positionView.dFdy() ).normalize().toVar( 'normalFlat' );\n\nconst normalView = /*@__PURE__*/ ( Fn( ( builder ) => {\n\n\tlet node;\n\n\tif ( builder.material.flatShading === true ) {\n\n\t\tnode = normalFlat;\n\n\t} else {\n\n\t\tnode = varying( transformNormalToView( normalLocal ), 'v_normalView' ).normalize();\n\n\t}\n\n\treturn node;\n\n}, 'vec3' ).once() )().toVar( 'normalView' );\n\nconst normalWorld = /*@__PURE__*/ varying( normalView.transformDirection( cameraViewMatrix ), 'v_normalWorld' ).normalize().toVar( 'normalWorld' );\n\nconst transformedNormalView = /*@__PURE__*/ ( Fn( ( builder ) => {\n\n\treturn builder.context.setupNormal();\n\n}, 'vec3' ).once() )().mul( faceDirection ).toVar( 'transformedNormalView' );\n\n\nconst transformedNormalWorld = /*@__PURE__*/ transformedNormalView.transformDirection( cameraViewMatrix ).toVar( 'transformedNormalWorld' );\n\nconst transformedClearcoatNormalView = /*@__PURE__*/ ( Fn( ( builder ) => {\n\n\treturn builder.context.setupClearcoatNormal();\n\n}, 'vec3' ).once() )().mul( faceDirection ).toVar( 'transformedClearcoatNormalView' );\n\nconst transformNormal = /*@__PURE__*/ Fn( ( [ normal, matrix = modelWorldMatrix ] ) => {\n\n\tconst m = mat3( matrix );\n\n\tconst transformedNormal = normal.div( vec3( m[ 0 ].dot( m[ 0 ] ), m[ 1 ].dot( m[ 1 ] ), m[ 2 ].dot( m[ 2 ] ) ) );\n\n\treturn m.mul( transformedNormal ).xyz;\n\n} );\n\nconst transformNormalToView = /*@__PURE__*/ Fn( ( [ normal ], builder ) => {\n\n\tconst modelNormalViewMatrix = builder.renderer.nodes.modelNormalViewMatrix;\n\n\tif ( modelNormalViewMatrix !== null ) {\n\n\t\treturn modelNormalViewMatrix.transformDirection( normal );\n\n\t}\n\n\t//\n\n\tconst transformedNormal = modelNormalMatrix.mul( normal );\n\n\treturn cameraViewMatrix.transformDirection( transformedNormal );\n\n} );\n\nconst materialRefractionRatio = /*@__PURE__*/ uniform( 0 ).onReference( ( { material } ) => material ).onRenderUpdate( ( { material } ) => material.refractionRatio );\n\nconst reflectView = /*@__PURE__*/ positionViewDirection.negate().reflect( transformedNormalView );\nconst refractView = /*@__PURE__*/ positionViewDirection.negate().refract( transformedNormalView, materialRefractionRatio );\n\nconst reflectVector = /*@__PURE__*/ reflectView.transformDirection( cameraViewMatrix ).toVar( 'reflectVector' );\nconst refractVector = /*@__PURE__*/ refractView.transformDirection( cameraViewMatrix ).toVar( 'reflectVector' );\n\nclass CubeTextureNode extends TextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'CubeTextureNode';\n\n\t}\n\n\tconstructor( value, uvNode = null, levelNode = null, biasNode = null ) {\n\n\t\tsuper( value, uvNode, levelNode, biasNode );\n\n\t\tthis.isCubeTextureNode = true;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'cubeTexture';\n\n\t}\n\n\tgetDefaultUV() {\n\n\t\tconst texture = this.value;\n\n\t\tif ( texture.mapping === CubeReflectionMapping ) {\n\n\t\t\treturn reflectVector;\n\n\t\t} else if ( texture.mapping === CubeRefractionMapping ) {\n\n\t\t\treturn refractVector;\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.CubeTextureNode: Mapping \"%s\" not supported.', texture.mapping );\n\n\t\t\treturn vec3( 0, 0, 0 );\n\n\t\t}\n\n\t}\n\n\tsetUpdateMatrix( /*updateMatrix*/ ) { } // Ignore .updateMatrix for CubeTextureNode\n\n\tsetupUV( builder, uvNode ) {\n\n\t\tconst texture = this.value;\n\n\t\tif ( builder.renderer.coordinateSystem === WebGPUCoordinateSystem || ! texture.isRenderTargetTexture ) {\n\n\t\t\treturn vec3( uvNode.x.negate(), uvNode.yz );\n\n\t\t} else {\n\n\t\t\treturn uvNode;\n\n\t\t}\n\n\t}\n\n\tgenerateUV( builder, cubeUV ) {\n\n\t\treturn cubeUV.build( builder, 'vec3' );\n\n\t}\n\n}\n\nconst cubeTexture = /*@__PURE__*/ nodeProxy( CubeTextureNode );\n\nclass BufferNode extends UniformNode {\n\n\tstatic get type() {\n\n\t\treturn 'BufferNode';\n\n\t}\n\n\tconstructor( value, bufferType, bufferCount = 0 ) {\n\n\t\tsuper( value, bufferType );\n\n\t\tthis.isBufferNode = true;\n\n\t\tthis.bufferType = bufferType;\n\t\tthis.bufferCount = bufferCount;\n\n\t}\n\n\tgetElementType( builder ) {\n\n\t\treturn this.getNodeType( builder );\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'buffer';\n\n\t}\n\n}\n\nconst buffer = ( value, type, count ) => nodeObject( new BufferNode( value, type, count ) );\n\nclass UniformArrayElementNode extends ArrayElementNode {\n\n\tstatic get type() {\n\n\t\treturn 'UniformArrayElementNode';\n\n\t}\n\n\tconstructor( arrayBuffer, indexNode ) {\n\n\t\tsuper( arrayBuffer, indexNode );\n\n\t\tthis.isArrayBufferElementNode = true;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst snippet = super.generate( builder );\n\t\tconst type = this.getNodeType();\n\n\t\treturn builder.format( snippet, 'vec4', type );\n\n\t}\n\n}\n\nclass UniformArrayNode extends BufferNode {\n\n\tstatic get type() {\n\n\t\treturn 'UniformArrayNode';\n\n\t}\n\n\tconstructor( value, elementType = null ) {\n\n\t\tsuper( null, 'vec4' );\n\n\t\tthis.array = value;\n\t\tthis.elementType = elementType;\n\n\t\tthis._elementType = null;\n\t\tthis._elementLength = 0;\n\n\t\tthis.updateType = NodeUpdateType.RENDER;\n\n\t\tthis.isArrayBufferNode = true;\n\n\t}\n\n\tgetElementType() {\n\n\t\treturn this.elementType || this._elementType;\n\n\t}\n\n\tgetElementLength() {\n\n\t\treturn this._elementLength;\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tconst { array, value } = this;\n\n\t\tconst elementLength = this.getElementLength();\n\t\tconst elementType = this.getElementType();\n\n\t\tif ( elementLength === 1 ) {\n\n\t\t\tfor ( let i = 0; i < array.length; i ++ ) {\n\n\t\t\t\tconst index = i * 4;\n\n\t\t\t\tvalue[ index ] = array[ i ];\n\n\t\t\t}\n\n\t\t} else if ( elementType === 'color' ) {\n\n\t\t\tfor ( let i = 0; i < array.length; i ++ ) {\n\n\t\t\t\tconst index = i * 4;\n\t\t\t\tconst vector = array[ i ];\n\n\t\t\t\tvalue[ index ] = vector.r;\n\t\t\t\tvalue[ index + 1 ] = vector.g;\n\t\t\t\tvalue[ index + 2 ] = vector.b || 0;\n\t\t\t\t//value[ index + 3 ] = vector.a || 0;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tfor ( let i = 0; i < array.length; i ++ ) {\n\n\t\t\t\tconst index = i * 4;\n\t\t\t\tconst vector = array[ i ];\n\n\t\t\t\tvalue[ index ] = vector.x;\n\t\t\t\tvalue[ index + 1 ] = vector.y;\n\t\t\t\tvalue[ index + 2 ] = vector.z || 0;\n\t\t\t\tvalue[ index + 3 ] = vector.w || 0;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst length = this.array.length;\n\n\t\tthis._elementType = this.elementType === null ? getValueType( this.array[ 0 ] ) : this.elementType;\n\t\tthis._elementLength = builder.getTypeLength( this._elementType );\n\n\t\tlet arrayType = Float32Array;\n\n\t\tif ( this._elementType.charAt( 0 ) === 'i' ) arrayType = Int32Array;\n\t\telse if ( this._elementType.charAt( 0 ) === 'u' ) arrayType = Uint32Array;\n\n\t\tthis.value = new arrayType( length * 4 );\n\t\tthis.bufferCount = length;\n\t\tthis.bufferType = builder.changeComponentType( 'vec4', builder.getComponentType( this._elementType ) );\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\telement( indexNode ) {\n\n\t\treturn nodeObject( new UniformArrayElementNode( this, nodeObject( indexNode ) ) );\n\n\t}\n\n}\n\nconst uniformArray = ( values, nodeType ) => nodeObject( new UniformArrayNode( values, nodeType ) );\n\n//\n\nconst uniforms = ( values, nodeType ) => { // @deprecated, r168\n\n\tconsole.warn( 'TSL.UniformArrayNode: uniforms() has been renamed to uniformArray().' );\n\treturn nodeObject( new UniformArrayNode( values, nodeType ) );\n\n};\n\nclass ReferenceElementNode extends ArrayElementNode {\n\n\tstatic get type() {\n\n\t\treturn 'ReferenceElementNode';\n\n\t}\n\n\tconstructor( referenceNode, indexNode ) {\n\n\t\tsuper( referenceNode, indexNode );\n\n\t\tthis.referenceNode = referenceNode;\n\n\t\tthis.isReferenceElementNode = true;\n\n\t}\n\n\tgetNodeType() {\n\n\t\treturn this.referenceNode.uniformType;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst snippet = super.generate( builder );\n\t\tconst arrayType = this.referenceNode.getNodeType();\n\t\tconst elementType = this.getNodeType();\n\n\t\treturn builder.format( snippet, arrayType, elementType );\n\n\t}\n\n}\n\n// TODO: Extends this from ReferenceBaseNode\nclass ReferenceNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ReferenceNode';\n\n\t}\n\n\tconstructor( property, uniformType, object = null, count = null ) {\n\n\t\tsuper();\n\n\t\tthis.property = property;\n\t\tthis.uniformType = uniformType;\n\t\tthis.object = object;\n\t\tthis.count = count;\n\n\t\tthis.properties = property.split( '.' );\n\t\tthis.reference = object;\n\t\tthis.node = null;\n\t\tthis.group = null;\n\t\tthis.name = null;\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\n\t}\n\n\telement( indexNode ) {\n\n\t\treturn nodeObject( new ReferenceElementNode( this, nodeObject( indexNode ) ) );\n\n\t}\n\n\tsetGroup( group ) {\n\n\t\tthis.group = group;\n\n\t\treturn this;\n\n\t}\n\n\tlabel( name ) {\n\n\t\tthis.name = name;\n\n\t\treturn this;\n\n\t}\n\n\tsetNodeType( uniformType ) {\n\n\t\tlet node = null;\n\n\t\tif ( this.count !== null ) {\n\n\t\t\tnode = buffer( null, uniformType, this.count );\n\n\t\t} else if ( Array.isArray( this.getValueFromReference() ) ) {\n\n\t\t\tnode = uniformArray( null, uniformType );\n\n\t\t} else if ( uniformType === 'texture' ) {\n\n\t\t\tnode = texture( null );\n\n\t\t} else if ( uniformType === 'cubeTexture' ) {\n\n\t\t\tnode = cubeTexture( null );\n\n\t\t} else {\n\n\t\t\tnode = uniform( null, uniformType );\n\n\t\t}\n\n\t\tif ( this.group !== null ) {\n\n\t\t\tnode.setGroup( this.group );\n\n\t\t}\n\n\t\tif ( this.name !== null ) node.label( this.name );\n\n\t\tthis.node = node.getSelf();\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tif ( this.node === null ) {\n\n\t\t\tthis.updateReference( builder );\n\t\t\tthis.updateValue();\n\n\t\t}\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tgetValueFromReference( object = this.reference ) {\n\n\t\tconst { properties } = this;\n\n\t\tlet value = object[ properties[ 0 ] ];\n\n\t\tfor ( let i = 1; i < properties.length; i ++ ) {\n\n\t\t\tvalue = value[ properties[ i ] ];\n\n\t\t}\n\n\t\treturn value;\n\n\t}\n\n\tupdateReference( state ) {\n\n\t\tthis.reference = this.object !== null ? this.object : state.object;\n\n\t\treturn this.reference;\n\n\t}\n\n\tsetup() {\n\n\t\tthis.updateValue();\n\n\t\treturn this.node;\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tthis.updateValue();\n\n\t}\n\n\tupdateValue() {\n\n\t\tif ( this.node === null ) this.setNodeType( this.uniformType );\n\n\t\tconst value = this.getValueFromReference();\n\n\t\tif ( Array.isArray( value ) ) {\n\n\t\t\tthis.node.array = value;\n\n\t\t} else {\n\n\t\t\tthis.node.value = value;\n\n\t\t}\n\n\t}\n\n}\n\nconst reference = ( name, type, object ) => nodeObject( new ReferenceNode( name, type, object ) );\nconst referenceBuffer = ( name, type, count, object ) => nodeObject( new ReferenceNode( name, type, object, count ) );\n\nclass MaterialReferenceNode extends ReferenceNode {\n\n\tstatic get type() {\n\n\t\treturn 'MaterialReferenceNode';\n\n\t}\n\n\tconstructor( property, inputType, material = null ) {\n\n\t\tsuper( property, inputType, material );\n\n\t\tthis.material = material;\n\n\t\t//this.updateType = NodeUpdateType.RENDER;\n\n\t\tthis.isMaterialReferenceNode = true;\n\n\t}\n\n\t/*setNodeType( node ) {\n\n\t\tsuper.setNodeType( node );\n\n\t\tthis.node.groupNode = renderGroup;\n\n\t}*/\n\n\tupdateReference( state ) {\n\n\t\tthis.reference = this.material !== null ? this.material : state.material;\n\n\t\treturn this.reference;\n\n\t}\n\n}\n\nconst materialReference = ( name, type, material ) => nodeObject( new MaterialReferenceNode( name, type, material ) );\n\nconst tangentGeometry = /*@__PURE__*/ Fn( ( builder ) => {\n\n\tif ( builder.geometry.hasAttribute( 'tangent' ) === false ) {\n\n\t\tbuilder.geometry.computeTangents();\n\n\t}\n\n\treturn attribute( 'tangent', 'vec4' );\n\n} )();\n\nconst tangentLocal = /*@__PURE__*/ tangentGeometry.xyz.toVar( 'tangentLocal' );\nconst tangentView = /*@__PURE__*/ modelViewMatrix.mul( vec4( tangentLocal, 0 ) ).xyz.varying( 'v_tangentView' ).normalize().toVar( 'tangentView' );\nconst tangentWorld = /*@__PURE__*/ tangentView.transformDirection( cameraViewMatrix ).varying( 'v_tangentWorld' ).normalize().toVar( 'tangentWorld' );\nconst transformedTangentView = /*@__PURE__*/ tangentView.toVar( 'transformedTangentView' );\nconst transformedTangentWorld = /*@__PURE__*/ transformedTangentView.transformDirection( cameraViewMatrix ).normalize().toVar( 'transformedTangentWorld' );\n\nconst getBitangent = ( crossNormalTangent ) => crossNormalTangent.mul( tangentGeometry.w ).xyz;\n\nconst bitangentGeometry = /*@__PURE__*/ varying( getBitangent( normalGeometry.cross( tangentGeometry ) ), 'v_bitangentGeometry' ).normalize().toVar( 'bitangentGeometry' );\nconst bitangentLocal = /*@__PURE__*/ varying( getBitangent( normalLocal.cross( tangentLocal ) ), 'v_bitangentLocal' ).normalize().toVar( 'bitangentLocal' );\nconst bitangentView = /*@__PURE__*/ varying( getBitangent( normalView.cross( tangentView ) ), 'v_bitangentView' ).normalize().toVar( 'bitangentView' );\nconst bitangentWorld = /*@__PURE__*/ varying( getBitangent( normalWorld.cross( tangentWorld ) ), 'v_bitangentWorld' ).normalize().toVar( 'bitangentWorld' );\nconst transformedBitangentView = /*@__PURE__*/ getBitangent( transformedNormalView.cross( transformedTangentView ) ).normalize().toVar( 'transformedBitangentView' );\nconst transformedBitangentWorld = /*@__PURE__*/ transformedBitangentView.transformDirection( cameraViewMatrix ).normalize().toVar( 'transformedBitangentWorld' );\n\nconst TBNViewMatrix = /*@__PURE__*/ mat3( tangentView, bitangentView, normalView );\n\nconst parallaxDirection = /*@__PURE__*/ positionViewDirection.mul( TBNViewMatrix )/*.normalize()*/;\nconst parallaxUV = ( uv, scale ) => uv.sub( parallaxDirection.mul( scale ) );\n\nconst transformedBentNormalView = /*@__PURE__*/ ( () => {\n\n\t// https://google.github.io/filament/Filament.md.html#lighting/imagebasedlights/anisotropy\n\n\tlet bentNormal = anisotropyB.cross( positionViewDirection );\n\tbentNormal = bentNormal.cross( anisotropyB ).normalize();\n\tbentNormal = mix( bentNormal, transformedNormalView, anisotropy.mul( roughness.oneMinus() ).oneMinus().pow2().pow2() ).normalize();\n\n\treturn bentNormal;\n\n\n} )();\n\n// Normal Mapping Without Precomputed Tangents\n// http://www.thetenthplanet.de/archives/1180\n\nconst perturbNormal2Arb = /*@__PURE__*/ Fn( ( inputs ) => {\n\n\tconst { eye_pos, surf_norm, mapN, uv } = inputs;\n\n\tconst q0 = eye_pos.dFdx();\n\tconst q1 = eye_pos.dFdy();\n\tconst st0 = uv.dFdx();\n\tconst st1 = uv.dFdy();\n\n\tconst N = surf_norm; // normalized\n\n\tconst q1perp = q1.cross( N );\n\tconst q0perp = N.cross( q0 );\n\n\tconst T = q1perp.mul( st0.x ).add( q0perp.mul( st1.x ) );\n\tconst B = q1perp.mul( st0.y ).add( q0perp.mul( st1.y ) );\n\n\tconst det = T.dot( T ).max( B.dot( B ) );\n\tconst scale = faceDirection.mul( det.inverseSqrt() );\n\n\treturn add( T.mul( mapN.x, scale ), B.mul( mapN.y, scale ), N.mul( mapN.z ) ).normalize();\n\n} );\n\nclass NormalMapNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'NormalMapNode';\n\n\t}\n\n\tconstructor( node, scaleNode = null ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.node = node;\n\t\tthis.scaleNode = scaleNode;\n\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { normalMapType, scaleNode } = this;\n\n\t\tlet normalMap = this.node.mul( 2.0 ).sub( 1.0 );\n\n\t\tif ( scaleNode !== null ) {\n\n\t\t\tnormalMap = vec3( normalMap.xy.mul( scaleNode ), normalMap.z );\n\n\t\t}\n\n\t\tlet outputNode = null;\n\n\t\tif ( normalMapType === ObjectSpaceNormalMap ) {\n\n\t\t\toutputNode = transformNormalToView( normalMap );\n\n\t\t} else if ( normalMapType === TangentSpaceNormalMap ) {\n\n\t\t\tconst tangent = builder.hasGeometryAttribute( 'tangent' );\n\n\t\t\tif ( tangent === true ) {\n\n\t\t\t\toutputNode = TBNViewMatrix.mul( normalMap ).normalize();\n\n\t\t\t} else {\n\n\t\t\t\toutputNode = perturbNormal2Arb( {\n\t\t\t\t\teye_pos: positionView,\n\t\t\t\t\tsurf_norm: normalView,\n\t\t\t\t\tmapN: normalMap,\n\t\t\t\t\tuv: uv()\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n}\n\nconst normalMap = /*@__PURE__*/ nodeProxy( NormalMapNode );\n\n// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen\n// https://mmikk.github.io/papers3d/mm_sfgrad_bump.pdf\n\nconst dHdxy_fwd = Fn( ( { textureNode, bumpScale } ) => {\n\n\t// It's used to preserve the same TextureNode instance\n\tconst sampleTexture = ( callback ) => textureNode.cache().context( { getUV: ( texNode ) => callback( texNode.uvNode || uv() ), forceUVContext: true } );\n\n\tconst Hll = float( sampleTexture( ( uvNode ) => uvNode ) );\n\n\treturn vec2(\n\t\tfloat( sampleTexture( ( uvNode ) => uvNode.add( uvNode.dFdx() ) ) ).sub( Hll ),\n\t\tfloat( sampleTexture( ( uvNode ) => uvNode.add( uvNode.dFdy() ) ) ).sub( Hll )\n\t).mul( bumpScale );\n\n} );\n\n// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\nconst perturbNormalArb = Fn( ( inputs ) => {\n\n\tconst { surf_pos, surf_norm, dHdxy } = inputs;\n\n\t// normalize is done to ensure that the bump map looks the same regardless of the texture's scale\n\tconst vSigmaX = surf_pos.dFdx().normalize();\n\tconst vSigmaY = surf_pos.dFdy().normalize();\n\tconst vN = surf_norm; // normalized\n\n\tconst R1 = vSigmaY.cross( vN );\n\tconst R2 = vN.cross( vSigmaX );\n\n\tconst fDet = vSigmaX.dot( R1 ).mul( faceDirection );\n\n\tconst vGrad = fDet.sign().mul( dHdxy.x.mul( R1 ).add( dHdxy.y.mul( R2 ) ) );\n\n\treturn fDet.abs().mul( surf_norm ).sub( vGrad ).normalize();\n\n} );\n\nclass BumpMapNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'BumpMapNode';\n\n\t}\n\n\tconstructor( textureNode, scaleNode = null ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.scaleNode = scaleNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst bumpScale = this.scaleNode !== null ? this.scaleNode : 1;\n\t\tconst dHdxy = dHdxy_fwd( { textureNode: this.textureNode, bumpScale } );\n\n\t\treturn perturbNormalArb( {\n\t\t\tsurf_pos: positionView,\n\t\t\tsurf_norm: normalView,\n\t\t\tdHdxy\n\t\t} );\n\n\t}\n\n}\n\nconst bumpMap = /*@__PURE__*/ nodeProxy( BumpMapNode );\n\nconst _propertyCache = new Map();\n\nclass MaterialNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'MaterialNode';\n\n\t}\n\n\tconstructor( scope ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\n\t}\n\n\tgetCache( property, type ) {\n\n\t\tlet node = _propertyCache.get( property );\n\n\t\tif ( node === undefined ) {\n\n\t\t\tnode = materialReference( property, type );\n\n\t\t\t_propertyCache.set( property, node );\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n\tgetFloat( property ) {\n\n\t\treturn this.getCache( property, 'float' );\n\n\t}\n\n\tgetColor( property ) {\n\n\t\treturn this.getCache( property, 'color' );\n\n\t}\n\n\tgetTexture( property ) {\n\n\t\treturn this.getCache( property === 'map' ? 'map' : property + 'Map', 'texture' );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst material = builder.context.material;\n\t\tconst scope = this.scope;\n\n\t\tlet node = null;\n\n\t\tif ( scope === MaterialNode.COLOR ) {\n\n\t\t\tconst colorNode = material.color !== undefined ? this.getColor( scope ) : vec3();\n\n\t\t\tif ( material.map && material.map.isTexture === true ) {\n\n\t\t\t\tnode = colorNode.mul( this.getTexture( 'map' ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = colorNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.OPACITY ) {\n\n\t\t\tconst opacityNode = this.getFloat( scope );\n\n\t\t\tif ( material.alphaMap && material.alphaMap.isTexture === true ) {\n\n\t\t\t\tnode = opacityNode.mul( this.getTexture( 'alpha' ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = opacityNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.SPECULAR_STRENGTH ) {\n\n\t\t\tif ( material.specularMap && material.specularMap.isTexture === true ) {\n\n\t\t\t\tnode = this.getTexture( 'specular' ).r;\n\n\t\t\t} else {\n\n\t\t\t\tnode = float( 1 );\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.SPECULAR_INTENSITY ) {\n\n\t\t\tconst specularIntensity = this.getFloat( scope );\n\n\t\t\tif ( material.specularMap ) {\n\n\t\t\t\tnode = specularIntensity.mul( this.getTexture( scope ).a );\n\n\t\t\t} else {\n\n\t\t\t\tnode = specularIntensity;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.SPECULAR_COLOR ) {\n\n\t\t\tconst specularColorNode = this.getColor( scope );\n\n\t\t\tif ( material.specularColorMap && material.specularColorMap.isTexture === true ) {\n\n\t\t\t\tnode = specularColorNode.mul( this.getTexture( scope ).rgb );\n\n\t\t\t} else {\n\n\t\t\t\tnode = specularColorNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.ROUGHNESS ) { // TODO: cleanup similar branches\n\n\t\t\tconst roughnessNode = this.getFloat( scope );\n\n\t\t\tif ( material.roughnessMap && material.roughnessMap.isTexture === true ) {\n\n\t\t\t\tnode = roughnessNode.mul( this.getTexture( scope ).g );\n\n\t\t\t} else {\n\n\t\t\t\tnode = roughnessNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.METALNESS ) {\n\n\t\t\tconst metalnessNode = this.getFloat( scope );\n\n\t\t\tif ( material.metalnessMap && material.metalnessMap.isTexture === true ) {\n\n\t\t\t\tnode = metalnessNode.mul( this.getTexture( scope ).b );\n\n\t\t\t} else {\n\n\t\t\t\tnode = metalnessNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.EMISSIVE ) {\n\n\t\t\tconst emissiveIntensityNode = this.getFloat( 'emissiveIntensity' );\n\t\t\tconst emissiveNode = this.getColor( scope ).mul( emissiveIntensityNode );\n\n\t\t\tif ( material.emissiveMap && material.emissiveMap.isTexture === true ) {\n\n\t\t\t\tnode = emissiveNode.mul( this.getTexture( scope ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = emissiveNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.NORMAL ) {\n\n\t\t\tif ( material.normalMap ) {\n\n\t\t\t\tnode = normalMap( this.getTexture( 'normal' ), this.getCache( 'normalScale', 'vec2' ) );\n\t\t\t\tnode.normalMapType = material.normalMapType;\n\n\t\t\t} else if ( material.bumpMap ) {\n\n\t\t\t\tnode = bumpMap( this.getTexture( 'bump' ).r, this.getFloat( 'bumpScale' ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = normalView;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.CLEARCOAT ) {\n\n\t\t\tconst clearcoatNode = this.getFloat( scope );\n\n\t\t\tif ( material.clearcoatMap && material.clearcoatMap.isTexture === true ) {\n\n\t\t\t\tnode = clearcoatNode.mul( this.getTexture( scope ).r );\n\n\t\t\t} else {\n\n\t\t\t\tnode = clearcoatNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.CLEARCOAT_ROUGHNESS ) {\n\n\t\t\tconst clearcoatRoughnessNode = this.getFloat( scope );\n\n\t\t\tif ( material.clearcoatRoughnessMap && material.clearcoatRoughnessMap.isTexture === true ) {\n\n\t\t\t\tnode = clearcoatRoughnessNode.mul( this.getTexture( scope ).r );\n\n\t\t\t} else {\n\n\t\t\t\tnode = clearcoatRoughnessNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.CLEARCOAT_NORMAL ) {\n\n\t\t\tif ( material.clearcoatNormalMap ) {\n\n\t\t\t\tnode = normalMap( this.getTexture( scope ), this.getCache( scope + 'Scale', 'vec2' ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = normalView;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.SHEEN ) {\n\n\t\t\tconst sheenNode = this.getColor( 'sheenColor' ).mul( this.getFloat( 'sheen' ) ); // Move this mul() to CPU\n\n\t\t\tif ( material.sheenColorMap && material.sheenColorMap.isTexture === true ) {\n\n\t\t\t\tnode = sheenNode.mul( this.getTexture( 'sheenColor' ).rgb );\n\n\t\t\t} else {\n\n\t\t\t\tnode = sheenNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.SHEEN_ROUGHNESS ) {\n\n\t\t\tconst sheenRoughnessNode = this.getFloat( scope );\n\n\t\t\tif ( material.sheenRoughnessMap && material.sheenRoughnessMap.isTexture === true ) {\n\n\t\t\t\tnode = sheenRoughnessNode.mul( this.getTexture( scope ).a );\n\n\t\t\t} else {\n\n\t\t\t\tnode = sheenRoughnessNode;\n\n\t\t\t}\n\n\t\t\tnode = node.clamp( 0.07, 1.0 );\n\n\t\t} else if ( scope === MaterialNode.ANISOTROPY ) {\n\n\t\t\tif ( material.anisotropyMap && material.anisotropyMap.isTexture === true ) {\n\n\t\t\t\tconst anisotropyPolar = this.getTexture( scope );\n\t\t\t\tconst anisotropyMat = mat2( materialAnisotropyVector.x, materialAnisotropyVector.y, materialAnisotropyVector.y.negate(), materialAnisotropyVector.x );\n\n\t\t\t\tnode = anisotropyMat.mul( anisotropyPolar.rg.mul( 2.0 ).sub( vec2( 1.0 ) ).normalize().mul( anisotropyPolar.b ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = materialAnisotropyVector;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.IRIDESCENCE_THICKNESS ) {\n\n\t\t\tconst iridescenceThicknessMaximum = reference( '1', 'float', material.iridescenceThicknessRange );\n\n\t\t\tif ( material.iridescenceThicknessMap ) {\n\n\t\t\t\tconst iridescenceThicknessMinimum = reference( '0', 'float', material.iridescenceThicknessRange );\n\n\t\t\t\tnode = iridescenceThicknessMaximum.sub( iridescenceThicknessMinimum ).mul( this.getTexture( scope ).g ).add( iridescenceThicknessMinimum );\n\n\t\t\t} else {\n\n\t\t\t\tnode = iridescenceThicknessMaximum;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.TRANSMISSION ) {\n\n\t\t\tconst transmissionNode = this.getFloat( scope );\n\n\t\t\tif ( material.transmissionMap ) {\n\n\t\t\t\tnode = transmissionNode.mul( this.getTexture( scope ).r );\n\n\t\t\t} else {\n\n\t\t\t\tnode = transmissionNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.THICKNESS ) {\n\n\t\t\tconst thicknessNode = this.getFloat( scope );\n\n\t\t\tif ( material.thicknessMap ) {\n\n\t\t\t\tnode = thicknessNode.mul( this.getTexture( scope ).g );\n\n\t\t\t} else {\n\n\t\t\t\tnode = thicknessNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.IOR ) {\n\n\t\t\tnode = this.getFloat( scope );\n\n\t\t} else if ( scope === MaterialNode.LIGHT_MAP ) {\n\n\t\t\tnode = this.getTexture( scope ).rgb.mul( this.getFloat( 'lightMapIntensity' ) );\n\n\t\t} else if ( scope === MaterialNode.AO_MAP ) {\n\n\t\t\tnode = this.getTexture( scope ).r.sub( 1.0 ).mul( this.getFloat( 'aoMapIntensity' ) ).add( 1.0 );\n\n\t\t} else {\n\n\t\t\tconst outputType = this.getNodeType( builder );\n\n\t\t\tnode = this.getCache( scope, outputType );\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n}\n\nMaterialNode.ALPHA_TEST = 'alphaTest';\nMaterialNode.COLOR = 'color';\nMaterialNode.OPACITY = 'opacity';\nMaterialNode.SHININESS = 'shininess';\nMaterialNode.SPECULAR = 'specular';\nMaterialNode.SPECULAR_STRENGTH = 'specularStrength';\nMaterialNode.SPECULAR_INTENSITY = 'specularIntensity';\nMaterialNode.SPECULAR_COLOR = 'specularColor';\nMaterialNode.REFLECTIVITY = 'reflectivity';\nMaterialNode.ROUGHNESS = 'roughness';\nMaterialNode.METALNESS = 'metalness';\nMaterialNode.NORMAL = 'normal';\nMaterialNode.CLEARCOAT = 'clearcoat';\nMaterialNode.CLEARCOAT_ROUGHNESS = 'clearcoatRoughness';\nMaterialNode.CLEARCOAT_NORMAL = 'clearcoatNormal';\nMaterialNode.EMISSIVE = 'emissive';\nMaterialNode.ROTATION = 'rotation';\nMaterialNode.SHEEN = 'sheen';\nMaterialNode.SHEEN_ROUGHNESS = 'sheenRoughness';\nMaterialNode.ANISOTROPY = 'anisotropy';\nMaterialNode.IRIDESCENCE = 'iridescence';\nMaterialNode.IRIDESCENCE_IOR = 'iridescenceIOR';\nMaterialNode.IRIDESCENCE_THICKNESS = 'iridescenceThickness';\nMaterialNode.IOR = 'ior';\nMaterialNode.TRANSMISSION = 'transmission';\nMaterialNode.THICKNESS = 'thickness';\nMaterialNode.ATTENUATION_DISTANCE = 'attenuationDistance';\nMaterialNode.ATTENUATION_COLOR = 'attenuationColor';\nMaterialNode.LINE_SCALE = 'scale';\nMaterialNode.LINE_DASH_SIZE = 'dashSize';\nMaterialNode.LINE_GAP_SIZE = 'gapSize';\nMaterialNode.LINE_WIDTH = 'linewidth';\nMaterialNode.LINE_DASH_OFFSET = 'dashOffset';\nMaterialNode.POINT_WIDTH = 'pointWidth';\nMaterialNode.DISPERSION = 'dispersion';\nMaterialNode.LIGHT_MAP = 'light';\nMaterialNode.AO_MAP = 'ao';\n\nconst materialAlphaTest = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.ALPHA_TEST );\nconst materialColor = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.COLOR );\nconst materialShininess = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.SHININESS );\nconst materialEmissive = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.EMISSIVE );\nconst materialOpacity = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.OPACITY );\nconst materialSpecular = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.SPECULAR );\n\nconst materialSpecularIntensity = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.SPECULAR_INTENSITY );\nconst materialSpecularColor = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.SPECULAR_COLOR );\n\nconst materialSpecularStrength = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.SPECULAR_STRENGTH );\nconst materialReflectivity = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.REFLECTIVITY );\nconst materialRoughness = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.ROUGHNESS );\nconst materialMetalness = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.METALNESS );\nconst materialNormal = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.NORMAL ).context( { getUV: null } );\nconst materialClearcoat = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.CLEARCOAT );\nconst materialClearcoatRoughness = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.CLEARCOAT_ROUGHNESS );\nconst materialClearcoatNormal = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.CLEARCOAT_NORMAL ).context( { getUV: null } );\nconst materialRotation = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.ROTATION );\nconst materialSheen = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.SHEEN );\nconst materialSheenRoughness = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.SHEEN_ROUGHNESS );\nconst materialAnisotropy = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.ANISOTROPY );\nconst materialIridescence = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.IRIDESCENCE );\nconst materialIridescenceIOR = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.IRIDESCENCE_IOR );\nconst materialIridescenceThickness = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.IRIDESCENCE_THICKNESS );\nconst materialTransmission = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.TRANSMISSION );\nconst materialThickness = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.THICKNESS );\nconst materialIOR = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.IOR );\nconst materialAttenuationDistance = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.ATTENUATION_DISTANCE );\nconst materialAttenuationColor = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.ATTENUATION_COLOR );\nconst materialLineScale = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.LINE_SCALE );\nconst materialLineDashSize = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.LINE_DASH_SIZE );\nconst materialLineGapSize = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.LINE_GAP_SIZE );\nconst materialLineWidth = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.LINE_WIDTH );\nconst materialLineDashOffset = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.LINE_DASH_OFFSET );\nconst materialPointWidth = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.POINT_WIDTH );\nconst materialDispersion = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.DISPERSION );\nconst materialLightMap = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.LIGHT_MAP );\nconst materialAOMap = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.AO_MAP );\nconst materialAnisotropyVector = /*@__PURE__*/ uniform( new Vector2() ).onReference( function ( frame ) {\n\n\treturn frame.material;\n\n} ).onRenderUpdate( function ( { material } ) {\n\n\tthis.value.set( material.anisotropy * Math.cos( material.anisotropyRotation ), material.anisotropy * Math.sin( material.anisotropyRotation ) );\n\n} );\n\nclass ModelViewProjectionNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'ModelViewProjectionNode';\n\n\t}\n\n\tconstructor( positionNode = null ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.positionNode = positionNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( builder.shaderStage === 'fragment' ) {\n\n\t\t\treturn varying( builder.context.mvp );\n\n\t\t}\n\n\t\tconst position = this.positionNode || positionLocal;\n\t\tconst viewMatrix = builder.renderer.nodes.modelViewMatrix || modelViewMatrix;\n\n\t\treturn cameraProjectionMatrix.mul( viewMatrix ).mul( position );\n\n\t}\n\n}\n\nconst modelViewProjection = /*@__PURE__*/ nodeProxy( ModelViewProjectionNode );\n\nclass IndexNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'IndexNode';\n\n\t}\n\n\tconstructor( scope ) {\n\n\t\tsuper( 'uint' );\n\n\t\tthis.scope = scope;\n\n\t\tthis.isInstanceIndexNode = true;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst nodeType = this.getNodeType( builder );\n\t\tconst scope = this.scope;\n\n\t\tlet propertyName;\n\n\t\tif ( scope === IndexNode.VERTEX ) {\n\n\t\t\t// The index of a vertex within a mesh.\n\t\t\tpropertyName = builder.getVertexIndex();\n\n\t\t} else if ( scope === IndexNode.INSTANCE ) {\n\n\t\t\t// The index of either a mesh instance or an invocation of a compute shader.\n\t\t\tpropertyName = builder.getInstanceIndex();\n\n\t\t} else if ( scope === IndexNode.DRAW ) {\n\n\t\t\t// The index of a draw call.\n\t\t\tpropertyName = builder.getDrawIndex();\n\n\t\t} else if ( scope === IndexNode.INVOCATION_LOCAL ) {\n\n\t\t\t// The index of a compute invocation within the scope of a workgroup load.\n\t\t\tpropertyName = builder.getInvocationLocalIndex();\n\n\t\t} else if ( scope === IndexNode.INVOCATION_SUBGROUP ) {\n\n\t\t\t// The index of a compute invocation within the scope of a subgroup.\n\t\t\tpropertyName = builder.getInvocationSubgroupIndex();\n\n\t\t} else if ( scope === IndexNode.SUBGROUP ) {\n\n\t\t\t// The index of the subgroup the current compute invocation belongs to.\n\t\t\tpropertyName = builder.getSubgroupIndex();\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.IndexNode: Unknown scope: ' + scope );\n\n\t\t}\n\n\t\tlet output;\n\n\t\tif ( builder.shaderStage === 'vertex' || builder.shaderStage === 'compute' ) {\n\n\t\t\toutput = propertyName;\n\n\t\t} else {\n\n\t\t\tconst nodeVarying = varying( this );\n\n\t\t\toutput = nodeVarying.build( builder, nodeType );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n}\n\nIndexNode.VERTEX = 'vertex';\nIndexNode.INSTANCE = 'instance';\nIndexNode.SUBGROUP = 'subgroup';\nIndexNode.INVOCATION_LOCAL = 'invocationLocal';\nIndexNode.INVOCATION_SUBGROUP = 'invocationSubgroup';\nIndexNode.DRAW = 'draw';\n\nconst vertexIndex = /*@__PURE__*/ nodeImmutable( IndexNode, IndexNode.VERTEX );\nconst instanceIndex = /*@__PURE__*/ nodeImmutable( IndexNode, IndexNode.INSTANCE );\nconst subgroupIndex = /*@__PURE__*/ nodeImmutable( IndexNode, IndexNode.SUBGROUP );\nconst invocationSubgroupIndex = /*@__PURE__*/ nodeImmutable( IndexNode, IndexNode.INVOCATION_SUBGROUP );\nconst invocationLocalIndex = /*@__PURE__*/ nodeImmutable( IndexNode, IndexNode.INVOCATION_LOCAL );\nconst drawIndex = /*@__PURE__*/ nodeImmutable( IndexNode, IndexNode.DRAW );\n\nclass InstanceNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'InstanceNode';\n\n\t}\n\n\tconstructor( count, instanceMatrix, instanceColor ) {\n\n\t\tsuper( 'void' );\n\n\t\tthis.count = count;\n\t\tthis.instanceMatrix = instanceMatrix;\n\t\tthis.instanceColor = instanceColor;\n\n\t\tthis.instanceMatrixNode = null;\n\n\t\tthis.instanceColorNode = null;\n\n\t\tthis.updateType = NodeUpdateType.FRAME;\n\n\t\tthis.buffer = null;\n\t\tthis.bufferColor = null;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { count, instanceMatrix, instanceColor } = this;\n\n\t\tlet { instanceMatrixNode, instanceColorNode } = this;\n\n\t\tif ( instanceMatrixNode === null ) {\n\n\t\t\t// Both WebGPU and WebGL backends have UBO max limited to 64kb. Matrix count number bigger than 1000 ( 16 * 4 * 1000 = 64kb ) will fallback to attribute.\n\n\t\t\tif ( count <= 1000 ) {\n\n\t\t\t\tinstanceMatrixNode = buffer( instanceMatrix.array, 'mat4', Math.max( count, 1 ) ).element( instanceIndex );\n\n\t\t\t} else {\n\n\t\t\t\tconst buffer = new InstancedInterleavedBuffer( instanceMatrix.array, 16, 1 );\n\n\t\t\t\tthis.buffer = buffer;\n\n\t\t\t\tconst bufferFn = instanceMatrix.usage === DynamicDrawUsage ? instancedDynamicBufferAttribute : instancedBufferAttribute;\n\n\t\t\t\tconst instanceBuffers = [\n\t\t\t\t\t// F.Signature -> bufferAttribute( array, type, stride, offset )\n\t\t\t\t\tbufferFn( buffer, 'vec4', 16, 0 ),\n\t\t\t\t\tbufferFn( buffer, 'vec4', 16, 4 ),\n\t\t\t\t\tbufferFn( buffer, 'vec4', 16, 8 ),\n\t\t\t\t\tbufferFn( buffer, 'vec4', 16, 12 )\n\t\t\t\t];\n\n\t\t\t\tinstanceMatrixNode = mat4( ...instanceBuffers );\n\n\t\t\t}\n\n\t\t\tthis.instanceMatrixNode = instanceMatrixNode;\n\n\t\t}\n\n\t\tif ( instanceColor && instanceColorNode === null ) {\n\n\t\t\tconst buffer = new InstancedBufferAttribute( instanceColor.array, 3 );\n\n\t\t\tconst bufferFn = instanceColor.usage === DynamicDrawUsage ? instancedDynamicBufferAttribute : instancedBufferAttribute;\n\n\t\t\tthis.bufferColor = buffer;\n\n\t\t\tinstanceColorNode = vec3( bufferFn( buffer, 'vec3', 3, 0 ) );\n\n\t\t\tthis.instanceColorNode = instanceColorNode;\n\n\t\t}\n\n\t\t// POSITION\n\n\t\tconst instancePosition = instanceMatrixNode.mul( positionLocal ).xyz;\n\t\tpositionLocal.assign( instancePosition );\n\n\t\t// NORMAL\n\n\t\tif ( builder.hasGeometryAttribute( 'normal' ) ) {\n\n\t\t\tconst instanceNormal = transformNormal( normalLocal, instanceMatrixNode );\n\n\t\t\t// ASSIGNS\n\n\t\t\tnormalLocal.assign( instanceNormal );\n\n\t\t}\n\n\t\t// COLOR\n\n\t\tif ( this.instanceColorNode !== null ) {\n\n\t\t\tvaryingProperty( 'vec3', 'vInstanceColor' ).assign( this.instanceColorNode );\n\n\t\t}\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tif ( this.instanceMatrix.usage !== DynamicDrawUsage && this.buffer != null && this.instanceMatrix.version !== this.buffer.version ) {\n\n\t\t\tthis.buffer.version = this.instanceMatrix.version;\n\n\t\t}\n\n\t\tif ( this.instanceColor && this.instanceColor.usage !== DynamicDrawUsage && this.bufferColor != null && this.instanceColor.version !== this.bufferColor.version ) {\n\n\t\t\tthis.bufferColor.version = this.instanceColor.version;\n\n\t\t}\n\n\t}\n\n}\n\nconst instance = /*@__PURE__*/ nodeProxy( InstanceNode );\n\nclass InstancedMeshNode extends InstanceNode {\n\n\tstatic get type() {\n\n\t\treturn 'InstancedMeshNode';\n\n\t}\n\n\tconstructor( instanceMesh ) {\n\n\t\tconst { count, instanceMatrix, instanceColor } = instanceMesh;\n\n\t\tsuper( count, instanceMatrix, instanceColor );\n\n\t\tthis.instanceMesh = instanceMesh;\n\n\t}\n\n}\n\nconst instancedMesh = /*@__PURE__*/ nodeProxy( InstancedMeshNode );\n\nclass BatchNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'BatchNode';\n\n\t}\n\n\tconstructor( batchMesh ) {\n\n\t\tsuper( 'void' );\n\n\t\tthis.batchMesh = batchMesh;\n\n\n\t\tthis.batchingIdNode = null;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\t// POSITION\n\n\t\tif ( this.batchingIdNode === null ) {\n\n\t\t\tif ( builder.getDrawIndex() === null ) {\n\n\t\t\t\tthis.batchingIdNode = instanceIndex;\n\n\t\t\t} else {\n\n\t\t\t\tthis.batchingIdNode = drawIndex;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst getIndirectIndex = Fn( ( [ id ] ) => {\n\n\t\t\tconst size = textureSize( textureLoad( this.batchMesh._indirectTexture ), 0 );\n\t\t\tconst x = int( id ).modInt( int( size ) );\n\t\t\tconst y = int( id ).div( int( size ) );\n\t\t\treturn textureLoad( this.batchMesh._indirectTexture, ivec2( x, y ) ).x;\n\n\t\t} ).setLayout( {\n\t\t\tname: 'getIndirectIndex',\n\t\t\ttype: 'uint',\n\t\t\tinputs: [\n\t\t\t\t{ name: 'id', type: 'int' }\n\t\t\t]\n\t\t} );\n\n\t\tconst indirectId = getIndirectIndex( int( this.batchingIdNode ) );\n\n\t\tconst matricesTexture = this.batchMesh._matricesTexture;\n\n\t\tconst size = textureSize( textureLoad( matricesTexture ), 0 );\n\t\tconst j = float( indirectId ).mul( 4 ).toInt().toVar();\n\n\t\tconst x = j.modInt( size );\n\t\tconst y = j.div( int( size ) );\n\t\tconst batchingMatrix = mat4(\n\t\t\ttextureLoad( matricesTexture, ivec2( x, y ) ),\n\t\t\ttextureLoad( matricesTexture, ivec2( x.add( 1 ), y ) ),\n\t\t\ttextureLoad( matricesTexture, ivec2( x.add( 2 ), y ) ),\n\t\t\ttextureLoad( matricesTexture, ivec2( x.add( 3 ), y ) )\n\t\t);\n\n\n\t\tconst colorsTexture = this.batchMesh._colorsTexture;\n\n\t\tif ( colorsTexture !== null ) {\n\n\t\t\tconst getBatchingColor = Fn( ( [ id ] ) => {\n\n\t\t\t\tconst size = textureSize( textureLoad( colorsTexture ), 0 ).x;\n\t\t\t\tconst j = id;\n\t\t\t\tconst x = j.modInt( size );\n\t\t\t\tconst y = j.div( size );\n\t\t\t\treturn textureLoad( colorsTexture, ivec2( x, y ) ).rgb;\n\n\t\t\t} ).setLayout( {\n\t\t\t\tname: 'getBatchingColor',\n\t\t\t\ttype: 'vec3',\n\t\t\t\tinputs: [\n\t\t\t\t\t{ name: 'id', type: 'int' }\n\t\t\t\t]\n\t\t\t} );\n\n\t\t\tconst color = getBatchingColor( indirectId );\n\n\t\t\tvaryingProperty( 'vec3', 'vBatchColor' ).assign( color );\n\n\t\t}\n\n\t\tconst bm = mat3( batchingMatrix );\n\n\t\tpositionLocal.assign( batchingMatrix.mul( positionLocal ) );\n\n\t\tconst transformedNormal = normalLocal.div( vec3( bm[ 0 ].dot( bm[ 0 ] ), bm[ 1 ].dot( bm[ 1 ] ), bm[ 2 ].dot( bm[ 2 ] ) ) );\n\n\t\tconst batchingNormal = bm.mul( transformedNormal ).xyz;\n\n\t\tnormalLocal.assign( batchingNormal );\n\n\t\tif ( builder.hasGeometryAttribute( 'tangent' ) ) {\n\n\t\t\ttangentLocal.mulAssign( bm );\n\n\t\t}\n\n\t}\n\n}\n\nconst batch = /*@__PURE__*/ nodeProxy( BatchNode );\n\nconst _frameId = new WeakMap();\n\nclass SkinningNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'SkinningNode';\n\n\t}\n\n\tconstructor( skinnedMesh, useReference = false ) {\n\n\t\tsuper( 'void' );\n\n\t\tthis.skinnedMesh = skinnedMesh;\n\t\tthis.useReference = useReference;\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\n\t\t//\n\n\t\tthis.skinIndexNode = attribute( 'skinIndex', 'uvec4' );\n\t\tthis.skinWeightNode = attribute( 'skinWeight', 'vec4' );\n\n\t\tlet bindMatrixNode, bindMatrixInverseNode, boneMatricesNode;\n\n\t\tif ( useReference ) {\n\n\t\t\tbindMatrixNode = reference( 'bindMatrix', 'mat4' );\n\t\t\tbindMatrixInverseNode = reference( 'bindMatrixInverse', 'mat4' );\n\t\t\tboneMatricesNode = referenceBuffer( 'skeleton.boneMatrices', 'mat4', skinnedMesh.skeleton.bones.length );\n\n\t\t} else {\n\n\t\t\tbindMatrixNode = uniform( skinnedMesh.bindMatrix, 'mat4' );\n\t\t\tbindMatrixInverseNode = uniform( skinnedMesh.bindMatrixInverse, 'mat4' );\n\t\t\tboneMatricesNode = buffer( skinnedMesh.skeleton.boneMatrices, 'mat4', skinnedMesh.skeleton.bones.length );\n\n\t\t}\n\n\t\tthis.bindMatrixNode = bindMatrixNode;\n\t\tthis.bindMatrixInverseNode = bindMatrixInverseNode;\n\t\tthis.boneMatricesNode = boneMatricesNode;\n\t\tthis.previousBoneMatricesNode = null;\n\n\t}\n\n\tgetSkinnedPosition( boneMatrices = this.boneMatricesNode, position = positionLocal ) {\n\n\t\tconst { skinIndexNode, skinWeightNode, bindMatrixNode, bindMatrixInverseNode } = this;\n\n\t\tconst boneMatX = boneMatrices.element( skinIndexNode.x );\n\t\tconst boneMatY = boneMatrices.element( skinIndexNode.y );\n\t\tconst boneMatZ = boneMatrices.element( skinIndexNode.z );\n\t\tconst boneMatW = boneMatrices.element( skinIndexNode.w );\n\n\t\t// POSITION\n\n\t\tconst skinVertex = bindMatrixNode.mul( position );\n\n\t\tconst skinned = add(\n\t\t\tboneMatX.mul( skinWeightNode.x ).mul( skinVertex ),\n\t\t\tboneMatY.mul( skinWeightNode.y ).mul( skinVertex ),\n\t\t\tboneMatZ.mul( skinWeightNode.z ).mul( skinVertex ),\n\t\t\tboneMatW.mul( skinWeightNode.w ).mul( skinVertex )\n\t\t);\n\n\t\treturn bindMatrixInverseNode.mul( skinned ).xyz;\n\n\t}\n\n\tgetSkinnedNormal( boneMatrices = this.boneMatricesNode, normal = normalLocal ) {\n\n\t\tconst { skinIndexNode, skinWeightNode, bindMatrixNode, bindMatrixInverseNode } = this;\n\n\t\tconst boneMatX = boneMatrices.element( skinIndexNode.x );\n\t\tconst boneMatY = boneMatrices.element( skinIndexNode.y );\n\t\tconst boneMatZ = boneMatrices.element( skinIndexNode.z );\n\t\tconst boneMatW = boneMatrices.element( skinIndexNode.w );\n\n\t\t// NORMAL\n\n\t\tlet skinMatrix = add(\n\t\t\tskinWeightNode.x.mul( boneMatX ),\n\t\t\tskinWeightNode.y.mul( boneMatY ),\n\t\t\tskinWeightNode.z.mul( boneMatZ ),\n\t\t\tskinWeightNode.w.mul( boneMatW )\n\t\t);\n\n\t\tskinMatrix = bindMatrixInverseNode.mul( skinMatrix ).mul( bindMatrixNode );\n\n\t\treturn skinMatrix.transformDirection( normal ).xyz;\n\n\t}\n\n\tgetPreviousSkinnedPosition( builder ) {\n\n\t\tconst skinnedMesh = builder.object;\n\n\t\tif ( this.previousBoneMatricesNode === null ) {\n\n\t\t\tskinnedMesh.skeleton.previousBoneMatrices = new Float32Array( skinnedMesh.skeleton.boneMatrices );\n\n\t\t\tthis.previousBoneMatricesNode = referenceBuffer( 'skeleton.previousBoneMatrices', 'mat4', skinnedMesh.skeleton.bones.length );\n\n\t\t}\n\n\t\treturn this.getSkinnedPosition( this.previousBoneMatricesNode, positionPrevious );\n\n\t}\n\n\tneedsPreviousBoneMatrices( builder ) {\n\n\t\tconst mrt = builder.renderer.getMRT();\n\n\t\treturn mrt && mrt.has( 'velocity' );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( this.needsPreviousBoneMatrices( builder ) ) {\n\n\t\t\tpositionPrevious.assign( this.getPreviousSkinnedPosition( builder ) );\n\n\t\t}\n\n\t\tconst skinPosition = this.getSkinnedPosition();\n\n\n\t\tpositionLocal.assign( skinPosition );\n\n\t\tif ( builder.hasGeometryAttribute( 'normal' ) ) {\n\n\t\t\tconst skinNormal = this.getSkinnedNormal();\n\n\t\t\tnormalLocal.assign( skinNormal );\n\n\t\t\tif ( builder.hasGeometryAttribute( 'tangent' ) ) {\n\n\t\t\t\ttangentLocal.assign( skinNormal );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tif ( output !== 'void' ) {\n\n\t\t\treturn positionLocal.build( builder, output );\n\n\t\t}\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tconst object = this.useReference ? frame.object : this.skinnedMesh;\n\t\tconst skeleton = object.skeleton;\n\n\t\tif ( _frameId.get( skeleton ) === frame.frameId ) return;\n\n\t\t_frameId.set( skeleton, frame.frameId );\n\n\t\tif ( this.previousBoneMatricesNode !== null ) skeleton.previousBoneMatrices.set( skeleton.boneMatrices );\n\n\t\tskeleton.update();\n\n\t}\n\n}\n\nconst skinning = ( skinnedMesh ) => nodeObject( new SkinningNode( skinnedMesh ) );\nconst skinningReference = ( skinnedMesh ) => nodeObject( new SkinningNode( skinnedMesh, true ) );\n\nclass LoopNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'LoopNode';\n\n\t}\n\n\tconstructor( params = [] ) {\n\n\t\tsuper();\n\n\t\tthis.params = params;\n\n\t}\n\n\tgetVarName( index ) {\n\n\t\treturn String.fromCharCode( 'i'.charCodeAt() + index );\n\n\t}\n\n\tgetProperties( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\tif ( properties.stackNode !== undefined ) return properties;\n\n\t\t//\n\n\t\tconst inputs = {};\n\n\t\tfor ( let i = 0, l = this.params.length - 1; i < l; i ++ ) {\n\n\t\t\tconst param = this.params[ i ];\n\n\t\t\tconst name = ( param.isNode !== true && param.name ) || this.getVarName( i );\n\t\t\tconst type = ( param.isNode !== true && param.type ) || 'int';\n\n\t\t\tinputs[ name ] = expression( name, type );\n\n\t\t}\n\n\t\tconst stack = builder.addStack(); // TODO: cache() it\n\n\t\tproperties.returnsNode = this.params[ this.params.length - 1 ]( inputs, stack, builder );\n\t\tproperties.stackNode = stack;\n\n\t\tbuilder.removeStack();\n\n\t\treturn properties;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst { returnsNode } = this.getProperties( builder );\n\n\t\treturn returnsNode ? returnsNode.getNodeType( builder ) : 'void';\n\n\t}\n\n\tsetup( builder ) {\n\n\t\t// setup properties\n\n\t\tthis.getProperties( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst properties = this.getProperties( builder );\n\n\t\tconst params = this.params;\n\t\tconst stackNode = properties.stackNode;\n\n\t\tfor ( let i = 0, l = params.length - 1; i < l; i ++ ) {\n\n\t\t\tconst param = params[ i ];\n\n\t\t\tlet start = null, end = null, name = null, type = null, condition = null, update = null;\n\n\t\t\tif ( param.isNode ) {\n\n\t\t\t\ttype = 'int';\n\t\t\t\tname = this.getVarName( i );\n\t\t\t\tstart = '0';\n\t\t\t\tend = param.build( builder, type );\n\t\t\t\tcondition = '<';\n\n\t\t\t} else {\n\n\t\t\t\ttype = param.type || 'int';\n\t\t\t\tname = param.name || this.getVarName( i );\n\t\t\t\tstart = param.start;\n\t\t\t\tend = param.end;\n\t\t\t\tcondition = param.condition;\n\t\t\t\tupdate = param.update;\n\n\t\t\t\tif ( typeof start === 'number' ) start = builder.generateConst( type, start );\n\t\t\t\telse if ( start && start.isNode ) start = start.build( builder, type );\n\n\t\t\t\tif ( typeof end === 'number' ) end = builder.generateConst( type, end );\n\t\t\t\telse if ( end && end.isNode ) end = end.build( builder, type );\n\n\t\t\t\tif ( start !== undefined && end === undefined ) {\n\n\t\t\t\t\tstart = start + ' - 1';\n\t\t\t\t\tend = '0';\n\t\t\t\t\tcondition = '>=';\n\n\t\t\t\t} else if ( end !== undefined && start === undefined ) {\n\n\t\t\t\t\tstart = '0';\n\t\t\t\t\tcondition = '<';\n\n\t\t\t\t}\n\n\t\t\t\tif ( condition === undefined ) {\n\n\t\t\t\t\tif ( Number( start ) > Number( end ) ) {\n\n\t\t\t\t\t\tcondition = '>=';\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tcondition = '<';\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst internalParam = { start, end, condition };\n\n\t\t\t//\n\n\t\t\tconst startSnippet = internalParam.start;\n\t\t\tconst endSnippet = internalParam.end;\n\n\t\t\tlet declarationSnippet = '';\n\t\t\tlet conditionalSnippet = '';\n\t\t\tlet updateSnippet = '';\n\n\t\t\tif ( ! update ) {\n\n\t\t\t\tif ( type === 'int' || type === 'uint' ) {\n\n\t\t\t\t\tif ( condition.includes( '<' ) ) update = '++';\n\t\t\t\t\telse update = '--';\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( condition.includes( '<' ) ) update = '+= 1.';\n\t\t\t\t\telse update = '-= 1.';\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tdeclarationSnippet += builder.getVar( type, name ) + ' = ' + startSnippet;\n\n\t\t\tconditionalSnippet += name + ' ' + condition + ' ' + endSnippet;\n\t\t\tupdateSnippet += name + ' ' + update;\n\n\t\t\tconst forSnippet = `for ( ${ declarationSnippet }; ${ conditionalSnippet }; ${ updateSnippet } )`;\n\n\t\t\tbuilder.addFlowCode( ( i === 0 ? '\\n' : '' ) + builder.tab + forSnippet + ' {\\n\\n' ).addFlowTab();\n\n\t\t}\n\n\t\tconst stackSnippet = stackNode.build( builder, 'void' );\n\n\t\tconst returnsSnippet = properties.returnsNode ? properties.returnsNode.build( builder ) : '';\n\n\t\tbuilder.removeFlowTab().addFlowCode( '\\n' + builder.tab + stackSnippet );\n\n\t\tfor ( let i = 0, l = this.params.length - 1; i < l; i ++ ) {\n\n\t\t\tbuilder.addFlowCode( ( i === 0 ? '' : builder.tab ) + '}\\n\\n' ).removeFlowTab();\n\n\t\t}\n\n\t\tbuilder.addFlowTab();\n\n\t\treturn returnsSnippet;\n\n\t}\n\n}\n\nconst Loop = ( ...params ) => nodeObject( new LoopNode( nodeArray( params, 'int' ) ) ).append();\nconst Continue = () => expression( 'continue' ).append();\nconst Break = () => expression( 'break' ).append();\n\n//\n\nconst loop = ( ...params ) => { // @deprecated, r168\n\n\tconsole.warn( 'TSL.LoopNode: loop() has been renamed to Loop().' );\n\treturn Loop( ...params );\n\n};\n\nconst _morphTextures = /*@__PURE__*/ new WeakMap();\nconst _morphVec4 = /*@__PURE__*/ new Vector4();\n\nconst getMorph = /*@__PURE__*/ Fn( ( { bufferMap, influence, stride, width, depth, offset } ) => {\n\n\tconst texelIndex = int( vertexIndex ).mul( stride ).add( offset );\n\n\tconst y = texelIndex.div( width );\n\tconst x = texelIndex.sub( y.mul( width ) );\n\n\tconst bufferAttrib = textureLoad( bufferMap, ivec2( x, y ) ).depth( depth );\n\n\treturn bufferAttrib.mul( influence );\n\n} );\n\nfunction getEntry( geometry ) {\n\n\tconst hasMorphPosition = geometry.morphAttributes.position !== undefined;\n\tconst hasMorphNormals = geometry.morphAttributes.normal !== undefined;\n\tconst hasMorphColors = geometry.morphAttributes.color !== undefined;\n\n\t// instead of using attributes, the WebGL 2 code path encodes morph targets\n\t// into an array of data textures. Each layer represents a single morph target.\n\n\tconst morphAttribute = geometry.morphAttributes.position || geometry.morphAttributes.normal || geometry.morphAttributes.color;\n\tconst morphTargetsCount = ( morphAttribute !== undefined ) ? morphAttribute.length : 0;\n\n\tlet entry = _morphTextures.get( geometry );\n\n\tif ( entry === undefined || entry.count !== morphTargetsCount ) {\n\n\t\tif ( entry !== undefined ) entry.texture.dispose();\n\n\t\tconst morphTargets = geometry.morphAttributes.position || [];\n\t\tconst morphNormals = geometry.morphAttributes.normal || [];\n\t\tconst morphColors = geometry.morphAttributes.color || [];\n\n\t\tlet vertexDataCount = 0;\n\n\t\tif ( hasMorphPosition === true ) vertexDataCount = 1;\n\t\tif ( hasMorphNormals === true ) vertexDataCount = 2;\n\t\tif ( hasMorphColors === true ) vertexDataCount = 3;\n\n\t\tlet width = geometry.attributes.position.count * vertexDataCount;\n\t\tlet height = 1;\n\n\t\tconst maxTextureSize = 4096; // @TODO: Use 'capabilities.maxTextureSize'\n\n\t\tif ( width > maxTextureSize ) {\n\n\t\t\theight = Math.ceil( width / maxTextureSize );\n\t\t\twidth = maxTextureSize;\n\n\t\t}\n\n\t\tconst buffer = new Float32Array( width * height * 4 * morphTargetsCount );\n\n\t\tconst bufferTexture = new DataArrayTexture( buffer, width, height, morphTargetsCount );\n\t\tbufferTexture.type = FloatType;\n\t\tbufferTexture.needsUpdate = true;\n\n\t\t// fill buffer\n\n\t\tconst vertexDataStride = vertexDataCount * 4;\n\n\t\tfor ( let i = 0; i < morphTargetsCount; i ++ ) {\n\n\t\t\tconst morphTarget = morphTargets[ i ];\n\t\t\tconst morphNormal = morphNormals[ i ];\n\t\t\tconst morphColor = morphColors[ i ];\n\n\t\t\tconst offset = width * height * 4 * i;\n\n\t\t\tfor ( let j = 0; j < morphTarget.count; j ++ ) {\n\n\t\t\t\tconst stride = j * vertexDataStride;\n\n\t\t\t\tif ( hasMorphPosition === true ) {\n\n\t\t\t\t\t_morphVec4.fromBufferAttribute( morphTarget, j );\n\n\t\t\t\t\tbuffer[ offset + stride + 0 ] = _morphVec4.x;\n\t\t\t\t\tbuffer[ offset + stride + 1 ] = _morphVec4.y;\n\t\t\t\t\tbuffer[ offset + stride + 2 ] = _morphVec4.z;\n\t\t\t\t\tbuffer[ offset + stride + 3 ] = 0;\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasMorphNormals === true ) {\n\n\t\t\t\t\t_morphVec4.fromBufferAttribute( morphNormal, j );\n\n\t\t\t\t\tbuffer[ offset + stride + 4 ] = _morphVec4.x;\n\t\t\t\t\tbuffer[ offset + stride + 5 ] = _morphVec4.y;\n\t\t\t\t\tbuffer[ offset + stride + 6 ] = _morphVec4.z;\n\t\t\t\t\tbuffer[ offset + stride + 7 ] = 0;\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasMorphColors === true ) {\n\n\t\t\t\t\t_morphVec4.fromBufferAttribute( morphColor, j );\n\n\t\t\t\t\tbuffer[ offset + stride + 8 ] = _morphVec4.x;\n\t\t\t\t\tbuffer[ offset + stride + 9 ] = _morphVec4.y;\n\t\t\t\t\tbuffer[ offset + stride + 10 ] = _morphVec4.z;\n\t\t\t\t\tbuffer[ offset + stride + 11 ] = ( morphColor.itemSize === 4 ) ? _morphVec4.w : 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tentry = {\n\t\t\tcount: morphTargetsCount,\n\t\t\ttexture: bufferTexture,\n\t\t\tstride: vertexDataCount,\n\t\t\tsize: new Vector2( width, height )\n\t\t};\n\n\t\t_morphTextures.set( geometry, entry );\n\n\t\tfunction disposeTexture() {\n\n\t\t\tbufferTexture.dispose();\n\n\t\t\t_morphTextures.delete( geometry );\n\n\t\t\tgeometry.removeEventListener( 'dispose', disposeTexture );\n\n\t\t}\n\n\t\tgeometry.addEventListener( 'dispose', disposeTexture );\n\n\t}\n\n\treturn entry;\n\n}\n\n\nclass MorphNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'MorphNode';\n\n\t}\n\n\tconstructor( mesh ) {\n\n\t\tsuper( 'void' );\n\n\t\tthis.mesh = mesh;\n\t\tthis.morphBaseInfluence = uniform( 1 );\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { geometry } = builder;\n\n\t\tconst hasMorphPosition = geometry.morphAttributes.position !== undefined;\n\t\tconst hasMorphNormals = geometry.hasAttribute( 'normal' ) && geometry.morphAttributes.normal !== undefined;\n\n\t\tconst morphAttribute = geometry.morphAttributes.position || geometry.morphAttributes.normal || geometry.morphAttributes.color;\n\t\tconst morphTargetsCount = ( morphAttribute !== undefined ) ? morphAttribute.length : 0;\n\n\t\t// nodes\n\n\t\tconst { texture: bufferMap, stride, size } = getEntry( geometry );\n\n\t\tif ( hasMorphPosition === true ) positionLocal.mulAssign( this.morphBaseInfluence );\n\t\tif ( hasMorphNormals === true ) normalLocal.mulAssign( this.morphBaseInfluence );\n\n\t\tconst width = int( size.width );\n\n\t\tLoop( morphTargetsCount, ( { i } ) => {\n\n\t\t\tconst influence = float( 0 ).toVar();\n\n\t\t\tif ( this.mesh.count > 1 && ( this.mesh.morphTexture !== null && this.mesh.morphTexture !== undefined ) ) {\n\n\t\t\t\tinfluence.assign( textureLoad( this.mesh.morphTexture, ivec2( int( i ).add( 1 ), int( instanceIndex ) ) ).r );\n\n\t\t\t} else {\n\n\t\t\t\tinfluence.assign( reference( 'morphTargetInfluences', 'float' ).element( i ).toVar() );\n\n\t\t\t}\n\n\t\t\tif ( hasMorphPosition === true ) {\n\n\t\t\t\tpositionLocal.addAssign( getMorph( {\n\t\t\t\t\tbufferMap,\n\t\t\t\t\tinfluence,\n\t\t\t\t\tstride,\n\t\t\t\t\twidth,\n\t\t\t\t\tdepth: i,\n\t\t\t\t\toffset: int( 0 )\n\t\t\t\t} ) );\n\n\t\t\t}\n\n\t\t\tif ( hasMorphNormals === true ) {\n\n\t\t\t\tnormalLocal.addAssign( getMorph( {\n\t\t\t\t\tbufferMap,\n\t\t\t\t\tinfluence,\n\t\t\t\t\tstride,\n\t\t\t\t\twidth,\n\t\t\t\t\tdepth: i,\n\t\t\t\t\toffset: int( 1 )\n\t\t\t\t} ) );\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\tupdate() {\n\n\t\tconst morphBaseInfluence = this.morphBaseInfluence;\n\n\t\tif ( this.mesh.geometry.morphTargetsRelative ) {\n\n\t\t\tmorphBaseInfluence.value = 1;\n\n\t\t} else {\n\n\t\t\tmorphBaseInfluence.value = 1 - this.mesh.morphTargetInfluences.reduce( ( a, b ) => a + b, 0 );\n\n\t\t}\n\n\t}\n\n}\n\nconst morphReference = /*@__PURE__*/ nodeProxy( MorphNode );\n\nclass LightingNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'LightingNode';\n\n\t}\n\n\tconstructor() {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.isLightingNode = true;\n\n\t}\n\n\tgenerate( /*builder*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n}\n\nclass AONode extends LightingNode {\n\n\tstatic get type() {\n\n\t\treturn 'AONode';\n\n\t}\n\n\tconstructor( aoNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.aoNode = aoNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tbuilder.context.ambientOcclusion.mulAssign( this.aoNode );\n\n\t}\n\n}\n\nclass LightingContextNode extends ContextNode {\n\n\tstatic get type() {\n\n\t\treturn 'LightingContextNode';\n\n\t}\n\n\tconstructor( node, lightingModel = null, backdropNode = null, backdropAlphaNode = null ) {\n\n\t\tsuper( node );\n\n\t\tthis.lightingModel = lightingModel;\n\t\tthis.backdropNode = backdropNode;\n\t\tthis.backdropAlphaNode = backdropAlphaNode;\n\n\t\tthis._value = null;\n\n\t}\n\n\tgetContext() {\n\n\t\tconst { backdropNode, backdropAlphaNode } = this;\n\n\t\tconst directDiffuse = vec3().toVar( 'directDiffuse' ),\n\t\t\tdirectSpecular = vec3().toVar( 'directSpecular' ),\n\t\t\tindirectDiffuse = vec3().toVar( 'indirectDiffuse' ),\n\t\t\tindirectSpecular = vec3().toVar( 'indirectSpecular' );\n\n\t\tconst reflectedLight = {\n\t\t\tdirectDiffuse,\n\t\t\tdirectSpecular,\n\t\t\tindirectDiffuse,\n\t\t\tindirectSpecular\n\t\t};\n\n\t\tconst context = {\n\t\t\tradiance: vec3().toVar( 'radiance' ),\n\t\t\tirradiance: vec3().toVar( 'irradiance' ),\n\t\t\tiblIrradiance: vec3().toVar( 'iblIrradiance' ),\n\t\t\tambientOcclusion: float( 1 ).toVar( 'ambientOcclusion' ),\n\t\t\treflectedLight,\n\t\t\tbackdrop: backdropNode,\n\t\t\tbackdropAlpha: backdropAlphaNode\n\t\t};\n\n\t\treturn context;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.value = this._value || ( this._value = this.getContext() );\n\t\tthis.value.lightingModel = this.lightingModel || builder.context.lightingModel;\n\n\t\treturn super.setup( builder );\n\n\t}\n\n}\n\nconst lightingContext = /*@__PURE__*/ nodeProxy( LightingContextNode );\n\nclass IrradianceNode extends LightingNode {\n\n\tstatic get type() {\n\n\t\treturn 'IrradianceNode';\n\n\t}\n\n\tconstructor( node ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tbuilder.context.irradiance.addAssign( this.node );\n\n\t}\n\n}\n\nlet screenSizeVec, viewportVec;\n\nclass ScreenNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ScreenNode';\n\n\t}\n\n\tconstructor( scope ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\n\t\tthis.isViewportNode = true;\n\n\t}\n\n\tgetNodeType() {\n\n\t\tif ( this.scope === ScreenNode.VIEWPORT ) return 'vec4';\n\t\telse return 'vec2';\n\n\t}\n\n\tgetUpdateType() {\n\n\t\tlet updateType = NodeUpdateType.NONE;\n\n\t\tif ( this.scope === ScreenNode.SIZE || this.scope === ScreenNode.VIEWPORT ) {\n\n\t\t\tupdateType = NodeUpdateType.RENDER;\n\n\t\t}\n\n\t\tthis.updateType = updateType;\n\n\t\treturn updateType;\n\n\t}\n\n\tupdate( { renderer } ) {\n\n\t\tconst renderTarget = renderer.getRenderTarget();\n\n\t\tif ( this.scope === ScreenNode.VIEWPORT ) {\n\n\t\t\tif ( renderTarget !== null ) {\n\n\t\t\t\tviewportVec.copy( renderTarget.viewport );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.getViewport( viewportVec );\n\n\t\t\t\tviewportVec.multiplyScalar( renderer.getPixelRatio() );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( renderTarget !== null ) {\n\n\t\t\t\tscreenSizeVec.width = renderTarget.width;\n\t\t\t\tscreenSizeVec.height = renderTarget.height;\n\n\t\t\t} else {\n\n\t\t\t\trenderer.getDrawingBufferSize( screenSizeVec );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetup( /*builder*/ ) {\n\n\t\tconst scope = this.scope;\n\n\t\tlet output = null;\n\n\t\tif ( scope === ScreenNode.SIZE ) {\n\n\t\t\toutput = uniform( screenSizeVec || ( screenSizeVec = new Vector2() ) );\n\n\t\t} else if ( scope === ScreenNode.VIEWPORT ) {\n\n\t\t\toutput = uniform( viewportVec || ( viewportVec = new Vector4() ) );\n\n\t\t} else {\n\n\t\t\toutput = vec2( screenCoordinate.div( screenSize ) );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tif ( this.scope === ScreenNode.COORDINATE ) {\n\n\t\t\tlet coord = builder.getFragCoord();\n\n\t\t\tif ( builder.isFlipY() ) {\n\n\t\t\t\t// follow webgpu standards\n\n\t\t\t\tconst size = builder.getNodeProperties( screenSize ).outputNode.build( builder );\n\n\t\t\t\tcoord = `${ builder.getType( 'vec2' ) }( ${ coord }.x, ${ size }.y - ${ coord }.y )`;\n\n\t\t\t}\n\n\t\t\treturn coord;\n\n\t\t}\n\n\t\treturn super.generate( builder );\n\n\t}\n\n}\n\nScreenNode.COORDINATE = 'coordinate';\nScreenNode.VIEWPORT = 'viewport';\nScreenNode.SIZE = 'size';\nScreenNode.UV = 'uv';\n\n// Screen\n\nconst screenUV = /*@__PURE__*/ nodeImmutable( ScreenNode, ScreenNode.UV );\nconst screenSize = /*@__PURE__*/ nodeImmutable( ScreenNode, ScreenNode.SIZE );\nconst screenCoordinate = /*@__PURE__*/ nodeImmutable( ScreenNode, ScreenNode.COORDINATE );\n\n// Viewport\n\nconst viewport = /*@__PURE__*/ nodeImmutable( ScreenNode, ScreenNode.VIEWPORT );\nconst viewportSize = viewport.zw;\nconst viewportCoordinate = /*@__PURE__*/ screenCoordinate.sub( viewport.xy );\nconst viewportUV = /*@__PURE__*/ viewportCoordinate.div( viewportSize );\n\n// Deprecated\n\nconst viewportResolution = /*@__PURE__*/ ( Fn( () => { // @deprecated, r169\n\n\tconsole.warn( 'TSL.ViewportNode: \"viewportResolution\" is deprecated. Use \"screenSize\" instead.' );\n\n\treturn screenSize;\n\n}, 'vec2' ).once() )();\n\nconst viewportTopLeft = /*@__PURE__*/ ( Fn( () => { // @deprecated, r168\n\n\tconsole.warn( 'TSL.ViewportNode: \"viewportTopLeft\" is deprecated. Use \"screenUV\" instead.' );\n\n\treturn screenUV;\n\n}, 'vec2' ).once() )();\n\nconst viewportBottomLeft = /*@__PURE__*/ ( Fn( () => { // @deprecated, r168\n\n\tconsole.warn( 'TSL.ViewportNode: \"viewportBottomLeft\" is deprecated. Use \"screenUV.flipY()\" instead.' );\n\n\treturn screenUV.flipY();\n\n}, 'vec2' ).once() )();\n\nconst _size$4 = /*@__PURE__*/ new Vector2();\n\nclass ViewportTextureNode extends TextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'ViewportTextureNode';\n\n\t}\n\n\tconstructor( uvNode = screenUV, levelNode = null, framebufferTexture = null ) {\n\n\t\tif ( framebufferTexture === null ) {\n\n\t\t\tframebufferTexture = new FramebufferTexture();\n\t\t\tframebufferTexture.minFilter = LinearMipmapLinearFilter;\n\n\t\t}\n\n\t\tsuper( framebufferTexture, uvNode, levelNode );\n\n\t\tthis.generateMipmaps = false;\n\n\t\tthis.isOutputTextureNode = true;\n\n\t\tthis.updateBeforeType = NodeUpdateType.FRAME;\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst renderer = frame.renderer;\n\t\trenderer.getDrawingBufferSize( _size$4 );\n\n\t\t//\n\n\t\tconst framebufferTexture = this.value;\n\n\t\tif ( framebufferTexture.image.width !== _size$4.width || framebufferTexture.image.height !== _size$4.height ) {\n\n\t\t\tframebufferTexture.image.width = _size$4.width;\n\t\t\tframebufferTexture.image.height = _size$4.height;\n\t\t\tframebufferTexture.needsUpdate = true;\n\n\t\t}\n\n\t\t//\n\n\t\tconst currentGenerateMipmaps = framebufferTexture.generateMipmaps;\n\t\tframebufferTexture.generateMipmaps = this.generateMipmaps;\n\n\t\trenderer.copyFramebufferToTexture( framebufferTexture );\n\n\t\tframebufferTexture.generateMipmaps = currentGenerateMipmaps;\n\n\t}\n\n\tclone() {\n\n\t\tconst viewportTextureNode = new this.constructor( this.uvNode, this.levelNode, this.value );\n\t\tviewportTextureNode.generateMipmaps = this.generateMipmaps;\n\n\t\treturn viewportTextureNode;\n\n\t}\n\n}\n\nconst viewportTexture = /*@__PURE__*/ nodeProxy( ViewportTextureNode );\nconst viewportMipTexture = /*@__PURE__*/ nodeProxy( ViewportTextureNode, null, null, { generateMipmaps: true } );\n\nlet sharedDepthbuffer = null;\n\nclass ViewportDepthTextureNode extends ViewportTextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'ViewportDepthTextureNode';\n\n\t}\n\n\tconstructor( uvNode = screenUV, levelNode = null ) {\n\n\t\tif ( sharedDepthbuffer === null ) {\n\n\t\t\tsharedDepthbuffer = new DepthTexture();\n\n\t\t}\n\n\t\tsuper( uvNode, levelNode, sharedDepthbuffer );\n\n\t}\n\n}\n\nconst viewportDepthTexture = /*@__PURE__*/ nodeProxy( ViewportDepthTextureNode );\n\nclass ViewportDepthNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ViewportDepthNode';\n\n\t}\n\n\tconstructor( scope, valueNode = null ) {\n\n\t\tsuper( 'float' );\n\n\t\tthis.scope = scope;\n\t\tthis.valueNode = valueNode;\n\n\t\tthis.isViewportDepthNode = true;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { scope } = this;\n\n\t\tif ( scope === ViewportDepthNode.DEPTH_BASE ) {\n\n\t\t\treturn builder.getFragDepth();\n\n\t\t}\n\n\t\treturn super.generate( builder );\n\n\t}\n\n\tsetup( { camera } ) {\n\n\t\tconst { scope } = this;\n\t\tconst value = this.valueNode;\n\n\t\tlet node = null;\n\n\t\tif ( scope === ViewportDepthNode.DEPTH_BASE ) {\n\n\t\t\tif ( value !== null ) {\n\n \t\t\t\tnode = depthBase().assign( value );\n\n\t\t\t}\n\n\t\t} else if ( scope === ViewportDepthNode.DEPTH ) {\n\n\t\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\t\tnode = viewZToPerspectiveDepth( positionView.z, cameraNear, cameraFar );\n\n\t\t\t} else {\n\n\t\t\t\tnode = viewZToOrthographicDepth( positionView.z, cameraNear, cameraFar );\n\n\t\t\t}\n\n\t\t} else if ( scope === ViewportDepthNode.LINEAR_DEPTH ) {\n\n\t\t\tif ( value !== null ) {\n\n\t\t\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\t\t\tconst viewZ = perspectiveDepthToViewZ( value, cameraNear, cameraFar );\n\n\t\t\t\t\tnode = viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tnode = value;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tnode = viewZToOrthographicDepth( positionView.z, cameraNear, cameraFar );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n}\n\nViewportDepthNode.DEPTH_BASE = 'depthBase';\nViewportDepthNode.DEPTH = 'depth';\nViewportDepthNode.LINEAR_DEPTH = 'linearDepth';\n\n// NOTE: viewZ, the z-coordinate in camera space, is negative for points in front of the camera\n\n// -near maps to 0; -far maps to 1\nconst viewZToOrthographicDepth = ( viewZ, near, far ) => viewZ.add( near ).div( near.sub( far ) );\n\n// maps orthographic depth in [ 0, 1 ] to viewZ\nconst orthographicDepthToViewZ = ( depth, near, far ) => near.sub( far ).mul( depth ).sub( near );\n\n// NOTE: https://twitter.com/gonnavis/status/1377183786949959682\n\n// -near maps to 0; -far maps to 1\nconst viewZToPerspectiveDepth = ( viewZ, near, far ) => near.add( viewZ ).mul( far ).div( far.sub( near ).mul( viewZ ) );\n\n// maps perspective depth in [ 0, 1 ] to viewZ\nconst perspectiveDepthToViewZ = ( depth, near, far ) => near.mul( far ).div( far.sub( near ).mul( depth ).sub( far ) );\n\n// -near maps to 0; -far maps to 1\nconst viewZToLogarithmicDepth = ( viewZ, near, far ) => {\n\n\t// NOTE: viewZ must be negative--see explanation at the end of this comment block.\n\t// The final logarithmic depth formula used here is adapted from one described in an\n\t// article by Thatcher Ulrich (see http://tulrich.com/geekstuff/log_depth_buffer.txt),\n\t// which was an improvement upon an earlier formula one described in an\n\t// Outerra article (https://outerra.blogspot.com/2009/08/logarithmic-z-buffer.html).\n\t// Ulrich's formula is the following:\n\t//     z = K * log( w / cameraNear ) / log( cameraFar / cameraNear )\n\t//     where K = 2^k - 1, and k is the number of bits in the depth buffer.\n\t// The Outerra variant ignored the camera near plane (it assumed it was 0) and instead\n\t// opted for a \"C-constant\" for resolution adjustment of objects near the camera.\n\t// Outerra states: \"Notice that the 'C' variant doesn’t use a near plane distance, it has it\n\t// set at 0\" (quote from https://outerra.blogspot.com/2012/11/maximizing-depth-buffer-range-and.html).\n\t// Ulrich's variant has the benefit of constant relative precision over the whole near-far range.\n\t// It was debated here whether Outerra's \"C-constant\" or Ulrich's \"near plane\" variant should\n\t// be used, and ultimately Ulrich's \"near plane\" version was chosen.\n\t// Outerra eventually made another improvement to their original \"C-constant\" variant,\n\t// but it still does not incorporate the camera near plane (for this version,\n\t// see https://outerra.blogspot.com/2013/07/logarithmic-depth-buffer-optimizations.html).\n\t// Here we make 4 changes to Ulrich's formula:\n\t// 1. Clamp the camera near plane so we don't divide by 0.\n\t// 2. Use log2 instead of log to avoid an extra multiply (shaders implement log using log2).\n\t// 3. Assume K is 1 (K = maximum value in depth buffer; see Ulrich's formula above).\n\t// 4. To maintain consistency with the functions \"viewZToOrthographicDepth\" and \"viewZToPerspectiveDepth\",\n\t//    we modify the formula here to use 'viewZ' instead of 'w'. The other functions expect a negative viewZ,\n\t//    so we do the same here, hence the 'viewZ.negate()' call.\n\t// For visual representation of this depth curve, see https://www.desmos.com/calculator/uyqk0vex1u\n\tnear = near.max( 1e-6 ).toVar();\n\tconst numerator = log2( viewZ.negate().div( near ) );\n\tconst denominator = log2( far.div( near ) );\n\treturn numerator.div( denominator );\n\n};\n\n// maps logarithmic depth in [ 0, 1 ] to viewZ\nconst logarithmicDepthToViewZ = ( depth, near, far ) => {\n\n\t// NOTE: we add a 'negate()' call to the return value here to maintain consistency with\n\t// the functions \"orthographicDepthToViewZ\" and \"perspectiveDepthToViewZ\" (they return\n\t// a negative viewZ).\n\tconst exponent = depth.mul( log( far.div( near ) ) );\n\treturn float( Math.E ).pow( exponent ).mul( near ).negate();\n\n};\n\nconst depthBase = /*@__PURE__*/ nodeProxy( ViewportDepthNode, ViewportDepthNode.DEPTH_BASE );\n\nconst depth = /*@__PURE__*/ nodeImmutable( ViewportDepthNode, ViewportDepthNode.DEPTH );\nconst linearDepth = /*@__PURE__*/ nodeProxy( ViewportDepthNode, ViewportDepthNode.LINEAR_DEPTH );\nconst viewportLinearDepth = /*@__PURE__*/ linearDepth( viewportDepthTexture() );\n\ndepth.assign = ( value ) => depthBase( value );\n\nclass BuiltinNode extends Node {\n\n\tconstructor( name ) {\n\n\t\tsuper( 'float' );\n\n\t\tthis.name = name;\n\n\t\tthis.isBuiltinNode = true;\n\n\t}\n\n\tgenerate( /* builder */ ) {\n\n\t\treturn this.name;\n\n\t}\n\n}\n\nconst builtin = nodeProxy( BuiltinNode );\n\nclass ClippingNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ClippingNode';\n\n\t}\n\n\tconstructor( scope = ClippingNode.DEFAULT ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tconst clippingContext = builder.clippingContext;\n\t\tconst { intersectionPlanes, unionPlanes } = clippingContext;\n\n\t\tthis.hardwareClipping = builder.material.hardwareClipping;\n\n\t\tif ( this.scope === ClippingNode.ALPHA_TO_COVERAGE ) {\n\n\t\t\treturn this.setupAlphaToCoverage( intersectionPlanes, unionPlanes );\n\n\t\t} else if ( this.scope === ClippingNode.HARDWARE ) {\n\n\t\t\treturn this.setupHardwareClipping( unionPlanes, builder );\n\n\t\t} else {\n\n\t\t\treturn this.setupDefault( intersectionPlanes, unionPlanes );\n\n\t\t}\n\n\t}\n\n\tsetupAlphaToCoverage( intersectionPlanes, unionPlanes ) {\n\n\t\treturn Fn( () => {\n\n\t\t\tconst distanceToPlane = float().toVar( 'distanceToPlane' );\n\t\t\tconst distanceGradient = float().toVar( 'distanceToGradient' );\n\n\t\t\tconst clipOpacity = float( 1 ).toVar( 'clipOpacity' );\n\n\t\t\tconst numUnionPlanes = unionPlanes.length;\n\n\t\t\tif ( ! this.hardwareClipping && numUnionPlanes > 0 ) {\n\n\t\t\t\tconst clippingPlanes = uniformArray( unionPlanes );\n\n\t\t\t\tLoop( numUnionPlanes, ( { i } ) => {\n\n\t\t\t\t\tconst plane = clippingPlanes.element( i );\n\n\t\t\t\t\tdistanceToPlane.assign( positionView.dot( plane.xyz ).negate().add( plane.w ) );\n\t\t\t\t\tdistanceGradient.assign( distanceToPlane.fwidth().div( 2.0 ) );\n\n\t\t\t\t\tclipOpacity.mulAssign( smoothstep( distanceGradient.negate(), distanceGradient, distanceToPlane ) );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tconst numIntersectionPlanes = intersectionPlanes.length;\n\n\t\t\tif ( numIntersectionPlanes > 0 ) {\n\n\t\t\t\tconst clippingPlanes = uniformArray( intersectionPlanes );\n\t\t\t\tconst intersectionClipOpacity = float( 1 ).toVar( 'intersectionClipOpacity' );\n\n\t\t\t\tLoop( numIntersectionPlanes, ( { i } ) => {\n\n\t\t\t\t\tconst plane = clippingPlanes.element( i );\n\n\t\t\t\t\tdistanceToPlane.assign( positionView.dot( plane.xyz ).negate().add( plane.w ) );\n\t\t\t\t\tdistanceGradient.assign( distanceToPlane.fwidth().div( 2.0 ) );\n\n\t\t\t\t\tintersectionClipOpacity.mulAssign( smoothstep( distanceGradient.negate(), distanceGradient, distanceToPlane ).oneMinus() );\n\n\t\t\t\t} );\n\n\t\t\t\tclipOpacity.mulAssign( intersectionClipOpacity.oneMinus() );\n\n\t\t\t}\n\n\t\t\tdiffuseColor.a.mulAssign( clipOpacity );\n\n\t\t\tdiffuseColor.a.equal( 0.0 ).discard();\n\n\t\t} )();\n\n\t}\n\n\tsetupDefault( intersectionPlanes, unionPlanes ) {\n\n\t\treturn Fn( () => {\n\n\t\t\tconst numUnionPlanes = unionPlanes.length;\n\n\t\t\tif ( ! this.hardwareClipping && numUnionPlanes > 0 ) {\n\n\t\t\t\tconst clippingPlanes = uniformArray( unionPlanes );\n\n\t\t\t\tLoop( numUnionPlanes, ( { i } ) => {\n\n\t\t\t\t\tconst plane = clippingPlanes.element( i );\n\t\t\t\t\tpositionView.dot( plane.xyz ).greaterThan( plane.w ).discard();\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tconst numIntersectionPlanes = intersectionPlanes.length;\n\n\t\t\tif ( numIntersectionPlanes > 0 ) {\n\n\t\t\t\tconst clippingPlanes = uniformArray( intersectionPlanes );\n\t\t\t\tconst clipped = bool( true ).toVar( 'clipped' );\n\n\t\t\t\tLoop( numIntersectionPlanes, ( { i } ) => {\n\n\t\t\t\t\tconst plane = clippingPlanes.element( i );\n\t\t\t\t\tclipped.assign( positionView.dot( plane.xyz ).greaterThan( plane.w ).and( clipped ) );\n\n\t\t\t\t} );\n\n\t\t\t\tclipped.discard();\n\n\t\t\t}\n\n\t\t} )();\n\n\t}\n\n\tsetupHardwareClipping( unionPlanes, builder ) {\n\n\t\tconst numUnionPlanes = unionPlanes.length;\n\n\t\tbuilder.enableHardwareClipping( numUnionPlanes );\n\n\t\treturn Fn( () => {\n\n\t\t\tconst clippingPlanes = uniformArray( unionPlanes );\n\t\t\tconst hw_clip_distances = builtin( builder.getClipDistance() );\n\n\t\t\tLoop( numUnionPlanes, ( { i } ) => {\n\n\t\t\t\tconst plane = clippingPlanes.element( i );\n\n\t\t\t\tconst distance = positionView.dot( plane.xyz ).sub( plane.w ).negate();\n\t\t\t\thw_clip_distances.element( i ).assign( distance );\n\n\t\t\t} );\n\n\t\t} )();\n\n\t}\n\n}\n\nClippingNode.ALPHA_TO_COVERAGE = 'alphaToCoverage';\nClippingNode.DEFAULT = 'default';\nClippingNode.HARDWARE = 'hardware';\n\nconst clipping = () => nodeObject( new ClippingNode() );\nconst clippingAlpha = () => nodeObject( new ClippingNode( ClippingNode.ALPHA_TO_COVERAGE ) );\nconst hardwareClipping = () => nodeObject( new ClippingNode( ClippingNode.HARDWARE ) );\n\n/**\n * See: https://casual-effects.com/research/Wyman2017Hashed/index.html\n */\n\nconst ALPHA_HASH_SCALE = 0.05; // Derived from trials only, and may be changed.\n\nconst hash2D = /*@__PURE__*/ Fn( ( [ value ] ) => {\n\n\treturn fract( mul( 1.0e4, sin( mul( 17.0, value.x ).add( mul( 0.1, value.y ) ) ) ).mul( add( 0.1, abs( sin( mul( 13.0, value.y ).add( value.x ) ) ) ) ) );\n\n} );\n\nconst hash3D = /*@__PURE__*/ Fn( ( [ value ] ) => {\n\n\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\n} );\n\nconst getAlphaHashThreshold = /*@__PURE__*/ Fn( ( [ position ] ) => {\n\n\t// Find the discretized derivatives of our coordinates\n\tconst maxDeriv = max$1(\n\t\tlength( dFdx( position.xyz ) ),\n\t\tlength( dFdy( position.xyz ) )\n\t);\n\n\tconst pixScale = float( 1 ).div( float( ALPHA_HASH_SCALE ).mul( maxDeriv ) ).toVar( 'pixScale' );\n\n\t// Find two nearest log-discretized noise scales\n\tconst pixScales = vec2(\n\t\texp2( floor( log2( pixScale ) ) ),\n\t\texp2( ceil( log2( pixScale ) ) )\n\t);\n\n\t// Compute alpha thresholds at our two noise scales\n\tconst alpha = vec2(\n\t\thash3D( floor( pixScales.x.mul( position.xyz ) ) ),\n\t\thash3D( floor( pixScales.y.mul( position.xyz ) ) ),\n\t);\n\n\t// Factor to interpolate lerp with\n\tconst lerpFactor = fract( log2( pixScale ) );\n\n\t// Interpolate alpha threshold from noise at two scales\n\tconst x = add( mul( lerpFactor.oneMinus(), alpha.x ), mul( lerpFactor, alpha.y ) );\n\n\t// Pass into CDF to compute uniformly distrib threshold\n\tconst a = min$1( lerpFactor, lerpFactor.oneMinus() );\n\tconst cases = vec3(\n\t\tx.mul( x ).div( mul( 2.0, a ).mul( sub( 1.0, a ) ) ),\n\t\tx.sub( mul( 0.5, a ) ).div( sub( 1.0, a ) ),\n\t\tsub( 1.0, sub( 1.0, x ).mul( sub( 1.0, x ) ).div( mul( 2.0, a ).mul( sub( 1.0, a ) ) ) ) );\n\n\t// Find our final, uniformly distributed alpha threshold (ατ)\n\tconst threshold = x.lessThan( a.oneMinus() ).select( x.lessThan( a ).select( cases.x, cases.y ), cases.z );\n\n\t// Avoids ατ == 0. Could also do ατ =1-ατ\n\treturn clamp( threshold, 1.0e-6, 1.0 );\n\n} ).setLayout( {\n\tname: 'getAlphaHashThreshold',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'position', type: 'vec3' }\n\t]\n} );\n\nclass NodeMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'NodeMaterial';\n\n\t}\n\n\tget type() {\n\n\t\treturn this.constructor.type;\n\n\t}\n\n\tset type( _value ) { /* */ }\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isNodeMaterial = true;\n\n\t\tthis.forceSinglePass = false;\n\n\t\tthis.fog = true;\n\t\tthis.lights = false;\n\t\tthis.hardwareClipping = false;\n\n\t\tthis.lightsNode = null;\n\t\tthis.envNode = null;\n\t\tthis.aoNode = null;\n\n\t\tthis.colorNode = null;\n\t\tthis.normalNode = null;\n\t\tthis.opacityNode = null;\n\t\tthis.backdropNode = null;\n\t\tthis.backdropAlphaNode = null;\n\t\tthis.alphaTestNode = null;\n\n\t\tthis.positionNode = null;\n\t\tthis.geometryNode = null;\n\n\t\tthis.depthNode = null;\n\t\tthis.shadowPositionNode = null;\n\t\tthis.receivedShadowNode = null;\n\t\tthis.castShadowNode = null;\n\n\t\tthis.outputNode = null;\n\t\tthis.mrtNode = null;\n\n\t\tthis.fragmentNode = null;\n\t\tthis.vertexNode = null;\n\n\t}\n\n\tcustomProgramCacheKey() {\n\n\t\treturn this.type + getCacheKey$1( this );\n\n\t}\n\n\tbuild( builder ) {\n\n\t\tthis.setup( builder );\n\n\t}\n\n\tsetupObserver( builder ) {\n\n\t\treturn new NodeMaterialObserver( builder );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tbuilder.context.setupNormal = () => this.setupNormal( builder );\n\n\t\tconst renderer = builder.renderer;\n\t\tconst renderTarget = renderer.getRenderTarget();\n\n\t\t// < VERTEX STAGE >\n\n\t\tbuilder.addStack();\n\n\t\tbuilder.stack.outputNode = this.vertexNode || this.setupPosition( builder );\n\n\t\tif ( this.geometryNode !== null ) {\n\n\t\t\tbuilder.stack.outputNode = builder.stack.outputNode.bypass( this.geometryNode );\n\n\t\t}\n\n\t\tbuilder.addFlow( 'vertex', builder.removeStack() );\n\n\t\t// < FRAGMENT STAGE >\n\n\t\tbuilder.addStack();\n\n\t\tlet resultNode;\n\n\t\tconst clippingNode = this.setupClipping( builder );\n\n\t\tif ( this.depthWrite === true ) {\n\n\t\t\t// only write depth if depth buffer is configured\n\n\t\t\tif ( renderTarget !== null ) {\n\n\t\t\t\tif ( renderTarget.depthBuffer === true ) this.setupDepth( builder );\n\n\t\t\t} else {\n\n\t\t\t\tif ( renderer.depth === true ) this.setupDepth( builder );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.fragmentNode === null ) {\n\n\t\t\tthis.setupDiffuseColor( builder );\n\t\t\tthis.setupVariants( builder );\n\n\t\t\tconst outgoingLightNode = this.setupLighting( builder );\n\n\t\t\tif ( clippingNode !== null ) builder.stack.add( clippingNode );\n\n\t\t\t// force unsigned floats - useful for RenderTargets\n\n\t\t\tconst basicOutput = vec4( outgoingLightNode, diffuseColor.a ).max( 0 );\n\n\t\t\tresultNode = this.setupOutput( builder, basicOutput );\n\n\t\t\t// OUTPUT NODE\n\n\t\t\toutput.assign( resultNode );\n\n\t\t\t//\n\n\t\t\tif ( this.outputNode !== null ) resultNode = this.outputNode;\n\n\t\t\t// MRT\n\n\t\t\tif ( renderTarget !== null ) {\n\n\t\t\t\tconst mrt = renderer.getMRT();\n\t\t\t\tconst materialMRT = this.mrtNode;\n\n\t\t\t\tif ( mrt !== null ) {\n\n\t\t\t\t\tresultNode = mrt;\n\n\t\t\t\t\tif ( materialMRT !== null ) {\n\n\t\t\t\t\t\tresultNode = mrt.merge( materialMRT );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( materialMRT !== null ) {\n\n\t\t\t\t\tresultNode = materialMRT;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tlet fragmentNode = this.fragmentNode;\n\n\t\t\tif ( fragmentNode.isOutputStructNode !== true ) {\n\n\t\t\t\tfragmentNode = vec4( fragmentNode );\n\n\t\t\t}\n\n\t\t\tresultNode = this.setupOutput( builder, fragmentNode );\n\n\t\t}\n\n\t\tbuilder.stack.outputNode = resultNode;\n\n\t\tbuilder.addFlow( 'fragment', builder.removeStack() );\n\n\t\t// < MONITOR >\n\n\t\tbuilder.monitor = this.setupObserver( builder );\n\n\t}\n\n\tsetupClipping( builder ) {\n\n\t\tif ( builder.clippingContext === null ) return null;\n\n\t\tconst { unionPlanes, intersectionPlanes } = builder.clippingContext;\n\n\t\tlet result = null;\n\n\t\tif ( unionPlanes.length > 0 || intersectionPlanes.length > 0 ) {\n\n\t\t\tconst samples = builder.renderer.samples;\n\n\t\t\tif ( this.alphaToCoverage && samples > 1 ) {\n\n\t\t\t\t// to be added to flow when the color/alpha value has been determined\n\t\t\t\tresult = clippingAlpha();\n\n\t\t\t} else {\n\n\t\t\t\tbuilder.stack.add( clipping() );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tsetupHardwareClipping( builder ) {\n\n\t\tthis.hardwareClipping = false;\n\n\t\tif ( builder.clippingContext === null ) return;\n\n\t\tconst candidateCount = builder.clippingContext.unionPlanes.length;\n\n\t\t// 8 planes supported by WebGL ANGLE_clip_cull_distance and WebGPU clip-distances\n\n\t\tif ( candidateCount > 0 && candidateCount <= 8 && builder.isAvailable( 'clipDistance' ) ) {\n\n\t\t\tbuilder.stack.add( hardwareClipping() );\n\n\t\t\tthis.hardwareClipping = true;\n\n\t\t}\n\n\t\treturn;\n\n\t}\n\n\tsetupDepth( builder ) {\n\n\t\tconst { renderer, camera } = builder;\n\n\t\t// Depth\n\n\t\tlet depthNode = this.depthNode;\n\n\t\tif ( depthNode === null ) {\n\n\t\t\tconst mrt = renderer.getMRT();\n\n\t\t\tif ( mrt && mrt.has( 'depth' ) ) {\n\n\t\t\t\tdepthNode = mrt.get( 'depth' );\n\n\t\t\t} else if ( renderer.logarithmicDepthBuffer === true ) {\n\n\t\t\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\t\t\tdepthNode = viewZToLogarithmicDepth( positionView.z, cameraNear, cameraFar );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdepthNode = viewZToOrthographicDepth( positionView.z, cameraNear, cameraFar );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( depthNode !== null ) {\n\n\t\t\tdepth.assign( depthNode ).append();\n\n\t\t}\n\n\t}\n\n\tsetupPosition( builder ) {\n\n\t\tconst { object } = builder;\n\t\tconst geometry = object.geometry;\n\n\t\tbuilder.addStack();\n\n\t\t// Vertex\n\n\t\tif ( geometry.morphAttributes.position || geometry.morphAttributes.normal || geometry.morphAttributes.color ) {\n\n\t\t\tmorphReference( object ).append();\n\n\t\t}\n\n\t\tif ( object.isSkinnedMesh === true ) {\n\n\t\t\tskinningReference( object ).append();\n\n\t\t}\n\n\t\tif ( this.displacementMap ) {\n\n\t\t\tconst displacementMap = materialReference( 'displacementMap', 'texture' );\n\t\t\tconst displacementScale = materialReference( 'displacementScale', 'float' );\n\t\t\tconst displacementBias = materialReference( 'displacementBias', 'float' );\n\n\t\t\tpositionLocal.addAssign( normalLocal.normalize().mul( ( displacementMap.x.mul( displacementScale ).add( displacementBias ) ) ) );\n\n\t\t}\n\n\t\tif ( object.isBatchedMesh ) {\n\n\t\t\tbatch( object ).append();\n\n\t\t}\n\n\t\tif ( ( object.isInstancedMesh && object.instanceMatrix && object.instanceMatrix.isInstancedBufferAttribute === true ) ) {\n\n\t\t\tinstancedMesh( object ).append();\n\n\t\t}\n\n\t\tif ( this.positionNode !== null ) {\n\n\t\t\tpositionLocal.assign( this.positionNode );\n\n\t\t}\n\n\t\tthis.setupHardwareClipping( builder );\n\n\t\tconst mvp = modelViewProjection();\n\n\t\tbuilder.context.vertex = builder.removeStack();\n\t\tbuilder.context.mvp = mvp;\n\n\t\treturn mvp;\n\n\t}\n\n\tsetupDiffuseColor( { object, geometry } ) {\n\n\t\tlet colorNode = this.colorNode ? vec4( this.colorNode ) : materialColor;\n\n\t\t// VERTEX COLORS\n\n\t\tif ( this.vertexColors === true && geometry.hasAttribute( 'color' ) ) {\n\n\t\t\tcolorNode = vec4( colorNode.xyz.mul( attribute( 'color', 'vec3' ) ), colorNode.a );\n\n\t\t}\n\n\t\t// Instanced colors\n\n\t\tif ( object.instanceColor ) {\n\n\t\t\tconst instanceColor = varyingProperty( 'vec3', 'vInstanceColor' );\n\n\t\t\tcolorNode = instanceColor.mul( colorNode );\n\n\t\t}\n\n\t\tif ( object.isBatchedMesh && object._colorsTexture ) {\n\n\t\t\tconst batchColor = varyingProperty( 'vec3', 'vBatchColor' );\n\n\t\t\tcolorNode = batchColor.mul( colorNode );\n\n\t\t}\n\n\n\t\t// COLOR\n\n\t\tdiffuseColor.assign( colorNode );\n\n\t\t// OPACITY\n\n\t\tconst opacityNode = this.opacityNode ? float( this.opacityNode ) : materialOpacity;\n\t\tdiffuseColor.a.assign( diffuseColor.a.mul( opacityNode ) );\n\n\t\t// ALPHA TEST\n\n\t\tif ( this.alphaTestNode !== null || this.alphaTest > 0 ) {\n\n\t\t\tconst alphaTestNode = this.alphaTestNode !== null ? float( this.alphaTestNode ) : materialAlphaTest;\n\n\t\t\tdiffuseColor.a.lessThanEqual( alphaTestNode ).discard();\n\n\t\t}\n\n\t\t// ALPHA HASH\n\n\t\tif ( this.alphaHash === true ) {\n\n\t\t\tdiffuseColor.a.lessThan( getAlphaHashThreshold( positionLocal ) ).discard();\n\n\t\t}\n\n\t\tif ( this.transparent === false && this.blending === NormalBlending && this.alphaToCoverage === false ) {\n\n\t\t\tdiffuseColor.a.assign( 1.0 );\n\n\t\t}\n\n\t}\n\n\tsetupVariants( /*builder*/ ) {\n\n\t\t// Interface function.\n\n\t}\n\n\tsetupOutgoingLight() {\n\n\t\treturn ( this.lights === true ) ? vec3( 0 ) : diffuseColor.rgb;\n\n\t}\n\n\tsetupNormal() {\n\n\t\treturn this.normalNode ? vec3( this.normalNode ) : materialNormal;\n\n\t}\n\n\tsetupEnvironment( /*builder*/ ) {\n\n\t\tlet node = null;\n\n\t\tif ( this.envNode ) {\n\n\t\t\tnode = this.envNode;\n\n\t\t} else if ( this.envMap ) {\n\n\t\t\tnode = this.envMap.isCubeTexture ? materialReference( 'envMap', 'cubeTexture' ) : materialReference( 'envMap', 'texture' );\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n\tsetupLightMap( builder ) {\n\n\t\tlet node = null;\n\n\t\tif ( builder.material.lightMap ) {\n\n\t\t\tnode = new IrradianceNode( materialLightMap );\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n\tsetupLights( builder ) {\n\n\t\tconst materialLightsNode = [];\n\n\t\t//\n\n\t\tconst envNode = this.setupEnvironment( builder );\n\n\t\tif ( envNode && envNode.isLightingNode ) {\n\n\t\t\tmaterialLightsNode.push( envNode );\n\n\t\t}\n\n\t\tconst lightMapNode = this.setupLightMap( builder );\n\n\t\tif ( lightMapNode && lightMapNode.isLightingNode ) {\n\n\t\t\tmaterialLightsNode.push( lightMapNode );\n\n\t\t}\n\n\t\tif ( this.aoNode !== null || builder.material.aoMap ) {\n\n\t\t\tconst aoNode = this.aoNode !== null ? this.aoNode : materialAOMap;\n\n\t\t\tmaterialLightsNode.push( new AONode( aoNode ) );\n\n\t\t}\n\n\t\tlet lightsN = this.lightsNode || builder.lightsNode;\n\n\t\tif ( materialLightsNode.length > 0 ) {\n\n\t\t\tlightsN = builder.renderer.lighting.createNode( [ ...lightsN.getLights(), ...materialLightsNode ] );\n\n\t\t}\n\n\t\treturn lightsN;\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\t// Interface function.\n\n\t}\n\n\tsetupLighting( builder ) {\n\n\t\tconst { material } = builder;\n\t\tconst { backdropNode, backdropAlphaNode, emissiveNode } = this;\n\n\t\t// OUTGOING LIGHT\n\n\t\tconst lights = this.lights === true || this.lightsNode !== null;\n\n\t\tconst lightsNode = lights ? this.setupLights( builder ) : null;\n\n\t\tlet outgoingLightNode = this.setupOutgoingLight( builder );\n\n\t\tif ( lightsNode && lightsNode.getScope().hasLights ) {\n\n\t\t\tconst lightingModel = this.setupLightingModel( builder );\n\n\t\t\toutgoingLightNode = lightingContext( lightsNode, lightingModel, backdropNode, backdropAlphaNode );\n\n\t\t} else if ( backdropNode !== null ) {\n\n\t\t\toutgoingLightNode = vec3( backdropAlphaNode !== null ? mix( outgoingLightNode, backdropNode, backdropAlphaNode ) : backdropNode );\n\n\t\t}\n\n\t\t// EMISSIVE\n\n\t\tif ( ( emissiveNode && emissiveNode.isNode === true ) || ( material.emissive && material.emissive.isColor === true ) ) {\n\n\t\t\temissive.assign( vec3( emissiveNode ? emissiveNode : materialEmissive ) );\n\n\t\t\toutgoingLightNode = outgoingLightNode.add( emissive );\n\n\t\t}\n\n\t\treturn outgoingLightNode;\n\n\t}\n\n\tsetupOutput( builder, outputNode ) {\n\n\t\t// FOG\n\n\t\tif ( this.fog === true ) {\n\n\t\t\tconst fogNode = builder.fogNode;\n\n\t\t\tif ( fogNode ) outputNode = vec4( fogNode.mix( outputNode.rgb, fogNode.colorNode ), outputNode.a );\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n\tsetDefaultValues( material ) {\n\n\t\t// This approach is to reuse the native refreshUniforms*\n\t\t// and turn available the use of features like transmission and environment in core\n\n\t\tfor ( const property in material ) {\n\n\t\t\tconst value = material[ property ];\n\n\t\t\tif ( this[ property ] === undefined ) {\n\n\t\t\t\tthis[ property ] = value;\n\n\t\t\t\tif ( value && value.clone ) this[ property ] = value.clone();\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst descriptors = Object.getOwnPropertyDescriptors( material.constructor.prototype );\n\n\t\tfor ( const key in descriptors ) {\n\n\t\t\tif ( Object.getOwnPropertyDescriptor( this.constructor.prototype, key ) === undefined &&\n\t\t\t     descriptors[ key ].get !== undefined ) {\n\n\t\t\t\tObject.defineProperty( this.constructor.prototype, key, descriptors[ key ] );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRoot = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( isRoot ) {\n\n\t\t\tmeta = {\n\t\t\t\ttextures: {},\n\t\t\t\timages: {},\n\t\t\t\tnodes: {}\n\t\t\t};\n\n\t\t}\n\n\t\tconst data = Material.prototype.toJSON.call( this, meta );\n\t\tconst nodeChildren = getNodeChildren( this );\n\n\t\tdata.inputNodes = {};\n\n\t\tfor ( const { property, childNode } of nodeChildren ) {\n\n\t\t\tdata.inputNodes[ property ] = childNode.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\t// TODO: Copied from Object3D.toJSON\n\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t\tif ( isRoot ) {\n\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\t\t\tconst nodes = extractFromCache( meta.nodes );\n\n\t\t\tif ( textures.length > 0 ) data.textures = textures;\n\t\t\tif ( images.length > 0 ) data.images = images;\n\t\t\tif ( nodes.length > 0 ) data.nodes = nodes;\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.lightsNode = source.lightsNode;\n\t\tthis.envNode = source.envNode;\n\n\t\tthis.colorNode = source.colorNode;\n\t\tthis.normalNode = source.normalNode;\n\t\tthis.opacityNode = source.opacityNode;\n\t\tthis.backdropNode = source.backdropNode;\n\t\tthis.backdropAlphaNode = source.backdropAlphaNode;\n\t\tthis.alphaTestNode = source.alphaTestNode;\n\n\t\tthis.positionNode = source.positionNode;\n\t\tthis.geometryNode = source.geometryNode;\n\n\t\tthis.depthNode = source.depthNode;\n\t\tthis.shadowPositionNode = source.shadowPositionNode;\n\t\tthis.receivedShadowNode = source.receivedShadowNode;\n\t\tthis.castShadowNode = source.castShadowNode;\n\n\t\tthis.outputNode = source.outputNode;\n\t\tthis.mrtNode = source.mrtNode;\n\n\t\tthis.fragmentNode = source.fragmentNode;\n\t\tthis.vertexNode = source.vertexNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nconst _defaultValues$e = /*@__PURE__*/ new PointsMaterial();\n\nclass InstancedPointsNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'InstancedPointsNodeMaterial';\n\n\t}\n\n\tconstructor( params = {} ) {\n\n\t\tsuper();\n\n\t\tthis.lights = false;\n\n\t\tthis.useAlphaToCoverage = true;\n\n\t\tthis.useColor = params.vertexColors;\n\n\t\tthis.pointWidth = 1;\n\n\t\tthis.pointColorNode = null;\n\n\t\tthis.pointWidthNode = null;\n\n\t\tthis.setDefaultValues( _defaultValues$e );\n\n\t\tthis.setValues( params );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.setupShaders( builder );\n\n\t\tsuper.setup( builder );\n\n\t}\n\n\tsetupShaders( { renderer } ) {\n\n\t\tconst useAlphaToCoverage = this.alphaToCoverage;\n\t\tconst useColor = this.useColor;\n\n\t\tthis.vertexNode = Fn( () => {\n\n\t\t\tconst instancePosition = attribute( 'instancePosition' ).xyz;\n\n\t\t\t// camera space\n\t\t\tconst mvPos = vec4( modelViewMatrix.mul( vec4( instancePosition, 1.0 ) ) );\n\n\t\t\tconst aspect = viewport.z.div( viewport.w );\n\n\t\t\t// clip space\n\t\t\tconst clipPos = cameraProjectionMatrix.mul( mvPos );\n\n\t\t\t// offset in ndc space\n\t\t\tconst offset = positionGeometry.xy.toVar();\n\n\t\t\toffset.mulAssign( this.pointWidthNode ? this.pointWidthNode : materialPointWidth );\n\n\t\t\toffset.assign( offset.div( viewport.z ) );\n\t\t\toffset.y.assign( offset.y.mul( aspect ) );\n\n\t\t\t// back to clip space\n\t\t\toffset.assign( offset.mul( clipPos.w ) );\n\n\t\t\t//clipPos.xy += offset;\n\t\t\tclipPos.addAssign( vec4( offset, 0, 0 ) );\n\n\t\t\treturn clipPos;\n\n\t\t} )();\n\n\t\tthis.fragmentNode = Fn( () => {\n\n\t\t\tconst alpha = float( 1 ).toVar();\n\n\t\t\tconst len2 = lengthSq( uv().mul( 2 ).sub( 1 ) );\n\n\t\t\tif ( useAlphaToCoverage && renderer.samples > 1 ) {\n\n\t\t\t\tconst dlen = float( len2.fwidth() ).toVar();\n\n\t\t\t\talpha.assign( smoothstep( dlen.oneMinus(), dlen.add( 1 ), len2 ).oneMinus() );\n\n\t\t\t} else {\n\n\t\t\t\tlen2.greaterThan( 1.0 ).discard();\n\n\t\t\t}\n\n\t\t\tlet pointColorNode;\n\n\t\t\tif ( this.pointColorNode ) {\n\n\t\t\t\tpointColorNode = this.pointColorNode;\n\n\t\t\t} else {\n\n\t\t\t\tif ( useColor ) {\n\n\t\t\t\t\tconst instanceColor = attribute( 'instanceColor' );\n\n\t\t\t\t\tpointColorNode = instanceColor.mul( materialColor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tpointColorNode = materialColor;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\talpha.mulAssign( materialOpacity );\n\n\t\t\treturn vec4( pointColorNode, alpha );\n\n\t\t} )();\n\n\t}\n\n\tget alphaToCoverage() {\n\n\t\treturn this.useAlphaToCoverage;\n\n\t}\n\n\tset alphaToCoverage( value ) {\n\n\t\tif ( this.useAlphaToCoverage !== value ) {\n\n\t\t\tthis.useAlphaToCoverage = value;\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n}\n\nconst _defaultValues$d = /*@__PURE__*/ new LineBasicMaterial();\n\nclass LineBasicNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'LineBasicNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isLineBasicNodeMaterial = true;\n\n\t\tthis.lights = false;\n\n\t\tthis.setDefaultValues( _defaultValues$d );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n}\n\nconst _defaultValues$c = /*@__PURE__*/ new LineDashedMaterial();\n\nclass LineDashedNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'LineDashedNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isLineDashedNodeMaterial = true;\n\n\t\tthis.lights = false;\n\n\t\tthis.setDefaultValues( _defaultValues$c );\n\n\t\tthis.dashOffset = 0;\n\n\t\tthis.offsetNode = null;\n\t\tthis.dashScaleNode = null;\n\t\tthis.dashSizeNode = null;\n\t\tthis.gapSizeNode = null;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupVariants() {\n\n\t\tconst offsetNode = this.offsetNode ? float( this.offsetNodeNode ) : materialLineDashOffset;\n\t\tconst dashScaleNode = this.dashScaleNode ? float( this.dashScaleNode ) : materialLineScale;\n\t\tconst dashSizeNode = this.dashSizeNode ? float( this.dashSizeNode ) : materialLineDashSize;\n\t\tconst gapSizeNode = this.dashSizeNode ? float( this.dashGapNode ) : materialLineGapSize;\n\n\t\tdashSize.assign( dashSizeNode );\n\t\tgapSize.assign( gapSizeNode );\n\n\t\tconst vLineDistance = varying( attribute( 'lineDistance' ).mul( dashScaleNode ) );\n\t\tconst vLineDistanceOffset = offsetNode ? vLineDistance.add( offsetNode ) : vLineDistance;\n\n\t\tvLineDistanceOffset.mod( dashSize.add( gapSize ) ).greaterThan( dashSize ).discard();\n\n\t}\n\n}\n\nlet _sharedFramebuffer = null;\n\nclass ViewportSharedTextureNode extends ViewportTextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'ViewportSharedTextureNode';\n\n\t}\n\n\tconstructor( uvNode = screenUV, levelNode = null ) {\n\n\t\tif ( _sharedFramebuffer === null ) {\n\n\t\t\t_sharedFramebuffer = new FramebufferTexture();\n\n\t\t}\n\n\t\tsuper( uvNode, levelNode, _sharedFramebuffer );\n\n\t}\n\n\tupdateReference() {\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst viewportSharedTexture = /*@__PURE__*/ nodeProxy( ViewportSharedTextureNode );\n\nconst _defaultValues$b = /*@__PURE__*/ new LineDashedMaterial();\n\nclass Line2NodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'Line2NodeMaterial';\n\n\t}\n\n\tconstructor( params = {} ) {\n\n\t\tsuper();\n\n\t\tthis.lights = false;\n\n\t\tthis.setDefaultValues( _defaultValues$b );\n\n\t\tthis.useAlphaToCoverage = true;\n\t\tthis.useColor = params.vertexColors;\n\t\tthis.useDash = params.dashed;\n\t\tthis.useWorldUnits = false;\n\n\t\tthis.dashOffset = 0;\n\t\tthis.lineWidth = 1;\n\n\t\tthis.lineColorNode = null;\n\n\t\tthis.offsetNode = null;\n\t\tthis.dashScaleNode = null;\n\t\tthis.dashSizeNode = null;\n\t\tthis.gapSizeNode = null;\n\n\t\tthis.blending = NoBlending;\n\n\t\tthis.setValues( params );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.setupShaders( builder );\n\n\t\tsuper.setup( builder );\n\n\t}\n\n\tsetupShaders( { renderer } ) {\n\n\t\tconst useAlphaToCoverage = this.alphaToCoverage;\n\t\tconst useColor = this.useColor;\n\t\tconst useDash = this.dashed;\n\t\tconst useWorldUnits = this.worldUnits;\n\n\t\tconst trimSegment = Fn( ( { start, end } ) => {\n\n\t\t\tconst a = cameraProjectionMatrix.element( 2 ).element( 2 ); // 3nd entry in 3th column\n\t\t\tconst b = cameraProjectionMatrix.element( 3 ).element( 2 ); // 3nd entry in 4th column\n\t\t\tconst nearEstimate = b.mul( - 0.5 ).div( a );\n\n\t\t\tconst alpha = nearEstimate.sub( start.z ).div( end.z.sub( start.z ) );\n\n\t\t\treturn vec4( mix( start.xyz, end.xyz, alpha ), end.w );\n\n\t\t} ).setLayout( {\n\t\t\tname: 'trimSegment',\n\t\t\ttype: 'vec4',\n\t\t\tinputs: [\n\t\t\t\t{ name: 'start', type: 'vec4' },\n\t\t\t\t{ name: 'end', type: 'vec4' }\n\t\t\t]\n\t\t} );\n\n\t\tthis.vertexNode = Fn( () => {\n\n\t\t\tconst instanceStart = attribute( 'instanceStart' );\n\t\t\tconst instanceEnd = attribute( 'instanceEnd' );\n\n\t\t\t// camera space\n\n\t\t\tconst start = vec4( modelViewMatrix.mul( vec4( instanceStart, 1.0 ) ) ).toVar( 'start' );\n\t\t\tconst end = vec4( modelViewMatrix.mul( vec4( instanceEnd, 1.0 ) ) ).toVar( 'end' );\n\n\t\t\tif ( useDash ) {\n\n\t\t\t\tconst dashScaleNode = this.dashScaleNode ? float( this.dashScaleNode ) : materialLineScale;\n\t\t\t\tconst offsetNode = this.offsetNode ? float( this.offsetNodeNode ) : materialLineDashOffset;\n\n\t\t\t\tconst instanceDistanceStart = attribute( 'instanceDistanceStart' );\n\t\t\t\tconst instanceDistanceEnd = attribute( 'instanceDistanceEnd' );\n\n\t\t\t\tlet lineDistance = positionGeometry.y.lessThan( 0.5 ).select( dashScaleNode.mul( instanceDistanceStart ), dashScaleNode.mul( instanceDistanceEnd ) );\n\t\t\t\tlineDistance = lineDistance.add( offsetNode );\n\n\t\t\t\tvaryingProperty( 'float', 'lineDistance' ).assign( lineDistance );\n\n\t\t\t}\n\n\t\t\tif ( useWorldUnits ) {\n\n\t\t\t\tvaryingProperty( 'vec3', 'worldStart' ).assign( start.xyz );\n\t\t\t\tvaryingProperty( 'vec3', 'worldEnd' ).assign( end.xyz );\n\n\t\t\t}\n\n\t\t\tconst aspect = viewport.z.div( viewport.w );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tconst perspective = cameraProjectionMatrix.element( 2 ).element( 3 ).equal( - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tIf( perspective, () => {\n\n\t\t\t\tIf( start.z.lessThan( 0.0 ).and( end.z.greaterThan( 0.0 ) ), () => {\n\n\t\t\t\t\tend.assign( trimSegment( { start: start, end: end } ) );\n\n\t\t\t\t} ).ElseIf( end.z.lessThan( 0.0 ).and( start.z.greaterThanEqual( 0.0 ) ), () => {\n\n\t\t\t\t\tstart.assign( trimSegment( { start: end, end: start } ) );\n\n\t\t\t \t} );\n\n\t\t\t} );\n\n\t\t\t// clip space\n\t\t\tconst clipStart = cameraProjectionMatrix.mul( start );\n\t\t\tconst clipEnd = cameraProjectionMatrix.mul( end );\n\n\t\t\t// ndc space\n\t\t\tconst ndcStart = clipStart.xyz.div( clipStart.w );\n\t\t\tconst ndcEnd = clipEnd.xyz.div( clipEnd.w );\n\n\t\t\t// direction\n\t\t\tconst dir = ndcEnd.xy.sub( ndcStart.xy ).toVar();\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x.assign( dir.x.mul( aspect ) );\n\t\t\tdir.assign( dir.normalize() );\n\n\t\t\tconst clip = vec4().toVar();\n\n\t\t\tif ( useWorldUnits ) {\n\n\t\t\t\t// get the offset direction as perpendicular to the view vector\n\n\t\t\t\tconst worldDir = end.xyz.sub( start.xyz ).normalize();\n\t\t\t\tconst tmpFwd = mix( start.xyz, end.xyz, 0.5 ).normalize();\n\t\t\t\tconst worldUp = worldDir.cross( tmpFwd ).normalize();\n\t\t\t\tconst worldFwd = worldDir.cross( worldUp );\n\n\t\t\t\tconst worldPos = varyingProperty( 'vec4', 'worldPos' );\n\n\t\t\t\tworldPos.assign( positionGeometry.y.lessThan( 0.5 ).select( start, end ) );\n\n\t\t\t\t// height offset\n\t\t\t\tconst hw = materialLineWidth.mul( 0.5 );\n\t\t\t\tworldPos.addAssign( vec4( positionGeometry.x.lessThan( 0.0 ).select( worldUp.mul( hw ), worldUp.mul( hw ).negate() ), 0 ) );\n\n\t\t\t\t// don't extend the line if we're rendering dashes because we\n\t\t\t\t// won't be rendering the endcaps\n\t\t\t\tif ( ! useDash ) {\n\n\t\t\t\t\t// cap extension\n\t\t\t\t\tworldPos.addAssign( vec4( positionGeometry.y.lessThan( 0.5 ).select( worldDir.mul( hw ).negate(), worldDir.mul( hw ) ), 0 ) );\n\n\t\t\t\t\t// add width to the box\n\t\t\t\t\tworldPos.addAssign( vec4( worldFwd.mul( hw ), 0 ) );\n\n\t\t\t\t\t// endcaps\n\t\t\t\t\tIf( positionGeometry.y.greaterThan( 1.0 ).or( positionGeometry.y.lessThan( 0.0 ) ), () => {\n\n\t\t\t\t\t\tworldPos.subAssign( vec4( worldFwd.mul( 2.0 ).mul( hw ), 0 ) );\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\t// project the worldpos\n\t\t\t\tclip.assign( cameraProjectionMatrix.mul( worldPos ) );\n\n\t\t\t\t// shift the depth of the projected points so the line\n\t\t\t\t// segments overlap neatly\n\t\t\t\tconst clipPose = vec3().toVar();\n\n\t\t\t\tclipPose.assign( positionGeometry.y.lessThan( 0.5 ).select( ndcStart, ndcEnd ) );\n\t\t\t\tclip.z.assign( clipPose.z.mul( clip.w ) );\n\n\t\t\t} else {\n\n\t\t\t\tconst offset = vec2( dir.y, dir.x.negate() ).toVar( 'offset' );\n\n\t\t\t\t// undo aspect ratio adjustment\n\t\t\t\tdir.x.assign( dir.x.div( aspect ) );\n\t\t\t\toffset.x.assign( offset.x.div( aspect ) );\n\n\t\t\t\t// sign flip\n\t\t\t\toffset.assign( positionGeometry.x.lessThan( 0.0 ).select( offset.negate(), offset ) );\n\n\t\t\t\t// endcaps\n\t\t\t\tIf( positionGeometry.y.lessThan( 0.0 ), () => {\n\n\t\t\t\t\toffset.assign( offset.sub( dir ) );\n\n\t\t\t\t} ).ElseIf( positionGeometry.y.greaterThan( 1.0 ), () => {\n\n\t\t\t\t\toffset.assign( offset.add( dir ) );\n\n\t\t\t\t} );\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset.assign( offset.mul( materialLineWidth ) );\n\n\t\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\t\toffset.assign( offset.div( viewport.w ) );\n\n\t\t\t\t// select end\n\t\t\t\tclip.assign( positionGeometry.y.lessThan( 0.5 ).select( clipStart, clipEnd ) );\n\n\t\t\t\t// back to clip space\n\t\t\t\toffset.assign( offset.mul( clip.w ) );\n\n\t\t\t\tclip.assign( clip.add( vec4( offset, 0, 0 ) ) );\n\n\t\t\t}\n\n\t\t\treturn clip;\n\n\t\t} )();\n\n\t\tconst closestLineToLine = Fn( ( { p1, p2, p3, p4 } ) => {\n\n\t\t\tconst p13 = p1.sub( p3 );\n\t\t\tconst p43 = p4.sub( p3 );\n\n\t\t\tconst p21 = p2.sub( p1 );\n\n\t\t\tconst d1343 = p13.dot( p43 );\n\t\t\tconst d4321 = p43.dot( p21 );\n\t\t\tconst d1321 = p13.dot( p21 );\n\t\t\tconst d4343 = p43.dot( p43 );\n\t\t\tconst d2121 = p21.dot( p21 );\n\n\t\t\tconst denom = d2121.mul( d4343 ).sub( d4321.mul( d4321 ) );\n\t\t\tconst numer = d1343.mul( d4321 ).sub( d1321.mul( d4343 ) );\n\n\t\t\tconst mua = numer.div( denom ).clamp();\n\t\t\tconst mub = d1343.add( d4321.mul( mua ) ).div( d4343 ).clamp();\n\n\t\t\treturn vec2( mua, mub );\n\n\t\t} );\n\n\t\tthis.colorNode = Fn( () => {\n\n\t\t\tconst vUv = uv();\n\n\t\t\tif ( useDash ) {\n\n\t\t\t\tconst dashSizeNode = this.dashSizeNode ? float( this.dashSizeNode ) : materialLineDashSize;\n\t\t\t\tconst gapSizeNode = this.dashSizeNode ? float( this.dashGapNode ) : materialLineGapSize;\n\n\t\t\t\tdashSize.assign( dashSizeNode );\n\t\t\t\tgapSize.assign( gapSizeNode );\n\n\t\t\t\tconst vLineDistance = varyingProperty( 'float', 'lineDistance' );\n\n\t\t\t\tvUv.y.lessThan( - 1.0 ).or( vUv.y.greaterThan( 1.0 ) ).discard(); // discard endcaps\n\t\t\t\tvLineDistance.mod( dashSize.add( gapSize ) ).greaterThan( dashSize ).discard(); // todo - FIX\n\n\t\t\t}\n\n\t\t\tconst alpha = float( 1 ).toVar( 'alpha' );\n\n\t\t\tif ( useWorldUnits ) {\n\n\t\t\t\tconst worldStart = varyingProperty( 'vec3', 'worldStart' );\n\t\t\t\tconst worldEnd = varyingProperty( 'vec3', 'worldEnd' );\n\n\t\t\t\t// Find the closest points on the view ray and the line segment\n\t\t\t\tconst rayEnd = varyingProperty( 'vec4', 'worldPos' ).xyz.normalize().mul( 1e5 );\n\t\t\t\tconst lineDir = worldEnd.sub( worldStart );\n\t\t\t\tconst params = closestLineToLine( { p1: worldStart, p2: worldEnd, p3: vec3( 0.0, 0.0, 0.0 ), p4: rayEnd } );\n\n\t\t\t\tconst p1 = worldStart.add( lineDir.mul( params.x ) );\n\t\t\t\tconst p2 = rayEnd.mul( params.y );\n\t\t\t\tconst delta = p1.sub( p2 );\n\t\t\t\tconst len = delta.length();\n\t\t\t\tconst norm = len.div( materialLineWidth );\n\n\t\t\t\tif ( ! useDash ) {\n\n\t\t\t\t\tif ( useAlphaToCoverage && renderer.samples > 1 ) {\n\n\t\t\t\t\t\tconst dnorm = norm.fwidth();\n\t\t\t\t\t\talpha.assign( smoothstep( dnorm.negate().add( 0.5 ), dnorm.add( 0.5 ), norm ).oneMinus() );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tnorm.greaterThan( 0.5 ).discard();\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// round endcaps\n\n\t\t\t\tif ( useAlphaToCoverage && renderer.samples > 1 ) {\n\n\t\t\t\t\tconst a = vUv.x;\n\t\t\t\t\tconst b = vUv.y.greaterThan( 0.0 ).select( vUv.y.sub( 1.0 ), vUv.y.add( 1.0 ) );\n\n\t\t\t\t\tconst len2 = a.mul( a ).add( b.mul( b ) );\n\n\t\t\t\t\tconst dlen = float( len2.fwidth() ).toVar( 'dlen' );\n\n\t\t\t\t\tIf( vUv.y.abs().greaterThan( 1.0 ), () => {\n\n\t\t\t\t\t\talpha.assign( smoothstep( dlen.oneMinus(), dlen.add( 1 ), len2 ).oneMinus() );\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tIf( vUv.y.abs().greaterThan( 1.0 ), () => {\n\n\t\t\t\t\t\tconst a = vUv.x;\n\t\t\t\t\t\tconst b = vUv.y.greaterThan( 0.0 ).select( vUv.y.sub( 1.0 ), vUv.y.add( 1.0 ) );\n\t\t\t\t\t\tconst len2 = a.mul( a ).add( b.mul( b ) );\n\n\t\t\t\t\t\tlen2.greaterThan( 1.0 ).discard();\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlet lineColorNode;\n\n\t\t\tif ( this.lineColorNode ) {\n\n\t\t\t\tlineColorNode = this.lineColorNode;\n\n\t\t\t} else {\n\n\t\t\t\tif ( useColor ) {\n\n\t\t\t\t\tconst instanceColorStart = attribute( 'instanceColorStart' );\n\t\t\t\t\tconst instanceColorEnd = attribute( 'instanceColorEnd' );\n\n\t\t\t\t\tconst instanceColor = positionGeometry.y.lessThan( 0.5 ).select( instanceColorStart, instanceColorEnd );\n\n\t\t\t\t\tlineColorNode = instanceColor.mul( materialColor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tlineColorNode = materialColor;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn vec4( lineColorNode, alpha );\n\n\t\t} )();\n\n\t\tif ( this.transparent ) {\n\n\t\t\tconst opacityNode = this.opacityNode ? float( this.opacityNode ) : materialOpacity;\n\n\t\t\tthis.outputNode = vec4( this.colorNode.rgb.mul( opacityNode ).add( viewportSharedTexture().rgb.mul( opacityNode.oneMinus() ) ), this.colorNode.a );\n\n\t\t}\n\n\t}\n\n\n\tget worldUnits() {\n\n\t\treturn this.useWorldUnits;\n\n\t}\n\n\tset worldUnits( value ) {\n\n\t\tif ( this.useWorldUnits !== value ) {\n\n\t\t\tthis.useWorldUnits = value;\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\n\tget dashed() {\n\n\t\treturn this.useDash;\n\n\t}\n\n\tset dashed( value ) {\n\n\t\tif ( this.useDash !== value ) {\n\n\t\t\tthis.useDash = value;\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\n\tget alphaToCoverage() {\n\n\t\treturn this.useAlphaToCoverage;\n\n\t}\n\n\tset alphaToCoverage( value ) {\n\n\t\tif ( this.useAlphaToCoverage !== value ) {\n\n\t\t\tthis.useAlphaToCoverage = value;\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n}\n\nconst directionToColor = ( node ) => nodeObject( node ).mul( 0.5 ).add( 0.5 );\nconst colorToDirection = ( node ) => nodeObject( node ).mul( 2.0 ).sub( 1 );\n\nconst _defaultValues$a = /*@__PURE__*/ new MeshNormalMaterial();\n\nclass MeshNormalNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshNormalNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.lights = false;\n\n\t\tthis.isMeshNormalNodeMaterial = true;\n\n\t\tthis.setDefaultValues( _defaultValues$a );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupDiffuseColor() {\n\n\t\tconst opacityNode = this.opacityNode ? float( this.opacityNode ) : materialOpacity;\n\n\t\tdiffuseColor.assign( vec4( directionToColor( transformedNormalView ), opacityNode ) );\n\n\t}\n\n}\n\nclass EquirectUVNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'EquirectUVNode';\n\n\t}\n\n\tconstructor( dirNode = positionWorldDirection ) {\n\n\t\tsuper( 'vec2' );\n\n\t\tthis.dirNode = dirNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst dir = this.dirNode;\n\n\t\tconst u = dir.z.atan2( dir.x ).mul( 1 / ( Math.PI * 2 ) ).add( 0.5 );\n\t\tconst v = dir.y.clamp( - 1.0, 1.0 ).asin().mul( 1 / Math.PI ).add( 0.5 );\n\n\t\treturn vec2( u, v );\n\n\t}\n\n}\n\nconst equirectUV = /*@__PURE__*/ nodeProxy( EquirectUVNode );\n\n// @TODO: Consider rename WebGLCubeRenderTarget to just CubeRenderTarget\n\nclass CubeRenderTarget extends WebGLCubeRenderTarget {\n\n\tconstructor( size = 1, options = {} ) {\n\n\t\tsuper( size, options );\n\n\t\tthis.isCubeRenderTarget = true;\n\n\t}\n\n\tfromEquirectangularTexture( renderer, texture$1 ) {\n\n\t\tconst currentMinFilter = texture$1.minFilter;\n\t\tconst currentGenerateMipmaps = texture$1.generateMipmaps;\n\n\t\ttexture$1.generateMipmaps = true;\n\n\t\tthis.texture.type = texture$1.type;\n\t\tthis.texture.colorSpace = texture$1.colorSpace;\n\n\t\tthis.texture.generateMipmaps = texture$1.generateMipmaps;\n\t\tthis.texture.minFilter = texture$1.minFilter;\n\t\tthis.texture.magFilter = texture$1.magFilter;\n\n\t\tconst geometry = new BoxGeometry( 5, 5, 5 );\n\n\t\tconst uvNode = equirectUV( positionWorldDirection );\n\n\t\tconst material = new NodeMaterial();\n\t\tmaterial.colorNode = texture( texture$1, uvNode, 0 );\n\t\tmaterial.side = BackSide;\n\t\tmaterial.blending = NoBlending;\n\n\t\tconst mesh = new Mesh( geometry, material );\n\n\t\tconst scene = new Scene();\n\t\tscene.add( mesh );\n\n\t\t// Avoid blurred poles\n\t\tif ( texture$1.minFilter === LinearMipmapLinearFilter ) texture$1.minFilter = LinearFilter;\n\n\t\tconst camera = new CubeCamera( 1, 10, this );\n\n\t\tconst currentMRT = renderer.getMRT();\n\t\trenderer.setMRT( null );\n\n\t\tcamera.update( renderer, scene );\n\n\t\trenderer.setMRT( currentMRT );\n\n\t\ttexture$1.minFilter = currentMinFilter;\n\t\ttexture$1.currentGenerateMipmaps = currentGenerateMipmaps;\n\n\t\tmesh.geometry.dispose();\n\t\tmesh.material.dispose();\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _cache$1 = new WeakMap();\n\nclass CubeMapNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'CubeMapNode';\n\n\t}\n\n\tconstructor( envNode ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.envNode = envNode;\n\n\t\tthis._cubeTexture = null;\n\t\tthis._cubeTextureNode = cubeTexture();\n\n\t\tconst defaultTexture = new CubeTexture();\n\t\tdefaultTexture.isRenderTargetTexture = true;\n\n\t\tthis._defaultTexture = defaultTexture;\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst { renderer, material } = frame;\n\n\t\tconst envNode = this.envNode;\n\n\t\tif ( envNode.isTextureNode || envNode.isMaterialReferenceNode ) {\n\n\t\t\tconst texture = ( envNode.isTextureNode ) ? envNode.value : material[ envNode.property ];\n\n\t\t\tif ( texture && texture.isTexture ) {\n\n\t\t\t\tconst mapping = texture.mapping;\n\n\t\t\t\tif ( mapping === EquirectangularReflectionMapping || mapping === EquirectangularRefractionMapping ) {\n\n\t\t\t\t\t// check for converted cubemap map\n\n\t\t\t\t\tif ( _cache$1.has( texture ) ) {\n\n\t\t\t\t\t\tconst cubeMap = _cache$1.get( texture );\n\n\t\t\t\t\t\tmapTextureMapping( cubeMap, texture.mapping );\n\t\t\t\t\t\tthis._cubeTexture = cubeMap;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// create cube map from equirectangular map\n\n\t\t\t\t\t\tconst image = texture.image;\n\n\t\t\t\t\t\tif ( isEquirectangularMapReady$1( image ) ) {\n\n\t\t\t\t\t\t\tconst renderTarget = new CubeRenderTarget( image.height );\n\t\t\t\t\t\t\trenderTarget.fromEquirectangularTexture( renderer, texture );\n\n\t\t\t\t\t\t\tmapTextureMapping( renderTarget.texture, texture.mapping );\n\t\t\t\t\t\t\tthis._cubeTexture = renderTarget.texture;\n\n\t\t\t\t\t\t\t_cache$1.set( texture, renderTarget.texture );\n\n\t\t\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// default cube texture as fallback when equirectangular texture is not yet loaded\n\n\t\t\t\t\t\t\tthis._cubeTexture = this._defaultTexture;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\t//\n\n\t\t\t\t\tthis._cubeTextureNode.value = this._cubeTexture;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// envNode already refers to a cube map\n\n\t\t\t\t\tthis._cubeTextureNode = this.envNode;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.updateBefore( builder );\n\n\t\treturn this._cubeTextureNode;\n\n\t}\n\n}\n\nfunction isEquirectangularMapReady$1( image ) {\n\n\tif ( image === null || image === undefined ) return false;\n\n\treturn image.height > 0;\n\n}\n\nfunction onTextureDispose( event ) {\n\n\tconst texture = event.target;\n\n\ttexture.removeEventListener( 'dispose', onTextureDispose );\n\n\tconst renderTarget = _cache$1.get( texture );\n\n\tif ( renderTarget !== undefined ) {\n\n\t\t_cache$1.delete( texture );\n\n\t\trenderTarget.dispose();\n\n\t}\n\n}\n\nfunction mapTextureMapping( texture, mapping ) {\n\n\tif ( mapping === EquirectangularReflectionMapping ) {\n\n\t\ttexture.mapping = CubeReflectionMapping;\n\n\t} else if ( mapping === EquirectangularRefractionMapping ) {\n\n\t\ttexture.mapping = CubeRefractionMapping;\n\n\t}\n\n}\n\nconst cubeMapNode = /*@__PURE__*/ nodeProxy( CubeMapNode );\n\nclass BasicEnvironmentNode extends LightingNode {\n\n\tstatic get type() {\n\n\t\treturn 'BasicEnvironmentNode';\n\n\t}\n\n\tconstructor( envNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.envNode = envNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\t// environment property is used in the finish() method of BasicLightingModel\n\n\t\tbuilder.context.environment = cubeMapNode( this.envNode );\n\n\t}\n\n}\n\nclass BasicLightMapNode extends LightingNode {\n\n\tstatic get type() {\n\n\t\treturn 'BasicLightMapNode';\n\n\t}\n\n\tconstructor( lightMapNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.lightMapNode = lightMapNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\t// irradianceLightMap property is used in the indirectDiffuse() method of BasicLightingModel\n\n\t\tconst RECIPROCAL_PI = float( 1 / Math.PI );\n\n\t\tbuilder.context.irradianceLightMap = this.lightMapNode.mul( RECIPROCAL_PI );\n\n\t}\n\n}\n\nclass LightingModel {\n\n\tstart( /*input, stack, builder*/ ) { }\n\n\tfinish( /*input, stack, builder*/ ) { }\n\n\tdirect( /*input, stack, builder*/ ) { }\n\n\tdirectRectArea( /*input, stack, builder*/ ) {}\n\n\tindirect( /*input, stack, builder*/ ) { }\n\n\tambientOcclusion( /*input, stack, builder*/ ) { }\n\n}\n\nclass BasicLightingModel extends LightingModel {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t}\n\n\tindirect( context, stack, builder ) {\n\n\t\tconst ambientOcclusion = context.ambientOcclusion;\n\t\tconst reflectedLight = context.reflectedLight;\n\t\tconst irradianceLightMap = builder.context.irradianceLightMap;\n\n\t\treflectedLight.indirectDiffuse.assign( vec4( 0.0 ) );\n\n\t\t// accumulation (baked indirect lighting only)\n\n\t\tif ( irradianceLightMap ) {\n\n\t\t\treflectedLight.indirectDiffuse.addAssign( irradianceLightMap );\n\n\t\t} else {\n\n\t\t\treflectedLight.indirectDiffuse.addAssign( vec4( 1.0, 1.0, 1.0, 0.0 ) );\n\n\t\t}\n\n\t\t// modulation\n\n\t\treflectedLight.indirectDiffuse.mulAssign( ambientOcclusion );\n\n\t\treflectedLight.indirectDiffuse.mulAssign( diffuseColor.rgb );\n\n\t}\n\n\tfinish( context, stack, builder ) {\n\n\t\tconst material = builder.material;\n\t\tconst outgoingLight = context.outgoingLight;\n\t\tconst envNode = builder.context.environment;\n\n\t\tif ( envNode ) {\n\n\t\t\tswitch ( material.combine ) {\n\n\t\t\t\tcase MultiplyOperation:\n\t\t\t\t\toutgoingLight.rgb.assign( mix( outgoingLight.rgb, outgoingLight.rgb.mul( envNode.rgb ), materialSpecularStrength.mul( materialReflectivity ) ) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MixOperation:\n\t\t\t\t\toutgoingLight.rgb.assign( mix( outgoingLight.rgb, envNode.rgb, materialSpecularStrength.mul( materialReflectivity ) ) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AddOperation:\n\t\t\t\t\toutgoingLight.rgb.addAssign( envNode.rgb.mul( materialSpecularStrength.mul( materialReflectivity ) ) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.BasicLightingModel: Unsupported .combine value:', material.combine );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nconst _defaultValues$9 = /*@__PURE__*/ new MeshBasicMaterial();\n\nclass MeshBasicNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshBasicNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshBasicNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.setDefaultValues( _defaultValues$9 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupNormal() {\n\n\t\treturn normalView; // see #28839\n\n\t}\n\n\tsetupEnvironment( builder ) {\n\n\t\tconst envNode = super.setupEnvironment( builder );\n\n\t\treturn envNode ? new BasicEnvironmentNode( envNode ) : null;\n\n\t}\n\n\tsetupLightMap( builder ) {\n\n\t\tlet node = null;\n\n\t\tif ( builder.material.lightMap ) {\n\n\t\t\tnode = new BasicLightMapNode( materialLightMap );\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n\tsetupOutgoingLight() {\n\n\t\treturn diffuseColor.rgb;\n\n\t}\n\n\tsetupLightingModel() {\n\n\t\treturn new BasicLightingModel();\n\n\t}\n\n}\n\nconst F_Schlick = /*@__PURE__*/ Fn( ( { f0, f90, dotVH } ) => {\n\n\t// Original approximation by Christophe Schlick '94\n\t// float fresnel = pow( 1.0 - dotVH, 5.0 );\n\n\t// Optimized variant (presented by Epic at SIGGRAPH '13)\n\t// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf\n\tconst fresnel = dotVH.mul( - 5.55473 ).sub( 6.98316 ).mul( dotVH ).exp2();\n\n\treturn f0.mul( fresnel.oneMinus() ).add( f90.mul( fresnel ) );\n\n} ); // validated\n\nconst BRDF_Lambert = /*@__PURE__*/ Fn( ( inputs ) => {\n\n\treturn inputs.diffuseColor.mul( 1 / Math.PI ); // punctual light\n\n} ); // validated\n\nconst G_BlinnPhong_Implicit = () => float( 0.25 );\n\nconst D_BlinnPhong = /*@__PURE__*/ Fn( ( { dotNH } ) => {\n\n\treturn shininess.mul( float( 0.5 ) ).add( 1.0 ).mul( float( 1 / Math.PI ) ).mul( dotNH.pow( shininess ) );\n\n} );\n\nconst BRDF_BlinnPhong = /*@__PURE__*/ Fn( ( { lightDirection } ) => {\n\n\tconst halfDir = lightDirection.add( positionViewDirection ).normalize();\n\n\tconst dotNH = transformedNormalView.dot( halfDir ).clamp();\n\tconst dotVH = positionViewDirection.dot( halfDir ).clamp();\n\n\tconst F = F_Schlick( { f0: specularColor, f90: 1.0, dotVH } );\n\tconst G = G_BlinnPhong_Implicit();\n\tconst D = D_BlinnPhong( { dotNH } );\n\n\treturn F.mul( G ).mul( D );\n\n} );\n\nclass PhongLightingModel extends BasicLightingModel {\n\n\tconstructor( specular = true ) {\n\n\t\tsuper();\n\n\t\tthis.specular = specular;\n\n\t}\n\n\tdirect( { lightDirection, lightColor, reflectedLight } ) {\n\n\t\tconst dotNL = transformedNormalView.dot( lightDirection ).clamp();\n\t\tconst irradiance = dotNL.mul( lightColor );\n\n\t\treflectedLight.directDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor: diffuseColor.rgb } ) ) );\n\n\t\tif ( this.specular === true ) {\n\n\t\t\treflectedLight.directSpecular.addAssign( irradiance.mul( BRDF_BlinnPhong( { lightDirection } ) ).mul( materialSpecularStrength ) );\n\n\t\t}\n\n\t}\n\n\tindirect( { ambientOcclusion, irradiance, reflectedLight } ) {\n\n\t\treflectedLight.indirectDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor } ) ) );\n\n\t\treflectedLight.indirectDiffuse.mulAssign( ambientOcclusion );\n\n\t}\n\n}\n\nconst _defaultValues$8 = /*@__PURE__*/ new MeshLambertMaterial();\n\nclass MeshLambertNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshLambertNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshLambertNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.setDefaultValues( _defaultValues$8 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupEnvironment( builder ) {\n\n\t\tconst envNode = super.setupEnvironment( builder );\n\n\t\treturn envNode ? new BasicEnvironmentNode( envNode ) : null;\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new PhongLightingModel( false ); // ( specular ) -> force lambert\n\n\t}\n\n}\n\nconst _defaultValues$7 = /*@__PURE__*/ new MeshPhongMaterial();\n\nclass MeshPhongNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshPhongNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshPhongNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.shininessNode = null;\n\t\tthis.specularNode = null;\n\n\t\tthis.setDefaultValues( _defaultValues$7 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupEnvironment( builder ) {\n\n\t\tconst envNode = super.setupEnvironment( builder );\n\n\t\treturn envNode ? new BasicEnvironmentNode( envNode ) : null;\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new PhongLightingModel();\n\n\t}\n\n\tsetupVariants() {\n\n\t\t// SHININESS\n\n\t\tconst shininessNode = ( this.shininessNode ? float( this.shininessNode ) : materialShininess ).max( 1e-4 ); // to prevent pow( 0.0, 0.0 )\n\n\t\tshininess.assign( shininessNode );\n\n\t\t// SPECULAR COLOR\n\n\t\tconst specularNode = this.specularNode || materialSpecular;\n\n\t\tspecularColor.assign( specularNode );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.shininessNode = source.shininessNode;\n\t\tthis.specularNode = source.specularNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nconst getGeometryRoughness = /*@__PURE__*/ Fn( ( builder ) => {\n\n\tif ( builder.geometry.hasAttribute( 'normal' ) === false ) {\n\n\t\treturn float( 0 );\n\n\t}\n\n\tconst dxy = normalView.dFdx().abs().max( normalView.dFdy().abs() );\n\tconst geometryRoughness = dxy.x.max( dxy.y ).max( dxy.z );\n\n\treturn geometryRoughness;\n\n} );\n\nconst getRoughness = /*@__PURE__*/ Fn( ( inputs ) => {\n\n\tconst { roughness } = inputs;\n\n\tconst geometryRoughness = getGeometryRoughness();\n\n\tlet roughnessFactor = roughness.max( 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.\n\troughnessFactor = roughnessFactor.add( geometryRoughness );\n\troughnessFactor = roughnessFactor.min( 1.0 );\n\n\treturn roughnessFactor;\n\n} );\n\n// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2\n// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\nconst V_GGX_SmithCorrelated = /*@__PURE__*/ Fn( ( { alpha, dotNL, dotNV } ) => {\n\n\tconst a2 = alpha.pow2();\n\n\tconst gv = dotNL.mul( a2.add( a2.oneMinus().mul( dotNV.pow2() ) ).sqrt() );\n\tconst gl = dotNV.mul( a2.add( a2.oneMinus().mul( dotNL.pow2() ) ).sqrt() );\n\n\treturn div( 0.5, gv.add( gl ).max( EPSILON ) );\n\n} ).setLayout( {\n\tname: 'V_GGX_SmithCorrelated',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'alpha', type: 'float' },\n\t\t{ name: 'dotNL', type: 'float' },\n\t\t{ name: 'dotNV', type: 'float' }\n\t]\n} ); // validated\n\n// https://google.github.io/filament/Filament.md.html#materialsystem/anisotropicmodel/anisotropicspecularbrdf\n\nconst V_GGX_SmithCorrelated_Anisotropic = /*@__PURE__*/ Fn( ( { alphaT, alphaB, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL } ) => {\n\n\tconst gv = dotNL.mul( vec3( alphaT.mul( dotTV ), alphaB.mul( dotBV ), dotNV ).length() );\n\tconst gl = dotNV.mul( vec3( alphaT.mul( dotTL ), alphaB.mul( dotBL ), dotNL ).length() );\n\tconst v = div( 0.5, gv.add( gl ) );\n\n\treturn v.saturate();\n\n} ).setLayout( {\n\tname: 'V_GGX_SmithCorrelated_Anisotropic',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'alphaT', type: 'float', qualifier: 'in' },\n\t\t{ name: 'alphaB', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotTV', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotBV', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotTL', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotBL', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotNV', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotNL', type: 'float', qualifier: 'in' }\n\t]\n} );\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (33)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is \"roughness squared\" in Disney’s reparameterization\nconst D_GGX = /*@__PURE__*/ Fn( ( { alpha, dotNH } ) => {\n\n\tconst a2 = alpha.pow2();\n\n\tconst denom = dotNH.pow2().mul( a2.oneMinus() ).oneMinus(); // avoid alpha = 0 with dotNH = 1\n\n\treturn a2.div( denom.pow2() ).mul( 1 / Math.PI );\n\n} ).setLayout( {\n\tname: 'D_GGX',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'alpha', type: 'float' },\n\t\t{ name: 'dotNH', type: 'float' }\n\t]\n} ); // validated\n\nconst RECIPROCAL_PI = /*@__PURE__*/ float( 1 / Math.PI );\n\n// https://google.github.io/filament/Filament.md.html#materialsystem/anisotropicmodel/anisotropicspecularbrdf\n\nconst D_GGX_Anisotropic = /*@__PURE__*/ Fn( ( { alphaT, alphaB, dotNH, dotTH, dotBH } ) => {\n\n\tconst a2 = alphaT.mul( alphaB );\n\tconst v = vec3( alphaB.mul( dotTH ), alphaT.mul( dotBH ), a2.mul( dotNH ) );\n\tconst v2 = v.dot( v );\n\tconst w2 = a2.div( v2 );\n\n\treturn RECIPROCAL_PI.mul( a2.mul( w2.pow2() ) );\n\n} ).setLayout( {\n\tname: 'D_GGX_Anisotropic',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'alphaT', type: 'float', qualifier: 'in' },\n\t\t{ name: 'alphaB', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotNH', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotTH', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotBH', type: 'float', qualifier: 'in' }\n\t]\n} );\n\n// GGX Distribution, Schlick Fresnel, GGX_SmithCorrelated Visibility\nconst BRDF_GGX = /*@__PURE__*/ Fn( ( inputs ) => {\n\n\tconst { lightDirection, f0, f90, roughness, f, USE_IRIDESCENCE, USE_ANISOTROPY } = inputs;\n\n\tconst normalView = inputs.normalView || transformedNormalView;\n\n\tconst alpha = roughness.pow2(); // UE4's roughness\n\n\tconst halfDir = lightDirection.add( positionViewDirection ).normalize();\n\n\tconst dotNL = normalView.dot( lightDirection ).clamp();\n\tconst dotNV = normalView.dot( positionViewDirection ).clamp(); // @ TODO: Move to core dotNV\n\tconst dotNH = normalView.dot( halfDir ).clamp();\n\tconst dotVH = positionViewDirection.dot( halfDir ).clamp();\n\n\tlet F = F_Schlick( { f0, f90, dotVH } );\n\tlet V, D;\n\n\tif ( defined( USE_IRIDESCENCE ) ) {\n\n\t\tF = iridescence.mix( F, f );\n\n\t}\n\n\tif ( defined( USE_ANISOTROPY ) ) {\n\n\t\tconst dotTL = anisotropyT.dot( lightDirection );\n\t\tconst dotTV = anisotropyT.dot( positionViewDirection );\n\t\tconst dotTH = anisotropyT.dot( halfDir );\n\t\tconst dotBL = anisotropyB.dot( lightDirection );\n\t\tconst dotBV = anisotropyB.dot( positionViewDirection );\n\t\tconst dotBH = anisotropyB.dot( halfDir );\n\n\t\tV = V_GGX_SmithCorrelated_Anisotropic( { alphaT, alphaB: alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL } );\n\t\tD = D_GGX_Anisotropic( { alphaT, alphaB: alpha, dotNH, dotTH, dotBH } );\n\n\t} else {\n\n\t\tV = V_GGX_SmithCorrelated( { alpha, dotNL, dotNV } );\n\t\tD = D_GGX( { alpha, dotNH } );\n\n\t}\n\n\treturn F.mul( V ).mul( D );\n\n} ); // validated\n\n// Analytical approximation of the DFG LUT, one half of the\n// split-sum approximation used in indirect specular lighting.\n// via 'environmentBRDF' from \"Physically Based Shading on Mobile\"\n// https://www.unrealengine.com/blog/physically-based-shading-on-mobile\nconst DFGApprox = /*@__PURE__*/ Fn( ( { roughness, dotNV } ) => {\n\n\tconst c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\n\tconst c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\n\tconst r = roughness.mul( c0 ).add( c1 );\n\n\tconst a004 = r.x.mul( r.x ).min( dotNV.mul( - 9.28 ).exp2() ).mul( r.x ).add( r.y );\n\n\tconst fab = vec2( - 1.04, 1.04 ).mul( a004 ).add( r.zw );\n\n\treturn fab;\n\n} ).setLayout( {\n\tname: 'DFGApprox',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'roughness', type: 'float' },\n\t\t{ name: 'dotNV', type: 'vec3' }\n\t]\n} );\n\nconst EnvironmentBRDF = /*@__PURE__*/ Fn( ( inputs ) => {\n\n\tconst { dotNV, specularColor, specularF90, roughness } = inputs;\n\n\tconst fab = DFGApprox( { dotNV, roughness } );\n\treturn specularColor.mul( fab.x ).add( specularF90.mul( fab.y ) );\n\n} );\n\nconst Schlick_to_F0 = /*@__PURE__*/ Fn( ( { f, f90, dotVH } ) => {\n\n\tconst x = dotVH.oneMinus().saturate();\n\tconst x2 = x.mul( x );\n\tconst x5 = x.mul( x2, x2 ).clamp( 0, .9999 );\n\n\treturn f.sub( vec3( f90 ).mul( x5 ) ).div( x5.oneMinus() );\n\n} ).setLayout( {\n\tname: 'Schlick_to_F0',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'f', type: 'vec3' },\n\t\t{ name: 'f90', type: 'float' },\n\t\t{ name: 'dotVH', type: 'float' }\n\t]\n} );\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nconst D_Charlie = /*@__PURE__*/ Fn( ( { roughness, dotNH } ) => {\n\n\tconst alpha = roughness.pow2();\n\n\t// Estevez and Kulla 2017, \"Production Friendly Microfacet Sheen BRDF\"\n\tconst invAlpha = float( 1.0 ).div( alpha );\n\tconst cos2h = dotNH.pow2();\n\tconst sin2h = cos2h.oneMinus().max( 0.0078125 ); // 2^(-14/2), so sin2h^2 > 0 in fp16\n\n\treturn float( 2.0 ).add( invAlpha ).mul( sin2h.pow( invAlpha.mul( 0.5 ) ) ).div( 2.0 * Math.PI );\n\n} ).setLayout( {\n\tname: 'D_Charlie',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'roughness', type: 'float' },\n\t\t{ name: 'dotNH', type: 'float' }\n\t]\n} );\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nconst V_Neubelt = /*@__PURE__*/ Fn( ( { dotNV, dotNL } ) => {\n\n\t// Neubelt and Pettineo 2013, \"Crafting a Next-gen Material Pipeline for The Order: 1886\"\n\treturn float( 1.0 ).div( float( 4.0 ).mul( dotNL.add( dotNV ).sub( dotNL.mul( dotNV ) ) ) );\n\n} ).setLayout( {\n\tname: 'V_Neubelt',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'dotNV', type: 'float' },\n\t\t{ name: 'dotNL', type: 'float' }\n\t]\n} );\n\nconst BRDF_Sheen = /*@__PURE__*/ Fn( ( { lightDirection } ) => {\n\n\tconst halfDir = lightDirection.add( positionViewDirection ).normalize();\n\n\tconst dotNL = transformedNormalView.dot( lightDirection ).clamp();\n\tconst dotNV = transformedNormalView.dot( positionViewDirection ).clamp();\n\tconst dotNH = transformedNormalView.dot( halfDir ).clamp();\n\n\tconst D = D_Charlie( { roughness: sheenRoughness, dotNH } );\n\tconst V = V_Neubelt( { dotNV, dotNL } );\n\n\treturn sheen.mul( D ).mul( V );\n\n} );\n\n// Rect Area Light\n\n// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines\n// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt\n// code: https://github.com/selfshadow/ltc_code/\n\nconst LTC_Uv = /*@__PURE__*/ Fn( ( { N, V, roughness } ) => {\n\n\tconst LUT_SIZE = 64.0;\n\tconst LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst LUT_BIAS = 0.5 / LUT_SIZE;\n\n\tconst dotNV = N.dot( V ).saturate();\n\n\t// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )\n\tconst uv = vec2( roughness, dotNV.oneMinus().sqrt() );\n\n\tuv.assign( uv.mul( LUT_SCALE ).add( LUT_BIAS ) );\n\n\treturn uv;\n\n} ).setLayout( {\n\tname: 'LTC_Uv',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'N', type: 'vec3' },\n\t\t{ name: 'V', type: 'vec3' },\n\t\t{ name: 'roughness', type: 'float' }\n\t]\n} );\n\nconst LTC_ClippedSphereFormFactor = /*@__PURE__*/ Fn( ( { f } ) => {\n\n\t// Real-Time Area Lighting: a Journey from Research to Production (p.102)\n\t// An approximation of the form factor of a horizon-clipped rectangle.\n\n\tconst l = f.length();\n\n\treturn max$1( l.mul( l ).add( f.z ).div( l.add( 1.0 ) ), 0 );\n\n} ).setLayout( {\n\tname: 'LTC_ClippedSphereFormFactor',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'f', type: 'vec3' }\n\t]\n} );\n\nconst LTC_EdgeVectorFormFactor = /*@__PURE__*/ Fn( ( { v1, v2 } ) => {\n\n\tconst x = v1.dot( v2 );\n\tconst y = x.abs().toVar();\n\n\t// rational polynomial approximation to theta / sin( theta ) / 2PI\n\tconst a = y.mul( 0.0145206 ).add( 0.4965155 ).mul( y ).add( 0.8543985 ).toVar();\n\tconst b = y.add( 4.1616724 ).mul( y ).add( 3.4175940 ).toVar();\n\tconst v = a.div( b );\n\n\tconst theta_sintheta = x.greaterThan( 0.0 ).select( v, max$1( x.mul( x ).oneMinus(), 1e-7 ).inverseSqrt().mul( 0.5 ).sub( v ) );\n\n\treturn v1.cross( v2 ).mul( theta_sintheta );\n\n} ).setLayout( {\n\tname: 'LTC_EdgeVectorFormFactor',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'v1', type: 'vec3' },\n\t\t{ name: 'v2', type: 'vec3' }\n\t]\n} );\n\nconst LTC_Evaluate = /*@__PURE__*/ Fn( ( { N, V, P, mInv, p0, p1, p2, p3 } ) => {\n\n\t// bail if point is on back side of plane of light\n\t// assumes ccw winding order of light vertices\n\tconst v1 = p1.sub( p0 ).toVar();\n\tconst v2 = p3.sub( p0 ).toVar();\n\n\tconst lightNormal = v1.cross( v2 );\n\tconst result = vec3().toVar();\n\n\tIf( lightNormal.dot( P.sub( p0 ) ).greaterThanEqual( 0.0 ), () => {\n\n\t\t// construct orthonormal basis around N\n\t\tconst T1 = V.sub( N.mul( V.dot( N ) ) ).normalize();\n\t\tconst T2 = N.cross( T1 ).negate(); // negated from paper; possibly due to a different handedness of world coordinate system\n\n\t\t// compute transform\n\t\tconst mat = mInv.mul( mat3( T1, T2, N ).transpose() ).toVar();\n\n\t\t// transform rect\n\t\t// & project rect onto sphere\n\t\tconst coords0 = mat.mul( p0.sub( P ) ).normalize().toVar();\n\t\tconst coords1 = mat.mul( p1.sub( P ) ).normalize().toVar();\n\t\tconst coords2 = mat.mul( p2.sub( P ) ).normalize().toVar();\n\t\tconst coords3 = mat.mul( p3.sub( P ) ).normalize().toVar();\n\n\t\t// calculate vector form factor\n\t\tconst vectorFormFactor = vec3( 0 ).toVar();\n\t\tvectorFormFactor.addAssign( LTC_EdgeVectorFormFactor( { v1: coords0, v2: coords1 } ) );\n\t\tvectorFormFactor.addAssign( LTC_EdgeVectorFormFactor( { v1: coords1, v2: coords2 } ) );\n\t\tvectorFormFactor.addAssign( LTC_EdgeVectorFormFactor( { v1: coords2, v2: coords3 } ) );\n\t\tvectorFormFactor.addAssign( LTC_EdgeVectorFormFactor( { v1: coords3, v2: coords0 } ) );\n\n\t\t// adjust for horizon clipping\n\t\tresult.assign( vec3( LTC_ClippedSphereFormFactor( { f: vectorFormFactor } ) ) );\n\n\t} );\n\n\treturn result;\n\n} ).setLayout( {\n\tname: 'LTC_Evaluate',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'N', type: 'vec3' },\n\t\t{ name: 'V', type: 'vec3' },\n\t\t{ name: 'P', type: 'vec3' },\n\t\t{ name: 'mInv', type: 'mat3' },\n\t\t{ name: 'p0', type: 'vec3' },\n\t\t{ name: 'p1', type: 'vec3' },\n\t\t{ name: 'p2', type: 'vec3' },\n\t\t{ name: 'p3', type: 'vec3' }\n\t]\n} );\n\n// Mipped Bicubic Texture Filtering by N8\n// https://www.shadertoy.com/view/Dl2SDW\n\nconst bC = 1.0 / 6.0;\n\nconst w0 = ( a ) => mul( bC, mul( a, mul( a, a.negate().add( 3.0 ) ).sub( 3.0 ) ).add( 1.0 ) );\n\nconst w1 = ( a ) => mul( bC, mul( a, mul( a, mul( 3.0, a ).sub( 6.0 ) ) ).add( 4.0 ) );\n\nconst w2 = ( a ) => mul( bC, mul( a, mul( a, mul( - 3.0, a ).add( 3.0 ) ).add( 3.0 ) ).add( 1.0 ) );\n\nconst w3 = ( a ) => mul( bC, pow( a, 3 ) );\n\nconst g0 = ( a ) => w0( a ).add( w1( a ) );\n\nconst g1 = ( a ) => w2( a ).add( w3( a ) );\n\n// h0 and h1 are the two offset functions\nconst h0 = ( a ) => add( - 1.0, w1( a ).div( w0( a ).add( w1( a ) ) ) );\n\nconst h1 = ( a ) => add( 1.0, w3( a ).div( w2( a ).add( w3( a ) ) ) );\n\nconst bicubic = ( textureNode, texelSize, lod ) => {\n\n\tconst uv = textureNode.uvNode;\n\tconst uvScaled = mul( uv, texelSize.zw ).add( 0.5 );\n\n\tconst iuv = floor( uvScaled );\n\tconst fuv = fract( uvScaled );\n\n\tconst g0x = g0( fuv.x );\n\tconst g1x = g1( fuv.x );\n\tconst h0x = h0( fuv.x );\n\tconst h1x = h1( fuv.x );\n\tconst h0y = h0( fuv.y );\n\tconst h1y = h1( fuv.y );\n\n\tconst p0 = vec2( iuv.x.add( h0x ), iuv.y.add( h0y ) ).sub( 0.5 ).mul( texelSize.xy );\n\tconst p1 = vec2( iuv.x.add( h1x ), iuv.y.add( h0y ) ).sub( 0.5 ).mul( texelSize.xy );\n\tconst p2 = vec2( iuv.x.add( h0x ), iuv.y.add( h1y ) ).sub( 0.5 ).mul( texelSize.xy );\n\tconst p3 = vec2( iuv.x.add( h1x ), iuv.y.add( h1y ) ).sub( 0.5 ).mul( texelSize.xy );\n\n\tconst a = g0( fuv.y ).mul( add( g0x.mul( textureNode.uv( p0 ).level( lod ) ), g1x.mul( textureNode.uv( p1 ).level( lod ) ) ) );\n\tconst b = g1( fuv.y ).mul( add( g0x.mul( textureNode.uv( p2 ).level( lod ) ), g1x.mul( textureNode.uv( p3 ).level( lod ) ) ) );\n\n\treturn a.add( b );\n\n};\n\nconst textureBicubic = /*@__PURE__*/ Fn( ( [ textureNode, lodNode = float( 3 ) ] ) => {\n\n\tconst fLodSize = vec2( textureNode.size( int( lodNode ) ) );\n\tconst cLodSize = vec2( textureNode.size( int( lodNode.add( 1.0 ) ) ) );\n\tconst fLodSizeInv = div( 1.0, fLodSize );\n\tconst cLodSizeInv = div( 1.0, cLodSize );\n\tconst fSample = bicubic( textureNode, vec4( fLodSizeInv, fLodSize ), floor( lodNode ) );\n\tconst cSample = bicubic( textureNode, vec4( cLodSizeInv, cLodSize ), ceil( lodNode ) );\n\n\treturn fract( lodNode ).mix( fSample, cSample );\n\n} );\n\n//\n// Transmission\n//\n\nconst getVolumeTransmissionRay = /*@__PURE__*/ Fn( ( [ n, v, thickness, ior, modelMatrix ] ) => {\n\n\t// Direction of refracted light.\n\tconst refractionVector = vec3( refract( v.negate(), normalize( n ), div( 1.0, ior ) ) );\n\n\t// Compute rotation-independant scaling of the model matrix.\n\tconst modelScale = vec3(\n\t\tlength( modelMatrix[ 0 ].xyz ),\n\t\tlength( modelMatrix[ 1 ].xyz ),\n\t\tlength( modelMatrix[ 2 ].xyz )\n\t);\n\n\t// The thickness is specified in local space.\n\treturn normalize( refractionVector ).mul( thickness.mul( modelScale ) );\n\n} ).setLayout( {\n\tname: 'getVolumeTransmissionRay',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'n', type: 'vec3' },\n\t\t{ name: 'v', type: 'vec3' },\n\t\t{ name: 'thickness', type: 'float' },\n\t\t{ name: 'ior', type: 'float' },\n\t\t{ name: 'modelMatrix', type: 'mat4' }\n\t]\n} );\n\nconst applyIorToRoughness = /*@__PURE__*/ Fn( ( [ roughness, ior ] ) => {\n\n\t// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and\n\t// an IOR of 1.5 results in the default amount of microfacet refraction.\n\treturn roughness.mul( clamp( ior.mul( 2.0 ).sub( 2.0 ), 0.0, 1.0 ) );\n\n} ).setLayout( {\n\tname: 'applyIorToRoughness',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'roughness', type: 'float' },\n\t\t{ name: 'ior', type: 'float' }\n\t]\n} );\n\nconst viewportBackSideTexture = /*@__PURE__*/ viewportMipTexture();\nconst viewportFrontSideTexture = /*@__PURE__*/ viewportMipTexture();\n\nconst getTransmissionSample = /*@__PURE__*/ Fn( ( [ fragCoord, roughness, ior ], { material } ) => {\n\n\tconst vTexture = material.side == BackSide ? viewportBackSideTexture : viewportFrontSideTexture;\n\n\tconst transmissionSample = vTexture.uv( fragCoord );\n\t//const transmissionSample = viewportMipTexture( fragCoord );\n\n\tconst lod = log2( screenSize.x ).mul( applyIorToRoughness( roughness, ior ) );\n\n\treturn textureBicubic( transmissionSample, lod );\n\n} );\n\nconst volumeAttenuation = /*@__PURE__*/ Fn( ( [ transmissionDistance, attenuationColor, attenuationDistance ] ) => {\n\n\tIf( attenuationDistance.notEqual( 0 ), () => {\n\n\t\t// Compute light attenuation using Beer's law.\n\t\tconst attenuationCoefficient = log( attenuationColor ).negate().div( attenuationDistance );\n\t\tconst transmittance = exp( attenuationCoefficient.negate().mul( transmissionDistance ) );\n\n\t\treturn transmittance;\n\n\t} );\n\n\t// Attenuation distance is +∞, i.e. the transmitted color is not attenuated at all.\n\treturn vec3( 1.0 );\n\n} ).setLayout( {\n\tname: 'volumeAttenuation',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'transmissionDistance', type: 'float' },\n\t\t{ name: 'attenuationColor', type: 'vec3' },\n\t\t{ name: 'attenuationDistance', type: 'float' }\n\t]\n} );\n\nconst getIBLVolumeRefraction = /*@__PURE__*/ Fn( ( [ n, v, roughness, diffuseColor, specularColor, specularF90, position, modelMatrix, viewMatrix, projMatrix, ior, thickness, attenuationColor, attenuationDistance, dispersion ] ) => {\n\n\tlet transmittedLight, transmittance;\n\n\tif ( dispersion ) {\n\n\t\ttransmittedLight = vec4().toVar();\n\t\ttransmittance = vec3().toVar();\n\n\t\tconst halfSpread = ior.sub( 1.0 ).mul( dispersion.mul( 0.025 ) );\n\t\tconst iors = vec3( ior.sub( halfSpread ), ior, ior.add( halfSpread ) );\n\n\t\tLoop( { start: 0, end: 3 }, ( { i } ) => {\n\n\t\t\tconst ior = iors.element( i );\n\n\t\t\tconst transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tconst refractedRayExit = position.add( transmissionRay );\n\n\t\t\t// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n\t\t\tconst ndcPos = projMatrix.mul( viewMatrix.mul( vec4( refractedRayExit, 1.0 ) ) );\n\t\t\tconst refractionCoords = vec2( ndcPos.xy.div( ndcPos.w ) ).toVar();\n\t\t\trefractionCoords.addAssign( 1.0 );\n\t\t\trefractionCoords.divAssign( 2.0 );\n\t\t\trefractionCoords.assign( vec2( refractionCoords.x, refractionCoords.y.oneMinus() ) ); // webgpu\n\n\t\t\t// Sample framebuffer to get pixel the refracted ray hits.\n\t\t\tconst transmissionSample = getTransmissionSample( refractionCoords, roughness, ior );\n\n\t\t\ttransmittedLight.element( i ).assign( transmissionSample.element( i ) );\n\t\t\ttransmittedLight.a.addAssign( transmissionSample.a );\n\n\t\t\ttransmittance.element( i ).assign( diffuseColor.element( i ).mul( volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance ).element( i ) ) );\n\n\t\t} );\n\n\t\ttransmittedLight.a.divAssign( 3.0 );\n\n\t} else {\n\n\t\tconst transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tconst refractedRayExit = position.add( transmissionRay );\n\n\t\t// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n\t\tconst ndcPos = projMatrix.mul( viewMatrix.mul( vec4( refractedRayExit, 1.0 ) ) );\n\t\tconst refractionCoords = vec2( ndcPos.xy.div( ndcPos.w ) ).toVar();\n\t\trefractionCoords.addAssign( 1.0 );\n\t\trefractionCoords.divAssign( 2.0 );\n\t\trefractionCoords.assign( vec2( refractionCoords.x, refractionCoords.y.oneMinus() ) ); // webgpu\n\n\t\t// Sample framebuffer to get pixel the refracted ray hits.\n\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\ttransmittance = diffuseColor.mul( volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance ) );\n\n\t}\n\n\tconst attenuatedColor = transmittance.rgb.mul( transmittedLight.rgb );\n\tconst dotNV = n.dot( v ).clamp();\n\n\t// Get the specular component.\n\tconst F = vec3( EnvironmentBRDF( { // n, v, specularColor, specularF90, roughness\n\t\tdotNV,\n\t\tspecularColor,\n\t\tspecularF90,\n\t\troughness\n\t} ) );\n\n\t// As less light is transmitted, the opacity should be increased. This simple approximation does a decent job\n\t// of modulating a CSS background, and has no effect when the buffer is opaque, due to a solid object or clear color.\n\tconst transmittanceFactor = transmittance.r.add( transmittance.g, transmittance.b ).div( 3.0 );\n\n\treturn vec4( F.oneMinus().mul( attenuatedColor ), transmittedLight.a.oneMinus().mul( transmittanceFactor ).oneMinus() );\n\n} );\n\n//\n// Iridescence\n//\n\n// XYZ to linear-sRGB color space\nconst XYZ_TO_REC709 = /*@__PURE__*/ mat3(\n\t3.2404542, - 0.9692660, 0.0556434,\n\t- 1.5371385, 1.8760108, - 0.2040259,\n\t- 0.4985314, 0.0415560, 1.0572252\n);\n\n// Assume air interface for top\n// Note: We don't handle the case fresnel0 == 1\nconst Fresnel0ToIor = ( fresnel0 ) => {\n\n\tconst sqrtF0 = fresnel0.sqrt();\n\treturn vec3( 1.0 ).add( sqrtF0 ).div( vec3( 1.0 ).sub( sqrtF0 ) );\n\n};\n\n// ior is a value between 1.0 and 3.0. 1.0 is air interface\nconst IorToFresnel0 = ( transmittedIor, incidentIor ) => {\n\n\treturn transmittedIor.sub( incidentIor ).div( transmittedIor.add( incidentIor ) ).pow2();\n\n};\n\n// Fresnel equations for dielectric/dielectric interfaces.\n// Ref: https://belcour.github.io/blog/research/2017/05/01/brdf-thin-film.html\n// Evaluation XYZ sensitivity curves in Fourier space\nconst evalSensitivity = ( OPD, shift ) => {\n\n\tconst phase = OPD.mul( 2.0 * Math.PI * 1.0e-9 );\n\tconst val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\tconst pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\tconst VAR = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\n\tconst x = float( 9.7470e-14 * Math.sqrt( 2.0 * Math.PI * 4.5282e+09 ) ).mul( phase.mul( 2.2399e+06 ).add( shift.x ).cos() ).mul( phase.pow2().mul( - 4.5282e+09 ).exp() );\n\n\tlet xyz = val.mul( VAR.mul( 2.0 * Math.PI ).sqrt() ).mul( pos.mul( phase ).add( shift ).cos() ).mul( phase.pow2().negate().mul( VAR ).exp() );\n\txyz = vec3( xyz.x.add( x ), xyz.y, xyz.z ).div( 1.0685e-7 );\n\n\tconst rgb = XYZ_TO_REC709.mul( xyz );\n\n\treturn rgb;\n\n};\n\nconst evalIridescence = /*@__PURE__*/ Fn( ( { outsideIOR, eta2, cosTheta1, thinFilmThickness, baseF0 } ) => {\n\n\t// Force iridescenceIOR -> outsideIOR when thinFilmThickness -> 0.0\n\tconst iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t// Evaluate the cosTheta on the base layer (Snell law)\n\tconst sinTheta2Sq = outsideIOR.div( iridescenceIOR ).pow2().mul( cosTheta1.pow2().oneMinus() );\n\n\t// Handle TIR:\n\tconst cosTheta2Sq = sinTheta2Sq.oneMinus();\n\n\tIf( cosTheta2Sq.lessThan( 0 ), () => {\n\n\t\treturn vec3( 1.0 );\n\n\t} );\n\n\tconst cosTheta2 = cosTheta2Sq.sqrt();\n\n\t// First interface\n\tconst R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\tconst R12 = F_Schlick( { f0: R0, f90: 1.0, dotVH: cosTheta1 } );\n\t//const R21 = R12;\n\tconst T121 = R12.oneMinus();\n\tconst phi12 = iridescenceIOR.lessThan( outsideIOR ).select( Math.PI, 0.0 );\n\tconst phi21 = float( Math.PI ).sub( phi12 );\n\n\t// Second interface\n\tconst baseIOR = Fresnel0ToIor( baseF0.clamp( 0.0, 0.9999 ) ); // guard against 1.0\n\tconst R1 = IorToFresnel0( baseIOR, iridescenceIOR.toVec3() );\n\tconst R23 = F_Schlick( { f0: R1, f90: 1.0, dotVH: cosTheta2 } );\n\tconst phi23 = vec3(\n\t\tbaseIOR.x.lessThan( iridescenceIOR ).select( Math.PI, 0.0 ),\n\t\tbaseIOR.y.lessThan( iridescenceIOR ).select( Math.PI, 0.0 ),\n\t\tbaseIOR.z.lessThan( iridescenceIOR ).select( Math.PI, 0.0 )\n\t);\n\n\t// Phase shift\n\tconst OPD = iridescenceIOR.mul( thinFilmThickness, cosTheta2, 2.0 );\n\tconst phi = vec3( phi21 ).add( phi23 );\n\n\t// Compound terms\n\tconst R123 = R12.mul( R23 ).clamp( 1e-5, 0.9999 );\n\tconst r123 = R123.sqrt();\n\tconst Rs = T121.pow2().mul( R23 ).div( vec3( 1.0 ).sub( R123 ) );\n\n\t// Reflectance term for m = 0 (DC term amplitude)\n\tconst C0 = R12.add( Rs );\n\tconst I = C0.toVar();\n\n\t// Reflectance term for m > 0 (pairs of diracs)\n\tconst Cm = Rs.sub( T121 ).toVar();\n\n\tLoop( { start: 1, end: 2, condition: '<=', name: 'm' }, ( { m } ) => {\n\n\t\tCm.mulAssign( r123 );\n\t\tconst Sm = evalSensitivity( float( m ).mul( OPD ), float( m ).mul( phi ) ).mul( 2.0 );\n\t\tI.addAssign( Cm.mul( Sm ) );\n\n\t} );\n\n\t// Since out of gamut colors might be produced, negative color values are clamped to 0.\n\treturn I.max( vec3( 0.0 ) );\n\n} ).setLayout( {\n\tname: 'evalIridescence',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'outsideIOR', type: 'float' },\n\t\t{ name: 'eta2', type: 'float' },\n\t\t{ name: 'cosTheta1', type: 'float' },\n\t\t{ name: 'thinFilmThickness', type: 'float' },\n\t\t{ name: 'baseF0', type: 'vec3' }\n\t]\n} );\n\n//\n//\tSheen\n//\n\n// This is a curve-fit approxmation to the \"Charlie sheen\" BRDF integrated over the hemisphere from\n// Estevez and Kulla 2017, \"Production Friendly Microfacet Sheen BRDF\". The analysis can be found\n// in the Sheen section of https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing\nconst IBLSheenBRDF = /*@__PURE__*/ Fn( ( { normal, viewDir, roughness } ) => {\n\n\tconst dotNV = normal.dot( viewDir ).saturate();\n\n\tconst r2 = roughness.pow2();\n\n\tconst a = select(\n\t\troughness.lessThan( 0.25 ),\n\t\tfloat( - 339.2 ).mul( r2 ).add( float( 161.4 ).mul( roughness ) ).sub( 25.9 ),\n\t\tfloat( - 8.48 ).mul( r2 ).add( float( 14.3 ).mul( roughness ) ).sub( 9.95 )\n\t);\n\n\tconst b = select(\n\t\troughness.lessThan( 0.25 ),\n\t\tfloat( 44.0 ).mul( r2 ).sub( float( 23.7 ).mul( roughness ) ).add( 3.26 ),\n\t\tfloat( 1.97 ).mul( r2 ).sub( float( 3.27 ).mul( roughness ) ).add( 0.72 )\n\t);\n\n\tconst DG = select( roughness.lessThan( 0.25 ), 0.0, float( 0.1 ).mul( roughness ).sub( 0.025 ) ).add( a.mul( dotNV ).add( b ).exp() );\n\n\treturn DG.mul( 1.0 / Math.PI ).saturate();\n\n} );\n\nconst clearcoatF0 = vec3( 0.04 );\nconst clearcoatF90 = float( 1 );\n\n//\n\nclass PhysicalLightingModel extends LightingModel {\n\n\tconstructor( clearcoat = false, sheen = false, iridescence = false, anisotropy = false, transmission = false, dispersion = false ) {\n\n\t\tsuper();\n\n\t\tthis.clearcoat = clearcoat;\n\t\tthis.sheen = sheen;\n\t\tthis.iridescence = iridescence;\n\t\tthis.anisotropy = anisotropy;\n\t\tthis.transmission = transmission;\n\t\tthis.dispersion = dispersion;\n\n\t\tthis.clearcoatRadiance = null;\n\t\tthis.clearcoatSpecularDirect = null;\n\t\tthis.clearcoatSpecularIndirect = null;\n\t\tthis.sheenSpecularDirect = null;\n\t\tthis.sheenSpecularIndirect = null;\n\t\tthis.iridescenceFresnel = null;\n\t\tthis.iridescenceF0 = null;\n\n\t}\n\n\tstart( context ) {\n\n\t\tif ( this.clearcoat === true ) {\n\n\t\t\tthis.clearcoatRadiance = vec3().toVar( 'clearcoatRadiance' );\n\t\t\tthis.clearcoatSpecularDirect = vec3().toVar( 'clearcoatSpecularDirect' );\n\t\t\tthis.clearcoatSpecularIndirect = vec3().toVar( 'clearcoatSpecularIndirect' );\n\n\t\t}\n\n\t\tif ( this.sheen === true ) {\n\n\t\t\tthis.sheenSpecularDirect = vec3().toVar( 'sheenSpecularDirect' );\n\t\t\tthis.sheenSpecularIndirect = vec3().toVar( 'sheenSpecularIndirect' );\n\n\t\t}\n\n\t\tif ( this.iridescence === true ) {\n\n\t\t\tconst dotNVi = transformedNormalView.dot( positionViewDirection ).clamp();\n\n\t\t\tthis.iridescenceFresnel = evalIridescence( {\n\t\t\t\toutsideIOR: float( 1.0 ),\n\t\t\t\teta2: iridescenceIOR,\n\t\t\t\tcosTheta1: dotNVi,\n\t\t\t\tthinFilmThickness: iridescenceThickness,\n\t\t\t\tbaseF0: specularColor\n\t\t\t} );\n\n\t\t\tthis.iridescenceF0 = Schlick_to_F0( { f: this.iridescenceFresnel, f90: 1.0, dotVH: dotNVi } );\n\n\t\t}\n\n\t\tif ( this.transmission === true ) {\n\n\t\t\tconst position = positionWorld;\n\t\t\tconst v = cameraPosition.sub( positionWorld ).normalize(); // TODO: Create Node for this, same issue in MaterialX\n\t\t\tconst n = transformedNormalWorld;\n\n\t\t\tcontext.backdrop = getIBLVolumeRefraction(\n\t\t\t\tn,\n\t\t\t\tv,\n\t\t\t\troughness,\n\t\t\t\tdiffuseColor,\n\t\t\t\tspecularColor,\n\t\t\t\tspecularF90, // specularF90\n\t\t\t\tposition, // positionWorld\n\t\t\t\tmodelWorldMatrix, // modelMatrix\n\t\t\t\tcameraViewMatrix, // viewMatrix\n\t\t\t\tcameraProjectionMatrix, // projMatrix\n\t\t\t\tior,\n\t\t\t\tthickness,\n\t\t\t\tattenuationColor,\n\t\t\t\tattenuationDistance,\n\t\t\t\tthis.dispersion ? dispersion : null\n\t\t\t);\n\n\t\t\tcontext.backdropAlpha = transmission;\n\n\t\t\tdiffuseColor.a.mulAssign( mix( 1, context.backdrop.a, transmission ) );\n\n\t\t}\n\n\t}\n\n\t// Fdez-Agüera's \"Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting\"\n\t// Approximates multiscattering in order to preserve energy.\n\t// http://www.jcgt.org/published/0008/01/03/\n\n\tcomputeMultiscattering( singleScatter, multiScatter, specularF90 ) {\n\n\t\tconst dotNV = transformedNormalView.dot( positionViewDirection ).clamp(); // @ TODO: Move to core dotNV\n\n\t\tconst fab = DFGApprox( { roughness, dotNV } );\n\n\t\tconst Fr = this.iridescenceF0 ? iridescence.mix( specularColor, this.iridescenceF0 ) : specularColor;\n\n\t\tconst FssEss = Fr.mul( fab.x ).add( specularF90.mul( fab.y ) );\n\n\t\tconst Ess = fab.x.add( fab.y );\n\t\tconst Ems = Ess.oneMinus();\n\n\t\tconst Favg = specularColor.add( specularColor.oneMinus().mul( 0.047619 ) ); // 1/21\n\t\tconst Fms = FssEss.mul( Favg ).div( Ems.mul( Favg ).oneMinus() );\n\n\t\tsingleScatter.addAssign( FssEss );\n\t\tmultiScatter.addAssign( Fms.mul( Ems ) );\n\n\t}\n\n\tdirect( { lightDirection, lightColor, reflectedLight } ) {\n\n\t\tconst dotNL = transformedNormalView.dot( lightDirection ).clamp();\n\t\tconst irradiance = dotNL.mul( lightColor );\n\n\t\tif ( this.sheen === true ) {\n\n\t\t\tthis.sheenSpecularDirect.addAssign( irradiance.mul( BRDF_Sheen( { lightDirection } ) ) );\n\n\t\t}\n\n\t\tif ( this.clearcoat === true ) {\n\n\t\t\tconst dotNLcc = transformedClearcoatNormalView.dot( lightDirection ).clamp();\n\t\t\tconst ccIrradiance = dotNLcc.mul( lightColor );\n\n\t\t\tthis.clearcoatSpecularDirect.addAssign( ccIrradiance.mul( BRDF_GGX( { lightDirection, f0: clearcoatF0, f90: clearcoatF90, roughness: clearcoatRoughness, normalView: transformedClearcoatNormalView } ) ) );\n\n\t\t}\n\n\t\treflectedLight.directDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor: diffuseColor.rgb } ) ) );\n\n\t\treflectedLight.directSpecular.addAssign( irradiance.mul( BRDF_GGX( { lightDirection, f0: specularColor, f90: 1, roughness, iridescence: this.iridescence, f: this.iridescenceFresnel, USE_IRIDESCENCE: this.iridescence, USE_ANISOTROPY: this.anisotropy } ) ) );\n\n\t}\n\n\tdirectRectArea( { lightColor, lightPosition, halfWidth, halfHeight, reflectedLight, ltc_1, ltc_2 } ) {\n\n\t\tconst p0 = lightPosition.add( halfWidth ).sub( halfHeight ); // counterclockwise; light shines in local neg z direction\n\t\tconst p1 = lightPosition.sub( halfWidth ).sub( halfHeight );\n\t\tconst p2 = lightPosition.sub( halfWidth ).add( halfHeight );\n\t\tconst p3 = lightPosition.add( halfWidth ).add( halfHeight );\n\n\t\tconst N = transformedNormalView;\n\t\tconst V = positionViewDirection;\n\t\tconst P = positionView.toVar();\n\n\t\tconst uv = LTC_Uv( { N, V, roughness } );\n\n\t\tconst t1 = ltc_1.uv( uv ).toVar();\n\t\tconst t2 = ltc_2.uv( uv ).toVar();\n\n\t\tconst mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3( 0, 1, 0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t).toVar();\n\n\t\t// LTC Fresnel Approximation by Stephen Hill\n\t\t// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf\n\t\tconst fresnel = specularColor.mul( t2.x ).add( specularColor.oneMinus().mul( t2.y ) ).toVar();\n\n\t\treflectedLight.directSpecular.addAssign( lightColor.mul( fresnel ).mul( LTC_Evaluate( { N, V, P, mInv, p0, p1, p2, p3 } ) ) );\n\n\t\treflectedLight.directDiffuse.addAssign( lightColor.mul( diffuseColor ).mul( LTC_Evaluate( { N, V, P, mInv: mat3( 1, 0, 0, 0, 1, 0, 0, 0, 1 ), p0, p1, p2, p3 } ) ) );\n\n\t}\n\n\tindirect( context, stack, builder ) {\n\n\t\tthis.indirectDiffuse( context, stack, builder );\n\t\tthis.indirectSpecular( context, stack, builder );\n\t\tthis.ambientOcclusion( context, stack, builder );\n\n\t}\n\n\tindirectDiffuse( { irradiance, reflectedLight } ) {\n\n\t\treflectedLight.indirectDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor } ) ) );\n\n\t}\n\n\tindirectSpecular( { radiance, iblIrradiance, reflectedLight } ) {\n\n\t\tif ( this.sheen === true ) {\n\n\t\t\tthis.sheenSpecularIndirect.addAssign( iblIrradiance.mul(\n\t\t\t\tsheen,\n\t\t\t\tIBLSheenBRDF( {\n\t\t\t\t\tnormal: transformedNormalView,\n\t\t\t\t\tviewDir: positionViewDirection,\n\t\t\t\t\troughness: sheenRoughness\n\t\t\t\t} )\n\t\t\t) );\n\n\t\t}\n\n\t\tif ( this.clearcoat === true ) {\n\n\t\t\tconst dotNVcc = transformedClearcoatNormalView.dot( positionViewDirection ).clamp();\n\n\t\t\tconst clearcoatEnv = EnvironmentBRDF( {\n\t\t\t\tdotNV: dotNVcc,\n\t\t\t\tspecularColor: clearcoatF0,\n\t\t\t\tspecularF90: clearcoatF90,\n\t\t\t\troughness: clearcoatRoughness\n\t\t\t} );\n\n\t\t\tthis.clearcoatSpecularIndirect.addAssign( this.clearcoatRadiance.mul( clearcoatEnv ) );\n\n\t\t}\n\n\t\t// Both indirect specular and indirect diffuse light accumulate here\n\n\t\tconst singleScattering = vec3().toVar( 'singleScattering' );\n\t\tconst multiScattering = vec3().toVar( 'multiScattering' );\n\t\tconst cosineWeightedIrradiance = iblIrradiance.mul( 1 / Math.PI );\n\n\t\tthis.computeMultiscattering( singleScattering, multiScattering, specularF90 );\n\n\t\tconst totalScattering = singleScattering.add( multiScattering );\n\n\t\tconst diffuse = diffuseColor.mul( totalScattering.r.max( totalScattering.g ).max( totalScattering.b ).oneMinus() );\n\n\t\treflectedLight.indirectSpecular.addAssign( radiance.mul( singleScattering ) );\n\t\treflectedLight.indirectSpecular.addAssign( multiScattering.mul( cosineWeightedIrradiance ) );\n\n\t\treflectedLight.indirectDiffuse.addAssign( diffuse.mul( cosineWeightedIrradiance ) );\n\n\t}\n\n\tambientOcclusion( { ambientOcclusion, reflectedLight } ) {\n\n\t\tconst dotNV = transformedNormalView.dot( positionViewDirection ).clamp(); // @ TODO: Move to core dotNV\n\n\t\tconst aoNV = dotNV.add( ambientOcclusion );\n\t\tconst aoExp = roughness.mul( - 16.0 ).oneMinus().negate().exp2();\n\n\t\tconst aoNode = ambientOcclusion.sub( aoNV.pow( aoExp ).oneMinus() ).clamp();\n\n\t\tif ( this.clearcoat === true ) {\n\n\t\t\tthis.clearcoatSpecularIndirect.mulAssign( ambientOcclusion );\n\n\t\t}\n\n\t\tif ( this.sheen === true ) {\n\n\t\t\tthis.sheenSpecularIndirect.mulAssign( ambientOcclusion );\n\n\t\t}\n\n\t\treflectedLight.indirectDiffuse.mulAssign( ambientOcclusion );\n\t\treflectedLight.indirectSpecular.mulAssign( aoNode );\n\n\t}\n\n\tfinish( context ) {\n\n\t\tconst { outgoingLight } = context;\n\n\t\tif ( this.clearcoat === true ) {\n\n\t\t\tconst dotNVcc = transformedClearcoatNormalView.dot( positionViewDirection ).clamp();\n\n\t\t\tconst Fcc = F_Schlick( {\n\t\t\t\tdotVH: dotNVcc,\n\t\t\t\tf0: clearcoatF0,\n\t\t\t\tf90: clearcoatF90\n\t\t\t} );\n\n\t\t\tconst clearcoatLight = outgoingLight.mul( clearcoat.mul( Fcc ).oneMinus() ).add( this.clearcoatSpecularDirect.add( this.clearcoatSpecularIndirect ).mul( clearcoat ) );\n\n\t\t\toutgoingLight.assign( clearcoatLight );\n\n\t\t}\n\n\t\tif ( this.sheen === true ) {\n\n\t\t\tconst sheenEnergyComp = sheen.r.max( sheen.g ).max( sheen.b ).mul( 0.157 ).oneMinus();\n\t\t\tconst sheenLight = outgoingLight.mul( sheenEnergyComp ).add( this.sheenSpecularDirect, this.sheenSpecularIndirect );\n\n\t\t\toutgoingLight.assign( sheenLight );\n\n\t\t}\n\n\t}\n\n}\n\n// These defines must match with PMREMGenerator\n\nconst cubeUV_r0 = /*@__PURE__*/ float( 1.0 );\nconst cubeUV_m0 = /*@__PURE__*/ float( - 2.0 );\nconst cubeUV_r1 = /*@__PURE__*/ float( 0.8 );\nconst cubeUV_m1 = /*@__PURE__*/ float( - 1.0 );\nconst cubeUV_r4 = /*@__PURE__*/ float( 0.4 );\nconst cubeUV_m4 = /*@__PURE__*/ float( 2.0 );\nconst cubeUV_r5 = /*@__PURE__*/ float( 0.305 );\nconst cubeUV_m5 = /*@__PURE__*/ float( 3.0 );\nconst cubeUV_r6 = /*@__PURE__*/ float( 0.21 );\nconst cubeUV_m6 = /*@__PURE__*/ float( 4.0 );\n\nconst cubeUV_minMipLevel = /*@__PURE__*/ float( 4.0 );\nconst cubeUV_minTileSize = /*@__PURE__*/ float( 16.0 );\n\n// These shader functions convert between the UV coordinates of a single face of\n// a cubemap, the 0-5 integer index of a cube face, and the direction vector for\n// sampling a textureCube (not generally normalized ).\n\nconst getFace = /*@__PURE__*/ Fn( ( [ direction ] ) => {\n\n\tconst absDirection = vec3( abs( direction ) ).toVar();\n\tconst face = float( - 1.0 ).toVar();\n\n\tIf( absDirection.x.greaterThan( absDirection.z ), () => {\n\n\t\tIf( absDirection.x.greaterThan( absDirection.y ), () => {\n\n\t\t\tface.assign( select( direction.x.greaterThan( 0.0 ), 0.0, 3.0 ) );\n\n\t\t} ).Else( () => {\n\n\t\t\tface.assign( select( direction.y.greaterThan( 0.0 ), 1.0, 4.0 ) );\n\n\t\t} );\n\n\t} ).Else( () => {\n\n\t\tIf( absDirection.z.greaterThan( absDirection.y ), () => {\n\n\t\t\tface.assign( select( direction.z.greaterThan( 0.0 ), 2.0, 5.0 ) );\n\n\t\t} ).Else( () => {\n\n\t\t\tface.assign( select( direction.y.greaterThan( 0.0 ), 1.0, 4.0 ) );\n\n\t\t} );\n\n\t} );\n\n\treturn face;\n\n} ).setLayout( {\n\tname: 'getFace',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'direction', type: 'vec3' }\n\t]\n} );\n\n// RH coordinate system; PMREM face-indexing convention\nconst getUV = /*@__PURE__*/ Fn( ( [ direction, face ] ) => {\n\n\tconst uv = vec2().toVar();\n\n\tIf( face.equal( 0.0 ), () => {\n\n\t\tuv.assign( vec2( direction.z, direction.y ).div( abs( direction.x ) ) ); // pos x\n\n\t} ).ElseIf( face.equal( 1.0 ), () => {\n\n\t\tuv.assign( vec2( direction.x.negate(), direction.z.negate() ).div( abs( direction.y ) ) ); // pos y\n\n\t} ).ElseIf( face.equal( 2.0 ), () => {\n\n\t\tuv.assign( vec2( direction.x.negate(), direction.y ).div( abs( direction.z ) ) ); // pos z\n\n\t} ).ElseIf( face.equal( 3.0 ), () => {\n\n\t\tuv.assign( vec2( direction.z.negate(), direction.y ).div( abs( direction.x ) ) ); // neg x\n\n\t} ).ElseIf( face.equal( 4.0 ), () => {\n\n\t\tuv.assign( vec2( direction.x.negate(), direction.z ).div( abs( direction.y ) ) ); // neg y\n\n\t} ).Else( () => {\n\n\t\tuv.assign( vec2( direction.x, direction.y ).div( abs( direction.z ) ) ); // neg z\n\n\t} );\n\n\treturn mul( 0.5, uv.add( 1.0 ) );\n\n} ).setLayout( {\n\tname: 'getUV',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'direction', type: 'vec3' },\n\t\t{ name: 'face', type: 'float' }\n\t]\n} );\n\nconst roughnessToMip = /*@__PURE__*/ Fn( ( [ roughness ] ) => {\n\n\tconst mip = float( 0.0 ).toVar();\n\n\tIf( roughness.greaterThanEqual( cubeUV_r1 ), () => {\n\n\t\tmip.assign( cubeUV_r0.sub( roughness ).mul( cubeUV_m1.sub( cubeUV_m0 ) ).div( cubeUV_r0.sub( cubeUV_r1 ) ).add( cubeUV_m0 ) );\n\n\t} ).ElseIf( roughness.greaterThanEqual( cubeUV_r4 ), () => {\n\n\t\tmip.assign( cubeUV_r1.sub( roughness ).mul( cubeUV_m4.sub( cubeUV_m1 ) ).div( cubeUV_r1.sub( cubeUV_r4 ) ).add( cubeUV_m1 ) );\n\n\t} ).ElseIf( roughness.greaterThanEqual( cubeUV_r5 ), () => {\n\n\t\tmip.assign( cubeUV_r4.sub( roughness ).mul( cubeUV_m5.sub( cubeUV_m4 ) ).div( cubeUV_r4.sub( cubeUV_r5 ) ).add( cubeUV_m4 ) );\n\n\t} ).ElseIf( roughness.greaterThanEqual( cubeUV_r6 ), () => {\n\n\t\tmip.assign( cubeUV_r5.sub( roughness ).mul( cubeUV_m6.sub( cubeUV_m5 ) ).div( cubeUV_r5.sub( cubeUV_r6 ) ).add( cubeUV_m5 ) );\n\n\t} ).Else( () => {\n\n\t\tmip.assign( float( - 2.0 ).mul( log2( mul( 1.16, roughness ) ) ) ); // 1.16 = 1.79^0.25\n\n\t} );\n\n\treturn mip;\n\n} ).setLayout( {\n\tname: 'roughnessToMip',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'roughness', type: 'float' }\n\t]\n} );\n\n// RH coordinate system; PMREM face-indexing convention\nconst getDirection = /*@__PURE__*/ Fn( ( [ uv_immutable, face ] ) => {\n\n\tconst uv = uv_immutable.toVar();\n\tuv.assign( mul( 2.0, uv ).sub( 1.0 ) );\n\tconst direction = vec3( uv, 1.0 ).toVar();\n\n\tIf( face.equal( 0.0 ), () => {\n\n\t\tdirection.assign( direction.zyx ); // ( 1, v, u ) pos x\n\n\t} ).ElseIf( face.equal( 1.0 ), () => {\n\n\t\tdirection.assign( direction.xzy );\n\t\tdirection.xz.mulAssign( - 1.0 ); // ( -u, 1, -v ) pos y\n\n\t} ).ElseIf( face.equal( 2.0 ), () => {\n\n\t\tdirection.x.mulAssign( - 1.0 ); // ( -u, v, 1 ) pos z\n\n\t} ).ElseIf( face.equal( 3.0 ), () => {\n\n\t\tdirection.assign( direction.zyx );\n\t\tdirection.xz.mulAssign( - 1.0 ); // ( -1, v, -u ) neg x\n\n\t} ).ElseIf( face.equal( 4.0 ), () => {\n\n\t\tdirection.assign( direction.xzy );\n\t\tdirection.xy.mulAssign( - 1.0 ); // ( -u, -1, v ) neg y\n\n\t} ).ElseIf( face.equal( 5.0 ), () => {\n\n\t\tdirection.z.mulAssign( - 1.0 ); // ( u, v, -1 ) neg zS\n\n\t} );\n\n\treturn direction;\n\n} ).setLayout( {\n\tname: 'getDirection',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'uv', type: 'vec2' },\n\t\t{ name: 'face', type: 'float' }\n\t]\n} );\n\n//\n\nconst textureCubeUV = /*@__PURE__*/ Fn( ( [ envMap, sampleDir_immutable, roughness_immutable, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP ] ) => {\n\n\tconst roughness = float( roughness_immutable );\n\tconst sampleDir = vec3( sampleDir_immutable );\n\n\tconst mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\tconst mipF = fract( mip );\n\tconst mipInt = floor( mip );\n\tconst color0 = vec3( bilinearCubeUV( envMap, sampleDir, mipInt, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP ) ).toVar();\n\n\tIf( mipF.notEqual( 0.0 ), () => {\n\n\t\tconst color1 = vec3( bilinearCubeUV( envMap, sampleDir, mipInt.add( 1.0 ), CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP ) ).toVar();\n\n\t\tcolor0.assign( mix( color0, color1, mipF ) );\n\n\t} );\n\n\treturn color0;\n\n} );\n\nconst bilinearCubeUV = /*@__PURE__*/ Fn( ( [ envMap, direction_immutable, mipInt_immutable, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP ] ) => {\n\n\tconst mipInt = float( mipInt_immutable ).toVar();\n\tconst direction = vec3( direction_immutable );\n\tconst face = float( getFace( direction ) ).toVar();\n\tconst filterInt = float( max$1( cubeUV_minMipLevel.sub( mipInt ), 0.0 ) ).toVar();\n\tmipInt.assign( max$1( mipInt, cubeUV_minMipLevel ) );\n\tconst faceSize = float( exp2( mipInt ) ).toVar();\n\tconst uv = vec2( getUV( direction, face ).mul( faceSize.sub( 2.0 ) ).add( 1.0 ) ).toVar();\n\n\tIf( face.greaterThan( 2.0 ), () => {\n\n\t\tuv.y.addAssign( faceSize );\n\t\tface.subAssign( 3.0 );\n\n\t} );\n\n\tuv.x.addAssign( face.mul( faceSize ) );\n\tuv.x.addAssign( filterInt.mul( mul( 3.0, cubeUV_minTileSize ) ) );\n\tuv.y.addAssign( mul( 4.0, exp2( CUBEUV_MAX_MIP ).sub( faceSize ) ) );\n\tuv.x.mulAssign( CUBEUV_TEXEL_WIDTH );\n\tuv.y.mulAssign( CUBEUV_TEXEL_HEIGHT );\n\n\treturn envMap.uv( uv ).grad( vec2(), vec2() ); // disable anisotropic filtering\n\n} );\n\nconst getSample = /*@__PURE__*/ Fn( ( { envMap, mipInt, outputDirection, theta, axis, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP } ) => {\n\n\tconst cosTheta = cos( theta );\n\n\t// Rodrigues' axis-angle rotation\n\tconst sampleDirection = outputDirection.mul( cosTheta )\n\t\t.add( axis.cross( outputDirection ).mul( sin( theta ) ) )\n\t\t.add( axis.mul( axis.dot( outputDirection ).mul( cosTheta.oneMinus() ) ) );\n\n\treturn bilinearCubeUV( envMap, sampleDirection, mipInt, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP );\n\n} );\n\nconst blur = /*@__PURE__*/ Fn( ( { n, latitudinal, poleAxis, outputDirection, weights, samples, dTheta, mipInt, envMap, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP } ) => {\n\n\tconst axis = vec3( select( latitudinal, poleAxis, cross( poleAxis, outputDirection ) ) ).toVar();\n\n\tIf( all( axis.equals( vec3( 0.0 ) ) ), () => {\n\n\t\taxis.assign( vec3( outputDirection.z, 0.0, outputDirection.x.negate() ) );\n\n\t} );\n\n\taxis.assign( normalize( axis ) );\n\n\tconst gl_FragColor = vec3().toVar();\n\tgl_FragColor.addAssign( weights.element( int( 0 ) ).mul( getSample( { theta: 0.0, axis, outputDirection, mipInt, envMap, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP } ) ) );\n\n\tLoop( { start: int( 1 ), end: n }, ( { i } ) => {\n\n\t\tIf( i.greaterThanEqual( samples ), () => {\n\n\t\t\tBreak();\n\n\t\t} );\n\n\t\tconst theta = float( dTheta.mul( float( i ) ) ).toVar();\n\t\tgl_FragColor.addAssign( weights.element( i ).mul( getSample( { theta: theta.mul( - 1.0 ), axis, outputDirection, mipInt, envMap, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP } ) ) );\n\t\tgl_FragColor.addAssign( weights.element( i ).mul( getSample( { theta, axis, outputDirection, mipInt, envMap, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP } ) ) );\n\n\t} );\n\n\treturn vec4( gl_FragColor, 1 );\n\n} );\n\nlet _generator = null;\n\nconst _cache = new WeakMap();\n\nfunction _generateCubeUVSize( imageHeight ) {\n\n\tconst maxMip = Math.log2( imageHeight ) - 2;\n\n\tconst texelHeight = 1.0 / imageHeight;\n\n\tconst texelWidth = 1.0 / ( 3 * Math.max( Math.pow( 2, maxMip ), 7 * 16 ) );\n\n\treturn { texelWidth, texelHeight, maxMip };\n\n}\n\nfunction _getPMREMFromTexture( texture ) {\n\n\tlet cacheTexture = _cache.get( texture );\n\n\tconst pmremVersion = cacheTexture !== undefined ? cacheTexture.pmremVersion : - 1;\n\n\tif ( pmremVersion !== texture.pmremVersion ) {\n\n\t\tconst image = texture.image;\n\n\t\tif ( texture.isCubeTexture ) {\n\n\t\t\tif ( isCubeMapReady( image ) ) {\n\n\t\t\t\tcacheTexture = _generator.fromCubemap( texture, cacheTexture );\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\n\t\t} else {\n\n\t\t\tif ( isEquirectangularMapReady( image ) ) {\n\n\t\t\t\tcacheTexture = _generator.fromEquirectangular( texture, cacheTexture );\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tcacheTexture.pmremVersion = texture.pmremVersion;\n\n\t\t_cache.set( texture, cacheTexture );\n\n\t}\n\n\treturn cacheTexture.texture;\n\n}\n\nclass PMREMNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'PMREMNode';\n\n\t}\n\n\tconstructor( value, uvNode = null, levelNode = null ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis._value = value;\n\t\tthis._pmrem = null;\n\n\t\tthis.uvNode = uvNode;\n\t\tthis.levelNode = levelNode;\n\n\t\tthis._generator = null;\n\n\t\tconst defaultTexture = new Texture();\n\t\tdefaultTexture.isRenderTargetTexture = true;\n\n\t\tthis._texture = texture( defaultTexture );\n\n\t\tthis._width = uniform( 0 );\n\t\tthis._height = uniform( 0 );\n\t\tthis._maxMip = uniform( 0 );\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\n\t}\n\n\tset value( value ) {\n\n\t\tthis._value = value;\n\t\tthis._pmrem = null;\n\n\t}\n\n\tget value() {\n\n\t\treturn this._value;\n\n\t}\n\n\tupdateFromTexture( texture ) {\n\n\t\tconst cubeUVSize = _generateCubeUVSize( texture.image.height );\n\n\t\tthis._texture.value = texture;\n\t\tthis._width.value = cubeUVSize.texelWidth;\n\t\tthis._height.value = cubeUVSize.texelHeight;\n\t\tthis._maxMip.value = cubeUVSize.maxMip;\n\n\t}\n\n\tupdateBefore() {\n\n\t\tlet pmrem = this._pmrem;\n\n\t\tconst pmremVersion = pmrem ? pmrem.pmremVersion : - 1;\n\t\tconst texture = this._value;\n\n\t\tif ( pmremVersion !== texture.pmremVersion ) {\n\n\t\t\tif ( texture.isPMREMTexture === true ) {\n\n\t\t\t\tpmrem = texture;\n\n\t\t\t} else {\n\n\t\t\t\tpmrem = _getPMREMFromTexture( texture );\n\n\t\t\t}\n\n\t\t\tif ( pmrem !== null ) {\n\n\t\t\t\tthis._pmrem = pmrem;\n\n\t\t\t\tthis.updateFromTexture( pmrem );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( _generator === null ) {\n\n\t\t\t_generator = builder.createPMREMGenerator();\n\n\t\t}\n\n\t\t//\n\n\t\tthis.updateBefore( builder );\n\n\t\t//\n\n\t\tlet uvNode = this.uvNode;\n\n\t\tif ( uvNode === null && builder.context.getUV ) {\n\n\t\t\tuvNode = builder.context.getUV( this );\n\n\t\t}\n\n\t\t//\n\n\t\tconst texture = this.value;\n\n\t\tif ( builder.renderer.coordinateSystem === WebGLCoordinateSystem && texture.isPMREMTexture !== true && texture.isRenderTargetTexture === true ) {\n\n\t\t\tuvNode = vec3( uvNode.x.negate(), uvNode.yz );\n\n\t\t}\n\n\t\t//\n\n\t\tlet levelNode = this.levelNode;\n\n\t\tif ( levelNode === null && builder.context.getTextureLevel ) {\n\n\t\t\tlevelNode = builder.context.getTextureLevel( this );\n\n\t\t}\n\n\t\t//\n\n\t\treturn textureCubeUV( this._texture, uvNode, levelNode, this._width, this._height, this._maxMip );\n\n\t}\n\n}\n\nfunction isCubeMapReady( image ) {\n\n\tif ( image === null || image === undefined ) return false;\n\n\tlet count = 0;\n\tconst length = 6;\n\n\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\tif ( image[ i ] !== undefined ) count ++;\n\n\t}\n\n\treturn count === length;\n\n\n}\n\nfunction isEquirectangularMapReady( image ) {\n\n\tif ( image === null || image === undefined ) return false;\n\n\treturn image.height > 0;\n\n}\n\nconst pmremTexture = /*@__PURE__*/ nodeProxy( PMREMNode );\n\nconst _envNodeCache = new WeakMap();\n\nclass EnvironmentNode extends LightingNode {\n\n\tstatic get type() {\n\n\t\treturn 'EnvironmentNode';\n\n\t}\n\n\tconstructor( envNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.envNode = envNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { material } = builder;\n\n\t\tlet envNode = this.envNode;\n\n\t\tif ( envNode.isTextureNode || envNode.isMaterialReferenceNode ) {\n\n\t\t\tconst value = ( envNode.isTextureNode ) ? envNode.value : material[ envNode.property ];\n\n\t\t\tlet cacheEnvNode = _envNodeCache.get( value );\n\n\t\t\tif ( cacheEnvNode === undefined ) {\n\n\t\t\t\tcacheEnvNode = pmremTexture( value );\n\n\t\t\t\t_envNodeCache.set( value, cacheEnvNode );\n\n\t\t\t}\n\n\t\t\tenvNode\t= cacheEnvNode;\n\n\t\t}\n\n\t\t//\n\n\t\tconst envMap = material.envMap;\n\t\tconst intensity = envMap ? reference( 'envMapIntensity', 'float', builder.material ) : reference( 'environmentIntensity', 'float', builder.scene ); // @TODO: Add materialEnvIntensity in MaterialNode\n\n\t\tconst useAnisotropy = material.useAnisotropy === true || material.anisotropy > 0;\n\t\tconst radianceNormalView = useAnisotropy ? transformedBentNormalView : transformedNormalView;\n\n\t\tconst radiance = envNode.context( createRadianceContext( roughness, radianceNormalView ) ).mul( intensity );\n\t\tconst irradiance = envNode.context( createIrradianceContext( transformedNormalWorld ) ).mul( Math.PI ).mul( intensity );\n\n\t\tconst isolateRadiance = cache( radiance );\n\t\tconst isolateIrradiance = cache( irradiance );\n\n\t\t//\n\n\t\tbuilder.context.radiance.addAssign( isolateRadiance );\n\n\t\tbuilder.context.iblIrradiance.addAssign( isolateIrradiance );\n\n\t\t//\n\n\t\tconst clearcoatRadiance = builder.context.lightingModel.clearcoatRadiance;\n\n\t\tif ( clearcoatRadiance ) {\n\n\t\t\tconst clearcoatRadianceContext = envNode.context( createRadianceContext( clearcoatRoughness, transformedClearcoatNormalView ) ).mul( intensity );\n\t\t\tconst isolateClearcoatRadiance = cache( clearcoatRadianceContext );\n\n\t\t\tclearcoatRadiance.addAssign( isolateClearcoatRadiance );\n\n\t\t}\n\n\t}\n\n}\n\nconst createRadianceContext = ( roughnessNode, normalViewNode ) => {\n\n\tlet reflectVec = null;\n\n\treturn {\n\t\tgetUV: () => {\n\n\t\t\tif ( reflectVec === null ) {\n\n\t\t\t\treflectVec = positionViewDirection.negate().reflect( normalViewNode );\n\n\t\t\t\t// Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.\n\t\t\t\treflectVec = roughnessNode.mul( roughnessNode ).mix( reflectVec, normalViewNode ).normalize();\n\n\t\t\t\treflectVec = reflectVec.transformDirection( cameraViewMatrix );\n\n\t\t\t}\n\n\t\t\treturn reflectVec;\n\n\t\t},\n\t\tgetTextureLevel: () => {\n\n\t\t\treturn roughnessNode;\n\n\t\t}\n\t};\n\n};\n\nconst createIrradianceContext = ( normalWorldNode ) => {\n\n\treturn {\n\t\tgetUV: () => {\n\n\t\t\treturn normalWorldNode;\n\n\t\t},\n\t\tgetTextureLevel: () => {\n\n\t\t\treturn float( 1.0 );\n\n\t\t}\n\t};\n\n};\n\nconst _defaultValues$6 = /*@__PURE__*/ new MeshStandardMaterial();\n\nclass MeshStandardNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshStandardNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshStandardNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.emissiveNode = null;\n\n\t\tthis.metalnessNode = null;\n\t\tthis.roughnessNode = null;\n\n\t\tthis.setDefaultValues( _defaultValues$6 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupEnvironment( builder ) {\n\n\t\tlet envNode = super.setupEnvironment( builder );\n\n\t\tif ( envNode === null && builder.environmentNode ) {\n\n\t\t\tenvNode = builder.environmentNode;\n\n\t\t}\n\n\t\treturn envNode ? new EnvironmentNode( envNode ) : null;\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new PhysicalLightingModel();\n\n\t}\n\n\tsetupSpecular() {\n\n\t\tconst specularColorNode = mix( vec3( 0.04 ), diffuseColor.rgb, metalness );\n\n\t\tspecularColor.assign( specularColorNode );\n\t\tspecularF90.assign( 1.0 );\n\n\t}\n\n\tsetupVariants() {\n\n\t\t// METALNESS\n\n\t\tconst metalnessNode = this.metalnessNode ? float( this.metalnessNode ) : materialMetalness;\n\n\t\tmetalness.assign( metalnessNode );\n\n\t\t// ROUGHNESS\n\n\t\tlet roughnessNode = this.roughnessNode ? float( this.roughnessNode ) : materialRoughness;\n\t\troughnessNode = getRoughness( { roughness: roughnessNode } );\n\n\t\troughness.assign( roughnessNode );\n\n\t\t// SPECULAR COLOR\n\n\t\tthis.setupSpecular();\n\n\t\t// DIFFUSE COLOR\n\n\t\tdiffuseColor.assign( vec4( diffuseColor.rgb.mul( metalnessNode.oneMinus() ), diffuseColor.a ) );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.emissiveNode = source.emissiveNode;\n\n\t\tthis.metalnessNode = source.metalnessNode;\n\t\tthis.roughnessNode = source.roughnessNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nconst _defaultValues$5 = /*@__PURE__*/ new MeshPhysicalMaterial();\n\nclass MeshPhysicalNodeMaterial extends MeshStandardNodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshPhysicalNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshPhysicalNodeMaterial = true;\n\n\t\tthis.clearcoatNode = null;\n\t\tthis.clearcoatRoughnessNode = null;\n\t\tthis.clearcoatNormalNode = null;\n\n\t\tthis.sheenNode = null;\n\t\tthis.sheenRoughnessNode = null;\n\n\t\tthis.iridescenceNode = null;\n\t\tthis.iridescenceIORNode = null;\n\t\tthis.iridescenceThicknessNode = null;\n\n\t\tthis.specularIntensityNode = null;\n\t\tthis.specularColorNode = null;\n\n\t\tthis.iorNode = null;\n\t\tthis.transmissionNode = null;\n\t\tthis.thicknessNode = null;\n\t\tthis.attenuationDistanceNode = null;\n\t\tthis.attenuationColorNode = null;\n\t\tthis.dispersionNode = null;\n\n\t\tthis.anisotropyNode = null;\n\n\t\tthis.setDefaultValues( _defaultValues$5 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tget useClearcoat() {\n\n\t\treturn this.clearcoat > 0 || this.clearcoatNode !== null;\n\n\t}\n\n\tget useIridescence() {\n\n\t\treturn this.iridescence > 0 || this.iridescenceNode !== null;\n\n\t}\n\n\tget useSheen() {\n\n\t\treturn this.sheen > 0 || this.sheenNode !== null;\n\n\t}\n\n\tget useAnisotropy() {\n\n\t\treturn this.anisotropy > 0 || this.anisotropyNode !== null;\n\n\t}\n\n\tget useTransmission() {\n\n\t\treturn this.transmission > 0 || this.transmissionNode !== null;\n\n\t}\n\n\tget useDispersion() {\n\n\t\treturn this.dispersion > 0 || this.dispersionNode !== null;\n\n\t}\n\n\tsetupSpecular() {\n\n\t\tconst iorNode = this.iorNode ? float( this.iorNode ) : materialIOR;\n\n\t\tior.assign( iorNode );\n\t\tspecularColor.assign( mix( min$1( pow2( ior.sub( 1.0 ).div( ior.add( 1.0 ) ) ).mul( materialSpecularColor ), vec3( 1.0 ) ).mul( materialSpecularIntensity ), diffuseColor.rgb, metalness ) );\n\t\tspecularF90.assign( mix( materialSpecularIntensity, 1.0, metalness ) );\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new PhysicalLightingModel( this.useClearcoat, this.useSheen, this.useIridescence, this.useAnisotropy, this.useTransmission, this.useDispersion );\n\n\t}\n\n\tsetupVariants( builder ) {\n\n\t\tsuper.setupVariants( builder );\n\n\t\t// CLEARCOAT\n\n\t\tif ( this.useClearcoat ) {\n\n\t\t\tconst clearcoatNode = this.clearcoatNode ? float( this.clearcoatNode ) : materialClearcoat;\n\t\t\tconst clearcoatRoughnessNode = this.clearcoatRoughnessNode ? float( this.clearcoatRoughnessNode ) : materialClearcoatRoughness;\n\n\t\t\tclearcoat.assign( clearcoatNode );\n\t\t\tclearcoatRoughness.assign( getRoughness( { roughness: clearcoatRoughnessNode } ) );\n\n\t\t}\n\n\t\t// SHEEN\n\n\t\tif ( this.useSheen ) {\n\n\t\t\tconst sheenNode = this.sheenNode ? vec3( this.sheenNode ) : materialSheen;\n\t\t\tconst sheenRoughnessNode = this.sheenRoughnessNode ? float( this.sheenRoughnessNode ) : materialSheenRoughness;\n\n\t\t\tsheen.assign( sheenNode );\n\t\t\tsheenRoughness.assign( sheenRoughnessNode );\n\n\t\t}\n\n\t\t// IRIDESCENCE\n\n\t\tif ( this.useIridescence ) {\n\n\t\t\tconst iridescenceNode = this.iridescenceNode ? float( this.iridescenceNode ) : materialIridescence;\n\t\t\tconst iridescenceIORNode = this.iridescenceIORNode ? float( this.iridescenceIORNode ) : materialIridescenceIOR;\n\t\t\tconst iridescenceThicknessNode = this.iridescenceThicknessNode ? float( this.iridescenceThicknessNode ) : materialIridescenceThickness;\n\n\t\t\tiridescence.assign( iridescenceNode );\n\t\t\tiridescenceIOR.assign( iridescenceIORNode );\n\t\t\tiridescenceThickness.assign( iridescenceThicknessNode );\n\n\t\t}\n\n\t\t// ANISOTROPY\n\n\t\tif ( this.useAnisotropy ) {\n\n\t\t\tconst anisotropyV = ( this.anisotropyNode ? vec2( this.anisotropyNode ) : materialAnisotropy ).toVar();\n\n\t\t\tanisotropy.assign( anisotropyV.length() );\n\n\t\t\tIf( anisotropy.equal( 0.0 ), () => {\n\n\t\t\t\tanisotropyV.assign( vec2( 1.0, 0.0 ) );\n\n\t\t\t} ).Else( () => {\n\n\t\t\t\tanisotropyV.divAssign( vec2( anisotropy ) );\n\t\t\t\tanisotropy.assign( anisotropy.saturate() );\n\n\t\t\t} );\n\n\t\t\t// Roughness along the anisotropy bitangent is the material roughness, while the tangent roughness increases with anisotropy.\n\t\t\talphaT.assign( anisotropy.pow2().mix( roughness.pow2(), 1.0 ) );\n\n\t\t\tanisotropyT.assign( TBNViewMatrix[ 0 ].mul( anisotropyV.x ).add( TBNViewMatrix[ 1 ].mul( anisotropyV.y ) ) );\n\t\t\tanisotropyB.assign( TBNViewMatrix[ 1 ].mul( anisotropyV.x ).sub( TBNViewMatrix[ 0 ].mul( anisotropyV.y ) ) );\n\n\t\t}\n\n\t\t// TRANSMISSION\n\n\t\tif ( this.useTransmission ) {\n\n\t\t\tconst transmissionNode = this.transmissionNode ? float( this.transmissionNode ) : materialTransmission;\n\t\t\tconst thicknessNode = this.thicknessNode ? float( this.thicknessNode ) : materialThickness;\n\t\t\tconst attenuationDistanceNode = this.attenuationDistanceNode ? float( this.attenuationDistanceNode ) : materialAttenuationDistance;\n\t\t\tconst attenuationColorNode = this.attenuationColorNode ? vec3( this.attenuationColorNode ) : materialAttenuationColor;\n\n\t\t\ttransmission.assign( transmissionNode );\n\t\t\tthickness.assign( thicknessNode );\n\t\t\tattenuationDistance.assign( attenuationDistanceNode );\n\t\t\tattenuationColor.assign( attenuationColorNode );\n\n\t\t\tif ( this.useDispersion ) {\n\n\t\t\t\tconst dispersionNode = this.dispersionNode ? float( this.dispersionNode ) : materialDispersion;\n\n\t\t\t\tdispersion.assign( dispersionNode );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetupClearcoatNormal() {\n\n\t\treturn this.clearcoatNormalNode ? vec3( this.clearcoatNormalNode ) : materialClearcoatNormal;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tbuilder.context.setupClearcoatNormal = () => this.setupClearcoatNormal( builder );\n\n\t\tsuper.setup( builder );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.clearcoatNode = source.clearcoatNode;\n\t\tthis.clearcoatRoughnessNode = source.clearcoatRoughnessNode;\n\t\tthis.clearcoatNormalNode = source.clearcoatNormalNode;\n\n\t\tthis.sheenNode = source.sheenNode;\n\t\tthis.sheenRoughnessNode = source.sheenRoughnessNode;\n\n\t\tthis.iridescenceNode = source.iridescenceNode;\n\t\tthis.iridescenceIORNode = source.iridescenceIORNode;\n\t\tthis.iridescenceThicknessNode = source.iridescenceThicknessNode;\n\n\t\tthis.specularIntensityNode = source.specularIntensityNode;\n\t\tthis.specularColorNode = source.specularColorNode;\n\n\t\tthis.transmissionNode = source.transmissionNode;\n\t\tthis.thicknessNode = source.thicknessNode;\n\t\tthis.attenuationDistanceNode = source.attenuationDistanceNode;\n\t\tthis.attenuationColorNode = source.attenuationColorNode;\n\t\tthis.dispersionNode = source.dispersionNode;\n\n\t\tthis.anisotropyNode = source.anisotropyNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nclass SSSLightingModel extends PhysicalLightingModel {\n\n\tconstructor( useClearcoat, useSheen, useIridescence, useSSS ) {\n\n\t\tsuper( useClearcoat, useSheen, useIridescence );\n\n\t\tthis.useSSS = useSSS;\n\n\t}\n\n\tdirect( { lightDirection, lightColor, reflectedLight }, stack, builder ) {\n\n\t\tif ( this.useSSS === true ) {\n\n\t\t\tconst material = builder.material;\n\n\t\t\tconst { thicknessColorNode, thicknessDistortionNode, thicknessAmbientNode, thicknessAttenuationNode, thicknessPowerNode, thicknessScaleNode } = material;\n\n\t\t\tconst scatteringHalf = lightDirection.add( transformedNormalView.mul( thicknessDistortionNode ) ).normalize();\n\t\t\tconst scatteringDot = float( positionViewDirection.dot( scatteringHalf.negate() ).saturate().pow( thicknessPowerNode ).mul( thicknessScaleNode ) );\n\t\t\tconst scatteringIllu = vec3( scatteringDot.add( thicknessAmbientNode ).mul( thicknessColorNode ) );\n\n\t\t\treflectedLight.directDiffuse.addAssign( scatteringIllu.mul( thicknessAttenuationNode.mul( lightColor ) ) );\n\n\t\t}\n\n\t\tsuper.direct( { lightDirection, lightColor, reflectedLight }, stack, builder );\n\n\t}\n\n}\n\nclass MeshSSSNodeMaterial extends MeshPhysicalNodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshSSSNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper( parameters );\n\n\t\tthis.thicknessColorNode = null;\n\t\tthis.thicknessDistortionNode = float( 0.1 );\n\t\tthis.thicknessAmbientNode = float( 0.0 );\n\t\tthis.thicknessAttenuationNode = float( .1 );\n\t\tthis.thicknessPowerNode = float( 2.0 );\n\t\tthis.thicknessScaleNode = float( 10.0 );\n\n\t}\n\n\tget useSSS() {\n\n\t\treturn this.thicknessColorNode !== null;\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new SSSLightingModel( this.useClearcoat, this.useSheen, this.useIridescence, this.useSSS );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.thicknessColorNode = source.thicknessColorNode;\n\t\tthis.thicknessDistortionNode = source.thicknessDistortionNode;\n\t\tthis.thicknessAmbientNode = source.thicknessAmbientNode;\n\t\tthis.thicknessAttenuationNode = source.thicknessAttenuationNode;\n\t\tthis.thicknessPowerNode = source.thicknessPowerNode;\n\t\tthis.thicknessScaleNode = source.thicknessScaleNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nconst getGradientIrradiance = /*@__PURE__*/ Fn( ( { normal, lightDirection, builder } ) => {\n\n\t// dotNL will be from -1.0 to 1.0\n\tconst dotNL = normal.dot( lightDirection );\n\tconst coord = vec2( dotNL.mul( 0.5 ).add( 0.5 ), 0.0 );\n\n\tif ( builder.material.gradientMap ) {\n\n\t\tconst gradientMap = materialReference( 'gradientMap', 'texture' ).context( { getUV: () => coord } );\n\n\t\treturn vec3( gradientMap.r );\n\n\t} else {\n\n\t\tconst fw = coord.fwidth().mul( 0.5 );\n\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( float( 0.7 ).sub( fw.x ), float( 0.7 ).add( fw.x ), coord.x ) );\n\n\t}\n\n} );\n\nclass ToonLightingModel extends LightingModel {\n\n\tdirect( { lightDirection, lightColor, reflectedLight }, stack, builder ) {\n\n\t\tconst irradiance = getGradientIrradiance( { normal: normalGeometry, lightDirection, builder } ).mul( lightColor );\n\n\t\treflectedLight.directDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor: diffuseColor.rgb } ) ) );\n\n\t}\n\n\tindirect( { ambientOcclusion, irradiance, reflectedLight } ) {\n\n\t\treflectedLight.indirectDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor } ) ) );\n\n\t\treflectedLight.indirectDiffuse.mulAssign( ambientOcclusion );\n\n\t}\n\n}\n\nconst _defaultValues$4 = /*@__PURE__*/ new MeshToonMaterial();\n\nclass MeshToonNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshToonNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshToonNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.setDefaultValues( _defaultValues$4 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new ToonLightingModel();\n\n\t}\n\n}\n\nclass MatcapUVNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'MatcapUVNode';\n\n\t}\n\n\tconstructor() {\n\n\t\tsuper( 'vec2' );\n\n\t}\n\n\tsetup() {\n\n\t\tconst x = vec3( positionViewDirection.z, 0, positionViewDirection.x.negate() ).normalize();\n\t\tconst y = positionViewDirection.cross( x );\n\n\t\treturn vec2( x.dot( transformedNormalView ), y.dot( transformedNormalView ) ).mul( 0.495 ).add( 0.5 ); // 0.495 to remove artifacts caused by undersized matcap disks\n\n\t}\n\n}\n\nconst matcapUV = /*@__PURE__*/ nodeImmutable( MatcapUVNode );\n\nconst _defaultValues$3 = /*@__PURE__*/ new MeshMatcapMaterial();\n\nclass MeshMatcapNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshMatcapNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.lights = false;\n\n\t\tthis.isMeshMatcapNodeMaterial = true;\n\n\t\tthis.setDefaultValues( _defaultValues$3 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupVariants( builder ) {\n\n\t\tconst uv = matcapUV;\n\n\t\tlet matcapColor;\n\n\t\tif ( builder.material.matcap ) {\n\n\t\t\tmatcapColor = materialReference( 'matcap', 'texture' ).context( { getUV: () => uv } );\n\n\t\t} else {\n\n\t\t\tmatcapColor = vec3( mix( 0.2, 0.8, uv.y ) ); // default if matcap is missing\n\n\t\t}\n\n\t\tdiffuseColor.rgb.mulAssign( matcapColor.rgb );\n\n\t}\n\n}\n\nconst _defaultValues$2 = /*@__PURE__*/ new PointsMaterial();\n\nclass PointsNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'PointsNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isPointsNodeMaterial = true;\n\n\t\tthis.lights = false;\n\t\tthis.transparent = true;\n\n\t\tthis.sizeNode = null;\n\n\t\tthis.setDefaultValues( _defaultValues$2 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.sizeNode = source.sizeNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nclass RotateNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'RotateNode';\n\n\t}\n\n\tconstructor( positionNode, rotationNode ) {\n\n\t\tsuper();\n\n\t\tthis.positionNode = positionNode;\n\t\tthis.rotationNode = rotationNode;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.positionNode.getNodeType( builder );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { rotationNode, positionNode } = this;\n\n\t\tconst nodeType = this.getNodeType( builder );\n\n\t\tif ( nodeType === 'vec2' ) {\n\n\t\t\tconst cosAngle = rotationNode.cos();\n\t\t\tconst sinAngle = rotationNode.sin();\n\n\t\t\tconst rotationMatrix = mat2(\n\t\t\t\tcosAngle, sinAngle,\n\t\t\t\tsinAngle.negate(), cosAngle\n\t\t\t);\n\n\t\t\treturn rotationMatrix.mul( positionNode );\n\n\t\t} else {\n\n\t\t\tconst rotation = rotationNode;\n\t\t\tconst rotationXMatrix = mat4( vec4( 1.0, 0.0, 0.0, 0.0 ), vec4( 0.0, cos( rotation.x ), sin( rotation.x ).negate(), 0.0 ), vec4( 0.0, sin( rotation.x ), cos( rotation.x ), 0.0 ), vec4( 0.0, 0.0, 0.0, 1.0 ) );\n\t\t\tconst rotationYMatrix = mat4( vec4( cos( rotation.y ), 0.0, sin( rotation.y ), 0.0 ), vec4( 0.0, 1.0, 0.0, 0.0 ), vec4( sin( rotation.y ).negate(), 0.0, cos( rotation.y ), 0.0 ), vec4( 0.0, 0.0, 0.0, 1.0 ) );\n\t\t\tconst rotationZMatrix = mat4( vec4( cos( rotation.z ), sin( rotation.z ).negate(), 0.0, 0.0 ), vec4( sin( rotation.z ), cos( rotation.z ), 0.0, 0.0 ), vec4( 0.0, 0.0, 1.0, 0.0 ), vec4( 0.0, 0.0, 0.0, 1.0 ) );\n\n\t\t\treturn rotationXMatrix.mul( rotationYMatrix ).mul( rotationZMatrix ).mul( vec4( positionNode, 1.0 ) ).xyz;\n\n\t\t}\n\n\t}\n\n}\n\nconst rotate = /*@__PURE__*/ nodeProxy( RotateNode );\n\nconst _defaultValues$1 = /*@__PURE__*/ new SpriteMaterial();\n\nclass SpriteNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'SpriteNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isSpriteNodeMaterial = true;\n\n\t\tthis.lights = false;\n\t\tthis._useSizeAttenuation = true;\n\n\t\tthis.positionNode = null;\n\t\tthis.rotationNode = null;\n\t\tthis.scaleNode = null;\n\n\t\tthis.setDefaultValues( _defaultValues$1 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupPosition( { object, camera, context } ) {\n\n\t\tconst sizeAttenuation = this.sizeAttenuation;\n\n\t\t// < VERTEX STAGE >\n\n\t\tconst { positionNode, rotationNode, scaleNode } = this;\n\n\t\tconst vertex = positionLocal;\n\n\t\tlet mvPosition = modelViewMatrix.mul( vec3( positionNode || 0 ) );\n\n\t\tlet scale = vec2( modelWorldMatrix[ 0 ].xyz.length(), modelWorldMatrix[ 1 ].xyz.length() );\n\n\t\tif ( scaleNode !== null ) {\n\n\t\t\tscale = scale.mul( scaleNode );\n\n\t\t}\n\n\n\t\tif ( ! sizeAttenuation ) {\n\n\t\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\t\tscale = scale.mul( mvPosition.z.negate() );\n\n\t\t\t} else {\n\n\t\t\t\tconst orthoScale = float( 2.0 ).div( cameraProjectionMatrix.element( 1 ).element( 1 ) );\n\t\t\t\tscale = scale.mul( orthoScale.mul( 2 ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet alignedPosition = vertex.xy;\n\n\t\tif ( object.center && object.center.isVector2 === true ) {\n\n\t\t\tconst center = reference$1( 'center', 'vec2' );\n\n\t\t\talignedPosition = alignedPosition.sub( center.sub( 0.5 ) );\n\n\t\t}\n\n\t\talignedPosition = alignedPosition.mul( scale );\n\n\t\tconst rotation = float( rotationNode || materialRotation );\n\n\t\tconst rotatedPosition = rotate( alignedPosition, rotation );\n\n\t\tmvPosition = vec4( mvPosition.xy.add( rotatedPosition ), mvPosition.zw );\n\n\t\tconst modelViewProjection = cameraProjectionMatrix.mul( mvPosition );\n\n\t\tcontext.vertex = vertex;\n\n\t\treturn modelViewProjection;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.positionNode = source.positionNode;\n\t\tthis.rotationNode = source.rotationNode;\n\t\tthis.scaleNode = source.scaleNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n\tget sizeAttenuation() {\n\n\t\treturn this._useSizeAttenuation;\n\n\t}\n\n\tset sizeAttenuation( value ) {\n\n\t\tif ( this._useSizeAttenuation !== value ) {\n\n\t\t\tthis._useSizeAttenuation = value;\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n}\n\nclass ShadowMaskModel extends LightingModel {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.shadowNode = float( 1 ).toVar( 'shadowMask' );\n\n\t}\n\n\tdirect( { shadowMask } ) {\n\n\t\tthis.shadowNode.mulAssign( shadowMask );\n\n\t}\n\n\tfinish( context ) {\n\n\t\tdiffuseColor.a.mulAssign( this.shadowNode.oneMinus() );\n\n\t\tcontext.outgoingLight.rgb.assign( diffuseColor.rgb ); // TODO: Optimize LightsNode to avoid this assignment\n\n\t}\n\n}\n\nconst _defaultValues = /*@__PURE__*/ new ShadowMaterial();\n\nclass ShadowNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'ShadowNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isShadowNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.setDefaultValues( _defaultValues );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new ShadowMaskModel();\n\n\t}\n\n}\n\nconst normal = Fn( ( { texture, uv } ) => {\n\n\tconst epsilon = 0.0001;\n\n\tconst ret = vec3().toVar();\n\n\tIf( uv.x.lessThan( epsilon ), () => {\n\n\t\tret.assign( vec3( 1, 0, 0 ) );\n\n\t} ).ElseIf( uv.y.lessThan( epsilon ), () => {\n\n\t\tret.assign( vec3( 0, 1, 0 ) );\n\n\t} ).ElseIf( uv.z.lessThan( epsilon ), () => {\n\n\t\tret.assign( vec3( 0, 0, 1 ) );\n\n\t} ).ElseIf( uv.x.greaterThan( 1 - epsilon ), () => {\n\n\t\tret.assign( vec3( - 1, 0, 0 ) );\n\n\t} ).ElseIf( uv.y.greaterThan( 1 - epsilon ), () => {\n\n\t\tret.assign( vec3( 0, - 1, 0 ) );\n\n\t} ).ElseIf( uv.z.greaterThan( 1 - epsilon ), () => {\n\n\t\tret.assign( vec3( 0, 0, - 1 ) );\n\n\t} ).Else( () => {\n\n\t\tconst step = 0.01;\n\n\t\tconst x = texture.uv( uv.add( vec3( - step, 0.0, 0.0 ) ) ).r.sub( texture.uv( uv.add( vec3( step, 0.0, 0.0 ) ) ).r );\n\t\tconst y = texture.uv( uv.add( vec3( 0.0, - step, 0.0 ) ) ).r.sub( texture.uv( uv.add( vec3( 0.0, step, 0.0 ) ) ).r );\n\t\tconst z = texture.uv( uv.add( vec3( 0.0, 0.0, - step ) ) ).r.sub( texture.uv( uv.add( vec3( 0.0, 0.0, step ) ) ).r );\n\n\t\tret.assign( vec3( x, y, z ) );\n\n\t} );\n\n\treturn ret.normalize();\n\n} );\n\n\nclass Texture3DNode extends TextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'Texture3DNode';\n\n\t}\n\n\tconstructor( value, uvNode = null, levelNode = null ) {\n\n\t\tsuper( value, uvNode, levelNode );\n\n\t\tthis.isTexture3DNode = true;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'texture3D';\n\n\t}\n\n\tgetDefaultUV() {\n\n\t\treturn vec3( 0.5, 0.5, 0.5 );\n\n\t}\n\n\tsetUpdateMatrix( /*updateMatrix*/ ) { } // Ignore .updateMatrix for 3d TextureNode\n\n\tsetupUV( builder, uvNode ) {\n\n\t\treturn uvNode;\n\n\t}\n\n\tgenerateUV( builder, uvNode ) {\n\n\t\treturn uvNode.build( builder, 'vec3' );\n\n\t}\n\n\tnormal( uvNode ) {\n\n\t\treturn normal( { texture: this, uv: uvNode } );\n\n\t}\n\n}\n\nconst texture3D = /*@__PURE__*/ nodeProxy( Texture3DNode );\n\nclass VolumeNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'VolumeNodeMaterial';\n\n\t}\n\n\tconstructor( params = {} ) {\n\n\t\tsuper();\n\n\t\tthis.lights = false;\n\t\tthis.isVolumeNodeMaterial = true;\n\t\tthis.testNode = null;\n\n\t\tthis.setValues( params );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst map = texture3D( this.map, null, 0 );\n\n\t\tconst hitBox = Fn( ( { orig, dir } ) => {\n\n\t\t\tconst box_min = vec3( - 0.5 );\n\t\t\tconst box_max = vec3( 0.5 );\n\n\t\t\tconst inv_dir = dir.reciprocal();\n\n\t\t\tconst tmin_tmp = box_min.sub( orig ).mul( inv_dir );\n\t\t\tconst tmax_tmp = box_max.sub( orig ).mul( inv_dir );\n\n\t\t\tconst tmin = min$1( tmin_tmp, tmax_tmp );\n\t\t\tconst tmax = max$1( tmin_tmp, tmax_tmp );\n\n\t\t\tconst t0 = max$1( tmin.x, max$1( tmin.y, tmin.z ) );\n\t\t\tconst t1 = min$1( tmax.x, min$1( tmax.y, tmax.z ) );\n\n\t\t\treturn vec2( t0, t1 );\n\n\t\t} );\n\n\t\tthis.fragmentNode = Fn( () => {\n\n\t\t\tconst vOrigin = varying( vec3( modelWorldMatrixInverse.mul( vec4( cameraPosition, 1.0 ) ) ) );\n\t\t\tconst vDirection = varying( positionGeometry.sub( vOrigin ) );\n\n\t\t\tconst rayDir = vDirection.normalize();\n\t\t\tconst bounds = vec2( hitBox( { orig: vOrigin, dir: rayDir } ) ).toVar();\n\n\t\t\tbounds.x.greaterThan( bounds.y ).discard();\n\n\t\t\tbounds.assign( vec2( max$1( bounds.x, 0.0 ), bounds.y ) );\n\n\t\t\tconst p = vec3( vOrigin.add( bounds.x.mul( rayDir ) ) ).toVar();\n\t\t\tconst inc = vec3( rayDir.abs().reciprocal() ).toVar();\n\t\t\tconst delta = float( min$1( inc.x, min$1( inc.y, inc.z ) ) ).toVar( 'delta' ); // used 'delta' name in loop\n\n\t\t\tdelta.divAssign( materialReference( 'steps', 'float' ) );\n\n\t\t\tconst ac = vec4( materialReference( 'base', 'color' ), 0.0 ).toVar();\n\n\t\t\tLoop( { type: 'float', start: bounds.x, end: bounds.y, update: '+= delta' }, () => {\n\n\t\t\t\tconst d = property( 'float', 'd' ).assign( map.uv( p.add( 0.5 ) ).r );\n\n\t\t\t\tif ( this.testNode !== null ) {\n\n\t\t\t\t\tthis.testNode( { map: map, mapValue: d, probe: p, finalColor: ac } ).append();\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// default to show surface of mesh\n\t\t\t\t\tac.a.assign( 1 );\n\t\t\t\t\tBreak();\n\n\t\t\t\t}\n\n\t\t\t\tp.addAssign( rayDir.mul( delta ) );\n\n\t\t\t} );\n\n\t\t\tac.a.equal( 0 ).discard();\n\n\t\t\treturn vec4( ac );\n\n\t\t} )();\n\n\t\tsuper.setup( builder );\n\n\t}\n\n}\n\nclass Animation {\n\n\tconstructor( nodes, info ) {\n\n\t\tthis.nodes = nodes;\n\t\tthis.info = info;\n\n\t\tthis._context = self;\n\t\tthis._animationLoop = null;\n\t\tthis._requestId = null;\n\n\t}\n\n\tstart() {\n\n\t\tconst update = ( time, frame ) => {\n\n\t\t\tthis._requestId = this._context.requestAnimationFrame( update );\n\n\t\t\tif ( this.info.autoReset === true ) this.info.reset();\n\n\t\t\tthis.nodes.nodeFrame.update();\n\n\t\t\tthis.info.frame = this.nodes.nodeFrame.frameId;\n\n\t\t\tif ( this._animationLoop !== null ) this._animationLoop( time, frame );\n\n\t\t};\n\n\t\tupdate();\n\n\t}\n\n\tstop() {\n\n\t\tthis._context.cancelAnimationFrame( this._requestId );\n\n\t\tthis._requestId = null;\n\n\t}\n\n\tsetAnimationLoop( callback ) {\n\n\t\tthis._animationLoop = callback;\n\n\t}\n\n\tsetContext( context ) {\n\n\t\tthis._context = context;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.stop();\n\n\t}\n\n}\n\nclass ChainMap {\n\n\tconstructor() {\n\n\t\tthis.weakMap = new WeakMap();\n\n\t}\n\n\tget( keys ) {\n\n\t\tlet map = this.weakMap;\n\n\t\tfor ( let i = 0; i < keys.length; i ++ ) {\n\n\t\t\tmap = map.get( keys[ i ] );\n\n\t\t\tif ( map === undefined ) return undefined;\n\n\t\t}\n\n\t\treturn map.get( keys[ keys.length - 1 ] );\n\n\t}\n\n\tset( keys, value ) {\n\n\t\tlet map = this.weakMap;\n\n\t\tfor ( let i = 0; i < keys.length; i ++ ) {\n\n\t\t\tconst key = keys[ i ];\n\n\t\t\tif ( map.has( key ) === false ) map.set( key, new WeakMap() );\n\n\t\t\tmap = map.get( key );\n\n\t\t}\n\n\t\treturn map.set( keys[ keys.length - 1 ], value );\n\n\t}\n\n\tdelete( keys ) {\n\n\t\tlet map = this.weakMap;\n\n\t\tfor ( let i = 0; i < keys.length; i ++ ) {\n\n\t\t\tmap = map.get( keys[ i ] );\n\n\t\t\tif ( map === undefined ) return false;\n\n\t\t}\n\n\t\treturn map.delete( keys[ keys.length - 1 ] );\n\n\t}\n\n}\n\nlet _id$7 = 0;\n\nfunction getKeys( obj ) {\n\n\tconst keys = Object.keys( obj );\n\n\tlet proto = Object.getPrototypeOf( obj );\n\n\twhile ( proto ) {\n\n\t\tconst descriptors = Object.getOwnPropertyDescriptors( proto );\n\n\t\tfor ( const key in descriptors ) {\n\n\t\t\tif ( descriptors[ key ] !== undefined ) {\n\n\t\t\t\tconst descriptor = descriptors[ key ];\n\n\t\t\t\tif ( descriptor && typeof descriptor.get === 'function' ) {\n\n\t\t\t\t\tkeys.push( key );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tproto = Object.getPrototypeOf( proto );\n\n\t}\n\n\treturn keys;\n\n}\n\nclass RenderObject {\n\n\tconstructor( nodes, geometries, renderer, object, material, scene, camera, lightsNode, renderContext, clippingContext ) {\n\n\t\tthis._nodes = nodes;\n\t\tthis._geometries = geometries;\n\n\t\tthis.id = _id$7 ++;\n\n\t\tthis.renderer = renderer;\n\t\tthis.object = object;\n\t\tthis.material = material;\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\t\tthis.lightsNode = lightsNode;\n\t\tthis.context = renderContext;\n\n\t\tthis.geometry = object.geometry;\n\t\tthis.version = material.version;\n\n\t\tthis.drawRange = null;\n\n\t\tthis.attributes = null;\n\t\tthis.pipeline = null;\n\t\tthis.vertexBuffers = null;\n\t\tthis.drawParams = null;\n\n\t\tthis.bundle = null;\n\n\t\tthis.clippingContext = clippingContext;\n\t\tthis.clippingContextCacheKey = clippingContext !== null ? clippingContext.cacheKey : '';\n\n\t\tthis.initialNodesCacheKey = this.getDynamicCacheKey();\n\t\tthis.initialCacheKey = this.getCacheKey();\n\n\t\tthis._nodeBuilderState = null;\n\t\tthis._bindings = null;\n\t\tthis._monitor = null;\n\n\t\tthis.onDispose = null;\n\n\t\tthis.isRenderObject = true;\n\n\t\tthis.onMaterialDispose = () => {\n\n\t\t\tthis.dispose();\n\n\t\t};\n\n\t\tthis.material.addEventListener( 'dispose', this.onMaterialDispose );\n\n\t}\n\n\tupdateClipping( parent ) {\n\n\t\tthis.clippingContext = parent;\n\n\t}\n\n\tget clippingNeedsUpdate() {\n\n\t\tif ( this.clippingContext === null || this.clippingContext.cacheKey === this.clippingContextCacheKey ) return false;\n\n\t\tthis.clippingContextCacheKey = this.clippingContext.cacheKey;\n\n\t\treturn true;\n\n\t}\n\n\tget hardwareClippingPlanes() {\n\n\t\treturn this.material.hardwareClipping === true ? this.clippingContext.unionClippingCount : 0;\n\n\t}\n\n\tgetNodeBuilderState() {\n\n\t\treturn this._nodeBuilderState || ( this._nodeBuilderState = this._nodes.getForRender( this ) );\n\n\t}\n\n\tgetMonitor() {\n\n\t\treturn this._monitor || ( this._monitor = this.getNodeBuilderState().monitor );\n\n\t}\n\n\tgetBindings() {\n\n\t\treturn this._bindings || ( this._bindings = this.getNodeBuilderState().createBindings() );\n\n\t}\n\n\tgetIndex() {\n\n\t\treturn this._geometries.getIndex( this );\n\n\t}\n\n\tgetIndirect() {\n\n\t\treturn this._geometries.getIndirect( this );\n\n\t}\n\n\tgetChainArray() {\n\n\t\treturn [ this.object, this.material, this.context, this.lightsNode ];\n\n\t}\n\n\tsetGeometry( geometry ) {\n\n\t\tthis.geometry = geometry;\n\t\tthis.attributes = null;\n\n\t}\n\n\tgetAttributes() {\n\n\t\tif ( this.attributes !== null ) return this.attributes;\n\n\t\tconst nodeAttributes = this.getNodeBuilderState().nodeAttributes;\n\t\tconst geometry = this.geometry;\n\n\t\tconst attributes = [];\n\t\tconst vertexBuffers = new Set();\n\n\t\tfor ( const nodeAttribute of nodeAttributes ) {\n\n\t\t\tconst attribute = nodeAttribute.node && nodeAttribute.node.attribute ? nodeAttribute.node.attribute : geometry.getAttribute( nodeAttribute.name );\n\n\t\t\tif ( attribute === undefined ) continue;\n\n\t\t\tattributes.push( attribute );\n\n\t\t\tconst bufferAttribute = attribute.isInterleavedBufferAttribute ? attribute.data : attribute;\n\t\t\tvertexBuffers.add( bufferAttribute );\n\n\t\t}\n\n\t\tthis.attributes = attributes;\n\t\tthis.vertexBuffers = Array.from( vertexBuffers.values() );\n\n\t\treturn attributes;\n\n\t}\n\n\tgetVertexBuffers() {\n\n\t\tif ( this.vertexBuffers === null ) this.getAttributes();\n\n\t\treturn this.vertexBuffers;\n\n\t}\n\n\tgetDrawParameters() {\n\n\t\tconst { object, material, geometry, group, drawRange } = this;\n\n\t\tconst drawParams = this.drawParams || ( this.drawParams = {\n\t\t\tvertexCount: 0,\n\t\t\tfirstVertex: 0,\n\t\t\tinstanceCount: 0,\n\t\t\tfirstInstance: 0\n\t\t} );\n\n\t\tconst index = this.getIndex();\n\t\tconst hasIndex = ( index !== null );\n\t\tconst instanceCount = geometry.isInstancedBufferGeometry ? geometry.instanceCount : ( object.count > 1 ? object.count : 1 );\n\n\t\tif ( instanceCount === 0 ) return null;\n\n\t\tdrawParams.instanceCount = instanceCount;\n\n\t\tif ( object.isBatchedMesh === true ) return drawParams;\n\n\t\tlet rangeFactor = 1;\n\n\t\tif ( material.wireframe === true && ! object.isPoints && ! object.isLineSegments && ! object.isLine && ! object.isLineLoop ) {\n\n\t\t\trangeFactor = 2;\n\n\t\t}\n\n\t\tlet firstVertex = drawRange.start * rangeFactor;\n\t\tlet lastVertex = ( drawRange.start + drawRange.count ) * rangeFactor;\n\n\t\tif ( group !== null ) {\n\n\t\t\tfirstVertex = Math.max( firstVertex, group.start * rangeFactor );\n\t\t\tlastVertex = Math.min( lastVertex, ( group.start + group.count ) * rangeFactor );\n\n\t\t}\n\n\t\tconst position = geometry.attributes.position;\n\t\tlet itemCount = Infinity;\n\n\t\tif ( hasIndex ) {\n\n\t\t\titemCount = index.count;\n\n\t\t} else if ( position !== undefined && position !== null ) {\n\n\t\t\titemCount = position.count;\n\n\t\t}\n\n\t\tfirstVertex = Math.max( firstVertex, 0 );\n\t\tlastVertex = Math.min( lastVertex, itemCount );\n\n\t\tconst count = lastVertex - firstVertex;\n\n\t\tif ( count < 0 || count === Infinity ) return null;\n\n\t\tdrawParams.vertexCount = count;\n\t\tdrawParams.firstVertex = firstVertex;\n\n\t\treturn drawParams;\n\n\t}\n\n\tgetGeometryCacheKey() {\n\n\t\tconst { geometry } = this;\n\n\t\tlet cacheKey = '';\n\n\t\tfor ( const name of Object.keys( geometry.attributes ).sort() ) {\n\n\t\t\tconst attribute = geometry.attributes[ name ];\n\n\t\t\tcacheKey += name + ',';\n\n\t\t\tif ( attribute.data ) cacheKey += attribute.data.stride + ',';\n\t\t\tif ( attribute.offset ) cacheKey += attribute.offset + ',';\n\t\t\tif ( attribute.itemSize ) cacheKey += attribute.itemSize + ',';\n\t\t\tif ( attribute.normalized ) cacheKey += 'n,';\n\n\t\t}\n\n\t\tif ( geometry.index ) {\n\n\t\t\tcacheKey += 'index,';\n\n\t\t}\n\n\t\treturn cacheKey;\n\n\t}\n\n\tgetMaterialCacheKey() {\n\n\t\tconst { object, material } = this;\n\n\t\tlet cacheKey = material.customProgramCacheKey();\n\n\t\tfor ( const property of getKeys( material ) ) {\n\n\t\t\tif ( /^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test( property ) ) continue;\n\n\t\t\tconst value = material[ property ];\n\n\t\t\tlet valueKey;\n\n\t\t\tif ( value !== null ) {\n\n\t\t\t\t// some material values require a formatting\n\n\t\t\t\tconst type = typeof value;\n\n\t\t\t\tif ( type === 'number' ) {\n\n\t\t\t\t\tvalueKey = value !== 0 ? '1' : '0'; // Convert to on/off, important for clearcoat, transmission, etc\n\n\t\t\t\t} else if ( type === 'object' ) {\n\n\t\t\t\t\tvalueKey = '{';\n\n\t\t\t\t\tif ( value.isTexture ) {\n\n\t\t\t\t\t\tvalueKey += value.mapping;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvalueKey += '}';\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvalueKey = String( value );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tvalueKey = String( value );\n\n\t\t\t}\n\n\t\t\tcacheKey += /*property + ':' +*/ valueKey + ',';\n\n\t\t}\n\n\t\tcacheKey += this.clippingContextCacheKey + ',';\n\n\t\tif ( object.geometry ) {\n\n\t\t\tcacheKey += this.getGeometryCacheKey();\n\n\t\t}\n\n\t\tif ( object.skeleton ) {\n\n\t\t\tcacheKey += object.skeleton.bones.length + ',';\n\n\t\t}\n\n\t\tif ( object.morphTargetInfluences ) {\n\n\t\t\tcacheKey += object.morphTargetInfluences.length + ',';\n\n\t\t}\n\n\t\tif ( object.isBatchedMesh ) {\n\n\t\t\tcacheKey += object._matricesTexture.uuid + ',';\n\n\t\t\tif ( object._colorsTexture !== null ) {\n\n\t\t\t\tcacheKey += object._colorsTexture.uuid + ',';\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( object.count > 1 ) {\n\n\t\t\t// TODO: https://github.com/mrdoob/three.js/pull/29066#issuecomment-2269400850\n\n\t\t\tcacheKey += object.uuid + ',';\n\n\t\t}\n\n\t\tcacheKey += object.receiveShadow + ',';\n\n\t\treturn hashString( cacheKey );\n\n\t}\n\n\tget needsGeometryUpdate() {\n\n\t\treturn this.geometry.id !== this.object.geometry.id;\n\n\t}\n\n\tget needsUpdate() {\n\n\t\treturn /*this.object.static !== true &&*/ ( this.initialNodesCacheKey !== this.getDynamicCacheKey() || this.clippingNeedsUpdate );\n\n\t}\n\n\tgetDynamicCacheKey() {\n\n\t\t// Environment Nodes Cache Key\n\n\t\tlet cacheKey = this._nodes.getCacheKey( this.scene, this.lightsNode );\n\n\t\tif ( this.object.receiveShadow ) {\n\n\t\t\tcacheKey += 1;\n\n\t\t}\n\n\t\treturn cacheKey;\n\n\t}\n\n\tgetCacheKey() {\n\n\t\treturn this.getMaterialCacheKey() + this.getDynamicCacheKey();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.material.removeEventListener( 'dispose', this.onMaterialDispose );\n\n\t\tthis.onDispose();\n\n\t}\n\n}\n\nconst chainArray = [];\n\nclass RenderObjects {\n\n\tconstructor( renderer, nodes, geometries, pipelines, bindings, info ) {\n\n\t\tthis.renderer = renderer;\n\t\tthis.nodes = nodes;\n\t\tthis.geometries = geometries;\n\t\tthis.pipelines = pipelines;\n\t\tthis.bindings = bindings;\n\t\tthis.info = info;\n\n\t\tthis.chainMaps = {};\n\n\t}\n\n\tget( object, material, scene, camera, lightsNode, renderContext, clippingContext, passId ) {\n\n\t\tconst chainMap = this.getChainMap( passId );\n\n\t\t// reuse chainArray\n\t\tchainArray[ 0 ] = object;\n\t\tchainArray[ 1 ] = material;\n\t\tchainArray[ 2 ] = renderContext;\n\t\tchainArray[ 3 ] = lightsNode;\n\n\t\tlet renderObject = chainMap.get( chainArray );\n\n\t\tif ( renderObject === undefined ) {\n\n\t\t\trenderObject = this.createRenderObject( this.nodes, this.geometries, this.renderer, object, material, scene, camera, lightsNode, renderContext, clippingContext, passId );\n\n\t\t\tchainMap.set( chainArray, renderObject );\n\n\t\t} else {\n\n\t\t\trenderObject.updateClipping( clippingContext );\n\n\t\t\tif ( renderObject.needsGeometryUpdate ) {\n\n\t\t\t\trenderObject.setGeometry( object.geometry );\n\n\t\t\t}\n\n\t\t\tif ( renderObject.version !== material.version || renderObject.needsUpdate ) {\n\n\t\t\t\tif ( renderObject.initialCacheKey !== renderObject.getCacheKey() ) {\n\n\t\t\t\t\trenderObject.dispose();\n\n\t\t\t\t\trenderObject = this.get( object, material, scene, camera, lightsNode, renderContext, clippingContext, passId );\n\n\t\t\t\t} else {\n\n\t\t\t\t\trenderObject.version = material.version;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn renderObject;\n\n\t}\n\n\tgetChainMap( passId = 'default' ) {\n\n\t\treturn this.chainMaps[ passId ] || ( this.chainMaps[ passId ] = new ChainMap() );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.chainMaps = {};\n\n\t}\n\n\tcreateRenderObject( nodes, geometries, renderer, object, material, scene, camera, lightsNode, renderContext, clippingContext, passId ) {\n\n\t\tconst chainMap = this.getChainMap( passId );\n\n\t\tconst renderObject = new RenderObject( nodes, geometries, renderer, object, material, scene, camera, lightsNode, renderContext, clippingContext );\n\n\t\trenderObject.onDispose = () => {\n\n\t\t\tthis.pipelines.delete( renderObject );\n\t\t\tthis.bindings.delete( renderObject );\n\t\t\tthis.nodes.delete( renderObject );\n\n\t\t\tchainMap.delete( renderObject.getChainArray() );\n\n\t\t};\n\n\t\treturn renderObject;\n\n\t}\n\n\n}\n\nclass DataMap {\n\n\tconstructor() {\n\n\t\tthis.data = new WeakMap();\n\n\t}\n\n\tget( object ) {\n\n\t\tlet map = this.data.get( object );\n\n\t\tif ( map === undefined ) {\n\n\t\t\tmap = {};\n\t\t\tthis.data.set( object, map );\n\n\t\t}\n\n\t\treturn map;\n\n\t}\n\n\tdelete( object ) {\n\n\t\tlet map;\n\n\t\tif ( this.data.has( object ) ) {\n\n\t\t\tmap = this.data.get( object );\n\n\t\t\tthis.data.delete( object );\n\n\t\t}\n\n\t\treturn map;\n\n\t}\n\n\thas( object ) {\n\n\t\treturn this.data.has( object );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.data = new WeakMap();\n\n\t}\n\n}\n\nconst AttributeType = {\n\tVERTEX: 1,\n\tINDEX: 2,\n\tSTORAGE: 3,\n\tINDIRECT: 4\n};\n\n// size of a chunk in bytes (STD140 layout)\n\nconst GPU_CHUNK_BYTES = 16;\n\n// @TODO: Move to src/constants.js\n\nconst BlendColorFactor = 211;\nconst OneMinusBlendColorFactor = 212;\n\nclass Attributes extends DataMap {\n\n\tconstructor( backend ) {\n\n\t\tsuper();\n\n\t\tthis.backend = backend;\n\n\t}\n\n\tdelete( attribute ) {\n\n\t\tconst attributeData = super.delete( attribute );\n\n\t\tif ( attributeData !== undefined ) {\n\n\t\t\tthis.backend.destroyAttribute( attribute );\n\n\t\t}\n\n\t\treturn attributeData;\n\n\t}\n\n\tupdate( attribute, type ) {\n\n\t\tconst data = this.get( attribute );\n\n\t\tif ( data.version === undefined ) {\n\n\t\t\tif ( type === AttributeType.VERTEX ) {\n\n\t\t\t\tthis.backend.createAttribute( attribute );\n\n\t\t\t} else if ( type === AttributeType.INDEX ) {\n\n\t\t\t\tthis.backend.createIndexAttribute( attribute );\n\n\t\t\t} else if ( type === AttributeType.STORAGE ) {\n\n\t\t\t\tthis.backend.createStorageAttribute( attribute );\n\n\t\t\t} else if ( type === AttributeType.INDIRECT ) {\n\n\t\t\t\tthis.backend.createIndirectStorageAttribute( attribute );\n\n\t\t\t}\n\n\t\t\tdata.version = this._getBufferAttribute( attribute ).version;\n\n\t\t} else {\n\n\t\t\tconst bufferAttribute = this._getBufferAttribute( attribute );\n\n\t\t\tif ( data.version < bufferAttribute.version || bufferAttribute.usage === DynamicDrawUsage ) {\n\n\t\t\t\tthis.backend.updateAttribute( attribute );\n\n\t\t\t\tdata.version = bufferAttribute.version;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_getBufferAttribute( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\treturn attribute;\n\n\t}\n\n}\n\nfunction arrayNeedsUint32( array ) {\n\n\t// assumes larger values usually on last\n\n\tfor ( let i = array.length - 1; i >= 0; -- i ) {\n\n\t\tif ( array[ i ] >= 65535 ) return true; // account for PRIMITIVE_RESTART_FIXED_INDEX, #24565\n\n\t}\n\n\treturn false;\n\n}\n\nfunction getWireframeVersion( geometry ) {\n\n\treturn ( geometry.index !== null ) ? geometry.index.version : geometry.attributes.position.version;\n\n}\n\nfunction getWireframeIndex( geometry ) {\n\n\tconst indices = [];\n\n\tconst geometryIndex = geometry.index;\n\tconst geometryPosition = geometry.attributes.position;\n\n\tif ( geometryIndex !== null ) {\n\n\t\tconst array = geometryIndex.array;\n\n\t\tfor ( let i = 0, l = array.length; i < l; i += 3 ) {\n\n\t\t\tconst a = array[ i + 0 ];\n\t\t\tconst b = array[ i + 1 ];\n\t\t\tconst c = array[ i + 2 ];\n\n\t\t\tindices.push( a, b, b, c, c, a );\n\n\t\t}\n\n\t} else {\n\n\t\tconst array = geometryPosition.array;\n\n\t\tfor ( let i = 0, l = ( array.length / 3 ) - 1; i < l; i += 3 ) {\n\n\t\t\tconst a = i + 0;\n\t\t\tconst b = i + 1;\n\t\t\tconst c = i + 2;\n\n\t\t\tindices.push( a, b, b, c, c, a );\n\n\t\t}\n\n\t}\n\n\tconst attribute = new ( arrayNeedsUint32( indices ) ? Uint32BufferAttribute : Uint16BufferAttribute )( indices, 1 );\n\tattribute.version = getWireframeVersion( geometry );\n\n\treturn attribute;\n\n}\n\nclass Geometries extends DataMap {\n\n\tconstructor( attributes, info ) {\n\n\t\tsuper();\n\n\t\tthis.attributes = attributes;\n\t\tthis.info = info;\n\n\t\tthis.wireframes = new WeakMap();\n\n\t\tthis.attributeCall = new WeakMap();\n\n\t}\n\n\thas( renderObject ) {\n\n\t\tconst geometry = renderObject.geometry;\n\n\t\treturn super.has( geometry ) && this.get( geometry ).initialized === true;\n\n\t}\n\n\tupdateForRender( renderObject ) {\n\n\t\tif ( this.has( renderObject ) === false ) this.initGeometry( renderObject );\n\n\t\tthis.updateAttributes( renderObject );\n\n\t}\n\n\tinitGeometry( renderObject ) {\n\n\t\tconst geometry = renderObject.geometry;\n\t\tconst geometryData = this.get( geometry );\n\n\t\tgeometryData.initialized = true;\n\n\t\tthis.info.memory.geometries ++;\n\n\t\tconst onDispose = () => {\n\n\t\t\tthis.info.memory.geometries --;\n\n\t\t\tconst index = geometry.index;\n\t\t\tconst geometryAttributes = renderObject.getAttributes();\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tthis.attributes.delete( index );\n\n\t\t\t}\n\n\t\t\tfor ( const geometryAttribute of geometryAttributes ) {\n\n\t\t\t\tthis.attributes.delete( geometryAttribute );\n\n\t\t\t}\n\n\t\t\tconst wireframeAttribute = this.wireframes.get( geometry );\n\n\t\t\tif ( wireframeAttribute !== undefined ) {\n\n\t\t\t\tthis.attributes.delete( wireframeAttribute );\n\n\t\t\t}\n\n\t\t\tgeometry.removeEventListener( 'dispose', onDispose );\n\n\t\t};\n\n\t\tgeometry.addEventListener( 'dispose', onDispose );\n\n\t}\n\n\tupdateAttributes( renderObject ) {\n\n\t\t// attributes\n\n\t\tconst attributes = renderObject.getAttributes();\n\n\t\tfor ( const attribute of attributes ) {\n\n\t\t\tif ( attribute.isStorageBufferAttribute || attribute.isStorageInstancedBufferAttribute ) {\n\n\t\t\t\tthis.updateAttribute( attribute, AttributeType.STORAGE );\n\n\t\t\t} else {\n\n\t\t\t\tthis.updateAttribute( attribute, AttributeType.VERTEX );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// indexes\n\n\t\tconst index = this.getIndex( renderObject );\n\n\t\tif ( index !== null ) {\n\n\t\t\tthis.updateAttribute( index, AttributeType.INDEX );\n\n\t\t}\n\n\t\t// indirect\n\n\t\tconst indirect = renderObject.geometry.indirect;\n\n\t\tif ( indirect !== null ) {\n\n\t\t\tthis.updateAttribute( indirect, AttributeType.INDIRECT );\n\n\t\t}\n\n\t}\n\n\tupdateAttribute( attribute, type ) {\n\n\t\tconst callId = this.info.render.calls;\n\n\t\tif ( ! attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tif ( this.attributeCall.get( attribute ) !== callId ) {\n\n\t\t\t\tthis.attributes.update( attribute, type );\n\n\t\t\t\tthis.attributeCall.set( attribute, callId );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( this.attributeCall.get( attribute ) === undefined ) {\n\n\t\t\t\tthis.attributes.update( attribute, type );\n\n\t\t\t\tthis.attributeCall.set( attribute, callId );\n\n\t\t\t} else if ( this.attributeCall.get( attribute.data ) !== callId ) {\n\n\t\t\t\tthis.attributes.update( attribute, type );\n\n\t\t\t\tthis.attributeCall.set( attribute.data, callId );\n\n\t\t\t\tthis.attributeCall.set( attribute, callId );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgetIndirect( renderObject ) {\n\n\t\treturn renderObject.geometry.indirect;\n\n\t}\n\n\tgetIndex( renderObject ) {\n\n\t\tconst { geometry, material } = renderObject;\n\n\t\tlet index = geometry.index;\n\n\t\tif ( material.wireframe === true ) {\n\n\t\t\tconst wireframes = this.wireframes;\n\n\t\t\tlet wireframeAttribute = wireframes.get( geometry );\n\n\t\t\tif ( wireframeAttribute === undefined ) {\n\n\t\t\t\twireframeAttribute = getWireframeIndex( geometry );\n\n\t\t\t\twireframes.set( geometry, wireframeAttribute );\n\n\t\t\t} else if ( wireframeAttribute.version !== getWireframeVersion( geometry ) ) {\n\n\t\t\t\tthis.attributes.delete( wireframeAttribute );\n\n\t\t\t\twireframeAttribute = getWireframeIndex( geometry );\n\n\t\t\t\twireframes.set( geometry, wireframeAttribute );\n\n\t\t\t}\n\n\t\t\tindex = wireframeAttribute;\n\n\t\t}\n\n\t\treturn index;\n\n\t}\n\n}\n\nclass Info {\n\n\tconstructor() {\n\n\t\tthis.autoReset = true;\n\n\t\tthis.frame = 0;\n\t\tthis.calls = 0;\n\n\t\tthis.render = {\n\t\t\tcalls: 0,\n\t\t\tframeCalls: 0,\n\t\t\tdrawCalls: 0,\n\t\t\ttriangles: 0,\n\t\t\tpoints: 0,\n\t\t\tlines: 0,\n\t\t\ttimestamp: 0,\n\t\t\tpreviousFrameCalls: 0,\n\t\t\ttimestampCalls: 0\n\t\t};\n\n\t\tthis.compute = {\n\t\t\tcalls: 0,\n\t\t\tframeCalls: 0,\n\t\t\ttimestamp: 0,\n\t\t\tpreviousFrameCalls: 0,\n\t\t\ttimestampCalls: 0\n\t\t};\n\n\t\tthis.memory = {\n\t\t\tgeometries: 0,\n\t\t\ttextures: 0\n\t\t};\n\n\t}\n\n\tupdate( object, count, instanceCount ) {\n\n\t\tthis.render.drawCalls ++;\n\n\t\tif ( object.isMesh || object.isSprite ) {\n\n\t\t\tthis.render.triangles += instanceCount * ( count / 3 );\n\n\t\t} else if ( object.isPoints ) {\n\n\t\t\tthis.render.points += instanceCount * count;\n\n\t\t} else if ( object.isLineSegments ) {\n\n\t\t\tthis.render.lines += instanceCount * ( count / 2 );\n\n\t\t} else if ( object.isLine ) {\n\n\t\t\tthis.render.lines += instanceCount * ( count - 1 );\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.WebGPUInfo: Unknown object type.' );\n\n\t\t}\n\n\t}\n\n\tupdateTimestamp( type, time ) {\n\n\t\tif ( this[ type ].timestampCalls === 0 ) {\n\n\t\t\tthis[ type ].timestamp = 0;\n\n\t\t}\n\n\n\t\tthis[ type ].timestamp += time;\n\n\t\tthis[ type ].timestampCalls ++;\n\n\n\t\tif ( this[ type ].timestampCalls >= this[ type ].previousFrameCalls ) {\n\n\t\t\tthis[ type ].timestampCalls = 0;\n\n\t\t}\n\n\n\t}\n\n\treset() {\n\n\t\tconst previousRenderFrameCalls = this.render.frameCalls;\n\t\tthis.render.previousFrameCalls = previousRenderFrameCalls;\n\n\t\tconst previousComputeFrameCalls = this.compute.frameCalls;\n\t\tthis.compute.previousFrameCalls = previousComputeFrameCalls;\n\n\n\t\tthis.render.drawCalls = 0;\n\t\tthis.render.frameCalls = 0;\n\t\tthis.compute.frameCalls = 0;\n\n\t\tthis.render.triangles = 0;\n\t\tthis.render.points = 0;\n\t\tthis.render.lines = 0;\n\n\n\t}\n\n\tdispose() {\n\n\t\tthis.reset();\n\n\t\tthis.calls = 0;\n\n\t\tthis.render.calls = 0;\n\t\tthis.compute.calls = 0;\n\n\t\tthis.render.timestamp = 0;\n\t\tthis.compute.timestamp = 0;\n\t\tthis.memory.geometries = 0;\n\t\tthis.memory.textures = 0;\n\n\t}\n\n}\n\nclass Pipeline {\n\n\tconstructor( cacheKey ) {\n\n\t\tthis.cacheKey = cacheKey;\n\n\t\tthis.usedTimes = 0;\n\n\t}\n\n}\n\nclass RenderPipeline extends Pipeline {\n\n\tconstructor( cacheKey, vertexProgram, fragmentProgram ) {\n\n\t\tsuper( cacheKey );\n\n\t\tthis.vertexProgram = vertexProgram;\n\t\tthis.fragmentProgram = fragmentProgram;\n\n\t}\n\n}\n\nclass ComputePipeline extends Pipeline {\n\n\tconstructor( cacheKey, computeProgram ) {\n\n\t\tsuper( cacheKey );\n\n\t\tthis.computeProgram = computeProgram;\n\n\t\tthis.isComputePipeline = true;\n\n\t}\n\n}\n\nlet _id$6 = 0;\n\nclass ProgrammableStage {\n\n\tconstructor( code, type, transforms = null, attributes = null ) {\n\n\t\tthis.id = _id$6 ++;\n\n\t\tthis.code = code;\n\t\tthis.stage = type;\n\t\tthis.transforms = transforms;\n\t\tthis.attributes = attributes;\n\n\t\tthis.usedTimes = 0;\n\n\t}\n\n}\n\nclass Pipelines extends DataMap {\n\n\tconstructor( backend, nodes ) {\n\n\t\tsuper();\n\n\t\tthis.backend = backend;\n\t\tthis.nodes = nodes;\n\n\t\tthis.bindings = null; // set by the bindings\n\n\t\tthis.caches = new Map();\n\t\tthis.programs = {\n\t\t\tvertex: new Map(),\n\t\t\tfragment: new Map(),\n\t\t\tcompute: new Map()\n\t\t};\n\n\t}\n\n\tgetForCompute( computeNode, bindings ) {\n\n\t\tconst { backend } = this;\n\n\t\tconst data = this.get( computeNode );\n\n\t\tif ( this._needsComputeUpdate( computeNode ) ) {\n\n\t\t\tconst previousPipeline = data.pipeline;\n\n\t\t\tif ( previousPipeline ) {\n\n\t\t\t\tpreviousPipeline.usedTimes --;\n\t\t\t\tpreviousPipeline.computeProgram.usedTimes --;\n\n\t\t\t}\n\n\t\t\t// get shader\n\n\t\t\tconst nodeBuilderState = this.nodes.getForCompute( computeNode );\n\n\t\t\t// programmable stage\n\n\t\t\tlet stageCompute = this.programs.compute.get( nodeBuilderState.computeShader );\n\n\t\t\tif ( stageCompute === undefined ) {\n\n\t\t\t\tif ( previousPipeline && previousPipeline.computeProgram.usedTimes === 0 ) this._releaseProgram( previousPipeline.computeProgram );\n\n\t\t\t\tstageCompute = new ProgrammableStage( nodeBuilderState.computeShader, 'compute', nodeBuilderState.transforms, nodeBuilderState.nodeAttributes );\n\t\t\t\tthis.programs.compute.set( nodeBuilderState.computeShader, stageCompute );\n\n\t\t\t\tbackend.createProgram( stageCompute );\n\n\t\t\t}\n\n\t\t\t// determine compute pipeline\n\n\t\t\tconst cacheKey = this._getComputeCacheKey( computeNode, stageCompute );\n\n\t\t\tlet pipeline = this.caches.get( cacheKey );\n\n\t\t\tif ( pipeline === undefined ) {\n\n\t\t\t\tif ( previousPipeline && previousPipeline.usedTimes === 0 ) this._releasePipeline( previousPipeline );\n\n\t\t\t\tpipeline = this._getComputePipeline( computeNode, stageCompute, cacheKey, bindings );\n\n\t\t\t}\n\n\t\t\t// keep track of all used times\n\n\t\t\tpipeline.usedTimes ++;\n\t\t\tstageCompute.usedTimes ++;\n\n\t\t\t//\n\n\t\t\tdata.version = computeNode.version;\n\t\t\tdata.pipeline = pipeline;\n\n\t\t}\n\n\t\treturn data.pipeline;\n\n\t}\n\n\tgetForRender( renderObject, promises = null ) {\n\n\t\tconst { backend } = this;\n\n\t\tconst data = this.get( renderObject );\n\n\t\tif ( this._needsRenderUpdate( renderObject ) ) {\n\n\t\t\tconst previousPipeline = data.pipeline;\n\n\t\t\tif ( previousPipeline ) {\n\n\t\t\t\tpreviousPipeline.usedTimes --;\n\t\t\t\tpreviousPipeline.vertexProgram.usedTimes --;\n\t\t\t\tpreviousPipeline.fragmentProgram.usedTimes --;\n\n\t\t\t}\n\n\t\t\t// get shader\n\n\t\t\tconst nodeBuilderState = renderObject.getNodeBuilderState();\n\n\t\t\t// programmable stages\n\n\t\t\tlet stageVertex = this.programs.vertex.get( nodeBuilderState.vertexShader );\n\n\t\t\tif ( stageVertex === undefined ) {\n\n\t\t\t\tif ( previousPipeline && previousPipeline.vertexProgram.usedTimes === 0 ) this._releaseProgram( previousPipeline.vertexProgram );\n\n\t\t\t\tstageVertex = new ProgrammableStage( nodeBuilderState.vertexShader, 'vertex' );\n\t\t\t\tthis.programs.vertex.set( nodeBuilderState.vertexShader, stageVertex );\n\n\t\t\t\tbackend.createProgram( stageVertex );\n\n\t\t\t}\n\n\t\t\tlet stageFragment = this.programs.fragment.get( nodeBuilderState.fragmentShader );\n\n\t\t\tif ( stageFragment === undefined ) {\n\n\t\t\t\tif ( previousPipeline && previousPipeline.fragmentProgram.usedTimes === 0 ) this._releaseProgram( previousPipeline.fragmentProgram );\n\n\t\t\t\tstageFragment = new ProgrammableStage( nodeBuilderState.fragmentShader, 'fragment' );\n\t\t\t\tthis.programs.fragment.set( nodeBuilderState.fragmentShader, stageFragment );\n\n\t\t\t\tbackend.createProgram( stageFragment );\n\n\t\t\t}\n\n\t\t\t// determine render pipeline\n\n\t\t\tconst cacheKey = this._getRenderCacheKey( renderObject, stageVertex, stageFragment );\n\n\t\t\tlet pipeline = this.caches.get( cacheKey );\n\n\t\t\tif ( pipeline === undefined ) {\n\n\t\t\t\tif ( previousPipeline && previousPipeline.usedTimes === 0 ) this._releasePipeline( previousPipeline );\n\n\t\t\t\tpipeline = this._getRenderPipeline( renderObject, stageVertex, stageFragment, cacheKey, promises );\n\n\t\t\t} else {\n\n\t\t\t\trenderObject.pipeline = pipeline;\n\n\t\t\t}\n\n\t\t\t// keep track of all used times\n\n\t\t\tpipeline.usedTimes ++;\n\t\t\tstageVertex.usedTimes ++;\n\t\t\tstageFragment.usedTimes ++;\n\n\t\t\t//\n\n\t\t\tdata.pipeline = pipeline;\n\n\t\t}\n\n\t\treturn data.pipeline;\n\n\t}\n\n\tdelete( object ) {\n\n\t\tconst pipeline = this.get( object ).pipeline;\n\n\t\tif ( pipeline ) {\n\n\t\t\t// pipeline\n\n\t\t\tpipeline.usedTimes --;\n\n\t\t\tif ( pipeline.usedTimes === 0 ) this._releasePipeline( pipeline );\n\n\t\t\t// programs\n\n\t\t\tif ( pipeline.isComputePipeline ) {\n\n\t\t\t\tpipeline.computeProgram.usedTimes --;\n\n\t\t\t\tif ( pipeline.computeProgram.usedTimes === 0 ) this._releaseProgram( pipeline.computeProgram );\n\n\t\t\t} else {\n\n\t\t\t\tpipeline.fragmentProgram.usedTimes --;\n\t\t\t\tpipeline.vertexProgram.usedTimes --;\n\n\t\t\t\tif ( pipeline.vertexProgram.usedTimes === 0 ) this._releaseProgram( pipeline.vertexProgram );\n\t\t\t\tif ( pipeline.fragmentProgram.usedTimes === 0 ) this._releaseProgram( pipeline.fragmentProgram );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn super.delete( object );\n\n\t}\n\n\tdispose() {\n\n\t\tsuper.dispose();\n\n\t\tthis.caches = new Map();\n\t\tthis.programs = {\n\t\t\tvertex: new Map(),\n\t\t\tfragment: new Map(),\n\t\t\tcompute: new Map()\n\t\t};\n\n\t}\n\n\tupdateForRender( renderObject ) {\n\n\t\tthis.getForRender( renderObject );\n\n\t}\n\n\t_getComputePipeline( computeNode, stageCompute, cacheKey, bindings ) {\n\n\t\t// check for existing pipeline\n\n\t\tcacheKey = cacheKey || this._getComputeCacheKey( computeNode, stageCompute );\n\n\t\tlet pipeline = this.caches.get( cacheKey );\n\n\t\tif ( pipeline === undefined ) {\n\n\t\t\tpipeline = new ComputePipeline( cacheKey, stageCompute );\n\n\t\t\tthis.caches.set( cacheKey, pipeline );\n\n\t\t\tthis.backend.createComputePipeline( pipeline, bindings );\n\n\t\t}\n\n\t\treturn pipeline;\n\n\t}\n\n\t_getRenderPipeline( renderObject, stageVertex, stageFragment, cacheKey, promises ) {\n\n\t\t// check for existing pipeline\n\n\t\tcacheKey = cacheKey || this._getRenderCacheKey( renderObject, stageVertex, stageFragment );\n\n\t\tlet pipeline = this.caches.get( cacheKey );\n\n\t\tif ( pipeline === undefined ) {\n\n\t\t\tpipeline = new RenderPipeline( cacheKey, stageVertex, stageFragment );\n\n\t\t\tthis.caches.set( cacheKey, pipeline );\n\n\t\t\trenderObject.pipeline = pipeline;\n\n\t\t\tthis.backend.createRenderPipeline( renderObject, promises );\n\n\t\t}\n\n\t\treturn pipeline;\n\n\t}\n\n\t_getComputeCacheKey( computeNode, stageCompute ) {\n\n\t\treturn computeNode.id + ',' + stageCompute.id;\n\n\t}\n\n\t_getRenderCacheKey( renderObject, stageVertex, stageFragment ) {\n\n\t\treturn stageVertex.id + ',' + stageFragment.id + ',' + this.backend.getRenderCacheKey( renderObject );\n\n\t}\n\n\t_releasePipeline( pipeline ) {\n\n\t\tthis.caches.delete( pipeline.cacheKey );\n\n\t}\n\n\t_releaseProgram( program ) {\n\n\t\tconst code = program.code;\n\t\tconst stage = program.stage;\n\n\t\tthis.programs[ stage ].delete( code );\n\n\t}\n\n\t_needsComputeUpdate( computeNode ) {\n\n\t\tconst data = this.get( computeNode );\n\n\t\treturn data.pipeline === undefined || data.version !== computeNode.version;\n\n\t}\n\n\t_needsRenderUpdate( renderObject ) {\n\n\t\tconst data = this.get( renderObject );\n\n\t\treturn data.pipeline === undefined || this.backend.needsRenderUpdate( renderObject );\n\n\t}\n\n}\n\nclass Bindings extends DataMap {\n\n\tconstructor( backend, nodes, textures, attributes, pipelines, info ) {\n\n\t\tsuper();\n\n\t\tthis.backend = backend;\n\t\tthis.textures = textures;\n\t\tthis.pipelines = pipelines;\n\t\tthis.attributes = attributes;\n\t\tthis.nodes = nodes;\n\t\tthis.info = info;\n\n\t\tthis.pipelines.bindings = this; // assign bindings to pipelines\n\n\t}\n\n\tgetForRender( renderObject ) {\n\n\t\tconst bindings = renderObject.getBindings();\n\n\t\tfor ( const bindGroup of bindings ) {\n\n\t\t\tconst groupData = this.get( bindGroup );\n\n\t\t\tif ( groupData.bindGroup === undefined ) {\n\n\t\t\t\t// each object defines an array of bindings (ubos, textures, samplers etc.)\n\n\t\t\t\tthis._init( bindGroup );\n\n\t\t\t\tthis.backend.createBindings( bindGroup, bindings, 0 );\n\n\t\t\t\tgroupData.bindGroup = bindGroup;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bindings;\n\n\t}\n\n\tgetForCompute( computeNode ) {\n\n\t\tconst bindings = this.nodes.getForCompute( computeNode ).bindings;\n\n\t\tfor ( const bindGroup of bindings ) {\n\n\t\t\tconst groupData = this.get( bindGroup );\n\n\t\t\tif ( groupData.bindGroup === undefined ) {\n\n\t\t\t\tthis._init( bindGroup );\n\n\t\t\t\tthis.backend.createBindings( bindGroup, bindings, 0 );\n\n\t\t\t\tgroupData.bindGroup = bindGroup;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bindings;\n\n\t}\n\n\tupdateForCompute( computeNode ) {\n\n\t\tthis._updateBindings( this.getForCompute( computeNode ) );\n\n\t}\n\n\tupdateForRender( renderObject ) {\n\n\t\tthis._updateBindings( this.getForRender( renderObject ) );\n\n\t}\n\n\t_updateBindings( bindings ) {\n\n\t\tfor ( const bindGroup of bindings ) {\n\n\t\t\tthis._update( bindGroup, bindings );\n\n\t\t}\n\n\t}\n\n\t_init( bindGroup ) {\n\n\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\tif ( binding.isSampledTexture ) {\n\n\t\t\t\tthis.textures.updateTexture( binding.texture );\n\n\t\t\t} else if ( binding.isStorageBuffer ) {\n\n\t\t\t\tconst attribute = binding.attribute;\n\t\t\t\tconst attributeType = attribute.isIndirectStorageBufferAttribute ? AttributeType.INDIRECT : AttributeType.STORAGE;\n\n\t\t\t\tthis.attributes.update( attribute, attributeType );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_update( bindGroup, bindings ) {\n\n\t\tconst { backend } = this;\n\n\t\tlet needsBindingsUpdate = false;\n\t\tlet cacheBindings = true;\n\t\tlet cacheIndex = 0;\n\t\tlet version = 0;\n\n\t\t// iterate over all bindings and check if buffer updates or a new binding group is required\n\n\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\tif ( binding.isNodeUniformsGroup ) {\n\n\t\t\t\tconst updated = this.nodes.updateGroup( binding );\n\n\t\t\t\tif ( ! updated ) continue;\n\n\t\t\t}\n\n\t\t\tif ( binding.isUniformBuffer ) {\n\n\t\t\t\tconst updated = binding.update();\n\n\t\t\t\tif ( updated ) {\n\n\t\t\t\t\tbackend.updateBinding( binding );\n\n\t\t\t\t}\n\n\t\t\t} else if ( binding.isSampler ) {\n\n\t\t\t\tbinding.update();\n\n\t\t\t} else if ( binding.isSampledTexture ) {\n\n\t\t\t\tconst texturesTextureData = this.textures.get( binding.texture );\n\n\t\t\t\tif ( binding.needsBindingsUpdate( texturesTextureData.generation ) ) needsBindingsUpdate = true;\n\n\t\t\t\tconst updated = binding.update();\n\n\t\t\t\tconst texture = binding.texture;\n\n\t\t\t\tif ( updated ) {\n\n\t\t\t\t\tthis.textures.updateTexture( texture );\n\n\t\t\t\t}\n\n\t\t\t\tconst textureData = backend.get( texture );\n\n\t\t\t\tif ( textureData.externalTexture !== undefined || texturesTextureData.isDefaultTexture ) {\n\n\t\t\t\t\tcacheBindings = false;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcacheIndex = cacheIndex * 10 + texture.id;\n\t\t\t\t\tversion += texture.version;\n\n\t\t\t\t}\n\n\t\t\t\tif ( backend.isWebGPUBackend === true && textureData.texture === undefined && textureData.externalTexture === undefined ) {\n\n\t\t\t\t\t// TODO: Remove this once we found why updated === false isn't bound to a texture in the WebGPU backend\n\t\t\t\t\tconsole.error( 'Bindings._update: binding should be available:', binding, updated, texture, binding.textureNode.value, needsBindingsUpdate );\n\n\t\t\t\t\tthis.textures.updateTexture( texture );\n\t\t\t\t\tneedsBindingsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t\tif ( texture.isStorageTexture === true ) {\n\n\t\t\t\t\tconst textureData = this.get( texture );\n\n\t\t\t\t\tif ( binding.store === true ) {\n\n\t\t\t\t\t\ttextureData.needsMipmap = true;\n\n\t\t\t\t\t} else if ( this.textures.needsMipmaps( texture ) && textureData.needsMipmap === true ) {\n\n\t\t\t\t\t\tthis.backend.generateMipmaps( texture );\n\n\t\t\t\t\t\ttextureData.needsMipmap = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( needsBindingsUpdate === true ) {\n\n\t\t\tthis.backend.updateBindings( bindGroup, bindings, cacheBindings ? cacheIndex : 0, version );\n\n\t\t}\n\n\t}\n\n}\n\nfunction painterSortStable( a, b ) {\n\n\tif ( a.groupOrder !== b.groupOrder ) {\n\n\t\treturn a.groupOrder - b.groupOrder;\n\n\t} else if ( a.renderOrder !== b.renderOrder ) {\n\n\t\treturn a.renderOrder - b.renderOrder;\n\n\t} else if ( a.material.id !== b.material.id ) {\n\n\t\treturn a.material.id - b.material.id;\n\n\t} else if ( a.z !== b.z ) {\n\n\t\treturn a.z - b.z;\n\n\t} else {\n\n\t\treturn a.id - b.id;\n\n\t}\n\n}\n\nfunction reversePainterSortStable( a, b ) {\n\n\tif ( a.groupOrder !== b.groupOrder ) {\n\n\t\treturn a.groupOrder - b.groupOrder;\n\n\t} else if ( a.renderOrder !== b.renderOrder ) {\n\n\t\treturn a.renderOrder - b.renderOrder;\n\n\t} else if ( a.z !== b.z ) {\n\n\t\treturn b.z - a.z;\n\n\t} else {\n\n\t\treturn a.id - b.id;\n\n\t}\n\n}\n\nfunction needsDoublePass( material ) {\n\n\tconst hasTransmission = material.transmission > 0 || material.transmissionNode;\n\n\treturn hasTransmission && material.side === DoubleSide && material.forceSinglePass === false;\n\n}\n\nclass RenderList {\n\n\tconstructor( lighting, scene, camera ) {\n\n\t\tthis.renderItems = [];\n\t\tthis.renderItemsIndex = 0;\n\n\t\tthis.opaque = [];\n\t\tthis.transparentDoublePass = [];\n\t\tthis.transparent = [];\n\t\tthis.bundles = [];\n\n\t\tthis.lightsNode = lighting.getNode( scene, camera );\n\t\tthis.lightsArray = [];\n\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\n\t\tthis.occlusionQueryCount = 0;\n\n\t}\n\n\tbegin() {\n\n\t\tthis.renderItemsIndex = 0;\n\n\t\tthis.opaque.length = 0;\n\t\tthis.transparentDoublePass.length = 0;\n\t\tthis.transparent.length = 0;\n\t\tthis.bundles.length = 0;\n\n\t\tthis.lightsArray.length = 0;\n\n\t\tthis.occlusionQueryCount = 0;\n\n\t\treturn this;\n\n\t}\n\n\tgetNextRenderItem( object, geometry, material, groupOrder, z, group, clippingContext ) {\n\n\t\tlet renderItem = this.renderItems[ this.renderItemsIndex ];\n\n\t\tif ( renderItem === undefined ) {\n\n\t\t\trenderItem = {\n\t\t\t\tid: object.id,\n\t\t\t\tobject: object,\n\t\t\t\tgeometry: geometry,\n\t\t\t\tmaterial: material,\n\t\t\t\tgroupOrder: groupOrder,\n\t\t\t\trenderOrder: object.renderOrder,\n\t\t\t\tz: z,\n\t\t\t\tgroup: group,\n\t\t\t\tclippingContext: clippingContext\n\t\t\t};\n\n\t\t\tthis.renderItems[ this.renderItemsIndex ] = renderItem;\n\n\t\t} else {\n\n\t\t\trenderItem.id = object.id;\n\t\t\trenderItem.object = object;\n\t\t\trenderItem.geometry = geometry;\n\t\t\trenderItem.material = material;\n\t\t\trenderItem.groupOrder = groupOrder;\n\t\t\trenderItem.renderOrder = object.renderOrder;\n\t\t\trenderItem.z = z;\n\t\t\trenderItem.group = group;\n\t\t\trenderItem.clippingContext = clippingContext;\n\n\t\t}\n\n\t\tthis.renderItemsIndex ++;\n\n\t\treturn renderItem;\n\n\t}\n\n\tpush( object, geometry, material, groupOrder, z, group, clippingContext ) {\n\n\t\tconst renderItem = this.getNextRenderItem( object, geometry, material, groupOrder, z, group, clippingContext );\n\n\t\tif ( object.occlusionTest === true ) this.occlusionQueryCount ++;\n\n\t\tif ( material.transparent === true || material.transmission > 0 ) {\n\n\t\t\tif ( needsDoublePass( material ) ) this.transparentDoublePass.push( renderItem );\n\n\t\t\tthis.transparent.push( renderItem );\n\n\t\t} else {\n\n\t\t\tthis.opaque.push( renderItem );\n\n\t\t}\n\n\t}\n\n\tunshift( object, geometry, material, groupOrder, z, group, clippingContext ) {\n\n\t\tconst renderItem = this.getNextRenderItem( object, geometry, material, groupOrder, z, group, clippingContext );\n\n\t\tif ( material.transparent === true || material.transmission > 0 ) {\n\n\t\t\tif ( needsDoublePass( material ) ) this.transparentDoublePass.unshift( renderItem );\n\n\t\t\tthis.transparent.unshift( renderItem );\n\n\t\t} else {\n\n\t\t\tthis.opaque.unshift( renderItem );\n\n\t\t}\n\n\t}\n\n\tpushBundle( group ) {\n\n\t\tthis.bundles.push( group );\n\n\t}\n\n\tpushLight( light ) {\n\n\t\tthis.lightsArray.push( light );\n\n\t}\n\n\tsort( customOpaqueSort, customTransparentSort ) {\n\n\t\tif ( this.opaque.length > 1 ) this.opaque.sort( customOpaqueSort || painterSortStable );\n\t\tif ( this.transparentDoublePass.length > 1 ) this.transparentDoublePass.sort( customTransparentSort || reversePainterSortStable );\n\t\tif ( this.transparent.length > 1 ) this.transparent.sort( customTransparentSort || reversePainterSortStable );\n\n\t}\n\n\tfinish() {\n\n\t\t// update lights\n\n\t\tthis.lightsNode.setLights( this.lightsArray );\n\n\t\t// Clear references from inactive renderItems in the list\n\n\t\tfor ( let i = this.renderItemsIndex, il = this.renderItems.length; i < il; i ++ ) {\n\n\t\t\tconst renderItem = this.renderItems[ i ];\n\n\t\t\tif ( renderItem.id === null ) break;\n\n\t\t\trenderItem.id = null;\n\t\t\trenderItem.object = null;\n\t\t\trenderItem.geometry = null;\n\t\t\trenderItem.material = null;\n\t\t\trenderItem.groupOrder = null;\n\t\t\trenderItem.renderOrder = null;\n\t\t\trenderItem.z = null;\n\t\t\trenderItem.group = null;\n\t\t\trenderItem.clippingContext = null;\n\n\t\t}\n\n\t}\n\n}\n\nclass RenderLists {\n\n\tconstructor( lighting ) {\n\n\t\tthis.lighting = lighting;\n\n\t\tthis.lists = new ChainMap();\n\n\t}\n\n\tget( scene, camera ) {\n\n\t\tconst lists = this.lists;\n\t\tconst keys = [ scene, camera ];\n\n\t\tlet list = lists.get( keys );\n\n\t\tif ( list === undefined ) {\n\n\t\t\tlist = new RenderList( this.lighting, scene, camera );\n\t\t\tlists.set( keys, list );\n\n\t\t}\n\n\t\treturn list;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.lists = new ChainMap();\n\n\t}\n\n}\n\nlet id$1 = 0;\n\nclass RenderContext {\n\n\tconstructor() {\n\n\t\tthis.id = id$1 ++;\n\n\t\tthis.color = true;\n\t\tthis.clearColor = true;\n\t\tthis.clearColorValue = { r: 0, g: 0, b: 0, a: 1 };\n\n\t\tthis.depth = true;\n\t\tthis.clearDepth = true;\n\t\tthis.clearDepthValue = 1;\n\n\t\tthis.stencil = false;\n\t\tthis.clearStencil = true;\n\t\tthis.clearStencilValue = 1;\n\n\t\tthis.viewport = false;\n\t\tthis.viewportValue = new Vector4();\n\n\t\tthis.scissor = false;\n\t\tthis.scissorValue = new Vector4();\n\n\t\tthis.textures = null;\n\t\tthis.depthTexture = null;\n\t\tthis.activeCubeFace = 0;\n\t\tthis.sampleCount = 1;\n\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\n\t\tthis.isRenderContext = true;\n\n\t}\n\n\tgetCacheKey() {\n\n\t\treturn getCacheKey( this );\n\n\t}\n\n}\n\nfunction getCacheKey( renderContext ) {\n\n\tconst { textures, activeCubeFace } = renderContext;\n\n\tconst values = [ activeCubeFace ];\n\n\tfor ( const texture of textures ) {\n\n\t\tvalues.push( texture.id );\n\n\t}\n\n\treturn hashArray( values );\n\n}\n\nclass RenderContexts {\n\n\tconstructor() {\n\n\t\tthis.chainMaps = {};\n\n\t}\n\n\tget( scene, camera, renderTarget = null ) {\n\n\t\tconst chainKey = [ scene, camera ];\n\n\t\tlet attachmentState;\n\n\t\tif ( renderTarget === null ) {\n\n\t\t\tattachmentState = 'default';\n\n\t\t} else {\n\n\t\t\tconst format = renderTarget.texture.format;\n\t\t\tconst count = renderTarget.textures.length;\n\n\t\t\tattachmentState = `${ count }:${ format }:${ renderTarget.samples }:${ renderTarget.depthBuffer }:${ renderTarget.stencilBuffer }`;\n\n\t\t}\n\n\t\tconst chainMap = this.getChainMap( attachmentState );\n\n\t\tlet renderState = chainMap.get( chainKey );\n\n\t\tif ( renderState === undefined ) {\n\n\t\t\trenderState = new RenderContext();\n\n\t\t\tchainMap.set( chainKey, renderState );\n\n\t\t}\n\n\t\tif ( renderTarget !== null ) renderState.sampleCount = renderTarget.samples === 0 ? 1 : renderTarget.samples;\n\n\t\treturn renderState;\n\n\t}\n\n\tgetChainMap( attachmentState ) {\n\n\t\treturn this.chainMaps[ attachmentState ] || ( this.chainMaps[ attachmentState ] = new ChainMap() );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.chainMaps = {};\n\n\t}\n\n}\n\nconst _size$3 = /*@__PURE__*/ new Vector3();\n\nclass Textures extends DataMap {\n\n\tconstructor( renderer, backend, info ) {\n\n\t\tsuper();\n\n\t\tthis.renderer = renderer;\n\t\tthis.backend = backend;\n\t\tthis.info = info;\n\n\t}\n\n\tupdateRenderTarget( renderTarget, activeMipmapLevel = 0 ) {\n\n\t\tconst renderTargetData = this.get( renderTarget );\n\n\t\tconst sampleCount = renderTarget.samples === 0 ? 1 : renderTarget.samples;\n\t\tconst depthTextureMips = renderTargetData.depthTextureMips || ( renderTargetData.depthTextureMips = {} );\n\n\t\tconst textures = renderTarget.textures;\n\n\t\tconst size = this.getSize( textures[ 0 ] );\n\n\t\tconst mipWidth = size.width >> activeMipmapLevel;\n\t\tconst mipHeight = size.height >> activeMipmapLevel;\n\n\t\tlet depthTexture = renderTarget.depthTexture || depthTextureMips[ activeMipmapLevel ];\n\t\tconst useDepthTexture = renderTarget.depthBuffer === true || renderTarget.stencilBuffer === true;\n\n\t\tlet textureNeedsUpdate = false;\n\n\t\tif ( depthTexture === undefined && useDepthTexture ) {\n\n\t\t\tdepthTexture = new DepthTexture();\n\t\t\tdepthTexture.format = renderTarget.stencilBuffer ? DepthStencilFormat : DepthFormat;\n\t\t\tdepthTexture.type = renderTarget.stencilBuffer ? UnsignedInt248Type : UnsignedIntType; // FloatType\n\t\t\tdepthTexture.image.width = mipWidth;\n\t\t\tdepthTexture.image.height = mipHeight;\n\n\t\t\tdepthTextureMips[ activeMipmapLevel ] = depthTexture;\n\n\t\t}\n\n\t\tif ( renderTargetData.width !== size.width || size.height !== renderTargetData.height ) {\n\n\t\t\ttextureNeedsUpdate = true;\n\n\t\t\tif ( depthTexture ) {\n\n\t\t\t\tdepthTexture.needsUpdate = true;\n\t\t\t\tdepthTexture.image.width = mipWidth;\n\t\t\t\tdepthTexture.image.height = mipHeight;\n\n\t\t\t}\n\n\t\t}\n\n\t\trenderTargetData.width = size.width;\n\t\trenderTargetData.height = size.height;\n\t\trenderTargetData.textures = textures;\n\t\trenderTargetData.depthTexture = depthTexture || null;\n\t\trenderTargetData.depth = renderTarget.depthBuffer;\n\t\trenderTargetData.stencil = renderTarget.stencilBuffer;\n\t\trenderTargetData.renderTarget = renderTarget;\n\n\t\tif ( renderTargetData.sampleCount !== sampleCount ) {\n\n\t\t\ttextureNeedsUpdate = true;\n\n\t\t\tif ( depthTexture ) {\n\n\t\t\t\tdepthTexture.needsUpdate = true;\n\n\t\t\t}\n\n\t\t\trenderTargetData.sampleCount = sampleCount;\n\n\t\t}\n\n\t\t//\n\n\t\tconst options = { sampleCount };\n\n\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\tconst texture = textures[ i ];\n\n\t\t\tif ( textureNeedsUpdate ) texture.needsUpdate = true;\n\n\t\t\tthis.updateTexture( texture, options );\n\n\t\t}\n\n\t\tif ( depthTexture ) {\n\n\t\t\tthis.updateTexture( depthTexture, options );\n\n\t\t}\n\n\t\t// dispose handler\n\n\t\tif ( renderTargetData.initialized !== true ) {\n\n\t\t\trenderTargetData.initialized = true;\n\n\t\t\t// dispose\n\n\t\t\tconst onDispose = () => {\n\n\t\t\t\trenderTarget.removeEventListener( 'dispose', onDispose );\n\n\t\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\t\tthis._destroyTexture( textures[ i ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( depthTexture ) {\n\n\t\t\t\t\tthis._destroyTexture( depthTexture );\n\n\t\t\t\t}\n\n\t\t\t\tthis.delete( renderTarget );\n\n\t\t\t};\n\n\t\t\trenderTarget.addEventListener( 'dispose', onDispose );\n\n\t\t}\n\n\t}\n\n\tupdateTexture( texture, options = {} ) {\n\n\t\tconst textureData = this.get( texture );\n\t\tif ( textureData.initialized === true && textureData.version === texture.version ) return;\n\n\t\tconst isRenderTarget = texture.isRenderTargetTexture || texture.isDepthTexture || texture.isFramebufferTexture;\n\t\tconst backend = this.backend;\n\n\t\tif ( isRenderTarget && textureData.initialized === true ) {\n\n\t\t\t// it's an update\n\n\t\t\tbackend.destroySampler( texture );\n\t\t\tbackend.destroyTexture( texture );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( texture.isFramebufferTexture ) {\n\n\t\t\tconst renderTarget = this.renderer.getRenderTarget();\n\n\t\t\tif ( renderTarget ) {\n\n\t\t\t\ttexture.type = renderTarget.texture.type;\n\n\t\t\t} else {\n\n\t\t\t\ttexture.type = UnsignedByteType;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst { width, height, depth } = this.getSize( texture );\n\n\t\toptions.width = width;\n\t\toptions.height = height;\n\t\toptions.depth = depth;\n\t\toptions.needsMipmaps = this.needsMipmaps( texture );\n\t\toptions.levels = options.needsMipmaps ? this.getMipLevels( texture, width, height ) : 1;\n\n\t\t//\n\n\t\tif ( isRenderTarget || texture.isStorageTexture === true ) {\n\n\t\t\tbackend.createSampler( texture );\n\t\t\tbackend.createTexture( texture, options );\n\n\t\t\ttextureData.generation = texture.version;\n\n\t\t} else {\n\n\t\t\tconst needsCreate = textureData.initialized !== true;\n\n\t\t\tif ( needsCreate ) backend.createSampler( texture );\n\n\t\t\tif ( texture.version > 0 ) {\n\n\t\t\t\tconst image = texture.image;\n\n\t\t\t\tif ( image === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.Renderer: Texture marked for update but image is undefined.' );\n\n\t\t\t\t} else if ( image.complete === false ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.Renderer: Texture marked for update but image is incomplete.' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( texture.images ) {\n\n\t\t\t\t\t\tconst images = [];\n\n\t\t\t\t\t\tfor ( const image of texture.images ) {\n\n\t\t\t\t\t\t\timages.push( image );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\toptions.images = images;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\toptions.image = image;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( textureData.isDefaultTexture === undefined || textureData.isDefaultTexture === true ) {\n\n\t\t\t\t\t\tbackend.createTexture( texture, options );\n\n\t\t\t\t\t\ttextureData.isDefaultTexture = false;\n\t\t\t\t\t\ttextureData.generation = texture.version;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( texture.source.dataReady === true ) backend.updateTexture( texture, options );\n\n\t\t\t\t\tif ( options.needsMipmaps && texture.mipmaps.length === 0 ) backend.generateMipmaps( texture );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// async update\n\n\t\t\t\tbackend.createDefaultTexture( texture );\n\n\t\t\t\ttextureData.isDefaultTexture = true;\n\t\t\t\ttextureData.generation = texture.version;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// dispose handler\n\n\t\tif ( textureData.initialized !== true ) {\n\n\t\t\ttextureData.initialized = true;\n\t\t\ttextureData.generation = texture.version;\n\n\t\t\t//\n\n\t\t\tthis.info.memory.textures ++;\n\n\t\t\t// dispose\n\n\t\t\tconst onDispose = () => {\n\n\t\t\t\ttexture.removeEventListener( 'dispose', onDispose );\n\n\t\t\t\tthis._destroyTexture( texture );\n\n\t\t\t\tthis.info.memory.textures --;\n\n\t\t\t};\n\n\t\t\ttexture.addEventListener( 'dispose', onDispose );\n\n\t\t}\n\n\t\t//\n\n\t\ttextureData.version = texture.version;\n\n\t}\n\n\tgetSize( texture, target = _size$3 ) {\n\n\t\tlet image = texture.images ? texture.images[ 0 ] : texture.image;\n\n\t\tif ( image ) {\n\n\t\t\tif ( image.image !== undefined ) image = image.image;\n\n\t\t\ttarget.width = image.width || 1;\n\t\t\ttarget.height = image.height || 1;\n\t\t\ttarget.depth = texture.isCubeTexture ? 6 : ( image.depth || 1 );\n\n\t\t} else {\n\n\t\t\ttarget.width = target.height = target.depth = 1;\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n\tgetMipLevels( texture, width, height ) {\n\n\t\tlet mipLevelCount;\n\n\t\tif ( texture.isCompressedTexture ) {\n\n\t\t\tif ( texture.mipmaps ) {\n\n\t\t\t\tmipLevelCount = texture.mipmaps.length;\n\n\t\t\t} else {\n\n\t\t\t\tmipLevelCount = 1;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tmipLevelCount = Math.floor( Math.log2( Math.max( width, height ) ) ) + 1;\n\n\t\t}\n\n\t\treturn mipLevelCount;\n\n\t}\n\n\tneedsMipmaps( texture ) {\n\n\t\treturn this.isEnvironmentTexture( texture ) || texture.isCompressedTexture === true || texture.generateMipmaps;\n\n\t}\n\n\tisEnvironmentTexture( texture ) {\n\n\t\tconst mapping = texture.mapping;\n\n\t\treturn ( mapping === EquirectangularReflectionMapping || mapping === EquirectangularRefractionMapping ) || ( mapping === CubeReflectionMapping || mapping === CubeRefractionMapping );\n\n\t}\n\n\t_destroyTexture( texture ) {\n\n\t\tthis.backend.destroySampler( texture );\n\t\tthis.backend.destroyTexture( texture );\n\n\t\tthis.delete( texture );\n\n\t}\n\n}\n\nclass Color4 extends Color {\n\n\tconstructor( r, g, b, a = 1 ) {\n\n\t\tsuper( r, g, b );\n\n\t\tthis.a = a;\n\n\t}\n\n\tset( r, g, b, a = 1 ) {\n\n\t\tthis.a = a;\n\n\t\treturn super.set( r, g, b );\n\n\t}\n\n\tcopy( color ) {\n\n\t\tif ( color.a !== undefined ) this.a = color.a;\n\n\t\treturn super.copy( color );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.r, this.g, this.b, this.a );\n\n\t}\n\n}\n\nclass ParameterNode extends PropertyNode {\n\n\tstatic get type() {\n\n\t\treturn 'ParameterNode';\n\n\t}\n\n\tconstructor( nodeType, name = null ) {\n\n\t\tsuper( nodeType, name );\n\n\t\tthis.isParameterNode = true;\n\n\t}\n\n\tgetHash() {\n\n\t\treturn this.uuid;\n\n\t}\n\n\tgenerate() {\n\n\t\treturn this.name;\n\n\t}\n\n}\n\nconst parameter = ( type, name ) => nodeObject( new ParameterNode( type, name ) );\n\nclass StackNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'StackNode';\n\n\t}\n\n\tconstructor( parent = null ) {\n\n\t\tsuper();\n\n\t\tthis.nodes = [];\n\t\tthis.outputNode = null;\n\n\t\tthis.parent = parent;\n\n\t\tthis._currentCond = null;\n\n\t\tthis.isStackNode = true;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.outputNode ? this.outputNode.getNodeType( builder ) : 'void';\n\n\t}\n\n\tadd( node ) {\n\n\t\tthis.nodes.push( node );\n\n\t\treturn this;\n\n\t}\n\n\tIf( boolNode, method ) {\n\n\t\tconst methodNode = new ShaderNode( method );\n\t\tthis._currentCond = select( boolNode, methodNode );\n\n\t\treturn this.add( this._currentCond );\n\n\t}\n\n\tElseIf( boolNode, method ) {\n\n\t\tconst methodNode = new ShaderNode( method );\n\t\tconst ifNode = select( boolNode, methodNode );\n\n\t\tthis._currentCond.elseNode = ifNode;\n\t\tthis._currentCond = ifNode;\n\n\t\treturn this;\n\n\t}\n\n\tElse( method ) {\n\n\t\tthis._currentCond.elseNode = new ShaderNode( method );\n\n\t\treturn this;\n\n\t}\n\n\tbuild( builder, ...params ) {\n\n\t\tconst previousStack = getCurrentStack();\n\n\t\tsetCurrentStack( this );\n\n\t\tfor ( const node of this.nodes ) {\n\n\t\t\tnode.build( builder, 'void' );\n\n\t\t}\n\n\t\tsetCurrentStack( previousStack );\n\n\t\treturn this.outputNode ? this.outputNode.build( builder, ...params ) : super.build( builder, ...params );\n\n\t}\n\n\t//\n\n\telse( ...params ) { // @deprecated, r168\n\n\t\tconsole.warn( 'TSL.StackNode: .else() has been renamed to .Else().' );\n\t\treturn this.Else( ...params );\n\n\t}\n\n\telseif( ...params ) { // @deprecated, r168\n\n\t\tconsole.warn( 'TSL.StackNode: .elseif() has been renamed to .ElseIf().' );\n\t\treturn this.ElseIf( ...params );\n\n\t}\n\n}\n\nconst stack = /*@__PURE__*/ nodeProxy( StackNode );\n\nclass StructTypeNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'StructTypeNode';\n\n\t}\n\n\tconstructor( types ) {\n\n\t\tsuper();\n\n\t\tthis.types = types;\n\t\tthis.isStructTypeNode = true;\n\n\t}\n\n\tgetMemberTypes() {\n\n\t\treturn this.types;\n\n\t}\n\n}\n\nclass OutputStructNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'OutputStructNode';\n\n\t}\n\n\tconstructor( ...members ) {\n\n\t\tsuper();\n\n\t\tthis.members = members;\n\n\t\tthis.isOutputStructNode = true;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tconst members = this.members;\n\t\tconst types = [];\n\n\t\tfor ( let i = 0; i < members.length; i ++ ) {\n\n\t\t\ttypes.push( members[ i ].getNodeType( builder ) );\n\n\t\t}\n\n\t\tthis.nodeType = builder.getStructTypeFromNode( new StructTypeNode( types ) ).name;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst propertyName = builder.getOutputStructName();\n\t\tconst members = this.members;\n\n\t\tconst structPrefix = propertyName !== '' ? propertyName + '.' : '';\n\n\t\tfor ( let i = 0; i < members.length; i ++ ) {\n\n\t\t\tconst snippet = members[ i ].build( builder, output );\n\n\t\t\tbuilder.addLineFlowCode( `${ structPrefix }m${ i } = ${ snippet }`, this );\n\n\t\t}\n\n\t\treturn propertyName;\n\n\t}\n\n}\n\nconst outputStruct = /*@__PURE__*/ nodeProxy( OutputStructNode );\n\nfunction getTextureIndex( textures, name ) {\n\n\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\tif ( textures[ i ].name === name ) {\n\n\t\t\treturn i;\n\n\t\t}\n\n\t}\n\n\treturn - 1;\n\n}\n\nclass MRTNode extends OutputStructNode {\n\n\tstatic get type() {\n\n\t\treturn 'MRTNode';\n\n\t}\n\n\tconstructor( outputNodes ) {\n\n\t\tsuper();\n\n\t\tthis.outputNodes = outputNodes;\n\n\t\tthis.isMRTNode = true;\n\n\t}\n\n\thas( name ) {\n\n\t\treturn this.outputNodes[ name ] !== undefined;\n\n\t}\n\n\tget( name ) {\n\n\t\treturn this.outputNodes[ name ];\n\n\t}\n\n\tmerge( mrtNode ) {\n\n\t\tconst outputs = { ...this.outputNodes, ...mrtNode.outputNodes };\n\n\t\treturn mrt( outputs );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst outputNodes = this.outputNodes;\n\t\tconst mrt = builder.renderer.getRenderTarget();\n\n\t\tconst members = [];\n\n\t\tconst textures = mrt.textures;\n\n\t\tfor ( const name in outputNodes ) {\n\n\t\t\tconst index = getTextureIndex( textures, name );\n\n\t\t\tmembers[ index ] = vec4( outputNodes[ name ] );\n\n\t\t}\n\n\t\tthis.members = members;\n\n\t\treturn super.setup( builder );\n\n\t}\n\n}\n\nconst mrt = /*@__PURE__*/ nodeProxy( MRTNode );\n\nconst hash = /*@__PURE__*/ Fn( ( [ seed ] ) => {\n\n\t// Taken from https://www.shadertoy.com/view/XlGcRh, originally from pcg-random.org\n\n\tconst state = seed.toUint().mul( 747796405 ).add( 2891336453 );\n\tconst word = state.shiftRight( state.shiftRight( 28 ).add( 4 ) ).bitXor( state ).mul( 277803737 );\n\tconst result = word.shiftRight( 22 ).bitXor( word );\n\n\treturn result.toFloat().mul( 1 / 2 ** 32 ); // Convert to range [0, 1)\n\n} );\n\n// remapping functions https://iquilezles.org/articles/functions/\nconst parabola = ( x, k ) => pow( mul( 4.0, x.mul( sub( 1.0, x ) ) ), k );\nconst gain = ( x, k ) => x.lessThan( 0.5 ) ? parabola( x.mul( 2.0 ), k ).div( 2.0 ) : sub( 1.0, parabola( mul( sub( 1.0, x ), 2.0 ), k ).div( 2.0 ) );\nconst pcurve = ( x, a, b ) => pow( div( pow( x, a ), add( pow( x, a ), pow( sub( 1.0, x ), b ) ) ), 1.0 / a );\nconst sinc = ( x, k ) => sin( PI.mul( k.mul( x ).sub( 1.0 ) ) ).div( PI.mul( k.mul( x ).sub( 1.0 ) ) );\n\n// https://github.com/cabbibo/glsl-tri-noise-3d\n\n\nconst tri = /*@__PURE__*/ Fn( ( [ x ] ) => {\n\n\treturn x.fract().sub( .5 ).abs();\n\n} ).setLayout( {\n\tname: 'tri',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'x', type: 'float' }\n\t]\n} );\n\nconst tri3 = /*@__PURE__*/ Fn( ( [ p ] ) => {\n\n\treturn vec3( tri( p.z.add( tri( p.y.mul( 1. ) ) ) ), tri( p.z.add( tri( p.x.mul( 1. ) ) ) ), tri( p.y.add( tri( p.x.mul( 1. ) ) ) ) );\n\n} ).setLayout( {\n\tname: 'tri3',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' }\n\t]\n} );\n\nconst triNoise3D = /*@__PURE__*/ Fn( ( [ p_immutable, spd, time ] ) => {\n\n\tconst p = vec3( p_immutable ).toVar();\n\tconst z = float( 1.4 ).toVar();\n\tconst rz = float( 0.0 ).toVar();\n\tconst bp = vec3( p ).toVar();\n\n\tLoop( { start: float( 0.0 ), end: float( 3.0 ), type: 'float', condition: '<=' }, () => {\n\n\t\tconst dg = vec3( tri3( bp.mul( 2.0 ) ) ).toVar();\n\t\tp.addAssign( dg.add( time.mul( float( 0.1 ).mul( spd ) ) ) );\n\t\tbp.mulAssign( 1.8 );\n\t\tz.mulAssign( 1.5 );\n\t\tp.mulAssign( 1.2 );\n\n\t\tconst t = float( tri( p.z.add( tri( p.x.add( tri( p.y ) ) ) ) ) ).toVar();\n\t\trz.addAssign( t.div( z ) );\n\t\tbp.addAssign( 0.14 );\n\n\t} );\n\n\treturn rz;\n\n} ).setLayout( {\n\tname: 'triNoise3D',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'spd', type: 'float' },\n\t\t{ name: 'time', type: 'float' }\n\t]\n} );\n\nclass FunctionOverloadingNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'FunctionOverloadingNode';\n\n\t}\n\n\tconstructor( functionNodes = [], ...parametersNodes ) {\n\n\t\tsuper();\n\n\t\tthis.functionNodes = functionNodes;\n\t\tthis.parametersNodes = parametersNodes;\n\n\t\tthis._candidateFnCall = null;\n\n\t\tthis.global = true;\n\n\t}\n\n\tgetNodeType() {\n\n\t\treturn this.functionNodes[ 0 ].shaderNode.layout.type;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst params = this.parametersNodes;\n\n\t\tlet candidateFnCall = this._candidateFnCall;\n\n\t\tif ( candidateFnCall === null ) {\n\n\t\t\tlet candidateFn = null;\n\t\t\tlet candidateScore = - 1;\n\n\t\t\tfor ( const functionNode of this.functionNodes ) {\n\n\t\t\t\tconst shaderNode = functionNode.shaderNode;\n\t\t\t\tconst layout = shaderNode.layout;\n\n\t\t\t\tif ( layout === null ) {\n\n\t\t\t\t\tthrow new Error( 'FunctionOverloadingNode: FunctionNode must be a layout.' );\n\n\t\t\t\t}\n\n\t\t\t\tconst inputs = layout.inputs;\n\n\t\t\t\tif ( params.length === inputs.length ) {\n\n\t\t\t\t\tlet score = 0;\n\n\t\t\t\t\tfor ( let i = 0; i < params.length; i ++ ) {\n\n\t\t\t\t\t\tconst param = params[ i ];\n\t\t\t\t\t\tconst input = inputs[ i ];\n\n\t\t\t\t\t\tif ( param.getNodeType( builder ) === input.type ) {\n\n\t\t\t\t\t\t\tscore ++;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tscore = 0;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( score > candidateScore ) {\n\n\t\t\t\t\t\tcandidateFn = functionNode;\n\t\t\t\t\t\tcandidateScore = score;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._candidateFnCall = candidateFnCall = candidateFn( ...params );\n\n\t\t}\n\n\t\treturn candidateFnCall;\n\n\t}\n\n}\n\nconst overloadingBaseFn = /*@__PURE__*/ nodeProxy( FunctionOverloadingNode );\n\nconst overloadingFn = ( functionNodes ) => ( ...params ) => overloadingBaseFn( functionNodes, ...params );\n\nconst time = /*@__PURE__*/ uniform( 0 ).setGroup( renderGroup ).onRenderUpdate( ( frame ) => frame.time );\nconst deltaTime = /*@__PURE__*/ uniform( 0 ).setGroup( renderGroup ).onRenderUpdate( ( frame ) => frame.deltaTime );\nconst frameId = /*@__PURE__*/ uniform( 0, 'uint' ).setGroup( renderGroup ).onRenderUpdate( ( frame ) => frame.frameId );\n\n// Deprecated\n\nconst timerLocal = ( timeScale = 1 ) => { // @deprecated, r170\n\n\tconsole.warn( 'TSL: timerLocal() is deprecated. Use \"time\" instead.' );\n\treturn time.mul( timeScale );\n\n};\n\nconst timerGlobal = ( timeScale = 1 ) => { // @deprecated, r170\n\n\tconsole.warn( 'TSL: timerGlobal() is deprecated. Use \"time\" instead.' );\n\treturn time.mul( timeScale );\n\n};\n\nconst timerDelta = ( timeScale = 1 ) => { // @deprecated, r170\n\n\tconsole.warn( 'TSL: timerDelta() is deprecated. Use \"deltaTime\" instead.' );\n\treturn deltaTime.mul( timeScale );\n\n};\n\nconst oscSine = ( t = time ) => t.add( 0.75 ).mul( Math.PI * 2 ).sin().mul( 0.5 ).add( 0.5 );\nconst oscSquare = ( t = time ) => t.fract().round();\nconst oscTriangle = ( t = time ) => t.add( 0.5 ).fract().mul( 2 ).sub( 1 ).abs();\nconst oscSawtooth = ( t = time ) => t.fract();\n\nconst rotateUV = /*@__PURE__*/ Fn( ( [ uv, rotation, center = vec2( 0.5 ) ] ) => {\n\n\treturn rotate( uv.sub( center ), rotation ).add( center );\n\n} );\n\nconst spherizeUV = /*@__PURE__*/ Fn( ( [ uv, strength, center = vec2( 0.5 ) ] ) => {\n\n\tconst delta = uv.sub( center );\n\tconst delta2 = delta.dot( delta );\n\tconst delta4 = delta2.mul( delta2 );\n\tconst deltaOffset = delta4.mul( strength );\n\n\treturn uv.add( delta.mul( deltaOffset ) );\n\n} );\n\nconst billboarding = /*@__PURE__*/ Fn( ( { position = null, horizontal = true, vertical = false } ) => {\n\n\tlet worldMatrix;\n\n\tif ( position !== null ) {\n\n\t\tworldMatrix = modelWorldMatrix.toVar();\n\t\tworldMatrix[ 3 ][ 0 ] = position.x;\n\t\tworldMatrix[ 3 ][ 1 ] = position.y;\n\t\tworldMatrix[ 3 ][ 2 ] = position.z;\n\n\t} else {\n\n\t\tworldMatrix = modelWorldMatrix;\n\n\t}\n\n\tconst modelViewMatrix = cameraViewMatrix.mul( worldMatrix );\n\n\tif ( defined( horizontal ) ) {\n\n\t\tmodelViewMatrix[ 0 ][ 0 ] = modelWorldMatrix[ 0 ].length();\n\t\tmodelViewMatrix[ 0 ][ 1 ] = 0;\n\t\tmodelViewMatrix[ 0 ][ 2 ] = 0;\n\n\t}\n\n\tif ( defined( vertical ) ) {\n\n\t\tmodelViewMatrix[ 1 ][ 0 ] = 0;\n\t\tmodelViewMatrix[ 1 ][ 1 ] = modelWorldMatrix[ 1 ].length();\n\t\tmodelViewMatrix[ 1 ][ 2 ] = 0;\n\n\t}\n\n\tmodelViewMatrix[ 2 ][ 0 ] = 0;\n\tmodelViewMatrix[ 2 ][ 1 ] = 0;\n\tmodelViewMatrix[ 2 ][ 2 ] = 1;\n\n\treturn cameraProjectionMatrix.mul( modelViewMatrix ).mul( positionLocal );\n\n} );\n\nconst viewportSafeUV = /*@__PURE__*/ Fn( ( [ uv = null ] ) => {\n\n\tconst depth = linearDepth();\n\tconst depthDiff = linearDepth( viewportDepthTexture( uv ) ).sub( depth );\n\tconst finalUV = depthDiff.lessThan( 0 ).select( screenUV, uv );\n\n\treturn finalUV;\n\n} );\n\nclass SpriteSheetUVNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'SpriteSheetUVNode';\n\n\t}\n\n\tconstructor( countNode, uvNode = uv(), frameNode = float( 0 ) ) {\n\n\t\tsuper( 'vec2' );\n\n\t\tthis.countNode = countNode;\n\t\tthis.uvNode = uvNode;\n\t\tthis.frameNode = frameNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { frameNode, uvNode, countNode } = this;\n\n\t\tconst { width, height } = countNode;\n\n\t\tconst frameNum = frameNode.mod( width.mul( height ) ).floor();\n\n\t\tconst column = frameNum.mod( width );\n\t\tconst row = height.sub( frameNum.add( 1 ).div( width ).ceil() );\n\n\t\tconst scale = countNode.reciprocal();\n\t\tconst uvFrameOffset = vec2( column, row );\n\n\t\treturn uvNode.add( uvFrameOffset ).mul( scale );\n\n\t}\n\n}\n\nconst spritesheetUV = /*@__PURE__*/ nodeProxy( SpriteSheetUVNode );\n\nclass TriplanarTexturesNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'TriplanarTexturesNode';\n\n\t}\n\n\tconstructor( textureXNode, textureYNode = null, textureZNode = null, scaleNode = float( 1 ), positionNode = positionLocal, normalNode = normalLocal ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.textureXNode = textureXNode;\n\t\tthis.textureYNode = textureYNode;\n\t\tthis.textureZNode = textureZNode;\n\n\t\tthis.scaleNode = scaleNode;\n\n\t\tthis.positionNode = positionNode;\n\t\tthis.normalNode = normalNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { textureXNode, textureYNode, textureZNode, scaleNode, positionNode, normalNode } = this;\n\n\t\t// Ref: https://github.com/keijiro/StandardTriplanar\n\n\t\t// Blending factor of triplanar mapping\n\t\tlet bf = normalNode.abs().normalize();\n\t\tbf = bf.div( bf.dot( vec3( 1.0 ) ) );\n\n\t\t// Triplanar mapping\n\t\tconst tx = positionNode.yz.mul( scaleNode );\n\t\tconst ty = positionNode.zx.mul( scaleNode );\n\t\tconst tz = positionNode.xy.mul( scaleNode );\n\n\t\t// Base color\n\t\tconst textureX = textureXNode.value;\n\t\tconst textureY = textureYNode !== null ? textureYNode.value : textureX;\n\t\tconst textureZ = textureZNode !== null ? textureZNode.value : textureX;\n\n\t\tconst cx = texture( textureX, tx ).mul( bf.x );\n\t\tconst cy = texture( textureY, ty ).mul( bf.y );\n\t\tconst cz = texture( textureZ, tz ).mul( bf.z );\n\n\t\treturn add( cx, cy, cz );\n\n\t}\n\n}\n\nconst triplanarTextures = /*@__PURE__*/ nodeProxy( TriplanarTexturesNode );\nconst triplanarTexture = ( ...params ) => triplanarTextures( ...params );\n\nconst _reflectorPlane = new Plane();\nconst _normal = new Vector3();\nconst _reflectorWorldPosition = new Vector3();\nconst _cameraWorldPosition = new Vector3();\nconst _rotationMatrix = new Matrix4();\nconst _lookAtPosition = new Vector3( 0, 0, - 1 );\nconst clipPlane = new Vector4();\n\nconst _view = new Vector3();\nconst _target = new Vector3();\nconst _q = new Vector4();\n\nconst _size$2 = new Vector2();\n\nconst _defaultRT = new RenderTarget();\nconst _defaultUV = screenUV.flipX();\n\n_defaultRT.depthTexture = new DepthTexture( 1, 1 );\n\nlet _inReflector = false;\n\nclass ReflectorNode extends TextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'ReflectorNode';\n\n\t}\n\n\tconstructor( parameters = {} ) {\n\n\t\tsuper( parameters.defaultTexture || _defaultRT.texture, _defaultUV );\n\n\t\tthis._reflectorBaseNode = parameters.reflector || new ReflectorBaseNode( this, parameters );\n\t\tthis._depthNode = null;\n\n\t\tthis.setUpdateMatrix( false );\n\n\t}\n\n\tget reflector() {\n\n\t\treturn this._reflectorBaseNode;\n\n\t}\n\n\tget target() {\n\n\t\treturn this._reflectorBaseNode.target;\n\n\t}\n\n\tgetDepthNode() {\n\n\t\tif ( this._depthNode === null ) {\n\n\t\t\tif ( this._reflectorBaseNode.depth !== true ) {\n\n\t\t\t\tthrow new Error( 'THREE.ReflectorNode: Depth node can only be requested when the reflector is created with { depth: true }. ' );\n\n\t\t\t}\n\n\t\t\tthis._depthNode = nodeObject( new ReflectorNode( {\n\t\t\t\tdefaultTexture: _defaultRT.depthTexture,\n\t\t\t\treflector: this._reflectorBaseNode\n\t\t\t} ) );\n\n\t\t}\n\n\t\treturn this._depthNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\t// ignore if used in post-processing\n\t\tif ( ! builder.object.isQuadMesh ) this._reflectorBaseNode.build( builder );\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\tclone() {\n\n\t\tconst texture = new this.constructor( this.reflectorNode );\n\t\ttexture._reflectorBaseNode = this._reflectorBaseNode;\n\n\t\treturn texture;\n\n\t}\n\n}\n\n\nclass ReflectorBaseNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ReflectorBaseNode';\n\n\t}\n\n\tconstructor( textureNode, parameters = {} ) {\n\n\t\tsuper();\n\n\t\tconst {\n\t\t\ttarget = new Object3D(),\n\t\t\tresolution = 1,\n\t\t\tgenerateMipmaps = false,\n\t\t\tbounces = true,\n\t\t\tdepth = false\n\t\t} = parameters;\n\n\t\t//\n\n\t\tthis.textureNode = textureNode;\n\n\t\tthis.target = target;\n\t\tthis.resolution = resolution;\n\t\tthis.generateMipmaps = generateMipmaps;\n\t\tthis.bounces = bounces;\n\t\tthis.depth = depth;\n\n\t\tthis.updateBeforeType = bounces ? NodeUpdateType.RENDER : NodeUpdateType.FRAME;\n\n\t\tthis.virtualCameras = new WeakMap();\n\t\tthis.renderTargets = new WeakMap();\n\n\t}\n\n\t_updateResolution( renderTarget, renderer ) {\n\n\t\tconst resolution = this.resolution;\n\n\t\trenderer.getDrawingBufferSize( _size$2 );\n\n\t\trenderTarget.setSize( Math.round( _size$2.width * resolution ), Math.round( _size$2.height * resolution ) );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis._updateResolution( _defaultRT, builder.renderer );\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\tgetVirtualCamera( camera ) {\n\n\t\tlet virtualCamera = this.virtualCameras.get( camera );\n\n\t\tif ( virtualCamera === undefined ) {\n\n\t\t\tvirtualCamera = camera.clone();\n\n\t\t\tthis.virtualCameras.set( camera, virtualCamera );\n\n\t\t}\n\n\t\treturn virtualCamera;\n\n\t}\n\n\tgetRenderTarget( camera ) {\n\n\t\tlet renderTarget = this.renderTargets.get( camera );\n\n\t\tif ( renderTarget === undefined ) {\n\n\t\t\trenderTarget = new RenderTarget( 0, 0, { type: HalfFloatType } );\n\n\t\t\tif ( this.generateMipmaps === true ) {\n\n\t\t\t\trenderTarget.texture.minFilter = LinearMipMapLinearFilter;\n\t\t\t\trenderTarget.texture.generateMipmaps = true;\n\n\t\t\t}\n\n\t\t\tif ( this.depth === true ) {\n\n\t\t\t\trenderTarget.depthTexture = new DepthTexture();\n\n\t\t\t}\n\n\t\t\tthis.renderTargets.set( camera, renderTarget );\n\n\t\t}\n\n\t\treturn renderTarget;\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tif ( this.bounces === false && _inReflector ) return;\n\n\t\t_inReflector = true;\n\n\t\tconst { scene, camera, renderer, material } = frame;\n\t\tconst { target } = this;\n\n\t\tconst virtualCamera = this.getVirtualCamera( camera );\n\t\tconst renderTarget = this.getRenderTarget( virtualCamera );\n\n\t\trenderer.getDrawingBufferSize( _size$2 );\n\n\t\tthis._updateResolution( renderTarget, renderer );\n\n\t\t//\n\n\t\t_reflectorWorldPosition.setFromMatrixPosition( target.matrixWorld );\n\t\t_cameraWorldPosition.setFromMatrixPosition( camera.matrixWorld );\n\n\t\t_rotationMatrix.extractRotation( target.matrixWorld );\n\n\t\t_normal.set( 0, 0, 1 );\n\t\t_normal.applyMatrix4( _rotationMatrix );\n\n\t\t_view.subVectors( _reflectorWorldPosition, _cameraWorldPosition );\n\n\t\t// Avoid rendering when reflector is facing away\n\n\t\tif ( _view.dot( _normal ) > 0 ) return;\n\n\t\t_view.reflect( _normal ).negate();\n\t\t_view.add( _reflectorWorldPosition );\n\n\t\t_rotationMatrix.extractRotation( camera.matrixWorld );\n\n\t\t_lookAtPosition.set( 0, 0, - 1 );\n\t\t_lookAtPosition.applyMatrix4( _rotationMatrix );\n\t\t_lookAtPosition.add( _cameraWorldPosition );\n\n\t\t_target.subVectors( _reflectorWorldPosition, _lookAtPosition );\n\t\t_target.reflect( _normal ).negate();\n\t\t_target.add( _reflectorWorldPosition );\n\n\t\t//\n\n\t\tvirtualCamera.coordinateSystem = camera.coordinateSystem;\n\t\tvirtualCamera.position.copy( _view );\n\t\tvirtualCamera.up.set( 0, 1, 0 );\n\t\tvirtualCamera.up.applyMatrix4( _rotationMatrix );\n\t\tvirtualCamera.up.reflect( _normal );\n\t\tvirtualCamera.lookAt( _target );\n\n\t\tvirtualCamera.near = camera.near;\n\t\tvirtualCamera.far = camera.far;\n\n\t\tvirtualCamera.updateMatrixWorld();\n\t\tvirtualCamera.projectionMatrix.copy( camera.projectionMatrix );\n\n\t\t// Now update projection matrix with new clip plane, implementing code from: http://www.terathon.com/code/oblique.html\n\t\t// Paper explaining this technique: http://www.terathon.com/lengyel/Lengyel-Oblique.pdf\n\t\t_reflectorPlane.setFromNormalAndCoplanarPoint( _normal, _reflectorWorldPosition );\n\t\t_reflectorPlane.applyMatrix4( virtualCamera.matrixWorldInverse );\n\n\t\tclipPlane.set( _reflectorPlane.normal.x, _reflectorPlane.normal.y, _reflectorPlane.normal.z, _reflectorPlane.constant );\n\n\t\tconst projectionMatrix = virtualCamera.projectionMatrix;\n\n\t\t_q.x = ( Math.sign( clipPlane.x ) + projectionMatrix.elements[ 8 ] ) / projectionMatrix.elements[ 0 ];\n\t\t_q.y = ( Math.sign( clipPlane.y ) + projectionMatrix.elements[ 9 ] ) / projectionMatrix.elements[ 5 ];\n\t\t_q.z = - 1.0;\n\t\t_q.w = ( 1.0 + projectionMatrix.elements[ 10 ] ) / projectionMatrix.elements[ 14 ];\n\n\t\t// Calculate the scaled plane vector\n\t\tclipPlane.multiplyScalar( 1.0 / clipPlane.dot( _q ) );\n\n\t\tconst clipBias = 0;\n\n\t\t// Replacing the third row of the projection matrix\n\t\tprojectionMatrix.elements[ 2 ] = clipPlane.x;\n\t\tprojectionMatrix.elements[ 6 ] = clipPlane.y;\n\t\tprojectionMatrix.elements[ 10 ] = ( renderer.coordinateSystem === WebGPUCoordinateSystem ) ? ( clipPlane.z - clipBias ) : ( clipPlane.z + 1.0 - clipBias );\n\t\tprojectionMatrix.elements[ 14 ] = clipPlane.w;\n\n\t\t//\n\n\t\tthis.textureNode.value = renderTarget.texture;\n\n\t\tif ( this.depth === true ) {\n\n\t\t\tthis.textureNode.getDepthNode().value = renderTarget.depthTexture;\n\n\t\t}\n\n\t\tmaterial.visible = false;\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\t\tconst currentMRT = renderer.getMRT();\n\n\t\trenderer.setMRT( null );\n\t\trenderer.setRenderTarget( renderTarget );\n\n\t\trenderer.render( scene, virtualCamera );\n\n\t\trenderer.setMRT( currentMRT );\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t\tmaterial.visible = true;\n\n\t\t_inReflector = false;\n\n\t}\n\n}\n\nconst reflector = ( parameters ) => nodeObject( new ReflectorNode( parameters ) );\n\n// Helper for passes that need to fill the viewport with a single quad.\n\nconst _camera = /*@__PURE__*/ new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\n// https://github.com/mrdoob/three.js/pull/21358\n\nclass QuadGeometry extends BufferGeometry {\n\n\tconstructor( flipY = false ) {\n\n\t\tsuper();\n\n\t\tconst uv = flipY === false ? [ 0, - 1, 0, 1, 2, 1 ] : [ 0, 2, 0, 0, 2, 0 ];\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( [ - 1, 3, 0, - 1, - 1, 0, 3, - 1, 0 ], 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uv, 2 ) );\n\n\t}\n\n}\n\nconst _geometry = /*@__PURE__*/ new QuadGeometry();\n\nclass QuadMesh extends Mesh {\n\n\tconstructor( material = null ) {\n\n\t\tsuper( _geometry, material );\n\n\t\tthis.camera = _camera;\n\n\t\tthis.isQuadMesh = true;\n\n\t}\n\n\trenderAsync( renderer ) {\n\n\t\treturn renderer.renderAsync( this, _camera );\n\n\t}\n\n\trender( renderer ) {\n\n\t\trenderer.render( this, _camera );\n\n\t}\n\n}\n\nconst _size$1 = /*@__PURE__*/ new Vector2();\n\nclass RTTNode extends TextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'RTTNode';\n\n\t}\n\n\tconstructor( node, width = null, height = null, options = { type: HalfFloatType } ) {\n\n\t\tconst renderTarget = new RenderTarget( width, height, options );\n\n\t\tsuper( renderTarget.texture, uv() );\n\n\t\tthis.node = node;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\n\t\tthis.renderTarget = renderTarget;\n\n\t\tthis.textureNeedsUpdate = true;\n\t\tthis.autoUpdate = true;\n\n\t\tthis.updateMap = new WeakMap();\n\n\t\tthis._rttNode = null;\n\t\tthis._quadMesh = new QuadMesh( new NodeMaterial() );\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\n\t}\n\n\tget autoSize() {\n\n\t\treturn this.width === null;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis._rttNode = this.node.context( builder.getSharedContext() );\n\t\tthis._quadMesh.material.name = 'RTT';\n\t\tthis._quadMesh.material.needsUpdate = true;\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\tsetSize( width, height ) {\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\n\t\tconst effectiveWidth = width * this.pixelRatio;\n\t\tconst effectiveHeight = height * this.pixelRatio;\n\n\t\tthis.renderTarget.setSize( effectiveWidth, effectiveHeight );\n\n\t\tthis.textureNeedsUpdate = true;\n\n\t}\n\n\tsetPixelRatio( pixelRatio ) {\n\n\t\tthis.pixelRatio = pixelRatio;\n\n\t\tthis.setSize( this.width, this.height );\n\n\t}\n\n\tupdateBefore( { renderer } ) {\n\n\t\tif ( this.textureNeedsUpdate === false && this.autoUpdate === false ) return;\n\n\t\tthis.textureNeedsUpdate = false;\n\n\t\t//\n\n\t\tif ( this.autoSize === true ) {\n\n\t\t\tthis.pixelRatio = renderer.getPixelRatio();\n\n\t\t\tconst size = renderer.getSize( _size$1 );\n\n\t\t\tthis.setSize( size.width, size.height );\n\n\t\t}\n\n\t\t//\n\n\t\tthis._quadMesh.material.fragmentNode = this._rttNode;\n\n\t\t//\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\trenderer.setRenderTarget( this.renderTarget );\n\n\t\tthis._quadMesh.render( renderer );\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t}\n\n\tclone() {\n\n\t\tconst newNode = new TextureNode( this.value, this.uvNode, this.levelNode );\n\t\tnewNode.sampler = this.sampler;\n\t\tnewNode.referenceNode = this;\n\n\t\treturn newNode;\n\n\t}\n\n}\n\nconst rtt = ( node, ...params ) => nodeObject( new RTTNode( nodeObject( node ), ...params ) );\n\nconst convertToTexture = ( node, ...params ) => {\n\n\tif ( node.isTextureNode ) return node;\n\tif ( node.isPassNode ) return node.getTextureNode();\n\n\treturn rtt( node, ...params );\n\n};\n\n/**\n* Computes a position in view space based on a fragment's screen position expressed as uv coordinates, the fragments\n* depth value and the camera's inverse projection matrix.\n*\n* @param {vec2} screenPosition - The fragment's screen position expressed as uv coordinates.\n* @param {float} depth - The fragment's depth value.\n* @param {mat4} projectionMatrixInverse - The camera's inverse projection matrix.\n* @return {vec3} The fragments position in view space.\n*/\nconst getViewPosition = /*@__PURE__*/ Fn( ( [ screenPosition, depth, projectionMatrixInverse ], builder ) => {\n\n\tlet clipSpacePosition;\n\n\tif ( builder.renderer.coordinateSystem === WebGPUCoordinateSystem ) {\n\n\t\tscreenPosition = vec2( screenPosition.x, screenPosition.y.oneMinus() ).mul( 2.0 ).sub( 1.0 );\n\t\tclipSpacePosition = vec4( vec3( screenPosition, depth ), 1.0 );\n\n\t} else {\n\n\t\tclipSpacePosition = vec4( vec3( screenPosition.x, screenPosition.y.oneMinus(), depth ).mul( 2.0 ).sub( 1.0 ), 1.0 );\n\n\t}\n\n\tconst viewSpacePosition = vec4( projectionMatrixInverse.mul( clipSpacePosition ) );\n\n\treturn viewSpacePosition.xyz.div( viewSpacePosition.w );\n\n} );\n\n/**\n* Computes a screen position expressed as uv coordinates based on a fragment's position in view space\n* and the camera's projection matrix\n*\n* @param {vec3} viewPosition - The fragments position in view space.\n* @param {mat4} projectionMatrix - The camera's projection matrix.\n* @return {vec2} The fragment's screen position expressed as uv coordinates.\n*/\nconst getScreenPosition = /*@__PURE__*/ Fn( ( [ viewPosition, projectionMatrix ] ) => {\n\n\tconst sampleClipPos = projectionMatrix.mul( vec4( viewPosition, 1.0 ) );\n\tconst sampleUv = sampleClipPos.xy.div( sampleClipPos.w ).mul( 0.5 ).add( 0.5 ).toVar();\n\treturn vec2( sampleUv.x, sampleUv.y.oneMinus() );\n\n} );\n\n/**\n* Computes a normal vector based on depth data. Can be used as a fallback when no normal render\n* target is available or if flat surface normals are required.\n*\n* @param {vec2} uv - The texture coordinate.\n* @param {DepthTexture} depthTexture - The depth texture.\n* @param {mat4} projectionMatrixInverse - The camera's inverse projection matrix.\n* @return {vec3} The computed normal vector.\n*/\nconst getNormalFromDepth = /*@__PURE__*/ Fn( ( [ uv, depthTexture, projectionMatrixInverse ] ) => {\n\n\tconst size = textureSize( textureLoad( depthTexture ) );\n\tconst p = ivec2( uv.mul( size ) ).toVar();\n\n\tconst c0 = textureLoad( depthTexture, p ).toVar();\n\n\tconst l2 = textureLoad( depthTexture, p.sub( ivec2( 2, 0 ) ) ).toVar();\n\tconst l1 = textureLoad( depthTexture, p.sub( ivec2( 1, 0 ) ) ).toVar();\n\tconst r1 = textureLoad( depthTexture, p.add( ivec2( 1, 0 ) ) ).toVar();\n\tconst r2 = textureLoad( depthTexture, p.add( ivec2( 2, 0 ) ) ).toVar();\n\tconst b2 = textureLoad( depthTexture, p.add( ivec2( 0, 2 ) ) ).toVar();\n\tconst b1 = textureLoad( depthTexture, p.add( ivec2( 0, 1 ) ) ).toVar();\n\tconst t1 = textureLoad( depthTexture, p.sub( ivec2( 0, 1 ) ) ).toVar();\n\tconst t2 = textureLoad( depthTexture, p.sub( ivec2( 0, 2 ) ) ).toVar();\n\n\tconst dl = abs( sub( float( 2 ).mul( l1 ).sub( l2 ), c0 ) ).toVar();\n\tconst dr = abs( sub( float( 2 ).mul( r1 ).sub( r2 ), c0 ) ).toVar();\n\tconst db = abs( sub( float( 2 ).mul( b1 ).sub( b2 ), c0 ) ).toVar();\n\tconst dt = abs( sub( float( 2 ).mul( t1 ).sub( t2 ), c0 ) ).toVar();\n\n\tconst ce = getViewPosition( uv, c0, projectionMatrixInverse ).toVar();\n\n\tconst dpdx = dl.lessThan( dr ).select( ce.sub( getViewPosition( uv.sub( vec2( float( 1 ).div( size.x ), 0 ) ), l1, projectionMatrixInverse ) ), ce.negate().add( getViewPosition( uv.add( vec2( float( 1 ).div( size.x ), 0 ) ), r1, projectionMatrixInverse ) ) );\n\tconst dpdy = db.lessThan( dt ).select( ce.sub( getViewPosition( uv.add( vec2( 0, float( 1 ).div( size.y ) ) ), b1, projectionMatrixInverse ) ), ce.negate().add( getViewPosition( uv.sub( vec2( 0, float( 1 ).div( size.y ) ) ), t1, projectionMatrixInverse ) ) );\n\n\treturn normalize( cross( dpdx, dpdy ) );\n\n} );\n\nclass StorageInstancedBufferAttribute extends InstancedBufferAttribute {\n\n\tconstructor( array, itemSize, typeClass = Float32Array ) {\n\n\t\tif ( ArrayBuffer.isView( array ) === false ) array = new typeClass( array * itemSize );\n\n\t\tsuper( array, itemSize );\n\n\t\tthis.isStorageInstancedBufferAttribute = true;\n\n\t}\n\n}\n\nclass StorageBufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, typeClass = Float32Array ) {\n\n\t\tif ( ArrayBuffer.isView( array ) === false ) array = new typeClass( array * itemSize );\n\n\t\tsuper( array, itemSize );\n\n\t\tthis.isStorageBufferAttribute = true;\n\n\t}\n\n}\n\nclass StorageArrayElementNode extends ArrayElementNode {\n\n\tstatic get type() {\n\n\t\treturn 'StorageArrayElementNode';\n\n\t}\n\n\tconstructor( storageBufferNode, indexNode ) {\n\n\t\tsuper( storageBufferNode, indexNode );\n\n\t\tthis.isStorageArrayElementNode = true;\n\n\t}\n\n\tset storageBufferNode( value ) {\n\n\t\tthis.node = value;\n\n\t}\n\n\tget storageBufferNode() {\n\n\t\treturn this.node;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( builder.isAvailable( 'storageBuffer' ) === false ) {\n\n\t\t\tif ( this.node.isPBO === true ) {\n\n\t\t\t\tbuilder.setupPBO( this.node );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tlet snippet;\n\n\t\tconst isAssignContext = builder.context.assign;\n\n\t\t//\n\n\t\tif ( builder.isAvailable( 'storageBuffer' ) === false ) {\n\n\t\t\tif ( this.node.isPBO === true && isAssignContext !== true && ( this.node.value.isInstancedBufferAttribute || builder.shaderStage !== 'compute' ) ) {\n\n\t\t\t\tsnippet = builder.generatePBO( this );\n\n\t\t\t} else {\n\n\t\t\t\tsnippet = this.node.build( builder );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tsnippet = super.generate( builder );\n\n\t\t}\n\n\t\tif ( isAssignContext !== true ) {\n\n\t\t\tconst type = this.getNodeType( builder );\n\n\t\t\tsnippet = builder.format( snippet, type, output );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n}\n\nconst storageElement = /*@__PURE__*/ nodeProxy( StorageArrayElementNode );\n\nclass StorageBufferNode extends BufferNode {\n\n\tstatic get type() {\n\n\t\treturn 'StorageBufferNode';\n\n\t}\n\n\tconstructor( value, bufferType = null, bufferCount = 0 ) {\n\n\t\tif ( bufferType === null && ( value.isStorageBufferAttribute || value.isStorageInstancedBufferAttribute ) ) {\n\n\t\t\tbufferType = getTypeFromLength( value.itemSize );\n\t\t\tbufferCount = value.count;\n\n\t\t}\n\n\t\tsuper( value, bufferType, bufferCount );\n\n\t\tthis.isStorageBufferNode = true;\n\n\t\tthis.access = NodeAccess.READ_WRITE;\n\t\tthis.isAtomic = false;\n\t\tthis.isPBO = false;\n\n\t\tthis.bufferCount = bufferCount;\n\n\t\tthis._attribute = null;\n\t\tthis._varying = null;\n\n\t\tthis.global = true;\n\n\t\tif ( value.isStorageBufferAttribute !== true && value.isStorageInstancedBufferAttribute !== true ) {\n\n\t\t\t// TOOD: Improve it, possibly adding a new property to the BufferAttribute to identify it as a storage buffer read-only attribute in Renderer\n\n\t\t\tif ( value.isInstancedBufferAttribute ) value.isStorageInstancedBufferAttribute = true;\n\t\t\telse value.isStorageBufferAttribute = true;\n\n\t\t}\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\tif ( this.bufferCount === 0 ) {\n\n\t\t\tlet bufferData = builder.globalCache.getData( this.value );\n\n\t\t\tif ( bufferData === undefined ) {\n\n\t\t\t\tbufferData = {\n\t\t\t\t\tnode: this\n\t\t\t\t};\n\n\t\t\t\tbuilder.globalCache.setData( this.value, bufferData );\n\n\t\t\t}\n\n\t\t\treturn bufferData.node.uuid;\n\n\t\t}\n\n\t\treturn this.uuid;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn this.value.isIndirectStorageBufferAttribute ? 'indirectStorageBuffer' : 'storageBuffer';\n\n\t}\n\n\telement( indexNode ) {\n\n\t\treturn storageElement( this, indexNode );\n\n\t}\n\n\tsetPBO( value ) {\n\n\t\tthis.isPBO = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetPBO() {\n\n\t\treturn this.isPBO;\n\n\t}\n\n\tsetAccess( value ) {\n\n\t\tthis.access = value;\n\n\t\treturn this;\n\n\t}\n\n\ttoReadOnly() {\n\n\t\treturn this.setAccess( NodeAccess.READ_ONLY );\n\n\t}\n\n\tsetAtomic( value ) {\n\n\t\tthis.isAtomic = value;\n\n\t\treturn this;\n\n\t}\n\n\ttoAtomic() {\n\n\t\treturn this.setAtomic( true );\n\n\t}\n\n\tgetAttributeData() {\n\n\t\tif ( this._attribute === null ) {\n\n\t\t\tthis._attribute = bufferAttribute( this.value );\n\t\t\tthis._varying = varying( this._attribute );\n\n\t\t}\n\n\t\treturn {\n\t\t\tattribute: this._attribute,\n\t\t\tvarying: this._varying\n\t\t};\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tif ( builder.isAvailable( 'storageBuffer' ) || builder.isAvailable( 'indirectStorageBuffer' ) ) {\n\n\t\t\treturn super.getNodeType( builder );\n\n\t\t}\n\n\t\tconst { attribute } = this.getAttributeData();\n\n\t\treturn attribute.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tif ( builder.isAvailable( 'storageBuffer' ) || builder.isAvailable( 'indirectStorageBuffer' ) ) {\n\n\t\t\treturn super.generate( builder );\n\n\t\t}\n\n\t\tconst { attribute, varying } = this.getAttributeData();\n\n\t\tconst output = varying.build( builder );\n\n\t\tbuilder.registerTransform( output, attribute );\n\n\t\treturn output;\n\n\t}\n\n}\n\nconst storage = ( value, type, count ) => nodeObject( new StorageBufferNode( value, type, count ) );\n\nconst storageObject = ( value, type, count ) => { // @deprecated, r171\n\n\tconsole.warn( 'THREE.TSL: \"storageObject()\" is deprecated. Use \"storage().setPBO( true )\" instead.' );\n\n\treturn storage( value, type, count ).setPBO( true );\n\n};\n\nconst attributeArray = ( count, type = 'float' ) => {\n\n\tconst itemSize = getLengthFromType( type );\n\n\tconst buffer = new StorageBufferAttribute( count, itemSize );\n\tconst node = storage( buffer, type, count );\n\n\treturn node;\n\n};\n\n\nconst instancedArray = ( count, type = 'float' ) => {\n\n\tconst itemSize = getLengthFromType( type );\n\n\tconst buffer = new StorageInstancedBufferAttribute( count, itemSize );\n\tconst node = storage( buffer, type, count );\n\n\treturn node;\n\n};\n\nclass VertexColorNode extends AttributeNode {\n\n\tstatic get type() {\n\n\t\treturn 'VertexColorNode';\n\n\t}\n\n\tconstructor( index = 0 ) {\n\n\t\tsuper( null, 'vec4' );\n\n\t\tthis.isVertexColorNode = true;\n\n\t\tthis.index = index;\n\n\t}\n\n\tgetAttributeName( /*builder*/ ) {\n\n\t\tconst index = this.index;\n\n\t\treturn 'color' + ( index > 0 ? index : '' );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst attributeName = this.getAttributeName( builder );\n\t\tconst geometryAttribute = builder.hasGeometryAttribute( attributeName );\n\n\t\tlet result;\n\n\t\tif ( geometryAttribute === true ) {\n\n\t\t\tresult = super.generate( builder );\n\n\t\t} else {\n\n\t\t\t// Vertex color fallback should be white\n\t\t\tresult = builder.generateConst( this.nodeType, new Vector4( 1, 1, 1, 1 ) );\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.index = this.index;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.index = data.index;\n\n\t}\n\n}\n\nconst vertexColor = ( ...params ) => nodeObject( new VertexColorNode( ...params ) );\n\nclass PointUVNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'PointUVNode';\n\n\t}\n\n\tconstructor() {\n\n\t\tsuper( 'vec2' );\n\n\t\tthis.isPointUVNode = true;\n\n\t}\n\n\tgenerate( /*builder*/ ) {\n\n\t\treturn 'vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )';\n\n\t}\n\n}\n\nconst pointUV = /*@__PURE__*/ nodeImmutable( PointUVNode );\n\nconst _e1 = /*@__PURE__*/ new Euler();\nconst _m1 = /*@__PURE__*/ new Matrix4();\n\nclass SceneNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'SceneNode';\n\n\t}\n\n\tconstructor( scope = SceneNode.BACKGROUND_BLURRINESS, scene = null ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\t\tthis.scene = scene;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst scope = this.scope;\n\t\tconst scene = this.scene !== null ? this.scene : builder.scene;\n\n\t\tlet output;\n\n\t\tif ( scope === SceneNode.BACKGROUND_BLURRINESS ) {\n\n\t\t\toutput = reference( 'backgroundBlurriness', 'float', scene );\n\n\t\t} else if ( scope === SceneNode.BACKGROUND_INTENSITY ) {\n\n\t\t\toutput = reference( 'backgroundIntensity', 'float', scene );\n\n\t\t} else if ( scope === SceneNode.BACKGROUND_ROTATION ) {\n\n\t\t\toutput = uniform( 'mat4' ).label( 'backgroundRotation' ).setGroup( renderGroup ).onRenderUpdate( () => {\n\n\t\t\t\tconst background = scene.background;\n\n\t\t\t\tif ( background !== null && background.isTexture && background.mapping !== UVMapping ) {\n\n\t\t\t\t\t_e1.copy( scene.backgroundRotation );\n\n\t\t\t\t\t// accommodate left-handed frame\n\t\t\t\t\t_e1.x *= - 1; _e1.y *= - 1; _e1.z *= - 1;\n\n\t\t\t\t\t_m1.makeRotationFromEuler( _e1 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_m1.identity();\n\n\t\t\t\t}\n\n\t\t\t\treturn _m1;\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.SceneNode: Unknown scope:', scope );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n}\n\nSceneNode.BACKGROUND_BLURRINESS = 'backgroundBlurriness';\nSceneNode.BACKGROUND_INTENSITY = 'backgroundIntensity';\nSceneNode.BACKGROUND_ROTATION = 'backgroundRotation';\n\nconst backgroundBlurriness = /*@__PURE__*/ nodeImmutable( SceneNode, SceneNode.BACKGROUND_BLURRINESS );\nconst backgroundIntensity = /*@__PURE__*/ nodeImmutable( SceneNode, SceneNode.BACKGROUND_INTENSITY );\nconst backgroundRotation = /*@__PURE__*/ nodeImmutable( SceneNode, SceneNode.BACKGROUND_ROTATION );\n\nclass StorageTextureNode extends TextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'StorageTextureNode';\n\n\t}\n\n\tconstructor( value, uvNode, storeNode = null ) {\n\n\t\tsuper( value, uvNode );\n\n\t\tthis.storeNode = storeNode;\n\n\t\tthis.isStorageTextureNode = true;\n\n\t\tthis.access = NodeAccess.WRITE_ONLY;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'storageTexture';\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tconst properties = builder.getNodeProperties( this );\n\t\tproperties.storeNode = this.storeNode;\n\n\t}\n\n\tsetAccess( value ) {\n\n\t\tthis.access = value;\n\t\treturn this;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tlet snippet;\n\n\t\tif ( this.storeNode !== null ) {\n\n\t\t\tsnippet = this.generateStore( builder );\n\n\t\t} else {\n\n\t\t\tsnippet = super.generate( builder, output );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\ttoReadWrite() {\n\n\t\treturn this.setAccess( NodeAccess.READ_WRITE );\n\n\t}\n\n\ttoReadOnly() {\n\n\t\treturn this.setAccess( NodeAccess.READ_ONLY );\n\n\t}\n\n\ttoWriteOnly() {\n\n\t\treturn this.setAccess( NodeAccess.WRITE_ONLY );\n\n\t}\n\n\tgenerateStore( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\tconst { uvNode, storeNode } = properties;\n\n\t\tconst textureProperty = super.generate( builder, 'property' );\n\t\tconst uvSnippet = uvNode.build( builder, 'uvec2' );\n\t\tconst storeSnippet = storeNode.build( builder, 'vec4' );\n\n\t\tconst snippet = builder.generateTextureStore( builder, textureProperty, uvSnippet, storeSnippet );\n\n\t\tbuilder.addLineFlowCode( snippet, this );\n\n\t}\n\n}\n\nconst storageTexture = /*@__PURE__*/ nodeProxy( StorageTextureNode );\n\nconst textureStore = ( value, uvNode, storeNode ) => {\n\n\tconst node = storageTexture( value, uvNode, storeNode );\n\n\tif ( storeNode !== null ) node.append();\n\n\treturn node;\n\n};\n\nclass UserDataNode extends ReferenceNode {\n\n\tstatic get type() {\n\n\t\treturn 'UserDataNode';\n\n\t}\n\n\tconstructor( property, inputType, userData = null ) {\n\n\t\tsuper( property, inputType, userData );\n\n\t\tthis.userData = userData;\n\n\t}\n\n\tupdateReference( state ) {\n\n\t\tthis.reference = this.userData !== null ? this.userData : state.object.userData;\n\n\t\treturn this.reference;\n\n\t}\n\n}\n\nconst userData = ( name, inputType, userData ) => nodeObject( new UserDataNode( name, inputType, userData ) );\n\nconst _objectData = new WeakMap();\n\nclass VelocityNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'VelocityNode';\n\n\t}\n\n\tconstructor() {\n\n\t\tsuper( 'vec2' );\n\n\t\tthis.projectionMatrix = null;\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\t\tthis.updateAfterType = NodeUpdateType.OBJECT;\n\n\t\tthis.previousModelWorldMatrix = uniform( new Matrix4() );\n\t\tthis.previousProjectionMatrix = uniform( new Matrix4() ).setGroup( renderGroup );\n\t\tthis.previousCameraViewMatrix = uniform( new Matrix4() );\n\n\t}\n\n\tsetProjectionMatrix( projectionMatrix ) {\n\n\t\tthis.projectionMatrix = projectionMatrix;\n\n\t}\n\n\tupdate( { frameId, camera, object } ) {\n\n\t\tconst previousModelMatrix = getPreviousMatrix( object );\n\n\t\tthis.previousModelWorldMatrix.value.copy( previousModelMatrix );\n\n\t\t//\n\n\t\tconst cameraData = getData( camera );\n\n\t\tif ( cameraData.frameId !== frameId ) {\n\n\t\t\tcameraData.frameId = frameId;\n\n\t\t\tif ( cameraData.previousProjectionMatrix === undefined ) {\n\n\t\t\t\tcameraData.previousProjectionMatrix = new Matrix4();\n\t\t\t\tcameraData.previousCameraViewMatrix = new Matrix4();\n\n\t\t\t\tcameraData.currentProjectionMatrix = new Matrix4();\n\t\t\t\tcameraData.currentCameraViewMatrix = new Matrix4();\n\n\t\t\t\tcameraData.previousProjectionMatrix.copy( this.projectionMatrix || camera.projectionMatrix );\n\t\t\t\tcameraData.previousCameraViewMatrix.copy( camera.matrixWorldInverse );\n\n\t\t\t} else {\n\n\t\t\t\tcameraData.previousProjectionMatrix.copy( cameraData.currentProjectionMatrix );\n\t\t\t\tcameraData.previousCameraViewMatrix.copy( cameraData.currentCameraViewMatrix );\n\n\t\t\t}\n\n\t\t\tcameraData.currentProjectionMatrix.copy( this.projectionMatrix || camera.projectionMatrix );\n\t\t\tcameraData.currentCameraViewMatrix.copy( camera.matrixWorldInverse );\n\n\t\t\tthis.previousProjectionMatrix.value.copy( cameraData.previousProjectionMatrix );\n\t\t\tthis.previousCameraViewMatrix.value.copy( cameraData.previousCameraViewMatrix );\n\n\t\t}\n\n\t}\n\n\tupdateAfter( { object } ) {\n\n\t\tgetPreviousMatrix( object ).copy( object.matrixWorld );\n\n\t}\n\n\tsetup( /*builder*/ ) {\n\n\t\tconst projectionMatrix = ( this.projectionMatrix === null ) ? cameraProjectionMatrix : uniform( this.projectionMatrix );\n\n\t\tconst previousModelViewMatrix = this.previousCameraViewMatrix.mul( this.previousModelWorldMatrix );\n\n\t\tconst clipPositionCurrent = projectionMatrix.mul( modelViewMatrix ).mul( positionLocal );\n\t\tconst clipPositionPrevious = this.previousProjectionMatrix.mul( previousModelViewMatrix ).mul( positionPrevious );\n\n\t\tconst ndcPositionCurrent = clipPositionCurrent.xy.div( clipPositionCurrent.w );\n\t\tconst ndcPositionPrevious = clipPositionPrevious.xy.div( clipPositionPrevious.w );\n\n\t\tconst velocity = sub( ndcPositionCurrent, ndcPositionPrevious );\n\n\t\treturn velocity;\n\n\t}\n\n}\n\nfunction getData( object ) {\n\n\tlet objectData = _objectData.get( object );\n\n\tif ( objectData === undefined ) {\n\n\t\tobjectData = {};\n\t\t_objectData.set( object, objectData );\n\n\t}\n\n\treturn objectData;\n\n}\n\nfunction getPreviousMatrix( object, index = 0 ) {\n\n\tconst objectData = getData( object );\n\n\tlet matrix = objectData[ index ];\n\n\tif ( matrix === undefined ) {\n\n\t\tobjectData[ index ] = matrix = new Matrix4();\n\n\t}\n\n\treturn matrix;\n\n}\n\nconst velocity = /*@__PURE__*/ nodeImmutable( VelocityNode );\n\nconst blendBurn = /*@__PURE__*/ Fn( ( [ base, blend ] ) => {\n\n\treturn min$1( 1.0, base.oneMinus().div( blend ) ).oneMinus();\n\n} ).setLayout( {\n\tname: 'blendBurn',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'base', type: 'vec3' },\n\t\t{ name: 'blend', type: 'vec3' }\n\t]\n} );\n\nconst blendDodge = /*@__PURE__*/ Fn( ( [ base, blend ] ) => {\n\n\treturn min$1( base.div( blend.oneMinus() ), 1.0 );\n\n} ).setLayout( {\n\tname: 'blendDodge',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'base', type: 'vec3' },\n\t\t{ name: 'blend', type: 'vec3' }\n\t]\n} );\n\nconst blendScreen = /*@__PURE__*/ Fn( ( [ base, blend ] ) => {\n\n\treturn base.oneMinus().mul( blend.oneMinus() ).oneMinus();\n\n} ).setLayout( {\n\tname: 'blendScreen',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'base', type: 'vec3' },\n\t\t{ name: 'blend', type: 'vec3' }\n\t]\n} );\n\nconst blendOverlay = /*@__PURE__*/ Fn( ( [ base, blend ] ) => {\n\n\treturn mix( base.mul( 2.0 ).mul( blend ), base.oneMinus().mul( 2.0 ).mul( blend.oneMinus() ).oneMinus(), step( 0.5, base ) );\n\n} ).setLayout( {\n\tname: 'blendOverlay',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'base', type: 'vec3' },\n\t\t{ name: 'blend', type: 'vec3' }\n\t]\n} );\n\nconst blendColor = /*@__PURE__*/ Fn( ( [ base, blend ] ) => {\n\n\tconst outAlpha = blend.a.add( base.a.mul( blend.a.oneMinus() ) );\n\n\treturn vec4( blend.rgb.mul( blend.a ).add( base.rgb.mul( base.a ).mul( blend.a.oneMinus() ) ).div( outAlpha ), outAlpha );\n\n} ).setLayout( {\n\tname: 'blendColor',\n\ttype: 'vec4',\n\tinputs: [\n\t\t{ name: 'base', type: 'vec4' },\n\t\t{ name: 'blend', type: 'vec4' }\n\t]\n} );\n\n// deprecated\n\nconst burn = ( ...params ) => { // @deprecated, r171\n\n\tconsole.warn( 'THREE.TSL: \"burn\" has been renamed. Use \"blendBurn\" instead.' );\n\treturn blendBurn( params );\n\n};\n\nconst dodge = ( ...params ) => { // @deprecated, r171\n\n\tconsole.warn( 'THREE.TSL: \"dodge\" has been renamed. Use \"blendDodge\" instead.' );\n\treturn blendDodge( params );\n\n};\n\nconst screen = ( ...params ) => { // @deprecated, r171\n\n\tconsole.warn( 'THREE.TSL: \"screen\" has been renamed. Use \"blendScreen\" instead.' );\n\treturn blendScreen( params );\n\n};\n\nconst overlay = ( ...params ) => { // @deprecated, r171\n\n\tconsole.warn( 'THREE.TSL: \"overlay\" has been renamed. Use \"blendOverlay\" instead.' );\n\treturn blendOverlay( params );\n\n};\n\nconst grayscale = /*@__PURE__*/ Fn( ( [ color ] ) => {\n\n\treturn luminance( color.rgb );\n\n} );\n\nconst saturation = /*@__PURE__*/ Fn( ( [ color, adjustment = float( 1 ) ] ) => {\n\n\treturn adjustment.mix( luminance( color.rgb ), color.rgb );\n\n} );\n\nconst vibrance = /*@__PURE__*/ Fn( ( [ color, adjustment = float( 1 ) ] ) => {\n\n\tconst average = add( color.r, color.g, color.b ).div( 3.0 );\n\n\tconst mx = color.r.max( color.g.max( color.b ) );\n\tconst amt = mx.sub( average ).mul( adjustment ).mul( - 3.0 );\n\n\treturn mix( color.rgb, mx, amt );\n\n} );\n\nconst hue = /*@__PURE__*/ Fn( ( [ color, adjustment = float( 1 ) ] ) => {\n\n\tconst k = vec3( 0.57735, 0.57735, 0.57735 );\n\n\tconst cosAngle = adjustment.cos();\n\n\treturn vec3( color.rgb.mul( cosAngle ).add( k.cross( color.rgb ).mul( adjustment.sin() ).add( k.mul( dot( k, color.rgb ).mul( cosAngle.oneMinus() ) ) ) ) );\n\n} );\n\nconst luminance = (\n\tcolor,\n\tluminanceCoefficients = vec3( ColorManagement.getLuminanceCoefficients( new Vector3() ) )\n) => dot( color, luminanceCoefficients );\n\nconst threshold = ( color, threshold ) => mix( vec3( 0.0 ), color, luminance( color ).sub( threshold ).max( 0 ) );\n\n/**\n * Color Decision List (CDL) v1.2\n *\n * Compact representation of color grading information, defined by slope, offset, power, and\n * saturation. The CDL should be typically be given input in a log space (such as LogC, ACEScc,\n * or AgX Log), and will return output in the same space. Output may require clamping >=0.\n *\n * @param {vec4} color Input (-Infinity < input < +Infinity)\n * @param {number | vec3} slope Slope (0 ≤ slope < +Infinity)\n * @param {number | vec3} offset Offset (-Infinity < offset < +Infinity; typically -1 < offset < 1)\n * @param {number | vec3} power Power (0 < power < +Infinity)\n * @param {number} saturation Saturation (0 ≤ saturation < +Infinity; typically 0 ≤ saturation < 4)\n * @param {vec3} luminanceCoefficients Luminance coefficients for saturation term, typically Rec. 709\n * @return Output, -Infinity < output < +Infinity\n *\n * References:\n * - ASC CDL v1.2\n * - https://blender.stackexchange.com/a/55239/43930\n * - https://docs.acescentral.com/specifications/acescc/\n */\nconst cdl = /*@__PURE__*/ Fn( ( [\n\tcolor,\n\tslope = vec3( 1 ),\n\toffset = vec3( 0 ),\n\tpower = vec3( 1 ),\n\tsaturation = float( 1 ),\n\t// ASC CDL v1.2 explicitly requires Rec. 709 luminance coefficients.\n\tluminanceCoefficients = vec3( ColorManagement.getLuminanceCoefficients( new Vector3(), LinearSRGBColorSpace ) )\n] ) => {\n\n\t// NOTE: The ASC CDL v1.2 defines a [0, 1] clamp on the slope+offset term, and another on the\n\t// saturation term. Per the ACEScc specification and Filament, limits may be omitted to support\n\t// values outside [0, 1], requiring a workaround for negative values in the power expression.\n\n\tconst luma = color.rgb.dot( vec3( luminanceCoefficients ) );\n\n\tconst v = max$1( color.rgb.mul( slope ).add( offset ), 0.0 ).toVar();\n\tconst pv = v.pow( power ).toVar();\n\n\tIf( v.r.greaterThan( 0.0 ), () => { v.r.assign( pv.r ); } ); // eslint-disable-line\n\tIf( v.g.greaterThan( 0.0 ), () => { v.g.assign( pv.g ); } ); // eslint-disable-line\n\tIf( v.b.greaterThan( 0.0 ), () => { v.b.assign( pv.b ); } ); // eslint-disable-line\n\n\tv.assign( luma.add( v.sub( luma ).mul( saturation ) ) );\n\n\treturn vec4( v.rgb, color.a );\n\n} );\n\nclass PosterizeNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'PosterizeNode';\n\n\t}\n\n\tconstructor( sourceNode, stepsNode ) {\n\n\t\tsuper();\n\n\t\tthis.sourceNode = sourceNode;\n\t\tthis.stepsNode = stepsNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { sourceNode, stepsNode } = this;\n\n\t\treturn sourceNode.mul( stepsNode ).floor().div( stepsNode );\n\n\t}\n\n}\n\nconst posterize = /*@__PURE__*/ nodeProxy( PosterizeNode );\n\nconst _size = /*@__PURE__*/ new Vector2();\n\nclass PassTextureNode extends TextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'PassTextureNode';\n\n\t}\n\n\tconstructor( passNode, texture ) {\n\n\t\tsuper( texture );\n\n\t\tthis.passNode = passNode;\n\n\t\tthis.setUpdateMatrix( false );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( builder.object.isQuadMesh ) this.passNode.build( builder );\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.passNode, this.value );\n\n\t}\n\n}\n\nclass PassMultipleTextureNode extends PassTextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'PassMultipleTextureNode';\n\n\t}\n\n\tconstructor( passNode, textureName, previousTexture = false ) {\n\n\t\tsuper( passNode, null );\n\n\t\tthis.textureName = textureName;\n\t\tthis.previousTexture = previousTexture;\n\n\t}\n\n\tupdateTexture() {\n\n\t\tthis.value = this.previousTexture ? this.passNode.getPreviousTexture( this.textureName ) : this.passNode.getTexture( this.textureName );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.updateTexture();\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.passNode, this.textureName, this.previousTexture );\n\n\t}\n\n}\n\nclass PassNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'PassNode';\n\n\t}\n\n\tconstructor( scope, scene, camera, options = {} ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.scope = scope;\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\t\tthis.options = options;\n\n\t\tthis._pixelRatio = 1;\n\t\tthis._width = 1;\n\t\tthis._height = 1;\n\n\t\tconst depthTexture = new DepthTexture();\n\t\tdepthTexture.isRenderTargetTexture = true;\n\t\t//depthTexture.type = FloatType;\n\t\tdepthTexture.name = 'depth';\n\n\t\tconst renderTarget = new RenderTarget( this._width * this._pixelRatio, this._height * this._pixelRatio, { type: HalfFloatType, ...options, } );\n\t\trenderTarget.texture.name = 'output';\n\t\trenderTarget.depthTexture = depthTexture;\n\n\t\tthis.renderTarget = renderTarget;\n\n\t\tthis.updateBeforeType = NodeUpdateType.FRAME;\n\n\t\tthis._textures = {\n\t\t\toutput: renderTarget.texture,\n\t\t\tdepth: depthTexture\n\t\t};\n\n\t\tthis._textureNodes = {};\n\t\tthis._linearDepthNodes = {};\n\t\tthis._viewZNodes = {};\n\n\t\tthis._previousTextures = {};\n\t\tthis._previousTextureNodes = {};\n\n\t\tthis._cameraNear = uniform( 0 );\n\t\tthis._cameraFar = uniform( 0 );\n\n\t\tthis._mrt = null;\n\n\t\tthis.isPassNode = true;\n\n\t}\n\n\tsetMRT( mrt ) {\n\n\t\tthis._mrt = mrt;\n\n\t\treturn this;\n\n\t}\n\n\tgetMRT() {\n\n\t\treturn this._mrt;\n\n\t}\n\n\tisGlobal() {\n\n\t\treturn true;\n\n\t}\n\n\tgetTexture( name ) {\n\n\t\tlet texture = this._textures[ name ];\n\n\t\tif ( texture === undefined ) {\n\n\t\t\tconst refTexture = this.renderTarget.texture;\n\n\t\t\ttexture = refTexture.clone();\n\t\t\ttexture.isRenderTargetTexture = true;\n\t\t\ttexture.name = name;\n\n\t\t\tthis._textures[ name ] = texture;\n\n\t\t\tthis.renderTarget.textures.push( texture );\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tgetPreviousTexture( name ) {\n\n\t\tlet texture = this._previousTextures[ name ];\n\n\t\tif ( texture === undefined ) {\n\n\t\t\ttexture = this.getTexture( name ).clone();\n\t\t\ttexture.isRenderTargetTexture = true;\n\n\t\t\tthis._previousTextures[ name ] = texture;\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\ttoggleTexture( name ) {\n\n\t\tconst prevTexture = this._previousTextures[ name ];\n\n\t\tif ( prevTexture !== undefined ) {\n\n\t\t\tconst texture = this._textures[ name ];\n\n\t\t\tconst index = this.renderTarget.textures.indexOf( texture );\n\t\t\tthis.renderTarget.textures[ index ] = prevTexture;\n\n\t\t\tthis._textures[ name ] = prevTexture;\n\t\t\tthis._previousTextures[ name ] = texture;\n\n\t\t\tthis._textureNodes[ name ].updateTexture();\n\t\t\tthis._previousTextureNodes[ name ].updateTexture();\n\n\t\t}\n\n\t}\n\n\tgetTextureNode( name = 'output' ) {\n\n\t\tlet textureNode = this._textureNodes[ name ];\n\n\t\tif ( textureNode === undefined ) {\n\n\t\t\ttextureNode = nodeObject( new PassMultipleTextureNode( this, name ) );\n\t\t\ttextureNode.updateTexture();\n\t\t\tthis._textureNodes[ name ] = textureNode;\n\n\t\t}\n\n\t\treturn textureNode;\n\n\t}\n\n\tgetPreviousTextureNode( name = 'output' ) {\n\n\t\tlet textureNode = this._previousTextureNodes[ name ];\n\n\t\tif ( textureNode === undefined ) {\n\n\t\t\tif ( this._textureNodes[ name ] === undefined ) this.getTextureNode( name );\n\n\t\t\ttextureNode = nodeObject( new PassMultipleTextureNode( this, name, true ) );\n\t\t\ttextureNode.updateTexture();\n\t\t\tthis._previousTextureNodes[ name ] = textureNode;\n\n\t\t}\n\n\t\treturn textureNode;\n\n\t}\n\n\tgetViewZNode( name = 'depth' ) {\n\n\t\tlet viewZNode = this._viewZNodes[ name ];\n\n\t\tif ( viewZNode === undefined ) {\n\n\t\t\tconst cameraNear = this._cameraNear;\n\t\t\tconst cameraFar = this._cameraFar;\n\n\t\t\tthis._viewZNodes[ name ] = viewZNode = perspectiveDepthToViewZ( this.getTextureNode( name ), cameraNear, cameraFar );\n\n\t\t}\n\n\t\treturn viewZNode;\n\n\t}\n\n\tgetLinearDepthNode( name = 'depth' ) {\n\n\t\tlet linearDepthNode = this._linearDepthNodes[ name ];\n\n\t\tif ( linearDepthNode === undefined ) {\n\n\t\t\tconst cameraNear = this._cameraNear;\n\t\t\tconst cameraFar = this._cameraFar;\n\t\t\tconst viewZNode = this.getViewZNode( name );\n\n\t\t\t// TODO: just if ( builder.camera.isPerspectiveCamera )\n\n\t\t\tthis._linearDepthNodes[ name ] = linearDepthNode = viewZToOrthographicDepth( viewZNode, cameraNear, cameraFar );\n\n\t\t}\n\n\t\treturn linearDepthNode;\n\n\t}\n\n\tsetup( { renderer } ) {\n\n\t\tthis.renderTarget.samples = this.options.samples === undefined ? renderer.samples : this.options.samples;\n\n\t\t// Disable MSAA for WebGL backend for now\n\t\tif ( renderer.backend.isWebGLBackend === true ) {\n\n\t\t\tthis.renderTarget.samples = 0;\n\n\t\t}\n\n\t\tthis.renderTarget.depthTexture.isMultisampleRenderTargetTexture = this.renderTarget.samples > 1;\n\n\t\treturn this.scope === PassNode.COLOR ? this.getTextureNode() : this.getLinearDepthNode();\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst { renderer } = frame;\n\t\tconst { scene, camera } = this;\n\n\t\tthis._pixelRatio = renderer.getPixelRatio();\n\n\t\tconst size = renderer.getSize( _size );\n\n\t\tthis.setSize( size.width, size.height );\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\t\tconst currentMRT = renderer.getMRT();\n\n\t\tthis._cameraNear.value = camera.near;\n\t\tthis._cameraFar.value = camera.far;\n\n\t\tfor ( const name in this._previousTextures ) {\n\n\t\t\tthis.toggleTexture( name );\n\n\t\t}\n\n\t\trenderer.setRenderTarget( this.renderTarget );\n\t\trenderer.setMRT( this._mrt );\n\n\t\trenderer.render( scene, camera );\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\t\trenderer.setMRT( currentMRT );\n\n\t}\n\n\tsetSize( width, height ) {\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tconst effectiveWidth = this._width * this._pixelRatio;\n\t\tconst effectiveHeight = this._height * this._pixelRatio;\n\n\t\tthis.renderTarget.setSize( effectiveWidth, effectiveHeight );\n\n\t}\n\n\tsetPixelRatio( pixelRatio ) {\n\n\t\tthis._pixelRatio = pixelRatio;\n\n\t\tthis.setSize( this._width, this._height );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.renderTarget.dispose();\n\n\t}\n\n\n}\n\nPassNode.COLOR = 'color';\nPassNode.DEPTH = 'depth';\n\nconst pass = ( scene, camera, options ) => nodeObject( new PassNode( PassNode.COLOR, scene, camera, options ) );\nconst passTexture = ( pass, texture ) => nodeObject( new PassTextureNode( pass, texture ) );\nconst depthPass = ( scene, camera ) => nodeObject( new PassNode( PassNode.DEPTH, scene, camera ) );\n\nclass ToonOutlinePassNode extends PassNode {\n\n\tstatic get type() {\n\n\t\treturn 'ToonOutlinePassNode';\n\n\t}\n\n\tconstructor( scene, camera, colorNode, thicknessNode, alphaNode ) {\n\n\t\tsuper( PassNode.COLOR, scene, camera );\n\n\t\tthis.colorNode = colorNode;\n\t\tthis.thicknessNode = thicknessNode;\n\t\tthis.alphaNode = alphaNode;\n\n\t\tthis._materialCache = new WeakMap();\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst { renderer } = frame;\n\n\t\tconst currentRenderObjectFunction = renderer.getRenderObjectFunction();\n\n\t\trenderer.setRenderObjectFunction( ( object, scene, camera, geometry, material, group, lightsNode, clippingContext ) => {\n\n\t\t\t// only render outline for supported materials\n\n\t\t\tif ( material.isMeshToonMaterial || material.isMeshToonNodeMaterial ) {\n\n\t\t\t\tif ( material.wireframe === false ) {\n\n\t\t\t\t\tconst outlineMaterial = this._getOutlineMaterial( material );\n\t\t\t\t\trenderer.renderObject( object, scene, camera, geometry, outlineMaterial, group, lightsNode, clippingContext );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// default\n\n\t\t\trenderer.renderObject( object, scene, camera, geometry, material, group, lightsNode, clippingContext );\n\n\t\t} );\n\n\t\tsuper.updateBefore( frame );\n\n\t\trenderer.setRenderObjectFunction( currentRenderObjectFunction );\n\n\t}\n\n\t_createMaterial() {\n\n\t\tconst material = new NodeMaterial();\n\t\tmaterial.isMeshToonOutlineMaterial = true;\n\t\tmaterial.name = 'Toon_Outline';\n\t\tmaterial.side = BackSide;\n\n\t\t// vertex node\n\n\t\tconst outlineNormal = normalLocal.negate();\n\t\tconst mvp = cameraProjectionMatrix.mul( modelViewMatrix );\n\n\t\tconst ratio = float( 1.0 ); // TODO: support outline thickness ratio for each vertex\n\t\tconst pos = mvp.mul( vec4( positionLocal, 1.0 ) );\n\t\tconst pos2 = mvp.mul( vec4( positionLocal.add( outlineNormal ), 1.0 ) );\n\t\tconst norm = normalize( pos.sub( pos2 ) ); // NOTE: subtract pos2 from pos because BackSide objectNormal is negative\n\n\t\tmaterial.vertexNode = pos.add( norm.mul( this.thicknessNode ).mul( pos.w ).mul( ratio ) );\n\n\t\t// color node\n\n\t\tmaterial.colorNode = vec4( this.colorNode, this.alphaNode );\n\n\t\treturn material;\n\n\t}\n\n\t_getOutlineMaterial( originalMaterial ) {\n\n\t\tlet outlineMaterial = this._materialCache.get( originalMaterial );\n\n\t\tif ( outlineMaterial === undefined ) {\n\n\t\t\toutlineMaterial = this._createMaterial();\n\n\t\t\tthis._materialCache.set( originalMaterial, outlineMaterial );\n\n\t\t}\n\n\t\treturn outlineMaterial;\n\n\t}\n\n}\n\nconst toonOutlinePass = ( scene, camera, color = new Color( 0, 0, 0 ), thickness = 0.003, alpha = 1 ) => nodeObject( new ToonOutlinePassNode( scene, camera, nodeObject( color ), nodeObject( thickness ), nodeObject( alpha ) ) );\n\n// exposure only\n\nconst linearToneMapping = /*@__PURE__*/ Fn( ( [ color, exposure ] ) => {\n\n\treturn color.mul( exposure ).clamp();\n\n} ).setLayout( {\n\tname: 'linearToneMapping',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' },\n\t\t{ name: 'exposure', type: 'float' }\n\t]\n} );\n\n// source: https://www.cs.utah.edu/docs/techreports/2002/pdf/UUCS-02-001.pdf\n\nconst reinhardToneMapping = /*@__PURE__*/ Fn( ( [ color, exposure ] ) => {\n\n\tcolor = color.mul( exposure );\n\n\treturn color.div( color.add( 1.0 ) ).clamp();\n\n} ).setLayout( {\n\tname: 'reinhardToneMapping',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' },\n\t\t{ name: 'exposure', type: 'float' }\n\t]\n} );\n\n// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/\n\nconst cineonToneMapping = /*@__PURE__*/ Fn( ( [ color, exposure ] ) => {\n\n\t// filmic operator by Jim Hejl and Richard Burgess-Dawson\n\tcolor = color.mul( exposure );\n\tcolor = color.sub( 0.004 ).max( 0.0 );\n\n\tconst a = color.mul( color.mul( 6.2 ).add( 0.5 ) );\n\tconst b = color.mul( color.mul( 6.2 ).add( 1.7 ) ).add( 0.06 );\n\n\treturn a.div( b ).pow( 2.2 );\n\n} ).setLayout( {\n\tname: 'cineonToneMapping',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' },\n\t\t{ name: 'exposure', type: 'float' }\n\t]\n} );\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\n\nconst RRTAndODTFit = /*@__PURE__*/ Fn( ( [ color ] ) => {\n\n\tconst a = color.mul( color.add( 0.0245786 ) ).sub( 0.000090537 );\n\tconst b = color.mul( color.add( 0.4329510 ).mul( 0.983729 ) ).add( 0.238081 );\n\n\treturn a.div( b );\n\n} );\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\n\nconst acesFilmicToneMapping = /*@__PURE__*/ Fn( ( [ color, exposure ] ) => {\n\n\t// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT\n\tconst ACESInputMat = mat3(\n\t\t0.59719, 0.35458, 0.04823,\n\t\t0.07600, 0.90834, 0.01566,\n\t\t0.02840, 0.13383, 0.83777\n\t);\n\n\t// ODT_SAT => XYZ => D60_2_D65 => sRGB\n\tconst ACESOutputMat = mat3(\n\t\t1.60475, - 0.53108, - 0.07367,\n\t\t- 0.10208, 1.10813, - 0.00605,\n\t\t- 0.00327, - 0.07276, 1.07602\n\t);\n\n\tcolor = color.mul( exposure ).div( 0.6 );\n\n\tcolor = ACESInputMat.mul( color );\n\n\t// Apply RRT and ODT\n\tcolor = RRTAndODTFit( color );\n\n\tcolor = ACESOutputMat.mul( color );\n\n\t// Clamp to [0, 1]\n\treturn color.clamp();\n\n} ).setLayout( {\n\tname: 'acesFilmicToneMapping',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' },\n\t\t{ name: 'exposure', type: 'float' }\n\t]\n} );\n\nconst LINEAR_REC2020_TO_LINEAR_SRGB = /*@__PURE__*/ mat3( vec3( 1.6605, - 0.1246, - 0.0182 ), vec3( - 0.5876, 1.1329, - 0.1006 ), vec3( - 0.0728, - 0.0083, 1.1187 ) );\nconst LINEAR_SRGB_TO_LINEAR_REC2020 = /*@__PURE__*/ mat3( vec3( 0.6274, 0.0691, 0.0164 ), vec3( 0.3293, 0.9195, 0.0880 ), vec3( 0.0433, 0.0113, 0.8956 ) );\n\nconst agxDefaultContrastApprox = /*@__PURE__*/ Fn( ( [ x_immutable ] ) => {\n\n\tconst x = vec3( x_immutable ).toVar();\n\tconst x2 = vec3( x.mul( x ) ).toVar();\n\tconst x4 = vec3( x2.mul( x2 ) ).toVar();\n\n\treturn float( 15.5 ).mul( x4.mul( x2 ) ).sub( mul( 40.14, x4.mul( x ) ) ).add( mul( 31.96, x4 ).sub( mul( 6.868, x2.mul( x ) ) ).add( mul( 0.4298, x2 ).add( mul( 0.1191, x ).sub( 0.00232 ) ) ) );\n\n} );\n\nconst agxToneMapping = /*@__PURE__*/ Fn( ( [ color, exposure ] ) => {\n\n\tconst colortone = vec3( color ).toVar();\n\tconst AgXInsetMatrix = mat3( vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ), vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ), vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 ) );\n\tconst AgXOutsetMatrix = mat3( vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ), vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ), vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 ) );\n\tconst AgxMinEv = float( - 12.47393 );\n\tconst AgxMaxEv = float( 4.026069 );\n\tcolortone.mulAssign( exposure );\n\tcolortone.assign( LINEAR_SRGB_TO_LINEAR_REC2020.mul( colortone ) );\n\tcolortone.assign( AgXInsetMatrix.mul( colortone ) );\n\tcolortone.assign( max$1( colortone, 1e-10 ) );\n\tcolortone.assign( log2( colortone ) );\n\tcolortone.assign( colortone.sub( AgxMinEv ).div( AgxMaxEv.sub( AgxMinEv ) ) );\n\tcolortone.assign( clamp( colortone, 0.0, 1.0 ) );\n\tcolortone.assign( agxDefaultContrastApprox( colortone ) );\n\tcolortone.assign( AgXOutsetMatrix.mul( colortone ) );\n\tcolortone.assign( pow( max$1( vec3( 0.0 ), colortone ), vec3( 2.2 ) ) );\n\tcolortone.assign( LINEAR_REC2020_TO_LINEAR_SRGB.mul( colortone ) );\n\tcolortone.assign( clamp( colortone, 0.0, 1.0 ) );\n\n\treturn colortone;\n\n} ).setLayout( {\n\tname: 'agxToneMapping',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' },\n\t\t{ name: 'exposure', type: 'float' }\n\t]\n} );\n\n// https://modelviewer.dev/examples/tone-mapping\n\nconst neutralToneMapping = /*@__PURE__*/ Fn( ( [ color, exposure ] ) => {\n\n\tconst StartCompression = float( 0.8 - 0.04 );\n\tconst Desaturation = float( 0.15 );\n\n\tcolor = color.mul( exposure );\n\n\tconst x = min$1( color.r, min$1( color.g, color.b ) );\n\tconst offset = select( x.lessThan( 0.08 ), x.sub( mul( 6.25, x.mul( x ) ) ), 0.04 );\n\n\tcolor.subAssign( offset );\n\n\tconst peak = max$1( color.r, max$1( color.g, color.b ) );\n\n\tIf( peak.lessThan( StartCompression ), () => {\n\n\t\treturn color;\n\n\t} );\n\n\tconst d = sub( 1, StartCompression );\n\tconst newPeak = sub( 1, d.mul( d ).div( peak.add( d.sub( StartCompression ) ) ) );\n\tcolor.mulAssign( newPeak.div( peak ) );\n\tconst g = sub( 1, div( 1, Desaturation.mul( peak.sub( newPeak ) ).add( 1 ) ) );\n\n\treturn mix( color, vec3( newPeak ), g );\n\n} ).setLayout( {\n\tname: 'neutralToneMapping',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' },\n\t\t{ name: 'exposure', type: 'float' }\n\t]\n} );\n\nclass CodeNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'CodeNode';\n\n\t}\n\n\tconstructor( code = '', includes = [], language = '' ) {\n\n\t\tsuper( 'code' );\n\n\t\tthis.isCodeNode = true;\n\n\t\tthis.code = code;\n\t\tthis.language = language;\n\n\t\tthis.includes = includes;\n\n\t}\n\n\tisGlobal() {\n\n\t\treturn true;\n\n\t}\n\n\tsetIncludes( includes ) {\n\n\t\tthis.includes = includes;\n\n\t\treturn this;\n\n\t}\n\n\tgetIncludes( /*builder*/ ) {\n\n\t\treturn this.includes;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst includes = this.getIncludes( builder );\n\n\t\tfor ( const include of includes ) {\n\n\t\t\tinclude.build( builder );\n\n\t\t}\n\n\t\tconst nodeCode = builder.getCodeFromNode( this, this.getNodeType( builder ) );\n\t\tnodeCode.code = this.code;\n\n\t\treturn nodeCode.code;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.code = this.code;\n\t\tdata.language = this.language;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.code = data.code;\n\t\tthis.language = data.language;\n\n\t}\n\n}\n\nconst code = /*@__PURE__*/ nodeProxy( CodeNode );\n\nconst js = ( src, includes ) => code( src, includes, 'js' );\nconst wgsl = ( src, includes ) => code( src, includes, 'wgsl' );\nconst glsl = ( src, includes ) => code( src, includes, 'glsl' );\n\nclass FunctionNode extends CodeNode {\n\n\tstatic get type() {\n\n\t\treturn 'FunctionNode';\n\n\t}\n\n\tconstructor( code = '', includes = [], language = '' ) {\n\n\t\tsuper( code, includes, language );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.getNodeFunction( builder ).type;\n\n\t}\n\n\tgetInputs( builder ) {\n\n\t\treturn this.getNodeFunction( builder ).inputs;\n\n\t}\n\n\tgetNodeFunction( builder ) {\n\n\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\tlet nodeFunction = nodeData.nodeFunction;\n\n\t\tif ( nodeFunction === undefined ) {\n\n\t\t\tnodeFunction = builder.parser.parseFunction( this.code );\n\n\t\t\tnodeData.nodeFunction = nodeFunction;\n\n\t\t}\n\n\t\treturn nodeFunction;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tsuper.generate( builder );\n\n\t\tconst nodeFunction = this.getNodeFunction( builder );\n\n\t\tconst name = nodeFunction.name;\n\t\tconst type = nodeFunction.type;\n\n\t\tconst nodeCode = builder.getCodeFromNode( this, type );\n\n\t\tif ( name !== '' ) {\n\n\t\t\t// use a custom property name\n\n\t\t\tnodeCode.name = name;\n\n\t\t}\n\n\t\tconst propertyName = builder.getPropertyName( nodeCode );\n\n\t\tconst code = this.getNodeFunction( builder ).getCode( propertyName );\n\n\t\tnodeCode.code = code + '\\n';\n\n\t\tif ( output === 'property' ) {\n\n\t\t\treturn propertyName;\n\n\t\t} else {\n\n\t\t\treturn builder.format( `${ propertyName }()`, type, output );\n\n\t\t}\n\n\t}\n\n}\n\nconst nativeFn = ( code, includes = [], language = '' ) => {\n\n\tfor ( let i = 0; i < includes.length; i ++ ) {\n\n\t\tconst include = includes[ i ];\n\n\t\t// TSL Function: glslFn, wgslFn\n\n\t\tif ( typeof include === 'function' ) {\n\n\t\t\tincludes[ i ] = include.functionNode;\n\n\t\t}\n\n\t}\n\n\tconst functionNode = nodeObject( new FunctionNode( code, includes, language ) );\n\n\tconst fn = ( ...params ) => functionNode.call( ...params );\n\tfn.functionNode = functionNode;\n\n\treturn fn;\n\n};\n\nconst glslFn = ( code, includes ) => nativeFn( code, includes, 'glsl' );\nconst wgslFn = ( code, includes ) => nativeFn( code, includes, 'wgsl' );\n\nclass ScriptableValueNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ScriptableValueNode';\n\n\t}\n\n\tconstructor( value = null ) {\n\n\t\tsuper();\n\n\t\tthis._value = value;\n\t\tthis._cache = null;\n\n\t\tthis.inputType = null;\n\t\tthis.outpuType = null;\n\n\t\tthis.events = new EventDispatcher();\n\n\t\tthis.isScriptableValueNode = true;\n\n\t}\n\n\tget isScriptableOutputNode() {\n\n\t\treturn this.outputType !== null;\n\n\t}\n\n\tset value( val ) {\n\n\t\tif ( this._value === val ) return;\n\n\t\tif ( this._cache && this.inputType === 'URL' && this.value.value instanceof ArrayBuffer ) {\n\n\t\t\tURL.revokeObjectURL( this._cache );\n\n\t\t\tthis._cache = null;\n\n\t\t}\n\n\t\tthis._value = val;\n\n\t\tthis.events.dispatchEvent( { type: 'change' } );\n\n\t\tthis.refresh();\n\n\t}\n\n\tget value() {\n\n\t\treturn this._value;\n\n\t}\n\n\trefresh() {\n\n\t\tthis.events.dispatchEvent( { type: 'refresh' } );\n\n\t}\n\n\tgetValue() {\n\n\t\tconst value = this.value;\n\n\t\tif ( value && this._cache === null && this.inputType === 'URL' && value.value instanceof ArrayBuffer ) {\n\n\t\t\tthis._cache = URL.createObjectURL( new Blob( [ value.value ] ) );\n\n\t\t} else if ( value && value.value !== null && value.value !== undefined && (\n\t\t\t( ( this.inputType === 'URL' || this.inputType === 'String' ) && typeof value.value === 'string' ) ||\n\t\t\t( this.inputType === 'Number' && typeof value.value === 'number' ) ||\n\t\t\t( this.inputType === 'Vector2' && value.value.isVector2 ) ||\n\t\t\t( this.inputType === 'Vector3' && value.value.isVector3 ) ||\n\t\t\t( this.inputType === 'Vector4' && value.value.isVector4 ) ||\n\t\t\t( this.inputType === 'Color' && value.value.isColor ) ||\n\t\t\t( this.inputType === 'Matrix3' && value.value.isMatrix3 ) ||\n\t\t\t( this.inputType === 'Matrix4' && value.value.isMatrix4 )\n\t\t) ) {\n\n\t\t\treturn value.value;\n\n\t\t}\n\n\t\treturn this._cache || value;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.value && this.value.isNode ? this.value.getNodeType( builder ) : 'float';\n\n\t}\n\n\tsetup() {\n\n\t\treturn this.value && this.value.isNode ? this.value : float();\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tif ( this.value !== null ) {\n\n\t\t\tif ( this.inputType === 'ArrayBuffer' ) {\n\n\t\t\t\tdata.value = arrayBufferToBase64( this.value );\n\n\t\t\t} else {\n\n\t\t\t\tdata.value = this.value ? this.value.toJSON( data.meta ).uuid : null;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tdata.value = null;\n\n\t\t}\n\n\t\tdata.inputType = this.inputType;\n\t\tdata.outputType = this.outputType;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tlet value = null;\n\n\t\tif ( data.value !== null ) {\n\n\t\t\tif ( data.inputType === 'ArrayBuffer' ) {\n\n\t\t\t\tvalue = base64ToArrayBuffer( data.value );\n\n\t\t\t} else if ( data.inputType === 'Texture' ) {\n\n\t\t\t\tvalue = data.meta.textures[ data.value ];\n\n\t\t\t} else {\n\n\t\t\t\tvalue = data.meta.nodes[ data.value ] || null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.value = value;\n\n\t\tthis.inputType = data.inputType;\n\t\tthis.outputType = data.outputType;\n\n\t}\n\n}\n\nconst scriptableValue = /*@__PURE__*/ nodeProxy( ScriptableValueNode );\n\nclass Resources extends Map {\n\n\tget( key, callback = null, ...params ) {\n\n\t\tif ( this.has( key ) ) return super.get( key );\n\n\t\tif ( callback !== null ) {\n\n\t\t\tconst value = callback( ...params );\n\t\t\tthis.set( key, value );\n\t\t\treturn value;\n\n\t\t}\n\n\t}\n\n}\n\nclass Parameters {\n\n\tconstructor( scriptableNode ) {\n\n\t\tthis.scriptableNode = scriptableNode;\n\n\t}\n\n\tget parameters() {\n\n\t\treturn this.scriptableNode.parameters;\n\n\t}\n\n\tget layout() {\n\n\t\treturn this.scriptableNode.getLayout();\n\n\t}\n\n\tgetInputLayout( id ) {\n\n\t\treturn this.scriptableNode.getInputLayout( id );\n\n\t}\n\n\tget( name ) {\n\n\t\tconst param = this.parameters[ name ];\n\t\tconst value = param ? param.getValue() : null;\n\n\t\treturn value;\n\n\t}\n\n}\n\nconst ScriptableNodeResources = new Resources();\n\nclass ScriptableNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ScriptableNode';\n\n\t}\n\n\tconstructor( codeNode = null, parameters = {} ) {\n\n\t\tsuper();\n\n\t\tthis.codeNode = codeNode;\n\t\tthis.parameters = parameters;\n\n\t\tthis._local = new Resources();\n\t\tthis._output = scriptableValue();\n\t\tthis._outputs = {};\n\t\tthis._source = this.source;\n\t\tthis._method = null;\n\t\tthis._object = null;\n\t\tthis._value = null;\n\t\tthis._needsOutputUpdate = true;\n\n\t\tthis.onRefresh = this.onRefresh.bind( this );\n\n\t\tthis.isScriptableNode = true;\n\n\t}\n\n\tget source() {\n\n\t\treturn this.codeNode ? this.codeNode.code : '';\n\n\t}\n\n\tsetLocal( name, value ) {\n\n\t\treturn this._local.set( name, value );\n\n\t}\n\n\tgetLocal( name ) {\n\n\t\treturn this._local.get( name );\n\n\t}\n\n\tonRefresh() {\n\n\t\tthis._refresh();\n\n\t}\n\n\tgetInputLayout( id ) {\n\n\t\tfor ( const element of this.getLayout() ) {\n\n\t\t\tif ( element.inputType && ( element.id === id || element.name === id ) ) {\n\n\t\t\t\treturn element;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgetOutputLayout( id ) {\n\n\t\tfor ( const element of this.getLayout() ) {\n\n\t\t\tif ( element.outputType && ( element.id === id || element.name === id ) ) {\n\n\t\t\t\treturn element;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetOutput( name, value ) {\n\n\t\tconst outputs = this._outputs;\n\n\t\tif ( outputs[ name ] === undefined ) {\n\n\t\t\toutputs[ name ] = scriptableValue( value );\n\n\t\t} else {\n\n\t\t\toutputs[ name ].value = value;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetOutput( name ) {\n\n\t\treturn this._outputs[ name ];\n\n\t}\n\n\tgetParameter( name ) {\n\n\t\treturn this.parameters[ name ];\n\n\t}\n\n\tsetParameter( name, value ) {\n\n\t\tconst parameters = this.parameters;\n\n\t\tif ( value && value.isScriptableNode ) {\n\n\t\t\tthis.deleteParameter( name );\n\n\t\t\tparameters[ name ] = value;\n\t\t\tparameters[ name ].getDefaultOutput().events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t} else if ( value && value.isScriptableValueNode ) {\n\n\t\t\tthis.deleteParameter( name );\n\n\t\t\tparameters[ name ] = value;\n\t\t\tparameters[ name ].events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t} else if ( parameters[ name ] === undefined ) {\n\n\t\t\tparameters[ name ] = scriptableValue( value );\n\t\t\tparameters[ name ].events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t} else {\n\n\t\t\tparameters[ name ].value = value;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.getDefaultOutput().getValue();\n\n\t}\n\n\tdeleteParameter( name ) {\n\n\t\tlet valueNode = this.parameters[ name ];\n\n\t\tif ( valueNode ) {\n\n\t\t\tif ( valueNode.isScriptableNode ) valueNode = valueNode.getDefaultOutput();\n\n\t\t\tvalueNode.events.removeEventListener( 'refresh', this.onRefresh );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclearParameters() {\n\n\t\tfor ( const name of Object.keys( this.parameters ) ) {\n\n\t\t\tthis.deleteParameter( name );\n\n\t\t}\n\n\t\tthis.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\tcall( name, ...params ) {\n\n\t\tconst object = this.getObject();\n\t\tconst method = object[ name ];\n\n\t\tif ( typeof method === 'function' ) {\n\n\t\t\treturn method( ...params );\n\n\t\t}\n\n\t}\n\n\tasync callAsync( name, ...params ) {\n\n\t\tconst object = this.getObject();\n\t\tconst method = object[ name ];\n\n\t\tif ( typeof method === 'function' ) {\n\n\t\t\treturn method.constructor.name === 'AsyncFunction' ? await method( ...params ) : method( ...params );\n\n\t\t}\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.getDefaultOutputNode().getNodeType( builder );\n\n\t}\n\n\trefresh( output = null ) {\n\n\t\tif ( output !== null ) {\n\n\t\t\tthis.getOutput( output ).refresh();\n\n\t\t} else {\n\n\t\t\tthis._refresh();\n\n\t\t}\n\n\t}\n\n\tgetObject() {\n\n\t\tif ( this.needsUpdate ) this.dispose();\n\t\tif ( this._object !== null ) return this._object;\n\n\t\t//\n\n\t\tconst refresh = () => this.refresh();\n\t\tconst setOutput = ( id, value ) => this.setOutput( id, value );\n\n\t\tconst parameters = new Parameters( this );\n\n\t\tconst THREE = ScriptableNodeResources.get( 'THREE' );\n\t\tconst TSL = ScriptableNodeResources.get( 'TSL' );\n\n\t\tconst method = this.getMethod( this.codeNode );\n\t\tconst params = [ parameters, this._local, ScriptableNodeResources, refresh, setOutput, THREE, TSL ];\n\n\t\tthis._object = method( ...params );\n\n\t\tconst layout = this._object.layout;\n\n\t\tif ( layout ) {\n\n\t\t\tif ( layout.cache === false ) {\n\n\t\t\t\tthis._local.clear();\n\n\t\t\t}\n\n\t\t\t// default output\n\t\t\tthis._output.outputType = layout.outputType || null;\n\n\t\t\tif ( Array.isArray( layout.elements ) ) {\n\n\t\t\t\tfor ( const element of layout.elements ) {\n\n\t\t\t\t\tconst id = element.id || element.name;\n\n\t\t\t\t\tif ( element.inputType ) {\n\n\t\t\t\t\t\tif ( this.getParameter( id ) === undefined ) this.setParameter( id, null );\n\n\t\t\t\t\t\tthis.getParameter( id ).inputType = element.inputType;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( element.outputType ) {\n\n\t\t\t\t\t\tif ( this.getOutput( id ) === undefined ) this.setOutput( id, null );\n\n\t\t\t\t\t\tthis.getOutput( id ).outputType = element.outputType;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this._object;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tfor ( const name in this.parameters ) {\n\n\t\t\tlet valueNode = this.parameters[ name ];\n\n\t\t\tif ( valueNode.isScriptableNode ) valueNode = valueNode.getDefaultOutput();\n\n\t\t\tvalueNode.events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t}\n\n\t}\n\n\tgetLayout() {\n\n\t\treturn this.getObject().layout;\n\n\t}\n\n\tgetDefaultOutputNode() {\n\n\t\tconst output = this.getDefaultOutput().value;\n\n\t\tif ( output && output.isNode ) {\n\n\t\t\treturn output;\n\n\t\t}\n\n\t\treturn float();\n\n\t}\n\n\tgetDefaultOutput()\t{\n\n\t\treturn this._exec()._output;\n\n\t}\n\n\tgetMethod() {\n\n\t\tif ( this.needsUpdate ) this.dispose();\n\t\tif ( this._method !== null ) return this._method;\n\n\t\t//\n\n\t\tconst parametersProps = [ 'parameters', 'local', 'global', 'refresh', 'setOutput', 'THREE', 'TSL' ];\n\t\tconst interfaceProps = [ 'layout', 'init', 'main', 'dispose' ];\n\n\t\tconst properties = interfaceProps.join( ', ' );\n\t\tconst declarations = 'var ' + properties + '; var output = {};\\n';\n\t\tconst returns = '\\nreturn { ...output, ' + properties + ' };';\n\n\t\tconst code = declarations + this.codeNode.code + returns;\n\n\t\t//\n\n\t\tthis._method = new Function( ...parametersProps, code );\n\n\t\treturn this._method;\n\n\t}\n\n\tdispose() {\n\n\t\tif ( this._method === null ) return;\n\n\t\tif ( this._object && typeof this._object.dispose === 'function' ) {\n\n\t\t\tthis._object.dispose();\n\n\t\t}\n\n\t\tthis._method = null;\n\t\tthis._object = null;\n\t\tthis._source = null;\n\t\tthis._value = null;\n\t\tthis._needsOutputUpdate = true;\n\t\tthis._output.value = null;\n\t\tthis._outputs = {};\n\n\t}\n\n\tsetup() {\n\n\t\treturn this.getDefaultOutputNode();\n\n\t}\n\n\tgetCacheKey( force ) {\n\n\t\tconst values = [ hashString( this.source ), this.getDefaultOutputNode().getCacheKey( force ) ];\n\n\t\tfor ( const param in this.parameters ) {\n\n\t\t\tvalues.push( this.parameters[ param ].getCacheKey( force ) );\n\n\t\t}\n\n\t\treturn hashArray( values );\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.dispose();\n\n\t}\n\n\tget needsUpdate() {\n\n\t\treturn this.source !== this._source;\n\n\t}\n\n\t_exec()\t{\n\n\t\tif ( this.codeNode === null ) return this;\n\n\t\tif ( this._needsOutputUpdate === true ) {\n\n\t\t\tthis._value = this.call( 'main' );\n\n\t\t\tthis._needsOutputUpdate = false;\n\n\t\t}\n\n\t\tthis._output.value = this._value;\n\n\t\treturn this;\n\n\t}\n\n\t_refresh() {\n\n\t\tthis.needsUpdate = true;\n\n\t\tthis._exec();\n\n\t\tthis._output.refresh();\n\n\t}\n\n}\n\nconst scriptable = /*@__PURE__*/ nodeProxy( ScriptableNode );\n\nclass FogNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'FogNode';\n\n\t}\n\n\tconstructor( colorNode, factorNode ) {\n\n\t\tsuper( 'float' );\n\n\t\tthis.isFogNode = true;\n\n\t\tthis.colorNode = colorNode;\n\t\tthis.factorNode = factorNode;\n\n\t}\n\n\tgetViewZNode( builder ) {\n\n\t\tlet viewZ;\n\n\t\tconst getViewZ = builder.context.getViewZ;\n\n\t\tif ( getViewZ !== undefined ) {\n\n\t\t\tviewZ = getViewZ( this );\n\n\t\t}\n\n\t\treturn ( viewZ || positionView.z ).negate();\n\n\t}\n\n\tsetup() {\n\n\t\treturn this.factorNode;\n\n\t}\n\n}\n\nconst fog = /*@__PURE__*/ nodeProxy( FogNode );\n\nclass FogRangeNode extends FogNode {\n\n\tstatic get type() {\n\n\t\treturn 'FogRangeNode';\n\n\t}\n\n\tconstructor( colorNode, nearNode, farNode ) {\n\n\t\tsuper( colorNode );\n\n\t\tthis.isFogRangeNode = true;\n\n\t\tthis.nearNode = nearNode;\n\t\tthis.farNode = farNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst viewZ = this.getViewZNode( builder );\n\n\t\treturn smoothstep( this.nearNode, this.farNode, viewZ );\n\n\t}\n\n}\n\nconst rangeFog = /*@__PURE__*/ nodeProxy( FogRangeNode );\n\nclass FogExp2Node extends FogNode {\n\n\tstatic get type() {\n\n\t\treturn 'FogExp2Node';\n\n\t}\n\n\tconstructor( colorNode, densityNode ) {\n\n\t\tsuper( colorNode );\n\n\t\tthis.isFogExp2Node = true;\n\n\t\tthis.densityNode = densityNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst viewZ = this.getViewZNode( builder );\n\t\tconst density = this.densityNode;\n\n\t\treturn density.mul( density, viewZ, viewZ ).negate().exp().oneMinus();\n\n\t}\n\n}\n\nconst densityFog = /*@__PURE__*/ nodeProxy( FogExp2Node );\n\nlet min = null;\nlet max = null;\n\nclass RangeNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'RangeNode';\n\n\t}\n\n\tconstructor( minNode = float(), maxNode = float() ) {\n\n\t\tsuper();\n\n\t\tthis.minNode = minNode;\n\t\tthis.maxNode = maxNode;\n\n\t}\n\n\tgetVectorLength( builder ) {\n\n\t\tconst minLength = builder.getTypeLength( getValueType( this.minNode.value ) );\n\t\tconst maxLength = builder.getTypeLength( getValueType( this.maxNode.value ) );\n\n\t\treturn minLength > maxLength ? minLength : maxLength;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn builder.object.count > 1 ? builder.getTypeFromLength( this.getVectorLength( builder ) ) : 'float';\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst object = builder.object;\n\n\t\tlet output = null;\n\n\t\tif ( object.count > 1 ) {\n\n\t\t\tconst minValue = this.minNode.value;\n\t\t\tconst maxValue = this.maxNode.value;\n\n\t\t\tconst minLength = builder.getTypeLength( getValueType( minValue ) );\n\t\t\tconst maxLength = builder.getTypeLength( getValueType( maxValue ) );\n\n\t\t\tmin = min || new Vector4();\n\t\t\tmax = max || new Vector4();\n\n\t\t\tmin.setScalar( 0 );\n\t\t\tmax.setScalar( 0 );\n\n\t\t\tif ( minLength === 1 ) min.setScalar( minValue );\n\t\t\telse if ( minValue.isColor ) min.set( minValue.r, minValue.g, minValue.b );\n\t\t\telse min.set( minValue.x, minValue.y, minValue.z || 0, minValue.w || 0 );\n\n\t\t\tif ( maxLength === 1 ) max.setScalar( maxValue );\n\t\t\telse if ( maxValue.isColor ) max.set( maxValue.r, maxValue.g, maxValue.b );\n\t\t\telse max.set( maxValue.x, maxValue.y, maxValue.z || 0, maxValue.w || 0 );\n\n\t\t\tconst stride = 4;\n\n\t\t\tconst length = stride * object.count;\n\t\t\tconst array = new Float32Array( length );\n\n\t\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\t\tconst index = i % stride;\n\n\t\t\t\tconst minElementValue = min.getComponent( index );\n\t\t\t\tconst maxElementValue = max.getComponent( index );\n\n\t\t\t\tarray[ i ] = MathUtils.lerp( minElementValue, maxElementValue, Math.random() );\n\n\t\t\t}\n\n\t\t\tconst nodeType = this.getNodeType( builder );\n\n\t\t\tif ( object.count <= 4096 ) {\n\n\t\t\t\toutput = buffer( array, 'vec4', object.count ).element( instanceIndex ).convert( nodeType );\n\n\t\t\t} else {\n\n\t\t\t\t// TODO: Improve anonymous buffer attribute creation removing this part\n\t\t\t\tconst bufferAttribute = new InstancedBufferAttribute( array, 4 );\n\t\t\t\tbuilder.geometry.setAttribute( '__range' + this.id, bufferAttribute );\n\n\t\t\t\toutput = instancedBufferAttribute( bufferAttribute ).convert( nodeType );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\toutput = float( 0 );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n}\n\nconst range = /*@__PURE__*/ nodeProxy( RangeNode );\n\nclass ComputeBuiltinNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ComputeBuiltinNode';\n\n\t}\n\n\tconstructor( builtinName, nodeType ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis._builtinName = builtinName;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\treturn this.getBuiltinName( builder );\n\n\t}\n\n\tgetNodeType( /*builder*/ ) {\n\n\t\treturn this.nodeType;\n\n\t}\n\n\tsetBuiltinName( builtinName ) {\n\n\t\tthis._builtinName = builtinName;\n\n\t\treturn this;\n\n\t}\n\n\tgetBuiltinName( /*builder*/ ) {\n\n\t\treturn this._builtinName;\n\n\t}\n\n\thasBuiltin( builder ) {\n\n\t\tbuilder.hasBuiltin( this._builtinName );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst builtinName = this.getBuiltinName( builder );\n\t\tconst nodeType = this.getNodeType( builder );\n\n\t\tif ( builder.shaderStage === 'compute' ) {\n\n\t\t\treturn builder.format( builtinName, nodeType, output );\n\n\t\t} else {\n\n\t\t\tconsole.warn( `ComputeBuiltinNode: Compute built-in value ${builtinName} can not be accessed in the ${builder.shaderStage} stage` );\n\t\t\treturn builder.generateConst( nodeType );\n\n\t\t}\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.global = this.global;\n\t\tdata._builtinName = this._builtinName;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.global = data.global;\n\t\tthis._builtinName = data._builtinName;\n\n\t}\n\n}\n\nconst computeBuiltin = ( name, nodeType ) => nodeObject( new ComputeBuiltinNode( name, nodeType ) );\n\nconst numWorkgroups = /*@__PURE__*/ computeBuiltin( 'numWorkgroups', 'uvec3' );\nconst workgroupId = /*@__PURE__*/ computeBuiltin( 'workgroupId', 'uvec3' );\nconst localId = /*@__PURE__*/ computeBuiltin( 'localId', 'uvec3' );\nconst subgroupSize = /*@__PURE__*/ computeBuiltin( 'subgroupSize', 'uint' );\n\nclass BarrierNode extends Node {\n\n\tconstructor( scope ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { scope } = this;\n\t\tconst { renderer } = builder;\n\n\t\tif ( renderer.backend.isWebGLBackend === true ) {\n\n\t\t\tbuilder.addFlowCode( `\\t// ${scope}Barrier \\n` );\n\n\t\t} else {\n\n\t\t\tbuilder.addLineFlowCode( `${scope}Barrier()`, this );\n\n\t\t}\n\n\t}\n\n}\n\nconst barrier = nodeProxy( BarrierNode );\n\nconst workgroupBarrier = () => barrier( 'workgroup' ).append();\nconst storageBarrier = () => barrier( 'storage' ).append();\nconst textureBarrier = () => barrier( 'texture' ).append();\n\nclass WorkgroupInfoElementNode extends ArrayElementNode {\n\n\tconstructor( workgroupInfoNode, indexNode ) {\n\n\t\tsuper( workgroupInfoNode, indexNode );\n\n\t\tthis.isWorkgroupInfoElementNode = true;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tlet snippet;\n\n\t\tconst isAssignContext = builder.context.assign;\n\t\tsnippet = super.generate( builder );\n\n\t\tif ( isAssignContext !== true ) {\n\n\t\t\tconst type = this.getNodeType( builder );\n\n\t\t\tsnippet = builder.format( snippet, type, output );\n\n\t\t}\n\n\t\t// TODO: Possibly activate clip distance index on index access rather than from clipping context\n\n\t\treturn snippet;\n\n\t}\n\n}\n\n\nclass WorkgroupInfoNode extends Node {\n\n\tconstructor( scope, bufferType, bufferCount = 0 ) {\n\n\t\tsuper( bufferType );\n\n\t\tthis.bufferType = bufferType;\n\t\tthis.bufferCount = bufferCount;\n\n\t\tthis.isWorkgroupInfoNode = true;\n\n\t\tthis.scope = scope;\n\n\t}\n\n\tlabel( name ) {\n\n\t\tthis.name = name;\n\n\t\treturn this;\n\n\t}\n\n\tgetHash() {\n\n\t\treturn this.uuid;\n\n\t}\n\n\tsetScope( scope ) {\n\n\t\tthis.scope = scope;\n\n\t\treturn this;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn `${this.scope}Array`;\n\n\t}\n\n\telement( indexNode ) {\n\n\t\treturn nodeObject( new WorkgroupInfoElementNode( this, indexNode ) );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\treturn builder.getScopedArray( this.name || `${this.scope}Array_${this.id}`, this.scope.toLowerCase(), this.bufferType, this.bufferCount );\n\n\t}\n\n}\n\nconst workgroupArray = ( type, count ) => nodeObject( new WorkgroupInfoNode( 'Workgroup', type, count ) );\n\nclass AtomicFunctionNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'AtomicFunctionNode';\n\n\t}\n\n\tconstructor( method, pointerNode, valueNode, storeNode = null ) {\n\n\t\tsuper( 'uint' );\n\n\t\tthis.method = method;\n\n\t\tthis.pointerNode = pointerNode;\n\t\tthis.valueNode = valueNode;\n\t\tthis.storeNode = storeNode;\n\n\t}\n\n\tgetInputType( builder ) {\n\n\t\treturn this.pointerNode.getNodeType( builder );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.getInputType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst method = this.method;\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst inputType = this.getInputType( builder );\n\n\t\tconst a = this.pointerNode;\n\t\tconst b = this.valueNode;\n\n\t\tconst params = [];\n\n\t\tparams.push( `&${ a.build( builder, inputType ) }` );\n\t\tparams.push( b.build( builder, inputType ) );\n\n\t\tconst methodSnippet = `${ builder.getMethod( method, type ) }( ${params.join( ', ' )} )`;\n\n\t\tif ( this.storeNode !== null ) {\n\n\t\t\tconst varSnippet = this.storeNode.build( builder, inputType );\n\n\t\t\tbuilder.addLineFlowCode( `${varSnippet} = ${methodSnippet}`, this );\n\n\t\t} else {\n\n\t\t\tbuilder.addLineFlowCode( methodSnippet, this );\n\n\t\t}\n\n\t}\n\n}\n\nAtomicFunctionNode.ATOMIC_LOAD = 'atomicLoad';\nAtomicFunctionNode.ATOMIC_STORE = 'atomicStore';\nAtomicFunctionNode.ATOMIC_ADD = 'atomicAdd';\nAtomicFunctionNode.ATOMIC_SUB = 'atomicSub';\nAtomicFunctionNode.ATOMIC_MAX = 'atomicMax';\nAtomicFunctionNode.ATOMIC_MIN = 'atomicMin';\nAtomicFunctionNode.ATOMIC_AND = 'atomicAnd';\nAtomicFunctionNode.ATOMIC_OR = 'atomicOr';\nAtomicFunctionNode.ATOMIC_XOR = 'atomicXor';\n\nconst atomicNode = nodeProxy( AtomicFunctionNode );\n\nconst atomicFunc = ( method, pointerNode, valueNode, storeNode ) => {\n\n\tconst node = atomicNode( method, pointerNode, valueNode, storeNode );\n\tnode.append();\n\n\treturn node;\n\n};\n\nconst atomicStore = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_STORE, pointerNode, valueNode, storeNode );\nconst atomicAdd = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_ADD, pointerNode, valueNode, storeNode );\nconst atomicSub = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_SUB, pointerNode, valueNode, storeNode );\nconst atomicMax = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_MAX, pointerNode, valueNode, storeNode );\nconst atomicMin = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_MIN, pointerNode, valueNode, storeNode );\nconst atomicAnd = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_AND, pointerNode, valueNode, storeNode );\nconst atomicOr = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_OR, pointerNode, valueNode, storeNode );\nconst atomicXor = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_XOR, pointerNode, valueNode, storeNode );\n\nlet uniformsLib;\n\nfunction getLightData( light ) {\n\n\tuniformsLib = uniformsLib || new WeakMap();\n\n\tlet uniforms = uniformsLib.get( light );\n\n\tif ( uniforms === undefined ) uniformsLib.set( light, uniforms = {} );\n\n\treturn uniforms;\n\n}\n\nfunction lightShadowMatrix( light ) {\n\n\tconst data = getLightData( light );\n\n\treturn data.shadowMatrix || ( data.shadowMatrix = uniform( 'mat4' ).setGroup( renderGroup ).onRenderUpdate( () => {\n\n\t\tlight.shadow.updateMatrices( light );\n\n\t\treturn light.shadow.matrix;\n\n\t} ) );\n\n}\n\nfunction lightProjectionUV( light ) {\n\n\tconst data = getLightData( light );\n\n\tif ( data.projectionUV === undefined ) {\n\n\t\tconst spotLightCoord = lightShadowMatrix( light ).mul( positionWorld );\n\n\t\tdata.projectionUV = spotLightCoord.xyz.div( spotLightCoord.w );\n\n\n\t}\n\n\treturn data.projectionUV;\n\n}\n\nfunction lightPosition( light ) {\n\n\tconst data = getLightData( light );\n\n\treturn data.position || ( data.position = uniform( new Vector3() ).setGroup( renderGroup ).onRenderUpdate( ( _, self ) => self.value.setFromMatrixPosition( light.matrixWorld ) ) );\n\n}\n\nfunction lightTargetPosition( light ) {\n\n\tconst data = getLightData( light );\n\n\treturn data.targetPosition || ( data.targetPosition = uniform( new Vector3() ).setGroup( renderGroup ).onRenderUpdate( ( _, self ) => self.value.setFromMatrixPosition( light.target.matrixWorld ) ) );\n\n}\n\nfunction lightViewPosition( light ) {\n\n\tconst data = getLightData( light );\n\n\treturn data.viewPosition || ( data.viewPosition = uniform( new Vector3() ).setGroup( renderGroup ).onRenderUpdate( ( { camera }, self ) => {\n\n\t\tself.value = self.value || new Vector3();\n\t\tself.value.setFromMatrixPosition( light.matrixWorld );\n\n\t\tself.value.applyMatrix4( camera.matrixWorldInverse );\n\n\t} ) );\n\n}\n\nconst lightTargetDirection = ( light ) => cameraViewMatrix.transformDirection( lightPosition( light ).sub( lightTargetPosition( light ) ) );\n\nconst sortLights = ( lights ) => {\n\n\treturn lights.sort( ( a, b ) => a.id - b.id );\n\n};\n\nconst getLightNodeById = ( id, lightNodes ) => {\n\n\tfor ( const lightNode of lightNodes ) {\n\n\t\tif ( lightNode.isAnalyticLightNode && lightNode.light.id === id ) {\n\n\t\t\treturn lightNode;\n\n\t\t}\n\n\t}\n\n\treturn null;\n\n};\n\nconst _lightsNodeRef = /*@__PURE__*/ new WeakMap();\n\nclass LightsNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'LightsNode';\n\n\t}\n\n\tconstructor() {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.totalDiffuseNode = vec3().toVar( 'totalDiffuse' );\n\t\tthis.totalSpecularNode = vec3().toVar( 'totalSpecular' );\n\n\t\tthis.outgoingLightNode = vec3().toVar( 'outgoingLight' );\n\n\t\tthis._lights = [];\n\n\t\tthis._lightNodes = null;\n\t\tthis._lightNodesHash = null;\n\n\t\tthis.global = true;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\tif ( this._lightNodesHash === null ) {\n\n\t\t\tif ( this._lightNodes === null ) this.setupLightsNode( builder );\n\n\t\t\tconst hash = [];\n\n\t\t\tfor ( const lightNode of this._lightNodes ) {\n\n\t\t\t\thash.push( lightNode.getSelf().getHash() );\n\n\t\t\t}\n\n\t\t\tthis._lightNodesHash = 'lights-' + hash.join( ',' );\n\n\t\t}\n\n\t\treturn this._lightNodesHash;\n\n\t}\n\n\tanalyze( builder ) {\n\n\t\tconst properties = builder.getDataFromNode( this );\n\n\t\tfor ( const node of properties.nodes ) {\n\n\t\t\tnode.build( builder );\n\n\t\t}\n\n\t}\n\n\tsetupLightsNode( builder ) {\n\n\t\tconst lightNodes = [];\n\n\t\tconst previousLightNodes = this._lightNodes;\n\n\t\tconst lights = sortLights( this._lights );\n\t\tconst nodeLibrary = builder.renderer.library;\n\n\t\tfor ( const light of lights ) {\n\n\t\t\tif ( light.isNode ) {\n\n\t\t\t\tlightNodes.push( nodeObject( light ) );\n\n\t\t\t} else {\n\n\t\t\t\tlet lightNode = null;\n\n\t\t\t\tif ( previousLightNodes !== null ) {\n\n\t\t\t\t\tlightNode = getLightNodeById( light.id, previousLightNodes ); // resuse existing light node\n\n\t\t\t\t}\n\n\t\t\t\tif ( lightNode === null ) {\n\n\t\t\t\t\tconst lightNodeClass = nodeLibrary.getLightNodeClass( light.constructor );\n\n\t\t\t\t\tif ( lightNodeClass === null ) {\n\n\t\t\t\t\t\tconsole.warn( `LightsNode.setupNodeLights: Light node not found for ${ light.constructor.name }` );\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlet lightNode = null;\n\n\t\t\t\t\tif ( ! _lightsNodeRef.has( light ) ) {\n\n\t\t\t\t\t\tlightNode = nodeObject( new lightNodeClass( light ) );\n\t\t\t\t\t\t_lightsNodeRef.set( light, lightNode );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tlightNode = _lightsNodeRef.get( light );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlightNodes.push( lightNode );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis._lightNodes = lightNodes;\n\n\t}\n\n\tsetupLights( builder, lightNodes ) {\n\n\t\tfor ( const lightNode of lightNodes ) {\n\n\t\t\tlightNode.build( builder );\n\n\t\t}\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( this._lightNodes === null ) this.setupLightsNode( builder );\n\n\t\tconst context = builder.context;\n\t\tconst lightingModel = context.lightingModel;\n\n\t\tlet outgoingLightNode = this.outgoingLightNode;\n\n\t\tif ( lightingModel ) {\n\n\t\t\tconst { _lightNodes, totalDiffuseNode, totalSpecularNode } = this;\n\n\t\t\tcontext.outgoingLight = outgoingLightNode;\n\n\t\t\tconst stack = builder.addStack();\n\n\t\t\t//\n\n\t\t\tconst properties = builder.getDataFromNode( this );\n\t\t\tproperties.nodes = stack.nodes;\n\n\t\t\t//\n\n\t\t\tlightingModel.start( context, stack, builder );\n\n\t\t\t// lights\n\n\t\t\tthis.setupLights( builder, _lightNodes );\n\n\t\t\t//\n\n\t\t\tlightingModel.indirect( context, stack, builder );\n\n\t\t\t//\n\n\t\t\tconst { backdrop, backdropAlpha } = context;\n\t\t\tconst { directDiffuse, directSpecular, indirectDiffuse, indirectSpecular } = context.reflectedLight;\n\n\t\t\tlet totalDiffuse = directDiffuse.add( indirectDiffuse );\n\n\t\t\tif ( backdrop !== null ) {\n\n\t\t\t\tif ( backdropAlpha !== null ) {\n\n\t\t\t\t\ttotalDiffuse = vec3( backdropAlpha.mix( totalDiffuse, backdrop ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttotalDiffuse = vec3( backdrop );\n\n\t\t\t\t}\n\n\t\t\t\tcontext.material.transparent = true;\n\n\t\t\t}\n\n\t\t\ttotalDiffuseNode.assign( totalDiffuse );\n\t\t\ttotalSpecularNode.assign( directSpecular.add( indirectSpecular ) );\n\n\t\t\toutgoingLightNode.assign( totalDiffuseNode.add( totalSpecularNode ) );\n\n\t\t\t//\n\n\t\t\tlightingModel.finish( context, stack, builder );\n\n\t\t\t//\n\n\t\t\toutgoingLightNode = outgoingLightNode.bypass( builder.removeStack() );\n\n\t\t}\n\n\t\treturn outgoingLightNode;\n\n\t}\n\n\tsetLights( lights ) {\n\n\t\tthis._lights = lights;\n\n\t\tthis._lightNodes = null;\n\t\tthis._lightNodesHash = null;\n\n\t\treturn this;\n\n\t}\n\n\tgetLights() {\n\n\t\treturn this._lights;\n\n\t}\n\n\tget hasLights() {\n\n\t\treturn this._lights.length > 0;\n\n\t}\n\n}\n\nconst lights = ( lights = [] ) => nodeObject( new LightsNode() ).setLights( lights );\n\nconst shadowMaterialLib = /*@__PURE__*/ new WeakMap();\nconst shadowWorldPosition = /*@__PURE__*/ vec3().toVar( 'shadowWorldPosition' );\n\nconst linearDistance = /*@__PURE__*/ Fn( ( [ position, cameraNear, cameraFar ] ) => {\n\n\tlet dist = positionWorld.sub( position ).length();\n\tdist = dist.sub( cameraNear ).div( cameraFar.sub( cameraNear ) );\n\tdist = dist.saturate(); // clamp to [ 0, 1 ]\n\n\treturn dist;\n\n} );\n\nconst linearShadowDistance = ( light ) => {\n\n\tconst camera = light.shadow.camera;\n\n\tconst nearDistance = reference( 'near', 'float', camera ).setGroup( renderGroup );\n\tconst farDistance = reference( 'far', 'float', camera ).setGroup( renderGroup );\n\n\tconst referencePosition = objectPosition( light );\n\n\treturn linearDistance( referencePosition, nearDistance, farDistance );\n\n};\n\nconst getShadowMaterial = ( light ) => {\n\n\tlet material = shadowMaterialLib.get( light );\n\n\tif ( material === undefined ) {\n\n\t\tconst depthNode = light.isPointLight ? linearShadowDistance( light ) : null;\n\n\t\tmaterial = new NodeMaterial();\n\t\tmaterial.colorNode = vec4( 0, 0, 0, 1 );\n\t\tmaterial.depthNode = depthNode;\n\t\tmaterial.isShadowNodeMaterial = true; // Use to avoid other overrideMaterial override material.colorNode unintentionally when using material.shadowNode\n\t\tmaterial.blending = NoBlending;\n\t\tmaterial.name = 'ShadowMaterial';\n\n\t\tshadowMaterialLib.set( light, material );\n\n\t}\n\n\treturn material;\n\n};\n\nconst BasicShadowFilter = /*@__PURE__*/ Fn( ( { depthTexture, shadowCoord } ) => {\n\n\treturn texture( depthTexture, shadowCoord.xy ).compare( shadowCoord.z );\n\n} );\n\nconst PCFShadowFilter = /*@__PURE__*/ Fn( ( { depthTexture, shadowCoord, shadow } ) => {\n\n\tconst depthCompare = ( uv, compare ) => texture( depthTexture, uv ).compare( compare );\n\n\tconst mapSize = reference( 'mapSize', 'vec2', shadow ).setGroup( renderGroup );\n\tconst radius = reference( 'radius', 'float', shadow ).setGroup( renderGroup );\n\n\tconst texelSize = vec2( 1 ).div( mapSize );\n\tconst dx0 = texelSize.x.negate().mul( radius );\n\tconst dy0 = texelSize.y.negate().mul( radius );\n\tconst dx1 = texelSize.x.mul( radius );\n\tconst dy1 = texelSize.y.mul( radius );\n\tconst dx2 = dx0.div( 2 );\n\tconst dy2 = dy0.div( 2 );\n\tconst dx3 = dx1.div( 2 );\n\tconst dy3 = dy1.div( 2 );\n\n\treturn add(\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx0, dy0 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( 0, dy0 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx1, dy0 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx2, dy2 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( 0, dy2 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx3, dy2 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx0, 0 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx2, 0 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy, shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx3, 0 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx1, 0 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx2, dy3 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( 0, dy3 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx3, dy3 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx0, dy1 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( 0, dy1 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx1, dy1 ) ), shadowCoord.z )\n\t).mul( 1 / 17 );\n\n} );\n\nconst PCFSoftShadowFilter = /*@__PURE__*/ Fn( ( { depthTexture, shadowCoord, shadow } ) => {\n\n\tconst depthCompare = ( uv, compare ) => texture( depthTexture, uv ).compare( compare );\n\n\tconst mapSize = reference( 'mapSize', 'vec2', shadow ).setGroup( renderGroup );\n\n\tconst texelSize = vec2( 1 ).div( mapSize );\n\tconst dx = texelSize.x;\n\tconst dy = texelSize.y;\n\n\tconst uv = shadowCoord.xy;\n\tconst f = fract( uv.mul( mapSize ).add( 0.5 ) );\n\tuv.subAssign( f.mul( texelSize ) );\n\n\treturn add(\n\t\tdepthCompare( uv, shadowCoord.z ),\n\t\tdepthCompare( uv.add( vec2( dx, 0 ) ), shadowCoord.z ),\n\t\tdepthCompare( uv.add( vec2( 0, dy ) ), shadowCoord.z ),\n\t\tdepthCompare( uv.add( texelSize ), shadowCoord.z ),\n\t\tmix(\n\t\t\tdepthCompare( uv.add( vec2( dx.negate(), 0 ) ), shadowCoord.z ),\n\t\t\tdepthCompare( uv.add( vec2( dx.mul( 2 ), 0 ) ), shadowCoord.z ),\n\t\t\tf.x\n\t\t),\n\t\tmix(\n\t\t\tdepthCompare( uv.add( vec2( dx.negate(), dy ) ), shadowCoord.z ),\n\t\t\tdepthCompare( uv.add( vec2( dx.mul( 2 ), dy ) ), shadowCoord.z ),\n\t\t\tf.x\n\t\t),\n\t\tmix(\n\t\t\tdepthCompare( uv.add( vec2( 0, dy.negate() ) ), shadowCoord.z ),\n\t\t\tdepthCompare( uv.add( vec2( 0, dy.mul( 2 ) ) ), shadowCoord.z ),\n\t\t\tf.y\n\t\t),\n\t\tmix(\n\t\t\tdepthCompare( uv.add( vec2( dx, dy.negate() ) ), shadowCoord.z ),\n\t\t\tdepthCompare( uv.add( vec2( dx, dy.mul( 2 ) ) ), shadowCoord.z ),\n\t\t\tf.y\n\t\t),\n\t\tmix(\n\t\t\tmix(\n\t\t\t\tdepthCompare( uv.add( vec2( dx.negate(), dy.negate() ) ), shadowCoord.z ),\n\t\t\t\tdepthCompare( uv.add( vec2( dx.mul( 2 ), dy.negate() ) ), shadowCoord.z ),\n\t\t\t\tf.x\n\t\t\t),\n\t\t\tmix(\n\t\t\t\tdepthCompare( uv.add( vec2( dx.negate(), dy.mul( 2 ) ) ), shadowCoord.z ),\n\t\t\t\tdepthCompare( uv.add( vec2( dx.mul( 2 ), dy.mul( 2 ) ) ), shadowCoord.z ),\n\t\t\t\tf.x\n\t\t\t),\n\t\t\tf.y\n\t\t)\n\t).mul( 1 / 9 );\n\n} );\n\n// VSM\n\nconst VSMShadowFilter = /*@__PURE__*/ Fn( ( { depthTexture, shadowCoord } ) => {\n\n\tconst occlusion = float( 1 ).toVar();\n\n\tconst distribution = texture( depthTexture ).uv( shadowCoord.xy ).rg;\n\n\tconst hardShadow = step( shadowCoord.z, distribution.x );\n\n\tIf( hardShadow.notEqual( float( 1.0 ) ), () => {\n\n\t\tconst distance = shadowCoord.z.sub( distribution.x );\n\t\tconst variance = max$1( 0, distribution.y.mul( distribution.y ) );\n\t\tlet softnessProbability = variance.div( variance.add( distance.mul( distance ) ) ); // Chebeyshevs inequality\n\t\tsoftnessProbability = clamp( sub( softnessProbability, 0.3 ).div( 0.95 - 0.3 ) );\n\t\tocclusion.assign( clamp( max$1( hardShadow, softnessProbability ) ) );\n\n\t} );\n\n\treturn occlusion;\n\n} );\n\nconst VSMPassVertical = /*@__PURE__*/ Fn( ( { samples, radius, size, shadowPass } ) => {\n\n\tconst mean = float( 0 ).toVar();\n\tconst squaredMean = float( 0 ).toVar();\n\n\tconst uvStride = samples.lessThanEqual( float( 1 ) ).select( float( 0 ), float( 2 ).div( samples.sub( 1 ) ) );\n\tconst uvStart = samples.lessThanEqual( float( 1 ) ).select( float( 0 ), float( - 1 ) );\n\n\tLoop( { start: int( 0 ), end: int( samples ), type: 'int', condition: '<' }, ( { i } ) => {\n\n\t\tconst uvOffset = uvStart.add( float( i ).mul( uvStride ) );\n\n\t\tconst depth = shadowPass.uv( add( screenCoordinate.xy, vec2( 0, uvOffset ).mul( radius ) ).div( size ) ).x;\n\t\tmean.addAssign( depth );\n\t\tsquaredMean.addAssign( depth.mul( depth ) );\n\n\t} );\n\n\tmean.divAssign( samples );\n\tsquaredMean.divAssign( samples );\n\n\tconst std_dev = sqrt( squaredMean.sub( mean.mul( mean ) ) );\n\treturn vec2( mean, std_dev );\n\n} );\n\nconst VSMPassHorizontal = /*@__PURE__*/ Fn( ( { samples, radius, size, shadowPass } ) => {\n\n\tconst mean = float( 0 ).toVar();\n\tconst squaredMean = float( 0 ).toVar();\n\n\tconst uvStride = samples.lessThanEqual( float( 1 ) ).select( float( 0 ), float( 2 ).div( samples.sub( 1 ) ) );\n\tconst uvStart = samples.lessThanEqual( float( 1 ) ).select( float( 0 ), float( - 1 ) );\n\n\tLoop( { start: int( 0 ), end: int( samples ), type: 'int', condition: '<' }, ( { i } ) => {\n\n\t\tconst uvOffset = uvStart.add( float( i ).mul( uvStride ) );\n\n\t\tconst distribution = shadowPass.uv( add( screenCoordinate.xy, vec2( uvOffset, 0 ).mul( radius ) ).div( size ) );\n\t\tmean.addAssign( distribution.x );\n\t\tsquaredMean.addAssign( add( distribution.y.mul( distribution.y ), distribution.x.mul( distribution.x ) ) );\n\n\t} );\n\n\tmean.divAssign( samples );\n\tsquaredMean.divAssign( samples );\n\n\tconst std_dev = sqrt( squaredMean.sub( mean.mul( mean ) ) );\n\treturn vec2( mean, std_dev );\n\n} );\n\nconst _shadowFilterLib = [ BasicShadowFilter, PCFShadowFilter, PCFSoftShadowFilter, VSMShadowFilter ];\n\n//\n\nconst _quadMesh$1 = /*@__PURE__*/ new QuadMesh();\n\nclass ShadowNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ShadowNode';\n\n\t}\n\n\tconstructor( light, shadow = null ) {\n\n\t\tsuper();\n\n\t\tthis.light = light;\n\t\tthis.shadow = shadow || light.shadow;\n\n\t\tthis.shadowMap = null;\n\n\t\tthis.vsmShadowMapVertical = null;\n\t\tthis.vsmShadowMapHorizontal = null;\n\n\t\tthis.vsmMaterialVertical = null;\n\t\tthis.vsmMaterialHorizontal = null;\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\t\tthis._node = null;\n\n\t\tthis.isShadowNode = true;\n\n\t}\n\n\tsetupShadowFilter( builder, { filterFn, depthTexture, shadowCoord, shadow } ) {\n\n\t\tconst frustumTest = shadowCoord.x.greaterThanEqual( 0 )\n\t\t\t.and( shadowCoord.x.lessThanEqual( 1 ) )\n\t\t\t.and( shadowCoord.y.greaterThanEqual( 0 ) )\n\t\t\t.and( shadowCoord.y.lessThanEqual( 1 ) )\n\t\t\t.and( shadowCoord.z.lessThanEqual( 1 ) );\n\n\t\tconst shadowNode = filterFn( { depthTexture, shadowCoord, shadow } );\n\n\t\treturn frustumTest.select( shadowNode, float( 1 ) );\n\n\t}\n\n\tsetupShadowCoord( builder, shadowPosition ) {\n\n\t\tconst { shadow } = this;\n\t\tconst { renderer } = builder;\n\n\t\tconst bias = reference( 'bias', 'float', shadow ).setGroup( renderGroup );\n\n\t\tlet shadowCoord = shadowPosition;\n\t\tlet coordZ;\n\n\t\tif ( shadow.camera.isOrthographicCamera || renderer.logarithmicDepthBuffer !== true ) {\n\n\t\t\tshadowCoord = shadowCoord.xyz.div( shadowCoord.w );\n\n\t\t\tcoordZ = shadowCoord.z;\n\n\t\t\tif ( renderer.coordinateSystem === WebGPUCoordinateSystem ) {\n\n\t\t\t\tcoordZ = coordZ.mul( 2 ).sub( 1 ); // WebGPU: Conversion [ 0, 1 ] to [ - 1, 1 ]\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst w = shadowCoord.w;\n\t\t\tshadowCoord = shadowCoord.xy.div( w ); // <-- Only divide X/Y coords since we don't need Z\n\n\t\t\t// The normally available \"cameraNear\" and \"cameraFar\" nodes cannot be used here because they do not get\n\t\t\t// updated to use the shadow camera. So, we have to declare our own \"local\" ones here.\n\t\t\t// TODO: How do we get the cameraNear/cameraFar nodes to use the shadow camera so we don't have to declare local ones here?\n\t\t\tconst cameraNearLocal = reference( 'near', 'float', shadow.camera ).setGroup( renderGroup );\n\t\t\tconst cameraFarLocal = reference( 'far', 'float', shadow.camera ).setGroup( renderGroup );\n\n\t\t\tcoordZ = viewZToLogarithmicDepth( w.negate(), cameraNearLocal, cameraFarLocal );\n\n\t\t}\n\n\t\tshadowCoord = vec3(\n\t\t\tshadowCoord.x,\n\t\t\tshadowCoord.y.oneMinus(), // follow webgpu standards\n\t\t\tcoordZ.add( bias )\n\t\t);\n\n\t\treturn shadowCoord;\n\n\t}\n\n\tgetShadowFilterFn( type ) {\n\n\t\treturn _shadowFilterLib[ type ];\n\n\t}\n\n\tsetupShadow( builder ) {\n\n\t\tconst { renderer } = builder;\n\n\t\tconst { light, shadow } = this;\n\n\t\tconst shadowMapType = renderer.shadowMap.type;\n\n\t\tconst depthTexture = new DepthTexture( shadow.mapSize.width, shadow.mapSize.height );\n\t\tdepthTexture.compareFunction = LessCompare;\n\n\t\tconst shadowMap = builder.createRenderTarget( shadow.mapSize.width, shadow.mapSize.height );\n\t\tshadowMap.depthTexture = depthTexture;\n\n\t\tshadow.camera.updateProjectionMatrix();\n\n\t\t// VSM\n\n\t\tif ( shadowMapType === VSMShadowMap ) {\n\n\t\t\tdepthTexture.compareFunction = null; // VSM does not use textureSampleCompare()/texture2DCompare()\n\n\t\t\tthis.vsmShadowMapVertical = builder.createRenderTarget( shadow.mapSize.width, shadow.mapSize.height, { format: RGFormat, type: HalfFloatType } );\n\t\t\tthis.vsmShadowMapHorizontal = builder.createRenderTarget( shadow.mapSize.width, shadow.mapSize.height, { format: RGFormat, type: HalfFloatType } );\n\n\t\t\tconst shadowPassVertical = texture( depthTexture );\n\t\t\tconst shadowPassHorizontal = texture( this.vsmShadowMapVertical.texture );\n\n\t\t\tconst samples = reference( 'blurSamples', 'float', shadow ).setGroup( renderGroup );\n\t\t\tconst radius = reference( 'radius', 'float', shadow ).setGroup( renderGroup );\n\t\t\tconst size = reference( 'mapSize', 'vec2', shadow ).setGroup( renderGroup );\n\n\t\t\tlet material = this.vsmMaterialVertical || ( this.vsmMaterialVertical = new NodeMaterial() );\n\t\t\tmaterial.fragmentNode = VSMPassVertical( { samples, radius, size, shadowPass: shadowPassVertical } ).context( builder.getSharedContext() );\n\t\t\tmaterial.name = 'VSMVertical';\n\n\t\t\tmaterial = this.vsmMaterialHorizontal || ( this.vsmMaterialHorizontal = new NodeMaterial() );\n\t\t\tmaterial.fragmentNode = VSMPassHorizontal( { samples, radius, size, shadowPass: shadowPassHorizontal } ).context( builder.getSharedContext() );\n\t\t\tmaterial.name = 'VSMHorizontal';\n\n\t\t}\n\n\t\t//\n\n\t\tconst shadowIntensity = reference( 'intensity', 'float', shadow ).setGroup( renderGroup );\n\t\tconst normalBias = reference( 'normalBias', 'float', shadow ).setGroup( renderGroup );\n\n\t\tconst shadowPosition = lightShadowMatrix( light ).mul( shadowWorldPosition.add( transformedNormalWorld.mul( normalBias ) ) );\n\t\tconst shadowCoord = this.setupShadowCoord( builder, shadowPosition );\n\n\t\t//\n\n\t\tconst filterFn = shadow.filterNode || this.getShadowFilterFn( renderer.shadowMap.type ) || null;\n\n\t\tif ( filterFn === null ) {\n\n\t\t\tthrow new Error( 'THREE.WebGPURenderer: Shadow map type not supported yet.' );\n\n\t\t}\n\n\t\tconst shadowDepthTexture = ( shadowMapType === VSMShadowMap ) ? this.vsmShadowMapHorizontal.texture : depthTexture;\n\n\t\tconst shadowNode = this.setupShadowFilter( builder, { filterFn, shadowTexture: shadowMap.texture, depthTexture: shadowDepthTexture, shadowCoord, shadow } );\n\n\t\tconst shadowColor = texture( shadowMap.texture, shadowCoord );\n\t\tconst shadowOutput = mix( 1, shadowNode.rgb.mix( shadowColor, 1 ), shadowIntensity.mul( shadowColor.a ) ).toVar();\n\n\t\tthis.shadowMap = shadowMap;\n\t\tthis.shadow.map = shadowMap;\n\n\t\treturn shadowOutput;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( builder.renderer.shadowMap.enabled === false ) return;\n\n\t\treturn Fn( ( { material } ) => {\n\n\t\t\tshadowWorldPosition.assign( material.shadowPositionNode || positionWorld );\n\n\t\t\tlet node = this._node;\n\n\t\t\tif ( node === null ) {\n\n\t\t\t\tthis._node = node = this.setupShadow( builder );\n\n\t\t\t}\n\n\t\t\tif ( builder.material.shadowNode ) { // @deprecated, r171\n\n\t\t\t\tconsole.warn( 'THREE.NodeMaterial: \".shadowNode\" is deprecated. Use \".castShadowNode\" instead.' );\n\n\t\t\t}\n\n\t\t\tif ( builder.material.receivedShadowNode ) {\n\n\t\t\t\tnode = builder.material.receivedShadowNode( node );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} )();\n\n\t}\n\n\trenderShadow( frame ) {\n\n\t\tconst { shadow, shadowMap } = this;\n\t\tconst { renderer, scene } = frame;\n\n\t\tshadowMap.setSize( shadow.mapSize.width, shadow.mapSize.height );\n\n\t\trenderer.render( scene, shadow.camera );\n\n\t}\n\n\tupdateShadow( frame ) {\n\n\t\tconst { shadowMap, light, shadow } = this;\n\t\tconst { renderer, scene, camera } = frame;\n\n\t\tconst shadowType = renderer.shadowMap.type;\n\n\t\tconst depthVersion = shadowMap.depthTexture.version;\n\t\tthis._depthVersionCached = depthVersion;\n\n\t\tconst currentOverrideMaterial = scene.overrideMaterial;\n\n\t\tscene.overrideMaterial = getShadowMaterial( light );\n\n\t\tshadow.camera.layers.mask = camera.layers.mask;\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\t\tconst currentRenderObjectFunction = renderer.getRenderObjectFunction();\n\t\tconst currentMRT = renderer.getMRT();\n\n\t\trenderer.setMRT( null );\n\n\t\trenderer.setRenderObjectFunction( ( object, ...params ) => {\n\n\t\t\tif ( object.castShadow === true || ( object.receiveShadow && shadowType === VSMShadowMap ) ) {\n\n\t\t\t\trenderer.renderObject( object, ...params );\n\n\t\t\t}\n\n\t\t} );\n\n\t\trenderer.setRenderTarget( shadowMap );\n\n\t\tthis.renderShadow( frame );\n\n\t\trenderer.setRenderObjectFunction( currentRenderObjectFunction );\n\n\t\t// vsm blur pass\n\n\t\tif ( light.isPointLight !== true && shadowType === VSMShadowMap ) {\n\n\t\t\tthis.vsmPass( renderer );\n\n\t\t}\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t\trenderer.setMRT( currentMRT );\n\n\t\tscene.overrideMaterial = currentOverrideMaterial;\n\n\t}\n\n\tvsmPass( renderer ) {\n\n\t\tconst { shadow } = this;\n\n\t\tthis.vsmShadowMapVertical.setSize( shadow.mapSize.width, shadow.mapSize.height );\n\t\tthis.vsmShadowMapHorizontal.setSize( shadow.mapSize.width, shadow.mapSize.height );\n\n\t\trenderer.setRenderTarget( this.vsmShadowMapVertical );\n\t\t_quadMesh$1.material = this.vsmMaterialVertical;\n\t\t_quadMesh$1.render( renderer );\n\n\t\trenderer.setRenderTarget( this.vsmShadowMapHorizontal );\n\t\t_quadMesh$1.material = this.vsmMaterialHorizontal;\n\t\t_quadMesh$1.render( renderer );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadowMap.dispose();\n\t\tthis.shadowMap = null;\n\n\t\tif ( this.vsmShadowMapVertical !== null ) {\n\n\t\t\tthis.vsmShadowMapVertical.dispose();\n\t\t\tthis.vsmShadowMapVertical = null;\n\n\t\t\tthis.vsmMaterialVertical.dispose();\n\t\t\tthis.vsmMaterialVertical = null;\n\n\t\t}\n\n\t\tif ( this.vsmShadowMapHorizontal !== null ) {\n\n\t\t\tthis.vsmShadowMapHorizontal.dispose();\n\t\t\tthis.vsmShadowMapHorizontal = null;\n\n\t\t\tthis.vsmMaterialHorizontal.dispose();\n\t\t\tthis.vsmMaterialHorizontal = null;\n\n\t\t}\n\n\t\tthis.updateBeforeType = NodeUpdateType.NONE;\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst { shadow } = this;\n\n\t\tconst needsUpdate = shadow.needsUpdate || shadow.autoUpdate;\n\n\t\tif ( needsUpdate ) {\n\n\t\t\tthis.updateShadow( frame );\n\n\t\t\tif ( this.shadowMap.depthTexture.version === this._depthVersionCached ) {\n\n\t\t\t\tshadow.needsUpdate = false;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nconst shadow = ( light, shadow ) => nodeObject( new ShadowNode( light, shadow ) );\n\nclass AnalyticLightNode extends LightingNode {\n\n\tstatic get type() {\n\n\t\treturn 'AnalyticLightNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper();\n\n\t\tthis.light = light;\n\n\t\tthis.color = new Color();\n\t\tthis.colorNode = ( light && light.colorNode ) || uniform( this.color ).setGroup( renderGroup );\n\n\t\tthis.baseColorNode = null;\n\n\t\tthis.shadowNode = null;\n\t\tthis.shadowColorNode = null;\n\n\t\tthis.isAnalyticLightNode = true;\n\n\t\tthis.updateType = NodeUpdateType.FRAME;\n\n\t}\n\n\tgetCacheKey() {\n\n\t\treturn hash$1( super.getCacheKey(), this.light.id, this.light.castShadow ? 1 : 0 );\n\n\t}\n\n\tgetHash() {\n\n\t\treturn this.light.uuid;\n\n\t}\n\n\tsetupShadowNode() {\n\n\t\treturn shadow( this.light );\n\n\t}\n\n\tsetupShadow( builder ) {\n\n\t\tconst { renderer } = builder;\n\n\t\tif ( renderer.shadowMap.enabled === false ) return;\n\n\t\tlet shadowColorNode = this.shadowColorNode;\n\n\t\tif ( shadowColorNode === null ) {\n\n\t\t\tconst customShadowNode = this.light.shadow.shadowNode;\n\n\t\t\tlet shadowNode;\n\n\t\t\tif ( customShadowNode !== undefined ) {\n\n\t\t\t\tshadowNode = nodeObject( customShadowNode );\n\n\t\t\t} else {\n\n\t\t\t\tshadowNode = this.setupShadowNode( builder );\n\n\t\t\t}\n\n\t\t\tthis.shadowNode = shadowNode;\n\n\t\t\tthis.shadowColorNode = shadowColorNode = this.colorNode.mul( shadowNode );\n\n\t\t\tthis.baseColorNode = this.colorNode;\n\n\t\t}\n\n\t\t//\n\n\t\tthis.colorNode = shadowColorNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.colorNode = this.baseColorNode || this.colorNode;\n\n\t\tif ( this.light.castShadow ) {\n\n\t\t\tif ( builder.object.receiveShadow ) {\n\n\t\t\t\tthis.setupShadow( builder );\n\n\t\t\t}\n\n\t\t} else if ( this.shadowNode !== null ) {\n\n\t\t\tthis.shadowNode.dispose();\n\t\t\tthis.shadowNode = null;\n\t\t\tthis.shadowColorNode = null;\n\n\t\t}\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tconst { light } = this;\n\n\t\tthis.color.copy( light.color ).multiplyScalar( light.intensity );\n\n\t}\n\n}\n\nconst getDistanceAttenuation = /*@__PURE__*/ Fn( ( inputs ) => {\n\n\tconst { lightDistance, cutoffDistance, decayExponent } = inputs;\n\n\t// based upon Frostbite 3 Moving to Physically-based Rendering\n\t// page 32, equation 26: E[window1]\n\t// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\n\tconst distanceFalloff = lightDistance.pow( decayExponent ).max( 0.01 ).reciprocal();\n\n\treturn cutoffDistance.greaterThan( 0 ).select(\n\t\tdistanceFalloff.mul( lightDistance.div( cutoffDistance ).pow4().oneMinus().clamp().pow2() ),\n\t\tdistanceFalloff\n\t);\n\n} ); // validated\n\nconst _clearColor$2 = /*@__PURE__*/ new Color();\n\n// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\n// vector suitable for 2D texture mapping. This code uses the following layout for the\n// 2D texture:\n//\n// xzXZ\n//  y Y\n//\n// Y - Positive y direction\n// y - Negative y direction\n// X - Positive x direction\n// x - Negative x direction\n// Z - Positive z direction\n// z - Negative z direction\n//\n// Source and test bed:\n// https://gist.github.com/tschw/da10c43c467ce8afd0c4\n\nconst cubeToUV = /*@__PURE__*/ Fn( ( [ pos, texelSizeY ] ) => {\n\n\tconst v = pos.toVar();\n\n\t// Number of texels to avoid at the edge of each square\n\n\tconst absV = abs( v );\n\n\t// Intersect unit cube\n\n\tconst scaleToCube = div( 1.0, max$1( absV.x, max$1( absV.y, absV.z ) ) );\n\tabsV.mulAssign( scaleToCube );\n\n\t// Apply scale to avoid seams\n\n\t// two texels less per square (one texel will do for NEAREST)\n\tv.mulAssign( scaleToCube.mul( texelSizeY.mul( 2 ).oneMinus() ) );\n\n\t// Unwrap\n\n\t// space: -1 ... 1 range for each square\n\t//\n\t// #X##\t\tdim    := ( 4 , 2 )\n\t//  # #\t\tcenter := ( 1 , 1 )\n\n\tconst planar = vec2( v.xy ).toVar();\n\n\tconst almostATexel = texelSizeY.mul( 1.5 );\n\tconst almostOne = almostATexel.oneMinus();\n\n\tIf( absV.z.greaterThanEqual( almostOne ), () => {\n\n\t\tIf( v.z.greaterThan( 0.0 ), () => {\n\n\t\t\tplanar.x.assign( sub( 4.0, v.x ) );\n\n\t\t} );\n\n\t} ).ElseIf( absV.x.greaterThanEqual( almostOne ), () => {\n\n\t\tconst signX = sign( v.x );\n\t\tplanar.x.assign( v.z.mul( signX ).add( signX.mul( 2.0 ) ) );\n\n\t} ).ElseIf( absV.y.greaterThanEqual( almostOne ), () => {\n\n\t\tconst signY = sign( v.y );\n\t\tplanar.x.assign( v.x.add( signY.mul( 2.0 ) ).add( 2.0 ) );\n\t\tplanar.y.assign( v.z.mul( signY ).sub( 2.0 ) );\n\n\t} );\n\n\t// Transform to UV space\n\n\t// scale := 0.5 / dim\n\t// translate := ( center + 0.5 ) / dim\n\treturn vec2( 0.125, 0.25 ).mul( planar ).add( vec2( 0.375, 0.75 ) ).flipY();\n\n} ).setLayout( {\n\tname: 'cubeToUV',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'pos', type: 'vec3' },\n\t\t{ name: 'texelSizeY', type: 'float' }\n\t]\n} );\n\nconst BasicPointShadowFilter = /*@__PURE__*/ Fn( ( { depthTexture, bd3D, dp, texelSize } ) => {\n\n\treturn texture( depthTexture, cubeToUV( bd3D, texelSize.y ) ).compare( dp );\n\n} );\n\nconst PointShadowFilter = /*@__PURE__*/ Fn( ( { depthTexture, bd3D, dp, texelSize, shadow } ) => {\n\n\tconst radius = reference( 'radius', 'float', shadow ).setGroup( renderGroup );\n\tconst offset = vec2( - 1.0, 1.0 ).mul( radius ).mul( texelSize.y );\n\n\treturn texture( depthTexture, cubeToUV( bd3D.add( offset.xyy ), texelSize.y ) ).compare( dp )\n\t\t.add( texture( depthTexture, cubeToUV( bd3D.add( offset.yyy ), texelSize.y ) ).compare( dp ) )\n\t\t.add( texture( depthTexture, cubeToUV( bd3D.add( offset.xyx ), texelSize.y ) ).compare( dp ) )\n\t\t.add( texture( depthTexture, cubeToUV( bd3D.add( offset.yyx ), texelSize.y ) ).compare( dp ) )\n\t\t.add( texture( depthTexture, cubeToUV( bd3D, texelSize.y ) ).compare( dp ) )\n\t\t.add( texture( depthTexture, cubeToUV( bd3D.add( offset.xxy ), texelSize.y ) ).compare( dp ) )\n\t\t.add( texture( depthTexture, cubeToUV( bd3D.add( offset.yxy ), texelSize.y ) ).compare( dp ) )\n\t\t.add( texture( depthTexture, cubeToUV( bd3D.add( offset.xxx ), texelSize.y ) ).compare( dp ) )\n\t\t.add( texture( depthTexture, cubeToUV( bd3D.add( offset.yxx ), texelSize.y ) ).compare( dp ) )\n\t\t.mul( 1.0 / 9.0 );\n\n} );\n\nconst pointShadowFilter = /*@__PURE__*/ Fn( ( { filterFn, depthTexture, shadowCoord, shadow } ) => {\n\n\t// for point lights, the uniform @vShadowCoord is re-purposed to hold\n\t// the vector from the light to the world-space position of the fragment.\n\tconst lightToPosition = shadowCoord.xyz.toVar();\n\tconst lightToPositionLength = lightToPosition.length();\n\n\tconst cameraNearLocal = uniform( 'float' ).setGroup( renderGroup ).onRenderUpdate( () => shadow.camera.near );\n\tconst cameraFarLocal = uniform( 'float' ).setGroup( renderGroup ).onRenderUpdate( () => shadow.camera.far );\n\tconst bias = reference( 'bias', 'float', shadow ).setGroup( renderGroup );\n\tconst mapSize = uniform( shadow.mapSize ).setGroup( renderGroup );\n\n\tconst result = float( 1.0 ).toVar();\n\n\tIf( lightToPositionLength.sub( cameraFarLocal ).lessThanEqual( 0.0 ).and( lightToPositionLength.sub( cameraNearLocal ).greaterThanEqual( 0.0 ) ), () => {\n\n\t\t// dp = normalized distance from light to fragment position\n\t\tconst dp = lightToPositionLength.sub( cameraNearLocal ).div( cameraFarLocal.sub( cameraNearLocal ) ).toVar(); // need to clamp?\n\t\tdp.addAssign( bias );\n\n\t\t// bd3D = base direction 3D\n\t\tconst bd3D = lightToPosition.normalize();\n\t\tconst texelSize = vec2( 1.0 ).div( mapSize.mul( vec2( 4.0, 2.0 ) ) );\n\n\t\t// percentage-closer filtering\n\t\tresult.assign( filterFn( { depthTexture, bd3D, dp, texelSize, shadow } ) );\n\n\t} );\n\n\treturn result;\n\n} );\n\nconst _viewport = /*@__PURE__*/ new Vector4();\nconst _viewportSize = /*@__PURE__*/ new Vector2();\nconst _shadowMapSize = /*@__PURE__*/ new Vector2();\n\n//\n\nclass PointShadowNode extends ShadowNode {\n\n\tstatic get type() {\n\n\t\treturn 'PointShadowNode';\n\n\t}\n\n\tconstructor( light, shadow = null ) {\n\n\t\tsuper( light, shadow );\n\n\t}\n\n\tgetShadowFilterFn( type ) {\n\n\t\treturn type === BasicShadowMap ? BasicPointShadowFilter : PointShadowFilter;\n\n\t}\n\n\tsetupShadowCoord( builder, shadowPosition ) {\n\n\t\treturn shadowPosition;\n\n\t}\n\n\tsetupShadowFilter( builder, { filterFn, shadowTexture, depthTexture, shadowCoord, shadow } ) {\n\n\t\treturn pointShadowFilter( { filterFn, shadowTexture, depthTexture, shadowCoord, shadow } );\n\n\t}\n\n\trenderShadow( frame ) {\n\n\t\tconst { shadow, shadowMap, light } = this;\n\t\tconst { renderer, scene } = frame;\n\n\t\tconst shadowFrameExtents = shadow.getFrameExtents();\n\n\t\t_shadowMapSize.copy( shadow.mapSize );\n\t\t_shadowMapSize.multiply( shadowFrameExtents );\n\n\t\tshadowMap.setSize( _shadowMapSize.width, _shadowMapSize.height );\n\n\t\t_viewportSize.copy( shadow.mapSize );\n\n\t\t//\n\n\t\tconst previousAutoClear = renderer.autoClear;\n\n\t\tconst previousClearColor = renderer.getClearColor( _clearColor$2 );\n\t\tconst previousClearAlpha = renderer.getClearAlpha();\n\n\t\trenderer.autoClear = false;\n\t\trenderer.setClearColor( shadow.clearColor, shadow.clearAlpha );\n\t\trenderer.clear();\n\n\t\tconst viewportCount = shadow.getViewportCount();\n\n\t\tfor ( let vp = 0; vp < viewportCount; vp ++ ) {\n\n\t\t\tconst viewport = shadow.getViewport( vp );\n\n\t\t\tconst x = _viewportSize.x * viewport.x;\n\t\t\tconst y = _shadowMapSize.y - _viewportSize.y - ( _viewportSize.y * viewport.y );\n\n\t\t\t_viewport.set(\n\t\t\t\tx,\n\t\t\t\ty,\n\t\t\t\t_viewportSize.x * viewport.z,\n\t\t\t\t_viewportSize.y * viewport.w\n\t\t\t);\n\n\t\t\tshadowMap.viewport.copy( _viewport );\n\n\t\t\tshadow.updateMatrices( light, vp );\n\n\t\t\trenderer.render( scene, shadow.camera );\n\n\t\t}\n\n\t\t//\n\n\t\trenderer.autoClear = previousAutoClear;\n\t\trenderer.setClearColor( previousClearColor, previousClearAlpha );\n\n\t}\n\n}\n\nconst pointShadow = ( light, shadow ) => nodeObject( new PointShadowNode( light, shadow ) );\n\nconst directPointLight = Fn( ( { color, lightViewPosition, cutoffDistance, decayExponent }, builder ) => {\n\n\tconst lightingModel = builder.context.lightingModel;\n\n\tconst lVector = lightViewPosition.sub( positionView ); // @TODO: Add it into LightNode\n\n\tconst lightDirection = lVector.normalize();\n\tconst lightDistance = lVector.length();\n\n\tconst lightAttenuation = getDistanceAttenuation( {\n\t\tlightDistance,\n\t\tcutoffDistance,\n\t\tdecayExponent\n\t} );\n\n\tconst lightColor = color.mul( lightAttenuation );\n\n\tconst reflectedLight = builder.context.reflectedLight;\n\n\tlightingModel.direct( {\n\t\tlightDirection,\n\t\tlightColor,\n\t\treflectedLight\n\t}, builder.stack, builder );\n\n} );\n\nclass PointLightNode extends AnalyticLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'PointLightNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t\tthis.cutoffDistanceNode = uniform( 0 ).setGroup( renderGroup );\n\t\tthis.decayExponentNode = uniform( 0 ).setGroup( renderGroup );\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tconst { light } = this;\n\n\t\tsuper.update( frame );\n\n\t\tthis.cutoffDistanceNode.value = light.distance;\n\t\tthis.decayExponentNode.value = light.decay;\n\n\t}\n\n\tsetupShadowNode() {\n\n\t\treturn pointShadow( this.light );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tdirectPointLight( {\n\t\t\tcolor: this.colorNode,\n\t\t\tlightViewPosition: lightViewPosition( this.light ),\n\t\t\tcutoffDistance: this.cutoffDistanceNode,\n\t\t\tdecayExponent: this.decayExponentNode\n\t\t} ).append();\n\n\t}\n\n}\n\nconst checker = /*@__PURE__*/ Fn( ( [ coord = uv() ] ) => {\n\n\tconst uv = coord.mul( 2.0 );\n\n\tconst cx = uv.x.floor();\n\tconst cy = uv.y.floor();\n\tconst result = cx.add( cy ).mod( 2.0 );\n\n\treturn result.sign();\n\n} );\n\n// Three.js Transpiler\n// https://raw.githubusercontent.com/AcademySoftwareFoundation/MaterialX/main/libraries/stdlib/genglsl/lib/mx_noise.glsl\n\n\n\nconst mx_select = /*@__PURE__*/ Fn( ( [ b_immutable, t_immutable, f_immutable ] ) => {\n\n\tconst f = float( f_immutable ).toVar();\n\tconst t = float( t_immutable ).toVar();\n\tconst b = bool( b_immutable ).toVar();\n\n\treturn select( b, t, f );\n\n} ).setLayout( {\n\tname: 'mx_select',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'b', type: 'bool' },\n\t\t{ name: 't', type: 'float' },\n\t\t{ name: 'f', type: 'float' }\n\t]\n} );\n\nconst mx_negate_if = /*@__PURE__*/ Fn( ( [ val_immutable, b_immutable ] ) => {\n\n\tconst b = bool( b_immutable ).toVar();\n\tconst val = float( val_immutable ).toVar();\n\n\treturn select( b, val.negate(), val );\n\n} ).setLayout( {\n\tname: 'mx_negate_if',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'val', type: 'float' },\n\t\t{ name: 'b', type: 'bool' }\n\t]\n} );\n\nconst mx_floor = /*@__PURE__*/ Fn( ( [ x_immutable ] ) => {\n\n\tconst x = float( x_immutable ).toVar();\n\n\treturn int( floor( x ) );\n\n} ).setLayout( {\n\tname: 'mx_floor',\n\ttype: 'int',\n\tinputs: [\n\t\t{ name: 'x', type: 'float' }\n\t]\n} );\n\nconst mx_floorfrac = /*@__PURE__*/ Fn( ( [ x_immutable, i ] ) => {\n\n\tconst x = float( x_immutable ).toVar();\n\ti.assign( mx_floor( x ) );\n\n\treturn x.sub( float( i ) );\n\n} );\n\nconst mx_bilerp_0 = /*@__PURE__*/ Fn( ( [ v0_immutable, v1_immutable, v2_immutable, v3_immutable, s_immutable, t_immutable ] ) => {\n\n\tconst t = float( t_immutable ).toVar();\n\tconst s = float( s_immutable ).toVar();\n\tconst v3 = float( v3_immutable ).toVar();\n\tconst v2 = float( v2_immutable ).toVar();\n\tconst v1 = float( v1_immutable ).toVar();\n\tconst v0 = float( v0_immutable ).toVar();\n\tconst s1 = float( sub( 1.0, s ) ).toVar();\n\n\treturn sub( 1.0, t ).mul( v0.mul( s1 ).add( v1.mul( s ) ) ).add( t.mul( v2.mul( s1 ).add( v3.mul( s ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_bilerp_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'v0', type: 'float' },\n\t\t{ name: 'v1', type: 'float' },\n\t\t{ name: 'v2', type: 'float' },\n\t\t{ name: 'v3', type: 'float' },\n\t\t{ name: 's', type: 'float' },\n\t\t{ name: 't', type: 'float' }\n\t]\n} );\n\nconst mx_bilerp_1 = /*@__PURE__*/ Fn( ( [ v0_immutable, v1_immutable, v2_immutable, v3_immutable, s_immutable, t_immutable ] ) => {\n\n\tconst t = float( t_immutable ).toVar();\n\tconst s = float( s_immutable ).toVar();\n\tconst v3 = vec3( v3_immutable ).toVar();\n\tconst v2 = vec3( v2_immutable ).toVar();\n\tconst v1 = vec3( v1_immutable ).toVar();\n\tconst v0 = vec3( v0_immutable ).toVar();\n\tconst s1 = float( sub( 1.0, s ) ).toVar();\n\n\treturn sub( 1.0, t ).mul( v0.mul( s1 ).add( v1.mul( s ) ) ).add( t.mul( v2.mul( s1 ).add( v3.mul( s ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_bilerp_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'v0', type: 'vec3' },\n\t\t{ name: 'v1', type: 'vec3' },\n\t\t{ name: 'v2', type: 'vec3' },\n\t\t{ name: 'v3', type: 'vec3' },\n\t\t{ name: 's', type: 'float' },\n\t\t{ name: 't', type: 'float' }\n\t]\n} );\n\nconst mx_bilerp = /*@__PURE__*/ overloadingFn( [ mx_bilerp_0, mx_bilerp_1 ] );\n\nconst mx_trilerp_0 = /*@__PURE__*/ Fn( ( [ v0_immutable, v1_immutable, v2_immutable, v3_immutable, v4_immutable, v5_immutable, v6_immutable, v7_immutable, s_immutable, t_immutable, r_immutable ] ) => {\n\n\tconst r = float( r_immutable ).toVar();\n\tconst t = float( t_immutable ).toVar();\n\tconst s = float( s_immutable ).toVar();\n\tconst v7 = float( v7_immutable ).toVar();\n\tconst v6 = float( v6_immutable ).toVar();\n\tconst v5 = float( v5_immutable ).toVar();\n\tconst v4 = float( v4_immutable ).toVar();\n\tconst v3 = float( v3_immutable ).toVar();\n\tconst v2 = float( v2_immutable ).toVar();\n\tconst v1 = float( v1_immutable ).toVar();\n\tconst v0 = float( v0_immutable ).toVar();\n\tconst s1 = float( sub( 1.0, s ) ).toVar();\n\tconst t1 = float( sub( 1.0, t ) ).toVar();\n\tconst r1 = float( sub( 1.0, r ) ).toVar();\n\n\treturn r1.mul( t1.mul( v0.mul( s1 ).add( v1.mul( s ) ) ).add( t.mul( v2.mul( s1 ).add( v3.mul( s ) ) ) ) ).add( r.mul( t1.mul( v4.mul( s1 ).add( v5.mul( s ) ) ).add( t.mul( v6.mul( s1 ).add( v7.mul( s ) ) ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_trilerp_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'v0', type: 'float' },\n\t\t{ name: 'v1', type: 'float' },\n\t\t{ name: 'v2', type: 'float' },\n\t\t{ name: 'v3', type: 'float' },\n\t\t{ name: 'v4', type: 'float' },\n\t\t{ name: 'v5', type: 'float' },\n\t\t{ name: 'v6', type: 'float' },\n\t\t{ name: 'v7', type: 'float' },\n\t\t{ name: 's', type: 'float' },\n\t\t{ name: 't', type: 'float' },\n\t\t{ name: 'r', type: 'float' }\n\t]\n} );\n\nconst mx_trilerp_1 = /*@__PURE__*/ Fn( ( [ v0_immutable, v1_immutable, v2_immutable, v3_immutable, v4_immutable, v5_immutable, v6_immutable, v7_immutable, s_immutable, t_immutable, r_immutable ] ) => {\n\n\tconst r = float( r_immutable ).toVar();\n\tconst t = float( t_immutable ).toVar();\n\tconst s = float( s_immutable ).toVar();\n\tconst v7 = vec3( v7_immutable ).toVar();\n\tconst v6 = vec3( v6_immutable ).toVar();\n\tconst v5 = vec3( v5_immutable ).toVar();\n\tconst v4 = vec3( v4_immutable ).toVar();\n\tconst v3 = vec3( v3_immutable ).toVar();\n\tconst v2 = vec3( v2_immutable ).toVar();\n\tconst v1 = vec3( v1_immutable ).toVar();\n\tconst v0 = vec3( v0_immutable ).toVar();\n\tconst s1 = float( sub( 1.0, s ) ).toVar();\n\tconst t1 = float( sub( 1.0, t ) ).toVar();\n\tconst r1 = float( sub( 1.0, r ) ).toVar();\n\n\treturn r1.mul( t1.mul( v0.mul( s1 ).add( v1.mul( s ) ) ).add( t.mul( v2.mul( s1 ).add( v3.mul( s ) ) ) ) ).add( r.mul( t1.mul( v4.mul( s1 ).add( v5.mul( s ) ) ).add( t.mul( v6.mul( s1 ).add( v7.mul( s ) ) ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_trilerp_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'v0', type: 'vec3' },\n\t\t{ name: 'v1', type: 'vec3' },\n\t\t{ name: 'v2', type: 'vec3' },\n\t\t{ name: 'v3', type: 'vec3' },\n\t\t{ name: 'v4', type: 'vec3' },\n\t\t{ name: 'v5', type: 'vec3' },\n\t\t{ name: 'v6', type: 'vec3' },\n\t\t{ name: 'v7', type: 'vec3' },\n\t\t{ name: 's', type: 'float' },\n\t\t{ name: 't', type: 'float' },\n\t\t{ name: 'r', type: 'float' }\n\t]\n} );\n\nconst mx_trilerp = /*@__PURE__*/ overloadingFn( [ mx_trilerp_0, mx_trilerp_1 ] );\n\nconst mx_gradient_float_0 = /*@__PURE__*/ Fn( ( [ hash_immutable, x_immutable, y_immutable ] ) => {\n\n\tconst y = float( y_immutable ).toVar();\n\tconst x = float( x_immutable ).toVar();\n\tconst hash = uint( hash_immutable ).toVar();\n\tconst h = uint( hash.bitAnd( uint( 7 ) ) ).toVar();\n\tconst u = float( mx_select( h.lessThan( uint( 4 ) ), x, y ) ).toVar();\n\tconst v = float( mul( 2.0, mx_select( h.lessThan( uint( 4 ) ), y, x ) ) ).toVar();\n\n\treturn mx_negate_if( u, bool( h.bitAnd( uint( 1 ) ) ) ).add( mx_negate_if( v, bool( h.bitAnd( uint( 2 ) ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_gradient_float_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'hash', type: 'uint' },\n\t\t{ name: 'x', type: 'float' },\n\t\t{ name: 'y', type: 'float' }\n\t]\n} );\n\nconst mx_gradient_float_1 = /*@__PURE__*/ Fn( ( [ hash_immutable, x_immutable, y_immutable, z_immutable ] ) => {\n\n\tconst z = float( z_immutable ).toVar();\n\tconst y = float( y_immutable ).toVar();\n\tconst x = float( x_immutable ).toVar();\n\tconst hash = uint( hash_immutable ).toVar();\n\tconst h = uint( hash.bitAnd( uint( 15 ) ) ).toVar();\n\tconst u = float( mx_select( h.lessThan( uint( 8 ) ), x, y ) ).toVar();\n\tconst v = float( mx_select( h.lessThan( uint( 4 ) ), y, mx_select( h.equal( uint( 12 ) ).or( h.equal( uint( 14 ) ) ), x, z ) ) ).toVar();\n\n\treturn mx_negate_if( u, bool( h.bitAnd( uint( 1 ) ) ) ).add( mx_negate_if( v, bool( h.bitAnd( uint( 2 ) ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_gradient_float_1',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'hash', type: 'uint' },\n\t\t{ name: 'x', type: 'float' },\n\t\t{ name: 'y', type: 'float' },\n\t\t{ name: 'z', type: 'float' }\n\t]\n} );\n\nconst mx_gradient_float = /*@__PURE__*/ overloadingFn( [ mx_gradient_float_0, mx_gradient_float_1 ] );\n\nconst mx_gradient_vec3_0 = /*@__PURE__*/ Fn( ( [ hash_immutable, x_immutable, y_immutable ] ) => {\n\n\tconst y = float( y_immutable ).toVar();\n\tconst x = float( x_immutable ).toVar();\n\tconst hash = uvec3( hash_immutable ).toVar();\n\n\treturn vec3( mx_gradient_float( hash.x, x, y ), mx_gradient_float( hash.y, x, y ), mx_gradient_float( hash.z, x, y ) );\n\n} ).setLayout( {\n\tname: 'mx_gradient_vec3_0',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'hash', type: 'uvec3' },\n\t\t{ name: 'x', type: 'float' },\n\t\t{ name: 'y', type: 'float' }\n\t]\n} );\n\nconst mx_gradient_vec3_1 = /*@__PURE__*/ Fn( ( [ hash_immutable, x_immutable, y_immutable, z_immutable ] ) => {\n\n\tconst z = float( z_immutable ).toVar();\n\tconst y = float( y_immutable ).toVar();\n\tconst x = float( x_immutable ).toVar();\n\tconst hash = uvec3( hash_immutable ).toVar();\n\n\treturn vec3( mx_gradient_float( hash.x, x, y, z ), mx_gradient_float( hash.y, x, y, z ), mx_gradient_float( hash.z, x, y, z ) );\n\n} ).setLayout( {\n\tname: 'mx_gradient_vec3_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'hash', type: 'uvec3' },\n\t\t{ name: 'x', type: 'float' },\n\t\t{ name: 'y', type: 'float' },\n\t\t{ name: 'z', type: 'float' }\n\t]\n} );\n\nconst mx_gradient_vec3 = /*@__PURE__*/ overloadingFn( [ mx_gradient_vec3_0, mx_gradient_vec3_1 ] );\n\nconst mx_gradient_scale2d_0 = /*@__PURE__*/ Fn( ( [ v_immutable ] ) => {\n\n\tconst v = float( v_immutable ).toVar();\n\n\treturn mul( 0.6616, v );\n\n} ).setLayout( {\n\tname: 'mx_gradient_scale2d_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'v', type: 'float' }\n\t]\n} );\n\nconst mx_gradient_scale3d_0 = /*@__PURE__*/ Fn( ( [ v_immutable ] ) => {\n\n\tconst v = float( v_immutable ).toVar();\n\n\treturn mul( 0.9820, v );\n\n} ).setLayout( {\n\tname: 'mx_gradient_scale3d_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'v', type: 'float' }\n\t]\n} );\n\nconst mx_gradient_scale2d_1 = /*@__PURE__*/ Fn( ( [ v_immutable ] ) => {\n\n\tconst v = vec3( v_immutable ).toVar();\n\n\treturn mul( 0.6616, v );\n\n} ).setLayout( {\n\tname: 'mx_gradient_scale2d_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'v', type: 'vec3' }\n\t]\n} );\n\nconst mx_gradient_scale2d = /*@__PURE__*/ overloadingFn( [ mx_gradient_scale2d_0, mx_gradient_scale2d_1 ] );\n\nconst mx_gradient_scale3d_1 = /*@__PURE__*/ Fn( ( [ v_immutable ] ) => {\n\n\tconst v = vec3( v_immutable ).toVar();\n\n\treturn mul( 0.9820, v );\n\n} ).setLayout( {\n\tname: 'mx_gradient_scale3d_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'v', type: 'vec3' }\n\t]\n} );\n\nconst mx_gradient_scale3d = /*@__PURE__*/ overloadingFn( [ mx_gradient_scale3d_0, mx_gradient_scale3d_1 ] );\n\nconst mx_rotl32 = /*@__PURE__*/ Fn( ( [ x_immutable, k_immutable ] ) => {\n\n\tconst k = int( k_immutable ).toVar();\n\tconst x = uint( x_immutable ).toVar();\n\n\treturn x.shiftLeft( k ).bitOr( x.shiftRight( int( 32 ).sub( k ) ) );\n\n} ).setLayout( {\n\tname: 'mx_rotl32',\n\ttype: 'uint',\n\tinputs: [\n\t\t{ name: 'x', type: 'uint' },\n\t\t{ name: 'k', type: 'int' }\n\t]\n} );\n\nconst mx_bjmix = /*@__PURE__*/ Fn( ( [ a, b, c ] ) => {\n\n\ta.subAssign( c );\n\ta.bitXorAssign( mx_rotl32( c, int( 4 ) ) );\n\tc.addAssign( b );\n\tb.subAssign( a );\n\tb.bitXorAssign( mx_rotl32( a, int( 6 ) ) );\n\ta.addAssign( c );\n\tc.subAssign( b );\n\tc.bitXorAssign( mx_rotl32( b, int( 8 ) ) );\n\tb.addAssign( a );\n\ta.subAssign( c );\n\ta.bitXorAssign( mx_rotl32( c, int( 16 ) ) );\n\tc.addAssign( b );\n\tb.subAssign( a );\n\tb.bitXorAssign( mx_rotl32( a, int( 19 ) ) );\n\ta.addAssign( c );\n\tc.subAssign( b );\n\tc.bitXorAssign( mx_rotl32( b, int( 4 ) ) );\n\tb.addAssign( a );\n\n} );\n\nconst mx_bjfinal = /*@__PURE__*/ Fn( ( [ a_immutable, b_immutable, c_immutable ] ) => {\n\n\tconst c = uint( c_immutable ).toVar();\n\tconst b = uint( b_immutable ).toVar();\n\tconst a = uint( a_immutable ).toVar();\n\tc.bitXorAssign( b );\n\tc.subAssign( mx_rotl32( b, int( 14 ) ) );\n\ta.bitXorAssign( c );\n\ta.subAssign( mx_rotl32( c, int( 11 ) ) );\n\tb.bitXorAssign( a );\n\tb.subAssign( mx_rotl32( a, int( 25 ) ) );\n\tc.bitXorAssign( b );\n\tc.subAssign( mx_rotl32( b, int( 16 ) ) );\n\ta.bitXorAssign( c );\n\ta.subAssign( mx_rotl32( c, int( 4 ) ) );\n\tb.bitXorAssign( a );\n\tb.subAssign( mx_rotl32( a, int( 14 ) ) );\n\tc.bitXorAssign( b );\n\tc.subAssign( mx_rotl32( b, int( 24 ) ) );\n\n\treturn c;\n\n} ).setLayout( {\n\tname: 'mx_bjfinal',\n\ttype: 'uint',\n\tinputs: [\n\t\t{ name: 'a', type: 'uint' },\n\t\t{ name: 'b', type: 'uint' },\n\t\t{ name: 'c', type: 'uint' }\n\t]\n} );\n\nconst mx_bits_to_01 = /*@__PURE__*/ Fn( ( [ bits_immutable ] ) => {\n\n\tconst bits = uint( bits_immutable ).toVar();\n\n\treturn float( bits ).div( float( uint( int( 0xffffffff ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_bits_to_01',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'bits', type: 'uint' }\n\t]\n} );\n\nconst mx_fade = /*@__PURE__*/ Fn( ( [ t_immutable ] ) => {\n\n\tconst t = float( t_immutable ).toVar();\n\n\treturn t.mul( t ).mul( t ).mul( t.mul( t.mul( 6.0 ).sub( 15.0 ) ).add( 10.0 ) );\n\n} ).setLayout( {\n\tname: 'mx_fade',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 't', type: 'float' }\n\t]\n} );\n\nconst mx_hash_int_0 = /*@__PURE__*/ Fn( ( [ x_immutable ] ) => {\n\n\tconst x = int( x_immutable ).toVar();\n\tconst len = uint( uint( 1 ) ).toVar();\n\tconst seed = uint( uint( int( 0xdeadbeef ) ).add( len.shiftLeft( uint( 2 ) ) ).add( uint( 13 ) ) ).toVar();\n\n\treturn mx_bjfinal( seed.add( uint( x ) ), seed, seed );\n\n} ).setLayout( {\n\tname: 'mx_hash_int_0',\n\ttype: 'uint',\n\tinputs: [\n\t\t{ name: 'x', type: 'int' }\n\t]\n} );\n\nconst mx_hash_int_1 = /*@__PURE__*/ Fn( ( [ x_immutable, y_immutable ] ) => {\n\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst len = uint( uint( 2 ) ).toVar();\n\tconst a = uint().toVar(), b = uint().toVar(), c = uint().toVar();\n\ta.assign( b.assign( c.assign( uint( int( 0xdeadbeef ) ).add( len.shiftLeft( uint( 2 ) ) ).add( uint( 13 ) ) ) ) );\n\ta.addAssign( uint( x ) );\n\tb.addAssign( uint( y ) );\n\n\treturn mx_bjfinal( a, b, c );\n\n} ).setLayout( {\n\tname: 'mx_hash_int_1',\n\ttype: 'uint',\n\tinputs: [\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' }\n\t]\n} );\n\nconst mx_hash_int_2 = /*@__PURE__*/ Fn( ( [ x_immutable, y_immutable, z_immutable ] ) => {\n\n\tconst z = int( z_immutable ).toVar();\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst len = uint( uint( 3 ) ).toVar();\n\tconst a = uint().toVar(), b = uint().toVar(), c = uint().toVar();\n\ta.assign( b.assign( c.assign( uint( int( 0xdeadbeef ) ).add( len.shiftLeft( uint( 2 ) ) ).add( uint( 13 ) ) ) ) );\n\ta.addAssign( uint( x ) );\n\tb.addAssign( uint( y ) );\n\tc.addAssign( uint( z ) );\n\n\treturn mx_bjfinal( a, b, c );\n\n} ).setLayout( {\n\tname: 'mx_hash_int_2',\n\ttype: 'uint',\n\tinputs: [\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' },\n\t\t{ name: 'z', type: 'int' }\n\t]\n} );\n\nconst mx_hash_int_3 = /*@__PURE__*/ Fn( ( [ x_immutable, y_immutable, z_immutable, xx_immutable ] ) => {\n\n\tconst xx = int( xx_immutable ).toVar();\n\tconst z = int( z_immutable ).toVar();\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst len = uint( uint( 4 ) ).toVar();\n\tconst a = uint().toVar(), b = uint().toVar(), c = uint().toVar();\n\ta.assign( b.assign( c.assign( uint( int( 0xdeadbeef ) ).add( len.shiftLeft( uint( 2 ) ) ).add( uint( 13 ) ) ) ) );\n\ta.addAssign( uint( x ) );\n\tb.addAssign( uint( y ) );\n\tc.addAssign( uint( z ) );\n\tmx_bjmix( a, b, c );\n\ta.addAssign( uint( xx ) );\n\n\treturn mx_bjfinal( a, b, c );\n\n} ).setLayout( {\n\tname: 'mx_hash_int_3',\n\ttype: 'uint',\n\tinputs: [\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' },\n\t\t{ name: 'z', type: 'int' },\n\t\t{ name: 'xx', type: 'int' }\n\t]\n} );\n\nconst mx_hash_int_4 = /*@__PURE__*/ Fn( ( [ x_immutable, y_immutable, z_immutable, xx_immutable, yy_immutable ] ) => {\n\n\tconst yy = int( yy_immutable ).toVar();\n\tconst xx = int( xx_immutable ).toVar();\n\tconst z = int( z_immutable ).toVar();\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst len = uint( uint( 5 ) ).toVar();\n\tconst a = uint().toVar(), b = uint().toVar(), c = uint().toVar();\n\ta.assign( b.assign( c.assign( uint( int( 0xdeadbeef ) ).add( len.shiftLeft( uint( 2 ) ) ).add( uint( 13 ) ) ) ) );\n\ta.addAssign( uint( x ) );\n\tb.addAssign( uint( y ) );\n\tc.addAssign( uint( z ) );\n\tmx_bjmix( a, b, c );\n\ta.addAssign( uint( xx ) );\n\tb.addAssign( uint( yy ) );\n\n\treturn mx_bjfinal( a, b, c );\n\n} ).setLayout( {\n\tname: 'mx_hash_int_4',\n\ttype: 'uint',\n\tinputs: [\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' },\n\t\t{ name: 'z', type: 'int' },\n\t\t{ name: 'xx', type: 'int' },\n\t\t{ name: 'yy', type: 'int' }\n\t]\n} );\n\nconst mx_hash_int = /*@__PURE__*/ overloadingFn( [ mx_hash_int_0, mx_hash_int_1, mx_hash_int_2, mx_hash_int_3, mx_hash_int_4 ] );\n\nconst mx_hash_vec3_0 = /*@__PURE__*/ Fn( ( [ x_immutable, y_immutable ] ) => {\n\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst h = uint( mx_hash_int( x, y ) ).toVar();\n\tconst result = uvec3().toVar();\n\tresult.x.assign( h.bitAnd( int( 0xFF ) ) );\n\tresult.y.assign( h.shiftRight( int( 8 ) ).bitAnd( int( 0xFF ) ) );\n\tresult.z.assign( h.shiftRight( int( 16 ) ).bitAnd( int( 0xFF ) ) );\n\n\treturn result;\n\n} ).setLayout( {\n\tname: 'mx_hash_vec3_0',\n\ttype: 'uvec3',\n\tinputs: [\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' }\n\t]\n} );\n\nconst mx_hash_vec3_1 = /*@__PURE__*/ Fn( ( [ x_immutable, y_immutable, z_immutable ] ) => {\n\n\tconst z = int( z_immutable ).toVar();\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst h = uint( mx_hash_int( x, y, z ) ).toVar();\n\tconst result = uvec3().toVar();\n\tresult.x.assign( h.bitAnd( int( 0xFF ) ) );\n\tresult.y.assign( h.shiftRight( int( 8 ) ).bitAnd( int( 0xFF ) ) );\n\tresult.z.assign( h.shiftRight( int( 16 ) ).bitAnd( int( 0xFF ) ) );\n\n\treturn result;\n\n} ).setLayout( {\n\tname: 'mx_hash_vec3_1',\n\ttype: 'uvec3',\n\tinputs: [\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' },\n\t\t{ name: 'z', type: 'int' }\n\t]\n} );\n\nconst mx_hash_vec3 = /*@__PURE__*/ overloadingFn( [ mx_hash_vec3_0, mx_hash_vec3_1 ] );\n\nconst mx_perlin_noise_float_0 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec2( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar();\n\tconst fx = float( mx_floorfrac( p.x, X ) ).toVar();\n\tconst fy = float( mx_floorfrac( p.y, Y ) ).toVar();\n\tconst u = float( mx_fade( fx ) ).toVar();\n\tconst v = float( mx_fade( fy ) ).toVar();\n\tconst result = float( mx_bilerp( mx_gradient_float( mx_hash_int( X, Y ), fx, fy ), mx_gradient_float( mx_hash_int( X.add( int( 1 ) ), Y ), fx.sub( 1.0 ), fy ), mx_gradient_float( mx_hash_int( X, Y.add( int( 1 ) ) ), fx, fy.sub( 1.0 ) ), mx_gradient_float( mx_hash_int( X.add( int( 1 ) ), Y.add( int( 1 ) ) ), fx.sub( 1.0 ), fy.sub( 1.0 ) ), u, v ) ).toVar();\n\n\treturn mx_gradient_scale2d( result );\n\n} ).setLayout( {\n\tname: 'mx_perlin_noise_float_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' }\n\t]\n} );\n\nconst mx_perlin_noise_float_1 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec3( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar(), Z = int().toVar();\n\tconst fx = float( mx_floorfrac( p.x, X ) ).toVar();\n\tconst fy = float( mx_floorfrac( p.y, Y ) ).toVar();\n\tconst fz = float( mx_floorfrac( p.z, Z ) ).toVar();\n\tconst u = float( mx_fade( fx ) ).toVar();\n\tconst v = float( mx_fade( fy ) ).toVar();\n\tconst w = float( mx_fade( fz ) ).toVar();\n\tconst result = float( mx_trilerp( mx_gradient_float( mx_hash_int( X, Y, Z ), fx, fy, fz ), mx_gradient_float( mx_hash_int( X.add( int( 1 ) ), Y, Z ), fx.sub( 1.0 ), fy, fz ), mx_gradient_float( mx_hash_int( X, Y.add( int( 1 ) ), Z ), fx, fy.sub( 1.0 ), fz ), mx_gradient_float( mx_hash_int( X.add( int( 1 ) ), Y.add( int( 1 ) ), Z ), fx.sub( 1.0 ), fy.sub( 1.0 ), fz ), mx_gradient_float( mx_hash_int( X, Y, Z.add( int( 1 ) ) ), fx, fy, fz.sub( 1.0 ) ), mx_gradient_float( mx_hash_int( X.add( int( 1 ) ), Y, Z.add( int( 1 ) ) ), fx.sub( 1.0 ), fy, fz.sub( 1.0 ) ), mx_gradient_float( mx_hash_int( X, Y.add( int( 1 ) ), Z.add( int( 1 ) ) ), fx, fy.sub( 1.0 ), fz.sub( 1.0 ) ), mx_gradient_float( mx_hash_int( X.add( int( 1 ) ), Y.add( int( 1 ) ), Z.add( int( 1 ) ) ), fx.sub( 1.0 ), fy.sub( 1.0 ), fz.sub( 1.0 ) ), u, v, w ) ).toVar();\n\n\treturn mx_gradient_scale3d( result );\n\n} ).setLayout( {\n\tname: 'mx_perlin_noise_float_1',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' }\n\t]\n} );\n\nconst mx_perlin_noise_float = /*@__PURE__*/ overloadingFn( [ mx_perlin_noise_float_0, mx_perlin_noise_float_1 ] );\n\nconst mx_perlin_noise_vec3_0 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec2( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar();\n\tconst fx = float( mx_floorfrac( p.x, X ) ).toVar();\n\tconst fy = float( mx_floorfrac( p.y, Y ) ).toVar();\n\tconst u = float( mx_fade( fx ) ).toVar();\n\tconst v = float( mx_fade( fy ) ).toVar();\n\tconst result = vec3( mx_bilerp( mx_gradient_vec3( mx_hash_vec3( X, Y ), fx, fy ), mx_gradient_vec3( mx_hash_vec3( X.add( int( 1 ) ), Y ), fx.sub( 1.0 ), fy ), mx_gradient_vec3( mx_hash_vec3( X, Y.add( int( 1 ) ) ), fx, fy.sub( 1.0 ) ), mx_gradient_vec3( mx_hash_vec3( X.add( int( 1 ) ), Y.add( int( 1 ) ) ), fx.sub( 1.0 ), fy.sub( 1.0 ) ), u, v ) ).toVar();\n\n\treturn mx_gradient_scale2d( result );\n\n} ).setLayout( {\n\tname: 'mx_perlin_noise_vec3_0',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' }\n\t]\n} );\n\nconst mx_perlin_noise_vec3_1 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec3( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar(), Z = int().toVar();\n\tconst fx = float( mx_floorfrac( p.x, X ) ).toVar();\n\tconst fy = float( mx_floorfrac( p.y, Y ) ).toVar();\n\tconst fz = float( mx_floorfrac( p.z, Z ) ).toVar();\n\tconst u = float( mx_fade( fx ) ).toVar();\n\tconst v = float( mx_fade( fy ) ).toVar();\n\tconst w = float( mx_fade( fz ) ).toVar();\n\tconst result = vec3( mx_trilerp( mx_gradient_vec3( mx_hash_vec3( X, Y, Z ), fx, fy, fz ), mx_gradient_vec3( mx_hash_vec3( X.add( int( 1 ) ), Y, Z ), fx.sub( 1.0 ), fy, fz ), mx_gradient_vec3( mx_hash_vec3( X, Y.add( int( 1 ) ), Z ), fx, fy.sub( 1.0 ), fz ), mx_gradient_vec3( mx_hash_vec3( X.add( int( 1 ) ), Y.add( int( 1 ) ), Z ), fx.sub( 1.0 ), fy.sub( 1.0 ), fz ), mx_gradient_vec3( mx_hash_vec3( X, Y, Z.add( int( 1 ) ) ), fx, fy, fz.sub( 1.0 ) ), mx_gradient_vec3( mx_hash_vec3( X.add( int( 1 ) ), Y, Z.add( int( 1 ) ) ), fx.sub( 1.0 ), fy, fz.sub( 1.0 ) ), mx_gradient_vec3( mx_hash_vec3( X, Y.add( int( 1 ) ), Z.add( int( 1 ) ) ), fx, fy.sub( 1.0 ), fz.sub( 1.0 ) ), mx_gradient_vec3( mx_hash_vec3( X.add( int( 1 ) ), Y.add( int( 1 ) ), Z.add( int( 1 ) ) ), fx.sub( 1.0 ), fy.sub( 1.0 ), fz.sub( 1.0 ) ), u, v, w ) ).toVar();\n\n\treturn mx_gradient_scale3d( result );\n\n} ).setLayout( {\n\tname: 'mx_perlin_noise_vec3_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' }\n\t]\n} );\n\nconst mx_perlin_noise_vec3 = /*@__PURE__*/ overloadingFn( [ mx_perlin_noise_vec3_0, mx_perlin_noise_vec3_1 ] );\n\nconst mx_cell_noise_float_0 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = float( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p ) ).toVar();\n\n\treturn mx_bits_to_01( mx_hash_int( ix ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_float_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'float' }\n\t]\n} );\n\nconst mx_cell_noise_float_1 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec2( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p.x ) ).toVar();\n\tconst iy = int( mx_floor( p.y ) ).toVar();\n\n\treturn mx_bits_to_01( mx_hash_int( ix, iy ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_float_1',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' }\n\t]\n} );\n\nconst mx_cell_noise_float_2 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec3( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p.x ) ).toVar();\n\tconst iy = int( mx_floor( p.y ) ).toVar();\n\tconst iz = int( mx_floor( p.z ) ).toVar();\n\n\treturn mx_bits_to_01( mx_hash_int( ix, iy, iz ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_float_2',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' }\n\t]\n} );\n\nconst mx_cell_noise_float_3 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec4( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p.x ) ).toVar();\n\tconst iy = int( mx_floor( p.y ) ).toVar();\n\tconst iz = int( mx_floor( p.z ) ).toVar();\n\tconst iw = int( mx_floor( p.w ) ).toVar();\n\n\treturn mx_bits_to_01( mx_hash_int( ix, iy, iz, iw ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_float_3',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec4' }\n\t]\n} );\n\nconst mx_cell_noise_float$1 = /*@__PURE__*/ overloadingFn( [ mx_cell_noise_float_0, mx_cell_noise_float_1, mx_cell_noise_float_2, mx_cell_noise_float_3 ] );\n\nconst mx_cell_noise_vec3_0 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = float( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p ) ).toVar();\n\n\treturn vec3( mx_bits_to_01( mx_hash_int( ix, int( 0 ) ) ), mx_bits_to_01( mx_hash_int( ix, int( 1 ) ) ), mx_bits_to_01( mx_hash_int( ix, int( 2 ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_vec3_0',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'float' }\n\t]\n} );\n\nconst mx_cell_noise_vec3_1 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec2( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p.x ) ).toVar();\n\tconst iy = int( mx_floor( p.y ) ).toVar();\n\n\treturn vec3( mx_bits_to_01( mx_hash_int( ix, iy, int( 0 ) ) ), mx_bits_to_01( mx_hash_int( ix, iy, int( 1 ) ) ), mx_bits_to_01( mx_hash_int( ix, iy, int( 2 ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_vec3_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' }\n\t]\n} );\n\nconst mx_cell_noise_vec3_2 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec3( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p.x ) ).toVar();\n\tconst iy = int( mx_floor( p.y ) ).toVar();\n\tconst iz = int( mx_floor( p.z ) ).toVar();\n\n\treturn vec3( mx_bits_to_01( mx_hash_int( ix, iy, iz, int( 0 ) ) ), mx_bits_to_01( mx_hash_int( ix, iy, iz, int( 1 ) ) ), mx_bits_to_01( mx_hash_int( ix, iy, iz, int( 2 ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_vec3_2',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' }\n\t]\n} );\n\nconst mx_cell_noise_vec3_3 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec4( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p.x ) ).toVar();\n\tconst iy = int( mx_floor( p.y ) ).toVar();\n\tconst iz = int( mx_floor( p.z ) ).toVar();\n\tconst iw = int( mx_floor( p.w ) ).toVar();\n\n\treturn vec3( mx_bits_to_01( mx_hash_int( ix, iy, iz, iw, int( 0 ) ) ), mx_bits_to_01( mx_hash_int( ix, iy, iz, iw, int( 1 ) ) ), mx_bits_to_01( mx_hash_int( ix, iy, iz, iw, int( 2 ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_vec3_3',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec4' }\n\t]\n} );\n\nconst mx_cell_noise_vec3 = /*@__PURE__*/ overloadingFn( [ mx_cell_noise_vec3_0, mx_cell_noise_vec3_1, mx_cell_noise_vec3_2, mx_cell_noise_vec3_3 ] );\n\nconst mx_fractal_noise_float$1 = /*@__PURE__*/ Fn( ( [ p_immutable, octaves_immutable, lacunarity_immutable, diminish_immutable ] ) => {\n\n\tconst diminish = float( diminish_immutable ).toVar();\n\tconst lacunarity = float( lacunarity_immutable ).toVar();\n\tconst octaves = int( octaves_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\tconst result = float( 0.0 ).toVar();\n\tconst amplitude = float( 1.0 ).toVar();\n\n\tLoop( octaves, () => {\n\n\t\tresult.addAssign( amplitude.mul( mx_perlin_noise_float( p ) ) );\n\t\tamplitude.mulAssign( diminish );\n\t\tp.mulAssign( lacunarity );\n\n\t} );\n\n\treturn result;\n\n} ).setLayout( {\n\tname: 'mx_fractal_noise_float',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'octaves', type: 'int' },\n\t\t{ name: 'lacunarity', type: 'float' },\n\t\t{ name: 'diminish', type: 'float' }\n\t]\n} );\n\nconst mx_fractal_noise_vec3$1 = /*@__PURE__*/ Fn( ( [ p_immutable, octaves_immutable, lacunarity_immutable, diminish_immutable ] ) => {\n\n\tconst diminish = float( diminish_immutable ).toVar();\n\tconst lacunarity = float( lacunarity_immutable ).toVar();\n\tconst octaves = int( octaves_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\tconst result = vec3( 0.0 ).toVar();\n\tconst amplitude = float( 1.0 ).toVar();\n\n\tLoop( octaves, () => {\n\n\t\tresult.addAssign( amplitude.mul( mx_perlin_noise_vec3( p ) ) );\n\t\tamplitude.mulAssign( diminish );\n\t\tp.mulAssign( lacunarity );\n\n\t} );\n\n\treturn result;\n\n} ).setLayout( {\n\tname: 'mx_fractal_noise_vec3',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'octaves', type: 'int' },\n\t\t{ name: 'lacunarity', type: 'float' },\n\t\t{ name: 'diminish', type: 'float' }\n\t]\n} );\n\nconst mx_fractal_noise_vec2$1 = /*@__PURE__*/ Fn( ( [ p_immutable, octaves_immutable, lacunarity_immutable, diminish_immutable ] ) => {\n\n\tconst diminish = float( diminish_immutable ).toVar();\n\tconst lacunarity = float( lacunarity_immutable ).toVar();\n\tconst octaves = int( octaves_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\n\treturn vec2( mx_fractal_noise_float$1( p, octaves, lacunarity, diminish ), mx_fractal_noise_float$1( p.add( vec3( int( 19 ), int( 193 ), int( 17 ) ) ), octaves, lacunarity, diminish ) );\n\n} ).setLayout( {\n\tname: 'mx_fractal_noise_vec2',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'octaves', type: 'int' },\n\t\t{ name: 'lacunarity', type: 'float' },\n\t\t{ name: 'diminish', type: 'float' }\n\t]\n} );\n\nconst mx_fractal_noise_vec4$1 = /*@__PURE__*/ Fn( ( [ p_immutable, octaves_immutable, lacunarity_immutable, diminish_immutable ] ) => {\n\n\tconst diminish = float( diminish_immutable ).toVar();\n\tconst lacunarity = float( lacunarity_immutable ).toVar();\n\tconst octaves = int( octaves_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\tconst c = vec3( mx_fractal_noise_vec3$1( p, octaves, lacunarity, diminish ) ).toVar();\n\tconst f = float( mx_fractal_noise_float$1( p.add( vec3( int( 19 ), int( 193 ), int( 17 ) ) ), octaves, lacunarity, diminish ) ).toVar();\n\n\treturn vec4( c, f );\n\n} ).setLayout( {\n\tname: 'mx_fractal_noise_vec4',\n\ttype: 'vec4',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'octaves', type: 'int' },\n\t\t{ name: 'lacunarity', type: 'float' },\n\t\t{ name: 'diminish', type: 'float' }\n\t]\n} );\n\nconst mx_worley_distance_0 = /*@__PURE__*/ Fn( ( [ p_immutable, x_immutable, y_immutable, xoff_immutable, yoff_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst yoff = int( yoff_immutable ).toVar();\n\tconst xoff = int( xoff_immutable ).toVar();\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst p = vec2( p_immutable ).toVar();\n\tconst tmp = vec3( mx_cell_noise_vec3( vec2( x.add( xoff ), y.add( yoff ) ) ) ).toVar();\n\tconst off = vec2( tmp.x, tmp.y ).toVar();\n\toff.subAssign( 0.5 );\n\toff.mulAssign( jitter );\n\toff.addAssign( 0.5 );\n\tconst cellpos = vec2( vec2( float( x ), float( y ) ).add( off ) ).toVar();\n\tconst diff = vec2( cellpos.sub( p ) ).toVar();\n\n\tIf( metric.equal( int( 2 ) ), () => {\n\n\t\treturn abs( diff.x ).add( abs( diff.y ) );\n\n\t} );\n\n\tIf( metric.equal( int( 3 ) ), () => {\n\n\t\treturn max$1( abs( diff.x ), abs( diff.y ) );\n\n\t} );\n\n\treturn dot( diff, diff );\n\n} ).setLayout( {\n\tname: 'mx_worley_distance_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' },\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' },\n\t\t{ name: 'xoff', type: 'int' },\n\t\t{ name: 'yoff', type: 'int' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_distance_1 = /*@__PURE__*/ Fn( ( [ p_immutable, x_immutable, y_immutable, z_immutable, xoff_immutable, yoff_immutable, zoff_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst zoff = int( zoff_immutable ).toVar();\n\tconst yoff = int( yoff_immutable ).toVar();\n\tconst xoff = int( xoff_immutable ).toVar();\n\tconst z = int( z_immutable ).toVar();\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\tconst off = vec3( mx_cell_noise_vec3( vec3( x.add( xoff ), y.add( yoff ), z.add( zoff ) ) ) ).toVar();\n\toff.subAssign( 0.5 );\n\toff.mulAssign( jitter );\n\toff.addAssign( 0.5 );\n\tconst cellpos = vec3( vec3( float( x ), float( y ), float( z ) ).add( off ) ).toVar();\n\tconst diff = vec3( cellpos.sub( p ) ).toVar();\n\n\tIf( metric.equal( int( 2 ) ), () => {\n\n\t\treturn abs( diff.x ).add( abs( diff.y ) ).add( abs( diff.z ) );\n\n\t} );\n\n\tIf( metric.equal( int( 3 ) ), () => {\n\n\t\treturn max$1( max$1( abs( diff.x ), abs( diff.y ) ), abs( diff.z ) );\n\n\t} );\n\n\treturn dot( diff, diff );\n\n} ).setLayout( {\n\tname: 'mx_worley_distance_1',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' },\n\t\t{ name: 'z', type: 'int' },\n\t\t{ name: 'xoff', type: 'int' },\n\t\t{ name: 'yoff', type: 'int' },\n\t\t{ name: 'zoff', type: 'int' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_distance = /*@__PURE__*/ overloadingFn( [ mx_worley_distance_0, mx_worley_distance_1 ] );\n\nconst mx_worley_noise_float_0 = /*@__PURE__*/ Fn( ( [ p_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst p = vec2( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar();\n\tconst localpos = vec2( mx_floorfrac( p.x, X ), mx_floorfrac( p.y, Y ) ).toVar();\n\tconst sqdist = float( 1e6 ).toVar();\n\n\tLoop( { start: - 1, end: int( 1 ), name: 'x', condition: '<=' }, ( { x } ) => {\n\n\t\tLoop( { start: - 1, end: int( 1 ), name: 'y', condition: '<=' }, ( { y } ) => {\n\n\t\t\tconst dist = float( mx_worley_distance( localpos, x, y, X, Y, jitter, metric ) ).toVar();\n\t\t\tsqdist.assign( min$1( sqdist, dist ) );\n\n\t\t} );\n\n\t} );\n\n\tIf( metric.equal( int( 0 ) ), () => {\n\n\t\tsqdist.assign( sqrt( sqdist ) );\n\n\t} );\n\n\treturn sqdist;\n\n} ).setLayout( {\n\tname: 'mx_worley_noise_float_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_noise_vec2_0 = /*@__PURE__*/ Fn( ( [ p_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst p = vec2( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar();\n\tconst localpos = vec2( mx_floorfrac( p.x, X ), mx_floorfrac( p.y, Y ) ).toVar();\n\tconst sqdist = vec2( 1e6, 1e6 ).toVar();\n\n\tLoop( { start: - 1, end: int( 1 ), name: 'x', condition: '<=' }, ( { x } ) => {\n\n\t\tLoop( { start: - 1, end: int( 1 ), name: 'y', condition: '<=' }, ( { y } ) => {\n\n\t\t\tconst dist = float( mx_worley_distance( localpos, x, y, X, Y, jitter, metric ) ).toVar();\n\n\t\t\tIf( dist.lessThan( sqdist.x ), () => {\n\n\t\t\t\tsqdist.y.assign( sqdist.x );\n\t\t\t\tsqdist.x.assign( dist );\n\n\t\t\t} ).ElseIf( dist.lessThan( sqdist.y ), () => {\n\n\t\t\t\tsqdist.y.assign( dist );\n\n\t\t\t} );\n\n\t\t} );\n\n\t} );\n\n\tIf( metric.equal( int( 0 ) ), () => {\n\n\t\tsqdist.assign( sqrt( sqdist ) );\n\n\t} );\n\n\treturn sqdist;\n\n} ).setLayout( {\n\tname: 'mx_worley_noise_vec2_0',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_noise_vec3_0 = /*@__PURE__*/ Fn( ( [ p_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst p = vec2( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar();\n\tconst localpos = vec2( mx_floorfrac( p.x, X ), mx_floorfrac( p.y, Y ) ).toVar();\n\tconst sqdist = vec3( 1e6, 1e6, 1e6 ).toVar();\n\n\tLoop( { start: - 1, end: int( 1 ), name: 'x', condition: '<=' }, ( { x } ) => {\n\n\t\tLoop( { start: - 1, end: int( 1 ), name: 'y', condition: '<=' }, ( { y } ) => {\n\n\t\t\tconst dist = float( mx_worley_distance( localpos, x, y, X, Y, jitter, metric ) ).toVar();\n\n\t\t\tIf( dist.lessThan( sqdist.x ), () => {\n\n\t\t\t\tsqdist.z.assign( sqdist.y );\n\t\t\t\tsqdist.y.assign( sqdist.x );\n\t\t\t\tsqdist.x.assign( dist );\n\n\t\t\t} ).ElseIf( dist.lessThan( sqdist.y ), () => {\n\n\t\t\t\tsqdist.z.assign( sqdist.y );\n\t\t\t\tsqdist.y.assign( dist );\n\n\t\t\t} ).ElseIf( dist.lessThan( sqdist.z ), () => {\n\n\t\t\t\tsqdist.z.assign( dist );\n\n\t\t\t} );\n\n\t\t} );\n\n\t} );\n\n\tIf( metric.equal( int( 0 ) ), () => {\n\n\t\tsqdist.assign( sqrt( sqdist ) );\n\n\t} );\n\n\treturn sqdist;\n\n} ).setLayout( {\n\tname: 'mx_worley_noise_vec3_0',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_noise_float_1 = /*@__PURE__*/ Fn( ( [ p_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar(), Z = int().toVar();\n\tconst localpos = vec3( mx_floorfrac( p.x, X ), mx_floorfrac( p.y, Y ), mx_floorfrac( p.z, Z ) ).toVar();\n\tconst sqdist = float( 1e6 ).toVar();\n\n\tLoop( { start: - 1, end: int( 1 ), name: 'x', condition: '<=' }, ( { x } ) => {\n\n\t\tLoop( { start: - 1, end: int( 1 ), name: 'y', condition: '<=' }, ( { y } ) => {\n\n\t\t\tLoop( { start: - 1, end: int( 1 ), name: 'z', condition: '<=' }, ( { z } ) => {\n\n\t\t\t\tconst dist = float( mx_worley_distance( localpos, x, y, z, X, Y, Z, jitter, metric ) ).toVar();\n\t\t\t\tsqdist.assign( min$1( sqdist, dist ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t} );\n\n\tIf( metric.equal( int( 0 ) ), () => {\n\n\t\tsqdist.assign( sqrt( sqdist ) );\n\n\t} );\n\n\treturn sqdist;\n\n} ).setLayout( {\n\tname: 'mx_worley_noise_float_1',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_noise_float$1 = /*@__PURE__*/ overloadingFn( [ mx_worley_noise_float_0, mx_worley_noise_float_1 ] );\n\nconst mx_worley_noise_vec2_1 = /*@__PURE__*/ Fn( ( [ p_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar(), Z = int().toVar();\n\tconst localpos = vec3( mx_floorfrac( p.x, X ), mx_floorfrac( p.y, Y ), mx_floorfrac( p.z, Z ) ).toVar();\n\tconst sqdist = vec2( 1e6, 1e6 ).toVar();\n\n\tLoop( { start: - 1, end: int( 1 ), name: 'x', condition: '<=' }, ( { x } ) => {\n\n\t\tLoop( { start: - 1, end: int( 1 ), name: 'y', condition: '<=' }, ( { y } ) => {\n\n\t\t\tLoop( { start: - 1, end: int( 1 ), name: 'z', condition: '<=' }, ( { z } ) => {\n\n\t\t\t\tconst dist = float( mx_worley_distance( localpos, x, y, z, X, Y, Z, jitter, metric ) ).toVar();\n\n\t\t\t\tIf( dist.lessThan( sqdist.x ), () => {\n\n\t\t\t\t\tsqdist.y.assign( sqdist.x );\n\t\t\t\t\tsqdist.x.assign( dist );\n\n\t\t\t\t} ).ElseIf( dist.lessThan( sqdist.y ), () => {\n\n\t\t\t\t\tsqdist.y.assign( dist );\n\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t} );\n\n\t} );\n\n\tIf( metric.equal( int( 0 ) ), () => {\n\n\t\tsqdist.assign( sqrt( sqdist ) );\n\n\t} );\n\n\treturn sqdist;\n\n} ).setLayout( {\n\tname: 'mx_worley_noise_vec2_1',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_noise_vec2$1 = /*@__PURE__*/ overloadingFn( [ mx_worley_noise_vec2_0, mx_worley_noise_vec2_1 ] );\n\nconst mx_worley_noise_vec3_1 = /*@__PURE__*/ Fn( ( [ p_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar(), Z = int().toVar();\n\tconst localpos = vec3( mx_floorfrac( p.x, X ), mx_floorfrac( p.y, Y ), mx_floorfrac( p.z, Z ) ).toVar();\n\tconst sqdist = vec3( 1e6, 1e6, 1e6 ).toVar();\n\n\tLoop( { start: - 1, end: int( 1 ), name: 'x', condition: '<=' }, ( { x } ) => {\n\n\t\tLoop( { start: - 1, end: int( 1 ), name: 'y', condition: '<=' }, ( { y } ) => {\n\n\t\t\tLoop( { start: - 1, end: int( 1 ), name: 'z', condition: '<=' }, ( { z } ) => {\n\n\t\t\t\tconst dist = float( mx_worley_distance( localpos, x, y, z, X, Y, Z, jitter, metric ) ).toVar();\n\n\t\t\t\tIf( dist.lessThan( sqdist.x ), () => {\n\n\t\t\t\t\tsqdist.z.assign( sqdist.y );\n\t\t\t\t\tsqdist.y.assign( sqdist.x );\n\t\t\t\t\tsqdist.x.assign( dist );\n\n\t\t\t\t} ).ElseIf( dist.lessThan( sqdist.y ), () => {\n\n\t\t\t\t\tsqdist.z.assign( sqdist.y );\n\t\t\t\t\tsqdist.y.assign( dist );\n\n\t\t\t\t} ).ElseIf( dist.lessThan( sqdist.z ), () => {\n\n\t\t\t\t\tsqdist.z.assign( dist );\n\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t} );\n\n\t} );\n\n\tIf( metric.equal( int( 0 ) ), () => {\n\n\t\tsqdist.assign( sqrt( sqdist ) );\n\n\t} );\n\n\treturn sqdist;\n\n} ).setLayout( {\n\tname: 'mx_worley_noise_vec3_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_noise_vec3$1 = /*@__PURE__*/ overloadingFn( [ mx_worley_noise_vec3_0, mx_worley_noise_vec3_1 ] );\n\n// Three.js Transpiler\n// https://github.com/AcademySoftwareFoundation/MaterialX/blob/main/libraries/stdlib/genglsl/lib/mx_hsv.glsl\n\n\nconst mx_hsvtorgb = /*@__PURE__*/ Fn( ( [ hsv ] ) => {\n\n\tconst s = hsv.y;\n\tconst v = hsv.z;\n\n\tconst result = vec3().toVar();\n\n\tIf( s.lessThan( 0.0001 ), () => {\n\n\t\tresult.assign( vec3( v, v, v ) );\n\n\t} ).Else( () => {\n\n\t\tlet h = hsv.x;\n\t\th = h.sub( floor( h ) ).mul( 6.0 ).toVar(); // TODO: check what .toVar() is needed in node system cache\n\t\tconst hi = int( trunc( h ) );\n\t\tconst f = h.sub( float( hi ) );\n\t\tconst p = v.mul( s.oneMinus() );\n\t\tconst q = v.mul( s.mul( f ).oneMinus() );\n\t\tconst t = v.mul( s.mul( f.oneMinus() ).oneMinus() );\n\n\t\tIf( hi.equal( int( 0 ) ), () => {\n\n\t\t\tresult.assign( vec3( v, t, p ) );\n\n\t\t} ).ElseIf( hi.equal( int( 1 ) ), () => {\n\n\t\t\tresult.assign( vec3( q, v, p ) );\n\n\t\t} ).ElseIf( hi.equal( int( 2 ) ), () => {\n\n\t\t\tresult.assign( vec3( p, v, t ) );\n\n\t\t} ).ElseIf( hi.equal( int( 3 ) ), () => {\n\n\t\t\tresult.assign( vec3( p, q, v ) );\n\n\t\t} ).ElseIf( hi.equal( int( 4 ) ), () => {\n\n\t\t\tresult.assign( vec3( t, p, v ) );\n\n\t\t} ).Else( () => {\n\n\t\t\tresult.assign( vec3( v, p, q ) );\n\n\t\t} );\n\n\t} );\n\n\treturn result;\n\n} ).setLayout( {\n\tname: 'mx_hsvtorgb',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'hsv', type: 'vec3' }\n\t]\n} );\n\nconst mx_rgbtohsv = /*@__PURE__*/ Fn( ( [ c_immutable ] ) => {\n\n\tconst c = vec3( c_immutable ).toVar();\n\tconst r = float( c.x ).toVar();\n\tconst g = float( c.y ).toVar();\n\tconst b = float( c.z ).toVar();\n\tconst mincomp = float( min$1( r, min$1( g, b ) ) ).toVar();\n\tconst maxcomp = float( max$1( r, max$1( g, b ) ) ).toVar();\n\tconst delta = float( maxcomp.sub( mincomp ) ).toVar();\n\tconst h = float().toVar(), s = float().toVar(), v = float().toVar();\n\tv.assign( maxcomp );\n\n\tIf( maxcomp.greaterThan( 0.0 ), () => {\n\n\t\ts.assign( delta.div( maxcomp ) );\n\n\t} ).Else( () => {\n\n\t\ts.assign( 0.0 );\n\n\t} );\n\n\tIf( s.lessThanEqual( 0.0 ), () => {\n\n\t\th.assign( 0.0 );\n\n\t} ).Else( () => {\n\n\t\tIf( r.greaterThanEqual( maxcomp ), () => {\n\n\t\t\th.assign( g.sub( b ).div( delta ) );\n\n\t\t} ).ElseIf( g.greaterThanEqual( maxcomp ), () => {\n\n\t\t\th.assign( add( 2.0, b.sub( r ).div( delta ) ) );\n\n\t\t} ).Else( () => {\n\n\t\t\th.assign( add( 4.0, r.sub( g ).div( delta ) ) );\n\n\t\t} );\n\n\t\th.mulAssign( 1.0 / 6.0 );\n\n\t\tIf( h.lessThan( 0.0 ), () => {\n\n\t\t\th.addAssign( 1.0 );\n\n\t\t} );\n\n\t} );\n\n\treturn vec3( h, s, v );\n\n} ).setLayout( {\n\tname: 'mx_rgbtohsv',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'c', type: 'vec3' }\n\t]\n} );\n\n// Three.js Transpiler\n// https://github.com/AcademySoftwareFoundation/MaterialX/blob/main/libraries/stdlib/genglsl/lib/mx_transform_color.glsl\n\n\nconst mx_srgb_texture_to_lin_rec709 = /*@__PURE__*/ Fn( ( [ color_immutable ] ) => {\n\n\tconst color = vec3( color_immutable ).toVar();\n\tconst isAbove = bvec3( greaterThan( color, vec3( 0.04045 ) ) ).toVar();\n\tconst linSeg = vec3( color.div( 12.92 ) ).toVar();\n\tconst powSeg = vec3( pow( max$1( color.add( vec3( 0.055 ) ), vec3( 0.0 ) ).div( 1.055 ), vec3( 2.4 ) ) ).toVar();\n\n\treturn mix( linSeg, powSeg, isAbove );\n\n} ).setLayout( {\n\tname: 'mx_srgb_texture_to_lin_rec709',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' }\n\t]\n} );\n\nconst mx_aastep = ( threshold, value ) => {\n\n\tthreshold = float( threshold );\n\tvalue = float( value );\n\n\tconst afwidth = vec2( value.dFdx(), value.dFdy() ).length().mul( 0.70710678118654757 );\n\n\treturn smoothstep( threshold.sub( afwidth ), threshold.add( afwidth ), value );\n\n};\n\nconst _ramp = ( a, b, uv, p ) => mix( a, b, uv[ p ].clamp() );\nconst mx_ramplr = ( valuel, valuer, texcoord = uv() ) => _ramp( valuel, valuer, texcoord, 'x' );\nconst mx_ramptb = ( valuet, valueb, texcoord = uv() ) => _ramp( valuet, valueb, texcoord, 'y' );\n\nconst _split = ( a, b, center, uv, p ) => mix( a, b, mx_aastep( center, uv[ p ] ) );\nconst mx_splitlr = ( valuel, valuer, center, texcoord = uv() ) => _split( valuel, valuer, center, texcoord, 'x' );\nconst mx_splittb = ( valuet, valueb, center, texcoord = uv() ) => _split( valuet, valueb, center, texcoord, 'y' );\n\nconst mx_transform_uv = ( uv_scale = 1, uv_offset = 0, uv_geo = uv() ) => uv_geo.mul( uv_scale ).add( uv_offset );\n\nconst mx_safepower = ( in1, in2 = 1 ) => {\n\n\tin1 = float( in1 );\n\n\treturn in1.abs().pow( in2 ).mul( in1.sign() );\n\n};\n\nconst mx_contrast = ( input, amount = 1, pivot = .5 ) => float( input ).sub( pivot ).mul( amount ).add( pivot );\n\nconst mx_noise_float = ( texcoord = uv(), amplitude = 1, pivot = 0 ) => mx_perlin_noise_float( texcoord.convert( 'vec2|vec3' ) ).mul( amplitude ).add( pivot );\n//export const mx_noise_vec2 = ( texcoord = uv(), amplitude = 1, pivot = 0 ) => mx_perlin_noise_vec3( texcoord.convert( 'vec2|vec3' ) ).mul( amplitude ).add( pivot );\nconst mx_noise_vec3 = ( texcoord = uv(), amplitude = 1, pivot = 0 ) => mx_perlin_noise_vec3( texcoord.convert( 'vec2|vec3' ) ).mul( amplitude ).add( pivot );\nconst mx_noise_vec4 = ( texcoord = uv(), amplitude = 1, pivot = 0 ) => {\n\n\ttexcoord = texcoord.convert( 'vec2|vec3' ); // overloading type\n\n\tconst noise_vec4 = vec4( mx_perlin_noise_vec3( texcoord ), mx_perlin_noise_float( texcoord.add( vec2( 19, 73 ) ) ) );\n\n\treturn noise_vec4.mul( amplitude ).add( pivot );\n\n};\n\nconst mx_worley_noise_float = ( texcoord = uv(), jitter = 1 ) => mx_worley_noise_float$1( texcoord.convert( 'vec2|vec3' ), jitter, int( 1 ) );\nconst mx_worley_noise_vec2 = ( texcoord = uv(), jitter = 1 ) => mx_worley_noise_vec2$1( texcoord.convert( 'vec2|vec3' ), jitter, int( 1 ) );\nconst mx_worley_noise_vec3 = ( texcoord = uv(), jitter = 1 ) => mx_worley_noise_vec3$1( texcoord.convert( 'vec2|vec3' ), jitter, int( 1 ) );\n\nconst mx_cell_noise_float = ( texcoord = uv() ) => mx_cell_noise_float$1( texcoord.convert( 'vec2|vec3' ) );\n\nconst mx_fractal_noise_float = ( position = uv(), octaves = 3, lacunarity = 2, diminish = .5, amplitude = 1 ) => mx_fractal_noise_float$1( position, int( octaves ), lacunarity, diminish ).mul( amplitude );\nconst mx_fractal_noise_vec2 = ( position = uv(), octaves = 3, lacunarity = 2, diminish = .5, amplitude = 1 ) => mx_fractal_noise_vec2$1( position, int( octaves ), lacunarity, diminish ).mul( amplitude );\nconst mx_fractal_noise_vec3 = ( position = uv(), octaves = 3, lacunarity = 2, diminish = .5, amplitude = 1 ) => mx_fractal_noise_vec3$1( position, int( octaves ), lacunarity, diminish ).mul( amplitude );\nconst mx_fractal_noise_vec4 = ( position = uv(), octaves = 3, lacunarity = 2, diminish = .5, amplitude = 1 ) => mx_fractal_noise_vec4$1( position, int( octaves ), lacunarity, diminish ).mul( amplitude );\n\n// https://devlog-martinsh.blogspot.com/2011/09/box-projected-cube-environment-mapping.html\n\nconst getParallaxCorrectNormal = /*@__PURE__*/ Fn( ( [ normal, cubeSize, cubePos ] ) => {\n\n\tconst nDir = normalize( normal ).toVar( 'nDir' );\n\tconst rbmax = sub( float( 0.5 ).mul( cubeSize.sub( cubePos ) ), positionWorld ).div( nDir ).toVar( 'rbmax' );\n\tconst rbmin = sub( float( - 0.5 ).mul( cubeSize.sub( cubePos ) ), positionWorld ).div( nDir ).toVar( 'rbmin' );\n\tconst rbminmax = vec3().toVar( 'rbminmax' );\n\trbminmax.x = nDir.x.greaterThan( float( 0 ) ).select( rbmax.x, rbmin.x );\n\trbminmax.y = nDir.y.greaterThan( float( 0 ) ).select( rbmax.y, rbmin.y );\n\trbminmax.z = nDir.z.greaterThan( float( 0 ) ).select( rbmax.z, rbmin.z );\n\n\tconst correction = min$1( min$1( rbminmax.x, rbminmax.y ), rbminmax.z ).toVar( 'correction' );\n\tconst boxIntersection = positionWorld.add( nDir.mul( correction ) ).toVar( 'boxIntersection' );\n\treturn boxIntersection.sub( cubePos );\n\n} );\n\nconst getShIrradianceAt = /*@__PURE__*/ Fn( ( [ normal, shCoefficients ] ) => {\n\n\t// normal is assumed to have unit length\n\n\tconst x = normal.x, y = normal.y, z = normal.z;\n\n\t// band 0\n\tlet result = shCoefficients.element( 0 ).mul( 0.886227 );\n\n\t// band 1\n\tresult = result.add( shCoefficients.element( 1 ).mul( 2.0 * 0.511664 ).mul( y ) );\n\tresult = result.add( shCoefficients.element( 2 ).mul( 2.0 * 0.511664 ).mul( z ) );\n\tresult = result.add( shCoefficients.element( 3 ).mul( 2.0 * 0.511664 ).mul( x ) );\n\n\t// band 2\n\tresult = result.add( shCoefficients.element( 4 ).mul( 2.0 * 0.429043 ).mul( x ).mul( y ) );\n\tresult = result.add( shCoefficients.element( 5 ).mul( 2.0 * 0.429043 ).mul( y ).mul( z ) );\n\tresult = result.add( shCoefficients.element( 6 ).mul( z.mul( z ).mul( 0.743125 ).sub( 0.247708 ) ) );\n\tresult = result.add( shCoefficients.element( 7 ).mul( 2.0 * 0.429043 ).mul( x ).mul( z ) );\n\tresult = result.add( shCoefficients.element( 8 ).mul( 0.429043 ).mul( mul( x, x ).sub( mul( y, y ) ) ) );\n\n\treturn result;\n\n} );\n\n// constants\n\nvar TSL = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tBRDF_GGX: BRDF_GGX,\n\tBRDF_Lambert: BRDF_Lambert,\n\tBasicShadowFilter: BasicShadowFilter,\n\tBreak: Break,\n\tContinue: Continue,\n\tDFGApprox: DFGApprox,\n\tD_GGX: D_GGX,\n\tDiscard: Discard,\n\tEPSILON: EPSILON,\n\tF_Schlick: F_Schlick,\n\tFn: Fn,\n\tINFINITY: INFINITY,\n\tIf: If,\n\tLoop: Loop,\n\tNodeAccess: NodeAccess,\n\tNodeShaderStage: NodeShaderStage,\n\tNodeType: NodeType,\n\tNodeUpdateType: NodeUpdateType,\n\tPCFShadowFilter: PCFShadowFilter,\n\tPCFSoftShadowFilter: PCFSoftShadowFilter,\n\tPI: PI,\n\tPI2: PI2,\n\tReturn: Return,\n\tSchlick_to_F0: Schlick_to_F0,\n\tScriptableNodeResources: ScriptableNodeResources,\n\tShaderNode: ShaderNode,\n\tTBNViewMatrix: TBNViewMatrix,\n\tVSMShadowFilter: VSMShadowFilter,\n\tV_GGX_SmithCorrelated: V_GGX_SmithCorrelated,\n\tabs: abs,\n\tacesFilmicToneMapping: acesFilmicToneMapping,\n\tacos: acos,\n\tadd: add,\n\taddMethodChaining: addMethodChaining,\n\taddNodeElement: addNodeElement,\n\tagxToneMapping: agxToneMapping,\n\tall: all,\n\talphaT: alphaT,\n\tand: and,\n\tanisotropy: anisotropy,\n\tanisotropyB: anisotropyB,\n\tanisotropyT: anisotropyT,\n\tany: any,\n\tappend: append,\n\tarrayBuffer: arrayBuffer,\n\tasin: asin,\n\tassign: assign,\n\tatan: atan,\n\tatan2: atan2,\n\tatomicAdd: atomicAdd,\n\tatomicAnd: atomicAnd,\n\tatomicFunc: atomicFunc,\n\tatomicMax: atomicMax,\n\tatomicMin: atomicMin,\n\tatomicOr: atomicOr,\n\tatomicStore: atomicStore,\n\tatomicSub: atomicSub,\n\tatomicXor: atomicXor,\n\tattenuationColor: attenuationColor,\n\tattenuationDistance: attenuationDistance,\n\tattribute: attribute,\n\tattributeArray: attributeArray,\n\tbackgroundBlurriness: backgroundBlurriness,\n\tbackgroundIntensity: backgroundIntensity,\n\tbackgroundRotation: backgroundRotation,\n\tbatch: batch,\n\tbillboarding: billboarding,\n\tbitAnd: bitAnd,\n\tbitNot: bitNot,\n\tbitOr: bitOr,\n\tbitXor: bitXor,\n\tbitangentGeometry: bitangentGeometry,\n\tbitangentLocal: bitangentLocal,\n\tbitangentView: bitangentView,\n\tbitangentWorld: bitangentWorld,\n\tbitcast: bitcast,\n\tblendBurn: blendBurn,\n\tblendColor: blendColor,\n\tblendDodge: blendDodge,\n\tblendOverlay: blendOverlay,\n\tblendScreen: blendScreen,\n\tblur: blur,\n\tbool: bool,\n\tbuffer: buffer,\n\tbufferAttribute: bufferAttribute,\n\tbumpMap: bumpMap,\n\tburn: burn,\n\tbvec2: bvec2,\n\tbvec3: bvec3,\n\tbvec4: bvec4,\n\tbypass: bypass,\n\tcache: cache,\n\tcall: call,\n\tcameraFar: cameraFar,\n\tcameraNear: cameraNear,\n\tcameraNormalMatrix: cameraNormalMatrix,\n\tcameraPosition: cameraPosition,\n\tcameraProjectionMatrix: cameraProjectionMatrix,\n\tcameraProjectionMatrixInverse: cameraProjectionMatrixInverse,\n\tcameraViewMatrix: cameraViewMatrix,\n\tcameraWorldMatrix: cameraWorldMatrix,\n\tcbrt: cbrt,\n\tcdl: cdl,\n\tceil: ceil,\n\tchecker: checker,\n\tcineonToneMapping: cineonToneMapping,\n\tclamp: clamp,\n\tclearcoat: clearcoat,\n\tclearcoatRoughness: clearcoatRoughness,\n\tcode: code,\n\tcolor: color,\n\tcolorSpaceToWorking: colorSpaceToWorking,\n\tcolorToDirection: colorToDirection,\n\tcompute: compute,\n\tcond: cond,\n\tcontext: context,\n\tconvert: convert,\n\tconvertColorSpace: convertColorSpace,\n\tconvertToTexture: convertToTexture,\n\tcos: cos,\n\tcross: cross,\n\tcubeTexture: cubeTexture,\n\tdFdx: dFdx,\n\tdFdy: dFdy,\n\tdashSize: dashSize,\n\tdefaultBuildStages: defaultBuildStages,\n\tdefaultShaderStages: defaultShaderStages,\n\tdefined: defined,\n\tdegrees: degrees,\n\tdeltaTime: deltaTime,\n\tdensityFog: densityFog,\n\tdepth: depth,\n\tdepthPass: depthPass,\n\tdifference: difference,\n\tdiffuseColor: diffuseColor,\n\tdirectPointLight: directPointLight,\n\tdirectionToColor: directionToColor,\n\tdispersion: dispersion,\n\tdistance: distance,\n\tdiv: div,\n\tdodge: dodge,\n\tdot: dot,\n\tdrawIndex: drawIndex,\n\tdynamicBufferAttribute: dynamicBufferAttribute,\n\telement: element,\n\temissive: emissive,\n\tequal: equal,\n\tequals: equals,\n\tequirectUV: equirectUV,\n\texp: exp,\n\texp2: exp2,\n\texpression: expression,\n\tfaceDirection: faceDirection,\n\tfaceForward: faceForward,\n\tfloat: float,\n\tfloor: floor,\n\tfog: fog,\n\tfract: fract,\n\tframeGroup: frameGroup,\n\tframeId: frameId,\n\tfrontFacing: frontFacing,\n\tfwidth: fwidth,\n\tgain: gain,\n\tgapSize: gapSize,\n\tgetConstNodeType: getConstNodeType,\n\tgetCurrentStack: getCurrentStack,\n\tgetDirection: getDirection,\n\tgetDistanceAttenuation: getDistanceAttenuation,\n\tgetGeometryRoughness: getGeometryRoughness,\n\tgetNormalFromDepth: getNormalFromDepth,\n\tgetParallaxCorrectNormal: getParallaxCorrectNormal,\n\tgetRoughness: getRoughness,\n\tgetScreenPosition: getScreenPosition,\n\tgetShIrradianceAt: getShIrradianceAt,\n\tgetTextureIndex: getTextureIndex,\n\tgetViewPosition: getViewPosition,\n\tglsl: glsl,\n\tglslFn: glslFn,\n\tgrayscale: grayscale,\n\tgreaterThan: greaterThan,\n\tgreaterThanEqual: greaterThanEqual,\n\thash: hash,\n\thighPrecisionModelNormalViewMatrix: highPrecisionModelNormalViewMatrix,\n\thighPrecisionModelViewMatrix: highPrecisionModelViewMatrix,\n\thue: hue,\n\tinstance: instance,\n\tinstanceIndex: instanceIndex,\n\tinstancedArray: instancedArray,\n\tinstancedBufferAttribute: instancedBufferAttribute,\n\tinstancedDynamicBufferAttribute: instancedDynamicBufferAttribute,\n\tinstancedMesh: instancedMesh,\n\tint: int,\n\tinverseSqrt: inverseSqrt,\n\tinvocationLocalIndex: invocationLocalIndex,\n\tinvocationSubgroupIndex: invocationSubgroupIndex,\n\tior: ior,\n\tiridescence: iridescence,\n\tiridescenceIOR: iridescenceIOR,\n\tiridescenceThickness: iridescenceThickness,\n\tivec2: ivec2,\n\tivec3: ivec3,\n\tivec4: ivec4,\n\tjs: js,\n\tlabel: label,\n\tlength: length,\n\tlengthSq: lengthSq,\n\tlessThan: lessThan,\n\tlessThanEqual: lessThanEqual,\n\tlightPosition: lightPosition,\n\tlightProjectionUV: lightProjectionUV,\n\tlightShadowMatrix: lightShadowMatrix,\n\tlightTargetDirection: lightTargetDirection,\n\tlightTargetPosition: lightTargetPosition,\n\tlightViewPosition: lightViewPosition,\n\tlightingContext: lightingContext,\n\tlights: lights,\n\tlinearDepth: linearDepth,\n\tlinearToneMapping: linearToneMapping,\n\tlocalId: localId,\n\tlog: log,\n\tlog2: log2,\n\tlogarithmicDepthToViewZ: logarithmicDepthToViewZ,\n\tloop: loop,\n\tluminance: luminance,\n\tmat2: mat2,\n\tmat3: mat3,\n\tmat4: mat4,\n\tmatcapUV: matcapUV,\n\tmaterialAOMap: materialAOMap,\n\tmaterialAlphaTest: materialAlphaTest,\n\tmaterialAnisotropy: materialAnisotropy,\n\tmaterialAnisotropyVector: materialAnisotropyVector,\n\tmaterialAttenuationColor: materialAttenuationColor,\n\tmaterialAttenuationDistance: materialAttenuationDistance,\n\tmaterialClearcoat: materialClearcoat,\n\tmaterialClearcoatNormal: materialClearcoatNormal,\n\tmaterialClearcoatRoughness: materialClearcoatRoughness,\n\tmaterialColor: materialColor,\n\tmaterialDispersion: materialDispersion,\n\tmaterialEmissive: materialEmissive,\n\tmaterialIOR: materialIOR,\n\tmaterialIridescence: materialIridescence,\n\tmaterialIridescenceIOR: materialIridescenceIOR,\n\tmaterialIridescenceThickness: materialIridescenceThickness,\n\tmaterialLightMap: materialLightMap,\n\tmaterialLineDashOffset: materialLineDashOffset,\n\tmaterialLineDashSize: materialLineDashSize,\n\tmaterialLineGapSize: materialLineGapSize,\n\tmaterialLineScale: materialLineScale,\n\tmaterialLineWidth: materialLineWidth,\n\tmaterialMetalness: materialMetalness,\n\tmaterialNormal: materialNormal,\n\tmaterialOpacity: materialOpacity,\n\tmaterialPointWidth: materialPointWidth,\n\tmaterialReference: materialReference,\n\tmaterialReflectivity: materialReflectivity,\n\tmaterialRefractionRatio: materialRefractionRatio,\n\tmaterialRotation: materialRotation,\n\tmaterialRoughness: materialRoughness,\n\tmaterialSheen: materialSheen,\n\tmaterialSheenRoughness: materialSheenRoughness,\n\tmaterialShininess: materialShininess,\n\tmaterialSpecular: materialSpecular,\n\tmaterialSpecularColor: materialSpecularColor,\n\tmaterialSpecularIntensity: materialSpecularIntensity,\n\tmaterialSpecularStrength: materialSpecularStrength,\n\tmaterialThickness: materialThickness,\n\tmaterialTransmission: materialTransmission,\n\tmax: max$1,\n\tmaxMipLevel: maxMipLevel,\n\tmetalness: metalness,\n\tmin: min$1,\n\tmix: mix,\n\tmixElement: mixElement,\n\tmod: mod,\n\tmodInt: modInt,\n\tmodelDirection: modelDirection,\n\tmodelNormalMatrix: modelNormalMatrix,\n\tmodelPosition: modelPosition,\n\tmodelScale: modelScale,\n\tmodelViewMatrix: modelViewMatrix,\n\tmodelViewPosition: modelViewPosition,\n\tmodelViewProjection: modelViewProjection,\n\tmodelWorldMatrix: modelWorldMatrix,\n\tmodelWorldMatrixInverse: modelWorldMatrixInverse,\n\tmorphReference: morphReference,\n\tmrt: mrt,\n\tmul: mul,\n\tmx_aastep: mx_aastep,\n\tmx_cell_noise_float: mx_cell_noise_float,\n\tmx_contrast: mx_contrast,\n\tmx_fractal_noise_float: mx_fractal_noise_float,\n\tmx_fractal_noise_vec2: mx_fractal_noise_vec2,\n\tmx_fractal_noise_vec3: mx_fractal_noise_vec3,\n\tmx_fractal_noise_vec4: mx_fractal_noise_vec4,\n\tmx_hsvtorgb: mx_hsvtorgb,\n\tmx_noise_float: mx_noise_float,\n\tmx_noise_vec3: mx_noise_vec3,\n\tmx_noise_vec4: mx_noise_vec4,\n\tmx_ramplr: mx_ramplr,\n\tmx_ramptb: mx_ramptb,\n\tmx_rgbtohsv: mx_rgbtohsv,\n\tmx_safepower: mx_safepower,\n\tmx_splitlr: mx_splitlr,\n\tmx_splittb: mx_splittb,\n\tmx_srgb_texture_to_lin_rec709: mx_srgb_texture_to_lin_rec709,\n\tmx_transform_uv: mx_transform_uv,\n\tmx_worley_noise_float: mx_worley_noise_float,\n\tmx_worley_noise_vec2: mx_worley_noise_vec2,\n\tmx_worley_noise_vec3: mx_worley_noise_vec3,\n\tnegate: negate,\n\tneutralToneMapping: neutralToneMapping,\n\tnodeArray: nodeArray,\n\tnodeImmutable: nodeImmutable,\n\tnodeObject: nodeObject,\n\tnodeObjects: nodeObjects,\n\tnodeProxy: nodeProxy,\n\tnormalFlat: normalFlat,\n\tnormalGeometry: normalGeometry,\n\tnormalLocal: normalLocal,\n\tnormalMap: normalMap,\n\tnormalView: normalView,\n\tnormalWorld: normalWorld,\n\tnormalize: normalize,\n\tnot: not,\n\tnotEqual: notEqual,\n\tnumWorkgroups: numWorkgroups,\n\tobjectDirection: objectDirection,\n\tobjectGroup: objectGroup,\n\tobjectPosition: objectPosition,\n\tobjectScale: objectScale,\n\tobjectViewPosition: objectViewPosition,\n\tobjectWorldMatrix: objectWorldMatrix,\n\toneMinus: oneMinus,\n\tor: or,\n\torthographicDepthToViewZ: orthographicDepthToViewZ,\n\toscSawtooth: oscSawtooth,\n\toscSine: oscSine,\n\toscSquare: oscSquare,\n\toscTriangle: oscTriangle,\n\toutput: output,\n\toutputStruct: outputStruct,\n\toverlay: overlay,\n\toverloadingFn: overloadingFn,\n\tparabola: parabola,\n\tparallaxDirection: parallaxDirection,\n\tparallaxUV: parallaxUV,\n\tparameter: parameter,\n\tpass: pass,\n\tpassTexture: passTexture,\n\tpcurve: pcurve,\n\tperspectiveDepthToViewZ: perspectiveDepthToViewZ,\n\tpmremTexture: pmremTexture,\n\tpointUV: pointUV,\n\tpointWidth: pointWidth,\n\tpositionGeometry: positionGeometry,\n\tpositionLocal: positionLocal,\n\tpositionPrevious: positionPrevious,\n\tpositionView: positionView,\n\tpositionViewDirection: positionViewDirection,\n\tpositionWorld: positionWorld,\n\tpositionWorldDirection: positionWorldDirection,\n\tposterize: posterize,\n\tpow: pow,\n\tpow2: pow2,\n\tpow3: pow3,\n\tpow4: pow4,\n\tproperty: property,\n\tradians: radians,\n\trand: rand,\n\trange: range,\n\trangeFog: rangeFog,\n\treciprocal: reciprocal,\n\treference: reference,\n\treferenceBuffer: referenceBuffer,\n\treflect: reflect,\n\treflectVector: reflectVector,\n\treflectView: reflectView,\n\treflector: reflector,\n\trefract: refract,\n\trefractVector: refractVector,\n\trefractView: refractView,\n\treinhardToneMapping: reinhardToneMapping,\n\tremainder: remainder,\n\tremap: remap,\n\tremapClamp: remapClamp,\n\trenderGroup: renderGroup,\n\trenderOutput: renderOutput,\n\trendererReference: rendererReference,\n\trotate: rotate,\n\trotateUV: rotateUV,\n\troughness: roughness,\n\tround: round,\n\trtt: rtt,\n\tsRGBTransferEOTF: sRGBTransferEOTF,\n\tsRGBTransferOETF: sRGBTransferOETF,\n\tsampler: sampler,\n\tsaturate: saturate,\n\tsaturation: saturation,\n\tscreen: screen,\n\tscreenCoordinate: screenCoordinate,\n\tscreenSize: screenSize,\n\tscreenUV: screenUV,\n\tscriptable: scriptable,\n\tscriptableValue: scriptableValue,\n\tselect: select,\n\tsetCurrentStack: setCurrentStack,\n\tshaderStages: shaderStages,\n\tshadow: shadow,\n\tsharedUniformGroup: sharedUniformGroup,\n\tsheen: sheen,\n\tsheenRoughness: sheenRoughness,\n\tshiftLeft: shiftLeft,\n\tshiftRight: shiftRight,\n\tshininess: shininess,\n\tsign: sign,\n\tsin: sin,\n\tsinc: sinc,\n\tskinning: skinning,\n\tskinningReference: skinningReference,\n\tsmoothstep: smoothstep,\n\tsmoothstepElement: smoothstepElement,\n\tspecularColor: specularColor,\n\tspecularF90: specularF90,\n\tspherizeUV: spherizeUV,\n\tsplit: split,\n\tspritesheetUV: spritesheetUV,\n\tsqrt: sqrt,\n\tstack: stack,\n\tstep: step,\n\tstorage: storage,\n\tstorageBarrier: storageBarrier,\n\tstorageObject: storageObject,\n\tstorageTexture: storageTexture,\n\tstring: string,\n\tsub: sub,\n\tsubgroupIndex: subgroupIndex,\n\tsubgroupSize: subgroupSize,\n\ttan: tan,\n\ttangentGeometry: tangentGeometry,\n\ttangentLocal: tangentLocal,\n\ttangentView: tangentView,\n\ttangentWorld: tangentWorld,\n\ttemp: temp,\n\ttexture: texture,\n\ttexture3D: texture3D,\n\ttextureBarrier: textureBarrier,\n\ttextureBicubic: textureBicubic,\n\ttextureCubeUV: textureCubeUV,\n\ttextureLoad: textureLoad,\n\ttextureSize: textureSize,\n\ttextureStore: textureStore,\n\tthickness: thickness,\n\tthreshold: threshold,\n\ttime: time,\n\ttimerDelta: timerDelta,\n\ttimerGlobal: timerGlobal,\n\ttimerLocal: timerLocal,\n\ttoOutputColorSpace: toOutputColorSpace,\n\ttoWorkingColorSpace: toWorkingColorSpace,\n\ttoneMapping: toneMapping,\n\ttoneMappingExposure: toneMappingExposure,\n\ttoonOutlinePass: toonOutlinePass,\n\ttransformDirection: transformDirection,\n\ttransformNormal: transformNormal,\n\ttransformNormalToView: transformNormalToView,\n\ttransformedBentNormalView: transformedBentNormalView,\n\ttransformedBitangentView: transformedBitangentView,\n\ttransformedBitangentWorld: transformedBitangentWorld,\n\ttransformedClearcoatNormalView: transformedClearcoatNormalView,\n\ttransformedNormalView: transformedNormalView,\n\ttransformedNormalWorld: transformedNormalWorld,\n\ttransformedTangentView: transformedTangentView,\n\ttransformedTangentWorld: transformedTangentWorld,\n\ttransmission: transmission,\n\ttranspose: transpose,\n\ttri: tri,\n\ttri3: tri3,\n\ttriNoise3D: triNoise3D,\n\ttriplanarTexture: triplanarTexture,\n\ttriplanarTextures: triplanarTextures,\n\ttrunc: trunc,\n\ttslFn: tslFn,\n\tuint: uint,\n\tuniform: uniform,\n\tuniformArray: uniformArray,\n\tuniformGroup: uniformGroup,\n\tuniforms: uniforms,\n\tuserData: userData,\n\tuv: uv,\n\tuvec2: uvec2,\n\tuvec3: uvec3,\n\tuvec4: uvec4,\n\tvarying: varying,\n\tvaryingProperty: varyingProperty,\n\tvec2: vec2,\n\tvec3: vec3,\n\tvec4: vec4,\n\tvectorComponents: vectorComponents,\n\tvelocity: velocity,\n\tvertexColor: vertexColor,\n\tvertexIndex: vertexIndex,\n\tvibrance: vibrance,\n\tviewZToLogarithmicDepth: viewZToLogarithmicDepth,\n\tviewZToOrthographicDepth: viewZToOrthographicDepth,\n\tviewZToPerspectiveDepth: viewZToPerspectiveDepth,\n\tviewport: viewport,\n\tviewportBottomLeft: viewportBottomLeft,\n\tviewportCoordinate: viewportCoordinate,\n\tviewportDepthTexture: viewportDepthTexture,\n\tviewportLinearDepth: viewportLinearDepth,\n\tviewportMipTexture: viewportMipTexture,\n\tviewportResolution: viewportResolution,\n\tviewportSafeUV: viewportSafeUV,\n\tviewportSharedTexture: viewportSharedTexture,\n\tviewportSize: viewportSize,\n\tviewportTexture: viewportTexture,\n\tviewportTopLeft: viewportTopLeft,\n\tviewportUV: viewportUV,\n\twgsl: wgsl,\n\twgslFn: wgslFn,\n\tworkgroupArray: workgroupArray,\n\tworkgroupBarrier: workgroupBarrier,\n\tworkgroupId: workgroupId,\n\tworkingToColorSpace: workingToColorSpace,\n\txor: xor\n});\n\nconst _clearColor$1 = /*@__PURE__*/ new Color4();\n\nclass Background extends DataMap {\n\n\tconstructor( renderer, nodes ) {\n\n\t\tsuper();\n\n\t\tthis.renderer = renderer;\n\t\tthis.nodes = nodes;\n\n\t}\n\n\tupdate( scene, renderList, renderContext ) {\n\n\t\tconst renderer = this.renderer;\n\t\tconst background = this.nodes.getBackgroundNode( scene ) || scene.background;\n\n\t\tlet forceClear = false;\n\n\t\tif ( background === null ) {\n\n\t\t\t// no background settings, use clear color configuration from the renderer\n\n\t\t\trenderer._clearColor.getRGB( _clearColor$1, LinearSRGBColorSpace );\n\t\t\t_clearColor$1.a = renderer._clearColor.a;\n\n\t\t} else if ( background.isColor === true ) {\n\n\t\t\t// background is an opaque color\n\n\t\t\tbackground.getRGB( _clearColor$1, LinearSRGBColorSpace );\n\t\t\t_clearColor$1.a = 1;\n\n\t\t\tforceClear = true;\n\n\t\t} else if ( background.isNode === true ) {\n\n\t\t\tconst sceneData = this.get( scene );\n\t\t\tconst backgroundNode = background;\n\n\t\t\t_clearColor$1.copy( renderer._clearColor );\n\n\t\t\tlet backgroundMesh = sceneData.backgroundMesh;\n\n\t\t\tif ( backgroundMesh === undefined ) {\n\n\t\t\t\tconst backgroundMeshNode = context( vec4( backgroundNode ).mul( backgroundIntensity ), {\n\t\t\t\t\t// @TODO: Add Texture2D support using node context\n\t\t\t\t\tgetUV: () => backgroundRotation.mul( normalWorld ),\n\t\t\t\t\tgetTextureLevel: () => backgroundBlurriness\n\t\t\t\t} );\n\n\t\t\t\tlet viewProj = modelViewProjection();\n\t\t\t\tviewProj = viewProj.setZ( viewProj.w );\n\n\t\t\t\tconst nodeMaterial = new NodeMaterial();\n\t\t\t\tnodeMaterial.name = 'Background.material';\n\t\t\t\tnodeMaterial.side = BackSide;\n\t\t\t\tnodeMaterial.depthTest = false;\n\t\t\t\tnodeMaterial.depthWrite = false;\n\t\t\t\tnodeMaterial.fog = false;\n\t\t\t\tnodeMaterial.lights = false;\n\t\t\t\tnodeMaterial.vertexNode = viewProj;\n\t\t\t\tnodeMaterial.colorNode = backgroundMeshNode;\n\n\t\t\t\tsceneData.backgroundMeshNode = backgroundMeshNode;\n\t\t\t\tsceneData.backgroundMesh = backgroundMesh = new Mesh( new SphereGeometry( 1, 32, 32 ), nodeMaterial );\n\t\t\t\tbackgroundMesh.frustumCulled = false;\n\t\t\t\tbackgroundMesh.name = 'Background.mesh';\n\n\t\t\t\tbackgroundMesh.onBeforeRender = function ( renderer, scene, camera ) {\n\n\t\t\t\t\tthis.matrixWorld.copyPosition( camera.matrixWorld );\n\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\tconst backgroundCacheKey = backgroundNode.getCacheKey();\n\n\t\t\tif ( sceneData.backgroundCacheKey !== backgroundCacheKey ) {\n\n\t\t\t\tsceneData.backgroundMeshNode.node = vec4( backgroundNode ).mul( backgroundIntensity );\n\t\t\t\tsceneData.backgroundMeshNode.needsUpdate = true;\n\n\t\t\t\tbackgroundMesh.material.needsUpdate = true;\n\n\t\t\t\tsceneData.backgroundCacheKey = backgroundCacheKey;\n\n\t\t\t}\n\n\t\t\trenderList.unshift( backgroundMesh, backgroundMesh.geometry, backgroundMesh.material, 0, 0, null, null );\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Renderer: Unsupported background configuration.', background );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( renderer.autoClear === true || forceClear === true ) {\n\n\t\t\tconst clearColorValue = renderContext.clearColorValue;\n\n\t\t\tclearColorValue.r = _clearColor$1.r;\n\t\t\tclearColorValue.g = _clearColor$1.g;\n\t\t\tclearColorValue.b = _clearColor$1.b;\n\t\t\tclearColorValue.a = _clearColor$1.a;\n\n\t\t\t// premultiply alpha\n\n\t\t\tif ( renderer.backend.isWebGLBackend === true || renderer.alpha === true ) {\n\n\t\t\t\tclearColorValue.r *= clearColorValue.a;\n\t\t\t\tclearColorValue.g *= clearColorValue.a;\n\t\t\t\tclearColorValue.b *= clearColorValue.a;\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\trenderContext.depthClearValue = renderer._clearDepth;\n\t\t\trenderContext.stencilClearValue = renderer._clearStencil;\n\n\t\t\trenderContext.clearColor = renderer.autoClearColor === true;\n\t\t\trenderContext.clearDepth = renderer.autoClearDepth === true;\n\t\t\trenderContext.clearStencil = renderer.autoClearStencil === true;\n\n\t\t} else {\n\n\t\t\trenderContext.clearColor = false;\n\t\t\trenderContext.clearDepth = false;\n\t\t\trenderContext.clearStencil = false;\n\n\t\t}\n\n\t}\n\n}\n\nlet _id$5 = 0;\n\nclass BindGroup {\n\n\tconstructor( name = '', bindings = [], index = 0, bindingsReference = [] ) {\n\n\t\tthis.name = name;\n\t\tthis.bindings = bindings;\n\t\tthis.index = index;\n\t\tthis.bindingsReference = bindingsReference;\n\n\t\tthis.id = _id$5 ++;\n\n\t}\n\n}\n\nclass NodeBuilderState {\n\n\tconstructor( vertexShader, fragmentShader, computeShader, nodeAttributes, bindings, updateNodes, updateBeforeNodes, updateAfterNodes, monitor, transforms = [] ) {\n\n\t\tthis.vertexShader = vertexShader;\n\t\tthis.fragmentShader = fragmentShader;\n\t\tthis.computeShader = computeShader;\n\t\tthis.transforms = transforms;\n\n\t\tthis.nodeAttributes = nodeAttributes;\n\t\tthis.bindings = bindings;\n\n\t\tthis.updateNodes = updateNodes;\n\t\tthis.updateBeforeNodes = updateBeforeNodes;\n\t\tthis.updateAfterNodes = updateAfterNodes;\n\n\t\tthis.monitor = monitor;\n\n\t\tthis.usedTimes = 0;\n\n\t}\n\n\tcreateBindings() {\n\n\t\tconst bindings = [];\n\n\t\tfor ( const instanceGroup of this.bindings ) {\n\n\t\t\tconst shared = instanceGroup.bindings[ 0 ].groupNode.shared;\n\n\t\t\tif ( shared !== true ) {\n\n\t\t\t\tconst bindingsGroup = new BindGroup( instanceGroup.name, [], instanceGroup.index, instanceGroup );\n\t\t\t\tbindings.push( bindingsGroup );\n\n\t\t\t\tfor ( const instanceBinding of instanceGroup.bindings ) {\n\n\t\t\t\t\tbindingsGroup.bindings.push( instanceBinding.clone() );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tbindings.push( instanceGroup );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bindings;\n\n\t}\n\n}\n\nclass NodeAttribute {\n\n\tconstructor( name, type, node = null ) {\n\n\t\tthis.isNodeAttribute = true;\n\n\t\tthis.name = name;\n\t\tthis.type = type;\n\t\tthis.node = node;\n\n\t}\n\n}\n\nclass NodeUniform {\n\n\tconstructor( name, type, node ) {\n\n\t\tthis.isNodeUniform = true;\n\n\t\tthis.name = name;\n\t\tthis.type = type;\n\t\tthis.node = node.getSelf();\n\n\t}\n\n\tget value() {\n\n\t\treturn this.node.value;\n\n\t}\n\n\tset value( val ) {\n\n\t\tthis.node.value = val;\n\n\t}\n\n\tget id() {\n\n\t\treturn this.node.id;\n\n\t}\n\n\tget groupNode() {\n\n\t\treturn this.node.groupNode;\n\n\t}\n\n}\n\nclass NodeVar {\n\n\tconstructor( name, type ) {\n\n\t\tthis.isNodeVar = true;\n\n\t\tthis.name = name;\n\t\tthis.type = type;\n\n\t}\n\n}\n\nclass NodeVarying extends NodeVar {\n\n\tconstructor( name, type ) {\n\n\t\tsuper( name, type );\n\n\t\tthis.needsInterpolation = false;\n\n\t\tthis.isNodeVarying = true;\n\n\t}\n\n}\n\nclass NodeCode {\n\n\tconstructor( name, type, code = '' ) {\n\n\t\tthis.name = name;\n\t\tthis.type = type;\n\t\tthis.code = code;\n\n\t\tObject.defineProperty( this, 'isNodeCode', { value: true } );\n\n\t}\n\n}\n\nlet id = 0;\n\nclass NodeCache {\n\n\tconstructor( parent = null ) {\n\n\t\tthis.id = id ++;\n\t\tthis.nodesData = new WeakMap();\n\n\t\tthis.parent = parent;\n\n\t}\n\n\tgetData( node ) {\n\n\t\tlet data = this.nodesData.get( node );\n\n\t\tif ( data === undefined && this.parent !== null ) {\n\n\t\t\tdata = this.parent.getData( node );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tsetData( node, data ) {\n\n\t\tthis.nodesData.set( node, data );\n\n\t}\n\n}\n\nclass Uniform {\n\n\tconstructor( name, value ) {\n\n\t\tthis.name = name;\n\t\tthis.value = value;\n\n\t\tthis.boundary = 0; // used to build the uniform buffer according to the STD140 layout\n\t\tthis.itemSize = 0;\n\n\t\tthis.offset = 0; // this property is set by WebGPUUniformsGroup and marks the start position in the uniform buffer\n\n\t}\n\n\tsetValue( value ) {\n\n\t\tthis.value = value;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.value;\n\n\t}\n\n}\n\nclass NumberUniform extends Uniform {\n\n\tconstructor( name, value = 0 ) {\n\n\t\tsuper( name, value );\n\n\t\tthis.isNumberUniform = true;\n\n\t\tthis.boundary = 4;\n\t\tthis.itemSize = 1;\n\n\t}\n\n}\n\nclass Vector2Uniform extends Uniform {\n\n\tconstructor( name, value = new Vector2() ) {\n\n\t\tsuper( name, value );\n\n\t\tthis.isVector2Uniform = true;\n\n\t\tthis.boundary = 8;\n\t\tthis.itemSize = 2;\n\n\t}\n\n}\n\nclass Vector3Uniform extends Uniform {\n\n\tconstructor( name, value = new Vector3() ) {\n\n\t\tsuper( name, value );\n\n\t\tthis.isVector3Uniform = true;\n\n\t\tthis.boundary = 16;\n\t\tthis.itemSize = 3;\n\n\t}\n\n}\n\nclass Vector4Uniform extends Uniform {\n\n\tconstructor( name, value = new Vector4() ) {\n\n\t\tsuper( name, value );\n\n\t\tthis.isVector4Uniform = true;\n\n\t\tthis.boundary = 16;\n\t\tthis.itemSize = 4;\n\n\t}\n\n}\n\nclass ColorUniform extends Uniform {\n\n\tconstructor( name, value = new Color() ) {\n\n\t\tsuper( name, value );\n\n\t\tthis.isColorUniform = true;\n\n\t\tthis.boundary = 16;\n\t\tthis.itemSize = 3;\n\n\t}\n\n}\n\nclass Matrix3Uniform extends Uniform {\n\n\tconstructor( name, value = new Matrix3() ) {\n\n\t\tsuper( name, value );\n\n\t\tthis.isMatrix3Uniform = true;\n\n\t\tthis.boundary = 48;\n\t\tthis.itemSize = 12;\n\n\t}\n\n}\n\nclass Matrix4Uniform extends Uniform {\n\n\tconstructor( name, value = new Matrix4() ) {\n\n\t\tsuper( name, value );\n\n\t\tthis.isMatrix4Uniform = true;\n\n\t\tthis.boundary = 64;\n\t\tthis.itemSize = 16;\n\n\t}\n\n}\n\nclass NumberNodeUniform extends NumberUniform {\n\n\tconstructor( nodeUniform ) {\n\n\t\tsuper( nodeUniform.name, nodeUniform.value );\n\n\t\tthis.nodeUniform = nodeUniform;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n\tgetType() {\n\n\t\treturn this.nodeUniform.type;\n\n\t}\n\n}\n\nclass Vector2NodeUniform extends Vector2Uniform {\n\n\tconstructor( nodeUniform ) {\n\n\t\tsuper( nodeUniform.name, nodeUniform.value );\n\n\t\tthis.nodeUniform = nodeUniform;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n\tgetType() {\n\n\t\treturn this.nodeUniform.type;\n\n\t}\n\n}\n\nclass Vector3NodeUniform extends Vector3Uniform {\n\n\tconstructor( nodeUniform ) {\n\n\t\tsuper( nodeUniform.name, nodeUniform.value );\n\n\t\tthis.nodeUniform = nodeUniform;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n\tgetType() {\n\n\t\treturn this.nodeUniform.type;\n\n\t}\n\n}\n\nclass Vector4NodeUniform extends Vector4Uniform {\n\n\tconstructor( nodeUniform ) {\n\n\t\tsuper( nodeUniform.name, nodeUniform.value );\n\n\t\tthis.nodeUniform = nodeUniform;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n\tgetType() {\n\n\t\treturn this.nodeUniform.type;\n\n\t}\n\n}\n\nclass ColorNodeUniform extends ColorUniform {\n\n\tconstructor( nodeUniform ) {\n\n\t\tsuper( nodeUniform.name, nodeUniform.value );\n\n\t\tthis.nodeUniform = nodeUniform;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n\tgetType() {\n\n\t\treturn this.nodeUniform.type;\n\n\t}\n\n}\n\nclass Matrix3NodeUniform extends Matrix3Uniform {\n\n\tconstructor( nodeUniform ) {\n\n\t\tsuper( nodeUniform.name, nodeUniform.value );\n\n\t\tthis.nodeUniform = nodeUniform;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n\tgetType() {\n\n\t\treturn this.nodeUniform.type;\n\n\t}\n\n}\n\nclass Matrix4NodeUniform extends Matrix4Uniform {\n\n\tconstructor( nodeUniform ) {\n\n\t\tsuper( nodeUniform.name, nodeUniform.value );\n\n\t\tthis.nodeUniform = nodeUniform;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n\tgetType() {\n\n\t\treturn this.nodeUniform.type;\n\n\t}\n\n}\n\nconst LOD_MIN = 4;\n\n// The standard deviations (radians) associated with the extra mips. These are\n// chosen to approximate a Trowbridge-Reitz distribution function times the\n// geometric shadowing function. These sigma values squared must match the\n// variance #defines in cube_uv_reflection_fragment.glsl.js.\nconst EXTRA_LOD_SIGMA = [ 0.125, 0.215, 0.35, 0.446, 0.526, 0.582 ];\n\n// The maximum length of the blur for loop. Smaller sigmas will use fewer\n// samples and exit early, but not recompile the shader.\nconst MAX_SAMPLES = 20;\n\nconst _flatCamera = /*@__PURE__*/ new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\nconst _cubeCamera = /*@__PURE__*/ new PerspectiveCamera( 90, 1 );\nconst _clearColor = /*@__PURE__*/ new Color();\nlet _oldTarget = null;\nlet _oldActiveCubeFace = 0;\nlet _oldActiveMipmapLevel = 0;\n\n// Golden Ratio\nconst PHI = ( 1 + Math.sqrt( 5 ) ) / 2;\nconst INV_PHI = 1 / PHI;\n\n// Vertices of a dodecahedron (except the opposites, which represent the\n// same axis), used as axis directions evenly spread on a sphere.\nconst _axisDirections = [\n\t/*@__PURE__*/ new Vector3( - PHI, INV_PHI, 0 ),\n\t/*@__PURE__*/ new Vector3( PHI, INV_PHI, 0 ),\n\t/*@__PURE__*/ new Vector3( - INV_PHI, 0, PHI ),\n\t/*@__PURE__*/ new Vector3( INV_PHI, 0, PHI ),\n\t/*@__PURE__*/ new Vector3( 0, PHI, - INV_PHI ),\n\t/*@__PURE__*/ new Vector3( 0, PHI, INV_PHI ),\n\t/*@__PURE__*/ new Vector3( - 1, 1, - 1 ),\n\t/*@__PURE__*/ new Vector3( 1, 1, - 1 ),\n\t/*@__PURE__*/ new Vector3( - 1, 1, 1 ),\n\t/*@__PURE__*/ new Vector3( 1, 1, 1 )\n];\n\n//\n\n// WebGPU Face indices\nconst _faceLib = [\n\t3, 1, 5,\n\t0, 4, 2\n];\n\nconst direction = getDirection( uv(), attribute( 'faceIndex' ) ).normalize();\nconst outputDirection = vec3( direction.x, direction.y.negate(), direction.z );\n\n/**\n * This class generates a Prefiltered, Mipmapped Radiance Environment Map\n * (PMREM) from a cubeMap environment texture. This allows different levels of\n * blur to be quickly accessed based on material roughness. It is packed into a\n * special CubeUV format that allows us to perform custom interpolation so that\n * we can support nonlinear formats such as RGBE. Unlike a traditional mipmap\n * chain, it only goes down to the LOD_MIN level (above), and then creates extra\n * even more filtered 'mips' at the same LOD_MIN resolution, associated with\n * higher roughness levels. In this way we maintain resolution to smoothly\n * interpolate diffuse lighting while limiting sampling computation.\n *\n * Paper: Fast, Accurate Image-Based Lighting\n * https://drive.google.com/file/d/15y8r_UpKlU9SvV4ILb0C3qCPecS8pvLz/view\n*/\n\nclass PMREMGenerator {\n\n\tconstructor( renderer ) {\n\n\t\tthis._renderer = renderer;\n\t\tthis._pingPongRenderTarget = null;\n\n\t\tthis._lodMax = 0;\n\t\tthis._cubeSize = 0;\n\t\tthis._lodPlanes = [];\n\t\tthis._sizeLods = [];\n\t\tthis._sigmas = [];\n\t\tthis._lodMeshes = [];\n\n\t\tthis._blurMaterial = null;\n\t\tthis._cubemapMaterial = null;\n\t\tthis._equirectMaterial = null;\n\t\tthis._backgroundBox = null;\n\n\t}\n\n\tget _hasInitialized() {\n\n\t\treturn this._renderer.hasInitialized();\n\n\t}\n\n\t/**\n\t * Generates a PMREM from a supplied Scene, which can be faster than using an\n\t * image if networking bandwidth is low. Optional sigma specifies a blur radius\n\t * in radians to be applied to the scene before PMREM generation. Optional near\n\t * and far planes ensure the scene is rendered in its entirety (the cubeCamera\n\t * is placed at the origin).\n\t */\n\tfromScene( scene, sigma = 0, near = 0.1, far = 100, renderTarget = null ) {\n\n\t\tthis._setSize( 256 );\n\n\t\tif ( this._hasInitialized === false ) {\n\n\t\t\tconsole.warn( 'THREE.PMREMGenerator: .fromScene() called before the backend is initialized. Try using .fromSceneAsync() instead.' );\n\n\t\t\tconst cubeUVRenderTarget = renderTarget || this._allocateTargets();\n\n\t\t\tthis.fromSceneAsync( scene, sigma, near, far, cubeUVRenderTarget );\n\n\t\t\treturn cubeUVRenderTarget;\n\n\t\t}\n\n\t\t_oldTarget = this._renderer.getRenderTarget();\n\t\t_oldActiveCubeFace = this._renderer.getActiveCubeFace();\n\t\t_oldActiveMipmapLevel = this._renderer.getActiveMipmapLevel();\n\n\t\tconst cubeUVRenderTarget = renderTarget || this._allocateTargets();\n\t\tcubeUVRenderTarget.depthBuffer = true;\n\n\t\tthis._sceneToCubeUV( scene, near, far, cubeUVRenderTarget );\n\n\t\tif ( sigma > 0 ) {\n\n\t\t\tthis._blur( cubeUVRenderTarget, 0, 0, sigma );\n\n\t\t}\n\n\t\tthis._applyPMREM( cubeUVRenderTarget );\n\n\t\tthis._cleanup( cubeUVRenderTarget );\n\n\t\treturn cubeUVRenderTarget;\n\n\t}\n\n\tasync fromSceneAsync( scene, sigma = 0, near = 0.1, far = 100, renderTarget = null ) {\n\n\t\tif ( this._hasInitialized === false ) await this._renderer.init();\n\n\t\treturn this.fromScene( scene, sigma, near, far, renderTarget );\n\n\t}\n\n\t/**\n\t * Generates a PMREM from an equirectangular texture, which can be either LDR\n\t * or HDR. The ideal input image size is 1k (1024 x 512),\n\t * as this matches best with the 256 x 256 cubemap output.\n\t */\n\tfromEquirectangular( equirectangular, renderTarget = null ) {\n\n\t\tif ( this._hasInitialized === false ) {\n\n\t\t\tconsole.warn( 'THREE.PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using .fromEquirectangularAsync() instead.' );\n\n\t\t\tthis._setSizeFromTexture( equirectangular );\n\n\t\t\tconst cubeUVRenderTarget = renderTarget || this._allocateTargets();\n\n\t\t\tthis.fromEquirectangularAsync( equirectangular, cubeUVRenderTarget );\n\n\t\t\treturn cubeUVRenderTarget;\n\n\t\t}\n\n\t\treturn this._fromTexture( equirectangular, renderTarget );\n\n\t}\n\n\tasync fromEquirectangularAsync( equirectangular, renderTarget = null ) {\n\n\t\tif ( this._hasInitialized === false ) await this._renderer.init();\n\n\t\treturn this._fromTexture( equirectangular, renderTarget );\n\n\t}\n\n\t/**\n\t * Generates a PMREM from an cubemap texture, which can be either LDR\n\t * or HDR. The ideal input cube size is 256 x 256,\n\t * as this matches best with the 256 x 256 cubemap output.\n\t */\n\tfromCubemap( cubemap, renderTarget = null ) {\n\n\t\tif ( this._hasInitialized === false ) {\n\n\t\t\tconsole.warn( 'THREE.PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead.' );\n\n\t\t\tthis._setSizeFromTexture( cubemap );\n\n\t\t\tconst cubeUVRenderTarget = renderTarget || this._allocateTargets();\n\n\t\t\tthis.fromCubemapAsync( cubemap, renderTarget );\n\n\t\t\treturn cubeUVRenderTarget;\n\n\t\t}\n\n\t\treturn this._fromTexture( cubemap, renderTarget );\n\n\t}\n\n\tasync fromCubemapAsync( cubemap, renderTarget = null ) {\n\n\t\tif ( this._hasInitialized === false ) await this._renderer.init();\n\n\t\treturn this._fromTexture( cubemap, renderTarget );\n\n\t}\n\n\t/**\n\t * Pre-compiles the cubemap shader. You can get faster start-up by invoking this method during\n\t * your texture's network fetch for increased concurrency.\n\t */\n\tasync compileCubemapShader() {\n\n\t\tif ( this._cubemapMaterial === null ) {\n\n\t\t\tthis._cubemapMaterial = _getCubemapMaterial();\n\t\t\tawait this._compileMaterial( this._cubemapMaterial );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Pre-compiles the equirectangular shader. You can get faster start-up by invoking this method during\n\t * your texture's network fetch for increased concurrency.\n\t */\n\tasync compileEquirectangularShader() {\n\n\t\tif ( this._equirectMaterial === null ) {\n\n\t\t\tthis._equirectMaterial = _getEquirectMaterial();\n\t\t\tawait this._compileMaterial( this._equirectMaterial );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Disposes of the PMREMGenerator's internal memory. Note that PMREMGenerator is a static class,\n\t * so you should not need more than one PMREMGenerator object. If you do, calling dispose() on\n\t * one of them will cause any others to also become unusable.\n\t */\n\tdispose() {\n\n\t\tthis._dispose();\n\n\t\tif ( this._cubemapMaterial !== null ) this._cubemapMaterial.dispose();\n\t\tif ( this._equirectMaterial !== null ) this._equirectMaterial.dispose();\n\t\tif ( this._backgroundBox !== null ) {\n\n\t\t\tthis._backgroundBox.geometry.dispose();\n\t\t\tthis._backgroundBox.material.dispose();\n\n\t\t}\n\n\t}\n\n\t// private interface\n\n\t_setSizeFromTexture( texture ) {\n\n\t\tif ( texture.mapping === CubeReflectionMapping || texture.mapping === CubeRefractionMapping ) {\n\n\t\t\tthis._setSize( texture.image.length === 0 ? 16 : ( texture.image[ 0 ].width || texture.image[ 0 ].image.width ) );\n\n\t\t} else { // Equirectangular\n\n\t\t\tthis._setSize( texture.image.width / 4 );\n\n\t\t}\n\n\t}\n\n\t_setSize( cubeSize ) {\n\n\t\tthis._lodMax = Math.floor( Math.log2( cubeSize ) );\n\t\tthis._cubeSize = Math.pow( 2, this._lodMax );\n\n\t}\n\n\t_dispose() {\n\n\t\tif ( this._blurMaterial !== null ) this._blurMaterial.dispose();\n\n\t\tif ( this._pingPongRenderTarget !== null ) this._pingPongRenderTarget.dispose();\n\n\t\tfor ( let i = 0; i < this._lodPlanes.length; i ++ ) {\n\n\t\t\tthis._lodPlanes[ i ].dispose();\n\n\t\t}\n\n\t}\n\n\t_cleanup( outputTarget ) {\n\n\t\tthis._renderer.setRenderTarget( _oldTarget, _oldActiveCubeFace, _oldActiveMipmapLevel );\n\t\toutputTarget.scissorTest = false;\n\t\t_setViewport( outputTarget, 0, 0, outputTarget.width, outputTarget.height );\n\n\t}\n\n\t_fromTexture( texture, renderTarget ) {\n\n\t\tthis._setSizeFromTexture( texture );\n\n\t\t_oldTarget = this._renderer.getRenderTarget();\n\t\t_oldActiveCubeFace = this._renderer.getActiveCubeFace();\n\t\t_oldActiveMipmapLevel = this._renderer.getActiveMipmapLevel();\n\n\t\tconst cubeUVRenderTarget = renderTarget || this._allocateTargets();\n\t\tthis._textureToCubeUV( texture, cubeUVRenderTarget );\n\t\tthis._applyPMREM( cubeUVRenderTarget );\n\t\tthis._cleanup( cubeUVRenderTarget );\n\n\t\treturn cubeUVRenderTarget;\n\n\t}\n\n\t_allocateTargets() {\n\n\t\tconst width = 3 * Math.max( this._cubeSize, 16 * 7 );\n\t\tconst height = 4 * this._cubeSize;\n\n\t\tconst params = {\n\t\t\tmagFilter: LinearFilter,\n\t\t\tminFilter: LinearFilter,\n\t\t\tgenerateMipmaps: false,\n\t\t\ttype: HalfFloatType,\n\t\t\tformat: RGBAFormat,\n\t\t\tcolorSpace: LinearSRGBColorSpace,\n\t\t\t//depthBuffer: false\n\t\t};\n\n\t\tconst cubeUVRenderTarget = _createRenderTarget( width, height, params );\n\n\t\tif ( this._pingPongRenderTarget === null || this._pingPongRenderTarget.width !== width || this._pingPongRenderTarget.height !== height ) {\n\n\t\t\tif ( this._pingPongRenderTarget !== null ) {\n\n\t\t\t\tthis._dispose();\n\n\t\t\t}\n\n\t\t\tthis._pingPongRenderTarget = _createRenderTarget( width, height, params );\n\n\t\t\tconst { _lodMax } = this;\n\t\t\t( { sizeLods: this._sizeLods, lodPlanes: this._lodPlanes, sigmas: this._sigmas, lodMeshes: this._lodMeshes } = _createPlanes( _lodMax ) );\n\n\t\t\tthis._blurMaterial = _getBlurShader( _lodMax, width, height );\n\n\t\t}\n\n\t\treturn cubeUVRenderTarget;\n\n\t}\n\n\tasync _compileMaterial( material ) {\n\n\t\tconst tmpMesh = new Mesh( this._lodPlanes[ 0 ], material );\n\t\tawait this._renderer.compile( tmpMesh, _flatCamera );\n\n\t}\n\n\t_sceneToCubeUV( scene, near, far, cubeUVRenderTarget ) {\n\n\t\tconst cubeCamera = _cubeCamera;\n\t\tcubeCamera.near = near;\n\t\tcubeCamera.far = far;\n\n\t\t// px, py, pz, nx, ny, nz\n\t\tconst upSign = [ - 1, 1, - 1, - 1, - 1, - 1 ];\n\t\tconst forwardSign = [ 1, 1, 1, - 1, - 1, - 1 ];\n\n\t\tconst renderer = this._renderer;\n\n\t\tconst originalAutoClear = renderer.autoClear;\n\n\t\trenderer.getClearColor( _clearColor );\n\n\t\trenderer.autoClear = false;\n\n\t\tlet backgroundBox = this._backgroundBox;\n\n\t\tif ( backgroundBox === null ) {\n\n\t\t\tconst backgroundMaterial = new MeshBasicMaterial( {\n\t\t\t\tname: 'PMREM.Background',\n\t\t\t\tside: BackSide,\n\t\t\t\tdepthWrite: false,\n\t\t\t\tdepthTest: false\n\t\t\t} );\n\n\t\t\tbackgroundBox = new Mesh( new BoxGeometry(), backgroundMaterial );\n\n\t\t}\n\n\t\tlet useSolidColor = false;\n\t\tconst background = scene.background;\n\n\t\tif ( background ) {\n\n\t\t\tif ( background.isColor ) {\n\n\t\t\t\tbackgroundBox.material.color.copy( background );\n\t\t\t\tscene.background = null;\n\t\t\t\tuseSolidColor = true;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tbackgroundBox.material.color.copy( _clearColor );\n\t\t\tuseSolidColor = true;\n\n\t\t}\n\n\t\trenderer.setRenderTarget( cubeUVRenderTarget );\n\n\t\trenderer.clear();\n\n\t\tif ( useSolidColor ) {\n\n\t\t\trenderer.render( backgroundBox, cubeCamera );\n\n\t\t}\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst col = i % 3;\n\n\t\t\tif ( col === 0 ) {\n\n\t\t\t\tcubeCamera.up.set( 0, upSign[ i ], 0 );\n\t\t\t\tcubeCamera.lookAt( forwardSign[ i ], 0, 0 );\n\n\t\t\t} else if ( col === 1 ) {\n\n\t\t\t\tcubeCamera.up.set( 0, 0, upSign[ i ] );\n\t\t\t\tcubeCamera.lookAt( 0, forwardSign[ i ], 0 );\n\n\t\t\t} else {\n\n\t\t\t\tcubeCamera.up.set( 0, upSign[ i ], 0 );\n\t\t\t\tcubeCamera.lookAt( 0, 0, forwardSign[ i ] );\n\n\t\t\t}\n\n\t\t\tconst size = this._cubeSize;\n\n\t\t\t_setViewport( cubeUVRenderTarget, col * size, i > 2 ? size : 0, size, size );\n\n\t\t\trenderer.render( scene, cubeCamera );\n\n\t\t}\n\n\t\trenderer.autoClear = originalAutoClear;\n\t\tscene.background = background;\n\n\t}\n\n\t_textureToCubeUV( texture, cubeUVRenderTarget ) {\n\n\t\tconst renderer = this._renderer;\n\n\t\tconst isCubeTexture = ( texture.mapping === CubeReflectionMapping || texture.mapping === CubeRefractionMapping );\n\n\t\tif ( isCubeTexture ) {\n\n\t\t\tif ( this._cubemapMaterial === null ) {\n\n\t\t\t\tthis._cubemapMaterial = _getCubemapMaterial( texture );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( this._equirectMaterial === null ) {\n\n\t\t\t\tthis._equirectMaterial = _getEquirectMaterial( texture );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst material = isCubeTexture ? this._cubemapMaterial : this._equirectMaterial;\n\t\tmaterial.fragmentNode.value = texture;\n\n\t\tconst mesh = this._lodMeshes[ 0 ];\n\t\tmesh.material = material;\n\n\t\tconst size = this._cubeSize;\n\n\t\t_setViewport( cubeUVRenderTarget, 0, 0, 3 * size, 2 * size );\n\n\t\trenderer.setRenderTarget( cubeUVRenderTarget );\n\t\trenderer.render( mesh, _flatCamera );\n\n\t}\n\n\t_applyPMREM( cubeUVRenderTarget ) {\n\n\t\tconst renderer = this._renderer;\n\t\tconst autoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\t\tconst n = this._lodPlanes.length;\n\n\t\tfor ( let i = 1; i < n; i ++ ) {\n\n\t\t\tconst sigma = Math.sqrt( this._sigmas[ i ] * this._sigmas[ i ] - this._sigmas[ i - 1 ] * this._sigmas[ i - 1 ] );\n\n\t\t\tconst poleAxis = _axisDirections[ ( n - i - 1 ) % _axisDirections.length ];\n\n\t\t\tthis._blur( cubeUVRenderTarget, i - 1, i, sigma, poleAxis );\n\n\t\t}\n\n\t\trenderer.autoClear = autoClear;\n\n\t}\n\n\t/**\n\t * This is a two-pass Gaussian blur for a cubemap. Normally this is done\n\t * vertically and horizontally, but this breaks down on a cube. Here we apply\n\t * the blur latitudinally (around the poles), and then longitudinally (towards\n\t * the poles) to approximate the orthogonally-separable blur. It is least\n\t * accurate at the poles, but still does a decent job.\n\t */\n\t_blur( cubeUVRenderTarget, lodIn, lodOut, sigma, poleAxis ) {\n\n\t\tconst pingPongRenderTarget = this._pingPongRenderTarget;\n\n\t\tthis._halfBlur(\n\t\t\tcubeUVRenderTarget,\n\t\t\tpingPongRenderTarget,\n\t\t\tlodIn,\n\t\t\tlodOut,\n\t\t\tsigma,\n\t\t\t'latitudinal',\n\t\t\tpoleAxis );\n\n\t\tthis._halfBlur(\n\t\t\tpingPongRenderTarget,\n\t\t\tcubeUVRenderTarget,\n\t\t\tlodOut,\n\t\t\tlodOut,\n\t\t\tsigma,\n\t\t\t'longitudinal',\n\t\t\tpoleAxis );\n\n\t}\n\n\t_halfBlur( targetIn, targetOut, lodIn, lodOut, sigmaRadians, direction, poleAxis ) {\n\n\t\tconst renderer = this._renderer;\n\t\tconst blurMaterial = this._blurMaterial;\n\n\t\tif ( direction !== 'latitudinal' && direction !== 'longitudinal' ) {\n\n\t\t\tconsole.error( 'blur direction must be either latitudinal or longitudinal!' );\n\n\t\t}\n\n\t\t// Number of standard deviations at which to cut off the discrete approximation.\n\t\tconst STANDARD_DEVIATIONS = 3;\n\n\t\tconst blurMesh = this._lodMeshes[ lodOut ];\n\t\tblurMesh.material = blurMaterial;\n\n\t\tconst blurUniforms = blurMaterial.uniforms;\n\n\t\tconst pixels = this._sizeLods[ lodIn ] - 1;\n\t\tconst radiansPerPixel = isFinite( sigmaRadians ) ? Math.PI / ( 2 * pixels ) : 2 * Math.PI / ( 2 * MAX_SAMPLES - 1 );\n\t\tconst sigmaPixels = sigmaRadians / radiansPerPixel;\n\t\tconst samples = isFinite( sigmaRadians ) ? 1 + Math.floor( STANDARD_DEVIATIONS * sigmaPixels ) : MAX_SAMPLES;\n\n\t\tif ( samples > MAX_SAMPLES ) {\n\n\t\t\tconsole.warn( `sigmaRadians, ${\n\t\t\t\tsigmaRadians}, is too large and will clip, as it requested ${\n\t\t\t\tsamples} samples when the maximum is set to ${MAX_SAMPLES}` );\n\n\t\t}\n\n\t\tconst weights = [];\n\t\tlet sum = 0;\n\n\t\tfor ( let i = 0; i < MAX_SAMPLES; ++ i ) {\n\n\t\t\tconst x = i / sigmaPixels;\n\t\t\tconst weight = Math.exp( - x * x / 2 );\n\t\t\tweights.push( weight );\n\n\t\t\tif ( i === 0 ) {\n\n\t\t\t\tsum += weight;\n\n\t\t\t} else if ( i < samples ) {\n\n\t\t\t\tsum += 2 * weight;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( let i = 0; i < weights.length; i ++ ) {\n\n\t\t\tweights[ i ] = weights[ i ] / sum;\n\n\t\t}\n\n\t\ttargetIn.texture.frame = ( targetIn.texture.frame || 0 ) + 1;\n\n\t\tblurUniforms.envMap.value = targetIn.texture;\n\t\tblurUniforms.samples.value = samples;\n\t\tblurUniforms.weights.array = weights;\n\t\tblurUniforms.latitudinal.value = direction === 'latitudinal' ? 1 : 0;\n\n\t\tif ( poleAxis ) {\n\n\t\t\tblurUniforms.poleAxis.value = poleAxis;\n\n\t\t}\n\n\t\tconst { _lodMax } = this;\n\t\tblurUniforms.dTheta.value = radiansPerPixel;\n\t\tblurUniforms.mipInt.value = _lodMax - lodIn;\n\n\t\tconst outputSize = this._sizeLods[ lodOut ];\n\t\tconst x = 3 * outputSize * ( lodOut > _lodMax - LOD_MIN ? lodOut - _lodMax + LOD_MIN : 0 );\n\t\tconst y = 4 * ( this._cubeSize - outputSize );\n\n\t\t_setViewport( targetOut, x, y, 3 * outputSize, 2 * outputSize );\n\t\trenderer.setRenderTarget( targetOut );\n\t\trenderer.render( blurMesh, _flatCamera );\n\n\t}\n\n}\n\nfunction _createPlanes( lodMax ) {\n\n\tconst lodPlanes = [];\n\tconst sizeLods = [];\n\tconst sigmas = [];\n\tconst lodMeshes = [];\n\n\tlet lod = lodMax;\n\n\tconst totalLods = lodMax - LOD_MIN + 1 + EXTRA_LOD_SIGMA.length;\n\n\tfor ( let i = 0; i < totalLods; i ++ ) {\n\n\t\tconst sizeLod = Math.pow( 2, lod );\n\t\tsizeLods.push( sizeLod );\n\t\tlet sigma = 1.0 / sizeLod;\n\n\t\tif ( i > lodMax - LOD_MIN ) {\n\n\t\t\tsigma = EXTRA_LOD_SIGMA[ i - lodMax + LOD_MIN - 1 ];\n\n\t\t} else if ( i === 0 ) {\n\n\t\t\tsigma = 0;\n\n\t\t}\n\n\t\tsigmas.push( sigma );\n\n\t\tconst texelSize = 1.0 / ( sizeLod - 2 );\n\t\tconst min = - texelSize;\n\t\tconst max = 1 + texelSize;\n\t\tconst uv1 = [ min, min, max, min, max, max, min, min, max, max, min, max ];\n\n\t\tconst cubeFaces = 6;\n\t\tconst vertices = 6;\n\t\tconst positionSize = 3;\n\t\tconst uvSize = 2;\n\t\tconst faceIndexSize = 1;\n\n\t\tconst position = new Float32Array( positionSize * vertices * cubeFaces );\n\t\tconst uv = new Float32Array( uvSize * vertices * cubeFaces );\n\t\tconst faceIndex = new Float32Array( faceIndexSize * vertices * cubeFaces );\n\n\t\tfor ( let face = 0; face < cubeFaces; face ++ ) {\n\n\t\t\tconst x = ( face % 3 ) * 2 / 3 - 1;\n\t\t\tconst y = face > 2 ? 0 : - 1;\n\t\t\tconst coordinates = [\n\t\t\t\tx, y, 0,\n\t\t\t\tx + 2 / 3, y, 0,\n\t\t\t\tx + 2 / 3, y + 1, 0,\n\t\t\t\tx, y, 0,\n\t\t\t\tx + 2 / 3, y + 1, 0,\n\t\t\t\tx, y + 1, 0\n\t\t\t];\n\n\t\t\tconst faceIdx = _faceLib[ face ];\n\t\t\tposition.set( coordinates, positionSize * vertices * faceIdx );\n\t\t\tuv.set( uv1, uvSize * vertices * faceIdx );\n\t\t\tconst fill = [ faceIdx, faceIdx, faceIdx, faceIdx, faceIdx, faceIdx ];\n\t\t\tfaceIndex.set( fill, faceIndexSize * vertices * faceIdx );\n\n\t\t}\n\n\t\tconst planes = new BufferGeometry();\n\t\tplanes.setAttribute( 'position', new BufferAttribute( position, positionSize ) );\n\t\tplanes.setAttribute( 'uv', new BufferAttribute( uv, uvSize ) );\n\t\tplanes.setAttribute( 'faceIndex', new BufferAttribute( faceIndex, faceIndexSize ) );\n\t\tlodPlanes.push( planes );\n\t\tlodMeshes.push( new Mesh( planes, null ) );\n\n\t\tif ( lod > LOD_MIN ) {\n\n\t\t\tlod --;\n\n\t\t}\n\n\t}\n\n\treturn { lodPlanes, sizeLods, sigmas, lodMeshes };\n\n}\n\nfunction _createRenderTarget( width, height, params ) {\n\n\tconst cubeUVRenderTarget = new RenderTarget( width, height, params );\n\tcubeUVRenderTarget.texture.mapping = CubeUVReflectionMapping;\n\tcubeUVRenderTarget.texture.name = 'PMREM.cubeUv';\n\tcubeUVRenderTarget.texture.isPMREMTexture = true;\n\tcubeUVRenderTarget.scissorTest = true;\n\treturn cubeUVRenderTarget;\n\n}\n\nfunction _setViewport( target, x, y, width, height ) {\n\n\ttarget.viewport.set( x, y, width, height );\n\ttarget.scissor.set( x, y, width, height );\n\n}\n\nfunction _getMaterial( type ) {\n\n\tconst material = new NodeMaterial();\n\tmaterial.depthTest = false;\n\tmaterial.depthWrite = false;\n\tmaterial.blending = NoBlending;\n\tmaterial.name = `PMREM_${ type }`;\n\n\treturn material;\n\n}\n\nfunction _getBlurShader( lodMax, width, height ) {\n\n\tconst weights = uniformArray( new Array( MAX_SAMPLES ).fill( 0 ) );\n\tconst poleAxis = uniform( new Vector3( 0, 1, 0 ) );\n\tconst dTheta = uniform( 0 );\n\tconst n = float( MAX_SAMPLES );\n\tconst latitudinal = uniform( 0 ); // false, bool\n\tconst samples = uniform( 1 ); // int\n\tconst envMap = texture( null );\n\tconst mipInt = uniform( 0 ); // int\n\tconst CUBEUV_TEXEL_WIDTH = float( 1 / width );\n\tconst CUBEUV_TEXEL_HEIGHT = float( 1 / height );\n\tconst CUBEUV_MAX_MIP = float( lodMax );\n\n\tconst materialUniforms = {\n\t\tn,\n\t\tlatitudinal,\n\t\tweights,\n\t\tpoleAxis,\n\t\toutputDirection,\n\t\tdTheta,\n\t\tsamples,\n\t\tenvMap,\n\t\tmipInt,\n\t\tCUBEUV_TEXEL_WIDTH,\n\t\tCUBEUV_TEXEL_HEIGHT,\n\t\tCUBEUV_MAX_MIP\n\t};\n\n\tconst material = _getMaterial( 'blur' );\n\tmaterial.uniforms = materialUniforms; // TODO: Move to outside of the material\n\tmaterial.fragmentNode = blur( { ...materialUniforms, latitudinal: latitudinal.equal( 1 ) } );\n\n\treturn material;\n\n}\n\nfunction _getCubemapMaterial( envTexture ) {\n\n\tconst material = _getMaterial( 'cubemap' );\n\tmaterial.fragmentNode = cubeTexture( envTexture, outputDirection );\n\n\treturn material;\n\n}\n\nfunction _getEquirectMaterial( envTexture ) {\n\n\tconst material = _getMaterial( 'equirect' );\n\tmaterial.fragmentNode = texture( envTexture, equirectUV( outputDirection ), 0 );\n\n\treturn material;\n\n}\n\nconst rendererCache = new WeakMap();\n\nconst typeFromArray = new Map( [\n\t[ Int8Array, 'int' ],\n\t[ Int16Array, 'int' ],\n\t[ Int32Array, 'int' ],\n\t[ Uint8Array, 'uint' ],\n\t[ Uint16Array, 'uint' ],\n\t[ Uint32Array, 'uint' ],\n\t[ Float32Array, 'float' ]\n] );\n\nconst toFloat = ( value ) => {\n\n\tif ( /e/g.test( value ) ) {\n\n\t\treturn String( value ).replace( /\\+/g, '' );\n\n\t} else {\n\n\t\tvalue = Number( value );\n\n\t\treturn value + ( value % 1 ? '' : '.0' );\n\n\t}\n\n};\n\nclass NodeBuilder {\n\n\tconstructor( object, renderer, parser ) {\n\n\t\tthis.object = object;\n\t\tthis.material = ( object && object.material ) || null;\n\t\tthis.geometry = ( object && object.geometry ) || null;\n\t\tthis.renderer = renderer;\n\t\tthis.parser = parser;\n\t\tthis.scene = null;\n\t\tthis.camera = null;\n\n\t\tthis.nodes = [];\n\t\tthis.sequentialNodes = [];\n\t\tthis.updateNodes = [];\n\t\tthis.updateBeforeNodes = [];\n\t\tthis.updateAfterNodes = [];\n\t\tthis.hashNodes = {};\n\n\t\tthis.monitor = null;\n\n\t\tthis.lightsNode = null;\n\t\tthis.environmentNode = null;\n\t\tthis.fogNode = null;\n\n\t\tthis.clippingContext = null;\n\n\t\tthis.vertexShader = null;\n\t\tthis.fragmentShader = null;\n\t\tthis.computeShader = null;\n\n\t\tthis.flowNodes = { vertex: [], fragment: [], compute: [] };\n\t\tthis.flowCode = { vertex: '', fragment: '', compute: '' };\n\t\tthis.uniforms = { vertex: [], fragment: [], compute: [], index: 0 };\n\t\tthis.structs = { vertex: [], fragment: [], compute: [], index: 0 };\n\t\tthis.bindings = { vertex: {}, fragment: {}, compute: {} };\n\t\tthis.bindingsIndexes = {};\n\t\tthis.bindGroups = null;\n\t\tthis.attributes = [];\n\t\tthis.bufferAttributes = [];\n\t\tthis.varyings = [];\n\t\tthis.codes = {};\n\t\tthis.vars = {};\n\t\tthis.flow = { code: '' };\n\t\tthis.chaining = [];\n\t\tthis.stack = stack();\n\t\tthis.stacks = [];\n\t\tthis.tab = '\\t';\n\n\t\tthis.currentFunctionNode = null;\n\n\t\tthis.context = {\n\t\t\tmaterial: this.material\n\t\t};\n\n\t\tthis.cache = new NodeCache();\n\t\tthis.globalCache = this.cache;\n\n\t\tthis.flowsData = new WeakMap();\n\n\t\tthis.shaderStage = null;\n\t\tthis.buildStage = null;\n\n\t\tthis.useComparisonMethod = false;\n\n\t}\n\n\tgetBindGroupsCache() {\n\n\t\tlet bindGroupsCache = rendererCache.get( this.renderer );\n\n\t\tif ( bindGroupsCache === undefined ) {\n\n\t\t\tbindGroupsCache = new ChainMap();\n\n\t\t\trendererCache.set( this.renderer, bindGroupsCache );\n\n\t\t}\n\n\t\treturn bindGroupsCache;\n\n\t}\n\n\tcreateRenderTarget( width, height, options ) {\n\n\t\treturn new RenderTarget( width, height, options );\n\n\t}\n\n\tcreateCubeRenderTarget( size, options ) {\n\n\t\treturn new CubeRenderTarget( size, options );\n\n\t}\n\n\tcreatePMREMGenerator() {\n\n\t\t// TODO: Move Materials.js to outside of the Nodes.js in order to remove this function and improve tree-shaking support\n\n\t\treturn new PMREMGenerator( this.renderer );\n\n\t}\n\n\tincludes( node ) {\n\n\t\treturn this.nodes.includes( node );\n\n\t}\n\n\t_getBindGroup( groupName, bindings ) {\n\n\t\tconst bindGroupsCache = this.getBindGroupsCache();\n\n\t\t//\n\n\t\tconst bindingsArray = [];\n\n\t\tlet sharedGroup = true;\n\n\t\tfor ( const binding of bindings ) {\n\n\t\t\tbindingsArray.push( binding );\n\n\t\t\tsharedGroup = sharedGroup && binding.groupNode.shared !== true;\n\n\t\t}\n\n\t\t//\n\n\t\tlet bindGroup;\n\n\t\tif ( sharedGroup ) {\n\n\t\t\tbindGroup = bindGroupsCache.get( bindingsArray );\n\n\t\t\tif ( bindGroup === undefined ) {\n\n\t\t\t\tbindGroup = new BindGroup( groupName, bindingsArray, this.bindingsIndexes[ groupName ].group, bindingsArray );\n\n\t\t\t\tbindGroupsCache.set( bindingsArray, bindGroup );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tbindGroup = new BindGroup( groupName, bindingsArray, this.bindingsIndexes[ groupName ].group, bindingsArray );\n\n\t\t}\n\n\t\treturn bindGroup;\n\n\t}\n\n\tgetBindGroupArray( groupName, shaderStage ) {\n\n\t\tconst bindings = this.bindings[ shaderStage ];\n\n\t\tlet bindGroup = bindings[ groupName ];\n\n\t\tif ( bindGroup === undefined ) {\n\n\t\t\tif ( this.bindingsIndexes[ groupName ] === undefined ) {\n\n\t\t\t\tthis.bindingsIndexes[ groupName ] = { binding: 0, group: Object.keys( this.bindingsIndexes ).length };\n\n\t\t\t}\n\n\t\t\tbindings[ groupName ] = bindGroup = [];\n\n\t\t}\n\n\t\treturn bindGroup;\n\n\t}\n\n\tgetBindings() {\n\n\t\tlet bindingsGroups = this.bindGroups;\n\n\t\tif ( bindingsGroups === null ) {\n\n\t\t\tconst groups = {};\n\t\t\tconst bindings = this.bindings;\n\n\t\t\tfor ( const shaderStage of shaderStages ) {\n\n\t\t\t\tfor ( const groupName in bindings[ shaderStage ] ) {\n\n\t\t\t\t\tconst uniforms = bindings[ shaderStage ][ groupName ];\n\n\t\t\t\t\tconst groupUniforms = groups[ groupName ] || ( groups[ groupName ] = [] );\n\t\t\t\t\tgroupUniforms.push( ...uniforms );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tbindingsGroups = [];\n\n\t\t\tfor ( const groupName in groups ) {\n\n\t\t\t\tconst group = groups[ groupName ];\n\n\t\t\t\tconst bindingsGroup = this._getBindGroup( groupName, group );\n\n\t\t\t\tbindingsGroups.push( bindingsGroup );\n\n\t\t\t}\n\n\t\t\tthis.bindGroups = bindingsGroups;\n\n\t\t}\n\n\t\treturn bindingsGroups;\n\n\t}\n\n\tsortBindingGroups() {\n\n\t\tconst bindingsGroups = this.getBindings();\n\n\t\tbindingsGroups.sort( ( a, b ) => ( a.bindings[ 0 ].groupNode.order - b.bindings[ 0 ].groupNode.order ) );\n\n\t\tfor ( let i = 0; i < bindingsGroups.length; i ++ ) {\n\n\t\t\tconst bindingGroup = bindingsGroups[ i ];\n\t\t\tthis.bindingsIndexes[ bindingGroup.name ].group = i;\n\n\t\t\tbindingGroup.index = i;\n\n\t\t}\n\n\t}\n\n\tsetHashNode( node, hash ) {\n\n\t\tthis.hashNodes[ hash ] = node;\n\n\t}\n\n\taddNode( node ) {\n\n\t\tif ( this.nodes.includes( node ) === false ) {\n\n\t\t\tthis.nodes.push( node );\n\n\t\t\tthis.setHashNode( node, node.getHash( this ) );\n\n\t\t}\n\n\t}\n\n\taddSequentialNode( node ) {\n\n\t\tif ( this.sequentialNodes.includes( node ) === false ) {\n\n\t\t\tthis.sequentialNodes.push( node );\n\n\t\t}\n\n\t}\n\n\tbuildUpdateNodes() {\n\n\t\tfor ( const node of this.nodes ) {\n\n\t\t\tconst updateType = node.getUpdateType();\n\n\t\t\tif ( updateType !== NodeUpdateType.NONE ) {\n\n\t\t\t\tthis.updateNodes.push( node.getSelf() );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( const node of this.sequentialNodes ) {\n\n\t\t\tconst updateBeforeType = node.getUpdateBeforeType();\n\t\t\tconst updateAfterType = node.getUpdateAfterType();\n\n\t\t\tif ( updateBeforeType !== NodeUpdateType.NONE ) {\n\n\t\t\t\tthis.updateBeforeNodes.push( node.getSelf() );\n\n\t\t\t}\n\n\t\t\tif ( updateAfterType !== NodeUpdateType.NONE ) {\n\n\t\t\t\tthis.updateAfterNodes.push( node.getSelf() );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tget currentNode() {\n\n\t\treturn this.chaining[ this.chaining.length - 1 ];\n\n\t}\n\n\tisFilteredTexture( texture ) {\n\n\t\treturn ( texture.magFilter === LinearFilter || texture.magFilter === LinearMipmapNearestFilter || texture.magFilter === NearestMipmapLinearFilter || texture.magFilter === LinearMipmapLinearFilter ||\n\t\t\ttexture.minFilter === LinearFilter || texture.minFilter === LinearMipmapNearestFilter || texture.minFilter === NearestMipmapLinearFilter || texture.minFilter === LinearMipmapLinearFilter );\n\n\t}\n\n\taddChain( node ) {\n\n\t\t/*\n\t\tif ( this.chaining.indexOf( node ) !== - 1 ) {\n\n\t\t\tconsole.warn( 'Recursive node: ', node );\n\n\t\t}\n\t\t*/\n\n\t\tthis.chaining.push( node );\n\n\t}\n\n\tremoveChain( node ) {\n\n\t\tconst lastChain = this.chaining.pop();\n\n\t\tif ( lastChain !== node ) {\n\n\t\t\tthrow new Error( 'NodeBuilder: Invalid node chaining!' );\n\n\t\t}\n\n\t}\n\n\tgetMethod( method ) {\n\n\t\treturn method;\n\n\t}\n\n\tgetNodeFromHash( hash ) {\n\n\t\treturn this.hashNodes[ hash ];\n\n\t}\n\n\taddFlow( shaderStage, node ) {\n\n\t\tthis.flowNodes[ shaderStage ].push( node );\n\n\t\treturn node;\n\n\t}\n\n\tsetContext( context ) {\n\n\t\tthis.context = context;\n\n\t}\n\n\tgetContext() {\n\n\t\treturn this.context;\n\n\t}\n\n\tgetSharedContext() {\n\n\t\t({ ...this.context });\n\n\t\treturn this.context;\n\n\t}\n\n\tsetCache( cache ) {\n\n\t\tthis.cache = cache;\n\n\t}\n\n\tgetCache() {\n\n\t\treturn this.cache;\n\n\t}\n\n\tgetCacheFromNode( node, parent = true ) {\n\n\t\tconst data = this.getDataFromNode( node );\n\t\tif ( data.cache === undefined ) data.cache = new NodeCache( parent ? this.getCache() : null );\n\n\t\treturn data.cache;\n\n\t}\n\n\tisAvailable( /*name*/ ) {\n\n\t\treturn false;\n\n\t}\n\n\tgetVertexIndex() {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgetInstanceIndex() {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgetDrawIndex() {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgetFrontFacing() {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgetFragCoord() {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tisFlipY() {\n\n\t\treturn false;\n\n\t}\n\n\tincreaseUsage( node ) {\n\n\t\tconst nodeData = this.getDataFromNode( node );\n\t\tnodeData.usageCount = nodeData.usageCount === undefined ? 1 : nodeData.usageCount + 1;\n\n\t\treturn nodeData.usageCount;\n\n\t}\n\n\tgenerateTexture( /* texture, textureProperty, uvSnippet */ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgenerateTextureLod( /* texture, textureProperty, uvSnippet, levelSnippet */ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgenerateConst( type, value = null ) {\n\n\t\tif ( value === null ) {\n\n\t\t\tif ( type === 'float' || type === 'int' || type === 'uint' ) value = 0;\n\t\t\telse if ( type === 'bool' ) value = false;\n\t\t\telse if ( type === 'color' ) value = new Color();\n\t\t\telse if ( type === 'vec2' ) value = new Vector2();\n\t\t\telse if ( type === 'vec3' ) value = new Vector3();\n\t\t\telse if ( type === 'vec4' ) value = new Vector4();\n\n\t\t}\n\n\t\tif ( type === 'float' ) return toFloat( value );\n\t\tif ( type === 'int' ) return `${ Math.round( value ) }`;\n\t\tif ( type === 'uint' ) return value >= 0 ? `${ Math.round( value ) }u` : '0u';\n\t\tif ( type === 'bool' ) return value ? 'true' : 'false';\n\t\tif ( type === 'color' ) return `${ this.getType( 'vec3' ) }( ${ toFloat( value.r ) }, ${ toFloat( value.g ) }, ${ toFloat( value.b ) } )`;\n\n\t\tconst typeLength = this.getTypeLength( type );\n\n\t\tconst componentType = this.getComponentType( type );\n\n\t\tconst generateConst = value => this.generateConst( componentType, value );\n\n\t\tif ( typeLength === 2 ) {\n\n\t\t\treturn `${ this.getType( type ) }( ${ generateConst( value.x ) }, ${ generateConst( value.y ) } )`;\n\n\t\t} else if ( typeLength === 3 ) {\n\n\t\t\treturn `${ this.getType( type ) }( ${ generateConst( value.x ) }, ${ generateConst( value.y ) }, ${ generateConst( value.z ) } )`;\n\n\t\t} else if ( typeLength === 4 ) {\n\n\t\t\treturn `${ this.getType( type ) }( ${ generateConst( value.x ) }, ${ generateConst( value.y ) }, ${ generateConst( value.z ) }, ${ generateConst( value.w ) } )`;\n\n\t\t} else if ( typeLength > 4 && value && ( value.isMatrix3 || value.isMatrix4 ) ) {\n\n\t\t\treturn `${ this.getType( type ) }( ${ value.elements.map( generateConst ).join( ', ' ) } )`;\n\n\t\t} else if ( typeLength > 4 ) {\n\n\t\t\treturn `${ this.getType( type ) }()`;\n\n\t\t}\n\n\t\tthrow new Error( `NodeBuilder: Type '${type}' not found in generate constant attempt.` );\n\n\t}\n\n\tgetType( type ) {\n\n\t\tif ( type === 'color' ) return 'vec3';\n\n\t\treturn type;\n\n\t}\n\n\thasGeometryAttribute( name ) {\n\n\t\treturn this.geometry && this.geometry.getAttribute( name ) !== undefined;\n\n\t}\n\n\tgetAttribute( name, type ) {\n\n\t\tconst attributes = this.attributes;\n\n\t\t// find attribute\n\n\t\tfor ( const attribute of attributes ) {\n\n\t\t\tif ( attribute.name === name ) {\n\n\t\t\t\treturn attribute;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// create a new if no exist\n\n\t\tconst attribute = new NodeAttribute( name, type );\n\n\t\tattributes.push( attribute );\n\n\t\treturn attribute;\n\n\t}\n\n\tgetPropertyName( node/*, shaderStage*/ ) {\n\n\t\treturn node.name;\n\n\t}\n\n\tisVector( type ) {\n\n\t\treturn /vec\\d/.test( type );\n\n\t}\n\n\tisMatrix( type ) {\n\n\t\treturn /mat\\d/.test( type );\n\n\t}\n\n\tisReference( type ) {\n\n\t\treturn type === 'void' || type === 'property' || type === 'sampler' || type === 'texture' || type === 'cubeTexture' || type === 'storageTexture' || type === 'depthTexture' || type === 'texture3D';\n\n\t}\n\n\tneedsToWorkingColorSpace( /*texture*/ ) {\n\n\t\treturn false;\n\n\t}\n\n\tgetComponentTypeFromTexture( texture ) {\n\n\t\tconst type = texture.type;\n\n\t\tif ( texture.isDataTexture ) {\n\n\t\t\tif ( type === IntType ) return 'int';\n\t\t\tif ( type === UnsignedIntType ) return 'uint';\n\n\t\t}\n\n\t\treturn 'float';\n\n\t}\n\n\tgetElementType( type ) {\n\n\t\tif ( type === 'mat2' ) return 'vec2';\n\t\tif ( type === 'mat3' ) return 'vec3';\n\t\tif ( type === 'mat4' ) return 'vec4';\n\n\t\treturn this.getComponentType( type );\n\n\t}\n\n\tgetComponentType( type ) {\n\n\t\ttype = this.getVectorType( type );\n\n\t\tif ( type === 'float' || type === 'bool' || type === 'int' || type === 'uint' ) return type;\n\n\t\tconst componentType = /(b|i|u|)(vec|mat)([2-4])/.exec( type );\n\n\t\tif ( componentType === null ) return null;\n\n\t\tif ( componentType[ 1 ] === 'b' ) return 'bool';\n\t\tif ( componentType[ 1 ] === 'i' ) return 'int';\n\t\tif ( componentType[ 1 ] === 'u' ) return 'uint';\n\n\t\treturn 'float';\n\n\t}\n\n\tgetVectorType( type ) {\n\n\t\tif ( type === 'color' ) return 'vec3';\n\t\tif ( type === 'texture' || type === 'cubeTexture' || type === 'storageTexture' || type === 'texture3D' ) return 'vec4';\n\n\t\treturn type;\n\n\t}\n\n\tgetTypeFromLength( length, componentType = 'float' ) {\n\n\t\tif ( length === 1 ) return componentType;\n\n\t\tconst baseType = getTypeFromLength( length );\n\t\tconst prefix = componentType === 'float' ? '' : componentType[ 0 ];\n\n\t\treturn prefix + baseType;\n\n\t}\n\n\tgetTypeFromArray( array ) {\n\n\t\treturn typeFromArray.get( array.constructor );\n\n\t}\n\n\tgetTypeFromAttribute( attribute ) {\n\n\t\tlet dataAttribute = attribute;\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) dataAttribute = attribute.data;\n\n\t\tconst array = dataAttribute.array;\n\t\tconst itemSize = attribute.itemSize;\n\t\tconst normalized = attribute.normalized;\n\n\t\tlet arrayType;\n\n\t\tif ( ! ( attribute instanceof Float16BufferAttribute ) && normalized !== true ) {\n\n\t\t\tarrayType = this.getTypeFromArray( array );\n\n\t\t}\n\n\t\treturn this.getTypeFromLength( itemSize, arrayType );\n\n\t}\n\n\tgetTypeLength( type ) {\n\n\t\tconst vecType = this.getVectorType( type );\n\t\tconst vecNum = /vec([2-4])/.exec( vecType );\n\n\t\tif ( vecNum !== null ) return Number( vecNum[ 1 ] );\n\t\tif ( vecType === 'float' || vecType === 'bool' || vecType === 'int' || vecType === 'uint' ) return 1;\n\t\tif ( /mat2/.test( type ) === true ) return 4;\n\t\tif ( /mat3/.test( type ) === true ) return 9;\n\t\tif ( /mat4/.test( type ) === true ) return 16;\n\n\t\treturn 0;\n\n\t}\n\n\tgetVectorFromMatrix( type ) {\n\n\t\treturn type.replace( 'mat', 'vec' );\n\n\t}\n\n\tchangeComponentType( type, newComponentType ) {\n\n\t\treturn this.getTypeFromLength( this.getTypeLength( type ), newComponentType );\n\n\t}\n\n\tgetIntegerType( type ) {\n\n\t\tconst componentType = this.getComponentType( type );\n\n\t\tif ( componentType === 'int' || componentType === 'uint' ) return type;\n\n\t\treturn this.changeComponentType( type, 'int' );\n\n\t}\n\n\taddStack() {\n\n\t\tthis.stack = stack( this.stack );\n\n\t\tthis.stacks.push( getCurrentStack() || this.stack );\n\t\tsetCurrentStack( this.stack );\n\n\t\treturn this.stack;\n\n\t}\n\n\tremoveStack() {\n\n\t\tconst lastStack = this.stack;\n\t\tthis.stack = lastStack.parent;\n\n\t\tsetCurrentStack( this.stacks.pop() );\n\n\t\treturn lastStack;\n\n\t}\n\n\tgetDataFromNode( node, shaderStage = this.shaderStage, cache = null ) {\n\n\t\tcache = cache === null ? ( node.isGlobal( this ) ? this.globalCache : this.cache ) : cache;\n\n\t\tlet nodeData = cache.getData( node );\n\n\t\tif ( nodeData === undefined ) {\n\n\t\t\tnodeData = {};\n\n\t\t\tcache.setData( node, nodeData );\n\n\t\t}\n\n\t\tif ( nodeData[ shaderStage ] === undefined ) nodeData[ shaderStage ] = {};\n\n\t\treturn nodeData[ shaderStage ];\n\n\t}\n\n\tgetNodeProperties( node, shaderStage = 'any' ) {\n\n\t\tconst nodeData = this.getDataFromNode( node, shaderStage );\n\n\t\treturn nodeData.properties || ( nodeData.properties = { outputNode: null } );\n\n\t}\n\n\tgetBufferAttributeFromNode( node, type ) {\n\n\t\tconst nodeData = this.getDataFromNode( node );\n\n\t\tlet bufferAttribute = nodeData.bufferAttribute;\n\n\t\tif ( bufferAttribute === undefined ) {\n\n\t\t\tconst index = this.uniforms.index ++;\n\n\t\t\tbufferAttribute = new NodeAttribute( 'nodeAttribute' + index, type, node );\n\n\t\t\tthis.bufferAttributes.push( bufferAttribute );\n\n\t\t\tnodeData.bufferAttribute = bufferAttribute;\n\n\t\t}\n\n\t\treturn bufferAttribute;\n\n\t}\n\n\tgetStructTypeFromNode( node, shaderStage = this.shaderStage ) {\n\n\t\tconst nodeData = this.getDataFromNode( node, shaderStage );\n\n\t\tif ( nodeData.structType === undefined ) {\n\n\t\t\tconst index = this.structs.index ++;\n\n\t\t\tnode.name = `StructType${ index }`;\n\t\t\tthis.structs[ shaderStage ].push( node );\n\n\t\t\tnodeData.structType = node;\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n\tgetUniformFromNode( node, type, shaderStage = this.shaderStage, name = null ) {\n\n\t\tconst nodeData = this.getDataFromNode( node, shaderStage, this.globalCache );\n\n\t\tlet nodeUniform = nodeData.uniform;\n\n\t\tif ( nodeUniform === undefined ) {\n\n\t\t\tconst index = this.uniforms.index ++;\n\n\t\t\tnodeUniform = new NodeUniform( name || ( 'nodeUniform' + index ), type, node );\n\n\t\t\tthis.uniforms[ shaderStage ].push( nodeUniform );\n\n\t\t\tnodeData.uniform = nodeUniform;\n\n\t\t}\n\n\t\treturn nodeUniform;\n\n\t}\n\n\tgetVarFromNode( node, name = null, type = node.getNodeType( this ), shaderStage = this.shaderStage ) {\n\n\t\tconst nodeData = this.getDataFromNode( node, shaderStage );\n\n\t\tlet nodeVar = nodeData.variable;\n\n\t\tif ( nodeVar === undefined ) {\n\n\t\t\tconst vars = this.vars[ shaderStage ] || ( this.vars[ shaderStage ] = [] );\n\n\t\t\tif ( name === null ) name = 'nodeVar' + vars.length;\n\n\t\t\tnodeVar = new NodeVar( name, type );\n\n\t\t\tvars.push( nodeVar );\n\n\t\t\tnodeData.variable = nodeVar;\n\n\t\t}\n\n\t\treturn nodeVar;\n\n\t}\n\n\tgetVaryingFromNode( node, name = null, type = node.getNodeType( this ) ) {\n\n\t\tconst nodeData = this.getDataFromNode( node, 'any' );\n\n\t\tlet nodeVarying = nodeData.varying;\n\n\t\tif ( nodeVarying === undefined ) {\n\n\t\t\tconst varyings = this.varyings;\n\t\t\tconst index = varyings.length;\n\n\t\t\tif ( name === null ) name = 'nodeVarying' + index;\n\n\t\t\tnodeVarying = new NodeVarying( name, type );\n\n\t\t\tvaryings.push( nodeVarying );\n\n\t\t\tnodeData.varying = nodeVarying;\n\n\t\t}\n\n\t\treturn nodeVarying;\n\n\t}\n\n\tgetCodeFromNode( node, type, shaderStage = this.shaderStage ) {\n\n\t\tconst nodeData = this.getDataFromNode( node );\n\n\t\tlet nodeCode = nodeData.code;\n\n\t\tif ( nodeCode === undefined ) {\n\n\t\t\tconst codes = this.codes[ shaderStage ] || ( this.codes[ shaderStage ] = [] );\n\t\t\tconst index = codes.length;\n\n\t\t\tnodeCode = new NodeCode( 'nodeCode' + index, type );\n\n\t\t\tcodes.push( nodeCode );\n\n\t\t\tnodeData.code = nodeCode;\n\n\t\t}\n\n\t\treturn nodeCode;\n\n\t}\n\n\taddFlowCodeHierarchy( node, nodeBlock ) {\n\n\t\tconst { flowCodes, flowCodeBlock } = this.getDataFromNode( node );\n\n\t\tlet needsFlowCode = true;\n\t\tlet nodeBlockHierarchy = nodeBlock;\n\n\t\twhile ( nodeBlockHierarchy ) {\n\n\t\t\tif ( flowCodeBlock.get( nodeBlockHierarchy ) === true ) {\n\n\t\t\t\tneedsFlowCode = false;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tnodeBlockHierarchy = this.getDataFromNode( nodeBlockHierarchy ).parentNodeBlock;\n\n\t\t}\n\n\t\tif ( needsFlowCode ) {\n\n\t\t\tfor ( const flowCode of flowCodes ) {\n\n\t\t\t\tthis.addLineFlowCode( flowCode );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\taddLineFlowCodeBlock( node, code, nodeBlock ) {\n\n\t\tconst nodeData = this.getDataFromNode( node );\n\t\tconst flowCodes = nodeData.flowCodes || ( nodeData.flowCodes = [] );\n\t\tconst codeBlock = nodeData.flowCodeBlock || ( nodeData.flowCodeBlock = new WeakMap() );\n\n\t\tflowCodes.push( code );\n\t\tcodeBlock.set( nodeBlock, true );\n\n\t}\n\n\taddLineFlowCode( code, node = null ) {\n\n\t\tif ( code === '' ) return this;\n\n\t\tif ( node !== null && this.context.nodeBlock ) {\n\n\t\t\tthis.addLineFlowCodeBlock( node, code, this.context.nodeBlock );\n\n\t\t}\n\n\t\tcode = this.tab + code;\n\n\t\tif ( ! /;\\s*$/.test( code ) ) {\n\n\t\t\tcode = code + ';\\n';\n\n\t\t}\n\n\t\tthis.flow.code += code;\n\n\t\treturn this;\n\n\t}\n\n\taddFlowCode( code ) {\n\n\t\tthis.flow.code += code;\n\n\t\treturn this;\n\n\t}\n\n\taddFlowTab() {\n\n\t\tthis.tab += '\\t';\n\n\t\treturn this;\n\n\t}\n\n\tremoveFlowTab() {\n\n\t\tthis.tab = this.tab.slice( 0, - 1 );\n\n\t\treturn this;\n\n\t}\n\n\tgetFlowData( node/*, shaderStage*/ ) {\n\n\t\treturn this.flowsData.get( node );\n\n\t}\n\n\tflowNode( node ) {\n\n\t\tconst output = node.getNodeType( this );\n\n\t\tconst flowData = this.flowChildNode( node, output );\n\n\t\tthis.flowsData.set( node, flowData );\n\n\t\treturn flowData;\n\n\t}\n\n\tbuildFunctionNode( shaderNode ) {\n\n\t\tconst fn = new FunctionNode();\n\n\t\tconst previous = this.currentFunctionNode;\n\n\t\tthis.currentFunctionNode = fn;\n\n\t\tfn.code = this.buildFunctionCode( shaderNode );\n\n\t\tthis.currentFunctionNode = previous;\n\n\t\treturn fn;\n\n\t}\n\n\tflowShaderNode( shaderNode ) {\n\n\t\tconst layout = shaderNode.layout;\n\n\t\tconst inputs = {\n\t\t\t[ Symbol.iterator ]() {\n\n\t\t\t\tlet index = 0;\n\t\t\t\tconst values = Object.values( this );\n\t\t\t\treturn {\n\t\t\t\t\tnext: () => ( {\n\t\t\t\t\t\tvalue: values[ index ],\n\t\t\t\t\t\tdone: index ++ >= values.length\n\t\t\t\t\t} )\n\t\t\t\t};\n\n\t\t\t}\n\t\t};\n\n\t\tfor ( const input of layout.inputs ) {\n\n\t\t\tinputs[ input.name ] = new ParameterNode( input.type, input.name );\n\n\t\t}\n\n\t\t//\n\n\t\tshaderNode.layout = null;\n\n\t\tconst callNode = shaderNode.call( inputs );\n\t\tconst flowData = this.flowStagesNode( callNode, layout.type );\n\n\t\tshaderNode.layout = layout;\n\n\t\treturn flowData;\n\n\t}\n\n\tflowStagesNode( node, output = null ) {\n\n\t\tconst previousFlow = this.flow;\n\t\tconst previousVars = this.vars;\n\t\tconst previousCache = this.cache;\n\t\tconst previousBuildStage = this.buildStage;\n\t\tconst previousStack = this.stack;\n\n\t\tconst flow = {\n\t\t\tcode: ''\n\t\t};\n\n\t\tthis.flow = flow;\n\t\tthis.vars = {};\n\t\tthis.cache = new NodeCache();\n\t\tthis.stack = stack();\n\n\t\tfor ( const buildStage of defaultBuildStages ) {\n\n\t\t\tthis.setBuildStage( buildStage );\n\n\t\t\tflow.result = node.build( this, output );\n\n\t\t}\n\n\t\tflow.vars = this.getVars( this.shaderStage );\n\n\t\tthis.flow = previousFlow;\n\t\tthis.vars = previousVars;\n\t\tthis.cache = previousCache;\n\t\tthis.stack = previousStack;\n\n\t\tthis.setBuildStage( previousBuildStage );\n\n\t\treturn flow;\n\n\t}\n\n\tgetFunctionOperator() {\n\n\t\treturn null;\n\n\t}\n\n\tflowChildNode( node, output = null ) {\n\n\t\tconst previousFlow = this.flow;\n\n\t\tconst flow = {\n\t\t\tcode: ''\n\t\t};\n\n\t\tthis.flow = flow;\n\n\t\tflow.result = node.build( this, output );\n\n\t\tthis.flow = previousFlow;\n\n\t\treturn flow;\n\n\t}\n\n\tflowNodeFromShaderStage( shaderStage, node, output = null, propertyName = null ) {\n\n\t\tconst previousShaderStage = this.shaderStage;\n\n\t\tthis.setShaderStage( shaderStage );\n\n\t\tconst flowData = this.flowChildNode( node, output );\n\n\t\tif ( propertyName !== null ) {\n\n\t\t\tflowData.code += `${ this.tab + propertyName } = ${ flowData.result };\\n`;\n\n\t\t}\n\n\t\tthis.flowCode[ shaderStage ] = this.flowCode[ shaderStage ] + flowData.code;\n\n\t\tthis.setShaderStage( previousShaderStage );\n\n\t\treturn flowData;\n\n\t}\n\n\tgetAttributesArray() {\n\n\t\treturn this.attributes.concat( this.bufferAttributes );\n\n\t}\n\n\tgetAttributes( /*shaderStage*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgetVaryings( /*shaderStage*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgetVar( type, name ) {\n\n\t\treturn `${ this.getType( type ) } ${ name }`;\n\n\t}\n\n\tgetVars( shaderStage ) {\n\n\t\tlet snippet = '';\n\n\t\tconst vars = this.vars[ shaderStage ];\n\n\t\tif ( vars !== undefined ) {\n\n\t\t\tfor ( const variable of vars ) {\n\n\t\t\t\tsnippet += `${ this.getVar( variable.type, variable.name ) }; `;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tgetUniforms( /*shaderStage*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgetCodes( shaderStage ) {\n\n\t\tconst codes = this.codes[ shaderStage ];\n\n\t\tlet code = '';\n\n\t\tif ( codes !== undefined ) {\n\n\t\t\tfor ( const nodeCode of codes ) {\n\n\t\t\t\tcode += nodeCode.code + '\\n';\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn code;\n\n\t}\n\n\tgetHash() {\n\n\t\treturn this.vertexShader + this.fragmentShader + this.computeShader;\n\n\t}\n\n\tsetShaderStage( shaderStage ) {\n\n\t\tthis.shaderStage = shaderStage;\n\n\t}\n\n\tgetShaderStage() {\n\n\t\treturn this.shaderStage;\n\n\t}\n\n\tsetBuildStage( buildStage ) {\n\n\t\tthis.buildStage = buildStage;\n\n\t}\n\n\tgetBuildStage() {\n\n\t\treturn this.buildStage;\n\n\t}\n\n\tbuildCode() {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tbuild() {\n\n\t\tconst { object, material, renderer } = this;\n\n\t\tif ( material !== null ) {\n\n\t\t\tlet nodeMaterial = renderer.library.fromMaterial( material );\n\n\t\t\tif ( nodeMaterial === null ) {\n\n\t\t\t\tconsole.error( `NodeMaterial: Material \"${ material.type }\" is not compatible.` );\n\n\t\t\t\tnodeMaterial = new NodeMaterial();\n\n\t\t\t}\n\n\t\t\tnodeMaterial.build( this );\n\n\t\t} else {\n\n\t\t\tthis.addFlow( 'compute', object );\n\n\t\t}\n\n\t\t// setup() -> stage 1: create possible new nodes and returns an output reference node\n\t\t// analyze()   -> stage 2: analyze nodes to possible optimization and validation\n\t\t// generate()  -> stage 3: generate shader\n\n\t\tfor ( const buildStage of defaultBuildStages ) {\n\n\t\t\tthis.setBuildStage( buildStage );\n\n\t\t\tif ( this.context.vertex && this.context.vertex.isNode ) {\n\n\t\t\t\tthis.flowNodeFromShaderStage( 'vertex', this.context.vertex );\n\n\t\t\t}\n\n\t\t\tfor ( const shaderStage of shaderStages ) {\n\n\t\t\t\tthis.setShaderStage( shaderStage );\n\n\t\t\t\tconst flowNodes = this.flowNodes[ shaderStage ];\n\n\t\t\t\tfor ( const node of flowNodes ) {\n\n\t\t\t\t\tif ( buildStage === 'generate' ) {\n\n\t\t\t\t\t\tthis.flowNode( node );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tnode.build( this );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setBuildStage( null );\n\t\tthis.setShaderStage( null );\n\n\t\t// stage 4: build code for a specific output\n\n\t\tthis.buildCode();\n\t\tthis.buildUpdateNodes();\n\n\t\treturn this;\n\n\t}\n\n\tgetNodeUniform( uniformNode, type ) {\n\n\t\tif ( type === 'float' || type === 'int' || type === 'uint' ) return new NumberNodeUniform( uniformNode );\n\t\tif ( type === 'vec2' || type === 'ivec2' || type === 'uvec2' ) return new Vector2NodeUniform( uniformNode );\n\t\tif ( type === 'vec3' || type === 'ivec3' || type === 'uvec3' ) return new Vector3NodeUniform( uniformNode );\n\t\tif ( type === 'vec4' || type === 'ivec4' || type === 'uvec4' ) return new Vector4NodeUniform( uniformNode );\n\t\tif ( type === 'color' ) return new ColorNodeUniform( uniformNode );\n\t\tif ( type === 'mat3' ) return new Matrix3NodeUniform( uniformNode );\n\t\tif ( type === 'mat4' ) return new Matrix4NodeUniform( uniformNode );\n\n\t\tthrow new Error( `Uniform \"${type}\" not declared.` );\n\n\t}\n\n\tcreateNodeMaterial( type = 'NodeMaterial' ) { // @deprecated, r168\n\n\t\tthrow new Error( `THREE.NodeBuilder: createNodeMaterial() was deprecated. Use new ${ type }() instead.` );\n\n\t}\n\n\tformat( snippet, fromType, toType ) {\n\n\t\tfromType = this.getVectorType( fromType );\n\t\ttoType = this.getVectorType( toType );\n\n\t\tif ( fromType === toType || toType === null || this.isReference( toType ) ) {\n\n\t\t\treturn snippet;\n\n\t\t}\n\n\t\tconst fromTypeLength = this.getTypeLength( fromType );\n\t\tconst toTypeLength = this.getTypeLength( toType );\n\n\t\tif ( fromTypeLength === 16 && toTypeLength === 9 ) {\n\n\t\t\treturn `${ this.getType( toType ) }(${ snippet }[0].xyz, ${ snippet }[1].xyz, ${ snippet }[2].xyz)`;\n\n\t\t}\n\n\t\tif ( fromTypeLength === 9 && toTypeLength === 4 ) {\n\n\t\t\treturn `${ this.getType( toType ) }(${ snippet }[0].xy, ${ snippet }[1].xy)`;\n\n\t\t}\n\n\n\t\tif ( fromTypeLength > 4 ) { // fromType is matrix-like\n\n\t\t\t// @TODO: ignore for now\n\n\t\t\treturn snippet;\n\n\t\t}\n\n\t\tif ( toTypeLength > 4 || toTypeLength === 0 ) { // toType is matrix-like or unknown\n\n\t\t\t// @TODO: ignore for now\n\n\t\t\treturn snippet;\n\n\t\t}\n\n\t\tif ( fromTypeLength === toTypeLength ) {\n\n\t\t\treturn `${ this.getType( toType ) }( ${ snippet } )`;\n\n\t\t}\n\n\t\tif ( fromTypeLength > toTypeLength ) {\n\n\t\t\treturn this.format( `${ snippet }.${ 'xyz'.slice( 0, toTypeLength ) }`, this.getTypeFromLength( toTypeLength, this.getComponentType( fromType ) ), toType );\n\n\t\t}\n\n\t\tif ( toTypeLength === 4 && fromTypeLength > 1 ) { // toType is vec4-like\n\n\t\t\treturn `${ this.getType( toType ) }( ${ this.format( snippet, fromType, 'vec3' ) }, 1.0 )`;\n\n\t\t}\n\n\t\tif ( fromTypeLength === 2 ) { // fromType is vec2-like and toType is vec3-like\n\n\t\t\treturn `${ this.getType( toType ) }( ${ this.format( snippet, fromType, 'vec2' ) }, 0.0 )`;\n\n\t\t}\n\n\t\tif ( fromTypeLength === 1 && toTypeLength > 1 && fromType !== this.getComponentType( toType ) ) { // fromType is float-like\n\n\t\t\t// convert a number value to vector type, e.g:\n\t\t\t// vec3( 1u ) -> vec3( float( 1u ) )\n\n\t\t\tsnippet = `${ this.getType( this.getComponentType( toType ) ) }( ${ snippet } )`;\n\n\t\t}\n\n\t\treturn `${ this.getType( toType ) }( ${ snippet } )`; // fromType is float-like\n\n\t}\n\n\tgetSignature() {\n\n\t\treturn `// Three.js r${ REVISION } - Node System\\n`;\n\n\t}\n\n}\n\nclass NodeFrame {\n\n\tconstructor() {\n\n\t\tthis.time = 0;\n\t\tthis.deltaTime = 0;\n\n\t\tthis.frameId = 0;\n\t\tthis.renderId = 0;\n\n\t\tthis.startTime = null;\n\n\t\tthis.updateMap = new WeakMap();\n\t\tthis.updateBeforeMap = new WeakMap();\n\t\tthis.updateAfterMap = new WeakMap();\n\n\t\tthis.renderer = null;\n\t\tthis.material = null;\n\t\tthis.camera = null;\n\t\tthis.object = null;\n\t\tthis.scene = null;\n\n\t}\n\n\t_getMaps( referenceMap, nodeRef ) {\n\n\t\tlet maps = referenceMap.get( nodeRef );\n\n\t\tif ( maps === undefined ) {\n\n\t\t\tmaps = {\n\t\t\t\trenderMap: new WeakMap(),\n\t\t\t\tframeMap: new WeakMap()\n\t\t\t};\n\n\t\t\treferenceMap.set( nodeRef, maps );\n\n\t\t}\n\n\t\treturn maps;\n\n\t}\n\n\tupdateBeforeNode( node ) {\n\n\t\tconst updateType = node.getUpdateBeforeType();\n\t\tconst reference = node.updateReference( this );\n\n\t\tif ( updateType === NodeUpdateType.FRAME ) {\n\n\t\t\tconst { frameMap } = this._getMaps( this.updateBeforeMap, reference );\n\n\t\t\tif ( frameMap.get( reference ) !== this.frameId ) {\n\n\t\t\t\tif ( node.updateBefore( this ) !== false ) {\n\n\t\t\t\t\tframeMap.set( reference, this.frameId );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( updateType === NodeUpdateType.RENDER ) {\n\n\t\t\tconst { renderMap } = this._getMaps( this.updateBeforeMap, reference );\n\n\t\t\tif ( renderMap.get( reference ) !== this.renderId ) {\n\n\t\t\t\tif ( node.updateBefore( this ) !== false ) {\n\n\t\t\t\t\trenderMap.set( reference, this.renderId );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( updateType === NodeUpdateType.OBJECT ) {\n\n\t\t\tnode.updateBefore( this );\n\n\t\t}\n\n\t}\n\n\tupdateAfterNode( node ) {\n\n\t\tconst updateType = node.getUpdateAfterType();\n\t\tconst reference = node.updateReference( this );\n\n\t\tif ( updateType === NodeUpdateType.FRAME ) {\n\n\t\t\tconst { frameMap } = this._getMaps( this.updateAfterMap, reference );\n\n\t\t\tif ( frameMap.get( reference ) !== this.frameId ) {\n\n\t\t\t\tif ( node.updateAfter( this ) !== false ) {\n\n\t\t\t\t\tframeMap.set( reference, this.frameId );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( updateType === NodeUpdateType.RENDER ) {\n\n\t\t\tconst { renderMap } = this._getMaps( this.updateAfterMap, reference );\n\n\t\t\tif ( renderMap.get( reference ) !== this.renderId ) {\n\n\t\t\t\tif ( node.updateAfter( this ) !== false ) {\n\n\t\t\t\t\trenderMap.set( reference, this.renderId );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( updateType === NodeUpdateType.OBJECT ) {\n\n\t\t\tnode.updateAfter( this );\n\n\t\t}\n\n\t}\n\n\tupdateNode( node ) {\n\n\t\tconst updateType = node.getUpdateType();\n\t\tconst reference = node.updateReference( this );\n\n\t\tif ( updateType === NodeUpdateType.FRAME ) {\n\n\t\t\tconst { frameMap } = this._getMaps( this.updateMap, reference );\n\n\t\t\tif ( frameMap.get( reference ) !== this.frameId ) {\n\n\t\t\t\tif ( node.update( this ) !== false ) {\n\n\t\t\t\t\tframeMap.set( reference, this.frameId );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( updateType === NodeUpdateType.RENDER ) {\n\n\t\t\tconst { renderMap } = this._getMaps( this.updateMap, reference );\n\n\t\t\tif ( renderMap.get( reference ) !== this.renderId ) {\n\n\t\t\t\tif ( node.update( this ) !== false ) {\n\n\t\t\t\t\trenderMap.set( reference, this.renderId );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( updateType === NodeUpdateType.OBJECT ) {\n\n\t\t\tnode.update( this );\n\n\t\t}\n\n\t}\n\n\tupdate() {\n\n\t\tthis.frameId ++;\n\n\t\tif ( this.lastTime === undefined ) this.lastTime = performance.now();\n\n\t\tthis.deltaTime = ( performance.now() - this.lastTime ) / 1000;\n\n\t\tthis.lastTime = performance.now();\n\n\t\tthis.time += this.deltaTime;\n\n\t}\n\n}\n\nclass NodeFunctionInput {\n\n\tconstructor( type, name, count = null, qualifier = '', isConst = false ) {\n\n\t\tthis.type = type;\n\t\tthis.name = name;\n\t\tthis.count = count;\n\t\tthis.qualifier = qualifier;\n\t\tthis.isConst = isConst;\n\n\t}\n\n}\n\nNodeFunctionInput.isNodeFunctionInput = true;\n\nclass DirectionalLightNode extends AnalyticLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'DirectionalLightNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tconst lightingModel = builder.context.lightingModel;\n\n\t\tconst lightColor = this.colorNode;\n\t\tconst lightDirection = lightTargetDirection( this.light );\n\t\tconst reflectedLight = builder.context.reflectedLight;\n\n\t\tlightingModel.direct( {\n\t\t\tlightDirection,\n\t\t\tlightColor,\n\t\t\treflectedLight\n\t\t}, builder.stack, builder );\n\n\t}\n\n}\n\nconst _matrix41 = /*@__PURE__*/ new Matrix4();\nconst _matrix42 = /*@__PURE__*/ new Matrix4();\n\nlet ltcLib = null;\n\nclass RectAreaLightNode extends AnalyticLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'RectAreaLightNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t\tthis.halfHeight = uniform( new Vector3() ).setGroup( renderGroup );\n\t\tthis.halfWidth = uniform( new Vector3() ).setGroup( renderGroup );\n\n\t\tthis.updateType = NodeUpdateType.RENDER;\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tsuper.update( frame );\n\n\t\tconst { light } = this;\n\n\t\tconst viewMatrix = frame.camera.matrixWorldInverse;\n\n\t\t_matrix42.identity();\n\t\t_matrix41.copy( light.matrixWorld );\n\t\t_matrix41.premultiply( viewMatrix );\n\t\t_matrix42.extractRotation( _matrix41 );\n\n\t\tthis.halfWidth.value.set( light.width * 0.5, 0.0, 0.0 );\n\t\tthis.halfHeight.value.set( 0.0, light.height * 0.5, 0.0 );\n\n\t\tthis.halfWidth.value.applyMatrix4( _matrix42 );\n\t\tthis.halfHeight.value.applyMatrix4( _matrix42 );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tlet ltc_1, ltc_2;\n\n\t\tif ( builder.isAvailable( 'float32Filterable' ) ) {\n\n\t\t\tltc_1 = texture( ltcLib.LTC_FLOAT_1 );\n\t\t\tltc_2 = texture( ltcLib.LTC_FLOAT_2 );\n\n\t\t} else {\n\n\t\t\tltc_1 = texture( ltcLib.LTC_HALF_1 );\n\t\t\tltc_2 = texture( ltcLib.LTC_HALF_2 );\n\n\t\t}\n\n\t\tconst { colorNode, light } = this;\n\t\tconst lightingModel = builder.context.lightingModel;\n\n\t\tconst lightPosition = lightViewPosition( light );\n\t\tconst reflectedLight = builder.context.reflectedLight;\n\n\t\tlightingModel.directRectArea( {\n\t\t\tlightColor: colorNode,\n\t\t\tlightPosition,\n\t\t\thalfWidth: this.halfWidth,\n\t\t\thalfHeight: this.halfHeight,\n\t\t\treflectedLight,\n\t\t\tltc_1,\n\t\t\tltc_2\n\t\t}, builder.stack, builder );\n\n\t}\n\n\tstatic setLTC( ltc ) {\n\n\t\tltcLib = ltc;\n\n\t}\n\n}\n\nclass SpotLightNode extends AnalyticLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'SpotLightNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t\tthis.coneCosNode = uniform( 0 ).setGroup( renderGroup );\n\t\tthis.penumbraCosNode = uniform( 0 ).setGroup( renderGroup );\n\n\t\tthis.cutoffDistanceNode = uniform( 0 ).setGroup( renderGroup );\n\t\tthis.decayExponentNode = uniform( 0 ).setGroup( renderGroup );\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tsuper.update( frame );\n\n\t\tconst { light } = this;\n\n\t\tthis.coneCosNode.value = Math.cos( light.angle );\n\t\tthis.penumbraCosNode.value = Math.cos( light.angle * ( 1 - light.penumbra ) );\n\n\t\tthis.cutoffDistanceNode.value = light.distance;\n\t\tthis.decayExponentNode.value = light.decay;\n\n\t}\n\n\tgetSpotAttenuation( angleCosine ) {\n\n\t\tconst { coneCosNode, penumbraCosNode } = this;\n\n\t\treturn smoothstep( coneCosNode, penumbraCosNode, angleCosine );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tconst lightingModel = builder.context.lightingModel;\n\n\t\tconst { colorNode, cutoffDistanceNode, decayExponentNode, light } = this;\n\n\t\tconst lVector = lightViewPosition( light ).sub( positionView ); // @TODO: Add it into LightNode\n\n\t\tconst lightDirection = lVector.normalize();\n\t\tconst angleCos = lightDirection.dot( lightTargetDirection( light ) );\n\t\tconst spotAttenuation = this.getSpotAttenuation( angleCos );\n\n\t\tconst lightDistance = lVector.length();\n\n\t\tconst lightAttenuation = getDistanceAttenuation( {\n\t\t\tlightDistance,\n\t\t\tcutoffDistance: cutoffDistanceNode,\n\t\t\tdecayExponent: decayExponentNode\n\t\t} );\n\n\t\tlet lightColor = colorNode.mul( spotAttenuation ).mul( lightAttenuation );\n\n\t\tif ( light.map ) {\n\n\t\t\tconst spotLightCoord = lightProjectionUV( light );\n\t\t\tconst projectedTexture = texture( light.map, spotLightCoord.xy ).onRenderUpdate( () => light.map );\n\n\t\t\tconst inSpotLightMap = spotLightCoord.mul( 2. ).sub( 1. ).abs().lessThan( 1. ).all();\n\n\t\t\tlightColor = inSpotLightMap.select( lightColor.mul( projectedTexture ), lightColor );\n\n\t\t}\n\n\t\tconst reflectedLight = builder.context.reflectedLight;\n\n\t\tlightingModel.direct( {\n\t\t\tlightDirection,\n\t\t\tlightColor,\n\t\t\treflectedLight\n\t\t}, builder.stack, builder );\n\n\t}\n\n}\n\nclass IESSpotLightNode extends SpotLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'IESSpotLightNode';\n\n\t}\n\n\tgetSpotAttenuation( angleCosine ) {\n\n\t\tconst iesMap = this.light.iesMap;\n\n\t\tlet spotAttenuation = null;\n\n\t\tif ( iesMap && iesMap.isTexture === true ) {\n\n\t\t\tconst angle = angleCosine.acos().mul( 1.0 / Math.PI );\n\n\t\t\tspotAttenuation = texture( iesMap, vec2( angle, 0 ), 0 ).r;\n\n\t\t} else {\n\n\t\t\tspotAttenuation = super.getSpotAttenuation( angleCosine );\n\n\t\t}\n\n\t\treturn spotAttenuation;\n\n\t}\n\n}\n\nclass AmbientLightNode extends AnalyticLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'AmbientLightNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t}\n\n\tsetup( { context } ) {\n\n\t\tcontext.irradiance.addAssign( this.colorNode );\n\n\t}\n\n}\n\nclass HemisphereLightNode extends AnalyticLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'HemisphereLightNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t\tthis.lightPositionNode = lightPosition( light );\n\t\tthis.lightDirectionNode = this.lightPositionNode.normalize();\n\n\t\tthis.groundColorNode = uniform( new Color() ).setGroup( renderGroup );\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tconst { light } = this;\n\n\t\tsuper.update( frame );\n\n\t\tthis.lightPositionNode.object3d = light;\n\n\t\tthis.groundColorNode.value.copy( light.groundColor ).multiplyScalar( light.intensity );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { colorNode, groundColorNode, lightDirectionNode } = this;\n\n\t\tconst dotNL = normalView.dot( lightDirectionNode );\n\t\tconst hemiDiffuseWeight = dotNL.mul( 0.5 ).add( 0.5 );\n\n\t\tconst irradiance = mix( groundColorNode, colorNode, hemiDiffuseWeight );\n\n\t\tbuilder.context.irradiance.addAssign( irradiance );\n\n\t}\n\n}\n\nclass LightProbeNode extends AnalyticLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'LightProbeNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t\tconst array = [];\n\n\t\tfor ( let i = 0; i < 9; i ++ ) array.push( new Vector3() );\n\n\t\tthis.lightProbe = uniformArray( array );\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tconst { light } = this;\n\n\t\tsuper.update( frame );\n\n\t\t//\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.lightProbe.array[ i ].copy( light.sh.coefficients[ i ] ).multiplyScalar( light.intensity );\n\n\t\t}\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst irradiance = getShIrradianceAt( normalWorld, this.lightProbe );\n\n\t\tbuilder.context.irradiance.addAssign( irradiance );\n\n\t}\n\n}\n\nclass NodeParser {\n\n\tparseFunction( /*source*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n}\n\nclass NodeFunction {\n\n\tconstructor( type, inputs, name = '', precision = '' ) {\n\n\t\tthis.type = type;\n\t\tthis.inputs = inputs;\n\t\tthis.name = name;\n\t\tthis.precision = precision;\n\n\t}\n\n\tgetCode( /*name = this.name*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n}\n\nNodeFunction.isNodeFunction = true;\n\nconst declarationRegexp$1 = /^\\s*(highp|mediump|lowp)?\\s*([a-z_0-9]+)\\s*([a-z_0-9]+)?\\s*\\(([\\s\\S]*?)\\)/i;\nconst propertiesRegexp$1 = /[a-z_0-9]+/ig;\n\nconst pragmaMain = '#pragma main';\n\nconst parse$1 = ( source ) => {\n\n\tsource = source.trim();\n\n\tconst pragmaMainIndex = source.indexOf( pragmaMain );\n\n\tconst mainCode = pragmaMainIndex !== - 1 ? source.slice( pragmaMainIndex + pragmaMain.length ) : source;\n\n\tconst declaration = mainCode.match( declarationRegexp$1 );\n\n\tif ( declaration !== null && declaration.length === 5 ) {\n\n\t\t// tokenizer\n\n\t\tconst inputsCode = declaration[ 4 ];\n\t\tconst propsMatches = [];\n\n\t\tlet nameMatch = null;\n\n\t\twhile ( ( nameMatch = propertiesRegexp$1.exec( inputsCode ) ) !== null ) {\n\n\t\t\tpropsMatches.push( nameMatch );\n\n\t\t}\n\n\t\t// parser\n\n\t\tconst inputs = [];\n\n\t\tlet i = 0;\n\n\t\twhile ( i < propsMatches.length ) {\n\n\t\t\tconst isConst = propsMatches[ i ][ 0 ] === 'const';\n\n\t\t\tif ( isConst === true ) {\n\n\t\t\t\ti ++;\n\n\t\t\t}\n\n\t\t\tlet qualifier = propsMatches[ i ][ 0 ];\n\n\t\t\tif ( qualifier === 'in' || qualifier === 'out' || qualifier === 'inout' ) {\n\n\t\t\t\ti ++;\n\n\t\t\t} else {\n\n\t\t\t\tqualifier = '';\n\n\t\t\t}\n\n\t\t\tconst type = propsMatches[ i ++ ][ 0 ];\n\n\t\t\tlet count = Number.parseInt( propsMatches[ i ][ 0 ] );\n\n\t\t\tif ( Number.isNaN( count ) === false ) i ++;\n\t\t\telse count = null;\n\n\t\t\tconst name = propsMatches[ i ++ ][ 0 ];\n\n\t\t\tinputs.push( new NodeFunctionInput( type, name, count, qualifier, isConst ) );\n\n\t\t}\n\n\t\t//\n\n\t\tconst blockCode = mainCode.substring( declaration[ 0 ].length );\n\n\t\tconst name = declaration[ 3 ] !== undefined ? declaration[ 3 ] : '';\n\t\tconst type = declaration[ 2 ];\n\n\t\tconst precision = declaration[ 1 ] !== undefined ? declaration[ 1 ] : '';\n\n\t\tconst headerCode = pragmaMainIndex !== - 1 ? source.slice( 0, pragmaMainIndex ) : '';\n\n\t\treturn {\n\t\t\ttype,\n\t\t\tinputs,\n\t\t\tname,\n\t\t\tprecision,\n\t\t\tinputsCode,\n\t\t\tblockCode,\n\t\t\theaderCode\n\t\t};\n\n\t} else {\n\n\t\tthrow new Error( 'FunctionNode: Function is not a GLSL code.' );\n\n\t}\n\n};\n\nclass GLSLNodeFunction extends NodeFunction {\n\n\tconstructor( source ) {\n\n\t\tconst { type, inputs, name, precision, inputsCode, blockCode, headerCode } = parse$1( source );\n\n\t\tsuper( type, inputs, name, precision );\n\n\t\tthis.inputsCode = inputsCode;\n\t\tthis.blockCode = blockCode;\n\t\tthis.headerCode = headerCode;\n\n\t}\n\n\tgetCode( name = this.name ) {\n\n\t\tlet code;\n\n\t\tconst blockCode = this.blockCode;\n\n\t\tif ( blockCode !== '' ) {\n\n\t\t\tconst { type, inputsCode, headerCode, precision } = this;\n\n\t\t\tlet declarationCode = `${ type } ${ name } ( ${ inputsCode.trim() } )`;\n\n\t\t\tif ( precision !== '' ) {\n\n\t\t\t\tdeclarationCode = `${ precision } ${ declarationCode }`;\n\n\t\t\t}\n\n\t\t\tcode = headerCode + declarationCode + blockCode;\n\n\t\t} else {\n\n\t\t\t// interface function\n\n\t\t\tcode = '';\n\n\t\t}\n\n\t\treturn code;\n\n\t}\n\n}\n\nclass GLSLNodeParser extends NodeParser {\n\n\tparseFunction( source ) {\n\n\t\treturn new GLSLNodeFunction( source );\n\n\t}\n\n}\n\nconst outputNodeMap = new WeakMap();\n\nclass Nodes extends DataMap {\n\n\tconstructor( renderer, backend ) {\n\n\t\tsuper();\n\n\t\tthis.renderer = renderer;\n\t\tthis.backend = backend;\n\t\tthis.nodeFrame = new NodeFrame();\n\t\tthis.nodeBuilderCache = new Map();\n\t\tthis.callHashCache = new ChainMap();\n\t\tthis.groupsData = new ChainMap();\n\n\t}\n\n\tupdateGroup( nodeUniformsGroup ) {\n\n\t\tconst groupNode = nodeUniformsGroup.groupNode;\n\t\tconst name = groupNode.name;\n\n\t\t// objectGroup is every updated\n\n\t\tif ( name === objectGroup.name ) return true;\n\n\t\t// renderGroup is updated once per render/compute call\n\n\t\tif ( name === renderGroup.name ) {\n\n\t\t\tconst uniformsGroupData = this.get( nodeUniformsGroup );\n\t\t\tconst renderId = this.nodeFrame.renderId;\n\n\t\t\tif ( uniformsGroupData.renderId !== renderId ) {\n\n\t\t\t\tuniformsGroupData.renderId = renderId;\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// frameGroup is updated once per frame\n\n\t\tif ( name === frameGroup.name ) {\n\n\t\t\tconst uniformsGroupData = this.get( nodeUniformsGroup );\n\t\t\tconst frameId = this.nodeFrame.frameId;\n\n\t\t\tif ( uniformsGroupData.frameId !== frameId ) {\n\n\t\t\t\tuniformsGroupData.frameId = frameId;\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// other groups are updated just when groupNode.needsUpdate is true\n\n\t\tconst groupChain = [ groupNode, nodeUniformsGroup ];\n\n\t\tlet groupData = this.groupsData.get( groupChain );\n\t\tif ( groupData === undefined ) this.groupsData.set( groupChain, groupData = {} );\n\n\t\tif ( groupData.version !== groupNode.version ) {\n\n\t\t\tgroupData.version = groupNode.version;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tgetForRenderCacheKey( renderObject ) {\n\n\t\treturn renderObject.initialCacheKey;\n\n\t}\n\n\tgetForRender( renderObject ) {\n\n\t\tconst renderObjectData = this.get( renderObject );\n\n\t\tlet nodeBuilderState = renderObjectData.nodeBuilderState;\n\n\t\tif ( nodeBuilderState === undefined ) {\n\n\t\t\tconst { nodeBuilderCache } = this;\n\n\t\t\tconst cacheKey = this.getForRenderCacheKey( renderObject );\n\n\t\t\tnodeBuilderState = nodeBuilderCache.get( cacheKey );\n\n\t\t\tif ( nodeBuilderState === undefined ) {\n\n\t\t\t\tconst nodeBuilder = this.backend.createNodeBuilder( renderObject.object, this.renderer );\n\t\t\t\tnodeBuilder.scene = renderObject.scene;\n\t\t\t\tnodeBuilder.material = renderObject.material;\n\t\t\t\tnodeBuilder.camera = renderObject.camera;\n\t\t\t\tnodeBuilder.context.material = renderObject.material;\n\t\t\t\tnodeBuilder.lightsNode = renderObject.lightsNode;\n\t\t\t\tnodeBuilder.environmentNode = this.getEnvironmentNode( renderObject.scene );\n\t\t\t\tnodeBuilder.fogNode = this.getFogNode( renderObject.scene );\n\t\t\t\tnodeBuilder.clippingContext = renderObject.clippingContext;\n\t\t\t\tnodeBuilder.build();\n\n\t\t\t\tnodeBuilderState = this._createNodeBuilderState( nodeBuilder );\n\n\t\t\t\tnodeBuilderCache.set( cacheKey, nodeBuilderState );\n\n\t\t\t}\n\n\t\t\tnodeBuilderState.usedTimes ++;\n\n\t\t\trenderObjectData.nodeBuilderState = nodeBuilderState;\n\n\t\t}\n\n\t\treturn nodeBuilderState;\n\n\t}\n\n\tdelete( object ) {\n\n\t\tif ( object.isRenderObject ) {\n\n\t\t\tconst nodeBuilderState = this.get( object ).nodeBuilderState;\n\t\t\tnodeBuilderState.usedTimes --;\n\n\t\t\tif ( nodeBuilderState.usedTimes === 0 ) {\n\n\t\t\t\tthis.nodeBuilderCache.delete( this.getForRenderCacheKey( object ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn super.delete( object );\n\n\t}\n\n\tgetForCompute( computeNode ) {\n\n\t\tconst computeData = this.get( computeNode );\n\n\t\tlet nodeBuilderState = computeData.nodeBuilderState;\n\n\t\tif ( nodeBuilderState === undefined ) {\n\n\t\t\tconst nodeBuilder = this.backend.createNodeBuilder( computeNode, this.renderer );\n\t\t\tnodeBuilder.build();\n\n\t\t\tnodeBuilderState = this._createNodeBuilderState( nodeBuilder );\n\n\t\t\tcomputeData.nodeBuilderState = nodeBuilderState;\n\n\t\t}\n\n\t\treturn nodeBuilderState;\n\n\t}\n\n\t_createNodeBuilderState( nodeBuilder ) {\n\n\t\treturn new NodeBuilderState(\n\t\t\tnodeBuilder.vertexShader,\n\t\t\tnodeBuilder.fragmentShader,\n\t\t\tnodeBuilder.computeShader,\n\t\t\tnodeBuilder.getAttributesArray(),\n\t\t\tnodeBuilder.getBindings(),\n\t\t\tnodeBuilder.updateNodes,\n\t\t\tnodeBuilder.updateBeforeNodes,\n\t\t\tnodeBuilder.updateAfterNodes,\n\t\t\tnodeBuilder.monitor,\n\t\t\tnodeBuilder.transforms\n\t\t);\n\n\t}\n\n\tgetEnvironmentNode( scene ) {\n\n\t\treturn scene.environmentNode || this.get( scene ).environmentNode || null;\n\n\t}\n\n\tgetBackgroundNode( scene ) {\n\n\t\treturn scene.backgroundNode || this.get( scene ).backgroundNode || null;\n\n\t}\n\n\tgetFogNode( scene ) {\n\n\t\treturn scene.fogNode || this.get( scene ).fogNode || null;\n\n\t}\n\n\tgetCacheKey( scene, lightsNode ) {\n\n\t\tconst chain = [ scene, lightsNode ];\n\t\tconst callId = this.renderer.info.calls;\n\n\t\tlet cacheKeyData = this.callHashCache.get( chain );\n\n\t\tif ( cacheKeyData === undefined || cacheKeyData.callId !== callId ) {\n\n\t\t\tconst environmentNode = this.getEnvironmentNode( scene );\n\t\t\tconst fogNode = this.getFogNode( scene );\n\n\t\t\tconst values = [];\n\n\t\t\tif ( lightsNode ) values.push( lightsNode.getCacheKey( true ) );\n\t\t\tif ( environmentNode ) values.push( environmentNode.getCacheKey() );\n\t\t\tif ( fogNode ) values.push( fogNode.getCacheKey() );\n\n\t\t\tvalues.push( this.renderer.shadowMap.enabled ? 1 : 0 );\n\n\t\t\tcacheKeyData = {\n\t\t\t\tcallId,\n\t\t\t\tcacheKey: hashArray( values )\n\t\t\t};\n\n\t\t\tthis.callHashCache.set( chain, cacheKeyData );\n\n\t\t}\n\n\t\treturn cacheKeyData.cacheKey;\n\n\t}\n\n\tupdateScene( scene ) {\n\n\t\tthis.updateEnvironment( scene );\n\t\tthis.updateFog( scene );\n\t\tthis.updateBackground( scene );\n\n\t}\n\n\tget isToneMappingState() {\n\n\t\treturn this.renderer.getRenderTarget() ? false : true;\n\n\t}\n\n\tupdateBackground( scene ) {\n\n\t\tconst sceneData = this.get( scene );\n\t\tconst background = scene.background;\n\n\t\tif ( background ) {\n\n\t\t\tconst forceUpdate = ( scene.backgroundBlurriness === 0 && sceneData.backgroundBlurriness > 0 ) || ( scene.backgroundBlurriness > 0 && sceneData.backgroundBlurriness === 0 );\n\n\t\t\tif ( sceneData.background !== background || forceUpdate ) {\n\n\t\t\t\tlet backgroundNode = null;\n\n\t\t\t\tif ( background.isCubeTexture === true || ( background.mapping === EquirectangularReflectionMapping || background.mapping === EquirectangularRefractionMapping || background.mapping === CubeUVReflectionMapping ) ) {\n\n\t\t\t\t\tif ( scene.backgroundBlurriness > 0 || background.mapping === CubeUVReflectionMapping ) {\n\n\t\t\t\t\t\tbackgroundNode = pmremTexture( background );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tlet envMap;\n\n\t\t\t\t\t\tif ( background.isCubeTexture === true ) {\n\n\t\t\t\t\t\t\tenvMap = cubeTexture( background );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tenvMap = texture( background );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbackgroundNode = cubeMapNode( envMap );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( background.isTexture === true ) {\n\n\t\t\t\t\tbackgroundNode = texture( background, screenUV.flipY() ).setUpdateMatrix( true );\n\n\t\t\t\t} else if ( background.isColor !== true ) {\n\n\t\t\t\t\tconsole.error( 'WebGPUNodes: Unsupported background configuration.', background );\n\n\t\t\t\t}\n\n\t\t\t\tsceneData.backgroundNode = backgroundNode;\n\t\t\t\tsceneData.background = background;\n\t\t\t\tsceneData.backgroundBlurriness = scene.backgroundBlurriness;\n\n\t\t\t}\n\n\t\t} else if ( sceneData.backgroundNode ) {\n\n\t\t\tdelete sceneData.backgroundNode;\n\t\t\tdelete sceneData.background;\n\n\t\t}\n\n\t}\n\n\tupdateFog( scene ) {\n\n\t\tconst sceneData = this.get( scene );\n\t\tconst fog = scene.fog;\n\n\t\tif ( fog ) {\n\n\t\t\tif ( sceneData.fog !== fog ) {\n\n\t\t\t\tlet fogNode = null;\n\n\t\t\t\tif ( fog.isFogExp2 ) {\n\n\t\t\t\t\tconst color = reference( 'color', 'color', fog ).setGroup( renderGroup );\n\t\t\t\t\tconst density = reference( 'density', 'float', fog ).setGroup( renderGroup );\n\n\t\t\t\t\tfogNode = densityFog( color, density );\n\n\t\t\t\t} else if ( fog.isFog ) {\n\n\t\t\t\t\tconst color = reference( 'color', 'color', fog ).setGroup( renderGroup );\n\t\t\t\t\tconst near = reference( 'near', 'float', fog ).setGroup( renderGroup );\n\t\t\t\t\tconst far = reference( 'far', 'float', fog ).setGroup( renderGroup );\n\n\t\t\t\t\tfogNode = rangeFog( color, near, far );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'WebGPUNodes: Unsupported fog configuration.', fog );\n\n\t\t\t\t}\n\n\t\t\t\tsceneData.fogNode = fogNode;\n\t\t\t\tsceneData.fog = fog;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tdelete sceneData.fogNode;\n\t\t\tdelete sceneData.fog;\n\n\t\t}\n\n\t}\n\n\tupdateEnvironment( scene ) {\n\n\t\tconst sceneData = this.get( scene );\n\t\tconst environment = scene.environment;\n\n\t\tif ( environment ) {\n\n\t\t\tif ( sceneData.environment !== environment ) {\n\n\t\t\t\tlet environmentNode = null;\n\n\t\t\t\tif ( environment.isCubeTexture === true ) {\n\n\t\t\t\t\tenvironmentNode = cubeTexture( environment );\n\n\t\t\t\t} else if ( environment.isTexture === true ) {\n\n\t\t\t\t\tenvironmentNode = texture( environment );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'Nodes: Unsupported environment configuration.', environment );\n\n\t\t\t\t}\n\n\t\t\t\tsceneData.environmentNode = environmentNode;\n\t\t\t\tsceneData.environment = environment;\n\n\t\t\t}\n\n\t\t} else if ( sceneData.environmentNode ) {\n\n\t\t\tdelete sceneData.environmentNode;\n\t\t\tdelete sceneData.environment;\n\n\t\t}\n\n\t}\n\n\tgetNodeFrame( renderer = this.renderer, scene = null, object = null, camera = null, material = null ) {\n\n\t\tconst nodeFrame = this.nodeFrame;\n\t\tnodeFrame.renderer = renderer;\n\t\tnodeFrame.scene = scene;\n\t\tnodeFrame.object = object;\n\t\tnodeFrame.camera = camera;\n\t\tnodeFrame.material = material;\n\n\t\treturn nodeFrame;\n\n\t}\n\n\tgetNodeFrameForRender( renderObject ) {\n\n\t\treturn this.getNodeFrame( renderObject.renderer, renderObject.scene, renderObject.object, renderObject.camera, renderObject.material );\n\n\t}\n\n\tgetOutputCacheKey() {\n\n\t\tconst renderer = this.renderer;\n\n\t\treturn renderer.toneMapping + ',' + renderer.currentColorSpace;\n\n\t}\n\n\thasOutputChange( outputTarget ) {\n\n\t\tconst cacheKey = outputNodeMap.get( outputTarget );\n\n\t\treturn cacheKey !== this.getOutputCacheKey();\n\n\t}\n\n\tgetOutputNode( outputTexture ) {\n\n\t\tconst renderer = this.renderer;\n\t\tconst cacheKey = this.getOutputCacheKey();\n\n\t\tconst output = texture( outputTexture, screenUV ).renderOutput( renderer.toneMapping, renderer.currentColorSpace );\n\n\t\toutputNodeMap.set( outputTexture, cacheKey );\n\n\t\treturn output;\n\n\t}\n\n\tupdateBefore( renderObject ) {\n\n\t\tconst nodeBuilder = renderObject.getNodeBuilderState();\n\n\t\tfor ( const node of nodeBuilder.updateBeforeNodes ) {\n\n\t\t\t// update frame state for each node\n\n\t\t\tthis.getNodeFrameForRender( renderObject ).updateBeforeNode( node );\n\n\t\t}\n\n\t}\n\n\tupdateAfter( renderObject ) {\n\n\t\tconst nodeBuilder = renderObject.getNodeBuilderState();\n\n\t\tfor ( const node of nodeBuilder.updateAfterNodes ) {\n\n\t\t\t// update frame state for each node\n\n\t\t\tthis.getNodeFrameForRender( renderObject ).updateAfterNode( node );\n\n\t\t}\n\n\t}\n\n\tupdateForCompute( computeNode ) {\n\n\t\tconst nodeFrame = this.getNodeFrame();\n\t\tconst nodeBuilder = this.getForCompute( computeNode );\n\n\t\tfor ( const node of nodeBuilder.updateNodes ) {\n\n\t\t\tnodeFrame.updateNode( node );\n\n\t\t}\n\n\t}\n\n\tupdateForRender( renderObject ) {\n\n\t\tconst nodeFrame = this.getNodeFrameForRender( renderObject );\n\t\tconst nodeBuilder = renderObject.getNodeBuilderState();\n\n\t\tfor ( const node of nodeBuilder.updateNodes ) {\n\n\t\t\tnodeFrame.updateNode( node );\n\n\t\t}\n\n\t}\n\n\tneedsRefresh( renderObject ) {\n\n\t\tconst nodeFrame = this.getNodeFrameForRender( renderObject );\n\t\tconst monitor = renderObject.getMonitor();\n\n\t\treturn monitor.needsRefresh( renderObject, nodeFrame );\n\n\t}\n\n\tdispose() {\n\n\t\tsuper.dispose();\n\n\t\tthis.nodeFrame = new NodeFrame();\n\t\tthis.nodeBuilderCache = new Map();\n\n\t}\n\n}\n\nconst _plane = /*@__PURE__*/ new Plane();\n\nclass ClippingContext {\n\n\tconstructor( parentContext = null ) {\n\n\t\tthis.version = 0;\n\n\t\tthis.clipIntersection = null;\n\t\tthis.cacheKey = '';\n\n\n\t\tif ( parentContext === null ) {\n\n\t\t\tthis.intersectionPlanes = [];\n\t\t\tthis.unionPlanes = [];\n\n\t\t\tthis.viewNormalMatrix = new Matrix3();\n\t\t\tthis.clippingGroupContexts = new WeakMap();\n\n\t\t\tthis.shadowPass = false;\n\n\t\t} else {\n\n\t\t\tthis.viewNormalMatrix = parentContext.viewNormalMatrix;\n\t\t\tthis.clippingGroupContexts = parentContext.clippingGroupContexts;\n\n\t\t\tthis.shadowPass = parentContext.shadowPass;\n\n\t\t\tthis.viewMatrix = parentContext.viewMatrix;\n\n\t\t}\n\n\t\tthis.parentVersion = null;\n\n\t}\n\n\tprojectPlanes( source, destination, offset ) {\n\n\t\tconst l = source.length;\n\n\t\tfor ( let i = 0; i < l; i ++ ) {\n\n\t\t\t_plane.copy( source[ i ] ).applyMatrix4( this.viewMatrix, this.viewNormalMatrix );\n\n\t\t\tconst v = destination[ offset + i ];\n\t\t\tconst normal = _plane.normal;\n\n\t\t\tv.x = - normal.x;\n\t\t\tv.y = - normal.y;\n\t\t\tv.z = - normal.z;\n\t\t\tv.w = _plane.constant;\n\n\t\t}\n\n\t}\n\n\tupdateGlobal( scene, camera ) {\n\n\t\tthis.shadowPass = ( scene.overrideMaterial !== null && scene.overrideMaterial.isShadowNodeMaterial );\n\t\tthis.viewMatrix = camera.matrixWorldInverse;\n\n\t\tthis.viewNormalMatrix.getNormalMatrix( this.viewMatrix );\n\n\t}\n\n\tupdate( parentContext, clippingGroup ) {\n\n\t\tlet update = false;\n\n\t\tif ( parentContext.version !== this.parentVersion ) {\n\n\t\t\tthis.intersectionPlanes = Array.from( parentContext.intersectionPlanes );\n\t\t\tthis.unionPlanes = Array.from( parentContext.unionPlanes );\n\t\t\tthis.parentVersion = parentContext.version;\n\n\t\t}\n\n\t\tif ( this.clipIntersection !== clippingGroup.clipIntersection ) {\n\n\t\t\tthis.clipIntersection = clippingGroup.clipIntersection;\n\n\t\t\tif ( this.clipIntersection ) {\n\n\t\t\t\tthis.unionPlanes.length = parentContext.unionPlanes.length;\n\n\t\t\t} else {\n\n\t\t\t\tthis.intersectionPlanes.length = parentContext.intersectionPlanes.length;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst srcClippingPlanes = clippingGroup.clippingPlanes;\n\t\tconst l = srcClippingPlanes.length;\n\n\t\tlet dstClippingPlanes;\n\t\tlet offset;\n\n\t\tif ( this.clipIntersection ) {\n\n\t\t\tdstClippingPlanes = this.intersectionPlanes;\n\t\t\toffset = parentContext.intersectionPlanes.length;\n\n\t\t} else {\n\n\t\t\tdstClippingPlanes = this.unionPlanes;\n\t\t\toffset = parentContext.unionPlanes.length;\n\n\t\t}\n\n\t\tif ( dstClippingPlanes.length !== offset + l ) {\n\n\t\t\tdstClippingPlanes.length = offset + l;\n\n\t\t\tfor ( let i = 0; i < l; i ++ ) {\n\n\t\t\t\tdstClippingPlanes[ offset + i ] = new Vector4();\n\n\t\t\t}\n\n\t\t\tupdate = true;\n\n\t\t}\n\n\t\tthis.projectPlanes( srcClippingPlanes, dstClippingPlanes, offset );\n\n\t\tif ( update ) {\n\n\t\t\tthis.version ++;\n\t\t\tthis.cacheKey = `${ this.intersectionPlanes.length }:${ this.unionPlanes.length }`;\n\n\t\t}\n\n\t}\n\n\tgetGroupContext( clippingGroup ) {\n\n\t\tif ( this.shadowPass && ! clippingGroup.clipShadows ) return this;\n\n\t\tlet context = this.clippingGroupContexts.get( clippingGroup );\n\n\t\tif ( context === undefined ) {\n\n\t\t\tcontext = new ClippingContext( this );\n\t\t\tthis.clippingGroupContexts.set( clippingGroup, context );\n\n\t\t}\n\n\t\tcontext.update( this, clippingGroup );\n\n\t\treturn context;\n\n\t}\n\n\tget unionClippingCount() {\n\n\t\treturn this.unionPlanes.length;\n\n\t}\n\n}\n\nclass RenderBundle {\n\n\tconstructor( scene, camera ) {\n\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\n\t}\n\n\tclone() {\n\n\t\treturn Object.assign( new this.constructor(), this );\n\n\t}\n\n}\n\nclass RenderBundles {\n\n\tconstructor() {\n\n\t\tthis.lists = new ChainMap();\n\n\t}\n\n\tget( scene, camera ) {\n\n\t\tconst lists = this.lists;\n\t\tconst keys = [ scene, camera ];\n\n\t\tlet list = lists.get( keys );\n\n\t\tif ( list === undefined ) {\n\n\t\t\tlist = new RenderBundle( scene, camera );\n\t\t\tlists.set( keys, list );\n\n\t\t}\n\n\t\treturn list;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.lists = new ChainMap();\n\n\t}\n\n}\n\nclass NodeLibrary {\n\n\tconstructor() {\n\n\t\tthis.lightNodes = new WeakMap();\n\t\tthis.materialNodes = new Map();\n\t\tthis.toneMappingNodes = new Map();\n\n\t}\n\n\tfromMaterial( material ) {\n\n\t\tif ( material.isNodeMaterial ) return material;\n\n\t\tlet nodeMaterial = null;\n\n\t\tconst nodeMaterialClass = this.getMaterialNodeClass( material.type );\n\n\t\tif ( nodeMaterialClass !== null ) {\n\n\t\t\tnodeMaterial = new nodeMaterialClass();\n\n\t\t\tfor ( const key in material ) {\n\n\t\t\t\tnodeMaterial[ key ] = material[ key ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn nodeMaterial;\n\n\t}\n\n\taddToneMapping( toneMappingNode, toneMapping ) {\n\n\t\tthis.addType( toneMappingNode, toneMapping, this.toneMappingNodes );\n\n\t}\n\n\tgetToneMappingFunction( toneMapping ) {\n\n\t\treturn this.toneMappingNodes.get( toneMapping ) || null;\n\n\t}\n\n\tgetMaterialNodeClass( materialType ) {\n\n\t\treturn this.materialNodes.get( materialType ) || null;\n\n\t}\n\n\taddMaterial( materialNodeClass, materialClassType ) {\n\n\t\tthis.addType( materialNodeClass, materialClassType, this.materialNodes );\n\n\t}\n\n\tgetLightNodeClass( light ) {\n\n\t\treturn this.lightNodes.get( light ) || null;\n\n\t}\n\n\taddLight( lightNodeClass, lightClass ) {\n\n\t\tthis.addClass( lightNodeClass, lightClass, this.lightNodes );\n\n\t}\n\n\taddType( nodeClass, type, library ) {\n\n\t\tif ( library.has( type ) ) {\n\n\t\t\tconsole.warn( `Redefinition of node ${ type }` );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( typeof nodeClass !== 'function' ) throw new Error( `Node class ${ nodeClass.name } is not a class.` );\n\t\tif ( typeof type === 'function' || typeof type === 'object' ) throw new Error( `Base class ${ type } is not a class.` );\n\n\t\tlibrary.set( type, nodeClass );\n\n\t}\n\n\taddClass( nodeClass, baseClass, library ) {\n\n\t\tif ( library.has( baseClass ) ) {\n\n\t\t\tconsole.warn( `Redefinition of node ${ baseClass.name }` );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( typeof nodeClass !== 'function' ) throw new Error( `Node class ${ nodeClass.name } is not a class.` );\n\t\tif ( typeof baseClass !== 'function' ) throw new Error( `Base class ${ baseClass.name } is not a class.` );\n\n\t\tlibrary.set( baseClass, nodeClass );\n\n\t}\n\n}\n\nconst _defaultLights = /*@__PURE__*/ new LightsNode();\n\nclass Lighting extends ChainMap {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t}\n\n\tcreateNode( lights = [] ) {\n\n\t\treturn new LightsNode().setLights( lights );\n\n\t}\n\n\tgetNode( scene, camera ) {\n\n\t\t// ignore post-processing\n\n\t\tif ( scene.isQuadMesh ) return _defaultLights;\n\n\t\t// tiled lighting\n\n\t\tconst keys = [ scene, camera ];\n\n\t\tlet node = this.get( keys );\n\n\t\tif ( node === undefined ) {\n\n\t\t\tnode = this.createNode();\n\t\t\tthis.set( keys, node );\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n}\n\nconst _scene = /*@__PURE__*/ new Scene();\nconst _drawingBufferSize = /*@__PURE__*/ new Vector2();\nconst _screen = /*@__PURE__*/ new Vector4();\nconst _frustum = /*@__PURE__*/ new Frustum();\nconst _projScreenMatrix = /*@__PURE__*/ new Matrix4();\nconst _vector4 = /*@__PURE__*/ new Vector4();\n\nclass Renderer {\n\n\tconstructor( backend, parameters = {} ) {\n\n\t\tthis.isRenderer = true;\n\n\t\t//\n\n\t\tconst {\n\t\t\tlogarithmicDepthBuffer = false,\n\t\t\talpha = true,\n\t\t\tdepth = true,\n\t\t\tstencil = false,\n\t\t\tantialias = false,\n\t\t\tsamples = 0,\n\t\t\tgetFallback = null\n\t\t} = parameters;\n\n\t\t// public\n\t\tthis.domElement = backend.getDomElement();\n\n\t\tthis.backend = backend;\n\n\t\tthis.samples = samples || ( antialias === true ) ? 4 : 0;\n\n\t\tthis.autoClear = true;\n\t\tthis.autoClearColor = true;\n\t\tthis.autoClearDepth = true;\n\t\tthis.autoClearStencil = true;\n\n\t\tthis.alpha = alpha;\n\n\t\tthis.logarithmicDepthBuffer = logarithmicDepthBuffer;\n\n\t\tthis.outputColorSpace = SRGBColorSpace;\n\n\t\tthis.toneMapping = NoToneMapping;\n\t\tthis.toneMappingExposure = 1.0;\n\n\t\tthis.sortObjects = true;\n\n\t\tthis.depth = depth;\n\t\tthis.stencil = stencil;\n\n\t\tthis.info = new Info();\n\n\t\tthis.nodes = {\n\t\t\tmodelViewMatrix: null,\n\t\t\tmodelNormalViewMatrix: null\n\t\t};\n\n\t\tthis.library = new NodeLibrary();\n\t\tthis.lighting = new Lighting();\n\n\t\t// internals\n\n\t\tthis._getFallback = getFallback;\n\n\t\tthis._pixelRatio = 1;\n\t\tthis._width = this.domElement.width;\n\t\tthis._height = this.domElement.height;\n\n\t\tthis._viewport = new Vector4( 0, 0, this._width, this._height );\n\t\tthis._scissor = new Vector4( 0, 0, this._width, this._height );\n\t\tthis._scissorTest = false;\n\n\t\tthis._attributes = null;\n\t\tthis._geometries = null;\n\t\tthis._nodes = null;\n\t\tthis._animation = null;\n\t\tthis._bindings = null;\n\t\tthis._objects = null;\n\t\tthis._pipelines = null;\n\t\tthis._bundles = null;\n\t\tthis._renderLists = null;\n\t\tthis._renderContexts = null;\n\t\tthis._textures = null;\n\t\tthis._background = null;\n\n\t\tthis._quad = new QuadMesh( new NodeMaterial() );\n\t\tthis._quad.material.type = 'Renderer_output';\n\n\t\tthis._currentRenderContext = null;\n\n\t\tthis._opaqueSort = null;\n\t\tthis._transparentSort = null;\n\n\t\tthis._frameBufferTarget = null;\n\n\t\tconst alphaClear = this.alpha === true ? 0 : 1;\n\n\t\tthis._clearColor = new Color4( 0, 0, 0, alphaClear );\n\t\tthis._clearDepth = 1;\n\t\tthis._clearStencil = 0;\n\n\t\tthis._renderTarget = null;\n\t\tthis._activeCubeFace = 0;\n\t\tthis._activeMipmapLevel = 0;\n\n\t\tthis._mrt = null;\n\n\t\tthis._renderObjectFunction = null;\n\t\tthis._currentRenderObjectFunction = null;\n\t\tthis._currentRenderBundle = null;\n\n\t\tthis._handleObjectFunction = this._renderObjectDirect;\n\n\t\tthis._isDeviceLost = false;\n\t\tthis.onDeviceLost = this._onDeviceLost;\n\n\t\tthis._initialized = false;\n\t\tthis._initPromise = null;\n\n\t\tthis._compilationPromises = null;\n\n\t\tthis.transparent = true;\n\t\tthis.opaque = true;\n\n\t\tthis.shadowMap = {\n\t\t\tenabled: false,\n\t\t\ttype: PCFShadowMap\n\t\t};\n\n\t\tthis.xr = {\n\t\t\tenabled: false\n\t\t};\n\n\t\tthis.debug = {\n\t\t\tcheckShaderErrors: true,\n\t\t\tonShaderError: null,\n\t\t\tgetShaderAsync: async ( scene, camera, object ) => {\n\n\t\t\t\tawait this.compileAsync( scene, camera );\n\n\t\t\t\tconst renderList = this._renderLists.get( scene, camera );\n\t\t\t\tconst renderContext = this._renderContexts.get( scene, camera, this._renderTarget );\n\n\t\t\t\tconst material = scene.overrideMaterial || object.material;\n\n\t\t\t\tconst renderObject = this._objects.get( object, material, scene, camera, renderList.lightsNode, renderContext, renderContext.clippingContext );\n\n\t\t\t\tconst { fragmentShader, vertexShader } = renderObject.getNodeBuilderState();\n\n\t\t\t\treturn { fragmentShader, vertexShader };\n\n\t\t\t}\n\t\t};\n\n\t}\n\n\tasync init() {\n\n\t\tif ( this._initialized ) {\n\n\t\t\tthrow new Error( 'Renderer: Backend has already been initialized.' );\n\n\t\t}\n\n\t\tif ( this._initPromise !== null ) {\n\n\t\t\treturn this._initPromise;\n\n\t\t}\n\n\t\tthis._initPromise = new Promise( async ( resolve, reject ) => {\n\n\t\t\tlet backend = this.backend;\n\n\t\t\ttry {\n\n\t\t\t\tawait backend.init( this );\n\n\t\t\t} catch ( error ) {\n\n\t\t\t\tif ( this._getFallback !== null ) {\n\n\t\t\t\t\t// try the fallback\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\tthis.backend = backend = this._getFallback( error );\n\t\t\t\t\t\tawait backend.init( this );\n\n\t\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t\treject( error );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\treject( error );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._nodes = new Nodes( this, backend );\n\t\t\tthis._animation = new Animation( this._nodes, this.info );\n\t\t\tthis._attributes = new Attributes( backend );\n\t\t\tthis._background = new Background( this, this._nodes );\n\t\t\tthis._geometries = new Geometries( this._attributes, this.info );\n\t\t\tthis._textures = new Textures( this, backend, this.info );\n\t\t\tthis._pipelines = new Pipelines( backend, this._nodes );\n\t\t\tthis._bindings = new Bindings( backend, this._nodes, this._textures, this._attributes, this._pipelines, this.info );\n\t\t\tthis._objects = new RenderObjects( this, this._nodes, this._geometries, this._pipelines, this._bindings, this.info );\n\t\t\tthis._renderLists = new RenderLists( this.lighting );\n\t\t\tthis._bundles = new RenderBundles();\n\t\t\tthis._renderContexts = new RenderContexts();\n\n\t\t\t//\n\n\t\t\tthis._animation.start();\n\t\t\tthis._initialized = true;\n\n\t\t\tresolve();\n\n\t\t} );\n\n\t\treturn this._initPromise;\n\n\t}\n\n\tget coordinateSystem() {\n\n\t\treturn this.backend.coordinateSystem;\n\n\t}\n\n\tasync compileAsync( scene, camera, targetScene = null ) {\n\n\t\tif ( this._isDeviceLost === true ) return;\n\n\t\tif ( this._initialized === false ) await this.init();\n\n\t\t// preserve render tree\n\n\t\tconst nodeFrame = this._nodes.nodeFrame;\n\n\t\tconst previousRenderId = nodeFrame.renderId;\n\t\tconst previousRenderContext = this._currentRenderContext;\n\t\tconst previousRenderObjectFunction = this._currentRenderObjectFunction;\n\t\tconst previousCompilationPromises = this._compilationPromises;\n\n\t\t//\n\n\t\tconst sceneRef = ( scene.isScene === true ) ? scene : _scene;\n\n\t\tif ( targetScene === null ) targetScene = scene;\n\n\t\tconst renderTarget = this._renderTarget;\n\t\tconst renderContext = this._renderContexts.get( targetScene, camera, renderTarget );\n\t\tconst activeMipmapLevel = this._activeMipmapLevel;\n\n\t\tconst compilationPromises = [];\n\n\t\tthis._currentRenderContext = renderContext;\n\t\tthis._currentRenderObjectFunction = this.renderObject;\n\n\t\tthis._handleObjectFunction = this._createObjectPipeline;\n\n\t\tthis._compilationPromises = compilationPromises;\n\n\t\tnodeFrame.renderId ++;\n\n\t\t//\n\n\t\tnodeFrame.update();\n\n\t\t//\n\n\t\trenderContext.depth = this.depth;\n\t\trenderContext.stencil = this.stencil;\n\n\t\tif ( ! renderContext.clippingContext ) renderContext.clippingContext = new ClippingContext();\n\t\trenderContext.clippingContext.updateGlobal( sceneRef, camera );\n\n\t\t//\n\n\t\tsceneRef.onBeforeRender( this, scene, camera, renderTarget );\n\n\t\t//\n\n\t\tconst renderList = this._renderLists.get( scene, camera );\n\t\trenderList.begin();\n\n\t\tthis._projectObject( scene, camera, 0, renderList, renderContext.clippingContext );\n\n\t\t// include lights from target scene\n\t\tif ( targetScene !== scene ) {\n\n\t\t\ttargetScene.traverseVisible( function ( object ) {\n\n\t\t\t\tif ( object.isLight && object.layers.test( camera.layers ) ) {\n\n\t\t\t\t\trenderList.pushLight( object );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t\trenderList.finish();\n\n\t\t//\n\n\t\tif ( renderTarget !== null ) {\n\n\t\t\tthis._textures.updateRenderTarget( renderTarget, activeMipmapLevel );\n\n\t\t\tconst renderTargetData = this._textures.get( renderTarget );\n\n\t\t\trenderContext.textures = renderTargetData.textures;\n\t\t\trenderContext.depthTexture = renderTargetData.depthTexture;\n\n\t\t} else {\n\n\t\t\trenderContext.textures = null;\n\t\t\trenderContext.depthTexture = null;\n\n\t\t}\n\n\t\t//\n\n\t\tthis._nodes.updateScene( sceneRef );\n\n\t\t//\n\n\t\tthis._background.update( sceneRef, renderList, renderContext );\n\n\t\t// process render lists\n\n\t\tconst opaqueObjects = renderList.opaque;\n\t\tconst transparentObjects = renderList.transparent;\n\t\tconst transparentDoublePassObjects = renderList.transparentDoublePass;\n\t\tconst lightsNode = renderList.lightsNode;\n\n\t\tif ( this.opaque === true && opaqueObjects.length > 0 ) this._renderObjects( opaqueObjects, camera, sceneRef, lightsNode );\n\t\tif ( this.transparent === true && transparentObjects.length > 0 ) this._renderTransparents( transparentObjects, transparentDoublePassObjects, camera, sceneRef, lightsNode );\n\n\t\t// restore render tree\n\n\t\tnodeFrame.renderId = previousRenderId;\n\n\t\tthis._currentRenderContext = previousRenderContext;\n\t\tthis._currentRenderObjectFunction = previousRenderObjectFunction;\n\t\tthis._compilationPromises = previousCompilationPromises;\n\n\t\tthis._handleObjectFunction = this._renderObjectDirect;\n\n\t\t// wait for all promises setup by backends awaiting compilation/linking/pipeline creation to complete\n\n\t\tawait Promise.all( compilationPromises );\n\n\t}\n\n\tasync renderAsync( scene, camera ) {\n\n\t\tif ( this._initialized === false ) await this.init();\n\n\t\tconst renderContext = this._renderScene( scene, camera );\n\n\t\tawait this.backend.resolveTimestampAsync( renderContext, 'render' );\n\n\t}\n\n\tasync waitForGPU() {\n\n\t\tawait this.backend.waitForGPU();\n\n\t}\n\n\tsetMRT( mrt ) {\n\n\t\tthis._mrt = mrt;\n\n\t\treturn this;\n\n\t}\n\n\tgetMRT() {\n\n\t\treturn this._mrt;\n\n\t}\n\n\t_onDeviceLost( info ) {\n\n\t\tlet errorMessage = `THREE.WebGPURenderer: ${info.api} Device Lost:\\n\\nMessage: ${info.message}`;\n\n\t\tif ( info.reason ) {\n\n\t\t\terrorMessage += `\\nReason: ${info.reason}`;\n\n\t\t}\n\n\t\tconsole.error( errorMessage );\n\n\t\tthis._isDeviceLost = true;\n\n\t}\n\n\n\t_renderBundle( bundle, sceneRef, lightsNode ) {\n\n\t\tconst { bundleGroup, camera, renderList } = bundle;\n\n\t\tconst renderContext = this._currentRenderContext;\n\n\t\t//\n\n\t\tconst renderBundle = this._bundles.get( bundleGroup, camera );\n\t\tconst renderBundleData = this.backend.get( renderBundle );\n\n\t\tif ( renderBundleData.renderContexts === undefined ) renderBundleData.renderContexts = new Set();\n\n\t\t//\n\n\t\tconst needsUpdate = bundleGroup.version !== renderBundleData.version;\n\t\tconst renderBundleNeedsUpdate = renderBundleData.renderContexts.has( renderContext ) === false || needsUpdate;\n\n\t\trenderBundleData.renderContexts.add( renderContext );\n\n\t\tif ( renderBundleNeedsUpdate ) {\n\n\t\t\tthis.backend.beginBundle( renderContext );\n\n\t\t\tif ( renderBundleData.renderObjects === undefined || needsUpdate ) {\n\n\t\t\t\trenderBundleData.renderObjects = [];\n\n\t\t\t}\n\n\t\t\tthis._currentRenderBundle = renderBundle;\n\n\t\t\tconst opaqueObjects = renderList.opaque;\n\n\t\t\tif ( this.opaque === true && opaqueObjects.length > 0 ) this._renderObjects( opaqueObjects, camera, sceneRef, lightsNode );\n\n\t\t\tthis._currentRenderBundle = null;\n\n\t\t\t//\n\n\t\t\tthis.backend.finishBundle( renderContext, renderBundle );\n\n\t\t\trenderBundleData.version = bundleGroup.version;\n\n\t\t} else {\n\n\t\t\tconst { renderObjects } = renderBundleData;\n\n\t\t\tfor ( let i = 0, l = renderObjects.length; i < l; i ++ ) {\n\n\t\t\t\tconst renderObject = renderObjects[ i ];\n\n\t\t\t\tif ( this._nodes.needsRefresh( renderObject ) ) {\n\n\t\t\t\t\tthis._nodes.updateBefore( renderObject );\n\n\t\t\t\t\tthis._nodes.updateForRender( renderObject );\n\t\t\t\t\tthis._bindings.updateForRender( renderObject );\n\n\t\t\t\t\tthis._nodes.updateAfter( renderObject );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.backend.addBundle( renderContext, renderBundle );\n\n\t}\n\n\trender( scene, camera ) {\n\n\t\tif ( this._initialized === false ) {\n\n\t\t\tconsole.warn( 'THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead.' );\n\n\t\t\treturn this.renderAsync( scene, camera );\n\n\t\t}\n\n\t\tthis._renderScene( scene, camera );\n\n\t}\n\n\t_getFrameBufferTarget() {\n\n\t\tconst { currentToneMapping, currentColorSpace } = this;\n\n\t\tconst useToneMapping = currentToneMapping !== NoToneMapping;\n\t\tconst useColorSpace = currentColorSpace !== LinearSRGBColorSpace;\n\n\t\tif ( useToneMapping === false && useColorSpace === false ) return null;\n\n\t\tconst { width, height } = this.getDrawingBufferSize( _drawingBufferSize );\n\t\tconst { depth, stencil } = this;\n\n\t\tlet frameBufferTarget = this._frameBufferTarget;\n\n\t\tif ( frameBufferTarget === null ) {\n\n\t\t\tframeBufferTarget = new RenderTarget( width, height, {\n\t\t\t\tdepthBuffer: depth,\n\t\t\t\tstencilBuffer: stencil,\n\t\t\t\ttype: HalfFloatType, // FloatType\n\t\t\t\tformat: RGBAFormat,\n\t\t\t\tcolorSpace: LinearSRGBColorSpace,\n\t\t\t\tgenerateMipmaps: false,\n\t\t\t\tminFilter: LinearFilter,\n\t\t\t\tmagFilter: LinearFilter,\n\t\t\t\tsamples: this.samples\n\t\t\t} );\n\n\t\t\tframeBufferTarget.isPostProcessingRenderTarget = true;\n\n\t\t\tthis._frameBufferTarget = frameBufferTarget;\n\n\t\t}\n\n\t\tframeBufferTarget.depthBuffer = depth;\n\t\tframeBufferTarget.stencilBuffer = stencil;\n\t\tframeBufferTarget.setSize( width, height );\n\t\tframeBufferTarget.viewport.copy( this._viewport );\n\t\tframeBufferTarget.scissor.copy( this._scissor );\n\t\tframeBufferTarget.viewport.multiplyScalar( this._pixelRatio );\n\t\tframeBufferTarget.scissor.multiplyScalar( this._pixelRatio );\n\t\tframeBufferTarget.scissorTest = this._scissorTest;\n\n\t\treturn frameBufferTarget;\n\n\t}\n\n\t_renderScene( scene, camera, useFrameBufferTarget = true ) {\n\n\t\tif ( this._isDeviceLost === true ) return;\n\n\t\tconst frameBufferTarget = useFrameBufferTarget ? this._getFrameBufferTarget() : null;\n\n\t\t// preserve render tree\n\n\t\tconst nodeFrame = this._nodes.nodeFrame;\n\n\t\tconst previousRenderId = nodeFrame.renderId;\n\t\tconst previousRenderContext = this._currentRenderContext;\n\t\tconst previousRenderObjectFunction = this._currentRenderObjectFunction;\n\n\t\t//\n\n\t\tconst sceneRef = ( scene.isScene === true ) ? scene : _scene;\n\n\t\tconst outputRenderTarget = this._renderTarget;\n\n\t\tconst activeCubeFace = this._activeCubeFace;\n\t\tconst activeMipmapLevel = this._activeMipmapLevel;\n\n\t\t//\n\n\t\tlet renderTarget;\n\n\t\tif ( frameBufferTarget !== null ) {\n\n\t\t\trenderTarget = frameBufferTarget;\n\n\t\t\tthis.setRenderTarget( renderTarget );\n\n\t\t} else {\n\n\t\t\trenderTarget = outputRenderTarget;\n\n\t\t}\n\n\t\t//\n\n\t\tconst renderContext = this._renderContexts.get( scene, camera, renderTarget );\n\n\t\tthis._currentRenderContext = renderContext;\n\t\tthis._currentRenderObjectFunction = this._renderObjectFunction || this.renderObject;\n\n\t\t//\n\n\t\tthis.info.calls ++;\n\t\tthis.info.render.calls ++;\n\t\tthis.info.render.frameCalls ++;\n\n\t\tnodeFrame.renderId = this.info.calls;\n\n\t\t//\n\n\t\tconst coordinateSystem = this.coordinateSystem;\n\n\t\tif ( camera.coordinateSystem !== coordinateSystem ) {\n\n\t\t\tcamera.coordinateSystem = coordinateSystem;\n\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t\t//\n\n\t\tif ( scene.matrixWorldAutoUpdate === true ) scene.updateMatrixWorld();\n\n\t\tif ( camera.parent === null && camera.matrixWorldAutoUpdate === true ) camera.updateMatrixWorld();\n\n\t\t//\n\n\t\tlet viewport = this._viewport;\n\t\tlet scissor = this._scissor;\n\t\tlet pixelRatio = this._pixelRatio;\n\n\t\tif ( renderTarget !== null ) {\n\n\t\t\tviewport = renderTarget.viewport;\n\t\t\tscissor = renderTarget.scissor;\n\t\t\tpixelRatio = 1;\n\n\t\t}\n\n\t\tthis.getDrawingBufferSize( _drawingBufferSize );\n\n\t\t_screen.set( 0, 0, _drawingBufferSize.width, _drawingBufferSize.height );\n\n\t\tconst minDepth = ( viewport.minDepth === undefined ) ? 0 : viewport.minDepth;\n\t\tconst maxDepth = ( viewport.maxDepth === undefined ) ? 1 : viewport.maxDepth;\n\n\t\trenderContext.viewportValue.copy( viewport ).multiplyScalar( pixelRatio ).floor();\n\t\trenderContext.viewportValue.width >>= activeMipmapLevel;\n\t\trenderContext.viewportValue.height >>= activeMipmapLevel;\n\t\trenderContext.viewportValue.minDepth = minDepth;\n\t\trenderContext.viewportValue.maxDepth = maxDepth;\n\t\trenderContext.viewport = renderContext.viewportValue.equals( _screen ) === false;\n\n\t\trenderContext.scissorValue.copy( scissor ).multiplyScalar( pixelRatio ).floor();\n\t\trenderContext.scissor = this._scissorTest && renderContext.scissorValue.equals( _screen ) === false;\n\t\trenderContext.scissorValue.width >>= activeMipmapLevel;\n\t\trenderContext.scissorValue.height >>= activeMipmapLevel;\n\n\t\tif ( ! renderContext.clippingContext ) renderContext.clippingContext = new ClippingContext();\n\t\trenderContext.clippingContext.updateGlobal( sceneRef, camera );\n\n\t\t//\n\n\t\tsceneRef.onBeforeRender( this, scene, camera, renderTarget );\n\n\t\t//\n\n\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\n\t\t_frustum.setFromProjectionMatrix( _projScreenMatrix, coordinateSystem );\n\n\t\tconst renderList = this._renderLists.get( scene, camera );\n\t\trenderList.begin();\n\n\t\tthis._projectObject( scene, camera, 0, renderList, renderContext.clippingContext );\n\n\t\trenderList.finish();\n\n\t\tif ( this.sortObjects === true ) {\n\n\t\t\trenderList.sort( this._opaqueSort, this._transparentSort );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( renderTarget !== null ) {\n\n\t\t\tthis._textures.updateRenderTarget( renderTarget, activeMipmapLevel );\n\n\t\t\tconst renderTargetData = this._textures.get( renderTarget );\n\n\t\t\trenderContext.textures = renderTargetData.textures;\n\t\t\trenderContext.depthTexture = renderTargetData.depthTexture;\n\t\t\trenderContext.width = renderTargetData.width;\n\t\t\trenderContext.height = renderTargetData.height;\n\t\t\trenderContext.renderTarget = renderTarget;\n\t\t\trenderContext.depth = renderTarget.depthBuffer;\n\t\t\trenderContext.stencil = renderTarget.stencilBuffer;\n\n\t\t} else {\n\n\t\t\trenderContext.textures = null;\n\t\t\trenderContext.depthTexture = null;\n\t\t\trenderContext.width = this.domElement.width;\n\t\t\trenderContext.height = this.domElement.height;\n\t\t\trenderContext.depth = this.depth;\n\t\t\trenderContext.stencil = this.stencil;\n\n\t\t}\n\n\t\trenderContext.width >>= activeMipmapLevel;\n\t\trenderContext.height >>= activeMipmapLevel;\n\t\trenderContext.activeCubeFace = activeCubeFace;\n\t\trenderContext.activeMipmapLevel = activeMipmapLevel;\n\t\trenderContext.occlusionQueryCount = renderList.occlusionQueryCount;\n\n\t\t//\n\n\t\tthis._nodes.updateScene( sceneRef );\n\n\t\t//\n\n\t\tthis._background.update( sceneRef, renderList, renderContext );\n\n\t\t//\n\n\t\tthis.backend.beginRender( renderContext );\n\n\t\t// process render lists\n\n\t\tconst {\n\t\t\tbundles,\n\t\t\tlightsNode,\n\t\t\ttransparentDoublePass: transparentDoublePassObjects,\n\t\t\ttransparent: transparentObjects,\n\t\t\topaque: opaqueObjects\n\t\t} = renderList;\n\n\t\tif ( bundles.length > 0 ) this._renderBundles( bundles, sceneRef, lightsNode );\n\t\tif ( this.opaque === true && opaqueObjects.length > 0 ) this._renderObjects( opaqueObjects, camera, sceneRef, lightsNode );\n\t\tif ( this.transparent === true && transparentObjects.length > 0 ) this._renderTransparents( transparentObjects, transparentDoublePassObjects, camera, sceneRef, lightsNode );\n\n\t\t// finish render pass\n\n\t\tthis.backend.finishRender( renderContext );\n\n\t\t// restore render tree\n\n\t\tnodeFrame.renderId = previousRenderId;\n\n\t\tthis._currentRenderContext = previousRenderContext;\n\t\tthis._currentRenderObjectFunction = previousRenderObjectFunction;\n\n\t\t//\n\n\t\tif ( frameBufferTarget !== null ) {\n\n\t\t\tthis.setRenderTarget( outputRenderTarget, activeCubeFace, activeMipmapLevel );\n\n\t\t\tconst quad = this._quad;\n\n\t\t\tif ( this._nodes.hasOutputChange( renderTarget.texture ) ) {\n\n\t\t\t\tquad.material.fragmentNode = this._nodes.getOutputNode( renderTarget.texture );\n\t\t\t\tquad.material.needsUpdate = true;\n\n\t\t\t}\n\n\t\t\tthis._renderScene( quad, quad.camera, false );\n\n\t\t}\n\n\t\t//\n\n\t\tsceneRef.onAfterRender( this, scene, camera, renderTarget );\n\n\t\t//\n\n\t\treturn renderContext;\n\n\t}\n\n\tgetMaxAnisotropy() {\n\n\t\treturn this.backend.getMaxAnisotropy();\n\n\t}\n\n\tgetActiveCubeFace() {\n\n\t\treturn this._activeCubeFace;\n\n\t}\n\n\tgetActiveMipmapLevel() {\n\n\t\treturn this._activeMipmapLevel;\n\n\t}\n\n\tasync setAnimationLoop( callback ) {\n\n\t\tif ( this._initialized === false ) await this.init();\n\n\t\tthis._animation.setAnimationLoop( callback );\n\n\t}\n\n\tasync getArrayBufferAsync( attribute ) {\n\n\t\treturn await this.backend.getArrayBufferAsync( attribute );\n\n\t}\n\n\tgetContext() {\n\n\t\treturn this.backend.getContext();\n\n\t}\n\n\tgetPixelRatio() {\n\n\t\treturn this._pixelRatio;\n\n\t}\n\n\tgetDrawingBufferSize( target ) {\n\n\t\treturn target.set( this._width * this._pixelRatio, this._height * this._pixelRatio ).floor();\n\n\t}\n\n\tgetSize( target ) {\n\n\t\treturn target.set( this._width, this._height );\n\n\t}\n\n\tsetPixelRatio( value = 1 ) {\n\n\t\tif ( this._pixelRatio === value ) return;\n\n\t\tthis._pixelRatio = value;\n\n\t\tthis.setSize( this._width, this._height, false );\n\n\t}\n\n\tsetDrawingBufferSize( width, height, pixelRatio ) {\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tthis._pixelRatio = pixelRatio;\n\n\t\tthis.domElement.width = Math.floor( width * pixelRatio );\n\t\tthis.domElement.height = Math.floor( height * pixelRatio );\n\n\t\tthis.setViewport( 0, 0, width, height );\n\n\t\tif ( this._initialized ) this.backend.updateSize();\n\n\t}\n\n\tsetSize( width, height, updateStyle = true ) {\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tthis.domElement.width = Math.floor( width * this._pixelRatio );\n\t\tthis.domElement.height = Math.floor( height * this._pixelRatio );\n\n\t\tif ( updateStyle === true ) {\n\n\t\t\tthis.domElement.style.width = width + 'px';\n\t\t\tthis.domElement.style.height = height + 'px';\n\n\t\t}\n\n\t\tthis.setViewport( 0, 0, width, height );\n\n\t\tif ( this._initialized ) this.backend.updateSize();\n\n\t}\n\n\tsetOpaqueSort( method ) {\n\n\t\tthis._opaqueSort = method;\n\n\t}\n\n\tsetTransparentSort( method ) {\n\n\t\tthis._transparentSort = method;\n\n\t}\n\n\tgetScissor( target ) {\n\n\t\tconst scissor = this._scissor;\n\n\t\ttarget.x = scissor.x;\n\t\ttarget.y = scissor.y;\n\t\ttarget.width = scissor.width;\n\t\ttarget.height = scissor.height;\n\n\t\treturn target;\n\n\t}\n\n\tsetScissor( x, y, width, height ) {\n\n\t\tconst scissor = this._scissor;\n\n\t\tif ( x.isVector4 ) {\n\n\t\t\tscissor.copy( x );\n\n\t\t} else {\n\n\t\t\tscissor.set( x, y, width, height );\n\n\t\t}\n\n\t}\n\n\tgetScissorTest() {\n\n\t\treturn this._scissorTest;\n\n\t}\n\n\tsetScissorTest( boolean ) {\n\n\t\tthis._scissorTest = boolean;\n\n\t\tthis.backend.setScissorTest( boolean );\n\n\t}\n\n\tgetViewport( target ) {\n\n\t\treturn target.copy( this._viewport );\n\n\t}\n\n\tsetViewport( x, y, width, height, minDepth = 0, maxDepth = 1 ) {\n\n\t\tconst viewport = this._viewport;\n\n\t\tif ( x.isVector4 ) {\n\n\t\t\tviewport.copy( x );\n\n\t\t} else {\n\n\t\t\tviewport.set( x, y, width, height );\n\n\t\t}\n\n\t\tviewport.minDepth = minDepth;\n\t\tviewport.maxDepth = maxDepth;\n\n\t}\n\n\tgetClearColor( target ) {\n\n\t\treturn target.copy( this._clearColor );\n\n\t}\n\n\tsetClearColor( color, alpha = 1 ) {\n\n\t\tthis._clearColor.set( color );\n\t\tthis._clearColor.a = alpha;\n\n\t}\n\n\tgetClearAlpha() {\n\n\t\treturn this._clearColor.a;\n\n\t}\n\n\tsetClearAlpha( alpha ) {\n\n\t\tthis._clearColor.a = alpha;\n\n\t}\n\n\tgetClearDepth() {\n\n\t\treturn this._clearDepth;\n\n\t}\n\n\tsetClearDepth( depth ) {\n\n\t\tthis._clearDepth = depth;\n\n\t}\n\n\tgetClearStencil() {\n\n\t\treturn this._clearStencil;\n\n\t}\n\n\tsetClearStencil( stencil ) {\n\n\t\tthis._clearStencil = stencil;\n\n\t}\n\n\tisOccluded( object ) {\n\n\t\tconst renderContext = this._currentRenderContext;\n\n\t\treturn renderContext && this.backend.isOccluded( renderContext, object );\n\n\t}\n\n\tclear( color = true, depth = true, stencil = true ) {\n\n\t\tif ( this._initialized === false ) {\n\n\t\t\tconsole.warn( 'THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead.' );\n\n\t\t\treturn this.clearAsync( color, depth, stencil );\n\n\t\t}\n\n\t\tconst renderTarget = this._renderTarget || this._getFrameBufferTarget();\n\n\t\tlet renderTargetData = null;\n\n\t\tif ( renderTarget !== null ) {\n\n\t\t\tthis._textures.updateRenderTarget( renderTarget );\n\n\t\t\trenderTargetData = this._textures.get( renderTarget );\n\n\t\t}\n\n\t\tthis.backend.clear( color, depth, stencil, renderTargetData );\n\n\t\tif ( renderTarget !== null && this._renderTarget === null ) {\n\n\t\t\t// If a color space transform or tone mapping is required,\n\t\t\t// the clear operation clears the intermediate renderTarget texture, but does not update the screen canvas.\n\n\t\t\tconst quad = this._quad;\n\n\t\t\tif ( this._nodes.hasOutputChange( renderTarget.texture ) ) {\n\n\t\t\t\tquad.material.fragmentNode = this._nodes.getOutputNode( renderTarget.texture );\n\t\t\t\tquad.material.needsUpdate = true;\n\n\t\t\t}\n\n\t\t\tthis._renderScene( quad, quad.camera, false );\n\n\t\t}\n\n\t}\n\n\tclearColor() {\n\n\t\treturn this.clear( true, false, false );\n\n\t}\n\n\tclearDepth() {\n\n\t\treturn this.clear( false, true, false );\n\n\t}\n\n\tclearStencil() {\n\n\t\treturn this.clear( false, false, true );\n\n\t}\n\n\tasync clearAsync( color = true, depth = true, stencil = true ) {\n\n\t\tif ( this._initialized === false ) await this.init();\n\n\t\tthis.clear( color, depth, stencil );\n\n\t}\n\n\tclearColorAsync() {\n\n\t\treturn this.clearAsync( true, false, false );\n\n\t}\n\n\tclearDepthAsync() {\n\n\t\treturn this.clearAsync( false, true, false );\n\n\t}\n\n\tclearStencilAsync() {\n\n\t\treturn this.clearAsync( false, false, true );\n\n\t}\n\n\tget currentToneMapping() {\n\n\t\treturn this._renderTarget !== null ? NoToneMapping : this.toneMapping;\n\n\t}\n\n\tget currentColorSpace() {\n\n\t\treturn this._renderTarget !== null ? LinearSRGBColorSpace : this.outputColorSpace;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.info.dispose();\n\t\tthis.backend.dispose();\n\n\t\tthis._animation.dispose();\n\t\tthis._objects.dispose();\n\t\tthis._pipelines.dispose();\n\t\tthis._nodes.dispose();\n\t\tthis._bindings.dispose();\n\t\tthis._renderLists.dispose();\n\t\tthis._renderContexts.dispose();\n\t\tthis._textures.dispose();\n\n\t\tthis.setRenderTarget( null );\n\t\tthis.setAnimationLoop( null );\n\n\t}\n\n\tsetRenderTarget( renderTarget, activeCubeFace = 0, activeMipmapLevel = 0 ) {\n\n\t\tthis._renderTarget = renderTarget;\n\t\tthis._activeCubeFace = activeCubeFace;\n\t\tthis._activeMipmapLevel = activeMipmapLevel;\n\n\t}\n\n\tgetRenderTarget() {\n\n\t\treturn this._renderTarget;\n\n\t}\n\n\tsetRenderObjectFunction( renderObjectFunction ) {\n\n\t\tthis._renderObjectFunction = renderObjectFunction;\n\n\t}\n\n\tgetRenderObjectFunction() {\n\n\t\treturn this._renderObjectFunction;\n\n\t}\n\n\tcompute( computeNodes ) {\n\n\t\tif ( this.isDeviceLost === true ) return;\n\n\t\tif ( this._initialized === false ) {\n\n\t\t\tconsole.warn( 'THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead.' );\n\n\t\t\treturn this.computeAsync( computeNodes );\n\n\t\t}\n\n\t\t//\n\n\t\tconst nodeFrame = this._nodes.nodeFrame;\n\n\t\tconst previousRenderId = nodeFrame.renderId;\n\n\t\t//\n\n\t\tthis.info.calls ++;\n\t\tthis.info.compute.calls ++;\n\t\tthis.info.compute.frameCalls ++;\n\n\t\tnodeFrame.renderId = this.info.calls;\n\n\t\t//\n\n\t\tconst backend = this.backend;\n\t\tconst pipelines = this._pipelines;\n\t\tconst bindings = this._bindings;\n\t\tconst nodes = this._nodes;\n\n\t\tconst computeList = Array.isArray( computeNodes ) ? computeNodes : [ computeNodes ];\n\n\t\tif ( computeList[ 0 ] === undefined || computeList[ 0 ].isComputeNode !== true ) {\n\n\t\t\tthrow new Error( 'THREE.Renderer: .compute() expects a ComputeNode.' );\n\n\t\t}\n\n\t\tbackend.beginCompute( computeNodes );\n\n\t\tfor ( const computeNode of computeList ) {\n\n\t\t\t// onInit\n\n\t\t\tif ( pipelines.has( computeNode ) === false ) {\n\n\t\t\t\tconst dispose = () => {\n\n\t\t\t\t\tcomputeNode.removeEventListener( 'dispose', dispose );\n\n\t\t\t\t\tpipelines.delete( computeNode );\n\t\t\t\t\tbindings.delete( computeNode );\n\t\t\t\t\tnodes.delete( computeNode );\n\n\t\t\t\t};\n\n\t\t\t\tcomputeNode.addEventListener( 'dispose', dispose );\n\n\t\t\t\t//\n\n\t\t\t\tconst onInitFn = computeNode.onInitFunction;\n\n\t\t\t\tif ( onInitFn !== null ) {\n\n\t\t\t\t\tonInitFn.call( computeNode, { renderer: this } );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tnodes.updateForCompute( computeNode );\n\t\t\tbindings.updateForCompute( computeNode );\n\n\t\t\tconst computeBindings = bindings.getForCompute( computeNode );\n\t\t\tconst computePipeline = pipelines.getForCompute( computeNode, computeBindings );\n\n\t\t\tbackend.compute( computeNodes, computeNode, computeBindings, computePipeline );\n\n\t\t}\n\n\t\tbackend.finishCompute( computeNodes );\n\n\t\t//\n\n\t\tnodeFrame.renderId = previousRenderId;\n\n\t}\n\n\tasync computeAsync( computeNodes ) {\n\n\t\tif ( this._initialized === false ) await this.init();\n\n\t\tthis.compute( computeNodes );\n\n\t\tawait this.backend.resolveTimestampAsync( computeNodes, 'compute' );\n\n\t}\n\n\tasync hasFeatureAsync( name ) {\n\n\t\tif ( this._initialized === false ) await this.init();\n\n\t\treturn this.backend.hasFeature( name );\n\n\t}\n\n\thasFeature( name ) {\n\n\t\tif ( this._initialized === false ) {\n\n\t\t\tconsole.warn( 'THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead.' );\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\treturn this.backend.hasFeature( name );\n\n\t}\n\n\thasInitialized() {\n\n\t\treturn this._initialized;\n\n\t}\n\n\tasync initTextureAsync( texture ) {\n\n\t\tif ( this._initialized === false ) await this.init();\n\n\t\tthis._textures.updateTexture( texture );\n\n\t}\n\n\tinitTexture( texture ) {\n\n\t\tif ( this._initialized === false ) {\n\n\t\t\tconsole.warn( 'THREE.Renderer: .initTexture() called before the backend is initialized. Try using .initTextureAsync() instead.' );\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\tthis._textures.updateTexture( texture );\n\n\t}\n\n\tcopyFramebufferToTexture( framebufferTexture, rectangle = null ) {\n\n\t\tif ( rectangle !== null ) {\n\n\t\t\tif ( rectangle.isVector2 ) {\n\n\t\t\t\trectangle = _vector4.set( rectangle.x, rectangle.y, framebufferTexture.image.width, framebufferTexture.image.height ).floor();\n\n\t\t\t} else if ( rectangle.isVector4 ) {\n\n\t\t\t\trectangle = _vector4.copy( rectangle ).floor();\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.' );\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\trectangle = _vector4.set( 0, 0, framebufferTexture.image.width, framebufferTexture.image.height );\n\n\t\t}\n\n\t\t//\n\n\t\tlet renderContext = this._currentRenderContext;\n\t\tlet renderTarget;\n\n\t\tif ( renderContext !== null ) {\n\n\t\t\trenderTarget = renderContext.renderTarget;\n\n\t\t} else {\n\n\t\t\trenderTarget = this._renderTarget || this._getFrameBufferTarget();\n\n\t\t\tif ( renderTarget !== null ) {\n\n\t\t\t\tthis._textures.updateRenderTarget( renderTarget );\n\n\t\t\t\trenderContext = this._textures.get( renderTarget );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tthis._textures.updateTexture( framebufferTexture, { renderTarget } );\n\n\t\tthis.backend.copyFramebufferToTexture( framebufferTexture, renderContext, rectangle );\n\n\t}\n\n\tcopyTextureToTexture( srcTexture, dstTexture, srcRegion = null, dstPosition = null, level = 0 ) {\n\n\t\tthis._textures.updateTexture( srcTexture );\n\t\tthis._textures.updateTexture( dstTexture );\n\n\t\tthis.backend.copyTextureToTexture( srcTexture, dstTexture, srcRegion, dstPosition, level );\n\n\t}\n\n\treadRenderTargetPixelsAsync( renderTarget, x, y, width, height, index = 0, faceIndex = 0 ) {\n\n\t\treturn this.backend.copyTextureToBuffer( renderTarget.textures[ index ], x, y, width, height, faceIndex );\n\n\t}\n\n\t_projectObject( object, camera, groupOrder, renderList, clippingContext ) {\n\n\t\tif ( object.visible === false ) return;\n\n\t\tconst visible = object.layers.test( camera.layers );\n\n\t\tif ( visible ) {\n\n\t\t\tif ( object.isGroup ) {\n\n\t\t\t\tgroupOrder = object.renderOrder;\n\n\t\t\t\tif ( object.isClippingGroup && object.enabled ) clippingContext = clippingContext.getGroupContext( object );\n\n\t\t\t} else if ( object.isLOD ) {\n\n\t\t\t\tif ( object.autoUpdate === true ) object.update( camera );\n\n\t\t\t} else if ( object.isLight ) {\n\n\t\t\t\trenderList.pushLight( object );\n\n\t\t\t} else if ( object.isSprite ) {\n\n\t\t\t\tif ( ! object.frustumCulled || _frustum.intersectsSprite( object ) ) {\n\n\t\t\t\t\tif ( this.sortObjects === true ) {\n\n\t\t\t\t\t\t_vector4.setFromMatrixPosition( object.matrixWorld ).applyMatrix4( _projScreenMatrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst { geometry, material } = object;\n\n\t\t\t\t\tif ( material.visible ) {\n\n\t\t\t\t\t\trenderList.push( object, geometry, material, groupOrder, _vector4.z, null, clippingContext );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( object.isLineLoop ) {\n\n\t\t\t\tconsole.error( 'THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.' );\n\n\t\t\t} else if ( object.isMesh || object.isLine || object.isPoints ) {\n\n\t\t\t\tif ( ! object.frustumCulled || _frustum.intersectsObject( object ) ) {\n\n\t\t\t\t\tconst { geometry, material } = object;\n\n\t\t\t\t\tif ( this.sortObjects === true ) {\n\n\t\t\t\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t\t\t\t\t_vector4\n\t\t\t\t\t\t\t.copy( geometry.boundingSphere.center )\n\t\t\t\t\t\t\t.applyMatrix4( object.matrixWorld )\n\t\t\t\t\t\t\t.applyMatrix4( _projScreenMatrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\t\tconst groups = geometry.groups;\n\n\t\t\t\t\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\t\t\tif ( groupMaterial && groupMaterial.visible ) {\n\n\t\t\t\t\t\t\t\trenderList.push( object, geometry, groupMaterial, groupOrder, _vector4.z, group, clippingContext );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( material.visible ) {\n\n\t\t\t\t\t\trenderList.push( object, geometry, material, groupOrder, _vector4.z, null, clippingContext );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( object.isBundleGroup === true && this.backend.beginBundle !== undefined ) {\n\n\t\t\tconst baseRenderList = renderList;\n\n\t\t\t// replace render list\n\t\t\trenderList = this._renderLists.get( object, camera );\n\n\t\t\trenderList.begin();\n\n\t\t\tbaseRenderList.pushBundle( {\n\t\t\t\tbundleGroup: object,\n\t\t\t\tcamera,\n\t\t\t\trenderList,\n\t\t\t} );\n\n\t\t\trenderList.finish();\n\n\t\t}\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tthis._projectObject( children[ i ], camera, groupOrder, renderList, clippingContext );\n\n\t\t}\n\n\t}\n\n\t_renderBundles( bundles, sceneRef, lightsNode ) {\n\n\t\tfor ( const bundle of bundles ) {\n\n\t\t\tthis._renderBundle( bundle, sceneRef, lightsNode );\n\n\t\t}\n\n\t}\n\n\t_renderTransparents( renderList, doublePassList, camera, scene, lightsNode ) {\n\n\t\tif ( doublePassList.length > 0 ) {\n\n\t\t\t// render back side\n\n\t\t\tfor ( const { material } of doublePassList ) {\n\n\t\t\t\tmaterial.side = BackSide;\n\n\t\t\t}\n\n\t\t\tthis._renderObjects( doublePassList, camera, scene, lightsNode, 'backSide' );\n\n\t\t\t// render front side\n\n\t\t\tfor ( const { material } of doublePassList ) {\n\n\t\t\t\tmaterial.side = FrontSide;\n\n\t\t\t}\n\n\t\t\tthis._renderObjects( renderList, camera, scene, lightsNode );\n\n\t\t\t// restore\n\n\t\t\tfor ( const { material } of doublePassList ) {\n\n\t\t\t\tmaterial.side = DoubleSide;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis._renderObjects( renderList, camera, scene, lightsNode );\n\n\t\t}\n\n\t}\n\n\t_renderObjects( renderList, camera, scene, lightsNode, passId = null ) {\n\n\t\t// process renderable objects\n\n\t\tfor ( let i = 0, il = renderList.length; i < il; i ++ ) {\n\n\t\t\tconst renderItem = renderList[ i ];\n\n\t\t\t// @TODO: Add support for multiple materials per object. This will require to extract\n\t\t\t// the material from the renderItem object and pass it with its group data to renderObject().\n\n\t\t\tconst { object, geometry, material, group, clippingContext } = renderItem;\n\n\t\t\tif ( camera.isArrayCamera ) {\n\n\t\t\t\tconst cameras = camera.cameras;\n\n\t\t\t\tfor ( let j = 0, jl = cameras.length; j < jl; j ++ ) {\n\n\t\t\t\t\tconst camera2 = cameras[ j ];\n\n\t\t\t\t\tif ( object.layers.test( camera2.layers ) ) {\n\n\t\t\t\t\t\tconst vp = camera2.viewport;\n\t\t\t\t\t\tconst minDepth = ( vp.minDepth === undefined ) ? 0 : vp.minDepth;\n\t\t\t\t\t\tconst maxDepth = ( vp.maxDepth === undefined ) ? 1 : vp.maxDepth;\n\n\t\t\t\t\t\tconst viewportValue = this._currentRenderContext.viewportValue;\n\t\t\t\t\t\tviewportValue.copy( vp ).multiplyScalar( this._pixelRatio ).floor();\n\t\t\t\t\t\tviewportValue.minDepth = minDepth;\n\t\t\t\t\t\tviewportValue.maxDepth = maxDepth;\n\n\t\t\t\t\t\tthis.backend.updateViewport( this._currentRenderContext );\n\n\t\t\t\t\t\tthis._currentRenderObjectFunction( object, scene, camera2, geometry, material, group, lightsNode, clippingContext, passId );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tthis._currentRenderObjectFunction( object, scene, camera, geometry, material, group, lightsNode, clippingContext, passId );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\trenderObject( object, scene, camera, geometry, material, group, lightsNode, clippingContext = null, passId = null ) {\n\n\t\tlet overridePositionNode;\n\t\tlet overrideColorNode;\n\t\tlet overrideDepthNode;\n\n\t\t//\n\n\t\tobject.onBeforeRender( this, scene, camera, geometry, material, group );\n\n\t\t//\n\n\t\tif ( scene.overrideMaterial !== null ) {\n\n\t\t\tconst overrideMaterial = scene.overrideMaterial;\n\n\t\t\tif ( material.positionNode && material.positionNode.isNode ) {\n\n\t\t\t\toverridePositionNode = overrideMaterial.positionNode;\n\t\t\t\toverrideMaterial.positionNode = material.positionNode;\n\n\t\t\t}\n\n\t\t\toverrideMaterial.alphaTest = material.alphaTest;\n\t\t\toverrideMaterial.alphaMap = material.alphaMap;\n\n\t\t\tif ( overrideMaterial.isShadowNodeMaterial ) {\n\n\t\t\t\toverrideMaterial.side = material.shadowSide === null ? material.side : material.shadowSide;\n\n\t\t\t\tif ( material.depthNode && material.depthNode.isNode ) {\n\n\t\t\t\t\toverrideDepthNode = overrideMaterial.depthNode;\n\t\t\t\t\toverrideMaterial.depthNode = material.depthNode;\n\n\t\t\t\t}\n\n\t\t\t\tif ( material.castShadowNode && material.castShadowNode.isNode ) {\n\n\t\t\t\t\toverrideColorNode = overrideMaterial.colorNode;\n\t\t\t\t\toverrideMaterial.colorNode = material.castShadowNode;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tmaterial = overrideMaterial;\n\n\t\t}\n\n\t\t//\n\n\t\tif ( material.transparent === true && material.side === DoubleSide && material.forceSinglePass === false ) {\n\n\t\t\tmaterial.side = BackSide;\n\t\t\tthis._handleObjectFunction( object, material, scene, camera, lightsNode, group, clippingContext, 'backSide' ); // create backSide pass id\n\n\t\t\tmaterial.side = FrontSide;\n\t\t\tthis._handleObjectFunction( object, material, scene, camera, lightsNode, group, clippingContext, passId ); // use default pass id\n\n\t\t\tmaterial.side = DoubleSide;\n\n\t\t} else {\n\n\t\t\tthis._handleObjectFunction( object, material, scene, camera, lightsNode, group, clippingContext, passId );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( overridePositionNode !== undefined ) {\n\n\t\t\tscene.overrideMaterial.positionNode = overridePositionNode;\n\n\t\t}\n\n\t\tif ( overrideDepthNode !== undefined ) {\n\n\t\t\tscene.overrideMaterial.depthNode = overrideDepthNode;\n\n\t\t}\n\n\t\tif ( overrideColorNode !== undefined ) {\n\n\t\t\tscene.overrideMaterial.colorNode = overrideColorNode;\n\n\t\t}\n\n\t\t//\n\n\t\tobject.onAfterRender( this, scene, camera, geometry, material, group );\n\n\t}\n\n\t_renderObjectDirect( object, material, scene, camera, lightsNode, group, clippingContext, passId ) {\n\n\t\tconst renderObject = this._objects.get( object, material, scene, camera, lightsNode, this._currentRenderContext, clippingContext, passId );\n\t\trenderObject.drawRange = object.geometry.drawRange;\n\t\trenderObject.group = group;\n\n\t\t//\n\n\t\tconst needsRefresh = this._nodes.needsRefresh( renderObject );\n\n\t\tif ( needsRefresh ) {\n\n\t\t\tthis._nodes.updateBefore( renderObject );\n\n\t\t\tthis._geometries.updateForRender( renderObject );\n\n\t\t\tthis._nodes.updateForRender( renderObject );\n\t\t\tthis._bindings.updateForRender( renderObject );\n\n\t\t}\n\n\t\tthis._pipelines.updateForRender( renderObject );\n\n\t\t//\n\n\t\tif ( this._currentRenderBundle !== null ) {\n\n\t\t\tconst renderBundleData = this.backend.get( this._currentRenderBundle );\n\n\t\t\trenderBundleData.renderObjects.push( renderObject );\n\n\t\t\trenderObject.bundle = this._currentRenderBundle.scene;\n\n\t\t}\n\n\t\tthis.backend.draw( renderObject, this.info );\n\n\t\tif ( needsRefresh ) this._nodes.updateAfter( renderObject );\n\n\t}\n\n\t_createObjectPipeline( object, material, scene, camera, lightsNode, clippingContext, passId ) {\n\n\t\tconst renderObject = this._objects.get( object, material, scene, camera, lightsNode, this._currentRenderContext, clippingContext, passId );\n\n\t\t//\n\n\t\tthis._nodes.updateBefore( renderObject );\n\n\t\tthis._geometries.updateForRender( renderObject );\n\n\t\tthis._nodes.updateForRender( renderObject );\n\t\tthis._bindings.updateForRender( renderObject );\n\n\t\tthis._pipelines.getForRender( renderObject, this._compilationPromises );\n\n\t\tthis._nodes.updateAfter( renderObject );\n\n\t}\n\n\tget compile() {\n\n\t\treturn this.compileAsync;\n\n\t}\n\n}\n\nclass Binding {\n\n\tconstructor( name = '' ) {\n\n\t\tthis.name = name;\n\n\t\tthis.visibility = 0;\n\n\t}\n\n\tsetVisibility( visibility ) {\n\n\t\tthis.visibility |= visibility;\n\n\t}\n\n\tclone() {\n\n\t\treturn Object.assign( new this.constructor(), this );\n\n\t}\n\n}\n\nfunction getFloatLength( floatLength ) {\n\n\t// ensure chunk size alignment (STD140 layout)\n\n\treturn floatLength + ( ( GPU_CHUNK_BYTES - ( floatLength % GPU_CHUNK_BYTES ) ) % GPU_CHUNK_BYTES );\n\n}\n\nclass Buffer extends Binding {\n\n\tconstructor( name, buffer = null ) {\n\n\t\tsuper( name );\n\n\t\tthis.isBuffer = true;\n\n\t\tthis.bytesPerElement = Float32Array.BYTES_PER_ELEMENT;\n\n\t\tthis._buffer = buffer;\n\n\t}\n\n\tget byteLength() {\n\n\t\treturn getFloatLength( this._buffer.byteLength );\n\n\t}\n\n\tget buffer() {\n\n\t\treturn this._buffer;\n\n\t}\n\n\tupdate() {\n\n\t\treturn true;\n\n\t}\n\n}\n\nclass UniformBuffer extends Buffer {\n\n\tconstructor( name, buffer = null ) {\n\n\t\tsuper( name, buffer );\n\n\t\tthis.isUniformBuffer = true;\n\n\t}\n\n}\n\nlet _id$4 = 0;\n\nclass NodeUniformBuffer extends UniformBuffer {\n\n\tconstructor( nodeUniform, groupNode ) {\n\n\t\tsuper( 'UniformBuffer_' + _id$4 ++, nodeUniform ? nodeUniform.value : null );\n\n\t\tthis.nodeUniform = nodeUniform;\n\t\tthis.groupNode = groupNode;\n\n\t}\n\n\tget buffer() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n}\n\nclass UniformsGroup extends UniformBuffer {\n\n\tconstructor( name ) {\n\n\t\tsuper( name );\n\n\t\tthis.isUniformsGroup = true;\n\n\t\tthis._values = null;\n\n\t\t// the order of uniforms in this array must match the order of uniforms in the shader\n\n\t\tthis.uniforms = [];\n\n\t}\n\n\taddUniform( uniform ) {\n\n\t\tthis.uniforms.push( uniform );\n\n\t\treturn this;\n\n\t}\n\n\tremoveUniform( uniform ) {\n\n\t\tconst index = this.uniforms.indexOf( uniform );\n\n\t\tif ( index !== - 1 ) {\n\n\t\t\tthis.uniforms.splice( index, 1 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tget values() {\n\n\t\tif ( this._values === null ) {\n\n\t\t\tthis._values = Array.from( this.buffer );\n\n\t\t}\n\n\t\treturn this._values;\n\n\t}\n\n\tget buffer() {\n\n\t\tlet buffer = this._buffer;\n\n\t\tif ( buffer === null ) {\n\n\t\t\tconst byteLength = this.byteLength;\n\n\t\t\tbuffer = new Float32Array( new ArrayBuffer( byteLength ) );\n\n\t\t\tthis._buffer = buffer;\n\n\t\t}\n\n\t\treturn buffer;\n\n\t}\n\n\tget byteLength() {\n\n\t\tlet offset = 0; // global buffer offset in bytes\n\n\t\tfor ( let i = 0, l = this.uniforms.length; i < l; i ++ ) {\n\n\t\t\tconst uniform = this.uniforms[ i ];\n\n\t\t\tconst { boundary, itemSize } = uniform;\n\n\t\t\t// offset within a single chunk in bytes\n\n\t\t\tconst chunkOffset = offset % GPU_CHUNK_BYTES;\n\t\t\tconst remainingSizeInChunk = GPU_CHUNK_BYTES - chunkOffset;\n\n\t\t\t// conformance tests\n\n\t\t\tif ( chunkOffset !== 0 && ( remainingSizeInChunk - boundary ) < 0 ) {\n\n\t\t\t\t// check for chunk overflow\n\n\t\t\t\toffset += ( GPU_CHUNK_BYTES - chunkOffset );\n\n\t\t\t} else if ( chunkOffset % boundary !== 0 ) {\n\n\t\t\t\t// check for correct alignment\n\n\t\t\t\toffset += ( chunkOffset % boundary );\n\n\t\t\t}\n\n\t\t\tuniform.offset = ( offset / this.bytesPerElement );\n\n\t\t\toffset += ( itemSize * this.bytesPerElement );\n\n\t\t}\n\n\t\treturn Math.ceil( offset / GPU_CHUNK_BYTES ) * GPU_CHUNK_BYTES;\n\n\t}\n\n\tupdate() {\n\n\t\tlet updated = false;\n\n\t\tfor ( const uniform of this.uniforms ) {\n\n\t\t\tif ( this.updateByType( uniform ) === true ) {\n\n\t\t\t\tupdated = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n\tupdateByType( uniform ) {\n\n\t\tif ( uniform.isNumberUniform ) return this.updateNumber( uniform );\n\t\tif ( uniform.isVector2Uniform ) return this.updateVector2( uniform );\n\t\tif ( uniform.isVector3Uniform ) return this.updateVector3( uniform );\n\t\tif ( uniform.isVector4Uniform ) return this.updateVector4( uniform );\n\t\tif ( uniform.isColorUniform ) return this.updateColor( uniform );\n\t\tif ( uniform.isMatrix3Uniform ) return this.updateMatrix3( uniform );\n\t\tif ( uniform.isMatrix4Uniform ) return this.updateMatrix4( uniform );\n\n\t\tconsole.error( 'THREE.WebGPUUniformsGroup: Unsupported uniform type.', uniform );\n\n\t}\n\n\tupdateNumber( uniform ) {\n\n\t\tlet updated = false;\n\n\t\tconst a = this.values;\n\t\tconst v = uniform.getValue();\n\t\tconst offset = uniform.offset;\n\t\tconst type = uniform.getType();\n\n\t\tif ( a[ offset ] !== v ) {\n\n\t\t\tconst b = this._getBufferForType( type );\n\n\t\t\tb[ offset ] = a[ offset ] = v;\n\t\t\tupdated = true;\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n\tupdateVector2( uniform ) {\n\n\t\tlet updated = false;\n\n\t\tconst a = this.values;\n\t\tconst v = uniform.getValue();\n\t\tconst offset = uniform.offset;\n\t\tconst type = uniform.getType();\n\n\t\tif ( a[ offset + 0 ] !== v.x || a[ offset + 1 ] !== v.y ) {\n\n\t\t\tconst b = this._getBufferForType( type );\n\n\t\t\tb[ offset + 0 ] = a[ offset + 0 ] = v.x;\n\t\t\tb[ offset + 1 ] = a[ offset + 1 ] = v.y;\n\n\t\t\tupdated = true;\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n\tupdateVector3( uniform ) {\n\n\t\tlet updated = false;\n\n\t\tconst a = this.values;\n\t\tconst v = uniform.getValue();\n\t\tconst offset = uniform.offset;\n\t\tconst type = uniform.getType();\n\n\t\tif ( a[ offset + 0 ] !== v.x || a[ offset + 1 ] !== v.y || a[ offset + 2 ] !== v.z ) {\n\n\t\t\tconst b = this._getBufferForType( type );\n\n\t\t\tb[ offset + 0 ] = a[ offset + 0 ] = v.x;\n\t\t\tb[ offset + 1 ] = a[ offset + 1 ] = v.y;\n\t\t\tb[ offset + 2 ] = a[ offset + 2 ] = v.z;\n\n\t\t\tupdated = true;\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n\tupdateVector4( uniform ) {\n\n\t\tlet updated = false;\n\n\t\tconst a = this.values;\n\t\tconst v = uniform.getValue();\n\t\tconst offset = uniform.offset;\n\t\tconst type = uniform.getType();\n\n\t\tif ( a[ offset + 0 ] !== v.x || a[ offset + 1 ] !== v.y || a[ offset + 2 ] !== v.z || a[ offset + 4 ] !== v.w ) {\n\n\t\t\tconst b = this._getBufferForType( type );\n\n\t\t\tb[ offset + 0 ] = a[ offset + 0 ] = v.x;\n\t\t\tb[ offset + 1 ] = a[ offset + 1 ] = v.y;\n\t\t\tb[ offset + 2 ] = a[ offset + 2 ] = v.z;\n\t\t\tb[ offset + 3 ] = a[ offset + 3 ] = v.w;\n\n\t\t\tupdated = true;\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n\tupdateColor( uniform ) {\n\n\t\tlet updated = false;\n\n\t\tconst a = this.values;\n\t\tconst c = uniform.getValue();\n\t\tconst offset = uniform.offset;\n\n\t\tif ( a[ offset + 0 ] !== c.r || a[ offset + 1 ] !== c.g || a[ offset + 2 ] !== c.b ) {\n\n\t\t\tconst b = this.buffer;\n\n\t\t\tb[ offset + 0 ] = a[ offset + 0 ] = c.r;\n\t\t\tb[ offset + 1 ] = a[ offset + 1 ] = c.g;\n\t\t\tb[ offset + 2 ] = a[ offset + 2 ] = c.b;\n\n\t\t\tupdated = true;\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n\tupdateMatrix3( uniform ) {\n\n\t\tlet updated = false;\n\n\t\tconst a = this.values;\n\t\tconst e = uniform.getValue().elements;\n\t\tconst offset = uniform.offset;\n\n\t\tif ( a[ offset + 0 ] !== e[ 0 ] || a[ offset + 1 ] !== e[ 1 ] || a[ offset + 2 ] !== e[ 2 ] ||\n\t\t\ta[ offset + 4 ] !== e[ 3 ] || a[ offset + 5 ] !== e[ 4 ] || a[ offset + 6 ] !== e[ 5 ] ||\n\t\t\ta[ offset + 8 ] !== e[ 6 ] || a[ offset + 9 ] !== e[ 7 ] || a[ offset + 10 ] !== e[ 8 ] ) {\n\n\t\t\tconst b = this.buffer;\n\n\t\t\tb[ offset + 0 ] = a[ offset + 0 ] = e[ 0 ];\n\t\t\tb[ offset + 1 ] = a[ offset + 1 ] = e[ 1 ];\n\t\t\tb[ offset + 2 ] = a[ offset + 2 ] = e[ 2 ];\n\t\t\tb[ offset + 4 ] = a[ offset + 4 ] = e[ 3 ];\n\t\t\tb[ offset + 5 ] = a[ offset + 5 ] = e[ 4 ];\n\t\t\tb[ offset + 6 ] = a[ offset + 6 ] = e[ 5 ];\n\t\t\tb[ offset + 8 ] = a[ offset + 8 ] = e[ 6 ];\n\t\t\tb[ offset + 9 ] = a[ offset + 9 ] = e[ 7 ];\n\t\t\tb[ offset + 10 ] = a[ offset + 10 ] = e[ 8 ];\n\n\t\t\tupdated = true;\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n\tupdateMatrix4( uniform ) {\n\n\t\tlet updated = false;\n\n\t\tconst a = this.values;\n\t\tconst e = uniform.getValue().elements;\n\t\tconst offset = uniform.offset;\n\n\t\tif ( arraysEqual( a, e, offset ) === false ) {\n\n\t\t\tconst b = this.buffer;\n\t\t\tb.set( e, offset );\n\t\t\tsetArray( a, e, offset );\n\t\t\tupdated = true;\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n\t_getBufferForType( type ) {\n\n\t\tif ( type === 'int' || type === 'ivec2' || type === 'ivec3' || type === 'ivec4' ) return new Int32Array( this.buffer.buffer );\n\t\tif ( type === 'uint' || type === 'uvec2' || type === 'uvec3' || type === 'uvec4' ) return new Uint32Array( this.buffer.buffer );\n\t\treturn this.buffer;\n\n\t}\n\n}\n\nfunction setArray( a, b, offset ) {\n\n\tfor ( let i = 0, l = b.length; i < l; i ++ ) {\n\n\t\ta[ offset + i ] = b[ i ];\n\n\t}\n\n}\n\nfunction arraysEqual( a, b, offset ) {\n\n\tfor ( let i = 0, l = b.length; i < l; i ++ ) {\n\n\t\tif ( a[ offset + i ] !== b[ i ] ) return false;\n\n\t}\n\n\treturn true;\n\n}\n\nlet _id$3 = 0;\n\nclass NodeUniformsGroup extends UniformsGroup {\n\n\tconstructor( name, groupNode ) {\n\n\t\tsuper( name );\n\n\t\tthis.id = _id$3 ++;\n\t\tthis.groupNode = groupNode;\n\n\t\tthis.isNodeUniformsGroup = true;\n\n\t}\n\n\tgetNodes() {\n\n\t\tconst nodes = [];\n\n\t\tfor ( const uniform of this.uniforms ) {\n\n\t\t\tconst node = uniform.nodeUniform.node;\n\n\t\t\tif ( ! node ) throw new Error( 'NodeUniformsGroup: Uniform has no node.' );\n\n\t\t\tnodes.push( node );\n\n\t\t}\n\n\t\treturn nodes;\n\n\t}\n\n}\n\nlet _id$2 = 0;\n\nclass SampledTexture extends Binding {\n\n\tconstructor( name, texture ) {\n\n\t\tsuper( name );\n\n\t\tthis.id = _id$2 ++;\n\n\t\tthis.texture = texture;\n\t\tthis.version = texture ? texture.version : 0;\n\t\tthis.store = false;\n\t\tthis.generation = null;\n\n\t\tthis.isSampledTexture = true;\n\n\t}\n\n\tneedsBindingsUpdate( generation ) {\n\n\t\tconst { texture } = this;\n\n\t\tif ( generation !== this.generation ) {\n\n\t\t\tthis.generation = generation;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn texture.isVideoTexture;\n\n\t}\n\n\tupdate() {\n\n\t\tconst { texture, version } = this;\n\n\t\tif ( version !== texture.version ) {\n\n\t\t\tthis.version = texture.version;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n}\n\nclass NodeSampledTexture extends SampledTexture {\n\n\tconstructor( name, textureNode, groupNode, access = null ) {\n\n\t\tsuper( name, textureNode ? textureNode.value : null );\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.groupNode = groupNode;\n\n\t\tthis.access = access;\n\n\t}\n\n\tneedsBindingsUpdate( generation ) {\n\n\t\treturn this.textureNode.value !== this.texture || super.needsBindingsUpdate( generation );\n\n\t}\n\n\tupdate() {\n\n\t\tconst { textureNode } = this;\n\n\t\tif ( this.texture !== textureNode.value ) {\n\n\t\t\tthis.texture = textureNode.value;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn super.update();\n\n\t}\n\n}\n\nclass NodeSampledCubeTexture extends NodeSampledTexture {\n\n\tconstructor( name, textureNode, groupNode, access ) {\n\n\t\tsuper( name, textureNode, groupNode, access );\n\n\t\tthis.isSampledCubeTexture = true;\n\n\t}\n\n}\n\nclass NodeSampledTexture3D extends NodeSampledTexture {\n\n\tconstructor( name, textureNode, groupNode, access ) {\n\n\t\tsuper( name, textureNode, groupNode, access );\n\n\t\tthis.isSampledTexture3D = true;\n\n\t}\n\n}\n\nconst glslMethods = {\n\tatan2: 'atan',\n\ttextureDimensions: 'textureSize',\n\tequals: 'equal'\n};\n\nconst precisionLib = {\n\tlow: 'lowp',\n\tmedium: 'mediump',\n\thigh: 'highp'\n};\n\nconst supports$1 = {\n\tswizzleAssign: true,\n\tstorageBuffer: false\n};\n\nconst defaultPrecisions = `\nprecision highp float;\nprecision highp int;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp sampler2DArray;\n\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\n\nprecision lowp sampler2DShadow;\n`;\n\nclass GLSLNodeBuilder extends NodeBuilder {\n\n\tconstructor( object, renderer ) {\n\n\t\tsuper( object, renderer, new GLSLNodeParser() );\n\n\t\tthis.uniformGroups = {};\n\t\tthis.transforms = [];\n\t\tthis.extensions = {};\n\t\tthis.builtins = { vertex: [], fragment: [], compute: [] };\n\n\t\tthis.useComparisonMethod = true;\n\n\t}\n\n\tneedsToWorkingColorSpace( texture ) {\n\n\t\treturn texture.isVideoTexture === true && texture.colorSpace !== NoColorSpace;\n\n\t}\n\n\tgetMethod( method ) {\n\n\t\treturn glslMethods[ method ] || method;\n\n\t}\n\n\tgetOutputStructName() {\n\n\t\treturn '';\n\n\t}\n\n\tbuildFunctionCode( shaderNode ) {\n\n\t\tconst layout = shaderNode.layout;\n\t\tconst flowData = this.flowShaderNode( shaderNode );\n\n\t\tconst parameters = [];\n\n\t\tfor ( const input of layout.inputs ) {\n\n\t\t\tparameters.push( this.getType( input.type ) + ' ' + input.name );\n\n\t\t}\n\n\t\t//\n\n\t\tconst code = `${ this.getType( layout.type ) } ${ layout.name }( ${ parameters.join( ', ' ) } ) {\n\n\t${ flowData.vars }\n\n${ flowData.code }\n\treturn ${ flowData.result };\n\n}`;\n\n\t\t//\n\n\t\treturn code;\n\n\t}\n\n\tsetupPBO( storageBufferNode ) {\n\n\t\tconst attribute = storageBufferNode.value;\n\n\t\tif ( attribute.pbo === undefined ) {\n\n\t\t\tconst originalArray = attribute.array;\n\t\t\tconst numElements = attribute.count * attribute.itemSize;\n\n\t\t\tconst { itemSize } = attribute;\n\n\t\t\tconst isInteger = attribute.array.constructor.name.toLowerCase().includes( 'int' );\n\n\t\t\tlet format = isInteger ? RedIntegerFormat : RedFormat;\n\n\t\t\tif ( itemSize === 2 ) {\n\n\t\t\t\tformat = isInteger ? RGIntegerFormat : RGFormat;\n\n\t\t\t} else if ( itemSize === 3 ) {\n\n\t\t\t\tformat = isInteger ? RGBIntegerFormat : RGBFormat;\n\n\t\t\t} else if ( itemSize === 4 ) {\n\n\t\t\t\tformat = isInteger ? RGBAIntegerFormat : RGBAFormat;\n\n\t\t\t}\n\n\t\t\tconst typeMap = {\n\t\t\t\tFloat32Array: FloatType,\n\t\t\t\tUint8Array: UnsignedByteType,\n\t\t\t\tUint16Array: UnsignedShortType,\n\t\t\t\tUint32Array: UnsignedIntType,\n\t\t\t\tInt8Array: ByteType,\n\t\t\t\tInt16Array: ShortType,\n\t\t\t\tInt32Array: IntType,\n\t\t\t\tUint8ClampedArray: UnsignedByteType,\n\t\t\t};\n\n\t\t\tconst width = Math.pow( 2, Math.ceil( Math.log2( Math.sqrt( numElements / itemSize ) ) ) );\n\t\t\tlet height = Math.ceil( ( numElements / itemSize ) / width );\n\t\t\tif ( width * height * itemSize < numElements ) height ++; // Ensure enough space\n\n\t\t\tconst newSize = width * height * itemSize;\n\n\t\t\tconst newArray = new originalArray.constructor( newSize );\n\n\t\t\tnewArray.set( originalArray, 0 );\n\n\t\t\tattribute.array = newArray;\n\n\t\t\tconst pboTexture = new DataTexture( attribute.array, width, height, format, typeMap[ attribute.array.constructor.name ] || FloatType );\n\t\t\tpboTexture.needsUpdate = true;\n\t\t\tpboTexture.isPBOTexture = true;\n\n\t\t\tconst pbo = new TextureNode( pboTexture, null, null );\n\t\t\tpbo.setPrecision( 'high' );\n\n\t\t\tattribute.pboNode = pbo;\n\t\t\tattribute.pbo = pbo.value;\n\n\t\t\tthis.getUniformFromNode( attribute.pboNode, 'texture', this.shaderStage, this.context.label );\n\n\t\t}\n\n\t}\n\n\tgetPropertyName( node, shaderStage = this.shaderStage ) {\n\n\t\tif ( node.isNodeUniform && node.node.isTextureNode !== true && node.node.isBufferNode !== true ) {\n\n\t\t\treturn shaderStage.charAt( 0 ) + '_' + node.name;\n\n\t\t}\n\n\t\treturn super.getPropertyName( node, shaderStage );\n\n\t}\n\n\tgeneratePBO( storageArrayElementNode ) {\n\n\t\tconst { node, indexNode } = storageArrayElementNode;\n\t\tconst attribute = node.value;\n\n\t\tif ( this.renderer.backend.has( attribute ) ) {\n\n\t\t\tconst attributeData = this.renderer.backend.get( attribute );\n\t\t\tattributeData.pbo = attribute.pbo;\n\n\t\t}\n\n\t\tconst nodeUniform = this.getUniformFromNode( attribute.pboNode, 'texture', this.shaderStage, this.context.label );\n\t\tconst textureName = this.getPropertyName( nodeUniform );\n\n\t\tthis.increaseUsage( indexNode ); // force cache generate to be used as index in x,y\n\t\tconst indexSnippet = indexNode.build( this, 'uint' );\n\n\t\tconst elementNodeData = this.getDataFromNode( storageArrayElementNode );\n\n\t\tlet propertyName = elementNodeData.propertyName;\n\n\t\tif ( propertyName === undefined ) {\n\n\t\t\t// property element\n\n\t\t\tconst nodeVar = this.getVarFromNode( storageArrayElementNode );\n\n\t\t\tpropertyName = this.getPropertyName( nodeVar );\n\n\t\t\t// property size\n\n\t\t\tconst bufferNodeData = this.getDataFromNode( node );\n\n\t\t\tlet propertySizeName = bufferNodeData.propertySizeName;\n\n\t\t\tif ( propertySizeName === undefined ) {\n\n\t\t\t\tpropertySizeName = propertyName + 'Size';\n\n\t\t\t\tthis.getVarFromNode( node, propertySizeName, 'uint' );\n\n\t\t\t\tthis.addLineFlowCode( `${ propertySizeName } = uint( textureSize( ${ textureName }, 0 ).x )`, storageArrayElementNode );\n\n\t\t\t\tbufferNodeData.propertySizeName = propertySizeName;\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tconst { itemSize } = attribute;\n\n\t\t\tconst channel = '.' + vectorComponents.join( '' ).slice( 0, itemSize );\n\t\t\tconst uvSnippet = `ivec2(${indexSnippet} % ${ propertySizeName }, ${indexSnippet} / ${ propertySizeName })`;\n\n\t\t\tconst snippet = this.generateTextureLoad( null, textureName, uvSnippet, null, '0' );\n\n\t\t\t//\n\n\n\t\t\tlet prefix = 'vec4';\n\n\t\t\tif ( attribute.pbo.type === UnsignedIntType ) {\n\n\t\t\t\tprefix = 'uvec4';\n\n\t\t\t} else if ( attribute.pbo.type === IntType ) {\n\n\t\t\t\tprefix = 'ivec4';\n\n\t\t\t}\n\n\t\t\tthis.addLineFlowCode( `${ propertyName } = ${prefix}(${ snippet })${channel}`, storageArrayElementNode );\n\n\t\t\telementNodeData.propertyName = propertyName;\n\n\t\t}\n\n\t\treturn propertyName;\n\n\t}\n\n\tgenerateTextureLoad( texture, textureProperty, uvIndexSnippet, depthSnippet, levelSnippet = '0' ) {\n\n\t\tif ( depthSnippet ) {\n\n\t\t\treturn `texelFetch( ${ textureProperty }, ivec3( ${ uvIndexSnippet }, ${ depthSnippet } ), ${ levelSnippet } )`;\n\n\t\t} else {\n\n\t\t\treturn `texelFetch( ${ textureProperty }, ${ uvIndexSnippet }, ${ levelSnippet } )`;\n\n\t\t}\n\n\t}\n\n\tgenerateTexture( texture, textureProperty, uvSnippet, depthSnippet ) {\n\n\t\tif ( texture.isDepthTexture ) {\n\n\t\t\treturn `texture( ${ textureProperty }, ${ uvSnippet } ).x`;\n\n\t\t} else {\n\n\t\t\tif ( depthSnippet ) uvSnippet = `vec3( ${ uvSnippet }, ${ depthSnippet } )`;\n\n\t\t\treturn `texture( ${ textureProperty }, ${ uvSnippet } )`;\n\n\t\t}\n\n\t}\n\n\tgenerateTextureLevel( texture, textureProperty, uvSnippet, levelSnippet ) {\n\n\t\treturn `textureLod( ${ textureProperty }, ${ uvSnippet }, ${ levelSnippet } )`;\n\n\t}\n\n\tgenerateTextureBias( texture, textureProperty, uvSnippet, biasSnippet ) {\n\n\t\treturn `texture( ${ textureProperty }, ${ uvSnippet }, ${ biasSnippet } )`;\n\n\t}\n\n\tgenerateTextureGrad( texture, textureProperty, uvSnippet, gradSnippet ) {\n\n\t\treturn `textureGrad( ${ textureProperty }, ${ uvSnippet }, ${ gradSnippet[ 0 ] }, ${ gradSnippet[ 1 ] } )`;\n\n\t}\n\n\tgenerateTextureCompare( texture, textureProperty, uvSnippet, compareSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tif ( shaderStage === 'fragment' ) {\n\n\t\t\treturn `texture( ${ textureProperty }, vec3( ${ uvSnippet }, ${ compareSnippet } ) )`;\n\n\t\t} else {\n\n\t\t\tconsole.error( `WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${ shaderStage } shader.` );\n\n\t\t}\n\n\t}\n\n\tgetVars( shaderStage ) {\n\n\t\tconst snippets = [];\n\n\t\tconst vars = this.vars[ shaderStage ];\n\n\t\tif ( vars !== undefined ) {\n\n\t\t\tfor ( const variable of vars ) {\n\n\t\t\t\tsnippets.push( `${ this.getVar( variable.type, variable.name ) };` );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn snippets.join( '\\n\\t' );\n\n\t}\n\n\tgetUniforms( shaderStage ) {\n\n\t\tconst uniforms = this.uniforms[ shaderStage ];\n\n\t\tconst bindingSnippets = [];\n\t\tconst uniformGroups = {};\n\n\t\tfor ( const uniform of uniforms ) {\n\n\t\t\tlet snippet = null;\n\t\t\tlet group = false;\n\n\t\t\tif ( uniform.type === 'texture' ) {\n\n\t\t\t\tconst texture = uniform.node.value;\n\n\t\t\t\tlet typePrefix = '';\n\n\t\t\t\tif ( texture.isDataTexture === true ) {\n\n\n\t\t\t\t\tif ( texture.type === UnsignedIntType ) {\n\n\t\t\t\t\t\ttypePrefix = 'u';\n\n\t\t\t\t\t} else if ( texture.type === IntType ) {\n\n\t\t\t\t\t\ttypePrefix = 'i';\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( texture.compareFunction ) {\n\n\t\t\t\t\tsnippet = `sampler2DShadow ${ uniform.name };`;\n\n\t\t\t\t} else if ( texture.isDataArrayTexture === true || texture.isCompressedArrayTexture === true ) {\n\n\t\t\t\t\tsnippet = `${typePrefix}sampler2DArray ${ uniform.name };`;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tsnippet = `${typePrefix}sampler2D ${ uniform.name };`;\n\n\t\t\t\t}\n\n\t\t\t} else if ( uniform.type === 'cubeTexture' ) {\n\n\t\t\t\tsnippet = `samplerCube ${ uniform.name };`;\n\n\t\t\t} else if ( uniform.type === 'texture3D' ) {\n\n\t\t\t\tsnippet = `sampler3D ${ uniform.name };`;\n\n\t\t\t} else if ( uniform.type === 'buffer' ) {\n\n\t\t\t\tconst bufferNode = uniform.node;\n\t\t\t\tconst bufferType = this.getType( bufferNode.bufferType );\n\t\t\t\tconst bufferCount = bufferNode.bufferCount;\n\n\t\t\t\tconst bufferCountSnippet = bufferCount > 0 ? bufferCount : '';\n\t\t\t\tsnippet = `${bufferNode.name} {\\n\\t${ bufferType } ${ uniform.name }[${ bufferCountSnippet }];\\n};\\n`;\n\n\t\t\t} else {\n\n\t\t\t\tconst vectorType = this.getVectorType( uniform.type );\n\n\t\t\t\tsnippet = `${ vectorType } ${ this.getPropertyName( uniform, shaderStage ) };`;\n\n\t\t\t\tgroup = true;\n\n\t\t\t}\n\n\t\t\tconst precision = uniform.node.precision;\n\n\t\t\tif ( precision !== null ) {\n\n\t\t\t\tsnippet = precisionLib[ precision ] + ' ' + snippet;\n\n\t\t\t}\n\n\t\t\tif ( group ) {\n\n\t\t\t\tsnippet = '\\t' + snippet;\n\n\t\t\t\tconst groupName = uniform.groupNode.name;\n\t\t\t\tconst groupSnippets = uniformGroups[ groupName ] || ( uniformGroups[ groupName ] = [] );\n\n\t\t\t\tgroupSnippets.push( snippet );\n\n\t\t\t} else {\n\n\t\t\t\tsnippet = 'uniform ' + snippet;\n\n\t\t\t\tbindingSnippets.push( snippet );\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet output = '';\n\n\t\tfor ( const name in uniformGroups ) {\n\n\t\t\tconst groupSnippets = uniformGroups[ name ];\n\n\t\t\toutput += this._getGLSLUniformStruct( shaderStage + '_' + name, groupSnippets.join( '\\n' ) ) + '\\n';\n\n\t\t}\n\n\t\toutput += bindingSnippets.join( '\\n' );\n\n\t\treturn output;\n\n\t}\n\n\tgetTypeFromAttribute( attribute ) {\n\n\t\tlet nodeType = super.getTypeFromAttribute( attribute );\n\n\t\tif ( /^[iu]/.test( nodeType ) && attribute.gpuType !== IntType ) {\n\n\t\t\tlet dataAttribute = attribute;\n\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) dataAttribute = attribute.data;\n\n\t\t\tconst array = dataAttribute.array;\n\n\t\t\tif ( ( array instanceof Uint32Array || array instanceof Int32Array ) === false ) {\n\n\t\t\t\tnodeType = nodeType.slice( 1 );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn nodeType;\n\n\t}\n\n\tgetAttributes( shaderStage ) {\n\n\t\tlet snippet = '';\n\n\t\tif ( shaderStage === 'vertex' || shaderStage === 'compute' ) {\n\n\t\t\tconst attributes = this.getAttributesArray();\n\n\t\t\tlet location = 0;\n\n\t\t\tfor ( const attribute of attributes ) {\n\n\t\t\t\tsnippet += `layout( location = ${ location ++ } ) in ${ attribute.type } ${ attribute.name };\\n`;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tgetStructMembers( struct ) {\n\n\t\tconst snippets = [];\n\t\tconst members = struct.getMemberTypes();\n\n\t\tfor ( let i = 0; i < members.length; i ++ ) {\n\n\t\t\tconst member = members[ i ];\n\t\t\tsnippets.push( `layout( location = ${i} ) out ${ member} m${i};` );\n\n\t\t}\n\n\t\treturn snippets.join( '\\n' );\n\n\t}\n\n\tgetStructs( shaderStage ) {\n\n\t\tconst snippets = [];\n\t\tconst structs = this.structs[ shaderStage ];\n\n\t\tif ( structs.length === 0 ) {\n\n\t\t\treturn 'layout( location = 0 ) out vec4 fragColor;\\n';\n\n\t\t}\n\n\t\tfor ( let index = 0, length = structs.length; index < length; index ++ ) {\n\n\t\t\tconst struct = structs[ index ];\n\n\t\t\tlet snippet = '\\n';\n\t\t\tsnippet += this.getStructMembers( struct );\n\t\t\tsnippet += '\\n';\n\n\t\t\tsnippets.push( snippet );\n\n\t\t}\n\n\t\treturn snippets.join( '\\n\\n' );\n\n\t}\n\n\tgetVaryings( shaderStage ) {\n\n\t\tlet snippet = '';\n\n\t\tconst varyings = this.varyings;\n\n\t\tif ( shaderStage === 'vertex' || shaderStage === 'compute' ) {\n\n\t\t\tfor ( const varying of varyings ) {\n\n\t\t\t\tif ( shaderStage === 'compute' ) varying.needsInterpolation = true;\n\t\t\t\tconst type = this.getType( varying.type );\n\t\t\t\tconst flat = type.includes( 'int' ) || type.includes( 'uv' ) || type.includes( 'iv' ) ? 'flat ' : '';\n\n\t\t\t\tsnippet += `${flat}${varying.needsInterpolation ? 'out' : '/*out*/'} ${type} ${varying.name};\\n`;\n\n\t\t\t}\n\n\t\t} else if ( shaderStage === 'fragment' ) {\n\n\t\t\tfor ( const varying of varyings ) {\n\n\t\t\t\tif ( varying.needsInterpolation ) {\n\n\t\t\t\t\tconst type = this.getType( varying.type );\n\t\t\t\t\tconst flat = type.includes( 'int' ) || type.includes( 'uv' ) || type.includes( 'iv' ) ? 'flat ' : '';\n\n\t\t\t\t\tsnippet += `${flat}in ${type} ${varying.name};\\n`;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( const builtin of this.builtins[ shaderStage ] ) {\n\n\t\t\tsnippet += `${builtin};\\n`;\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tgetVertexIndex() {\n\n\t\treturn 'uint( gl_VertexID )';\n\n\t}\n\n\tgetInstanceIndex() {\n\n\t\treturn 'uint( gl_InstanceID )';\n\n\t}\n\n\tgetInvocationLocalIndex() {\n\n\t\tconst workgroupSize = this.object.workgroupSize;\n\n\t\tconst size = workgroupSize.reduce( ( acc, curr ) => acc * curr, 1 );\n\n\t\treturn `uint( gl_InstanceID ) % ${size}u`;\n\n\t}\n\n\tgetDrawIndex() {\n\n\t\tconst extensions = this.renderer.backend.extensions;\n\n\t\tif ( extensions.has( 'WEBGL_multi_draw' ) ) {\n\n\t\t\treturn 'uint( gl_DrawID )';\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tgetFrontFacing() {\n\n\t\treturn 'gl_FrontFacing';\n\n\t}\n\n\tgetFragCoord() {\n\n\t\treturn 'gl_FragCoord.xy';\n\n\t}\n\n\tgetFragDepth() {\n\n\t\treturn 'gl_FragDepth';\n\n\t}\n\n\tenableExtension( name, behavior, shaderStage = this.shaderStage ) {\n\n\t\tconst map = this.extensions[ shaderStage ] || ( this.extensions[ shaderStage ] = new Map() );\n\n\t\tif ( map.has( name ) === false ) {\n\n\t\t\tmap.set( name, {\n\t\t\t\tname,\n\t\t\t\tbehavior\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tgetExtensions( shaderStage ) {\n\n\t\tconst snippets = [];\n\n\t\tif ( shaderStage === 'vertex' ) {\n\n\t\t\tconst ext = this.renderer.backend.extensions;\n\t\t\tconst isBatchedMesh = this.object.isBatchedMesh;\n\n\t\t\tif ( isBatchedMesh && ext.has( 'WEBGL_multi_draw' ) ) {\n\n\t\t\t\tthis.enableExtension( 'GL_ANGLE_multi_draw', 'require', shaderStage );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst extensions = this.extensions[ shaderStage ];\n\n\t\tif ( extensions !== undefined ) {\n\n\t\t\tfor ( const { name, behavior } of extensions.values() ) {\n\n\t\t\t\tsnippets.push( `#extension ${name} : ${behavior}` );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn snippets.join( '\\n' );\n\n\t}\n\n\tgetClipDistance() {\n\n\t\treturn 'gl_ClipDistance';\n\n\t}\n\n\tisAvailable( name ) {\n\n\t\tlet result = supports$1[ name ];\n\n\t\tif ( result === undefined ) {\n\n\t\t\tlet extensionName;\n\n\t\t\tresult = false;\n\n\t\t\tswitch ( name ) {\n\n\t\t\t\tcase 'float32Filterable':\n\t\t\t\t\textensionName = 'OES_texture_float_linear';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'clipDistance':\n\t\t\t\t\textensionName = 'WEBGL_clip_cull_distance';\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( extensionName !== undefined ) {\n\n\t\t\t\tconst extensions = this.renderer.backend.extensions;\n\n\t\t\t\tif ( extensions.has( extensionName ) ) {\n\n\t\t\t\t\textensions.get( extensionName );\n\t\t\t\t\tresult = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tsupports$1[ name ] = result;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tisFlipY() {\n\n\t\treturn true;\n\n\t}\n\n\tenableHardwareClipping( planeCount ) {\n\n\t\tthis.enableExtension( 'GL_ANGLE_clip_cull_distance', 'require' );\n\n\t\tthis.builtins[ 'vertex' ].push( `out float gl_ClipDistance[ ${ planeCount } ]` );\n\n\t}\n\n\tregisterTransform( varyingName, attributeNode ) {\n\n\t\tthis.transforms.push( { varyingName, attributeNode } );\n\n\t}\n\n\tgetTransforms( /* shaderStage  */ ) {\n\n\t\tconst transforms = this.transforms;\n\n\t\tlet snippet = '';\n\n\t\tfor ( let i = 0; i < transforms.length; i ++ ) {\n\n\t\t\tconst transform = transforms[ i ];\n\n\t\t\tconst attributeName = this.getPropertyName( transform.attributeNode );\n\n\t\t\tsnippet += `${ transform.varyingName } = ${ attributeName };\\n\\t`;\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\t_getGLSLUniformStruct( name, vars ) {\n\n\t\treturn `\nlayout( std140 ) uniform ${name} {\n${vars}\n};`;\n\n\t}\n\n\t_getGLSLVertexCode( shaderData ) {\n\n\t\treturn `#version 300 es\n\n${ this.getSignature() }\n\n// extensions \n${shaderData.extensions}\n\n// precision\n${ defaultPrecisions }\n\n// uniforms\n${shaderData.uniforms}\n\n// varyings\n${shaderData.varyings}\n\n// attributes\n${shaderData.attributes}\n\n// codes\n${shaderData.codes}\n\nvoid main() {\n\n\t// vars\n\t${shaderData.vars}\n\n\t// transforms\n\t${shaderData.transforms}\n\n\t// flow\n\t${shaderData.flow}\n\n\tgl_PointSize = 1.0;\n\n}\n`;\n\n\t}\n\n\t_getGLSLFragmentCode( shaderData ) {\n\n\t\treturn `#version 300 es\n\n${ this.getSignature() }\n\n// precision\n${ defaultPrecisions }\n\n// uniforms\n${shaderData.uniforms}\n\n// varyings\n${shaderData.varyings}\n\n// codes\n${shaderData.codes}\n\n${shaderData.structs}\n\nvoid main() {\n\n\t// vars\n\t${shaderData.vars}\n\n\t// flow\n\t${shaderData.flow}\n\n}\n`;\n\n\t}\n\n\tbuildCode() {\n\n\t\tconst shadersData = this.material !== null ? { fragment: {}, vertex: {} } : { compute: {} };\n\n\t\tthis.sortBindingGroups();\n\n\t\tfor ( const shaderStage in shadersData ) {\n\n\t\t\tlet flow = '// code\\n\\n';\n\t\t\tflow += this.flowCode[ shaderStage ];\n\n\t\t\tconst flowNodes = this.flowNodes[ shaderStage ];\n\t\t\tconst mainNode = flowNodes[ flowNodes.length - 1 ];\n\n\t\t\tfor ( const node of flowNodes ) {\n\n\t\t\t\tconst flowSlotData = this.getFlowData( node/*, shaderStage*/ );\n\t\t\t\tconst slotName = node.name;\n\n\t\t\t\tif ( slotName ) {\n\n\t\t\t\t\tif ( flow.length > 0 ) flow += '\\n';\n\n\t\t\t\t\tflow += `\\t// flow -> ${ slotName }\\n\\t`;\n\n\t\t\t\t}\n\n\t\t\t\tflow += `${ flowSlotData.code }\\n\\t`;\n\n\t\t\t\tif ( node === mainNode && shaderStage !== 'compute' ) {\n\n\t\t\t\t\tflow += '// result\\n\\t';\n\n\t\t\t\t\tif ( shaderStage === 'vertex' ) {\n\n\t\t\t\t\t\tflow += 'gl_Position = ';\n\t\t\t\t\t\tflow += `${ flowSlotData.result };`;\n\n\t\t\t\t\t} else if ( shaderStage === 'fragment' ) {\n\n\t\t\t\t\t\tif ( ! node.outputNode.isOutputStructNode ) {\n\n\t\t\t\t\t\t\tflow += 'fragColor = ';\n\t\t\t\t\t\t\tflow += `${ flowSlotData.result };`;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst stageData = shadersData[ shaderStage ];\n\n\t\t\tstageData.extensions = this.getExtensions( shaderStage );\n\t\t\tstageData.uniforms = this.getUniforms( shaderStage );\n\t\t\tstageData.attributes = this.getAttributes( shaderStage );\n\t\t\tstageData.varyings = this.getVaryings( shaderStage );\n\t\t\tstageData.vars = this.getVars( shaderStage );\n\t\t\tstageData.structs = this.getStructs( shaderStage );\n\t\t\tstageData.codes = this.getCodes( shaderStage );\n\t\t\tstageData.transforms = this.getTransforms( shaderStage );\n\t\t\tstageData.flow = flow;\n\n\t\t}\n\n\t\tif ( this.material !== null ) {\n\n\t\t\tthis.vertexShader = this._getGLSLVertexCode( shadersData.vertex );\n\t\t\tthis.fragmentShader = this._getGLSLFragmentCode( shadersData.fragment );\n\n\t\t} else {\n\n\t\t\tthis.computeShader = this._getGLSLVertexCode( shadersData.compute );\n\n\t\t}\n\n\t}\n\n\tgetUniformFromNode( node, type, shaderStage, name = null ) {\n\n\t\tconst uniformNode = super.getUniformFromNode( node, type, shaderStage, name );\n\t\tconst nodeData = this.getDataFromNode( node, shaderStage, this.globalCache );\n\n\t\tlet uniformGPU = nodeData.uniformGPU;\n\n\t\tif ( uniformGPU === undefined ) {\n\n\t\t\tconst group = node.groupNode;\n\t\t\tconst groupName = group.name;\n\n\t\t\tconst bindings = this.getBindGroupArray( groupName, shaderStage );\n\n\t\t\tif ( type === 'texture' ) {\n\n\t\t\t\tuniformGPU = new NodeSampledTexture( uniformNode.name, uniformNode.node, group );\n\t\t\t\tbindings.push( uniformGPU );\n\n\t\t\t} else if ( type === 'cubeTexture' ) {\n\n\t\t\t\tuniformGPU = new NodeSampledCubeTexture( uniformNode.name, uniformNode.node, group );\n\t\t\t\tbindings.push( uniformGPU );\n\n\t\t\t} else if ( type === 'texture3D' ) {\n\n\t\t\t\tuniformGPU = new NodeSampledTexture3D( uniformNode.name, uniformNode.node, group );\n\t\t\t\tbindings.push( uniformGPU );\n\n\t\t\t} else if ( type === 'buffer' ) {\n\n\t\t\t\tnode.name = `NodeBuffer_${ node.id }`;\n\t\t\t\tuniformNode.name = `buffer${ node.id }`;\n\n\t\t\t\tconst buffer = new NodeUniformBuffer( node, group );\n\t\t\t\tbuffer.name = node.name;\n\n\t\t\t\tbindings.push( buffer );\n\n\t\t\t\tuniformGPU = buffer;\n\n\t\t\t} else {\n\n\t\t\t\tconst uniformsStage = this.uniformGroups[ shaderStage ] || ( this.uniformGroups[ shaderStage ] = {} );\n\n\t\t\t\tlet uniformsGroup = uniformsStage[ groupName ];\n\n\t\t\t\tif ( uniformsGroup === undefined ) {\n\n\t\t\t\t\tuniformsGroup = new NodeUniformsGroup( shaderStage + '_' + groupName, group );\n\t\t\t\t\t//uniformsGroup.setVisibility( gpuShaderStageLib[ shaderStage ] );\n\n\t\t\t\t\tuniformsStage[ groupName ] = uniformsGroup;\n\n\t\t\t\t\tbindings.push( uniformsGroup );\n\n\t\t\t\t}\n\n\t\t\t\tuniformGPU = this.getNodeUniform( uniformNode, type );\n\n\t\t\t\tuniformsGroup.addUniform( uniformGPU );\n\n\t\t\t}\n\n\t\t\tnodeData.uniformGPU = uniformGPU;\n\n\t\t}\n\n\t\treturn uniformNode;\n\n\t}\n\n}\n\nlet vector2 = null;\nlet vector4 = null;\nlet color4 = null;\n\nclass Backend {\n\n\tconstructor( parameters = {} ) {\n\n\t\tthis.parameters = Object.assign( {}, parameters );\n\t\tthis.data = new WeakMap();\n\t\tthis.renderer = null;\n\t\tthis.domElement = null;\n\n\t}\n\n\tasync init( renderer ) {\n\n\t\tthis.renderer = renderer;\n\n\t}\n\n\t// render context\n\n\tbegin( /*renderContext*/ ) { }\n\n\tfinish( /*renderContext*/ ) { }\n\n\t// render object\n\n\tdraw( /*renderObject, info*/ ) { }\n\n\t// program\n\n\tcreateProgram( /*program*/ ) { }\n\n\tdestroyProgram( /*program*/ ) { }\n\n\t// bindings\n\n\tcreateBindings( /*bingGroup, bindings*/ ) { }\n\n\tupdateBindings( /*bingGroup, bindings*/ ) { }\n\n\t// pipeline\n\n\tcreateRenderPipeline( /*renderObject*/ ) { }\n\n\tcreateComputePipeline( /*computeNode, pipeline*/ ) { }\n\n\tdestroyPipeline( /*pipeline*/ ) { }\n\n\t// cache key\n\n\tneedsRenderUpdate( /*renderObject*/ ) { } // return Boolean ( fast test )\n\n\tgetRenderCacheKey( /*renderObject*/ ) { } // return String\n\n\t// node builder\n\n\tcreateNodeBuilder( /*renderObject*/ ) { } // return NodeBuilder (ADD IT)\n\n\t// textures\n\n\tcreateSampler( /*texture*/ ) { }\n\n\tcreateDefaultTexture( /*texture*/ ) { }\n\n\tcreateTexture( /*texture*/ ) { }\n\n\tcopyTextureToBuffer( /*texture, x, y, width, height*/ ) {}\n\n\t// attributes\n\n\tcreateAttribute( /*attribute*/ ) { }\n\n\tcreateIndexAttribute( /*attribute*/ ) { }\n\n\tupdateAttribute( /*attribute*/ ) { }\n\n\tdestroyAttribute( /*attribute*/ ) { }\n\n\t// canvas\n\n\tgetContext() { }\n\n\tupdateSize() { }\n\n\t// utils\n\n\tresolveTimestampAsync( /*renderContext, type*/ ) { }\n\n\thasFeatureAsync( /*name*/ ) { } // return Boolean\n\n\thasFeature( /*name*/ ) { } // return Boolean\n\n\tgetInstanceCount( renderObject ) {\n\n\t\tconst { object, geometry } = renderObject;\n\n\t\treturn geometry.isInstancedBufferGeometry ? geometry.instanceCount : ( object.count > 1 ? object.count : 1 );\n\n\t}\n\n\tgetDrawingBufferSize() {\n\n\t\tvector2 = vector2 || new Vector2();\n\n\t\treturn this.renderer.getDrawingBufferSize( vector2 );\n\n\t}\n\n\tgetScissor() {\n\n\t\tvector4 = vector4 || new Vector4();\n\n\t\treturn this.renderer.getScissor( vector4 );\n\n\t}\n\n\tsetScissorTest( /*boolean*/ ) { }\n\n\tgetClearColor() {\n\n\t\tconst renderer = this.renderer;\n\n\t\tcolor4 = color4 || new Color4();\n\n\t\trenderer.getClearColor( color4 );\n\n\t\tcolor4.getRGB( color4, this.renderer.currentColorSpace );\n\n\t\treturn color4;\n\n\t}\n\n\tgetDomElement() {\n\n\t\tlet domElement = this.domElement;\n\n\t\tif ( domElement === null ) {\n\n\t\t\tdomElement = ( this.parameters.canvas !== undefined ) ? this.parameters.canvas : createCanvasElement();\n\n\t\t\t// OffscreenCanvas does not have setAttribute, see #22811\n\t\t\tif ( 'setAttribute' in domElement ) domElement.setAttribute( 'data-engine', `three.js r${REVISION} webgpu` );\n\n\t\t\tthis.domElement = domElement;\n\n\t\t}\n\n\t\treturn domElement;\n\n\t}\n\n\t// resource properties\n\n\tset( object, value ) {\n\n\t\tthis.data.set( object, value );\n\n\t}\n\n\tget( object ) {\n\n\t\tlet map = this.data.get( object );\n\n\t\tif ( map === undefined ) {\n\n\t\t\tmap = {};\n\t\t\tthis.data.set( object, map );\n\n\t\t}\n\n\t\treturn map;\n\n\t}\n\n\thas( object ) {\n\n\t\treturn this.data.has( object );\n\n\t}\n\n\tdelete( object ) {\n\n\t\tthis.data.delete( object );\n\n\t}\n\n\tdispose() { }\n\n}\n\nlet _id$1 = 0;\n\nclass DualAttributeData {\n\n\tconstructor( attributeData, dualBuffer ) {\n\n\t\tthis.buffers = [ attributeData.bufferGPU, dualBuffer ];\n\t\tthis.type = attributeData.type;\n\t\tthis.bufferType = attributeData.bufferType;\n\t\tthis.pbo = attributeData.pbo;\n\t\tthis.byteLength = attributeData.byteLength;\n\t\tthis.bytesPerElement = attributeData.BYTES_PER_ELEMENT;\n\t\tthis.version = attributeData.version;\n\t\tthis.isInteger = attributeData.isInteger;\n\t\tthis.activeBufferIndex = 0;\n\t\tthis.baseId = attributeData.id;\n\n\t}\n\n\n\tget id() {\n\n\t\treturn `${ this.baseId }|${ this.activeBufferIndex }`;\n\n\t}\n\n\tget bufferGPU() {\n\n\t\treturn this.buffers[ this.activeBufferIndex ];\n\n\t}\n\n\tget transformBuffer() {\n\n\t\treturn this.buffers[ this.activeBufferIndex ^ 1 ];\n\n\t}\n\n\tswitchBuffers() {\n\n\t\tthis.activeBufferIndex ^= 1;\n\n\t}\n\n}\n\nclass WebGLAttributeUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t}\n\n\tcreateAttribute( attribute, bufferType ) {\n\n\t\tconst backend = this.backend;\n\t\tconst { gl } = backend;\n\n\t\tconst array = attribute.array;\n\t\tconst usage = attribute.usage || gl.STATIC_DRAW;\n\n\t\tconst bufferAttribute = attribute.isInterleavedBufferAttribute ? attribute.data : attribute;\n\t\tconst bufferData = backend.get( bufferAttribute );\n\n\t\tlet bufferGPU = bufferData.bufferGPU;\n\n\t\tif ( bufferGPU === undefined ) {\n\n\t\t\tbufferGPU = this._createBuffer( gl, bufferType, array, usage );\n\n\t\t\tbufferData.bufferGPU = bufferGPU;\n\t\t\tbufferData.bufferType = bufferType;\n\t\t\tbufferData.version = bufferAttribute.version;\n\n\t\t}\n\n\t\t//attribute.onUploadCallback();\n\n\t\tlet type;\n\n\t\tif ( array instanceof Float32Array ) {\n\n\t\t\ttype = gl.FLOAT;\n\n\t\t} else if ( array instanceof Uint16Array ) {\n\n\t\t\tif ( attribute.isFloat16BufferAttribute ) {\n\n\t\t\t\ttype = gl.HALF_FLOAT;\n\n\t\t\t} else {\n\n\t\t\t\ttype = gl.UNSIGNED_SHORT;\n\n\t\t\t}\n\n\t\t} else if ( array instanceof Int16Array ) {\n\n\t\t\ttype = gl.SHORT;\n\n\t\t} else if ( array instanceof Uint32Array ) {\n\n\t\t\ttype = gl.UNSIGNED_INT;\n\n\t\t} else if ( array instanceof Int32Array ) {\n\n\t\t\ttype = gl.INT;\n\n\t\t} else if ( array instanceof Int8Array ) {\n\n\t\t\ttype = gl.BYTE;\n\n\t\t} else if ( array instanceof Uint8Array ) {\n\n\t\t\ttype = gl.UNSIGNED_BYTE;\n\n\t\t} else if ( array instanceof Uint8ClampedArray ) {\n\n\t\t\ttype = gl.UNSIGNED_BYTE;\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.WebGLBackend: Unsupported buffer data format: ' + array );\n\n\t\t}\n\n\t\tlet attributeData = {\n\t\t\tbufferGPU,\n\t\t\tbufferType,\n\t\t\ttype,\n\t\t\tbyteLength: array.byteLength,\n\t\t\tbytesPerElement: array.BYTES_PER_ELEMENT,\n\t\t\tversion: attribute.version,\n\t\t\tpbo: attribute.pbo,\n\t\t\tisInteger: type === gl.INT || type === gl.UNSIGNED_INT || attribute.gpuType === IntType,\n\t\t\tid: _id$1 ++\n\t\t};\n\n\t\tif ( attribute.isStorageBufferAttribute || attribute.isStorageInstancedBufferAttribute ) {\n\n\t\t\t// create buffer for tranform feedback use\n\t\t\tconst bufferGPUDual = this._createBuffer( gl, bufferType, array, usage );\n\t\t\tattributeData = new DualAttributeData( attributeData, bufferGPUDual );\n\n\t\t}\n\n\t\tbackend.set( attribute, attributeData );\n\n\t}\n\n\tupdateAttribute( attribute ) {\n\n\t\tconst backend = this.backend;\n\t\tconst { gl } = backend;\n\n\t\tconst array = attribute.array;\n\t\tconst bufferAttribute = attribute.isInterleavedBufferAttribute ? attribute.data : attribute;\n\t\tconst bufferData = backend.get( bufferAttribute );\n\t\tconst bufferType = bufferData.bufferType;\n\t\tconst updateRanges = attribute.isInterleavedBufferAttribute ? attribute.data.updateRanges : attribute.updateRanges;\n\n\t\tgl.bindBuffer( bufferType, bufferData.bufferGPU );\n\n\t\tif ( updateRanges.length === 0 ) {\n\n\t\t\t// Not using update ranges\n\n\t\t\tgl.bufferSubData( bufferType, 0, array );\n\n\t\t} else {\n\n\t\t\tfor ( let i = 0, l = updateRanges.length; i < l; i ++ ) {\n\n\t\t\t\tconst range = updateRanges[ i ];\n\t\t\t\tgl.bufferSubData( bufferType, range.start * array.BYTES_PER_ELEMENT,\n\t\t\t\t\tarray, range.start, range.count );\n\n\t\t\t}\n\n\t\t\tbufferAttribute.clearUpdateRanges();\n\n\t\t}\n\n\t\tgl.bindBuffer( bufferType, null );\n\n\t\tbufferData.version = bufferAttribute.version;\n\n\t}\n\n\tdestroyAttribute( attribute ) {\n\n\t\tconst backend = this.backend;\n\t\tconst { gl } = backend;\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tbackend.delete( attribute.data );\n\n\t\t}\n\n\t\tconst attributeData = backend.get( attribute );\n\n\t\tgl.deleteBuffer( attributeData.bufferGPU );\n\n\t\tbackend.delete( attribute );\n\n\t}\n\n\tasync getArrayBufferAsync( attribute ) {\n\n\t\tconst backend = this.backend;\n\t\tconst { gl } = backend;\n\n\t\tconst bufferAttribute = attribute.isInterleavedBufferAttribute ? attribute.data : attribute;\n\t\tconst { bufferGPU } = backend.get( bufferAttribute );\n\n\t\tconst array = attribute.array;\n\t\tconst byteLength = array.byteLength;\n\n\t\tgl.bindBuffer( gl.COPY_READ_BUFFER, bufferGPU );\n\n\t\tconst writeBuffer = gl.createBuffer();\n\n\t\tgl.bindBuffer( gl.COPY_WRITE_BUFFER, writeBuffer );\n\t\tgl.bufferData( gl.COPY_WRITE_BUFFER, byteLength, gl.STREAM_READ );\n\n\t\tgl.copyBufferSubData( gl.COPY_READ_BUFFER, gl.COPY_WRITE_BUFFER, 0, 0, byteLength );\n\n\t\tawait backend.utils._clientWaitAsync();\n\n\t\tconst dstBuffer = new attribute.array.constructor( array.length );\n\n\t\t// Ensure the buffer is bound before reading\n\t\tgl.bindBuffer( gl.COPY_WRITE_BUFFER, writeBuffer );\n\n\t\tgl.getBufferSubData( gl.COPY_WRITE_BUFFER, 0, dstBuffer );\n\n\t\tgl.deleteBuffer( writeBuffer );\n\n\t\tgl.bindBuffer( gl.COPY_READ_BUFFER, null );\n\t\tgl.bindBuffer( gl.COPY_WRITE_BUFFER, null );\n\n\t\treturn dstBuffer.buffer;\n\n\t}\n\n\t_createBuffer( gl, bufferType, array, usage ) {\n\n\t\tconst bufferGPU = gl.createBuffer();\n\n\t\tgl.bindBuffer( bufferType, bufferGPU );\n\t\tgl.bufferData( bufferType, array, usage );\n\t\tgl.bindBuffer( bufferType, null );\n\n\t\treturn bufferGPU;\n\n\t}\n\n}\n\nlet initialized$1 = false, equationToGL, factorToGL;\n\nclass WebGLState {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t\tthis.gl = this.backend.gl;\n\n\t\tthis.enabled = {};\n\t\tthis.currentFlipSided = null;\n\t\tthis.currentCullFace = null;\n\t\tthis.currentProgram = null;\n\t\tthis.currentBlendingEnabled = false;\n\t\tthis.currentBlending = null;\n\t\tthis.currentBlendSrc = null;\n\t\tthis.currentBlendDst = null;\n\t\tthis.currentBlendSrcAlpha = null;\n\t\tthis.currentBlendDstAlpha = null;\n\t\tthis.currentPremultipledAlpha = null;\n\t\tthis.currentPolygonOffsetFactor = null;\n\t\tthis.currentPolygonOffsetUnits = null;\n\t\tthis.currentColorMask = null;\n\t\tthis.currentDepthFunc = null;\n\t\tthis.currentDepthMask = null;\n\t\tthis.currentStencilFunc = null;\n\t\tthis.currentStencilRef = null;\n\t\tthis.currentStencilFuncMask = null;\n\t\tthis.currentStencilFail = null;\n\t\tthis.currentStencilZFail = null;\n\t\tthis.currentStencilZPass = null;\n\t\tthis.currentStencilMask = null;\n\t\tthis.currentLineWidth = null;\n\t\tthis.currentClippingPlanes = 0;\n\n\t\tthis.currentBoundFramebuffers = {};\n\t\tthis.currentDrawbuffers = new WeakMap();\n\n\t\tthis.maxTextures = this.gl.getParameter( this.gl.MAX_TEXTURE_IMAGE_UNITS );\n\t\tthis.currentTextureSlot = null;\n\t\tthis.currentBoundTextures = {};\n\t\tthis.currentBoundBufferBases = {};\n\n\t\tif ( initialized$1 === false ) {\n\n\t\t\tthis._init( this.gl );\n\n\t\t\tinitialized$1 = true;\n\n\t\t}\n\n\t}\n\n\t_init( gl ) {\n\n\t\t// Store only WebGL constants here.\n\n\t\tequationToGL = {\n\t\t\t[ AddEquation ]: gl.FUNC_ADD,\n\t\t\t[ SubtractEquation ]: gl.FUNC_SUBTRACT,\n\t\t\t[ ReverseSubtractEquation ]: gl.FUNC_REVERSE_SUBTRACT\n\t\t};\n\n\t\tfactorToGL = {\n\t\t\t[ ZeroFactor ]: gl.ZERO,\n\t\t\t[ OneFactor ]: gl.ONE,\n\t\t\t[ SrcColorFactor ]: gl.SRC_COLOR,\n\t\t\t[ SrcAlphaFactor ]: gl.SRC_ALPHA,\n\t\t\t[ SrcAlphaSaturateFactor ]: gl.SRC_ALPHA_SATURATE,\n\t\t\t[ DstColorFactor ]: gl.DST_COLOR,\n\t\t\t[ DstAlphaFactor ]: gl.DST_ALPHA,\n\t\t\t[ OneMinusSrcColorFactor ]: gl.ONE_MINUS_SRC_COLOR,\n\t\t\t[ OneMinusSrcAlphaFactor ]: gl.ONE_MINUS_SRC_ALPHA,\n\t\t\t[ OneMinusDstColorFactor ]: gl.ONE_MINUS_DST_COLOR,\n\t\t\t[ OneMinusDstAlphaFactor ]: gl.ONE_MINUS_DST_ALPHA\n\t\t};\n\n\t}\n\n\tenable( id ) {\n\n\t\tconst { enabled } = this;\n\n\t\tif ( enabled[ id ] !== true ) {\n\n\t\t\tthis.gl.enable( id );\n\t\t\tenabled[ id ] = true;\n\n\t\t}\n\n\t}\n\n\tdisable( id ) {\n\n\t\tconst { enabled } = this;\n\n\t\tif ( enabled[ id ] !== false ) {\n\n\t\t\tthis.gl.disable( id );\n\t\t\tenabled[ id ] = false;\n\n\t\t}\n\n\t}\n\n\tsetFlipSided( flipSided ) {\n\n\t\tif ( this.currentFlipSided !== flipSided ) {\n\n\t\t\tconst { gl } = this;\n\n\t\t\tif ( flipSided ) {\n\n\t\t\t\tgl.frontFace( gl.CW );\n\n\t\t\t} else {\n\n\t\t\t\tgl.frontFace( gl.CCW );\n\n\t\t\t}\n\n\t\t\tthis.currentFlipSided = flipSided;\n\n\t\t}\n\n\t}\n\n\tsetCullFace( cullFace ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( cullFace !== CullFaceNone ) {\n\n\t\t\tthis.enable( gl.CULL_FACE );\n\n\t\t\tif ( cullFace !== this.currentCullFace ) {\n\n\t\t\t\tif ( cullFace === CullFaceBack ) {\n\n\t\t\t\t\tgl.cullFace( gl.BACK );\n\n\t\t\t\t} else if ( cullFace === CullFaceFront ) {\n\n\t\t\t\t\tgl.cullFace( gl.FRONT );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tgl.cullFace( gl.FRONT_AND_BACK );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis.disable( gl.CULL_FACE );\n\n\t\t}\n\n\t\tthis.currentCullFace = cullFace;\n\n\t}\n\n\tsetLineWidth( width ) {\n\n\t\tconst { currentLineWidth, gl } = this;\n\n\t\tif ( width !== currentLineWidth ) {\n\n\t\t\tgl.lineWidth( width );\n\n\t\t\tthis.currentLineWidth = width;\n\n\t\t}\n\n\t}\n\n\n\tsetBlending( blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha, premultipliedAlpha ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( blending === NoBlending ) {\n\n\t\t\tif ( this.currentBlendingEnabled === true ) {\n\n\t\t\t\tthis.disable( gl.BLEND );\n\t\t\t\tthis.currentBlendingEnabled = false;\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( this.currentBlendingEnabled === false ) {\n\n\t\t\tthis.enable( gl.BLEND );\n\t\t\tthis.currentBlendingEnabled = true;\n\n\t\t}\n\n\t\tif ( blending !== CustomBlending ) {\n\n\t\t\tif ( blending !== this.currentBlending || premultipliedAlpha !== this.currentPremultipledAlpha ) {\n\n\t\t\t\tif ( this.currentBlendEquation !== AddEquation || this.currentBlendEquationAlpha !== AddEquation ) {\n\n\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\n\n\t\t\t\t\tthis.currentBlendEquation = AddEquation;\n\t\t\t\t\tthis.currentBlendEquationAlpha = AddEquation;\n\n\t\t\t\t}\n\n\t\t\t\tif ( premultipliedAlpha ) {\n\n\t\t\t\t\tswitch ( blending ) {\n\n\t\t\t\t\t\tcase NormalBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.ONE, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase AdditiveBlending:\n\t\t\t\t\t\t\tgl.blendFunc( gl.ONE, gl.ONE );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase SubtractiveBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.ONE_MINUS_SRC_COLOR, gl.ZERO, gl.ONE );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase MultiplyBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.SRC_COLOR, gl.ZERO, gl.SRC_ALPHA );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLState: Invalid blending: ', blending );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tswitch ( blending ) {\n\n\t\t\t\t\t\tcase NormalBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase AdditiveBlending:\n\t\t\t\t\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase SubtractiveBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.ONE_MINUS_SRC_COLOR, gl.ZERO, gl.ONE );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase MultiplyBlending:\n\t\t\t\t\t\t\tgl.blendFunc( gl.ZERO, gl.SRC_COLOR );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLState: Invalid blending: ', blending );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tthis.currentBlendSrc = null;\n\t\t\t\tthis.currentBlendDst = null;\n\t\t\t\tthis.currentBlendSrcAlpha = null;\n\t\t\t\tthis.currentBlendDstAlpha = null;\n\n\t\t\t\tthis.currentBlending = blending;\n\t\t\t\tthis.currentPremultipledAlpha = premultipliedAlpha;\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// custom blending\n\n\t\tblendEquationAlpha = blendEquationAlpha || blendEquation;\n\t\tblendSrcAlpha = blendSrcAlpha || blendSrc;\n\t\tblendDstAlpha = blendDstAlpha || blendDst;\n\n\t\tif ( blendEquation !== this.currentBlendEquation || blendEquationAlpha !== this.currentBlendEquationAlpha ) {\n\n\t\t\tgl.blendEquationSeparate( equationToGL[ blendEquation ], equationToGL[ blendEquationAlpha ] );\n\n\t\t\tthis.currentBlendEquation = blendEquation;\n\t\t\tthis.currentBlendEquationAlpha = blendEquationAlpha;\n\n\t\t}\n\n\t\tif ( blendSrc !== this.currentBlendSrc || blendDst !== this.currentBlendDst || blendSrcAlpha !== this.currentBlendSrcAlpha || blendDstAlpha !== this.currentBlendDstAlpha ) {\n\n\t\t\tgl.blendFuncSeparate( factorToGL[ blendSrc ], factorToGL[ blendDst ], factorToGL[ blendSrcAlpha ], factorToGL[ blendDstAlpha ] );\n\n\t\t\tthis.currentBlendSrc = blendSrc;\n\t\t\tthis.currentBlendDst = blendDst;\n\t\t\tthis.currentBlendSrcAlpha = blendSrcAlpha;\n\t\t\tthis.currentBlendDstAlpha = blendDstAlpha;\n\n\t\t}\n\n\t\tthis.currentBlending = blending;\n\t\tthis.currentPremultipledAlpha = false;\n\n\t}\n\n\tsetColorMask( colorMask ) {\n\n\t\tif ( this.currentColorMask !== colorMask ) {\n\n\t\t\tthis.gl.colorMask( colorMask, colorMask, colorMask, colorMask );\n\t\t\tthis.currentColorMask = colorMask;\n\n\t\t}\n\n\t}\n\n\tsetDepthTest( depthTest ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( depthTest ) {\n\n\t\t\tthis.enable( gl.DEPTH_TEST );\n\n\t\t} else {\n\n\t\t\tthis.disable( gl.DEPTH_TEST );\n\n\t\t}\n\n\t}\n\n\tsetDepthMask( depthMask ) {\n\n\t\tif ( this.currentDepthMask !== depthMask ) {\n\n\t\t\tthis.gl.depthMask( depthMask );\n\t\t\tthis.currentDepthMask = depthMask;\n\n\t\t}\n\n\t}\n\n\tsetDepthFunc( depthFunc ) {\n\n\t\tif ( this.currentDepthFunc !== depthFunc ) {\n\n\t\t\tconst { gl } = this;\n\n\t\t\tswitch ( depthFunc ) {\n\n\t\t\t\tcase NeverDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.NEVER );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AlwaysDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.ALWAYS );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase LessDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.LESS );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase LessEqualDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase EqualDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.EQUAL );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase GreaterEqualDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.GEQUAL );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase GreaterDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.GREATER );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase NotEqualDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.NOTEQUAL );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\n\n\t\t\t}\n\n\t\t\tthis.currentDepthFunc = depthFunc;\n\n\t\t}\n\n\t}\n\n\tsetStencilTest( stencilTest ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( stencilTest ) {\n\n\t\t\tthis.enable( gl.STENCIL_TEST );\n\n\t\t} else {\n\n\t\t\tthis.disable( gl.STENCIL_TEST );\n\n\t\t}\n\n\t}\n\n\tsetStencilMask( stencilMask ) {\n\n\t\tif ( this.currentStencilMask !== stencilMask ) {\n\n\t\t\tthis.gl.stencilMask( stencilMask );\n\t\t\tthis.currentStencilMask = stencilMask;\n\n\t\t}\n\n\t}\n\n\tsetStencilFunc( stencilFunc, stencilRef, stencilMask ) {\n\n\t\tif ( this.currentStencilFunc !== stencilFunc ||\n\t\t\t this.currentStencilRef !== stencilRef ||\n\t\t\t this.currentStencilFuncMask !== stencilMask ) {\n\n\t\t\tthis.gl.stencilFunc( stencilFunc, stencilRef, stencilMask );\n\n\t\t\tthis.currentStencilFunc = stencilFunc;\n\t\t\tthis.currentStencilRef = stencilRef;\n\t\t\tthis.currentStencilFuncMask = stencilMask;\n\n\t\t}\n\n\t}\n\n\tsetStencilOp( stencilFail, stencilZFail, stencilZPass ) {\n\n\t\tif ( this.currentStencilFail !== stencilFail ||\n\t\t\t this.currentStencilZFail !== stencilZFail ||\n\t\t\t this.currentStencilZPass !== stencilZPass ) {\n\n\t\t\tthis.gl.stencilOp( stencilFail, stencilZFail, stencilZPass );\n\n\t\t\tthis.currentStencilFail = stencilFail;\n\t\t\tthis.currentStencilZFail = stencilZFail;\n\t\t\tthis.currentStencilZPass = stencilZPass;\n\n\t\t}\n\n\t}\n\n\tsetMaterial( material, frontFaceCW, hardwareClippingPlanes ) {\n\n\t\tconst { gl } = this;\n\n\t\tmaterial.side === DoubleSide\n\t\t\t? this.disable( gl.CULL_FACE )\n\t\t\t: this.enable( gl.CULL_FACE );\n\n\t\tlet flipSided = ( material.side === BackSide );\n\t\tif ( frontFaceCW ) flipSided = ! flipSided;\n\n\t\tthis.setFlipSided( flipSided );\n\n\t\t( material.blending === NormalBlending && material.transparent === false )\n\t\t\t? this.setBlending( NoBlending )\n\t\t\t: this.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha, material.premultipliedAlpha );\n\n\t\tthis.setDepthFunc( material.depthFunc );\n\t\tthis.setDepthTest( material.depthTest );\n\t\tthis.setDepthMask( material.depthWrite );\n\t\tthis.setColorMask( material.colorWrite );\n\n\t\tconst stencilWrite = material.stencilWrite;\n\t\tthis.setStencilTest( stencilWrite );\n\t\tif ( stencilWrite ) {\n\n\t\t\tthis.setStencilMask( material.stencilWriteMask );\n\t\t\tthis.setStencilFunc( material.stencilFunc, material.stencilRef, material.stencilFuncMask );\n\t\t\tthis.setStencilOp( material.stencilFail, material.stencilZFail, material.stencilZPass );\n\n\t\t}\n\n\t\tthis.setPolygonOffset( material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits );\n\n\t\tmaterial.alphaToCoverage === true && this.backend.renderer.samples > 1\n\t\t\t? this.enable( gl.SAMPLE_ALPHA_TO_COVERAGE )\n\t\t\t: this.disable( gl.SAMPLE_ALPHA_TO_COVERAGE );\n\n\t\tif ( hardwareClippingPlanes > 0 ) {\n\n\t\t\tif ( this.currentClippingPlanes !== hardwareClippingPlanes ) {\n\n\t\t\t\tconst CLIP_DISTANCE0_WEBGL = 0x3000;\n\n\t\t\t\tfor ( let i = 0; i < 8; i ++ ) {\n\n\t\t\t\t\tif ( i < hardwareClippingPlanes ) {\n\n\t\t\t\t\t\tthis.enable( CLIP_DISTANCE0_WEBGL + i );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthis.disable( CLIP_DISTANCE0_WEBGL + i );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetPolygonOffset( polygonOffset, factor, units ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( polygonOffset ) {\n\n\t\t\tthis.enable( gl.POLYGON_OFFSET_FILL );\n\n\t\t\tif ( this.currentPolygonOffsetFactor !== factor || this.currentPolygonOffsetUnits !== units ) {\n\n\t\t\t\tgl.polygonOffset( factor, units );\n\n\t\t\t\tthis.currentPolygonOffsetFactor = factor;\n\t\t\t\tthis.currentPolygonOffsetUnits = units;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis.disable( gl.POLYGON_OFFSET_FILL );\n\n\t\t}\n\n\t}\n\n\tuseProgram( program ) {\n\n\t\tif ( this.currentProgram !== program ) {\n\n\t\t\tthis.gl.useProgram( program );\n\n\t\t\tthis.currentProgram = program;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\t// framebuffer\n\n\n\tbindFramebuffer( target, framebuffer ) {\n\n\t\tconst { gl, currentBoundFramebuffers } = this;\n\n\t\tif ( currentBoundFramebuffers[ target ] !== framebuffer ) {\n\n\t\t\tgl.bindFramebuffer( target, framebuffer );\n\n\t\t\tcurrentBoundFramebuffers[ target ] = framebuffer;\n\n\t\t\t// gl.DRAW_FRAMEBUFFER is equivalent to gl.FRAMEBUFFER\n\n\t\t\tif ( target === gl.DRAW_FRAMEBUFFER ) {\n\n\t\t\t\tcurrentBoundFramebuffers[ gl.FRAMEBUFFER ] = framebuffer;\n\n\t\t\t}\n\n\t\t\tif ( target === gl.FRAMEBUFFER ) {\n\n\t\t\t\tcurrentBoundFramebuffers[ gl.DRAW_FRAMEBUFFER ] = framebuffer;\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tdrawBuffers( renderContext, framebuffer ) {\n\n\t\tconst { gl } = this;\n\n\t\tlet drawBuffers = [];\n\n\t\tlet needsUpdate = false;\n\n\t\tif ( renderContext.textures !== null ) {\n\n\t\t\tdrawBuffers = this.currentDrawbuffers.get( framebuffer );\n\n\t\t\tif ( drawBuffers === undefined ) {\n\n\t\t\t\tdrawBuffers = [];\n\t\t\t\tthis.currentDrawbuffers.set( framebuffer, drawBuffers );\n\n\t\t\t}\n\n\n\t\t\tconst textures = renderContext.textures;\n\n\t\t\tif ( drawBuffers.length !== textures.length || drawBuffers[ 0 ] !== gl.COLOR_ATTACHMENT0 ) {\n\n\t\t\t\tfor ( let i = 0, il = textures.length; i < il; i ++ ) {\n\n\t\t\t\t\tdrawBuffers[ i ] = gl.COLOR_ATTACHMENT0 + i;\n\n\t\t\t\t}\n\n\t\t\t\tdrawBuffers.length = textures.length;\n\n\t\t\t\tneedsUpdate = true;\n\n\t\t\t}\n\n\n\t\t} else {\n\n\t\t\tif ( drawBuffers[ 0 ] !== gl.BACK ) {\n\n\t\t\t\tdrawBuffers[ 0 ] = gl.BACK;\n\n\t\t\t\tneedsUpdate = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( needsUpdate ) {\n\n\t\t\tgl.drawBuffers( drawBuffers );\n\n\t\t}\n\n\t}\n\n\n\t// texture\n\n\tactiveTexture( webglSlot ) {\n\n\t\tconst { gl, currentTextureSlot, maxTextures } = this;\n\n\t\tif ( webglSlot === undefined ) webglSlot = gl.TEXTURE0 + maxTextures - 1;\n\n\t\tif ( currentTextureSlot !== webglSlot ) {\n\n\t\t\tgl.activeTexture( webglSlot );\n\t\t\tthis.currentTextureSlot = webglSlot;\n\n\t\t}\n\n\t}\n\n\tbindTexture( webglType, webglTexture, webglSlot ) {\n\n\t\tconst { gl, currentTextureSlot, currentBoundTextures, maxTextures } = this;\n\n\t\tif ( webglSlot === undefined ) {\n\n\t\t\tif ( currentTextureSlot === null ) {\n\n\t\t\t\twebglSlot = gl.TEXTURE0 + maxTextures - 1;\n\n\t\t\t} else {\n\n\t\t\t\twebglSlot = currentTextureSlot;\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet boundTexture = currentBoundTextures[ webglSlot ];\n\n\t\tif ( boundTexture === undefined ) {\n\n\t\t\tboundTexture = { type: undefined, texture: undefined };\n\t\t\tcurrentBoundTextures[ webglSlot ] = boundTexture;\n\n\t\t}\n\n\t\tif ( boundTexture.type !== webglType || boundTexture.texture !== webglTexture ) {\n\n\t\t\tif ( currentTextureSlot !== webglSlot ) {\n\n\t\t\t\tgl.activeTexture( webglSlot );\n\t\t\t\tthis.currentTextureSlot = webglSlot;\n\n\t\t\t}\n\n\t\t\tgl.bindTexture( webglType, webglTexture );\n\n\t\t\tboundTexture.type = webglType;\n\t\t\tboundTexture.texture = webglTexture;\n\n\t\t}\n\n\t}\n\n\tbindBufferBase( target, index, buffer ) {\n\n\t\tconst { gl } = this;\n\n\t\tconst key = `${target}-${index}`;\n\n\t\tif ( this.currentBoundBufferBases[ key ] !== buffer ) {\n\n\t\t\tgl.bindBufferBase( target, index, buffer );\n\t\t\tthis.currentBoundBufferBases[ key ] = buffer;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\n\tunbindTexture() {\n\n\t\tconst { gl, currentTextureSlot, currentBoundTextures } = this;\n\n\t\tconst boundTexture = currentBoundTextures[ currentTextureSlot ];\n\n\t\tif ( boundTexture !== undefined && boundTexture.type !== undefined ) {\n\n\t\t\tgl.bindTexture( boundTexture.type, null );\n\n\t\t\tboundTexture.type = undefined;\n\t\t\tboundTexture.texture = undefined;\n\n\t\t}\n\n\t}\n\n}\n\nclass WebGLUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t\tthis.gl = this.backend.gl;\n\t\tthis.extensions = backend.extensions;\n\n\t}\n\n\tconvert( p, colorSpace = NoColorSpace ) {\n\n\t\tconst { gl, extensions } = this;\n\n\t\tlet extension;\n\n\t\tif ( p === UnsignedByteType ) return gl.UNSIGNED_BYTE;\n\t\tif ( p === UnsignedShort4444Type ) return gl.UNSIGNED_SHORT_4_4_4_4;\n\t\tif ( p === UnsignedShort5551Type ) return gl.UNSIGNED_SHORT_5_5_5_1;\n\t\tif ( p === UnsignedInt5999Type ) return gl.UNSIGNED_INT_5_9_9_9_REV;\n\n\t\tif ( p === ByteType ) return gl.BYTE;\n\t\tif ( p === ShortType ) return gl.SHORT;\n\t\tif ( p === UnsignedShortType ) return gl.UNSIGNED_SHORT;\n\t\tif ( p === IntType ) return gl.INT;\n\t\tif ( p === UnsignedIntType ) return gl.UNSIGNED_INT;\n\t\tif ( p === FloatType ) return gl.FLOAT;\n\n\t\tif ( p === HalfFloatType ) {\n\n\t\t\treturn gl.HALF_FLOAT;\n\n\t\t}\n\n\t\tif ( p === AlphaFormat ) return gl.ALPHA;\n\t\tif ( p === RGBFormat ) return gl.RGB;\n\t\tif ( p === RGBAFormat ) return gl.RGBA;\n\t\tif ( p === LuminanceFormat ) return gl.LUMINANCE;\n\t\tif ( p === LuminanceAlphaFormat ) return gl.LUMINANCE_ALPHA;\n\t\tif ( p === DepthFormat ) return gl.DEPTH_COMPONENT;\n\t\tif ( p === DepthStencilFormat ) return gl.DEPTH_STENCIL;\n\n\t\t// WebGL2 formats.\n\n\t\tif ( p === RedFormat ) return gl.RED;\n\t\tif ( p === RedIntegerFormat ) return gl.RED_INTEGER;\n\t\tif ( p === RGFormat ) return gl.RG;\n\t\tif ( p === RGIntegerFormat ) return gl.RG_INTEGER;\n\t\tif ( p === RGBAIntegerFormat ) return gl.RGBA_INTEGER;\n\n\t\t// S3TC\n\n\t\tif ( p === RGB_S3TC_DXT1_Format || p === RGBA_S3TC_DXT1_Format || p === RGBA_S3TC_DXT3_Format || p === RGBA_S3TC_DXT5_Format ) {\n\n\t\t\tif ( colorSpace === SRGBColorSpace ) {\n\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc_srgb' );\n\n\t\t\t\tif ( extension !== null ) {\n\n\t\t\t\t\tif ( p === RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_SRGB_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc' );\n\n\t\t\t\tif ( extension !== null ) {\n\n\t\t\t\t\tif ( p === RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// PVRTC\n\n\t\tif ( p === RGB_PVRTC_4BPPV1_Format || p === RGB_PVRTC_2BPPV1_Format || p === RGBA_PVRTC_4BPPV1_Format || p === RGBA_PVRTC_2BPPV1_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_pvrtc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGB_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\n\t\t\t\tif ( p === RGB_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\n\t\t\t\tif ( p === RGBA_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\n\t\t\t\tif ( p === RGBA_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// ETC\n\n\t\tif ( p === RGB_ETC1_Format || p === RGB_ETC2_Format || p === RGBA_ETC2_EAC_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_etc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGB_ETC1_Format || p === RGB_ETC2_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ETC2 : extension.COMPRESSED_RGB8_ETC2;\n\t\t\t\tif ( p === RGBA_ETC2_EAC_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC : extension.COMPRESSED_RGBA8_ETC2_EAC;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// ASTC\n\n\t\tif ( p === RGBA_ASTC_4x4_Format || p === RGBA_ASTC_5x4_Format || p === RGBA_ASTC_5x5_Format ||\n\t\t\tp === RGBA_ASTC_6x5_Format || p === RGBA_ASTC_6x6_Format || p === RGBA_ASTC_8x5_Format ||\n\t\t\tp === RGBA_ASTC_8x6_Format || p === RGBA_ASTC_8x8_Format || p === RGBA_ASTC_10x5_Format ||\n\t\t\tp === RGBA_ASTC_10x6_Format || p === RGBA_ASTC_10x8_Format || p === RGBA_ASTC_10x10_Format ||\n\t\t\tp === RGBA_ASTC_12x10_Format || p === RGBA_ASTC_12x12_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_astc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGBA_ASTC_4x4_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR : extension.COMPRESSED_RGBA_ASTC_4x4_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_5x4_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR : extension.COMPRESSED_RGBA_ASTC_5x4_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_5x5_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR : extension.COMPRESSED_RGBA_ASTC_5x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_6x5_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR : extension.COMPRESSED_RGBA_ASTC_6x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_6x6_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR : extension.COMPRESSED_RGBA_ASTC_6x6_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_8x5_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR : extension.COMPRESSED_RGBA_ASTC_8x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_8x6_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR : extension.COMPRESSED_RGBA_ASTC_8x6_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_8x8_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR : extension.COMPRESSED_RGBA_ASTC_8x8_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x5_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR : extension.COMPRESSED_RGBA_ASTC_10x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x6_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR : extension.COMPRESSED_RGBA_ASTC_10x6_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x8_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR : extension.COMPRESSED_RGBA_ASTC_10x8_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x10_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR : extension.COMPRESSED_RGBA_ASTC_10x10_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_12x10_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR : extension.COMPRESSED_RGBA_ASTC_12x10_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_12x12_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR : extension.COMPRESSED_RGBA_ASTC_12x12_KHR;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// BPTC\n\n\t\tif ( p === RGBA_BPTC_Format ) {\n\n\t\t\textension = extensions.get( 'EXT_texture_compression_bptc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGBA_BPTC_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT : extension.COMPRESSED_RGBA_BPTC_UNORM_EXT;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// RGTC\n\n\t\tif ( p === RED_RGTC1_Format || p === SIGNED_RED_RGTC1_Format || p === RED_GREEN_RGTC2_Format || p === SIGNED_RED_GREEN_RGTC2_Format ) {\n\n\t\t\textension = extensions.get( 'EXT_texture_compression_rgtc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGBA_BPTC_Format ) return extension.COMPRESSED_RED_RGTC1_EXT;\n\t\t\t\tif ( p === SIGNED_RED_RGTC1_Format ) return extension.COMPRESSED_SIGNED_RED_RGTC1_EXT;\n\t\t\t\tif ( p === RED_GREEN_RGTC2_Format ) return extension.COMPRESSED_RED_GREEN_RGTC2_EXT;\n\t\t\t\tif ( p === SIGNED_RED_GREEN_RGTC2_Format ) return extension.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( p === UnsignedInt248Type ) {\n\n\t\t\treturn gl.UNSIGNED_INT_24_8;\n\n\t\t}\n\n\t\t// if \"p\" can't be resolved, assume the user defines a WebGL constant as a string (fallback/workaround for packed RGB formats)\n\n\t\treturn ( gl[ p ] !== undefined ) ? gl[ p ] : null;\n\n\t}\n\n\t_clientWaitAsync() {\n\n\t\tconst { gl } = this;\n\n\t\tconst sync = gl.fenceSync( gl.SYNC_GPU_COMMANDS_COMPLETE, 0 );\n\n\t\tgl.flush();\n\n\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\tfunction test() {\n\n\t\t\t\tconst res = gl.clientWaitSync( sync, gl.SYNC_FLUSH_COMMANDS_BIT, 0 );\n\n\t\t\t\tif ( res === gl.WAIT_FAILED ) {\n\n\t\t\t\t\tgl.deleteSync( sync );\n\n\t\t\t\t\treject();\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( res === gl.TIMEOUT_EXPIRED ) {\n\n\t\t\t\t\trequestAnimationFrame( test );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tgl.deleteSync( sync );\n\n\t\t\t\tresolve();\n\n\t\t\t}\n\n\t\t\ttest();\n\n\t\t} );\n\n\t}\n\n}\n\nlet initialized = false, wrappingToGL, filterToGL, compareToGL;\n\nclass WebGLTextureUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t\tthis.gl = backend.gl;\n\t\tthis.extensions = backend.extensions;\n\t\tthis.defaultTextures = {};\n\n\t\tif ( initialized === false ) {\n\n\t\t\tthis._init( this.gl );\n\n\t\t\tinitialized = true;\n\n\t\t}\n\n\t}\n\n\t_init( gl ) {\n\n\t\t// Store only WebGL constants here.\n\n\t\twrappingToGL = {\n\t\t\t[ RepeatWrapping ]: gl.REPEAT,\n\t\t\t[ ClampToEdgeWrapping ]: gl.CLAMP_TO_EDGE,\n\t\t\t[ MirroredRepeatWrapping ]: gl.MIRRORED_REPEAT\n\t\t};\n\n\t\tfilterToGL = {\n\t\t\t[ NearestFilter ]: gl.NEAREST,\n\t\t\t[ NearestMipmapNearestFilter ]: gl.NEAREST_MIPMAP_NEAREST,\n\t\t\t[ NearestMipmapLinearFilter ]: gl.NEAREST_MIPMAP_LINEAR,\n\n\t\t\t[ LinearFilter ]: gl.LINEAR,\n\t\t\t[ LinearMipmapNearestFilter ]: gl.LINEAR_MIPMAP_NEAREST,\n\t\t\t[ LinearMipmapLinearFilter ]: gl.LINEAR_MIPMAP_LINEAR\n\t\t};\n\n\t\tcompareToGL = {\n\t\t\t[ NeverCompare ]: gl.NEVER,\n\t\t\t[ AlwaysCompare ]: gl.ALWAYS,\n\t\t\t[ LessCompare ]: gl.LESS,\n\t\t\t[ LessEqualCompare ]: gl.LEQUAL,\n\t\t\t[ EqualCompare ]: gl.EQUAL,\n\t\t\t[ GreaterEqualCompare ]: gl.GEQUAL,\n\t\t\t[ GreaterCompare ]: gl.GREATER,\n\t\t\t[ NotEqualCompare ]: gl.NOTEQUAL\n\t\t};\n\n\t}\n\n\tfilterFallback( f ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( f === NearestFilter || f === NearestMipmapNearestFilter || f === NearestMipmapLinearFilter ) {\n\n\t\t\treturn gl.NEAREST;\n\n\t\t}\n\n\t\treturn gl.LINEAR;\n\n\t}\n\n\tgetGLTextureType( texture ) {\n\n\t\tconst { gl } = this;\n\n\t\tlet glTextureType;\n\n\t\tif ( texture.isCubeTexture === true ) {\n\n\t\t\tglTextureType = gl.TEXTURE_CUBE_MAP;\n\n\t\t} else if ( texture.isDataArrayTexture === true || texture.isCompressedArrayTexture === true ) {\n\n\t\t\tglTextureType = gl.TEXTURE_2D_ARRAY;\n\n\t\t} else if ( texture.isData3DTexture === true ) { // TODO: isCompressed3DTexture, wait for #26642\n\n\t\t\tglTextureType = gl.TEXTURE_3D;\n\n\t\t} else {\n\n\t\t\tglTextureType = gl.TEXTURE_2D;\n\n\n\t\t}\n\n\t\treturn glTextureType;\n\n\t}\n\n\tgetInternalFormat( internalFormatName, glFormat, glType, colorSpace, forceLinearTransfer = false ) {\n\n\t\tconst { gl, extensions } = this;\n\n\t\tif ( internalFormatName !== null ) {\n\n\t\t\tif ( gl[ internalFormatName ] !== undefined ) return gl[ internalFormatName ];\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format \\'' + internalFormatName + '\\'' );\n\n\t\t}\n\n\t\tlet internalFormat = glFormat;\n\n\t\tif ( glFormat === gl.RED ) {\n\n\t\t\tif ( glType === gl.FLOAT ) internalFormat = gl.R32F;\n\t\t\tif ( glType === gl.HALF_FLOAT ) internalFormat = gl.R16F;\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.R8;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.R16;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.R32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.R8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.R16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.R32I;\n\n\t\t}\n\n\t\tif ( glFormat === gl.RED_INTEGER ) {\n\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.R8UI;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.R16UI;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.R32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.R8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.R16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.R32I;\n\n\t\t}\n\n\t\tif ( glFormat === gl.RG ) {\n\n\t\t\tif ( glType === gl.FLOAT ) internalFormat = gl.RG32F;\n\t\t\tif ( glType === gl.HALF_FLOAT ) internalFormat = gl.RG16F;\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.RG8;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.RG16;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.RG32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.RG8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.RG16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.RG32I;\n\n\t\t}\n\n\t\tif ( glFormat === gl.RG_INTEGER ) {\n\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.RG8UI;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.RG16UI;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.RG32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.RG8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.RG16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.RG32I;\n\n\t\t}\n\n\t\tif ( glFormat === gl.RGB ) {\n\n\t\t\tif ( glType === gl.FLOAT ) internalFormat = gl.RGB32F;\n\t\t\tif ( glType === gl.HALF_FLOAT ) internalFormat = gl.RGB16F;\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.RGB8;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.RGB16;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.RGB32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.RGB8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.RGB16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.RGB32I;\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = ( colorSpace === SRGBColorSpace && forceLinearTransfer === false ) ? gl.SRGB8 : gl.RGB8;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT_5_6_5 ) internalFormat = gl.RGB565;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT_5_5_5_1 ) internalFormat = gl.RGB5_A1;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT_4_4_4_4 ) internalFormat = gl.RGB4;\n\t\t\tif ( glType === gl.UNSIGNED_INT_5_9_9_9_REV ) internalFormat = gl.RGB9_E5;\n\n\t\t}\n\n\t\tif ( glFormat === gl.RGB_INTEGER ) {\n\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.RGB8UI;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.RGB16UI;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.RGB32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.RGB8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.RGB16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.RGB32I;\n\n\t\t}\n\n\t\tif ( glFormat === gl.RGBA ) {\n\n\t\t\tif ( glType === gl.FLOAT ) internalFormat = gl.RGBA32F;\n\t\t\tif ( glType === gl.HALF_FLOAT ) internalFormat = gl.RGBA16F;\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.RGBA8;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.RGBA16;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.RGBA32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.RGBA8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.RGBA16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.RGBA32I;\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = ( colorSpace === SRGBColorSpace && forceLinearTransfer === false ) ? gl.SRGB8_ALPHA8 : gl.RGBA8;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT_4_4_4_4 ) internalFormat = gl.RGBA4;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT_5_5_5_1 ) internalFormat = gl.RGB5_A1;\n\n\t\t}\n\n\t\tif ( glFormat === gl.RGBA_INTEGER ) {\n\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.RGBA8UI;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.RGBA16UI;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.RGBA32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.RGBA8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.RGBA16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.RGBA32I;\n\n\t\t}\n\n\t\tif ( glFormat === gl.DEPTH_COMPONENT ) {\n\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.DEPTH24_STENCIL8;\n\t\t\tif ( glType === gl.FLOAT ) internalFormat = gl.DEPTH_COMPONENT32F;\n\n\t\t}\n\n\t\tif ( glFormat === gl.DEPTH_STENCIL ) {\n\n\t\t\tif ( glType === gl.UNSIGNED_INT_24_8 ) internalFormat = gl.DEPTH24_STENCIL8;\n\n\t\t}\n\n\t\tif ( internalFormat === gl.R16F || internalFormat === gl.R32F ||\n\t\t\tinternalFormat === gl.RG16F || internalFormat === gl.RG32F ||\n\t\t\tinternalFormat === gl.RGBA16F || internalFormat === gl.RGBA32F ) {\n\n\t\t\textensions.get( 'EXT_color_buffer_float' );\n\n\t\t}\n\n\t\treturn internalFormat;\n\n\t}\n\n\tsetTextureParameters( textureType, texture ) {\n\n\t\tconst { gl, extensions, backend } = this;\n\n\n\t\tgl.pixelStorei( gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\n\t\tgl.pixelStorei( gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha );\n\t\tgl.pixelStorei( gl.UNPACK_ALIGNMENT, texture.unpackAlignment );\n\t\tgl.pixelStorei( gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, gl.NONE );\n\n\t\tgl.texParameteri( textureType, gl.TEXTURE_WRAP_S, wrappingToGL[ texture.wrapS ] );\n\t\tgl.texParameteri( textureType, gl.TEXTURE_WRAP_T, wrappingToGL[ texture.wrapT ] );\n\n\t\tif ( textureType === gl.TEXTURE_3D || textureType === gl.TEXTURE_2D_ARRAY ) {\n\n\t\t\tgl.texParameteri( textureType, gl.TEXTURE_WRAP_R, wrappingToGL[ texture.wrapR ] );\n\n\t\t}\n\n\t\tgl.texParameteri( textureType, gl.TEXTURE_MAG_FILTER, filterToGL[ texture.magFilter ] );\n\n\n\t\tconst hasMipmaps = texture.mipmaps !== undefined && texture.mipmaps.length > 0;\n\n\t\t// follow WebGPU backend mapping for texture filtering\n\t\tconst minFilter = texture.minFilter === LinearFilter && hasMipmaps ? LinearMipmapLinearFilter : texture.minFilter;\n\n\t\tgl.texParameteri( textureType, gl.TEXTURE_MIN_FILTER, filterToGL[ minFilter ] );\n\n\t\tif ( texture.compareFunction ) {\n\n\t\t\tgl.texParameteri( textureType, gl.TEXTURE_COMPARE_MODE, gl.COMPARE_REF_TO_TEXTURE );\n\t\t\tgl.texParameteri( textureType, gl.TEXTURE_COMPARE_FUNC, compareToGL[ texture.compareFunction ] );\n\n\t\t}\n\n\t\tif ( extensions.has( 'EXT_texture_filter_anisotropic' ) === true ) {\n\n\t\t\tif ( texture.magFilter === NearestFilter ) return;\n\t\t\tif ( texture.minFilter !== NearestMipmapLinearFilter && texture.minFilter !== LinearMipmapLinearFilter ) return;\n\t\t\tif ( texture.type === FloatType && extensions.has( 'OES_texture_float_linear' ) === false ) return; // verify extension for WebGL 1 and WebGL 2\n\n\t\t\tif ( texture.anisotropy > 1 ) {\n\n\t\t\t\tconst extension = extensions.get( 'EXT_texture_filter_anisotropic' );\n\t\t\t\tgl.texParameterf( textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min( texture.anisotropy, backend.getMaxAnisotropy() ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcreateDefaultTexture( texture ) {\n\n\t\tconst { gl, backend, defaultTextures } = this;\n\n\n\t\tconst glTextureType = this.getGLTextureType( texture );\n\n\t\tlet textureGPU = defaultTextures[ glTextureType ];\n\n\t\tif ( textureGPU === undefined ) {\n\n\t\t\ttextureGPU = gl.createTexture();\n\n\t\t\tbackend.state.bindTexture( glTextureType, textureGPU );\n\t\t\tgl.texParameteri( glTextureType, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\n\t\t\tgl.texParameteri( glTextureType, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\n\n\t\t\t// gl.texImage2D( glTextureType, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, data );\n\n\t\t\tdefaultTextures[ glTextureType ] = textureGPU;\n\n\t\t}\n\n\t\tbackend.set( texture, {\n\t\t\ttextureGPU,\n\t\t\tglTextureType,\n\t\t\tisDefault: true\n\t\t} );\n\n\t}\n\n\tcreateTexture( texture, options ) {\n\n\t\tconst { gl, backend } = this;\n\t\tconst { levels, width, height, depth } = options;\n\n\t\tconst glFormat = backend.utils.convert( texture.format, texture.colorSpace );\n\t\tconst glType = backend.utils.convert( texture.type );\n\t\tconst glInternalFormat = this.getInternalFormat( texture.internalFormat, glFormat, glType, texture.colorSpace, texture.isVideoTexture );\n\n\t\tconst textureGPU = gl.createTexture();\n\t\tconst glTextureType = this.getGLTextureType( texture );\n\n\t\tbackend.state.bindTexture( glTextureType, textureGPU );\n\n\t\tthis.setTextureParameters( glTextureType, texture );\n\n\t\tif ( texture.isDataArrayTexture || texture.isCompressedArrayTexture ) {\n\n\t\t\tgl.texStorage3D( gl.TEXTURE_2D_ARRAY, levels, glInternalFormat, width, height, depth );\n\n\t\t} else if ( texture.isData3DTexture ) {\n\n\t\t\tgl.texStorage3D( gl.TEXTURE_3D, levels, glInternalFormat, width, height, depth );\n\n\t\t} else if ( ! texture.isVideoTexture ) {\n\n\t\t\tgl.texStorage2D( glTextureType, levels, glInternalFormat, width, height );\n\n\t\t}\n\n\t\tbackend.set( texture, {\n\t\t\ttextureGPU,\n\t\t\tglTextureType,\n\t\t\tglFormat,\n\t\t\tglType,\n\t\t\tglInternalFormat\n\t\t} );\n\n\t}\n\n\tcopyBufferToTexture( buffer, texture ) {\n\n\t\tconst { gl, backend } = this;\n\n\t\tconst { textureGPU, glTextureType, glFormat, glType } = backend.get( texture );\n\n\t\tconst { width, height } = texture.source.data;\n\n\t\tgl.bindBuffer( gl.PIXEL_UNPACK_BUFFER, buffer );\n\n\t\tbackend.state.bindTexture( glTextureType, textureGPU );\n\n\t\tgl.pixelStorei( gl.UNPACK_FLIP_Y_WEBGL, false );\n\t\tgl.pixelStorei( gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false );\n\t\tgl.texSubImage2D( glTextureType, 0, 0, 0, width, height, glFormat, glType, 0 );\n\n\t\tgl.bindBuffer( gl.PIXEL_UNPACK_BUFFER, null );\n\n\t\tbackend.state.unbindTexture();\n\t\t// debug\n\t\t// const framebuffer = gl.createFramebuffer();\n\t\t// gl.bindFramebuffer( gl.FRAMEBUFFER, framebuffer );\n\t\t// gl.framebufferTexture2D( gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, glTextureType, textureGPU, 0 );\n\n\t\t// const readout = new Float32Array( width * height * 4 );\n\n\t\t// const altFormat = gl.getParameter( gl.IMPLEMENTATION_COLOR_READ_FORMAT );\n\t\t// const altType = gl.getParameter( gl.IMPLEMENTATION_COLOR_READ_TYPE );\n\n\t\t// gl.readPixels( 0, 0, width, height, altFormat, altType, readout );\n\t\t// gl.bindFramebuffer( gl.FRAMEBUFFER, null );\n\t\t// console.log( readout );\n\n\t}\n\n\tupdateTexture( texture, options ) {\n\n\t\tconst { gl } = this;\n\t\tconst { width, height } = options;\n\t\tconst { textureGPU, glTextureType, glFormat, glType, glInternalFormat } = this.backend.get( texture );\n\n\t\tif ( texture.isRenderTargetTexture || ( textureGPU === undefined /* unsupported texture format */ ) )\n\t\t\treturn;\n\n\t\tconst getImage = ( source ) => {\n\n\t\t\tif ( source.isDataTexture ) {\n\n\t\t\t\treturn source.image.data;\n\n\t\t\t} else if ( ( typeof HTMLImageElement !== 'undefined' && source instanceof HTMLImageElement ) ||\n\t\t\t\t( typeof HTMLCanvasElement !== 'undefined' && source instanceof HTMLCanvasElement ) ||\n\t\t\t\t( typeof ImageBitmap !== 'undefined' && source instanceof ImageBitmap ) ||\n\t\t\t\tsource instanceof OffscreenCanvas ) {\n\n\t\t\t\treturn source;\n\n\t\t\t}\n\n\t\t\treturn source.data;\n\n\t\t};\n\n\t\tthis.backend.state.bindTexture( glTextureType, textureGPU );\n\n\t\tthis.setTextureParameters( glTextureType, texture );\n\n\t\tif ( texture.isCompressedTexture ) {\n\n\t\t\tconst mipmaps = texture.mipmaps;\n\t\t\tconst image = options.image;\n\n\t\t\tfor ( let i = 0; i < mipmaps.length; i ++ ) {\n\n\t\t\t\tconst mipmap = mipmaps[ i ];\n\n\t\t\t\tif ( texture.isCompressedArrayTexture ) {\n\n\n\t\t\t\t\tif ( texture.format !== gl.RGBA ) {\n\n\t\t\t\t\t\tif ( glFormat !== null ) {\n\n\t\t\t\t\t\t\tgl.compressedTexSubImage3D( gl.TEXTURE_2D_ARRAY, i, 0, 0, 0, mipmap.width, mipmap.height, image.depth, glFormat, mipmap.data );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tgl.texSubImage3D( gl.TEXTURE_2D_ARRAY, i, 0, 0, 0, mipmap.width, mipmap.height, image.depth, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( glFormat !== null ) {\n\n\t\t\t\t\t\tgl.compressedTexSubImage2D( gl.TEXTURE_2D, i, 0, 0, mipmap.width, mipmap.height, glFormat, mipmap.data );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'Unsupported compressed texture format' );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t} else if ( texture.isCubeTexture ) {\n\n\t\t\tconst images = options.images;\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\tconst image = getImage( images[ i ] );\n\n\t\t\t\tgl.texSubImage2D( gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, 0, 0, width, height, glFormat, glType, image );\n\n\t\t\t}\n\n\t\t} else if ( texture.isDataArrayTexture ) {\n\n\t\t\tconst image = options.image;\n\n\t\t\tgl.texSubImage3D( gl.TEXTURE_2D_ARRAY, 0, 0, 0, 0, image.width, image.height, image.depth, glFormat, glType, image.data );\n\n\t\t} else if ( texture.isData3DTexture ) {\n\n\t\t\tconst image = options.image;\n\n\t\t\tgl.texSubImage3D( gl.TEXTURE_3D, 0, 0, 0, 0, image.width, image.height, image.depth, glFormat, glType, image.data );\n\n\t\t} else if ( texture.isVideoTexture ) {\n\n\t\t\ttexture.update();\n\n\t\t\tgl.texImage2D( glTextureType, 0, glInternalFormat, glFormat, glType, options.image );\n\n\n\t\t} else {\n\n\t\t\tconst image = getImage( options.image );\n\n\t\t\tgl.texSubImage2D( glTextureType, 0, 0, 0, width, height, glFormat, glType, image );\n\n\t\t}\n\n\t}\n\n\tgenerateMipmaps( texture ) {\n\n\t\tconst { gl, backend } = this;\n\t\tconst { textureGPU, glTextureType } = backend.get( texture );\n\n\t\tbackend.state.bindTexture( glTextureType, textureGPU );\n\t\tgl.generateMipmap( glTextureType );\n\n\t}\n\n\tdeallocateRenderBuffers( renderTarget ) {\n\n\t\tconst { gl, backend } = this;\n\n\t\t// remove framebuffer reference\n\t\tif ( renderTarget ) {\n\n\t\t\tconst renderContextData = backend.get( renderTarget );\n\n\t\t\trenderContextData.renderBufferStorageSetup = undefined;\n\n\t\t\tif ( renderContextData.framebuffers ) {\n\n\t\t\t\tfor ( const cacheKey in renderContextData.framebuffers ) {\n\n\t\t\t\t\tgl.deleteFramebuffer( renderContextData.framebuffers[ cacheKey ] );\n\n\t\t\t\t}\n\n\t\t\t\tdelete renderContextData.framebuffers;\n\n\t\t\t}\n\n\t\t\tif ( renderContextData.depthRenderbuffer ) {\n\n\t\t\t\tgl.deleteRenderbuffer( renderContextData.depthRenderbuffer );\n\t\t\t\tdelete renderContextData.depthRenderbuffer;\n\n\t\t\t}\n\n\t\t\tif ( renderContextData.stencilRenderbuffer ) {\n\n\t\t\t\tgl.deleteRenderbuffer( renderContextData.stencilRenderbuffer );\n\t\t\t\tdelete renderContextData.stencilRenderbuffer;\n\n\t\t\t}\n\n\t\t\tif ( renderContextData.msaaFrameBuffer ) {\n\n\t\t\t\tgl.deleteFramebuffer( renderContextData.msaaFrameBuffer );\n\t\t\t\tdelete renderContextData.msaaFrameBuffer;\n\n\t\t\t}\n\n\t\t\tif ( renderContextData.msaaRenderbuffers ) {\n\n\t\t\t\tfor ( let i = 0; i < renderContextData.msaaRenderbuffers.length; i ++ ) {\n\n\t\t\t\t\tgl.deleteRenderbuffer( renderContextData.msaaRenderbuffers[ i ] );\n\n\t\t\t\t}\n\n\t\t\t\tdelete renderContextData.msaaRenderbuffers;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tdestroyTexture( texture ) {\n\n\t\tconst { gl, backend } = this;\n\t\tconst { textureGPU, renderTarget } = backend.get( texture );\n\n\t\tthis.deallocateRenderBuffers( renderTarget );\n\t\tgl.deleteTexture( textureGPU );\n\n\t\tbackend.delete( texture );\n\n\t}\n\n\tcopyTextureToTexture( srcTexture, dstTexture, srcRegion = null, dstPosition = null, level = 0 ) {\n\n\t\tconst { gl, backend } = this;\n\t\tconst { state } = this.backend;\n\n\t\tconst { textureGPU: dstTextureGPU, glTextureType, glType, glFormat } = backend.get( dstTexture );\n\n\t\tlet width, height, minX, minY;\n\t\tlet dstX, dstY;\n\n\t\tif ( srcRegion !== null ) {\n\n\t\t\twidth = srcRegion.max.x - srcRegion.min.x;\n\t\t\theight = srcRegion.max.y - srcRegion.min.y;\n\t\t\tminX = srcRegion.min.x;\n\t\t\tminY = srcRegion.min.y;\n\n\t\t} else {\n\n\t\t\twidth = srcTexture.image.width;\n\t\t\theight = srcTexture.image.height;\n\t\t\tminX = 0;\n\t\t\tminY = 0;\n\n\t\t}\n\n\t\tif ( dstPosition !== null ) {\n\n\t\t\tdstX = dstPosition.x;\n\t\t\tdstY = dstPosition.y;\n\n\t\t} else {\n\n\t\t\tdstX = 0;\n\t\t\tdstY = 0;\n\n\t\t}\n\n\t\tstate.bindTexture( glTextureType, dstTextureGPU );\n\n\t\t// As another texture upload may have changed pixelStorei\n\t\t// parameters, make sure they are correct for the dstTexture\n\t\tgl.pixelStorei( gl.UNPACK_ALIGNMENT, dstTexture.unpackAlignment );\n\t\tgl.pixelStorei( gl.UNPACK_FLIP_Y_WEBGL, dstTexture.flipY );\n\t\tgl.pixelStorei( gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, dstTexture.premultiplyAlpha );\n\t\tgl.pixelStorei( gl.UNPACK_ALIGNMENT, dstTexture.unpackAlignment );\n\n\t\tconst currentUnpackRowLen = gl.getParameter( gl.UNPACK_ROW_LENGTH );\n\t\tconst currentUnpackImageHeight = gl.getParameter( gl.UNPACK_IMAGE_HEIGHT );\n\t\tconst currentUnpackSkipPixels = gl.getParameter( gl.UNPACK_SKIP_PIXELS );\n\t\tconst currentUnpackSkipRows = gl.getParameter( gl.UNPACK_SKIP_ROWS );\n\t\tconst currentUnpackSkipImages = gl.getParameter( gl.UNPACK_SKIP_IMAGES );\n\n\t\tconst image = srcTexture.isCompressedTexture ? srcTexture.mipmaps[ level ] : srcTexture.image;\n\n\t\tgl.pixelStorei( gl.UNPACK_ROW_LENGTH, image.width );\n\t\tgl.pixelStorei( gl.UNPACK_IMAGE_HEIGHT, image.height );\n\t\tgl.pixelStorei( gl.UNPACK_SKIP_PIXELS, minX );\n\t\tgl.pixelStorei( gl.UNPACK_SKIP_ROWS, minY );\n\n\t\tif ( srcTexture.isRenderTargetTexture || srcTexture.isDepthTexture ) {\n\n\t\t\tconst srcTextureData = backend.get( srcTexture );\n\t\t\tconst dstTextureData = backend.get( dstTexture );\n\n\t\t\tconst srcRenderContextData = backend.get( srcTextureData.renderTarget );\n\t\t\tconst dstRenderContextData = backend.get( dstTextureData.renderTarget );\n\n\t\t\tconst srcFramebuffer = srcRenderContextData.framebuffers[ srcTextureData.cacheKey ];\n\t\t\tconst dstFramebuffer = dstRenderContextData.framebuffers[ dstTextureData.cacheKey ];\n\n\t\t\tstate.bindFramebuffer( gl.READ_FRAMEBUFFER, srcFramebuffer );\n\t\t\tstate.bindFramebuffer( gl.DRAW_FRAMEBUFFER, dstFramebuffer );\n\n\t\t\tlet mask = gl.COLOR_BUFFER_BIT;\n\n\t\t\tif ( srcTexture.isDepthTexture ) mask = gl.DEPTH_BUFFER_BIT;\n\n\t\t\tgl.blitFramebuffer( minX, minY, width, height, dstX, dstY, width, height, mask, gl.NEAREST );\n\n\t\t\tstate.bindFramebuffer( gl.READ_FRAMEBUFFER, null );\n\t\t\tstate.bindFramebuffer( gl.DRAW_FRAMEBUFFER, null );\n\n\t\t} else {\n\n\t\t\tif ( srcTexture.isDataTexture ) {\n\n\t\t\t\tgl.texSubImage2D( gl.TEXTURE_2D, level, dstX, dstY, width, height, glFormat, glType, image.data );\n\n\t\t\t} else {\n\n\t\t\t\tif ( srcTexture.isCompressedTexture ) {\n\n\t\t\t\t\tgl.compressedTexSubImage2D( gl.TEXTURE_2D, level, dstX, dstY, image.width, image.height, glFormat, image.data );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tgl.texSubImage2D( gl.TEXTURE_2D, level, dstX, dstY, width, height, glFormat, glType, image );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tgl.pixelStorei( gl.UNPACK_ROW_LENGTH, currentUnpackRowLen );\n\t\tgl.pixelStorei( gl.UNPACK_IMAGE_HEIGHT, currentUnpackImageHeight );\n\t\tgl.pixelStorei( gl.UNPACK_SKIP_PIXELS, currentUnpackSkipPixels );\n\t\tgl.pixelStorei( gl.UNPACK_SKIP_ROWS, currentUnpackSkipRows );\n\t\tgl.pixelStorei( gl.UNPACK_SKIP_IMAGES, currentUnpackSkipImages );\n\n\t\t// Generate mipmaps only when copying level 0\n\t\tif ( level === 0 && dstTexture.generateMipmaps ) gl.generateMipmap( gl.TEXTURE_2D );\n\n\t\tstate.unbindTexture();\n\n\t}\n\n\tcopyFramebufferToTexture( texture, renderContext, rectangle ) {\n\n\t\tconst { gl } = this;\n\t\tconst { state } = this.backend;\n\n\t\tconst { textureGPU } = this.backend.get( texture );\n\n\t\tconst { x, y, z: width, w: height } = rectangle;\n\n\t\tconst requireDrawFrameBuffer = texture.isDepthTexture === true || ( renderContext.renderTarget && renderContext.renderTarget.samples > 0 );\n\n\t\tconst srcHeight = renderContext.renderTarget ? renderContext.renderTarget.height : this.backend.gerDrawingBufferSize().y;\n\n\t\tif ( requireDrawFrameBuffer ) {\n\n\t\t\tconst partial = ( x !== 0 || y !== 0 );\n\t\t\tlet mask;\n\t\t\tlet attachment;\n\n\t\t\tif ( texture.isDepthTexture === true ) {\n\n\t\t\t\tmask = gl.DEPTH_BUFFER_BIT;\n\t\t\t\tattachment = gl.DEPTH_ATTACHMENT;\n\n\t\t\t\tif ( renderContext.stencil ) {\n\n\t\t\t\t\tmask |= gl.STENCIL_BUFFER_BIT;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tmask = gl.COLOR_BUFFER_BIT;\n\t\t\t\tattachment = gl.COLOR_ATTACHMENT0;\n\n\t\t\t}\n\n\t\t\tif ( partial ) {\n\n\t\t\t\tconst renderTargetContextData = this.backend.get( renderContext.renderTarget );\n\n\t\t\t\tconst fb = renderTargetContextData.framebuffers[ renderContext.getCacheKey() ];\n\t\t\t\tconst msaaFrameBuffer = renderTargetContextData.msaaFrameBuffer;\n\n\t\t\t\tstate.bindFramebuffer( gl.DRAW_FRAMEBUFFER, fb );\n\t\t\t\tstate.bindFramebuffer( gl.READ_FRAMEBUFFER, msaaFrameBuffer );\n\n\t\t\t\tconst flippedY = srcHeight - y - height;\n\n\t\t\t\tgl.blitFramebuffer( x, flippedY, x + width, flippedY + height, x, flippedY, x + width, flippedY + height, mask, gl.NEAREST );\n\n\t\t\t\tstate.bindFramebuffer( gl.READ_FRAMEBUFFER, fb );\n\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, textureGPU );\n\n\t\t\t\tgl.copyTexSubImage2D( gl.TEXTURE_2D, 0, 0, 0, x, flippedY, width, height );\n\n\t\t\t\tstate.unbindTexture();\n\n\t\t\t} else {\n\n\t\t\t\tconst fb = gl.createFramebuffer();\n\n\t\t\t\tstate.bindFramebuffer( gl.DRAW_FRAMEBUFFER, fb );\n\n\t\t\t\tgl.framebufferTexture2D( gl.DRAW_FRAMEBUFFER, attachment, gl.TEXTURE_2D, textureGPU, 0 );\n\t\t\t\tgl.blitFramebuffer( 0, 0, width, height, 0, 0, width, height, mask, gl.NEAREST );\n\n\t\t\t\tgl.deleteFramebuffer( fb );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tstate.bindTexture( gl.TEXTURE_2D, textureGPU );\n\t\t\tgl.copyTexSubImage2D( gl.TEXTURE_2D, 0, 0, 0, x, srcHeight - height - y, width, height );\n\n\t\t\tstate.unbindTexture();\n\n\t\t}\n\n\t\tif ( texture.generateMipmaps ) this.generateMipmaps( texture );\n\n\t\tthis.backend._setFramebuffer( renderContext );\n\n\t}\n\n\t// Setup storage for internal depth/stencil buffers and bind to correct framebuffer\n\tsetupRenderBufferStorage( renderbuffer, renderContext ) {\n\n\t\tconst { gl } = this;\n\t\tconst renderTarget = renderContext.renderTarget;\n\n\t\tconst { samples, depthTexture, depthBuffer, stencilBuffer, width, height } = renderTarget;\n\n\t\tgl.bindRenderbuffer( gl.RENDERBUFFER, renderbuffer );\n\n\t\tif ( depthBuffer && ! stencilBuffer ) {\n\n\t\t\tlet glInternalFormat = gl.DEPTH_COMPONENT24;\n\n\t\t\tif ( samples > 0 ) {\n\n\t\t\t\tif ( depthTexture && depthTexture.isDepthTexture ) {\n\n\t\t\t\t\tif ( depthTexture.type === gl.FLOAT ) {\n\n\t\t\t\t\t\tglInternalFormat = gl.DEPTH_COMPONENT32F;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tgl.renderbufferStorageMultisample( gl.RENDERBUFFER, samples, glInternalFormat, width, height );\n\n\t\t\t} else {\n\n\t\t\t\tgl.renderbufferStorage( gl.RENDERBUFFER, glInternalFormat, width, height );\n\n\t\t\t}\n\n\t\t\tgl.framebufferRenderbuffer( gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, renderbuffer );\n\n\t\t} else if ( depthBuffer && stencilBuffer ) {\n\n\t\t\tif ( samples > 0 ) {\n\n\t\t\t\tgl.renderbufferStorageMultisample( gl.RENDERBUFFER, samples, gl.DEPTH24_STENCIL8, width, height );\n\n\t\t\t} else {\n\n\t\t\t\tgl.renderbufferStorage( gl.RENDERBUFFER, gl.DEPTH_STENCIL, width, height );\n\n\t\t\t}\n\n\n\t\t\tgl.framebufferRenderbuffer( gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, renderbuffer );\n\n\t\t}\n\n\t}\n\n\tasync copyTextureToBuffer( texture, x, y, width, height, faceIndex ) {\n\n\t\tconst { backend, gl } = this;\n\n\t\tconst { textureGPU, glFormat, glType } = this.backend.get( texture );\n\n\t\tconst fb = gl.createFramebuffer();\n\n\t\tgl.bindFramebuffer( gl.READ_FRAMEBUFFER, fb );\n\n\t\tconst target = texture.isCubeTexture ? gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex : gl.TEXTURE_2D;\n\n\t\tgl.framebufferTexture2D( gl.READ_FRAMEBUFFER, gl.COLOR_ATTACHMENT0, target, textureGPU, 0 );\n\n\t\tconst typedArrayType = this._getTypedArrayType( glType );\n\t\tconst bytesPerTexel = this._getBytesPerTexel( glType, glFormat );\n\n\t\tconst elementCount = width * height;\n\t\tconst byteLength = elementCount * bytesPerTexel;\n\n\t\tconst buffer = gl.createBuffer();\n\n\t\tgl.bindBuffer( gl.PIXEL_PACK_BUFFER, buffer );\n\t\tgl.bufferData( gl.PIXEL_PACK_BUFFER, byteLength, gl.STREAM_READ );\n\t\tgl.readPixels( x, y, width, height, glFormat, glType, 0 );\n\t\tgl.bindBuffer( gl.PIXEL_PACK_BUFFER, null );\n\n\t\tawait backend.utils._clientWaitAsync();\n\n\t\tconst dstBuffer = new typedArrayType( byteLength / typedArrayType.BYTES_PER_ELEMENT );\n\n\t\tgl.bindBuffer( gl.PIXEL_PACK_BUFFER, buffer );\n\t\tgl.getBufferSubData( gl.PIXEL_PACK_BUFFER, 0, dstBuffer );\n\t\tgl.bindBuffer( gl.PIXEL_PACK_BUFFER, null );\n\n\t\tgl.deleteFramebuffer( fb );\n\n\t\treturn dstBuffer;\n\n\t}\n\n\t_getTypedArrayType( glType ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( glType === gl.UNSIGNED_BYTE ) return Uint8Array;\n\n\t\tif ( glType === gl.UNSIGNED_SHORT_4_4_4_4 ) return Uint16Array;\n\t\tif ( glType === gl.UNSIGNED_SHORT_5_5_5_1 ) return Uint16Array;\n\t\tif ( glType === gl.UNSIGNED_SHORT_5_6_5 ) return Uint16Array;\n\t\tif ( glType === gl.UNSIGNED_SHORT ) return Uint16Array;\n\t\tif ( glType === gl.UNSIGNED_INT ) return Uint32Array;\n\n\t\tif ( glType === gl.HALF_FLOAT ) return Uint16Array;\n\t\tif ( glType === gl.FLOAT ) return Float32Array;\n\n\t\tthrow new Error( `Unsupported WebGL type: ${glType}` );\n\n\t}\n\n\t_getBytesPerTexel( glType, glFormat ) {\n\n\t\tconst { gl } = this;\n\n\t\tlet bytesPerComponent = 0;\n\n\t\tif ( glType === gl.UNSIGNED_BYTE ) bytesPerComponent = 1;\n\n\t\tif ( glType === gl.UNSIGNED_SHORT_4_4_4_4 ||\n\t\t\tglType === gl.UNSIGNED_SHORT_5_5_5_1 ||\n\t\t\tglType === gl.UNSIGNED_SHORT_5_6_5 ||\n\t\t\tglType === gl.UNSIGNED_SHORT ||\n\t\t\tglType === gl.HALF_FLOAT ) bytesPerComponent = 2;\n\n\t\tif ( glType === gl.UNSIGNED_INT ||\n\t\t\tglType === gl.FLOAT ) bytesPerComponent = 4;\n\n\t\tif ( glFormat === gl.RGBA ) return bytesPerComponent * 4;\n\t\tif ( glFormat === gl.RGB ) return bytesPerComponent * 3;\n\t\tif ( glFormat === gl.ALPHA ) return bytesPerComponent;\n\n\t}\n\n}\n\nclass WebGLExtensions {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t\tthis.gl = this.backend.gl;\n\t\tthis.availableExtensions = this.gl.getSupportedExtensions();\n\n\t\tthis.extensions = {};\n\n\t}\n\n\tget( name ) {\n\n\t\tlet extension = this.extensions[ name ];\n\n\t\tif ( extension === undefined ) {\n\n\t\t\textension = this.gl.getExtension( name );\n\n\t\t\tthis.extensions[ name ] = extension;\n\n\t\t}\n\n\t\treturn extension;\n\n\t}\n\n\thas( name ) {\n\n\t\treturn this.availableExtensions.includes( name );\n\n\t}\n\n}\n\nclass WebGLCapabilities {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t\tthis.maxAnisotropy = null;\n\n\t}\n\n\tgetMaxAnisotropy() {\n\n\t\tif ( this.maxAnisotropy !== null ) return this.maxAnisotropy;\n\n\t\tconst gl = this.backend.gl;\n\t\tconst extensions = this.backend.extensions;\n\n\t\tif ( extensions.has( 'EXT_texture_filter_anisotropic' ) === true ) {\n\n\t\t\tconst extension = extensions.get( 'EXT_texture_filter_anisotropic' );\n\n\t\t\tthis.maxAnisotropy = gl.getParameter( extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT );\n\n\t\t} else {\n\n\t\t\tthis.maxAnisotropy = 0;\n\n\t\t}\n\n\t\treturn this.maxAnisotropy;\n\n\t}\n\n}\n\nconst GLFeatureName = {\n\n\t'WEBGL_multi_draw': 'WEBGL_multi_draw',\n\t'WEBGL_compressed_texture_astc': 'texture-compression-astc',\n\t'WEBGL_compressed_texture_etc': 'texture-compression-etc2',\n\t'WEBGL_compressed_texture_etc1': 'texture-compression-etc1',\n\t'WEBGL_compressed_texture_pvrtc': 'texture-compression-pvrtc',\n\t'WEBKIT_WEBGL_compressed_texture_pvrtc': 'texture-compression-pvrtc',\n\t'WEBGL_compressed_texture_s3tc': 'texture-compression-bc',\n\t'EXT_texture_compression_bptc': 'texture-compression-bptc',\n\t'EXT_disjoint_timer_query_webgl2': 'timestamp-query',\n\n};\n\nclass WebGLBufferRenderer {\n\n\tconstructor( backend ) {\n\n\t\tthis.gl = backend.gl;\n\t\tthis.extensions = backend.extensions;\n\t\tthis.info = backend.renderer.info;\n\t\tthis.mode = null;\n\t\tthis.index = 0;\n\t\tthis.type = null;\n\t\tthis.object = null;\n\n\t}\n\n\trender( start, count ) {\n\n\t\tconst { gl, mode, object, type, info, index } = this;\n\n\t\tif ( index !== 0 ) {\n\n\t\t\tgl.drawElements( mode, count, type, start );\n\n\t\t} else {\n\n\t\t\tgl.drawArrays( mode, start, count );\n\n\t\t}\n\n\t\tinfo.update( object, count, mode, 1 );\n\n\t}\n\n\trenderInstances( start, count, primcount ) {\n\n\t\tconst { gl, mode, type, index, object, info } = this;\n\n\t\tif ( primcount === 0 ) return;\n\n\t\tif ( index !== 0 ) {\n\n\t\t\tgl.drawElementsInstanced( mode, count, type, start, primcount );\n\n\t\t} else {\n\n\t\t\tgl.drawArraysInstanced( mode, start, count, primcount );\n\n\t\t}\n\n\t\tinfo.update( object, count, mode, primcount );\n\n\t}\n\n\trenderMultiDraw( starts, counts, drawCount ) {\n\n\t\tconst { extensions, mode, object, info } = this;\n\n\t\tif ( drawCount === 0 ) return;\n\n\t\tconst extension = extensions.get( 'WEBGL_multi_draw' );\n\n\t\tif ( extension === null ) {\n\n\t\t\tfor ( let i = 0; i < drawCount; i ++ ) {\n\n\t\t\t\tthis.render( starts[ i ], counts[ i ] );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( this.index !== 0 ) {\n\n\t\t\t\textension.multiDrawElementsWEBGL( mode, counts, 0, this.type, starts, 0, drawCount );\n\n\t\t\t} else {\n\n\t\t\t\textension.multiDrawArraysWEBGL( mode, starts, 0, counts, 0, drawCount );\n\n\t\t\t}\n\n\t\t\tlet elementCount = 0;\n\t\t\tfor ( let i = 0; i < drawCount; i ++ ) {\n\n\t\t\t\telementCount += counts[ i ];\n\n\t\t\t}\n\n\t\t\tinfo.update( object, elementCount, mode, 1 );\n\n\t\t}\n\n\t}\n\n\trenderMultiDrawInstances( starts, counts, drawCount, primcount ) {\n\n\t\tconst { extensions, mode, object, info } = this;\n\n\t\tif ( drawCount === 0 ) return;\n\n\t\tconst extension = extensions.get( 'WEBGL_multi_draw' );\n\n\t\tif ( extension === null ) {\n\n\t\t\tfor ( let i = 0; i < drawCount; i ++ ) {\n\n\t\t\t\tthis.renderInstances( starts[ i ], counts[ i ], primcount[ i ] );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( this.index !== 0 ) {\n\n\t\t\t\textension.multiDrawElementsInstancedWEBGL( mode, counts, 0, this.type, starts, 0, primcount, 0, drawCount );\n\n\t\t\t} else {\n\n\t\t\t\textension.multiDrawArraysInstancedWEBGL( mode, starts, 0, counts, 0, primcount, 0, drawCount );\n\n\t\t\t}\n\n\t\t\tlet elementCount = 0;\n\t\t\tfor ( let i = 0; i < drawCount; i ++ ) {\n\n\t\t\t\telementCount += counts[ i ] * primcount[ i ];\n\n\t\t\t}\n\n\t\t\tinfo.update( object, elementCount, mode, 1 );\n\n\t\t}\n\n\t}\n\n\t//\n\n}\n\n//\n\nclass WebGLBackend extends Backend {\n\n\tconstructor( parameters = {} ) {\n\n\t\tsuper( parameters );\n\n\t\tthis.isWebGLBackend = true;\n\n\t}\n\n\tinit( renderer ) {\n\n\t\tsuper.init( renderer );\n\n\t\t//\n\n\t\tconst parameters = this.parameters;\n\n\t\tconst glContext = ( parameters.context !== undefined ) ? parameters.context : renderer.domElement.getContext( 'webgl2' );\n\n\t \tfunction onContextLost( event ) {\n\n\t\t\tevent.preventDefault();\n\n\t\t\tconst contextLossInfo = {\n\t\t\t\tapi: 'WebGL',\n\t\t\t\tmessage: event.statusMessage || 'Unknown reason',\n\t\t\t\treason: null,\n\t\t\t\toriginalEvent: event\n\t\t\t};\n\n\t\t\trenderer.onDeviceLost( contextLossInfo );\n\n\t\t}\n\n\t\tthis._onContextLost = onContextLost;\n\n\t\trenderer.domElement.addEventListener( 'webglcontextlost', onContextLost, false );\n\n\t\tthis.gl = glContext;\n\n\t\tthis.extensions = new WebGLExtensions( this );\n\t\tthis.capabilities = new WebGLCapabilities( this );\n\t\tthis.attributeUtils = new WebGLAttributeUtils( this );\n\t\tthis.textureUtils = new WebGLTextureUtils( this );\n\t\tthis.bufferRenderer = new WebGLBufferRenderer( this );\n\n\t\tthis.state = new WebGLState( this );\n\t\tthis.utils = new WebGLUtils( this );\n\n\t\tthis.vaoCache = {};\n\t\tthis.transformFeedbackCache = {};\n\t\tthis.discard = false;\n\t\tthis.trackTimestamp = ( parameters.trackTimestamp === true );\n\n\t\tthis.extensions.get( 'EXT_color_buffer_float' );\n\t\tthis.extensions.get( 'WEBGL_clip_cull_distance' );\n\t\tthis.extensions.get( 'OES_texture_float_linear' );\n\t\tthis.extensions.get( 'EXT_color_buffer_half_float' );\n\t\tthis.extensions.get( 'WEBGL_multisampled_render_to_texture' );\n\t\tthis.extensions.get( 'WEBGL_render_shared_exponent' );\n\t\tthis.extensions.get( 'WEBGL_multi_draw' );\n\n\t\tthis.disjoint = this.extensions.get( 'EXT_disjoint_timer_query_webgl2' );\n\t\tthis.parallel = this.extensions.get( 'KHR_parallel_shader_compile' );\n\n\t\tthis._knownBindings = new WeakSet();\n\n\t\tthis._currentContext = null;\n\n\t}\n\n\tget coordinateSystem() {\n\n\t\treturn WebGLCoordinateSystem;\n\n\t}\n\n\tasync getArrayBufferAsync( attribute ) {\n\n\t\treturn await this.attributeUtils.getArrayBufferAsync( attribute );\n\n\t}\n\n\tasync waitForGPU() {\n\n\t\tawait this.utils._clientWaitAsync();\n\n\t}\n\n\tinitTimestampQuery( renderContext ) {\n\n\t\tif ( ! this.disjoint || ! this.trackTimestamp ) return;\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tif ( this.queryRunning ) {\n\n\t\t  if ( ! renderContextData.queryQueue ) renderContextData.queryQueue = [];\n\t\t  renderContextData.queryQueue.push( renderContext );\n\t\t  return;\n\n\t\t}\n\n\t\tif ( renderContextData.activeQuery ) {\n\n\t\t  this.gl.endQuery( this.disjoint.TIME_ELAPSED_EXT );\n\t\t  renderContextData.activeQuery = null;\n\n\t\t}\n\n\t\trenderContextData.activeQuery = this.gl.createQuery();\n\n\t\tif ( renderContextData.activeQuery !== null ) {\n\n\t\t  this.gl.beginQuery( this.disjoint.TIME_ELAPSED_EXT, renderContextData.activeQuery );\n\t\t  this.queryRunning = true;\n\n\t\t}\n\n\t}\n\n\t// timestamp utils\n\n\tprepareTimestampBuffer( renderContext ) {\n\n\t\tif ( ! this.disjoint || ! this.trackTimestamp ) return;\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tif ( renderContextData.activeQuery ) {\n\n\t\t  this.gl.endQuery( this.disjoint.TIME_ELAPSED_EXT );\n\n\t\t  if ( ! renderContextData.gpuQueries ) renderContextData.gpuQueries = [];\n\t\t  renderContextData.gpuQueries.push( { query: renderContextData.activeQuery } );\n\t\t  renderContextData.activeQuery = null;\n\t\t  this.queryRunning = false;\n\n\t\t  if ( renderContextData.queryQueue && renderContextData.queryQueue.length > 0 ) {\n\n\t\t\t\tconst nextRenderContext = renderContextData.queryQueue.shift();\n\t\t\t\tthis.initTimestampQuery( nextRenderContext );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tasync resolveTimestampAsync( renderContext, type = 'render' ) {\n\n\t\tif ( ! this.disjoint || ! this.trackTimestamp ) return;\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tif ( ! renderContextData.gpuQueries ) renderContextData.gpuQueries = [];\n\n\t\tfor ( let i = 0; i < renderContextData.gpuQueries.length; i ++ ) {\n\n\t\t  const queryInfo = renderContextData.gpuQueries[ i ];\n\t\t  const available = this.gl.getQueryParameter( queryInfo.query, this.gl.QUERY_RESULT_AVAILABLE );\n\t\t  const disjoint = this.gl.getParameter( this.disjoint.GPU_DISJOINT_EXT );\n\n\t\t  if ( available && ! disjoint ) {\n\n\t\t\t\tconst elapsed = this.gl.getQueryParameter( queryInfo.query, this.gl.QUERY_RESULT );\n\t\t\t\tconst duration = Number( elapsed ) / 1000000; // Convert nanoseconds to milliseconds\n\t\t\t\tthis.gl.deleteQuery( queryInfo.query );\n\t\t\t\trenderContextData.gpuQueries.splice( i, 1 ); // Remove the processed query\n\t\t\t\ti --;\n\t\t\t\tthis.renderer.info.updateTimestamp( type, duration );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgetContext() {\n\n\t\treturn this.gl;\n\n\t}\n\n\tbeginRender( renderContext ) {\n\n\t\tconst { gl } = this;\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\t//\n\n\t\t//\n\n\t\tthis.initTimestampQuery( renderContext );\n\n\t\trenderContextData.previousContext = this._currentContext;\n\t\tthis._currentContext = renderContext;\n\n\t\tthis._setFramebuffer( renderContext );\n\n\t\tthis.clear( renderContext.clearColor, renderContext.clearDepth, renderContext.clearStencil, renderContext, false );\n\n\t\t//\n\t\tif ( renderContext.viewport ) {\n\n\t\t\tthis.updateViewport( renderContext );\n\n\t\t} else {\n\n\t\t\tgl.viewport( 0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight );\n\n\t\t}\n\n\t\tif ( renderContext.scissor ) {\n\n\t\t\tconst { x, y, width, height } = renderContext.scissorValue;\n\n\t\t\tgl.scissor( x, renderContext.height - height - y, width, height );\n\n\t\t}\n\n\t\tconst occlusionQueryCount = renderContext.occlusionQueryCount;\n\n\t\tif ( occlusionQueryCount > 0 ) {\n\n\t\t\t// Get a reference to the array of objects with queries. The renderContextData property\n\t\t\t// can be changed by another render pass before the async reading of all previous queries complete\n\t\t\trenderContextData.currentOcclusionQueries = renderContextData.occlusionQueries;\n\t\t\trenderContextData.currentOcclusionQueryObjects = renderContextData.occlusionQueryObjects;\n\n\t\t\trenderContextData.lastOcclusionObject = null;\n\t\t\trenderContextData.occlusionQueries = new Array( occlusionQueryCount );\n\t\t\trenderContextData.occlusionQueryObjects = new Array( occlusionQueryCount );\n\t\t\trenderContextData.occlusionQueryIndex = 0;\n\n\t\t}\n\n\t}\n\n\tfinishRender( renderContext ) {\n\n\t\tconst { gl, state } = this;\n\t\tconst renderContextData = this.get( renderContext );\n\t\tconst previousContext = renderContextData.previousContext;\n\n\t\tconst occlusionQueryCount = renderContext.occlusionQueryCount;\n\n\t\tif ( occlusionQueryCount > 0 ) {\n\n\t\t\tif ( occlusionQueryCount > renderContextData.occlusionQueryIndex ) {\n\n\t\t\t\tgl.endQuery( gl.ANY_SAMPLES_PASSED );\n\n\t\t\t}\n\n\t\t\tthis.resolveOccludedAsync( renderContext );\n\n\t\t}\n\n\t\tconst textures = renderContext.textures;\n\n\t\tif ( textures !== null ) {\n\n\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\tconst texture = textures[ i ];\n\n\t\t\t\tif ( texture.generateMipmaps ) {\n\n\t\t\t\t\tthis.generateMipmaps( texture );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis._currentContext = previousContext;\n\n\t\tif ( renderContext.textures !== null && renderContext.renderTarget ) {\n\n\t\t\tconst renderTargetContextData = this.get( renderContext.renderTarget );\n\n\t\t\tconst { samples } = renderContext.renderTarget;\n\n\t\t\tif ( samples > 0 ) {\n\n\t\t\t\tconst fb = renderTargetContextData.framebuffers[ renderContext.getCacheKey() ];\n\n\t\t\t\tconst mask = gl.COLOR_BUFFER_BIT;\n\n\t\t\t\tconst msaaFrameBuffer = renderTargetContextData.msaaFrameBuffer;\n\n\t\t\t\tconst textures = renderContext.textures;\n\n\t\t\t\tstate.bindFramebuffer( gl.READ_FRAMEBUFFER, msaaFrameBuffer );\n\t\t\t\tstate.bindFramebuffer( gl.DRAW_FRAMEBUFFER, fb );\n\n\t\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\t\t// TODO Add support for MRT\n\n\t\t\t\t\tif ( renderContext.scissor ) {\n\n\t\t\t\t\t\tconst { x, y, width, height } = renderContext.scissorValue;\n\n\t\t\t\t\t\tconst viewY = renderContext.height - height - y;\n\n\t\t\t\t\t\tgl.blitFramebuffer( x, viewY, x + width, viewY + height, x, viewY, x + width, viewY + height, mask, gl.NEAREST );\n\t\t\t\t\t\tgl.invalidateSubFramebuffer( gl.READ_FRAMEBUFFER, renderTargetContextData.invalidationArray, x, viewY, width, height );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tgl.blitFramebuffer( 0, 0, renderContext.width, renderContext.height, 0, 0, renderContext.width, renderContext.height, mask, gl.NEAREST );\n\t\t\t\t\t\tgl.invalidateFramebuffer( gl.READ_FRAMEBUFFER, renderTargetContextData.invalidationArray );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t}\n\n\t\tif ( previousContext !== null ) {\n\n\t\t\tthis._setFramebuffer( previousContext );\n\n\t\t\tif ( previousContext.viewport ) {\n\n\t\t\t\tthis.updateViewport( previousContext );\n\n\t\t\t} else {\n\n\t\t\t\tgl.viewport( 0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.prepareTimestampBuffer( renderContext );\n\n\t}\n\n\tresolveOccludedAsync( renderContext ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\t// handle occlusion query results\n\n\t\tconst { currentOcclusionQueries, currentOcclusionQueryObjects } = renderContextData;\n\n\t\tif ( currentOcclusionQueries && currentOcclusionQueryObjects ) {\n\n\t\t\tconst occluded = new WeakSet();\n\t\t\tconst { gl } = this;\n\n\t\t\trenderContextData.currentOcclusionQueryObjects = null;\n\t\t\trenderContextData.currentOcclusionQueries = null;\n\n\t\t\tconst check = () => {\n\n\t\t\t\tlet completed = 0;\n\n\t\t\t\t// check all queries and requeue as appropriate\n\t\t\t\tfor ( let i = 0; i < currentOcclusionQueries.length; i ++ ) {\n\n\t\t\t\t\tconst query = currentOcclusionQueries[ i ];\n\n\t\t\t\t\tif ( query === null ) continue;\n\n\t\t\t\t\tif ( gl.getQueryParameter( query, gl.QUERY_RESULT_AVAILABLE ) ) {\n\n\t\t\t\t\t\tif ( gl.getQueryParameter( query, gl.QUERY_RESULT ) > 0 ) occluded.add( currentOcclusionQueryObjects[ i ] );\n\n\t\t\t\t\t\tcurrentOcclusionQueries[ i ] = null;\n\t\t\t\t\t\tgl.deleteQuery( query );\n\n\t\t\t\t\t\tcompleted ++;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( completed < currentOcclusionQueries.length ) {\n\n\t\t\t\t\trequestAnimationFrame( check );\n\n\t\t\t\t} else {\n\n\t\t\t\t\trenderContextData.occluded = occluded;\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t\tcheck();\n\n\t\t}\n\n\t}\n\n\tisOccluded( renderContext, object ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\treturn renderContextData.occluded && renderContextData.occluded.has( object );\n\n\t}\n\n\tupdateViewport( renderContext ) {\n\n\t\tconst gl = this.gl;\n\t\tconst { x, y, width, height } = renderContext.viewportValue;\n\n\t\tgl.viewport( x, renderContext.height - height - y, width, height );\n\n\t}\n\n\tsetScissorTest( boolean ) {\n\n\t\tconst gl = this.gl;\n\n\t\tif ( boolean ) {\n\n\t\t\tgl.enable( gl.SCISSOR_TEST );\n\n\t\t} else {\n\n\t\t\tgl.disable( gl.SCISSOR_TEST );\n\n\t\t}\n\n\t}\n\n\tclear( color, depth, stencil, descriptor = null, setFrameBuffer = true ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( descriptor === null ) {\n\n\t\t\tconst clearColor = this.getClearColor();\n\n\t\t\t// premultiply alpha\n\n\t\t\tclearColor.r *= clearColor.a;\n\t\t\tclearColor.g *= clearColor.a;\n\t\t\tclearColor.b *= clearColor.a;\n\n\t\t\tdescriptor = {\n\t\t\t\ttextures: null,\n\t\t\t\tclearColorValue: clearColor\n\t\t\t};\n\n\t\t}\n\n\t\t//\n\n\t\tlet clear = 0;\n\n\t\tif ( color ) clear |= gl.COLOR_BUFFER_BIT;\n\t\tif ( depth ) clear |= gl.DEPTH_BUFFER_BIT;\n\t\tif ( stencil ) clear |= gl.STENCIL_BUFFER_BIT;\n\n\t\tif ( clear !== 0 ) {\n\n\t\t\tlet clearColor;\n\n\t\t\tif ( descriptor.clearColorValue ) {\n\n\t\t\t\tclearColor = descriptor.clearColorValue;\n\n\t\t\t} else {\n\n\t\t\t\tclearColor = this.getClearColor();\n\n\t\t\t\t// premultiply alpha\n\n\t\t\t\tclearColor.r *= clearColor.a;\n\t\t\t\tclearColor.g *= clearColor.a;\n\t\t\t\tclearColor.b *= clearColor.a;\n\n\t\t\t}\n\n\t\t\tif ( depth ) this.state.setDepthMask( true );\n\n\t\t\tif ( descriptor.textures === null ) {\n\n\t\t\t\tgl.clearColor( clearColor.r, clearColor.g, clearColor.b, clearColor.a );\n\t\t\t\tgl.clear( clear );\n\n\t\t\t} else {\n\n\t\t\t\tif ( setFrameBuffer ) this._setFramebuffer( descriptor );\n\n\t\t\t\tif ( color ) {\n\n\t\t\t\t\tfor ( let i = 0; i < descriptor.textures.length; i ++ ) {\n\n\t\t\t\t\t\tgl.clearBufferfv( gl.COLOR, i, [ clearColor.r, clearColor.g, clearColor.b, clearColor.a ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( depth && stencil ) {\n\n\t\t\t\t\tgl.clearBufferfi( gl.DEPTH_STENCIL, 0, 1, 0 );\n\n\t\t\t\t} else if ( depth ) {\n\n\t\t\t\t\tgl.clearBufferfv( gl.DEPTH, 0, [ 1.0 ] );\n\n\t\t\t\t} else if ( stencil ) {\n\n\t\t\t\t\tgl.clearBufferiv( gl.STENCIL, 0, [ 0 ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tbeginCompute( computeGroup ) {\n\n\t\tconst { state, gl } = this;\n\n\t\tstate.bindFramebuffer( gl.FRAMEBUFFER, null );\n\t\tthis.initTimestampQuery( computeGroup );\n\n\t}\n\n\tcompute( computeGroup, computeNode, bindings, pipeline ) {\n\n\t\tconst { state, gl } = this;\n\n\t\tif ( ! this.discard ) {\n\n\t\t\t// required here to handle async behaviour of render.compute()\n\t\t\tgl.enable( gl.RASTERIZER_DISCARD );\n\t\t\tthis.discard = true;\n\n\t\t}\n\n\t\tconst { programGPU, transformBuffers, attributes } = this.get( pipeline );\n\n\t\tconst vaoKey = this._getVaoKey( null, attributes );\n\n\t\tconst vaoGPU = this.vaoCache[ vaoKey ];\n\n\t\tif ( vaoGPU === undefined ) {\n\n\t\t\tthis._createVao( null, attributes );\n\n\t\t} else {\n\n\t\t\tgl.bindVertexArray( vaoGPU );\n\n\t\t}\n\n\t\tstate.useProgram( programGPU );\n\n\t\tthis._bindUniforms( bindings );\n\n\t\tconst transformFeedbackGPU = this._getTransformFeedback( transformBuffers );\n\n\t\tgl.bindTransformFeedback( gl.TRANSFORM_FEEDBACK, transformFeedbackGPU );\n\t\tgl.beginTransformFeedback( gl.POINTS );\n\n\t\tif ( attributes[ 0 ].isStorageInstancedBufferAttribute ) {\n\n\t\t\tgl.drawArraysInstanced( gl.POINTS, 0, 1, computeNode.count );\n\n\t\t} else {\n\n\t\t\tgl.drawArrays( gl.POINTS, 0, computeNode.count );\n\n\t\t}\n\n\t\tgl.endTransformFeedback();\n\t\tgl.bindTransformFeedback( gl.TRANSFORM_FEEDBACK, null );\n\n\t\t// switch active buffers\n\n\t\tfor ( let i = 0; i < transformBuffers.length; i ++ ) {\n\n\t\t\tconst dualAttributeData = transformBuffers[ i ];\n\n\t\t\tif ( dualAttributeData.pbo ) {\n\n\t\t\t\tthis.textureUtils.copyBufferToTexture( dualAttributeData.transformBuffer, dualAttributeData.pbo );\n\n\t\t\t}\n\n\t\t\tdualAttributeData.switchBuffers();\n\n\n\t\t}\n\n\t}\n\n\tfinishCompute( computeGroup ) {\n\n\t\tconst gl = this.gl;\n\n\t\tthis.discard = false;\n\n\t\tgl.disable( gl.RASTERIZER_DISCARD );\n\n\t\tthis.prepareTimestampBuffer( computeGroup );\n\n\t\tif ( this._currentContext ) {\n\n\t\t\tthis._setFramebuffer( this._currentContext );\n\n\t\t}\n\n\t}\n\n\tdraw( renderObject/*, info*/ ) {\n\n\t\tconst { object, pipeline, material, context, hardwareClippingPlanes } = renderObject;\n\t\tconst { programGPU } = this.get( pipeline );\n\n\t\tconst { gl, state } = this;\n\n\t\tconst contextData = this.get( context );\n\n\t\tconst drawParams = renderObject.getDrawParameters();\n\n\t\tif ( drawParams === null ) return;\n\n\t\t//\n\n\t\tthis._bindUniforms( renderObject.getBindings() );\n\n\t\tconst frontFaceCW = ( object.isMesh && object.matrixWorld.determinant() < 0 );\n\n\t\tstate.setMaterial( material, frontFaceCW, hardwareClippingPlanes );\n\n\t\tstate.useProgram( programGPU );\n\n\t\t//\n\n\t\tconst renderObjectData = this.get( renderObject );\n\n\t\tlet vaoGPU = renderObjectData.staticVao;\n\n\t\tif ( vaoGPU === undefined || renderObjectData.geometryId !== renderObject.geometry.id ) {\n\n\t\t\tconst vaoKey = this._getVaoKey( renderObject.getIndex(), renderObject.getAttributes() );\n\n\t\t\tvaoGPU = this.vaoCache[ vaoKey ];\n\n\t\t\tif ( vaoGPU === undefined ) {\n\n\t\t\t\tlet staticVao;\n\n\t\t\t\t( { vaoGPU, staticVao } = this._createVao( renderObject.getIndex(), renderObject.getAttributes() ) );\n\n\t\t\t\tif ( staticVao ) {\n\n\t\t\t\t\trenderObjectData.staticVao = vaoGPU;\n\t\t\t\t\trenderObjectData.geometryId = renderObject.geometry.id;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tgl.bindVertexArray( vaoGPU );\n\n\t\t//\n\n\t\tconst index = renderObject.getIndex();\n\n\t\t//\n\n\t\tconst lastObject = contextData.lastOcclusionObject;\n\n\t\tif ( lastObject !== object && lastObject !== undefined ) {\n\n\t\t\tif ( lastObject !== null && lastObject.occlusionTest === true ) {\n\n\t\t\t\tgl.endQuery( gl.ANY_SAMPLES_PASSED );\n\n\t\t\t\tcontextData.occlusionQueryIndex ++;\n\n\t\t\t}\n\n\t\t\tif ( object.occlusionTest === true ) {\n\n\t\t\t\tconst query = gl.createQuery();\n\n\t\t\t\tgl.beginQuery( gl.ANY_SAMPLES_PASSED, query );\n\n\t\t\t\tcontextData.occlusionQueries[ contextData.occlusionQueryIndex ] = query;\n\t\t\t\tcontextData.occlusionQueryObjects[ contextData.occlusionQueryIndex ] = object;\n\n\t\t\t}\n\n\t\t\tcontextData.lastOcclusionObject = object;\n\n\t\t}\n\n\t\t//\n\t\tconst renderer = this.bufferRenderer;\n\n\t\tif ( object.isPoints ) renderer.mode = gl.POINTS;\n\t\telse if ( object.isLineSegments ) renderer.mode = gl.LINES;\n\t\telse if ( object.isLine ) renderer.mode = gl.LINE_STRIP;\n\t\telse if ( object.isLineLoop ) renderer.mode = gl.LINE_LOOP;\n\t\telse {\n\n\t\t\tif ( material.wireframe === true ) {\n\n\t\t\t\tstate.setLineWidth( material.wireframeLinewidth * this.renderer.getPixelRatio() );\n\t\t\t\trenderer.mode = gl.LINES;\n\n\t\t\t} else {\n\n\t\t\t\trenderer.mode = gl.TRIANGLES;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst { vertexCount, instanceCount } = drawParams;\n\t\tlet { firstVertex } = drawParams;\n\n\t\trenderer.object = object;\n\n\t\tif ( index !== null ) {\n\n\t\t\tfirstVertex *= index.array.BYTES_PER_ELEMENT;\n\n\t\t\tconst indexData = this.get( index );\n\n\t\t\trenderer.index = index.count;\n\t\t\trenderer.type = indexData.type;\n\n\t\t} else {\n\n\t\t\trenderer.index = 0;\n\n\t\t}\n\n\t\tif ( object.isBatchedMesh ) {\n\n\t\t\tif ( object._multiDrawInstances !== null ) {\n\n\t\t\t\trenderer.renderMultiDrawInstances( object._multiDrawStarts, object._multiDrawCounts, object._multiDrawCount, object._multiDrawInstances );\n\n\t\t\t} else if ( ! this.hasFeature( 'WEBGL_multi_draw' ) ) {\n\n\t\t\t\twarnOnce( 'THREE.WebGLRenderer: WEBGL_multi_draw not supported.' );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.renderMultiDraw( object._multiDrawStarts, object._multiDrawCounts, object._multiDrawCount );\n\n\t\t\t}\n\n\t\t} else if ( instanceCount > 1 ) {\n\n\t\t\trenderer.renderInstances( firstVertex, vertexCount, instanceCount );\n\n\t\t} else {\n\n\t\t\trenderer.render( firstVertex, vertexCount );\n\n\t\t}\n\t\t//\n\n\t\tgl.bindVertexArray( null );\n\n\t}\n\n\tneedsRenderUpdate( /*renderObject*/ ) {\n\n\t\treturn false;\n\n\t}\n\n\tgetRenderCacheKey( /*renderObject*/ ) {\n\n\t\treturn '';\n\n\t}\n\n\t// textures\n\n\tcreateDefaultTexture( texture ) {\n\n\t\tthis.textureUtils.createDefaultTexture( texture );\n\n\t}\n\n\tcreateTexture( texture, options ) {\n\n\t\tthis.textureUtils.createTexture( texture, options );\n\n\t}\n\n\tupdateTexture( texture, options ) {\n\n\t\tthis.textureUtils.updateTexture( texture, options );\n\n\t}\n\n\tgenerateMipmaps( texture ) {\n\n\t\tthis.textureUtils.generateMipmaps( texture );\n\n\t}\n\n\n\tdestroyTexture( texture ) {\n\n\t\tthis.textureUtils.destroyTexture( texture );\n\n\t}\n\n\tcopyTextureToBuffer( texture, x, y, width, height, faceIndex ) {\n\n\t\treturn this.textureUtils.copyTextureToBuffer( texture, x, y, width, height, faceIndex );\n\n\t}\n\n\tcreateSampler( /*texture*/ ) {\n\n\t\t//console.warn( 'Abstract class.' );\n\n\t}\n\n\tdestroySampler() {}\n\n\t// node builder\n\n\tcreateNodeBuilder( object, renderer ) {\n\n\t\treturn new GLSLNodeBuilder( object, renderer );\n\n\t}\n\n\t// program\n\n\tcreateProgram( program ) {\n\n\t\tconst gl = this.gl;\n\t\tconst { stage, code } = program;\n\n\t\tconst shader = stage === 'fragment' ? gl.createShader( gl.FRAGMENT_SHADER ) : gl.createShader( gl.VERTEX_SHADER );\n\n\t\tgl.shaderSource( shader, code );\n\t\tgl.compileShader( shader );\n\n\t\tthis.set( program, {\n\t\t\tshaderGPU: shader\n\t\t} );\n\n\t}\n\n\tdestroyProgram( /*program*/ ) {\n\n\t\tconsole.warn( 'Abstract class.' );\n\n\t}\n\n\tcreateRenderPipeline( renderObject, promises ) {\n\n\t\tconst gl = this.gl;\n\t\tconst pipeline = renderObject.pipeline;\n\n\t\t// Program\n\n\t\tconst { fragmentProgram, vertexProgram } = pipeline;\n\n\t\tconst programGPU = gl.createProgram();\n\n\t\tconst fragmentShader = this.get( fragmentProgram ).shaderGPU;\n\t\tconst vertexShader = this.get( vertexProgram ).shaderGPU;\n\n\t\tgl.attachShader( programGPU, fragmentShader );\n\t\tgl.attachShader( programGPU, vertexShader );\n\t\tgl.linkProgram( programGPU );\n\n\t\tthis.set( pipeline, {\n\t\t\tprogramGPU,\n\t\t\tfragmentShader,\n\t\t\tvertexShader\n\t\t} );\n\n\t\tif ( promises !== null && this.parallel ) {\n\n\t\t\tconst p = new Promise( ( resolve /*, reject*/ ) => {\n\n\t\t\t\tconst parallel = this.parallel;\n\t\t\t\tconst checkStatus = () => {\n\n\t\t\t\t\tif ( gl.getProgramParameter( programGPU, parallel.COMPLETION_STATUS_KHR ) ) {\n\n\t\t\t\t\t\tthis._completeCompile( renderObject, pipeline );\n\t\t\t\t\t\tresolve();\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\trequestAnimationFrame( checkStatus );\n\n\t\t\t\t\t}\n\n\t\t\t\t};\n\n\t\t\t\tcheckStatus();\n\n\t\t\t} );\n\n\t\t\tpromises.push( p );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis._completeCompile( renderObject, pipeline );\n\n\t}\n\n\t_handleSource( string, errorLine ) {\n\n\t\tconst lines = string.split( '\\n' );\n\t\tconst lines2 = [];\n\n\t\tconst from = Math.max( errorLine - 6, 0 );\n\t\tconst to = Math.min( errorLine + 6, lines.length );\n\n\t\tfor ( let i = from; i < to; i ++ ) {\n\n\t\t\tconst line = i + 1;\n\t\t\tlines2.push( `${line === errorLine ? '>' : ' '} ${line}: ${lines[ i ]}` );\n\n\t\t}\n\n\t\treturn lines2.join( '\\n' );\n\n\t}\n\n\t_getShaderErrors( gl, shader, type ) {\n\n\t\tconst status = gl.getShaderParameter( shader, gl.COMPILE_STATUS );\n\t\tconst errors = gl.getShaderInfoLog( shader ).trim();\n\n\t\tif ( status && errors === '' ) return '';\n\n\t\tconst errorMatches = /ERROR: 0:(\\d+)/.exec( errors );\n\t\tif ( errorMatches ) {\n\n\t\t\tconst errorLine = parseInt( errorMatches[ 1 ] );\n\t\t\treturn type.toUpperCase() + '\\n\\n' + errors + '\\n\\n' + this._handleSource( gl.getShaderSource( shader ), errorLine );\n\n\t\t} else {\n\n\t\t\treturn errors;\n\n\t\t}\n\n\t}\n\n\t_logProgramError( programGPU, glFragmentShader, glVertexShader ) {\n\n\t\tif ( this.renderer.debug.checkShaderErrors ) {\n\n\t\t\tconst gl = this.gl;\n\n\t\t\tconst programLog = gl.getProgramInfoLog( programGPU ).trim();\n\n\t\t\tif ( gl.getProgramParameter( programGPU, gl.LINK_STATUS ) === false ) {\n\n\n\t\t\t\tif ( typeof this.renderer.debug.onShaderError === 'function' ) {\n\n\t\t\t\t\tthis.renderer.debug.onShaderError( gl, programGPU, glVertexShader, glFragmentShader );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// default error reporting\n\n\t\t\t\t\tconst vertexErrors = this._getShaderErrors( gl, glVertexShader, 'vertex' );\n\t\t\t\t\tconst fragmentErrors = this._getShaderErrors( gl, glFragmentShader, 'fragment' );\n\n\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t'THREE.WebGLProgram: Shader Error ' + gl.getError() + ' - ' +\n\t\t\t\t\t\t'VALIDATE_STATUS ' + gl.getProgramParameter( programGPU, gl.VALIDATE_STATUS ) + '\\n\\n' +\n\t\t\t\t\t\t'Program Info Log: ' + programLog + '\\n' +\n\t\t\t\t\t\tvertexErrors + '\\n' +\n\t\t\t\t\t\tfragmentErrors\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t} else if ( programLog !== '' ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLProgram: Program Info Log:', programLog );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_completeCompile( renderObject, pipeline ) {\n\n\t\tconst { state, gl } = this;\n\t\tconst pipelineData = this.get( pipeline );\n\t\tconst { programGPU, fragmentShader, vertexShader } = pipelineData;\n\n\t\tif ( gl.getProgramParameter( programGPU, gl.LINK_STATUS ) === false ) {\n\n\t\t\tthis._logProgramError( programGPU, fragmentShader, vertexShader );\n\n\t\t}\n\n\t\tstate.useProgram( programGPU );\n\n\t\t// Bindings\n\n\t\tconst bindings = renderObject.getBindings();\n\n\t\tthis._setupBindings( bindings, programGPU );\n\n\t\t//\n\n\t\tthis.set( pipeline, {\n\t\t\tprogramGPU\n\t\t} );\n\n\t}\n\n\tcreateComputePipeline( computePipeline, bindings ) {\n\n\t\tconst { state, gl } = this;\n\n\t\t// Program\n\n\t\tconst fragmentProgram = {\n\t\t\tstage: 'fragment',\n\t\t\tcode: '#version 300 es\\nprecision highp float;\\nvoid main() {}'\n\t\t};\n\n\t\tthis.createProgram( fragmentProgram );\n\n\t\tconst { computeProgram } = computePipeline;\n\n\t\tconst programGPU = gl.createProgram();\n\n\t\tconst fragmentShader = this.get( fragmentProgram ).shaderGPU;\n\t\tconst vertexShader = this.get( computeProgram ).shaderGPU;\n\n\t\tconst transforms = computeProgram.transforms;\n\n\t\tconst transformVaryingNames = [];\n\t\tconst transformAttributeNodes = [];\n\n\t\tfor ( let i = 0; i < transforms.length; i ++ ) {\n\n\t\t\tconst transform = transforms[ i ];\n\n\t\t\ttransformVaryingNames.push( transform.varyingName );\n\t\t\ttransformAttributeNodes.push( transform.attributeNode );\n\n\t\t}\n\n\t\tgl.attachShader( programGPU, fragmentShader );\n\t\tgl.attachShader( programGPU, vertexShader );\n\n\t\tgl.transformFeedbackVaryings(\n\t\t\tprogramGPU,\n\t\t\ttransformVaryingNames,\n\t\t\tgl.SEPARATE_ATTRIBS\n\t\t);\n\n\t\tgl.linkProgram( programGPU );\n\n\t\tif ( gl.getProgramParameter( programGPU, gl.LINK_STATUS ) === false ) {\n\n\t\t\tthis._logProgramError( programGPU, fragmentShader, vertexShader );\n\n\n\t\t}\n\n\t\tstate.useProgram( programGPU );\n\n\t\t// Bindings\n\n\t\tthis._setupBindings( bindings, programGPU );\n\n\t\tconst attributeNodes = computeProgram.attributes;\n\t\tconst attributes = [];\n\t\tconst transformBuffers = [];\n\n\t\tfor ( let i = 0; i < attributeNodes.length; i ++ ) {\n\n\t\t\tconst attribute = attributeNodes[ i ].node.attribute;\n\n\t\t\tattributes.push( attribute );\n\n\t\t\tif ( ! this.has( attribute ) ) this.attributeUtils.createAttribute( attribute, gl.ARRAY_BUFFER );\n\n\t\t}\n\n\t\tfor ( let i = 0; i < transformAttributeNodes.length; i ++ ) {\n\n\t\t\tconst attribute = transformAttributeNodes[ i ].attribute;\n\n\t\t\tif ( ! this.has( attribute ) ) this.attributeUtils.createAttribute( attribute, gl.ARRAY_BUFFER );\n\n\t\t\tconst attributeData = this.get( attribute );\n\n\t\t\ttransformBuffers.push( attributeData );\n\n\t\t}\n\n\t\t//\n\n\t\tthis.set( computePipeline, {\n\t\t\tprogramGPU,\n\t\t\ttransformBuffers,\n\t\t\tattributes\n\t\t} );\n\n\t}\n\n\tcreateBindings( bindGroup, bindings ) {\n\n\t\tif ( this._knownBindings.has( bindings ) === false ) {\n\n\t\t\tthis._knownBindings.add( bindings );\n\n\t\t\tlet uniformBuffers = 0;\n\t\t\tlet textures = 0;\n\n\t\t\tfor ( const bindGroup of bindings ) {\n\n\t\t\t\tthis.set( bindGroup, {\n\t\t\t\t\ttextures: textures,\n\t\t\t\t\tuniformBuffers: uniformBuffers\n\t\t\t\t} );\n\n\t\t\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\t\t\tif ( binding.isUniformBuffer ) uniformBuffers ++;\n\t\t\t\t\tif ( binding.isSampledTexture ) textures ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.updateBindings( bindGroup, bindings );\n\n\t}\n\n\tupdateBindings( bindGroup /*, bindings*/ ) {\n\n\t\tconst { gl } = this;\n\n\t\tconst bindGroupData = this.get( bindGroup );\n\n\t\tlet i = bindGroupData.uniformBuffers;\n\t\tlet t = bindGroupData.textures;\n\n\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\tif ( binding.isUniformsGroup || binding.isUniformBuffer ) {\n\n\t\t\t\tconst data = binding.buffer;\n\t\t\t\tconst bufferGPU = gl.createBuffer();\n\n\t\t\t\tgl.bindBuffer( gl.UNIFORM_BUFFER, bufferGPU );\n\t\t\t\tgl.bufferData( gl.UNIFORM_BUFFER, data, gl.DYNAMIC_DRAW );\n\n\t\t\t\tthis.set( binding, {\n\t\t\t\t\tindex: i ++,\n\t\t\t\t\tbufferGPU\n\t\t\t\t} );\n\n\t\t\t} else if ( binding.isSampledTexture ) {\n\n\t\t\t\tconst { textureGPU, glTextureType } = this.get( binding.texture );\n\n\t\t\t\tthis.set( binding, {\n\t\t\t\t\tindex: t ++,\n\t\t\t\t\ttextureGPU,\n\t\t\t\t\tglTextureType\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tupdateBinding( binding ) {\n\n\t\tconst gl = this.gl;\n\n\t\tif ( binding.isUniformsGroup || binding.isUniformBuffer ) {\n\n\t\t\tconst bindingData = this.get( binding );\n\t\t\tconst bufferGPU = bindingData.bufferGPU;\n\t\t\tconst data = binding.buffer;\n\n\t\t\tgl.bindBuffer( gl.UNIFORM_BUFFER, bufferGPU );\n\t\t\tgl.bufferData( gl.UNIFORM_BUFFER, data, gl.DYNAMIC_DRAW );\n\n\t\t}\n\n\t}\n\n\t// attributes\n\n\tcreateIndexAttribute( attribute ) {\n\n\t\tconst gl = this.gl;\n\n\t\tthis.attributeUtils.createAttribute( attribute, gl.ELEMENT_ARRAY_BUFFER );\n\n\t}\n\n\tcreateAttribute( attribute ) {\n\n\t\tif ( this.has( attribute ) ) return;\n\n\t\tconst gl = this.gl;\n\n\t\tthis.attributeUtils.createAttribute( attribute, gl.ARRAY_BUFFER );\n\n\t}\n\n\tcreateStorageAttribute( attribute ) {\n\n\t\tif ( this.has( attribute ) ) return;\n\n\t\tconst gl = this.gl;\n\n\t\tthis.attributeUtils.createAttribute( attribute, gl.ARRAY_BUFFER );\n\n\t}\n\n\tupdateAttribute( attribute ) {\n\n\t\tthis.attributeUtils.updateAttribute( attribute );\n\n\t}\n\n\tdestroyAttribute( attribute ) {\n\n\t\tthis.attributeUtils.destroyAttribute( attribute );\n\n\t}\n\n\tupdateSize() {\n\n\t\t//console.warn( 'Abstract class.' );\n\n\t}\n\n\thasFeature( name ) {\n\n\t\tconst keysMatching = Object.keys( GLFeatureName ).filter( key => GLFeatureName[ key ] === name );\n\n\t\tconst extensions = this.extensions;\n\n\t\tfor ( let i = 0; i < keysMatching.length; i ++ ) {\n\n\t\t\tif ( extensions.has( keysMatching[ i ] ) ) return true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tgetMaxAnisotropy() {\n\n\t\treturn this.capabilities.getMaxAnisotropy();\n\n\t}\n\n\tcopyTextureToTexture( srcTexture, dstTexture, srcRegion, dstPosition, level ) {\n\n\t\tthis.textureUtils.copyTextureToTexture( srcTexture, dstTexture, srcRegion, dstPosition, level );\n\n\t}\n\n\tcopyFramebufferToTexture( texture, renderContext, rectangle ) {\n\n\t\tthis.textureUtils.copyFramebufferToTexture( texture, renderContext, rectangle );\n\n\t}\n\n\t_setFramebuffer( descriptor ) {\n\n\t\tconst { gl, state } = this;\n\n\t\tlet currentFrameBuffer = null;\n\n\t\tif ( descriptor.textures !== null ) {\n\n\t\t\tconst renderTarget = descriptor.renderTarget;\n\t\t\tconst renderTargetContextData = this.get( renderTarget );\n\t\t\tconst { samples, depthBuffer, stencilBuffer } = renderTarget;\n\n\t\t\tconst isCube = renderTarget.isWebGLCubeRenderTarget === true;\n\n\t\t\tlet msaaFb = renderTargetContextData.msaaFrameBuffer;\n\t\t\tlet depthRenderbuffer = renderTargetContextData.depthRenderbuffer;\n\n\t\t\tconst cacheKey = getCacheKey( descriptor );\n\n\t\t\tlet fb;\n\n\t\t\tif ( isCube ) {\n\n\t\t\t\trenderTargetContextData.cubeFramebuffers || ( renderTargetContextData.cubeFramebuffers = {} );\n\n\t\t\t\tfb = renderTargetContextData.cubeFramebuffers[ cacheKey ];\n\n\t\t\t} else {\n\n\t\t\t\trenderTargetContextData.framebuffers || ( renderTargetContextData.framebuffers = {} );\n\n\t\t\t\tfb = renderTargetContextData.framebuffers[ cacheKey ];\n\n\t\t\t}\n\n\t\t\tif ( fb === undefined ) {\n\n\t\t\t\tfb = gl.createFramebuffer();\n\n\t\t\t\tstate.bindFramebuffer( gl.FRAMEBUFFER, fb );\n\n\t\t\t\tconst textures = descriptor.textures;\n\n\t\t\t\tif ( isCube ) {\n\n\t\t\t\t\trenderTargetContextData.cubeFramebuffers[ cacheKey ] = fb;\n\n\t\t\t\t\tconst { textureGPU } = this.get( textures[ 0 ] );\n\n\t\t\t\t\tconst cubeFace = this.renderer._activeCubeFace;\n\n\t\t\t\t\tgl.framebufferTexture2D( gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_CUBE_MAP_POSITIVE_X + cubeFace, textureGPU, 0 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\trenderTargetContextData.framebuffers[ cacheKey ] = fb;\n\n\t\t\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\t\t\tconst texture = textures[ i ];\n\t\t\t\t\t\tconst textureData = this.get( texture );\n\t\t\t\t\t\ttextureData.renderTarget = descriptor.renderTarget;\n\t\t\t\t\t\ttextureData.cacheKey = cacheKey; // required for copyTextureToTexture()\n\n\t\t\t\t\t\tconst attachment = gl.COLOR_ATTACHMENT0 + i;\n\n\t\t\t\t\t\tgl.framebufferTexture2D( gl.FRAMEBUFFER, attachment, gl.TEXTURE_2D, textureData.textureGPU, 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.drawBuffers( descriptor, fb );\n\n\t\t\t\t}\n\n\t\t\t\tif ( descriptor.depthTexture !== null ) {\n\n\t\t\t\t\tconst textureData = this.get( descriptor.depthTexture );\n\t\t\t\t\tconst depthStyle = stencilBuffer ? gl.DEPTH_STENCIL_ATTACHMENT : gl.DEPTH_ATTACHMENT;\n\t\t\t\t\ttextureData.renderTarget = descriptor.renderTarget;\n\t\t\t\t\ttextureData.cacheKey = cacheKey; // required for copyTextureToTexture()\n\n\t\t\t\t\tgl.framebufferTexture2D( gl.FRAMEBUFFER, depthStyle, gl.TEXTURE_2D, textureData.textureGPU, 0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( samples > 0 ) {\n\n\t\t\t\tif ( msaaFb === undefined ) {\n\n\t\t\t\t\tconst invalidationArray = [];\n\n\t\t\t\t\tmsaaFb = gl.createFramebuffer();\n\n\t\t\t\t\tstate.bindFramebuffer( gl.FRAMEBUFFER, msaaFb );\n\n\t\t\t\t\tconst msaaRenderbuffers = [];\n\n\t\t\t\t\tconst textures = descriptor.textures;\n\n\t\t\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\t\t\tmsaaRenderbuffers[ i ] = gl.createRenderbuffer();\n\n\t\t\t\t\t\tgl.bindRenderbuffer( gl.RENDERBUFFER, msaaRenderbuffers[ i ] );\n\n\t\t\t\t\t\tinvalidationArray.push( gl.COLOR_ATTACHMENT0 + i );\n\n\t\t\t\t\t\tif ( depthBuffer ) {\n\n\t\t\t\t\t\t\tconst depthStyle = stencilBuffer ? gl.DEPTH_STENCIL_ATTACHMENT : gl.DEPTH_ATTACHMENT;\n\t\t\t\t\t\t\tinvalidationArray.push( depthStyle );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst texture = descriptor.textures[ i ];\n\t\t\t\t\t\tconst textureData = this.get( texture );\n\n\t\t\t\t\t\tgl.renderbufferStorageMultisample( gl.RENDERBUFFER, samples, textureData.glInternalFormat, descriptor.width, descriptor.height );\n\t\t\t\t\t\tgl.framebufferRenderbuffer( gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0 + i, gl.RENDERBUFFER, msaaRenderbuffers[ i ] );\n\n\n\t\t\t\t\t}\n\n\t\t\t\t\trenderTargetContextData.msaaFrameBuffer = msaaFb;\n\t\t\t\t\trenderTargetContextData.msaaRenderbuffers = msaaRenderbuffers;\n\n\t\t\t\t\tif ( depthRenderbuffer === undefined ) {\n\n\t\t\t\t\t\tdepthRenderbuffer = gl.createRenderbuffer();\n\t\t\t\t\t\tthis.textureUtils.setupRenderBufferStorage( depthRenderbuffer, descriptor );\n\n\t\t\t\t\t\trenderTargetContextData.depthRenderbuffer = depthRenderbuffer;\n\n\t\t\t\t\t\tconst depthStyle = stencilBuffer ? gl.DEPTH_STENCIL_ATTACHMENT : gl.DEPTH_ATTACHMENT;\n\t\t\t\t\t\tinvalidationArray.push( depthStyle );\n\n\t\t\t\t\t}\n\n\t\t\t\t\trenderTargetContextData.invalidationArray = invalidationArray;\n\n\t\t\t\t}\n\n\t\t\t\tcurrentFrameBuffer = renderTargetContextData.msaaFrameBuffer;\n\n\t\t\t} else {\n\n\t\t\t\tcurrentFrameBuffer = fb;\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.bindFramebuffer( gl.FRAMEBUFFER, currentFrameBuffer );\n\n\t}\n\n\n\t_getVaoKey( index, attributes ) {\n\n\t\tlet key = [];\n\n\t\tif ( index !== null ) {\n\n\t\t\tconst indexData = this.get( index );\n\n\t\t\tkey += ':' + indexData.id;\n\n\t\t}\n\n\t\tfor ( let i = 0; i < attributes.length; i ++ ) {\n\n\t\t\tconst attributeData = this.get( attributes[ i ] );\n\n\t\t\tkey += ':' + attributeData.id;\n\n\t\t}\n\n\t\treturn key;\n\n\t}\n\n\t_createVao( index, attributes ) {\n\n\t\tconst { gl } = this;\n\n\t\tconst vaoGPU = gl.createVertexArray();\n\t\tlet key = '';\n\n\t\tlet staticVao = true;\n\n\t\tgl.bindVertexArray( vaoGPU );\n\n\t\tif ( index !== null ) {\n\n\t\t\tconst indexData = this.get( index );\n\n\t\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, indexData.bufferGPU );\n\n\t\t\tkey += ':' + indexData.id;\n\n\t\t}\n\n\t\tfor ( let i = 0; i < attributes.length; i ++ ) {\n\n\t\t\tconst attribute = attributes[ i ];\n\t\t\tconst attributeData = this.get( attribute );\n\n\t\t\tkey += ':' + attributeData.id;\n\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, attributeData.bufferGPU );\n\t\t\tgl.enableVertexAttribArray( i );\n\n\t\t\tif ( attribute.isStorageBufferAttribute || attribute.isStorageInstancedBufferAttribute ) staticVao = false;\n\n\t\t\tlet stride, offset;\n\n\t\t\tif ( attribute.isInterleavedBufferAttribute === true ) {\n\n\t\t\t\tstride = attribute.data.stride * attributeData.bytesPerElement;\n\t\t\t\toffset = attribute.offset * attributeData.bytesPerElement;\n\n\t\t\t} else {\n\n\t\t\t\tstride = 0;\n\t\t\t\toffset = 0;\n\n\t\t\t}\n\n\t\t\tif ( attributeData.isInteger ) {\n\n\t\t\t\tgl.vertexAttribIPointer( i, attribute.itemSize, attributeData.type, stride, offset );\n\n\t\t\t} else {\n\n\t\t\t\tgl.vertexAttribPointer( i, attribute.itemSize, attributeData.type, attribute.normalized, stride, offset );\n\n\t\t\t}\n\n\t\t\tif ( attribute.isInstancedBufferAttribute && ! attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\tgl.vertexAttribDivisor( i, attribute.meshPerAttribute );\n\n\t\t\t} else if ( attribute.isInterleavedBufferAttribute && attribute.data.isInstancedInterleavedBuffer ) {\n\n\t\t\t\tgl.vertexAttribDivisor( i, attribute.data.meshPerAttribute );\n\n\t\t\t}\n\n\t\t}\n\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, null );\n\n\t\tthis.vaoCache[ key ] = vaoGPU;\n\n\t\treturn { vaoGPU, staticVao };\n\n\t}\n\n\t_getTransformFeedback( transformBuffers ) {\n\n\t\tlet key = '';\n\n\t\tfor ( let i = 0; i < transformBuffers.length; i ++ ) {\n\n\t\t\tkey += ':' + transformBuffers[ i ].id;\n\n\t\t}\n\n\t\tlet transformFeedbackGPU = this.transformFeedbackCache[ key ];\n\n\t\tif ( transformFeedbackGPU !== undefined ) {\n\n\t\t\treturn transformFeedbackGPU;\n\n\t\t}\n\n\t\tconst { gl } = this;\n\n\t\ttransformFeedbackGPU = gl.createTransformFeedback();\n\n\t\tgl.bindTransformFeedback( gl.TRANSFORM_FEEDBACK, transformFeedbackGPU );\n\n\t\tfor ( let i = 0; i < transformBuffers.length; i ++ ) {\n\n\t\t\tconst attributeData = transformBuffers[ i ];\n\n\t\t\tgl.bindBufferBase( gl.TRANSFORM_FEEDBACK_BUFFER, i, attributeData.transformBuffer );\n\n\t\t}\n\n\t\tgl.bindTransformFeedback( gl.TRANSFORM_FEEDBACK, null );\n\n\t\tthis.transformFeedbackCache[ key ] = transformFeedbackGPU;\n\n\t\treturn transformFeedbackGPU;\n\n\t}\n\n\n\t_setupBindings( bindings, programGPU ) {\n\n\t\tconst gl = this.gl;\n\n\t\tfor ( const bindGroup of bindings ) {\n\n\t\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\t\tconst bindingData = this.get( binding );\n\t\t\t\tconst index = bindingData.index;\n\n\t\t\t\tif ( binding.isUniformsGroup || binding.isUniformBuffer ) {\n\n\t\t\t\t\tconst location = gl.getUniformBlockIndex( programGPU, binding.name );\n\t\t\t\t\tgl.uniformBlockBinding( programGPU, location, index );\n\n\t\t\t\t} else if ( binding.isSampledTexture ) {\n\n\t\t\t\t\tconst location = gl.getUniformLocation( programGPU, binding.name );\n\t\t\t\t\tgl.uniform1i( location, index );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_bindUniforms( bindings ) {\n\n\t\tconst { gl, state } = this;\n\n\t\tfor ( const bindGroup of bindings ) {\n\n\t\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\t\tconst bindingData = this.get( binding );\n\t\t\t\tconst index = bindingData.index;\n\n\t\t\t\tif ( binding.isUniformsGroup || binding.isUniformBuffer ) {\n\n\t\t\t\t\t// TODO USE bindBufferRange to group multiple uniform buffers\n\t\t\t\t\tstate.bindBufferBase( gl.UNIFORM_BUFFER, index, bindingData.bufferGPU );\n\n\t\t\t\t} else if ( binding.isSampledTexture ) {\n\n\t\t\t\t\tstate.bindTexture( bindingData.glTextureType, bindingData.textureGPU, gl.TEXTURE0 + index );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tdispose() {\n\n\t\tthis.renderer.domElement.removeEventListener( 'webglcontextlost', this._onContextLost );\n\n\t}\n\n}\n\nconst GPUPrimitiveTopology = {\n\tPointList: 'point-list',\n\tLineList: 'line-list',\n\tLineStrip: 'line-strip',\n\tTriangleList: 'triangle-list',\n\tTriangleStrip: 'triangle-strip',\n};\n\nconst GPUCompareFunction = {\n\tNever: 'never',\n\tLess: 'less',\n\tEqual: 'equal',\n\tLessEqual: 'less-equal',\n\tGreater: 'greater',\n\tNotEqual: 'not-equal',\n\tGreaterEqual: 'greater-equal',\n\tAlways: 'always'\n};\n\nconst GPUStoreOp = {\n\tStore: 'store',\n\tDiscard: 'discard'\n};\n\nconst GPULoadOp = {\n\tLoad: 'load',\n\tClear: 'clear'\n};\n\nconst GPUFrontFace = {\n\tCCW: 'ccw',\n\tCW: 'cw'\n};\n\nconst GPUCullMode = {\n\tNone: 'none',\n\tFront: 'front',\n\tBack: 'back'\n};\n\nconst GPUIndexFormat = {\n\tUint16: 'uint16',\n\tUint32: 'uint32'\n};\n\nconst GPUTextureFormat = {\n\n\t// 8-bit formats\n\n\tR8Unorm: 'r8unorm',\n\tR8Snorm: 'r8snorm',\n\tR8Uint: 'r8uint',\n\tR8Sint: 'r8sint',\n\n\t// 16-bit formats\n\n\tR16Uint: 'r16uint',\n\tR16Sint: 'r16sint',\n\tR16Float: 'r16float',\n\tRG8Unorm: 'rg8unorm',\n\tRG8Snorm: 'rg8snorm',\n\tRG8Uint: 'rg8uint',\n\tRG8Sint: 'rg8sint',\n\n\t// 32-bit formats\n\n\tR32Uint: 'r32uint',\n\tR32Sint: 'r32sint',\n\tR32Float: 'r32float',\n\tRG16Uint: 'rg16uint',\n\tRG16Sint: 'rg16sint',\n\tRG16Float: 'rg16float',\n\tRGBA8Unorm: 'rgba8unorm',\n\tRGBA8UnormSRGB: 'rgba8unorm-srgb',\n\tRGBA8Snorm: 'rgba8snorm',\n\tRGBA8Uint: 'rgba8uint',\n\tRGBA8Sint: 'rgba8sint',\n\tBGRA8Unorm: 'bgra8unorm',\n\tBGRA8UnormSRGB: 'bgra8unorm-srgb',\n\t// Packed 32-bit formats\n\tRGB9E5UFloat: 'rgb9e5ufloat',\n\tRGB10A2Unorm: 'rgb10a2unorm',\n\tRG11B10uFloat: 'rgb10a2unorm',\n\n\t// 64-bit formats\n\n\tRG32Uint: 'rg32uint',\n\tRG32Sint: 'rg32sint',\n\tRG32Float: 'rg32float',\n\tRGBA16Uint: 'rgba16uint',\n\tRGBA16Sint: 'rgba16sint',\n\tRGBA16Float: 'rgba16float',\n\n\t// 128-bit formats\n\n\tRGBA32Uint: 'rgba32uint',\n\tRGBA32Sint: 'rgba32sint',\n\tRGBA32Float: 'rgba32float',\n\n\t// Depth and stencil formats\n\n\tStencil8: 'stencil8',\n\tDepth16Unorm: 'depth16unorm',\n\tDepth24Plus: 'depth24plus',\n\tDepth24PlusStencil8: 'depth24plus-stencil8',\n\tDepth32Float: 'depth32float',\n\n\t// 'depth32float-stencil8' extension\n\n\tDepth32FloatStencil8: 'depth32float-stencil8',\n\n\t// BC compressed formats usable if 'texture-compression-bc' is both\n\t// supported by the device/user agent and enabled in requestDevice.\n\n\tBC1RGBAUnorm: 'bc1-rgba-unorm',\n\tBC1RGBAUnormSRGB: 'bc1-rgba-unorm-srgb',\n\tBC2RGBAUnorm: 'bc2-rgba-unorm',\n\tBC2RGBAUnormSRGB: 'bc2-rgba-unorm-srgb',\n\tBC3RGBAUnorm: 'bc3-rgba-unorm',\n\tBC3RGBAUnormSRGB: 'bc3-rgba-unorm-srgb',\n\tBC4RUnorm: 'bc4-r-unorm',\n\tBC4RSnorm: 'bc4-r-snorm',\n\tBC5RGUnorm: 'bc5-rg-unorm',\n\tBC5RGSnorm: 'bc5-rg-snorm',\n\tBC6HRGBUFloat: 'bc6h-rgb-ufloat',\n\tBC6HRGBFloat: 'bc6h-rgb-float',\n\tBC7RGBAUnorm: 'bc7-rgba-unorm',\n\tBC7RGBAUnormSRGB: 'bc7-rgba-srgb',\n\n\t// ETC2 compressed formats usable if 'texture-compression-etc2' is both\n\t// supported by the device/user agent and enabled in requestDevice.\n\n\tETC2RGB8Unorm: 'etc2-rgb8unorm',\n\tETC2RGB8UnormSRGB: 'etc2-rgb8unorm-srgb',\n\tETC2RGB8A1Unorm: 'etc2-rgb8a1unorm',\n\tETC2RGB8A1UnormSRGB: 'etc2-rgb8a1unorm-srgb',\n\tETC2RGBA8Unorm: 'etc2-rgba8unorm',\n\tETC2RGBA8UnormSRGB: 'etc2-rgba8unorm-srgb',\n\tEACR11Unorm: 'eac-r11unorm',\n\tEACR11Snorm: 'eac-r11snorm',\n\tEACRG11Unorm: 'eac-rg11unorm',\n\tEACRG11Snorm: 'eac-rg11snorm',\n\n\t// ASTC compressed formats usable if 'texture-compression-astc' is both\n\t// supported by the device/user agent and enabled in requestDevice.\n\n\tASTC4x4Unorm: 'astc-4x4-unorm',\n\tASTC4x4UnormSRGB: 'astc-4x4-unorm-srgb',\n\tASTC5x4Unorm: 'astc-5x4-unorm',\n\tASTC5x4UnormSRGB: 'astc-5x4-unorm-srgb',\n\tASTC5x5Unorm: 'astc-5x5-unorm',\n\tASTC5x5UnormSRGB: 'astc-5x5-unorm-srgb',\n\tASTC6x5Unorm: 'astc-6x5-unorm',\n\tASTC6x5UnormSRGB: 'astc-6x5-unorm-srgb',\n\tASTC6x6Unorm: 'astc-6x6-unorm',\n\tASTC6x6UnormSRGB: 'astc-6x6-unorm-srgb',\n\tASTC8x5Unorm: 'astc-8x5-unorm',\n\tASTC8x5UnormSRGB: 'astc-8x5-unorm-srgb',\n\tASTC8x6Unorm: 'astc-8x6-unorm',\n\tASTC8x6UnormSRGB: 'astc-8x6-unorm-srgb',\n\tASTC8x8Unorm: 'astc-8x8-unorm',\n\tASTC8x8UnormSRGB: 'astc-8x8-unorm-srgb',\n\tASTC10x5Unorm: 'astc-10x5-unorm',\n\tASTC10x5UnormSRGB: 'astc-10x5-unorm-srgb',\n\tASTC10x6Unorm: 'astc-10x6-unorm',\n\tASTC10x6UnormSRGB: 'astc-10x6-unorm-srgb',\n\tASTC10x8Unorm: 'astc-10x8-unorm',\n\tASTC10x8UnormSRGB: 'astc-10x8-unorm-srgb',\n\tASTC10x10Unorm: 'astc-10x10-unorm',\n\tASTC10x10UnormSRGB: 'astc-10x10-unorm-srgb',\n\tASTC12x10Unorm: 'astc-12x10-unorm',\n\tASTC12x10UnormSRGB: 'astc-12x10-unorm-srgb',\n\tASTC12x12Unorm: 'astc-12x12-unorm',\n\tASTC12x12UnormSRGB: 'astc-12x12-unorm-srgb',\n\n};\n\nconst GPUAddressMode = {\n\tClampToEdge: 'clamp-to-edge',\n\tRepeat: 'repeat',\n\tMirrorRepeat: 'mirror-repeat'\n};\n\nconst GPUFilterMode = {\n\tLinear: 'linear',\n\tNearest: 'nearest'\n};\n\nconst GPUBlendFactor = {\n\tZero: 'zero',\n\tOne: 'one',\n\tSrc: 'src',\n\tOneMinusSrc: 'one-minus-src',\n\tSrcAlpha: 'src-alpha',\n\tOneMinusSrcAlpha: 'one-minus-src-alpha',\n\tDst: 'dst',\n\tOneMinusDstColor: 'one-minus-dst',\n\tDstAlpha: 'dst-alpha',\n\tOneMinusDstAlpha: 'one-minus-dst-alpha',\n\tSrcAlphaSaturated: 'src-alpha-saturated',\n\tConstant: 'constant',\n\tOneMinusConstant: 'one-minus-constant'\n};\n\nconst GPUBlendOperation = {\n\tAdd: 'add',\n\tSubtract: 'subtract',\n\tReverseSubtract: 'reverse-subtract',\n\tMin: 'min',\n\tMax: 'max'\n};\n\nconst GPUColorWriteFlags = {\n\tNone: 0,\n\tRed: 0x1,\n\tGreen: 0x2,\n\tBlue: 0x4,\n\tAlpha: 0x8,\n\tAll: 0xF\n};\n\nconst GPUStencilOperation = {\n\tKeep: 'keep',\n\tZero: 'zero',\n\tReplace: 'replace',\n\tInvert: 'invert',\n\tIncrementClamp: 'increment-clamp',\n\tDecrementClamp: 'decrement-clamp',\n\tIncrementWrap: 'increment-wrap',\n\tDecrementWrap: 'decrement-wrap'\n};\n\nconst GPUBufferBindingType = {\n\tUniform: 'uniform',\n\tStorage: 'storage',\n\tReadOnlyStorage: 'read-only-storage'\n};\n\nconst GPUStorageTextureAccess = {\n\tWriteOnly: 'write-only',\n\tReadOnly: 'read-only',\n\tReadWrite: 'read-write',\n};\n\nconst GPUTextureSampleType = {\n\tFloat: 'float',\n\tUnfilterableFloat: 'unfilterable-float',\n\tDepth: 'depth',\n\tSInt: 'sint',\n\tUInt: 'uint'\n};\n\nconst GPUTextureDimension = {\n\tOneD: '1d',\n\tTwoD: '2d',\n\tThreeD: '3d'\n};\n\nconst GPUTextureViewDimension = {\n\tOneD: '1d',\n\tTwoD: '2d',\n\tTwoDArray: '2d-array',\n\tCube: 'cube',\n\tCubeArray: 'cube-array',\n\tThreeD: '3d'\n};\n\nconst GPUTextureAspect = {\n\tAll: 'all',\n\tStencilOnly: 'stencil-only',\n\tDepthOnly: 'depth-only'\n};\n\nconst GPUInputStepMode = {\n\tVertex: 'vertex',\n\tInstance: 'instance'\n};\n\nconst GPUFeatureName = {\n\tDepthClipControl: 'depth-clip-control',\n\tDepth32FloatStencil8: 'depth32float-stencil8',\n\tTextureCompressionBC: 'texture-compression-bc',\n\tTextureCompressionETC2: 'texture-compression-etc2',\n\tTextureCompressionASTC: 'texture-compression-astc',\n\tTimestampQuery: 'timestamp-query',\n\tIndirectFirstInstance: 'indirect-first-instance',\n\tShaderF16: 'shader-f16',\n\tRG11B10UFloat: 'rg11b10ufloat-renderable',\n\tBGRA8UNormStorage: 'bgra8unorm-storage',\n\tFloat32Filterable: 'float32-filterable',\n\tClipDistances: 'clip-distances',\n\tDualSourceBlending: 'dual-source-blending',\n\tSubgroups: 'subgroups'\n};\n\nclass Sampler extends Binding {\n\n\tconstructor( name, texture ) {\n\n\t\tsuper( name );\n\n\t\tthis.texture = texture;\n\t\tthis.version = texture ? texture.version : 0;\n\n\t\tthis.isSampler = true;\n\n\t}\n\n}\n\nclass NodeSampler extends Sampler {\n\n\tconstructor( name, textureNode, groupNode ) {\n\n\t\tsuper( name, textureNode ? textureNode.value : null );\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.groupNode = groupNode;\n\n\t}\n\n\tupdate() {\n\n\t\tthis.texture = this.textureNode.value;\n\n\t}\n\n}\n\nclass StorageBuffer extends Buffer {\n\n\tconstructor( name, attribute ) {\n\n\t\tsuper( name, attribute ? attribute.array : null );\n\n\t\tthis.attribute = attribute;\n\n\t\tthis.isStorageBuffer = true;\n\n\t}\n\n}\n\nlet _id = 0;\n\nclass NodeStorageBuffer extends StorageBuffer {\n\n\tconstructor( nodeUniform, groupNode ) {\n\n\t\tsuper( 'StorageBuffer_' + _id ++, nodeUniform ? nodeUniform.value : null );\n\n\t\tthis.nodeUniform = nodeUniform;\n\t\tthis.access = nodeUniform ? nodeUniform.access : NodeAccess.READ_WRITE;\n\t\tthis.groupNode = groupNode;\n\n\t}\n\n\tget buffer() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n}\n\nclass WebGPUTexturePassUtils extends DataMap {\n\n\tconstructor( device ) {\n\n\t\tsuper();\n\n\t\tthis.device = device;\n\n\t\tconst mipmapVertexSource = `\nstruct VarysStruct {\n\t@builtin( position ) Position: vec4<f32>,\n\t@location( 0 ) vTex : vec2<f32>\n};\n\n@vertex\nfn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {\n\n\tvar Varys : VarysStruct;\n\n\tvar pos = array< vec2<f32>, 4 >(\n\t\tvec2<f32>( -1.0,  1.0 ),\n\t\tvec2<f32>(  1.0,  1.0 ),\n\t\tvec2<f32>( -1.0, -1.0 ),\n\t\tvec2<f32>(  1.0, -1.0 )\n\t);\n\n\tvar tex = array< vec2<f32>, 4 >(\n\t\tvec2<f32>( 0.0, 0.0 ),\n\t\tvec2<f32>( 1.0, 0.0 ),\n\t\tvec2<f32>( 0.0, 1.0 ),\n\t\tvec2<f32>( 1.0, 1.0 )\n\t);\n\n\tVarys.vTex = tex[ vertexIndex ];\n\tVarys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );\n\n\treturn Varys;\n\n}\n`;\n\n\t\tconst mipmapFragmentSource = `\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n\treturn textureSample( img, imgSampler, vTex );\n\n}\n`;\n\n\t\tconst flipYFragmentSource = `\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n\treturn textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );\n\n}\n`;\n\t\tthis.mipmapSampler = device.createSampler( { minFilter: GPUFilterMode.Linear } );\n\t\tthis.flipYSampler = device.createSampler( { minFilter: GPUFilterMode.Nearest } ); //@TODO?: Consider using textureLoad()\n\n\t\t// We'll need a new pipeline for every texture format used.\n\t\tthis.transferPipelines = {};\n\t\tthis.flipYPipelines = {};\n\n\t\tthis.mipmapVertexShaderModule = device.createShaderModule( {\n\t\t\tlabel: 'mipmapVertex',\n\t\t\tcode: mipmapVertexSource\n\t\t} );\n\n\t\tthis.mipmapFragmentShaderModule = device.createShaderModule( {\n\t\t\tlabel: 'mipmapFragment',\n\t\t\tcode: mipmapFragmentSource\n\t\t} );\n\n\t\tthis.flipYFragmentShaderModule = device.createShaderModule( {\n\t\t\tlabel: 'flipYFragment',\n\t\t\tcode: flipYFragmentSource\n\t\t} );\n\n\t}\n\n\tgetTransferPipeline( format ) {\n\n\t\tlet pipeline = this.transferPipelines[ format ];\n\n\t\tif ( pipeline === undefined ) {\n\n\t\t\tpipeline = this.device.createRenderPipeline( {\n\t\t\t\tlabel: `mipmap-${ format }`,\n\t\t\t\tvertex: {\n\t\t\t\t\tmodule: this.mipmapVertexShaderModule,\n\t\t\t\t\tentryPoint: 'main'\n\t\t\t\t},\n\t\t\t\tfragment: {\n\t\t\t\t\tmodule: this.mipmapFragmentShaderModule,\n\t\t\t\t\tentryPoint: 'main',\n\t\t\t\t\ttargets: [ { format } ]\n\t\t\t\t},\n\t\t\t\tprimitive: {\n\t\t\t\t\ttopology: GPUPrimitiveTopology.TriangleStrip,\n\t\t\t\t\tstripIndexFormat: GPUIndexFormat.Uint32\n\t\t\t\t},\n\t\t\t\tlayout: 'auto'\n\t\t\t} );\n\n\t\t\tthis.transferPipelines[ format ] = pipeline;\n\n\t\t}\n\n\t\treturn pipeline;\n\n\t}\n\n\tgetFlipYPipeline( format ) {\n\n\t\tlet pipeline = this.flipYPipelines[ format ];\n\n\t\tif ( pipeline === undefined ) {\n\n\t\t\tpipeline = this.device.createRenderPipeline( {\n\t\t\t\tlabel: `flipY-${ format }`,\n\t\t\t\tvertex: {\n\t\t\t\t\tmodule: this.mipmapVertexShaderModule,\n\t\t\t\t\tentryPoint: 'main'\n\t\t\t\t},\n\t\t\t\tfragment: {\n\t\t\t\t\tmodule: this.flipYFragmentShaderModule,\n\t\t\t\t\tentryPoint: 'main',\n\t\t\t\t\ttargets: [ { format } ]\n\t\t\t\t},\n\t\t\t\tprimitive: {\n\t\t\t\t\ttopology: GPUPrimitiveTopology.TriangleStrip,\n\t\t\t\t\tstripIndexFormat: GPUIndexFormat.Uint32\n\t\t\t\t},\n\t\t\t\tlayout: 'auto'\n\t\t\t} );\n\n\t\t\tthis.flipYPipelines[ format ] = pipeline;\n\n\t\t}\n\n\t\treturn pipeline;\n\n\t}\n\n\tflipY( textureGPU, textureGPUDescriptor, baseArrayLayer = 0 ) {\n\n\t\tconst format = textureGPUDescriptor.format;\n\t\tconst { width, height } = textureGPUDescriptor.size;\n\n\t\tconst transferPipeline = this.getTransferPipeline( format );\n\t\tconst flipYPipeline = this.getFlipYPipeline( format );\n\n\t\tconst tempTexture = this.device.createTexture( {\n\t\t\tsize: { width, height, depthOrArrayLayers: 1 },\n\t\t\tformat,\n\t\t\tusage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.TEXTURE_BINDING\n\t\t} );\n\n\t\tconst srcView = textureGPU.createView( {\n\t\t\tbaseMipLevel: 0,\n\t\t\tmipLevelCount: 1,\n\t\t\tdimension: GPUTextureViewDimension.TwoD,\n\t\t\tbaseArrayLayer\n\t\t} );\n\n\t\tconst dstView = tempTexture.createView( {\n\t\t\tbaseMipLevel: 0,\n\t\t\tmipLevelCount: 1,\n\t\t\tdimension: GPUTextureViewDimension.TwoD,\n\t\t\tbaseArrayLayer: 0\n\t\t} );\n\n\t\tconst commandEncoder = this.device.createCommandEncoder( {} );\n\n\t\tconst pass = ( pipeline, sourceView, destinationView ) => {\n\n\t\t\tconst bindGroupLayout = pipeline.getBindGroupLayout( 0 ); // @TODO: Consider making this static.\n\n\t\t\tconst bindGroup = this.device.createBindGroup( {\n\t\t\t\tlayout: bindGroupLayout,\n\t\t\t\tentries: [ {\n\t\t\t\t\tbinding: 0,\n\t\t\t\t\tresource: this.flipYSampler\n\t\t\t\t}, {\n\t\t\t\t\tbinding: 1,\n\t\t\t\t\tresource: sourceView\n\t\t\t\t} ]\n\t\t\t} );\n\n\t\t\tconst passEncoder = commandEncoder.beginRenderPass( {\n\t\t\t\tcolorAttachments: [ {\n\t\t\t\t\tview: destinationView,\n\t\t\t\t\tloadOp: GPULoadOp.Clear,\n\t\t\t\t\tstoreOp: GPUStoreOp.Store,\n\t\t\t\t\tclearValue: [ 0, 0, 0, 0 ]\n\t\t\t\t} ]\n\t\t\t} );\n\n\t\t\tpassEncoder.setPipeline( pipeline );\n\t\t\tpassEncoder.setBindGroup( 0, bindGroup );\n\t\t\tpassEncoder.draw( 4, 1, 0, 0 );\n\t\t\tpassEncoder.end();\n\n\t\t};\n\n\t\tpass( transferPipeline, srcView, dstView );\n\t\tpass( flipYPipeline, dstView, srcView );\n\n\t\tthis.device.queue.submit( [ commandEncoder.finish() ] );\n\n\t\ttempTexture.destroy();\n\n\t}\n\n\tgenerateMipmaps( textureGPU, textureGPUDescriptor, baseArrayLayer = 0 ) {\n\n\t\tconst textureData = this.get( textureGPU );\n\n\t\tif ( textureData.useCount === undefined ) {\n\n\t\t\ttextureData.useCount = 0;\n\t\t\ttextureData.layers = [];\n\n\t\t}\n\n\t\tconst passes = textureData.layers[ baseArrayLayer ] || this._mipmapCreateBundles( textureGPU, textureGPUDescriptor, baseArrayLayer );\n\n\t\tconst commandEncoder = this.device.createCommandEncoder( {} );\n\n\t\tthis._mipmapRunBundles( commandEncoder, passes );\n\n\t\tthis.device.queue.submit( [ commandEncoder.finish() ] );\n\n\t\tif ( textureData.useCount !== 0 ) textureData.layers[ baseArrayLayer ] = passes;\n\n\t\ttextureData.useCount ++;\n\n\t}\n\n\t_mipmapCreateBundles( textureGPU, textureGPUDescriptor, baseArrayLayer ) {\n\n\t\tconst pipeline = this.getTransferPipeline( textureGPUDescriptor.format );\n\n\t\tconst bindGroupLayout = pipeline.getBindGroupLayout( 0 ); // @TODO: Consider making this static.\n\n\t\tlet srcView = textureGPU.createView( {\n\t\t\tbaseMipLevel: 0,\n\t\t\tmipLevelCount: 1,\n\t\t\tdimension: GPUTextureViewDimension.TwoD,\n\t\t\tbaseArrayLayer\n\t\t} );\n\n\t\tconst passes = [];\n\n\t\tfor ( let i = 1; i < textureGPUDescriptor.mipLevelCount; i ++ ) {\n\n\t\t\tconst bindGroup = this.device.createBindGroup( {\n\t\t\t\tlayout: bindGroupLayout,\n\t\t\t\tentries: [ {\n\t\t\t\t\tbinding: 0,\n\t\t\t\t\tresource: this.mipmapSampler\n\t\t\t\t}, {\n\t\t\t\t\tbinding: 1,\n\t\t\t\t\tresource: srcView\n\t\t\t\t} ]\n\t\t\t} );\n\n\t\t\tconst dstView = textureGPU.createView( {\n\t\t\t\tbaseMipLevel: i,\n\t\t\t\tmipLevelCount: 1,\n\t\t\t\tdimension: GPUTextureViewDimension.TwoD,\n\t\t\t\tbaseArrayLayer\n\t\t\t} );\n\n\t\t\tconst passDescriptor = {\n\t\t\t\tcolorAttachments: [ {\n\t\t\t\t\tview: dstView,\n\t\t\t\t\tloadOp: GPULoadOp.Clear,\n\t\t\t\t\tstoreOp: GPUStoreOp.Store,\n\t\t\t\t\tclearValue: [ 0, 0, 0, 0 ]\n\t\t\t\t} ]\n\t\t\t};\n\n\t\t\tconst passEncoder = this.device.createRenderBundleEncoder( {\n\t\t\t\tcolorFormats: [ textureGPUDescriptor.format ]\n\t\t\t} );\n\n\t\t\tpassEncoder.setPipeline( pipeline );\n\t\t\tpassEncoder.setBindGroup( 0, bindGroup );\n\t\t\tpassEncoder.draw( 4, 1, 0, 0 );\n\n\t\t\tpasses.push( {\n\t\t\t\trenderBundles: [ passEncoder.finish() ],\n\t\t\t\tpassDescriptor\n\t\t\t} );\n\n\t\t\tsrcView = dstView;\n\n\t\t}\n\n\t\treturn passes;\n\n\t}\n\n\t_mipmapRunBundles( commandEncoder, passes ) {\n\n\t\tconst levels = passes.length;\n\n\t\tfor ( let i = 0; i < levels; i ++ ) {\n\n\t\t\tconst pass = passes[ i ];\n\n\t\t\tconst passEncoder = commandEncoder.beginRenderPass( pass.passDescriptor );\n\n\t\t\tpassEncoder.executeBundles( pass.renderBundles );\n\n\t\t\tpassEncoder.end();\n\n\t\t}\n\n\t}\n\n}\n\nconst _compareToWebGPU = {\n\t[ NeverCompare ]: 'never',\n\t[ LessCompare ]: 'less',\n\t[ EqualCompare ]: 'equal',\n\t[ LessEqualCompare ]: 'less-equal',\n\t[ GreaterCompare ]: 'greater',\n\t[ GreaterEqualCompare ]: 'greater-equal',\n\t[ AlwaysCompare ]: 'always',\n\t[ NotEqualCompare ]: 'not-equal'\n};\n\nconst _flipMap = [ 0, 1, 3, 2, 4, 5 ];\n\nclass WebGPUTextureUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t\tthis._passUtils = null;\n\n\t\tthis.defaultTexture = {};\n\t\tthis.defaultCubeTexture = {};\n\t\tthis.defaultVideoFrame = null;\n\n\t\tthis.colorBuffer = null;\n\n\t\tthis.depthTexture = new DepthTexture();\n\t\tthis.depthTexture.name = 'depthBuffer';\n\n\t}\n\n\tcreateSampler( texture ) {\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\n\t\tconst textureGPU = backend.get( texture );\n\n\t\tconst samplerDescriptorGPU = {\n\t\t\taddressModeU: this._convertAddressMode( texture.wrapS ),\n\t\t\taddressModeV: this._convertAddressMode( texture.wrapT ),\n\t\t\taddressModeW: this._convertAddressMode( texture.wrapR ),\n\t\t\tmagFilter: this._convertFilterMode( texture.magFilter ),\n\t\t\tminFilter: this._convertFilterMode( texture.minFilter ),\n\t\t\tmipmapFilter: this._convertFilterMode( texture.minFilter ),\n\t\t\tmaxAnisotropy: 1\n\t\t};\n\n\t\t// anisotropy can only be used when all filter modes are set to linear.\n\n\t\tif ( samplerDescriptorGPU.magFilter === GPUFilterMode.Linear && samplerDescriptorGPU.minFilter === GPUFilterMode.Linear && samplerDescriptorGPU.mipmapFilter === GPUFilterMode.Linear ) {\n\n\t\t\tsamplerDescriptorGPU.maxAnisotropy = texture.anisotropy;\n\n\t\t}\n\n\t\tif ( texture.isDepthTexture && texture.compareFunction !== null ) {\n\n\t\t\tsamplerDescriptorGPU.compare = _compareToWebGPU[ texture.compareFunction ];\n\n\t\t}\n\n\t\ttextureGPU.sampler = device.createSampler( samplerDescriptorGPU );\n\n\t}\n\n\tcreateDefaultTexture( texture ) {\n\n\t\tlet textureGPU;\n\n\t\tconst format = getFormat( texture );\n\n\t\tif ( texture.isCubeTexture ) {\n\n\t\t\ttextureGPU = this._getDefaultCubeTextureGPU( format );\n\n\t\t} else if ( texture.isVideoTexture ) {\n\n\t\t\tthis.backend.get( texture ).externalTexture = this._getDefaultVideoFrame();\n\n\t\t} else {\n\n\t\t\ttextureGPU = this._getDefaultTextureGPU( format );\n\n\t\t}\n\n\t\tthis.backend.get( texture ).texture = textureGPU;\n\n\t}\n\n\tcreateTexture( texture, options = {} ) {\n\n\t\tconst backend = this.backend;\n\t\tconst textureData = backend.get( texture );\n\n\t\tif ( textureData.initialized ) {\n\n\t\t\tthrow new Error( 'WebGPUTextureUtils: Texture already initialized.' );\n\n\t\t}\n\n\t\tif ( options.needsMipmaps === undefined ) options.needsMipmaps = false;\n\t\tif ( options.levels === undefined ) options.levels = 1;\n\t\tif ( options.depth === undefined ) options.depth = 1;\n\n\t\tconst { width, height, depth, levels } = options;\n\n\t\tif ( texture.isFramebufferTexture ) {\n\n\t\t\tif ( options.renderTarget ) {\n\n\t\t\t\toptions.format = this.backend.utils.getCurrentColorFormat( options.renderTarget );\n\n\t\t\t} else {\n\n\t\t\t\toptions.format = this.backend.utils.getPreferredCanvasFormat();\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst dimension = this._getDimension( texture );\n\t\tconst format = texture.internalFormat || options.format || getFormat( texture, backend.device );\n\n\t\ttextureData.format = format;\n\n\t\tlet sampleCount = options.sampleCount !== undefined ? options.sampleCount : 1;\n\n\t\tsampleCount = backend.utils.getSampleCount( sampleCount );\n\n\t\tconst primarySampleCount = texture.isRenderTargetTexture && ! texture.isMultisampleRenderTargetTexture ? 1 : sampleCount;\n\n\t\tlet usage = GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_DST | GPUTextureUsage.COPY_SRC;\n\n\t\tif ( texture.isStorageTexture === true ) {\n\n\t\t\tusage |= GPUTextureUsage.STORAGE_BINDING;\n\n\t\t}\n\n\t\tif ( texture.isCompressedTexture !== true && texture.isCompressedArrayTexture !== true ) {\n\n\t\t\tusage |= GPUTextureUsage.RENDER_ATTACHMENT;\n\n\t\t}\n\n\t\tconst textureDescriptorGPU = {\n\t\t\tlabel: texture.name,\n\t\t\tsize: {\n\t\t\t\twidth: width,\n\t\t\t\theight: height,\n\t\t\t\tdepthOrArrayLayers: depth,\n\t\t\t},\n\t\t\tmipLevelCount: levels,\n\t\t\tsampleCount: primarySampleCount,\n\t\t\tdimension: dimension,\n\t\t\tformat: format,\n\t\t\tusage: usage\n\t\t};\n\n\t\t// texture creation\n\n\t\tif ( texture.isVideoTexture ) {\n\n\t\t\tconst video = texture.source.data;\n\t\t\tconst videoFrame = new VideoFrame( video );\n\n\t\t\ttextureDescriptorGPU.size.width = videoFrame.displayWidth;\n\t\t\ttextureDescriptorGPU.size.height = videoFrame.displayHeight;\n\n\t\t\tvideoFrame.close();\n\n\t\t\ttextureData.externalTexture = video;\n\n\t\t} else {\n\n\t\t\tif ( format === undefined ) {\n\n\t\t\t\tconsole.warn( 'WebGPURenderer: Texture format not supported.' );\n\n\t\t\t\treturn this.createDefaultTexture( texture );\n\n\t\t\t}\n\n\t\t\ttextureData.texture = backend.device.createTexture( textureDescriptorGPU );\n\n\t\t}\n\n\t\tif ( texture.isRenderTargetTexture && sampleCount > 1 && ! texture.isMultisampleRenderTargetTexture ) {\n\n\t\t\tconst msaaTextureDescriptorGPU = Object.assign( {}, textureDescriptorGPU );\n\n\t\t\tmsaaTextureDescriptorGPU.label = msaaTextureDescriptorGPU.label + '-msaa';\n\t\t\tmsaaTextureDescriptorGPU.sampleCount = sampleCount;\n\n\t\t\ttextureData.msaaTexture = backend.device.createTexture( msaaTextureDescriptorGPU );\n\n\t\t}\n\n\t\ttextureData.initialized = true;\n\n\t\ttextureData.textureDescriptorGPU = textureDescriptorGPU;\n\n\t}\n\n\tdestroyTexture( texture ) {\n\n\t\tconst backend = this.backend;\n\t\tconst textureData = backend.get( texture );\n\n\t\tif ( textureData.texture !== undefined ) textureData.texture.destroy();\n\n\t\tif ( textureData.msaaTexture !== undefined ) textureData.msaaTexture.destroy();\n\n\t\tbackend.delete( texture );\n\n\t}\n\n\tdestroySampler( texture ) {\n\n\t\tconst backend = this.backend;\n\t\tconst textureData = backend.get( texture );\n\n\t\tdelete textureData.sampler;\n\n\t}\n\n\tgenerateMipmaps( texture ) {\n\n\t\tconst textureData = this.backend.get( texture );\n\n\t\tif ( texture.isCubeTexture ) {\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\tthis._generateMipmaps( textureData.texture, textureData.textureDescriptorGPU, i );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst depth = texture.image.depth || 1;\n\n\t\t\tfor ( let i = 0; i < depth; i ++ ) {\n\n\t\t\t\tthis._generateMipmaps( textureData.texture, textureData.textureDescriptorGPU, i );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgetColorBuffer() {\n\n\t\tif ( this.colorBuffer ) this.colorBuffer.destroy();\n\n\t\tconst backend = this.backend;\n\t\tconst { width, height } = backend.getDrawingBufferSize();\n\n\t\tthis.colorBuffer = backend.device.createTexture( {\n\t\t\tlabel: 'colorBuffer',\n\t\t\tsize: {\n\t\t\t\twidth: width,\n\t\t\t\theight: height,\n\t\t\t\tdepthOrArrayLayers: 1\n\t\t\t},\n\t\t\tsampleCount: backend.utils.getSampleCount( backend.renderer.samples ),\n\t\t\tformat: backend.utils.getPreferredCanvasFormat(),\n\t\t\tusage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC\n\t\t} );\n\n\t\treturn this.colorBuffer;\n\n\t}\n\n\tgetDepthBuffer( depth = true, stencil = false ) {\n\n\t\tconst backend = this.backend;\n\t\tconst { width, height } = backend.getDrawingBufferSize();\n\n\t\tconst depthTexture = this.depthTexture;\n\t\tconst depthTextureGPU = backend.get( depthTexture ).texture;\n\n\t\tlet format, type;\n\n\t\tif ( stencil ) {\n\n\t\t\tformat = DepthStencilFormat;\n\t\t\ttype = UnsignedInt248Type;\n\n\t\t} else if ( depth ) {\n\n\t\t\tformat = DepthFormat;\n\t\t\ttype = UnsignedIntType;\n\n\t\t}\n\n\t\tif ( depthTextureGPU !== undefined ) {\n\n\t\t\tif ( depthTexture.image.width === width && depthTexture.image.height === height && depthTexture.format === format && depthTexture.type === type ) {\n\n\t\t\t\treturn depthTextureGPU;\n\n\t\t\t}\n\n\t\t\tthis.destroyTexture( depthTexture );\n\n\t\t}\n\n\t\tdepthTexture.name = 'depthBuffer';\n\t\tdepthTexture.format = format;\n\t\tdepthTexture.type = type;\n\t\tdepthTexture.image.width = width;\n\t\tdepthTexture.image.height = height;\n\n\t\tthis.createTexture( depthTexture, { sampleCount: backend.utils.getSampleCount( backend.renderer.samples ), width, height } );\n\n\t\treturn backend.get( depthTexture ).texture;\n\n\t}\n\n\tupdateTexture( texture, options ) {\n\n\t\tconst textureData = this.backend.get( texture );\n\n\t\tconst { textureDescriptorGPU } = textureData;\n\n\t\tif ( texture.isRenderTargetTexture || ( textureDescriptorGPU === undefined /* unsupported texture format */ ) )\n\t\t\treturn;\n\n\t\t// transfer texture data\n\n\t\tif ( texture.isDataTexture ) {\n\n\t\t\tthis._copyBufferToTexture( options.image, textureData.texture, textureDescriptorGPU, 0, texture.flipY );\n\n\t\t} else if ( texture.isDataArrayTexture || texture.isData3DTexture ) {\n\n\t\t\tfor ( let i = 0; i < options.image.depth; i ++ ) {\n\n\t\t\t\tthis._copyBufferToTexture( options.image, textureData.texture, textureDescriptorGPU, i, texture.flipY, i );\n\n\t\t\t}\n\n\t\t} else if ( texture.isCompressedTexture || texture.isCompressedArrayTexture ) {\n\n\t\t\tthis._copyCompressedBufferToTexture( texture.mipmaps, textureData.texture, textureDescriptorGPU );\n\n\t\t} else if ( texture.isCubeTexture ) {\n\n\t\t\tthis._copyCubeMapToTexture( options.images, textureData.texture, textureDescriptorGPU, texture.flipY );\n\n\t\t} else if ( texture.isVideoTexture ) {\n\n\t\t\tconst video = texture.source.data;\n\n\t\t\ttextureData.externalTexture = video;\n\n\t\t} else {\n\n\t\t\tthis._copyImageToTexture( options.image, textureData.texture, textureDescriptorGPU, 0, texture.flipY );\n\n\t\t}\n\n\t\t//\n\n\t\ttextureData.version = texture.version;\n\n\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\n\n\t}\n\n\tasync copyTextureToBuffer( texture, x, y, width, height, faceIndex ) {\n\n\t\tconst device = this.backend.device;\n\n\t\tconst textureData = this.backend.get( texture );\n\t\tconst textureGPU = textureData.texture;\n\t\tconst format = textureData.textureDescriptorGPU.format;\n\t\tconst bytesPerTexel = this._getBytesPerTexel( format );\n\n\t\tlet bytesPerRow = width * bytesPerTexel;\n\t\tbytesPerRow = Math.ceil( bytesPerRow / 256 ) * 256; // Align to 256 bytes\n\n\t\tconst readBuffer = device.createBuffer(\n\t\t\t{\n\t\t\t\tsize: width * height * bytesPerTexel,\n\t\t\t\tusage: GPUBufferUsage.COPY_DST | GPUBufferUsage.MAP_READ\n\t\t\t}\n\t\t);\n\n\t\tconst encoder = device.createCommandEncoder();\n\n\t\tencoder.copyTextureToBuffer(\n\t\t\t{\n\t\t\t\ttexture: textureGPU,\n\t\t\t\torigin: { x, y, z: faceIndex },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbuffer: readBuffer,\n\t\t\t\tbytesPerRow: bytesPerRow\n\t\t\t},\n\t\t\t{\n\t\t\t\twidth: width,\n\t\t\t\theight: height\n\t\t\t}\n\n\t\t);\n\n\t\tconst typedArrayType = this._getTypedArrayType( format );\n\n\t\tdevice.queue.submit( [ encoder.finish() ] );\n\n\t\tawait readBuffer.mapAsync( GPUMapMode.READ );\n\n\t\tconst buffer = readBuffer.getMappedRange();\n\n\t\treturn new typedArrayType( buffer );\n\n\t}\n\n\t_isEnvironmentTexture( texture ) {\n\n\t\tconst mapping = texture.mapping;\n\n\t\treturn ( mapping === EquirectangularReflectionMapping || mapping === EquirectangularRefractionMapping ) || ( mapping === CubeReflectionMapping || mapping === CubeRefractionMapping );\n\n\t}\n\n\t_getDefaultTextureGPU( format ) {\n\n\t\tlet defaultTexture = this.defaultTexture[ format ];\n\n\t\tif ( defaultTexture === undefined ) {\n\n\t\t\tconst texture = new Texture();\n\t\t\ttexture.minFilter = NearestFilter;\n\t\t\ttexture.magFilter = NearestFilter;\n\n\t\t\tthis.createTexture( texture, { width: 1, height: 1, format } );\n\n\t\t\tthis.defaultTexture[ format ] = defaultTexture = texture;\n\n\t\t}\n\n\t\treturn this.backend.get( defaultTexture ).texture;\n\n\t}\n\n\t_getDefaultCubeTextureGPU( format ) {\n\n\t\tlet defaultCubeTexture = this.defaultTexture[ format ];\n\n\t\tif ( defaultCubeTexture === undefined ) {\n\n\t\t\tconst texture = new CubeTexture();\n\t\t\ttexture.minFilter = NearestFilter;\n\t\t\ttexture.magFilter = NearestFilter;\n\n\t\t\tthis.createTexture( texture, { width: 1, height: 1, depth: 6 } );\n\n\t\t\tthis.defaultCubeTexture[ format ] = defaultCubeTexture = texture;\n\n\t\t}\n\n\t\treturn this.backend.get( defaultCubeTexture ).texture;\n\n\t}\n\n\t_getDefaultVideoFrame() {\n\n\t\tlet defaultVideoFrame = this.defaultVideoFrame;\n\n\t\tif ( defaultVideoFrame === null ) {\n\n\t\t\tconst init = {\n\t\t\t\ttimestamp: 0,\n\t\t\t\tcodedWidth: 1,\n\t\t\t\tcodedHeight: 1,\n\t\t\t\tformat: 'RGBA',\n\t\t\t};\n\n\t\t\tthis.defaultVideoFrame = defaultVideoFrame = new VideoFrame( new Uint8Array( [ 0, 0, 0, 0xff ] ), init );\n\n\t\t}\n\n\t\treturn defaultVideoFrame;\n\n\t}\n\n\t_copyCubeMapToTexture( images, textureGPU, textureDescriptorGPU, flipY ) {\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst image = images[ i ];\n\n\t\t\tconst flipIndex = flipY === true ? _flipMap[ i ] : i;\n\n\t\t\tif ( image.isDataTexture ) {\n\n\t\t\t\tthis._copyBufferToTexture( image.image, textureGPU, textureDescriptorGPU, flipIndex, flipY );\n\n\t\t\t} else {\n\n\t\t\t\tthis._copyImageToTexture( image, textureGPU, textureDescriptorGPU, flipIndex, flipY );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_copyImageToTexture( image, textureGPU, textureDescriptorGPU, originDepth, flipY ) {\n\n\t\tconst device = this.backend.device;\n\n\t\tdevice.queue.copyExternalImageToTexture(\n\t\t\t{\n\t\t\t\tsource: image\n\t\t\t}, {\n\t\t\t\ttexture: textureGPU,\n\t\t\t\tmipLevel: 0,\n\t\t\t\torigin: { x: 0, y: 0, z: originDepth }\n\t\t\t}, {\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height,\n\t\t\t\tdepthOrArrayLayers: 1\n\t\t\t}\n\t\t);\n\n\t\tif ( flipY === true ) {\n\n\t\t\tthis._flipY( textureGPU, textureDescriptorGPU, originDepth );\n\n\t\t}\n\n\t}\n\n\t_getPassUtils() {\n\n\t\tlet passUtils = this._passUtils;\n\n\t\tif ( passUtils === null ) {\n\n\t\t\tthis._passUtils = passUtils = new WebGPUTexturePassUtils( this.backend.device );\n\n\t\t}\n\n\t\treturn passUtils;\n\n\t}\n\n\t_generateMipmaps( textureGPU, textureDescriptorGPU, baseArrayLayer = 0 ) {\n\n\t\tthis._getPassUtils().generateMipmaps( textureGPU, textureDescriptorGPU, baseArrayLayer );\n\n\t}\n\n\t_flipY( textureGPU, textureDescriptorGPU, originDepth = 0 ) {\n\n\t\tthis._getPassUtils().flipY( textureGPU, textureDescriptorGPU, originDepth );\n\n\t}\n\n\t_copyBufferToTexture( image, textureGPU, textureDescriptorGPU, originDepth, flipY, depth = 0 ) {\n\n\t\t// @TODO: Consider to use GPUCommandEncoder.copyBufferToTexture()\n\t\t// @TODO: Consider to support valid buffer layouts with other formats like RGB\n\n\t\tconst device = this.backend.device;\n\n\t\tconst data = image.data;\n\n\t\tconst bytesPerTexel = this._getBytesPerTexel( textureDescriptorGPU.format );\n\t\tconst bytesPerRow = image.width * bytesPerTexel;\n\n\t\tdevice.queue.writeTexture(\n\t\t\t{\n\t\t\t\ttexture: textureGPU,\n\t\t\t\tmipLevel: 0,\n\t\t\t\torigin: { x: 0, y: 0, z: originDepth }\n\t\t\t},\n\t\t\tdata,\n\t\t\t{\n\t\t\t\toffset: image.width * image.height * bytesPerTexel * depth,\n\t\t\t\tbytesPerRow\n\t\t\t},\n\t\t\t{\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height,\n\t\t\t\tdepthOrArrayLayers: 1\n\t\t\t} );\n\n\t\tif ( flipY === true ) {\n\n\t\t\tthis._flipY( textureGPU, textureDescriptorGPU, originDepth );\n\n\t\t}\n\n\t}\n\n\t_copyCompressedBufferToTexture( mipmaps, textureGPU, textureDescriptorGPU ) {\n\n\t\t// @TODO: Consider to use GPUCommandEncoder.copyBufferToTexture()\n\n\t\tconst device = this.backend.device;\n\n\t\tconst blockData = this._getBlockData( textureDescriptorGPU.format );\n\t\tconst isTextureArray = textureDescriptorGPU.size.depthOrArrayLayers > 1;\n\n\t\tfor ( let i = 0; i < mipmaps.length; i ++ ) {\n\n\t\t\tconst mipmap = mipmaps[ i ];\n\n\t\t\tconst width = mipmap.width;\n\t\t\tconst height = mipmap.height;\n\t\t\tconst depth = isTextureArray ? textureDescriptorGPU.size.depthOrArrayLayers : 1;\n\n\t\t\tconst bytesPerRow = Math.ceil( width / blockData.width ) * blockData.byteLength;\n\t\t\tconst bytesPerImage = bytesPerRow * Math.ceil( height / blockData.height );\n\n\t\t\tfor ( let j = 0; j < depth; j ++ ) {\n\n\t\t\t\tdevice.queue.writeTexture(\n\t\t\t\t\t{\n\t\t\t\t\t\ttexture: textureGPU,\n\t\t\t\t\t\tmipLevel: i,\n\t\t\t\t\t\torigin: { x: 0, y: 0, z: j }\n\t\t\t\t\t},\n\t\t\t\t\tmipmap.data,\n\t\t\t\t\t{\n\t\t\t\t\t\toffset: j * bytesPerImage,\n\t\t\t\t\t\tbytesPerRow,\n\t\t\t\t\t\trowsPerImage: Math.ceil( height / blockData.height )\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\twidth: Math.ceil( width / blockData.width ) * blockData.width,\n\t\t\t\t\t\theight: Math.ceil( height / blockData.height ) * blockData.height,\n\t\t\t\t\t\tdepthOrArrayLayers: 1\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_getBlockData( format ) {\n\n\t\t// this method is only relevant for compressed texture formats\n\n\t\tif ( format === GPUTextureFormat.BC1RGBAUnorm || format === GPUTextureFormat.BC1RGBAUnormSRGB ) return { byteLength: 8, width: 4, height: 4 }; // DXT1\n\t\tif ( format === GPUTextureFormat.BC2RGBAUnorm || format === GPUTextureFormat.BC2RGBAUnormSRGB ) return { byteLength: 16, width: 4, height: 4 }; // DXT3\n\t\tif ( format === GPUTextureFormat.BC3RGBAUnorm || format === GPUTextureFormat.BC3RGBAUnormSRGB ) return { byteLength: 16, width: 4, height: 4 }; // DXT5\n\t\tif ( format === GPUTextureFormat.BC4RUnorm || format === GPUTextureFormat.BC4RSNorm ) return { byteLength: 8, width: 4, height: 4 }; // RGTC1\n\t\tif ( format === GPUTextureFormat.BC5RGUnorm || format === GPUTextureFormat.BC5RGSnorm ) return { byteLength: 16, width: 4, height: 4 }; // RGTC2\n\t\tif ( format === GPUTextureFormat.BC6HRGBUFloat || format === GPUTextureFormat.BC6HRGBFloat ) return { byteLength: 16, width: 4, height: 4 }; // BPTC (float)\n\t\tif ( format === GPUTextureFormat.BC7RGBAUnorm || format === GPUTextureFormat.BC7RGBAUnormSRGB ) return { byteLength: 16, width: 4, height: 4 }; // BPTC (unorm)\n\n\t\tif ( format === GPUTextureFormat.ETC2RGB8Unorm || format === GPUTextureFormat.ETC2RGB8UnormSRGB ) return { byteLength: 8, width: 4, height: 4 };\n\t\tif ( format === GPUTextureFormat.ETC2RGB8A1Unorm || format === GPUTextureFormat.ETC2RGB8A1UnormSRGB ) return { byteLength: 8, width: 4, height: 4 };\n\t\tif ( format === GPUTextureFormat.ETC2RGBA8Unorm || format === GPUTextureFormat.ETC2RGBA8UnormSRGB ) return { byteLength: 16, width: 4, height: 4 };\n\t\tif ( format === GPUTextureFormat.EACR11Unorm ) return { byteLength: 8, width: 4, height: 4 };\n\t\tif ( format === GPUTextureFormat.EACR11Snorm ) return { byteLength: 8, width: 4, height: 4 };\n\t\tif ( format === GPUTextureFormat.EACRG11Unorm ) return { byteLength: 16, width: 4, height: 4 };\n\t\tif ( format === GPUTextureFormat.EACRG11Snorm ) return { byteLength: 16, width: 4, height: 4 };\n\n\t\tif ( format === GPUTextureFormat.ASTC4x4Unorm || format === GPUTextureFormat.ASTC4x4UnormSRGB ) return { byteLength: 16, width: 4, height: 4 };\n\t\tif ( format === GPUTextureFormat.ASTC5x4Unorm || format === GPUTextureFormat.ASTC5x4UnormSRGB ) return { byteLength: 16, width: 5, height: 4 };\n\t\tif ( format === GPUTextureFormat.ASTC5x5Unorm || format === GPUTextureFormat.ASTC5x5UnormSRGB ) return { byteLength: 16, width: 5, height: 5 };\n\t\tif ( format === GPUTextureFormat.ASTC6x5Unorm || format === GPUTextureFormat.ASTC6x5UnormSRGB ) return { byteLength: 16, width: 6, height: 5 };\n\t\tif ( format === GPUTextureFormat.ASTC6x6Unorm || format === GPUTextureFormat.ASTC6x6UnormSRGB ) return { byteLength: 16, width: 6, height: 6 };\n\t\tif ( format === GPUTextureFormat.ASTC8x5Unorm || format === GPUTextureFormat.ASTC8x5UnormSRGB ) return { byteLength: 16, width: 8, height: 5 };\n\t\tif ( format === GPUTextureFormat.ASTC8x6Unorm || format === GPUTextureFormat.ASTC8x6UnormSRGB ) return { byteLength: 16, width: 8, height: 6 };\n\t\tif ( format === GPUTextureFormat.ASTC8x8Unorm || format === GPUTextureFormat.ASTC8x8UnormSRGB ) return { byteLength: 16, width: 8, height: 8 };\n\t\tif ( format === GPUTextureFormat.ASTC10x5Unorm || format === GPUTextureFormat.ASTC10x5UnormSRGB ) return { byteLength: 16, width: 10, height: 5 };\n\t\tif ( format === GPUTextureFormat.ASTC10x6Unorm || format === GPUTextureFormat.ASTC10x6UnormSRGB ) return { byteLength: 16, width: 10, height: 6 };\n\t\tif ( format === GPUTextureFormat.ASTC10x8Unorm || format === GPUTextureFormat.ASTC10x8UnormSRGB ) return { byteLength: 16, width: 10, height: 8 };\n\t\tif ( format === GPUTextureFormat.ASTC10x10Unorm || format === GPUTextureFormat.ASTC10x10UnormSRGB ) return { byteLength: 16, width: 10, height: 10 };\n\t\tif ( format === GPUTextureFormat.ASTC12x10Unorm || format === GPUTextureFormat.ASTC12x10UnormSRGB ) return { byteLength: 16, width: 12, height: 10 };\n\t\tif ( format === GPUTextureFormat.ASTC12x12Unorm || format === GPUTextureFormat.ASTC12x12UnormSRGB ) return { byteLength: 16, width: 12, height: 12 };\n\n\t}\n\n\t_convertAddressMode( value ) {\n\n\t\tlet addressMode = GPUAddressMode.ClampToEdge;\n\n\t\tif ( value === RepeatWrapping ) {\n\n\t\t\taddressMode = GPUAddressMode.Repeat;\n\n\t\t} else if ( value === MirroredRepeatWrapping ) {\n\n\t\t\taddressMode = GPUAddressMode.MirrorRepeat;\n\n\t\t}\n\n\t\treturn addressMode;\n\n\t}\n\n\t_convertFilterMode( value ) {\n\n\t\tlet filterMode = GPUFilterMode.Linear;\n\n\t\tif ( value === NearestFilter || value === NearestMipmapNearestFilter || value === NearestMipmapLinearFilter ) {\n\n\t\t\tfilterMode = GPUFilterMode.Nearest;\n\n\t\t}\n\n\t\treturn filterMode;\n\n\t}\n\n\t_getBytesPerTexel( format ) {\n\n\t\t// 8-bit formats\n\t\tif ( format === GPUTextureFormat.R8Unorm ||\n\t\t\tformat === GPUTextureFormat.R8Snorm ||\n\t\t\tformat === GPUTextureFormat.R8Uint ||\n\t\t\tformat === GPUTextureFormat.R8Sint ) return 1;\n\n\t\t// 16-bit formats\n\t\tif ( format === GPUTextureFormat.R16Uint ||\n\t\t\tformat === GPUTextureFormat.R16Sint ||\n\t\t\tformat === GPUTextureFormat.R16Float ||\n\t\t\tformat === GPUTextureFormat.RG8Unorm ||\n\t\t\tformat === GPUTextureFormat.RG8Snorm ||\n\t\t\tformat === GPUTextureFormat.RG8Uint ||\n\t\t\tformat === GPUTextureFormat.RG8Sint ) return 2;\n\n\t\t// 32-bit formats\n\t\tif ( format === GPUTextureFormat.R32Uint ||\n\t\t\tformat === GPUTextureFormat.R32Sint ||\n\t\t\tformat === GPUTextureFormat.R32Float ||\n\t\t\tformat === GPUTextureFormat.RG16Uint ||\n\t\t\tformat === GPUTextureFormat.RG16Sint ||\n\t\t\tformat === GPUTextureFormat.RG16Float ||\n\t\t\tformat === GPUTextureFormat.RGBA8Unorm ||\n\t\t\tformat === GPUTextureFormat.RGBA8UnormSRGB ||\n\t\t\tformat === GPUTextureFormat.RGBA8Snorm ||\n\t\t\tformat === GPUTextureFormat.RGBA8Uint ||\n\t\t\tformat === GPUTextureFormat.RGBA8Sint ||\n\t\t\tformat === GPUTextureFormat.BGRA8Unorm ||\n\t\t\tformat === GPUTextureFormat.BGRA8UnormSRGB ||\n\t\t\t// Packed 32-bit formats\n\t\t\tformat === GPUTextureFormat.RGB9E5UFloat ||\n\t\t\tformat === GPUTextureFormat.RGB10A2Unorm ||\n\t\t\tformat === GPUTextureFormat.RG11B10UFloat ||\n\t\t\tformat === GPUTextureFormat.Depth32Float ||\n\t\t\tformat === GPUTextureFormat.Depth24Plus ||\n\t\t\tformat === GPUTextureFormat.Depth24PlusStencil8 ||\n\t\t\tformat === GPUTextureFormat.Depth32FloatStencil8 ) return 4;\n\n\t\t// 64-bit formats\n\t\tif ( format === GPUTextureFormat.RG32Uint ||\n\t\t\tformat === GPUTextureFormat.RG32Sint ||\n\t\t\tformat === GPUTextureFormat.RG32Float ||\n\t\t\tformat === GPUTextureFormat.RGBA16Uint ||\n\t\t\tformat === GPUTextureFormat.RGBA16Sint ||\n\t\t\tformat === GPUTextureFormat.RGBA16Float ) return 8;\n\n\t\t// 128-bit formats\n\t\tif ( format === GPUTextureFormat.RGBA32Uint ||\n\t\t\tformat === GPUTextureFormat.RGBA32Sint ||\n\t\t\tformat === GPUTextureFormat.RGBA32Float ) return 16;\n\n\n\t}\n\n\t_getTypedArrayType( format ) {\n\n\t\tif ( format === GPUTextureFormat.R8Uint ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.R8Sint ) return Int8Array;\n\t\tif ( format === GPUTextureFormat.R8Unorm ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.R8Snorm ) return Int8Array;\n\t\tif ( format === GPUTextureFormat.RG8Uint ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.RG8Sint ) return Int8Array;\n\t\tif ( format === GPUTextureFormat.RG8Unorm ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.RG8Snorm ) return Int8Array;\n\t\tif ( format === GPUTextureFormat.RGBA8Uint ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.RGBA8Sint ) return Int8Array;\n\t\tif ( format === GPUTextureFormat.RGBA8Unorm ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.RGBA8Snorm ) return Int8Array;\n\n\n\t\tif ( format === GPUTextureFormat.R16Uint ) return Uint16Array;\n\t\tif ( format === GPUTextureFormat.R16Sint ) return Int16Array;\n\t\tif ( format === GPUTextureFormat.RG16Uint ) return Uint16Array;\n\t\tif ( format === GPUTextureFormat.RG16Sint ) return Int16Array;\n\t\tif ( format === GPUTextureFormat.RGBA16Uint ) return Uint16Array;\n\t\tif ( format === GPUTextureFormat.RGBA16Sint ) return Int16Array;\n\t\tif ( format === GPUTextureFormat.R16Float ) return Uint16Array;\n\t\tif ( format === GPUTextureFormat.RG16Float ) return Uint16Array;\n\t\tif ( format === GPUTextureFormat.RGBA16Float ) return Uint16Array;\n\n\n\t\tif ( format === GPUTextureFormat.R32Uint ) return Uint32Array;\n\t\tif ( format === GPUTextureFormat.R32Sint ) return Int32Array;\n\t\tif ( format === GPUTextureFormat.R32Float ) return Float32Array;\n\t\tif ( format === GPUTextureFormat.RG32Uint ) return Uint32Array;\n\t\tif ( format === GPUTextureFormat.RG32Sint ) return Int32Array;\n\t\tif ( format === GPUTextureFormat.RG32Float ) return Float32Array;\n\t\tif ( format === GPUTextureFormat.RGBA32Uint ) return Uint32Array;\n\t\tif ( format === GPUTextureFormat.RGBA32Sint ) return Int32Array;\n\t\tif ( format === GPUTextureFormat.RGBA32Float ) return Float32Array;\n\n\t\tif ( format === GPUTextureFormat.BGRA8Unorm ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.BGRA8UnormSRGB ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.RGB10A2Unorm ) return Uint32Array;\n\t\tif ( format === GPUTextureFormat.RGB9E5UFloat ) return Uint32Array;\n\t\tif ( format === GPUTextureFormat.RG11B10UFloat ) return Uint32Array;\n\n\t\tif ( format === GPUTextureFormat.Depth32Float ) return Float32Array;\n\t\tif ( format === GPUTextureFormat.Depth24Plus ) return Uint32Array;\n\t\tif ( format === GPUTextureFormat.Depth24PlusStencil8 ) return Uint32Array;\n\t\tif ( format === GPUTextureFormat.Depth32FloatStencil8 ) return Float32Array;\n\n\t}\n\n\t_getDimension( texture ) {\n\n\t\tlet dimension;\n\n\t\tif ( texture.isData3DTexture ) {\n\n\t\t\tdimension = GPUTextureDimension.ThreeD;\n\n\t\t} else {\n\n\t\t\tdimension = GPUTextureDimension.TwoD;\n\n\t\t}\n\n\t\treturn dimension;\n\n\t}\n\n}\n\nfunction getFormat( texture, device = null ) {\n\n\tconst format = texture.format;\n\tconst type = texture.type;\n\tconst colorSpace = texture.colorSpace;\n\n\tlet formatGPU;\n\n\tif ( texture.isCompressedTexture === true || texture.isCompressedArrayTexture === true ) {\n\n\t\tswitch ( format ) {\n\n\t\t\tcase RGBA_S3TC_DXT1_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.BC1RGBAUnormSRGB : GPUTextureFormat.BC1RGBAUnorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_S3TC_DXT3_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.BC2RGBAUnormSRGB : GPUTextureFormat.BC2RGBAUnorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_S3TC_DXT5_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.BC3RGBAUnormSRGB : GPUTextureFormat.BC3RGBAUnorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGB_ETC2_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ETC2RGB8UnormSRGB : GPUTextureFormat.ETC2RGB8Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ETC2_EAC_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ETC2RGBA8UnormSRGB : GPUTextureFormat.ETC2RGBA8Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_4x4_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC4x4UnormSRGB : GPUTextureFormat.ASTC4x4Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_5x4_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC5x4UnormSRGB : GPUTextureFormat.ASTC5x4Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_5x5_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC5x5UnormSRGB : GPUTextureFormat.ASTC5x5Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_6x5_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC6x5UnormSRGB : GPUTextureFormat.ASTC6x5Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_6x6_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC6x6UnormSRGB : GPUTextureFormat.ASTC6x6Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_8x5_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC8x5UnormSRGB : GPUTextureFormat.ASTC8x5Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_8x6_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC8x6UnormSRGB : GPUTextureFormat.ASTC8x6Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_8x8_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC8x8UnormSRGB : GPUTextureFormat.ASTC8x8Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_10x5_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC10x5UnormSRGB : GPUTextureFormat.ASTC10x5Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_10x6_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC10x6UnormSRGB : GPUTextureFormat.ASTC10x6Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_10x8_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC10x8UnormSRGB : GPUTextureFormat.ASTC10x8Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_10x10_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC10x10UnormSRGB : GPUTextureFormat.ASTC10x10Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_12x10_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC12x10UnormSRGB : GPUTextureFormat.ASTC12x10Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_12x12_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC12x12UnormSRGB : GPUTextureFormat.ASTC12x12Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBAFormat:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.RGBA8UnormSRGB : GPUTextureFormat.RGBA8Unorm;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture format.', format );\n\n\t\t}\n\n\t} else {\n\n\t\tswitch ( format ) {\n\n\t\t\tcase RGBAFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase ByteType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA8Snorm;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase ShortType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA16Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedShortType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA16Uint;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase UnsignedIntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA32Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase IntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA32Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedByteType:\n\t\t\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.RGBA8UnormSRGB : GPUTextureFormat.RGBA8Unorm;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase HalfFloatType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA16Float;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase FloatType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA32Float;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with RGBAFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase RGBFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase UnsignedInt5999Type:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGB9E5UFloat;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with RGBFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase RedFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase ByteType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R8Snorm;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase ShortType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R16Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedShortType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R16Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedIntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R32Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase IntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R32Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedByteType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R8Unorm;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase HalfFloatType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R16Float;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase FloatType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R32Float;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with RedFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase RGFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase ByteType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG8Snorm;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase ShortType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG16Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedShortType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG16Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedIntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG32Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase IntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG32Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedByteType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG8Unorm;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase HalfFloatType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG16Float;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase FloatType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG32Float;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with RGFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase DepthFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase UnsignedShortType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.Depth16Unorm;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedIntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.Depth24Plus;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase FloatType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.Depth32Float;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with DepthFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase DepthStencilFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase UnsignedInt248Type:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.Depth24PlusStencil8;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase FloatType:\n\n\t\t\t\t\t\tif ( device && device.features.has( GPUFeatureName.Depth32FloatStencil8 ) === false ) {\n\n\t\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the \"depth32float-stencil8\" GPU feature.' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.Depth32FloatStencil8;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with DepthStencilFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase RedIntegerFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase IntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R32Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedIntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R32Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with RedIntegerFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase RGIntegerFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase IntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG32Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedIntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG32Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with RGIntegerFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase RGBAIntegerFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase IntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA32Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedIntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA32Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture format.', format );\n\n\t\t}\n\n\t}\n\n\treturn formatGPU;\n\n}\n\nconst declarationRegexp = /^[fn]*\\s*([a-z_0-9]+)?\\s*\\(([\\s\\S]*?)\\)\\s*[\\-\\>]*\\s*([a-z_0-9]+(?:<[\\s\\S]+?>)?)/i;\nconst propertiesRegexp = /([a-z_0-9]+)\\s*:\\s*([a-z_0-9]+(?:<[\\s\\S]+?>)?)/ig;\n\nconst wgslTypeLib$1 = {\n\t'f32': 'float',\n\t'i32': 'int',\n\t'u32': 'uint',\n\t'bool': 'bool',\n\n\t'vec2<f32>': 'vec2',\n \t'vec2<i32>': 'ivec2',\n \t'vec2<u32>': 'uvec2',\n \t'vec2<bool>': 'bvec2',\n\n\t'vec2f': 'vec2',\n\t'vec2i': 'ivec2',\n\t'vec2u': 'uvec2',\n\t'vec2b': 'bvec2',\n\n\t'vec3<f32>': 'vec3',\n\t'vec3<i32>': 'ivec3',\n\t'vec3<u32>': 'uvec3',\n\t'vec3<bool>': 'bvec3',\n\n\t'vec3f': 'vec3',\n\t'vec3i': 'ivec3',\n\t'vec3u': 'uvec3',\n\t'vec3b': 'bvec3',\n\n\t'vec4<f32>': 'vec4',\n\t'vec4<i32>': 'ivec4',\n\t'vec4<u32>': 'uvec4',\n\t'vec4<bool>': 'bvec4',\n\n\t'vec4f': 'vec4',\n\t'vec4i': 'ivec4',\n\t'vec4u': 'uvec4',\n\t'vec4b': 'bvec4',\n\n\t'mat2x2<f32>': 'mat2',\n\t'mat2x2f': 'mat2',\n\n\t'mat3x3<f32>': 'mat3',\n\t'mat3x3f': 'mat3',\n\n\t'mat4x4<f32>': 'mat4',\n\t'mat4x4f': 'mat4',\n\n\t'sampler': 'sampler',\n\n\t'texture_1d': 'texture',\n\n\t'texture_2d': 'texture',\n\t'texture_2d_array': 'texture',\n\t'texture_multisampled_2d': 'cubeTexture',\n\n\t'texture_depth_2d': 'depthTexture',\n\n\t'texture_3d': 'texture3D',\n\n\t'texture_cube': 'cubeTexture',\n\t'texture_cube_array': 'cubeTexture',\n\n\t'texture_storage_1d': 'storageTexture',\n\t'texture_storage_2d': 'storageTexture',\n\t'texture_storage_2d_array': 'storageTexture',\n\t'texture_storage_3d': 'storageTexture'\n\n};\n\nconst parse = ( source ) => {\n\n\tsource = source.trim();\n\n\tconst declaration = source.match( declarationRegexp );\n\n\tif ( declaration !== null && declaration.length === 4 ) {\n\n\t\tconst inputsCode = declaration[ 2 ];\n\t\tconst propsMatches = [];\n\t\tlet match = null;\n\n\t\twhile ( ( match = propertiesRegexp.exec( inputsCode ) ) !== null ) {\n\n\t\t\tpropsMatches.push( { name: match[ 1 ], type: match[ 2 ] } );\n\n\t\t}\n\n\t\t// Process matches to correctly pair names and types\n\t\tconst inputs = [];\n\t\tfor ( let i = 0; i < propsMatches.length; i ++ ) {\n\n\t\t\tconst { name, type } = propsMatches[ i ];\n\n\t\t\tlet resolvedType = type;\n\n\t\t\tif ( resolvedType.startsWith( 'ptr' ) ) {\n\n\t\t\t\tresolvedType = 'pointer';\n\n\t\t\t} else {\n\n\t\t\t\tif ( resolvedType.startsWith( 'texture' ) ) {\n\n\t\t\t\t\tresolvedType = type.split( '<' )[ 0 ];\n\n\t\t\t\t}\n\n\t\t\t\tresolvedType = wgslTypeLib$1[ resolvedType ];\n\n\t\t\t}\n\n\t\t\tinputs.push( new NodeFunctionInput( resolvedType, name ) );\n\n\t\t}\n\n\t\tconst blockCode = source.substring( declaration[ 0 ].length );\n\t\tconst outputType = declaration[ 3 ] || 'void';\n\n\t\tconst name = declaration[ 1 ] !== undefined ? declaration[ 1 ] : '';\n\t\tconst type = wgslTypeLib$1[ outputType ] || outputType;\n\n\t\treturn {\n\t\t\ttype,\n\t\t\tinputs,\n\t\t\tname,\n\t\t\tinputsCode,\n\t\t\tblockCode,\n\t\t\toutputType\n\t\t};\n\n\t} else {\n\n\t\tthrow new Error( 'FunctionNode: Function is not a WGSL code.' );\n\n\t}\n\n};\n\nclass WGSLNodeFunction extends NodeFunction {\n\n\tconstructor( source ) {\n\n\t\tconst { type, inputs, name, inputsCode, blockCode, outputType } = parse( source );\n\n\t\tsuper( type, inputs, name );\n\n\t\tthis.inputsCode = inputsCode;\n\t\tthis.blockCode = blockCode;\n\t\tthis.outputType = outputType;\n\n\t}\n\n\tgetCode( name = this.name ) {\n\n\t\tconst outputType = this.outputType !== 'void' ? '-> ' + this.outputType : '';\n\n\t\treturn `fn ${ name } ( ${ this.inputsCode.trim() } ) ${ outputType }` + this.blockCode;\n\n\t}\n\n}\n\nclass WGSLNodeParser extends NodeParser {\n\n\tparseFunction( source ) {\n\n\t\treturn new WGSLNodeFunction( source );\n\n\t}\n\n}\n\n// GPUShaderStage is not defined in browsers not supporting WebGPU\nconst GPUShaderStage = ( typeof self !== 'undefined' ) ? self.GPUShaderStage : { VERTEX: 1, FRAGMENT: 2, COMPUTE: 4 };\n\nconst accessNames = {\n\t[ NodeAccess.READ_ONLY ]: 'read',\n\t[ NodeAccess.WRITE_ONLY ]: 'write',\n\t[ NodeAccess.READ_WRITE ]: 'read_write'\n};\n\nconst wrapNames = {\n\t[ RepeatWrapping ]: 'repeat',\n\t[ ClampToEdgeWrapping ]: 'clamp',\n\t[ MirroredRepeatWrapping ]: 'mirror'\n};\n\nconst gpuShaderStageLib = {\n\t'vertex': GPUShaderStage ? GPUShaderStage.VERTEX : 1,\n\t'fragment': GPUShaderStage ? GPUShaderStage.FRAGMENT : 2,\n\t'compute': GPUShaderStage ? GPUShaderStage.COMPUTE : 4\n};\n\nconst supports = {\n\tinstance: true,\n\tswizzleAssign: false,\n\tstorageBuffer: true\n};\n\nconst wgslFnOpLib = {\n\t'^^': 'tsl_xor'\n};\n\nconst wgslTypeLib = {\n\tfloat: 'f32',\n\tint: 'i32',\n\tuint: 'u32',\n\tbool: 'bool',\n\tcolor: 'vec3<f32>',\n\n\tvec2: 'vec2<f32>',\n\tivec2: 'vec2<i32>',\n\tuvec2: 'vec2<u32>',\n\tbvec2: 'vec2<bool>',\n\n\tvec3: 'vec3<f32>',\n\tivec3: 'vec3<i32>',\n\tuvec3: 'vec3<u32>',\n\tbvec3: 'vec3<bool>',\n\n\tvec4: 'vec4<f32>',\n\tivec4: 'vec4<i32>',\n\tuvec4: 'vec4<u32>',\n\tbvec4: 'vec4<bool>',\n\n\tmat2: 'mat2x2<f32>',\n\tmat3: 'mat3x3<f32>',\n\tmat4: 'mat4x4<f32>'\n};\n\nconst wgslCodeCache = {};\n\nconst wgslPolyfill = {\n\ttsl_xor: new CodeNode( 'fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }' ),\n\tmod_float: new CodeNode( 'fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }' ),\n\tmod_vec2: new CodeNode( 'fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }' ),\n\tmod_vec3: new CodeNode( 'fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }' ),\n\tmod_vec4: new CodeNode( 'fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }' ),\n\tequals_bool: new CodeNode( 'fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }' ),\n\tequals_bvec2: new CodeNode( 'fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }' ),\n\tequals_bvec3: new CodeNode( 'fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }' ),\n\tequals_bvec4: new CodeNode( 'fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }' ),\n\trepeatWrapping_float: new CodeNode( 'fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }' ),\n\tmirrorWrapping_float: new CodeNode( 'fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }' ),\n\tclampWrapping_float: new CodeNode( 'fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }' ),\n\tbiquadraticTexture: new CodeNode( /* wgsl */`\nfn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {\n\n\tlet res = vec2f( iRes );\n\n\tlet uvScaled = coord * res;\n\tlet uvWrapping = ( ( uvScaled % res ) + res ) % res;\n\n\t// https://www.shadertoy.com/view/WtyXRy\n\n\tlet uv = uvWrapping - 0.5;\n\tlet iuv = floor( uv );\n\tlet f = fract( uv );\n\n\tlet rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );\n\tlet rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );\n\tlet rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );\n\tlet rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );\n\n\treturn mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );\n\n}\n` )\n};\n\nconst wgslMethods = {\n\tdFdx: 'dpdx',\n\tdFdy: '- dpdy',\n\tmod_float: 'tsl_mod_float',\n\tmod_vec2: 'tsl_mod_vec2',\n\tmod_vec3: 'tsl_mod_vec3',\n\tmod_vec4: 'tsl_mod_vec4',\n\tequals_bool: 'tsl_equals_bool',\n\tequals_bvec2: 'tsl_equals_bvec2',\n\tequals_bvec3: 'tsl_equals_bvec3',\n\tequals_bvec4: 'tsl_equals_bvec4',\n\tinversesqrt: 'inverseSqrt',\n\tbitcast: 'bitcast<f32>'\n};\n\n// WebGPU issue: does not support pow() with negative base on Windows\n\nif ( typeof navigator !== 'undefined' && /Windows/g.test( navigator.userAgent ) ) {\n\n\twgslPolyfill.pow_float = new CodeNode( 'fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }' );\n\twgslPolyfill.pow_vec2 = new CodeNode( 'fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }', [ wgslPolyfill.pow_float ] );\n\twgslPolyfill.pow_vec3 = new CodeNode( 'fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }', [ wgslPolyfill.pow_float ] );\n\twgslPolyfill.pow_vec4 = new CodeNode( 'fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }', [ wgslPolyfill.pow_float ] );\n\n\twgslMethods.pow_float = 'tsl_pow_float';\n\twgslMethods.pow_vec2 = 'tsl_pow_vec2';\n\twgslMethods.pow_vec3 = 'tsl_pow_vec3';\n\twgslMethods.pow_vec4 = 'tsl_pow_vec4';\n\n}\n\n//\n\nlet diagnostics = '';\n\nif ( ( typeof navigator !== 'undefined' && /Firefox|Deno/g.test( navigator.userAgent ) ) !== true ) {\n\n\tdiagnostics += 'diagnostic( off, derivative_uniformity );\\n';\n\n}\n\n//\n\nclass WGSLNodeBuilder extends NodeBuilder {\n\n\tconstructor( object, renderer ) {\n\n\t\tsuper( object, renderer, new WGSLNodeParser() );\n\n\t\tthis.uniformGroups = {};\n\n\t\tthis.builtins = {};\n\n\t\tthis.directives = {};\n\n\t\tthis.scopedArrays = new Map();\n\n\t}\n\n\tneedsToWorkingColorSpace( texture ) {\n\n\t\treturn texture.isVideoTexture === true && texture.colorSpace !== NoColorSpace;\n\n\t}\n\n\t_generateTextureSample( texture, textureProperty, uvSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tif ( shaderStage === 'fragment' ) {\n\n\t\t\tif ( depthSnippet ) {\n\n\t\t\t\treturn `textureSample( ${ textureProperty }, ${ textureProperty }_sampler, ${ uvSnippet }, ${ depthSnippet } )`;\n\n\t\t\t} else {\n\n\t\t\t\treturn `textureSample( ${ textureProperty }, ${ textureProperty }_sampler, ${ uvSnippet } )`;\n\n\t\t\t}\n\n\t\t} else if ( this.isFilteredTexture( texture ) ) {\n\n\t\t\treturn this.generateFilteredTexture( texture, textureProperty, uvSnippet );\n\n\t\t} else {\n\n\t\t\treturn this.generateTextureLod( texture, textureProperty, uvSnippet, depthSnippet, '0' );\n\n\t\t}\n\n\t}\n\n\t_generateVideoSample( textureProperty, uvSnippet, shaderStage = this.shaderStage ) {\n\n\t\tif ( shaderStage === 'fragment' ) {\n\n\t\t\treturn `textureSampleBaseClampToEdge( ${ textureProperty }, ${ textureProperty }_sampler, vec2<f32>( ${ uvSnippet }.x, 1.0 - ${ uvSnippet }.y ) )`;\n\n\t\t} else {\n\n\t\t\tconsole.error( `WebGPURenderer: THREE.VideoTexture does not support ${ shaderStage } shader.` );\n\n\t\t}\n\n\t}\n\n\t_generateTextureSampleLevel( texture, textureProperty, uvSnippet, levelSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tif ( shaderStage === 'fragment' && this.isUnfilterable( texture ) === false ) {\n\n\t\t\treturn `textureSampleLevel( ${ textureProperty }, ${ textureProperty }_sampler, ${ uvSnippet }, ${ levelSnippet } )`;\n\n\t\t} else if ( this.isFilteredTexture( texture ) ) {\n\n\t\t\treturn this.generateFilteredTexture( texture, textureProperty, uvSnippet, levelSnippet );\n\n\t\t} else {\n\n\t\t\treturn this.generateTextureLod( texture, textureProperty, uvSnippet, depthSnippet, levelSnippet );\n\n\t\t}\n\n\t}\n\n\tgenerateWrapFunction( texture ) {\n\n\t\tconst functionName = `tsl_coord_${ wrapNames[ texture.wrapS ] }S_${ wrapNames[ texture.wrapT ] }T`;\n\n\t\tlet nodeCode = wgslCodeCache[ functionName ];\n\n\t\tif ( nodeCode === undefined ) {\n\n\t\t\tconst includes = [];\n\n\t\t\tlet code = `fn ${ functionName }( coord : vec2f ) -> vec2f {\\n\\n\\treturn vec2f(\\n`;\n\n\t\t\tconst addWrapSnippet = ( wrap, axis ) => {\n\n\t\t\t\tif ( wrap === RepeatWrapping ) {\n\n\t\t\t\t\tincludes.push( wgslPolyfill.repeatWrapping_float );\n\n\t\t\t\t\tcode += `\\t\\ttsl_repeatWrapping_float( coord.${ axis } )`;\n\n\t\t\t\t} else if ( wrap === ClampToEdgeWrapping ) {\n\n\t\t\t\t\tincludes.push( wgslPolyfill.clampWrapping_float );\n\n\t\t\t\t\tcode += `\\t\\ttsl_clampWrapping_float( coord.${ axis } )`;\n\n\t\t\t\t} else if ( wrap === MirroredRepeatWrapping ) {\n\n\t\t\t\t\tincludes.push( wgslPolyfill.mirrorWrapping_float );\n\n\t\t\t\t\tcode += `\\t\\ttsl_mirrorWrapping_float( coord.${ axis } )`;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcode += `\\t\\tcoord.${ axis }`;\n\n\t\t\t\t\tconsole.warn( `WebGPURenderer: Unsupported texture wrap type \"${ wrap }\" for vertex shader.` );\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t\taddWrapSnippet( texture.wrapS, 'x' );\n\n\t\t\tcode += ',\\n';\n\n\t\t\taddWrapSnippet( texture.wrapT, 'y' );\n\n\t\t\tcode += '\\n\\t);\\n\\n}\\n';\n\n\t\t\twgslCodeCache[ functionName ] = nodeCode = new CodeNode( code, includes );\n\n\t\t}\n\n\t\tnodeCode.build( this );\n\n\t\treturn functionName;\n\n\t}\n\n\tgenerateTextureDimension( texture, textureProperty, levelSnippet ) {\n\n\t\tconst textureData = this.getDataFromNode( texture, this.shaderStage, this.globalCache );\n\n\t\tif ( textureData.dimensionsSnippet === undefined ) textureData.dimensionsSnippet = {};\n\n\t\tlet textureDimensionNode = textureData.dimensionsSnippet[ levelSnippet ];\n\n\t\tif ( textureData.dimensionsSnippet[ levelSnippet ] === undefined ) {\n\n\t\t\tlet textureDimensionsParams;\n\n\t\t\tif ( texture.isMultisampleRenderTargetTexture === true ) {\n\n\t\t\t\ttextureDimensionsParams = textureProperty;\n\n\t\t\t} else {\n\n\t\t\t\ttextureDimensionsParams = `${ textureProperty }, u32( ${ levelSnippet } )`;\n\n\t\t\t}\n\n\t\t\ttextureDimensionNode = new VarNode( new ExpressionNode( `textureDimensions( ${ textureDimensionsParams } )`, 'uvec2' ) );\n\n\t\t\ttextureData.dimensionsSnippet[ levelSnippet ] = textureDimensionNode;\n\n\t\t}\n\n\t\treturn textureDimensionNode.build( this );\n\n\t}\n\n\tgenerateFilteredTexture( texture, textureProperty, uvSnippet, levelSnippet = '0u' ) {\n\n\t\tthis._include( 'biquadraticTexture' );\n\n\t\tconst wrapFunction = this.generateWrapFunction( texture );\n\t\tconst textureDimension = this.generateTextureDimension( texture, textureProperty, levelSnippet );\n\n\t\treturn `tsl_biquadraticTexture( ${ textureProperty }, ${ wrapFunction }( ${ uvSnippet } ), ${ textureDimension }, u32( ${ levelSnippet } ) )`;\n\n\t}\n\n\tgenerateTextureLod( texture, textureProperty, uvSnippet, depthSnippet, levelSnippet = '0u' ) {\n\n\t\tconst wrapFunction = this.generateWrapFunction( texture );\n\t\tconst textureDimension = this.generateTextureDimension( texture, textureProperty, levelSnippet );\n\n\t\tconst coordSnippet = `vec2u( ${ wrapFunction }( ${ uvSnippet } ) * vec2f( ${ textureDimension } ) )`;\n\n\t\treturn this.generateTextureLoad( texture, textureProperty, coordSnippet, depthSnippet, levelSnippet );\n\n\t}\n\n\tgenerateTextureLoad( texture, textureProperty, uvIndexSnippet, depthSnippet, levelSnippet = '0u' ) {\n\n\t\tif ( texture.isVideoTexture === true || texture.isStorageTexture === true ) {\n\n\t\t\treturn `textureLoad( ${ textureProperty }, ${ uvIndexSnippet } )`;\n\n\t\t} else if ( depthSnippet ) {\n\n\t\t\treturn `textureLoad( ${ textureProperty }, ${ uvIndexSnippet }, ${ depthSnippet }, u32( ${ levelSnippet } ) )`;\n\n\t\t} else {\n\n\t\t\treturn `textureLoad( ${ textureProperty }, ${ uvIndexSnippet }, u32( ${ levelSnippet } ) )`;\n\n\t\t}\n\n\t}\n\n\tgenerateTextureStore( texture, textureProperty, uvIndexSnippet, valueSnippet ) {\n\n\t\treturn `textureStore( ${ textureProperty }, ${ uvIndexSnippet }, ${ valueSnippet } )`;\n\n\t}\n\n\tisSampleCompare( texture ) {\n\n\t\treturn texture.isDepthTexture === true && texture.compareFunction !== null;\n\n\t}\n\n\tisUnfilterable( texture ) {\n\n\t\treturn this.getComponentTypeFromTexture( texture ) !== 'float' ||\n\t\t\t( ! this.isAvailable( 'float32Filterable' ) && texture.isDataTexture === true && texture.type === FloatType ) ||\n\t\t\t( this.isSampleCompare( texture ) === false && texture.minFilter === NearestFilter && texture.magFilter === NearestFilter ) ||\n\t\t\ttexture.isMultisampleRenderTargetTexture === true;\n\n\t}\n\n\tgenerateTexture( texture, textureProperty, uvSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tlet snippet = null;\n\n\t\tif ( texture.isVideoTexture === true ) {\n\n\t\t\tsnippet = this._generateVideoSample( textureProperty, uvSnippet, shaderStage );\n\n\t\t} else if ( this.isUnfilterable( texture ) ) {\n\n\t\t\tsnippet = this.generateTextureLod( texture, textureProperty, uvSnippet, depthSnippet, '0', shaderStage );\n\n\t\t} else {\n\n\t\t\tsnippet = this._generateTextureSample( texture, textureProperty, uvSnippet, depthSnippet, shaderStage );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tgenerateTextureGrad( texture, textureProperty, uvSnippet, gradSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tif ( shaderStage === 'fragment' ) {\n\n\t\t\t// TODO handle i32 or u32 --> uvSnippet, array_index: A, ddx, ddy\n\t\t\treturn `textureSampleGrad( ${ textureProperty }, ${ textureProperty }_sampler, ${ uvSnippet },  ${ gradSnippet[ 0 ] }, ${ gradSnippet[ 1 ] } )`;\n\n\t\t} else {\n\n\t\t\tconsole.error( `WebGPURenderer: THREE.TextureNode.gradient() does not support ${ shaderStage } shader.` );\n\n\t\t}\n\n\t}\n\n\tgenerateTextureCompare( texture, textureProperty, uvSnippet, compareSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tif ( shaderStage === 'fragment' ) {\n\n\t\t\treturn `textureSampleCompare( ${ textureProperty }, ${ textureProperty }_sampler, ${ uvSnippet }, ${ compareSnippet } )`;\n\n\t\t} else {\n\n\t\t\tconsole.error( `WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${ shaderStage } shader.` );\n\n\t\t}\n\n\t}\n\n\tgenerateTextureLevel( texture, textureProperty, uvSnippet, levelSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tlet snippet = null;\n\n\t\tif ( texture.isVideoTexture === true ) {\n\n\t\t\tsnippet = this._generateVideoSample( textureProperty, uvSnippet, shaderStage );\n\n\t\t} else {\n\n\t\t\tsnippet = this._generateTextureSampleLevel( texture, textureProperty, uvSnippet, levelSnippet, depthSnippet, shaderStage );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tgenerateTextureBias( texture, textureProperty, uvSnippet, biasSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tif ( shaderStage === 'fragment' ) {\n\n\t\t\treturn `textureSampleBias( ${ textureProperty }, ${ textureProperty }_sampler, ${ uvSnippet }, ${ biasSnippet } )`;\n\n\t\t} else {\n\n\t\t\tconsole.error( `WebGPURenderer: THREE.TextureNode.biasNode does not support ${ shaderStage } shader.` );\n\n\t\t}\n\n\t}\n\n\tgetPropertyName( node, shaderStage = this.shaderStage ) {\n\n\t\tif ( node.isNodeVarying === true && node.needsInterpolation === true ) {\n\n\t\t\tif ( shaderStage === 'vertex' ) {\n\n\t\t\t\treturn `varyings.${ node.name }`;\n\n\t\t\t}\n\n\t\t} else if ( node.isNodeUniform === true ) {\n\n\t\t\tconst name = node.name;\n\t\t\tconst type = node.type;\n\n\t\t\tif ( type === 'texture' || type === 'cubeTexture' || type === 'storageTexture' || type === 'texture3D' ) {\n\n\t\t\t\treturn name;\n\n\t\t\t} else if ( type === 'buffer' || type === 'storageBuffer' || type === 'indirectStorageBuffer' ) {\n\n\t\t\t\treturn `NodeBuffer_${ node.id }.${name}`;\n\n\t\t\t} else {\n\n\t\t\t\treturn node.groupNode.name + '.' + name;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn super.getPropertyName( node );\n\n\t}\n\n\tgetOutputStructName() {\n\n\t\treturn 'output';\n\n\t}\n\n\t_getUniformGroupCount( shaderStage ) {\n\n\t\treturn Object.keys( this.uniforms[ shaderStage ] ).length;\n\n\t}\n\n\tgetFunctionOperator( op ) {\n\n\t\tconst fnOp = wgslFnOpLib[ op ];\n\n\t\tif ( fnOp !== undefined ) {\n\n\t\t\tthis._include( fnOp );\n\n\t\t\treturn fnOp;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tgetNodeAccess( node, shaderStage ) {\n\n\t\tif ( shaderStage !== 'compute' )\n\t\t\treturn NodeAccess.READ_ONLY;\n\n\t\treturn node.access;\n\n\t}\n\n\tgetStorageAccess( node, shaderStage ) {\n\n\t\treturn accessNames[ this.getNodeAccess( node, shaderStage ) ];\n\n\t}\n\n\tgetUniformFromNode( node, type, shaderStage, name = null ) {\n\n\t\tconst uniformNode = super.getUniformFromNode( node, type, shaderStage, name );\n\t\tconst nodeData = this.getDataFromNode( node, shaderStage, this.globalCache );\n\n\t\tif ( nodeData.uniformGPU === undefined ) {\n\n\t\t\tlet uniformGPU;\n\n\t\t\tconst group = node.groupNode;\n\t\t\tconst groupName = group.name;\n\n\t\t\tconst bindings = this.getBindGroupArray( groupName, shaderStage );\n\n\t\t\tif ( type === 'texture' || type === 'cubeTexture' || type === 'storageTexture' || type === 'texture3D' ) {\n\n\t\t\t\tlet texture = null;\n\n\t\t\t\tconst access = this.getNodeAccess( node, shaderStage );\n\n\t\t\t\tif ( type === 'texture' || type === 'storageTexture' ) {\n\n\t\t\t\t\ttexture = new NodeSampledTexture( uniformNode.name, uniformNode.node, group, access );\n\n\t\t\t\t} else if ( type === 'cubeTexture' ) {\n\n\t\t\t\t\ttexture = new NodeSampledCubeTexture( uniformNode.name, uniformNode.node, group, access );\n\n\t\t\t\t} else if ( type === 'texture3D' ) {\n\n\t\t\t\t\ttexture = new NodeSampledTexture3D( uniformNode.name, uniformNode.node, group, access );\n\n\t\t\t\t}\n\n\t\t\t\ttexture.store = node.isStorageTextureNode === true;\n\t\t\t\ttexture.setVisibility( gpuShaderStageLib[ shaderStage ] );\n\n\t\t\t\tif ( shaderStage === 'fragment' && this.isUnfilterable( node.value ) === false && texture.store === false ) {\n\n\t\t\t\t\tconst sampler = new NodeSampler( `${uniformNode.name}_sampler`, uniformNode.node, group );\n\t\t\t\t\tsampler.setVisibility( gpuShaderStageLib[ shaderStage ] );\n\n\t\t\t\t\tbindings.push( sampler, texture );\n\n\t\t\t\t\tuniformGPU = [ sampler, texture ];\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbindings.push( texture );\n\n\t\t\t\t\tuniformGPU = [ texture ];\n\n\t\t\t\t}\n\n\t\t\t} else if ( type === 'buffer' || type === 'storageBuffer' || type === 'indirectStorageBuffer' ) {\n\n\t\t\t\tconst bufferClass = type === 'buffer' ? NodeUniformBuffer : NodeStorageBuffer;\n\n\t\t\t\tconst buffer = new bufferClass( node, group );\n\t\t\t\tbuffer.setVisibility( gpuShaderStageLib[ shaderStage ] );\n\n\t\t\t\tbindings.push( buffer );\n\n\t\t\t\tuniformGPU = buffer;\n\n\t\t\t} else {\n\n\t\t\t\tconst uniformsStage = this.uniformGroups[ shaderStage ] || ( this.uniformGroups[ shaderStage ] = {} );\n\n\t\t\t\tlet uniformsGroup = uniformsStage[ groupName ];\n\n\t\t\t\tif ( uniformsGroup === undefined ) {\n\n\t\t\t\t\tuniformsGroup = new NodeUniformsGroup( groupName, group );\n\t\t\t\t\tuniformsGroup.setVisibility( gpuShaderStageLib[ shaderStage ] );\n\n\t\t\t\t\tuniformsStage[ groupName ] = uniformsGroup;\n\n\t\t\t\t\tbindings.push( uniformsGroup );\n\n\t\t\t\t}\n\n\t\t\t\tuniformGPU = this.getNodeUniform( uniformNode, type );\n\n\t\t\t\tuniformsGroup.addUniform( uniformGPU );\n\n\t\t\t}\n\n\t\t\tnodeData.uniformGPU = uniformGPU;\n\n\t\t}\n\n\t\treturn uniformNode;\n\n\t}\n\n\tgetBuiltin( name, property, type, shaderStage = this.shaderStage ) {\n\n\t\tconst map = this.builtins[ shaderStage ] || ( this.builtins[ shaderStage ] = new Map() );\n\n\t\tif ( map.has( name ) === false ) {\n\n\t\t\tmap.set( name, {\n\t\t\t\tname,\n\t\t\t\tproperty,\n\t\t\t\ttype\n\t\t\t} );\n\n\t\t}\n\n\t\treturn property;\n\n\t}\n\n\thasBuiltin( name, shaderStage = this.shaderStage ) {\n\n\t\treturn ( this.builtins[ shaderStage ] !== undefined && this.builtins[ shaderStage ].has( name ) );\n\n\t}\n\n\tgetVertexIndex() {\n\n\t\tif ( this.shaderStage === 'vertex' ) {\n\n\t\t\treturn this.getBuiltin( 'vertex_index', 'vertexIndex', 'u32', 'attribute' );\n\n\t\t}\n\n\t\treturn 'vertexIndex';\n\n\t}\n\n\tbuildFunctionCode( shaderNode ) {\n\n\t\tconst layout = shaderNode.layout;\n\t\tconst flowData = this.flowShaderNode( shaderNode );\n\n\t\tconst parameters = [];\n\n\t\tfor ( const input of layout.inputs ) {\n\n\t\t\tparameters.push( input.name + ' : ' + this.getType( input.type ) );\n\n\t\t}\n\n\t\t//\n\n\t\tlet code = `fn ${ layout.name }( ${ parameters.join( ', ' ) } ) -> ${ this.getType( layout.type ) } {\n${ flowData.vars }\n${ flowData.code }\n`;\n\n\t\tif ( flowData.result ) {\n\n\t\t\tcode += `\\treturn ${ flowData.result };\\n`;\n\n\t\t}\n\n\t\tcode += '\\n}\\n';\n\n\t\t//\n\n\t\treturn code;\n\n\t}\n\n\tgetInstanceIndex() {\n\n\t\tif ( this.shaderStage === 'vertex' ) {\n\n\t\t\treturn this.getBuiltin( 'instance_index', 'instanceIndex', 'u32', 'attribute' );\n\n\t\t}\n\n\t\treturn 'instanceIndex';\n\n\t}\n\n\tgetInvocationLocalIndex() {\n\n\t\treturn this.getBuiltin( 'local_invocation_index', 'invocationLocalIndex', 'u32', 'attribute' );\n\n\t}\n\n\tgetSubgroupSize() {\n\n\t\tthis.enableSubGroups();\n\n\t\treturn this.getBuiltin( 'subgroup_size', 'subgroupSize', 'u32', 'attribute' );\n\n\t}\n\n\tgetInvocationSubgroupIndex() {\n\n\t\tthis.enableSubGroups();\n\n\t\treturn this.getBuiltin( 'subgroup_invocation_id', 'invocationSubgroupIndex', 'u32', 'attribute' );\n\n\t}\n\n\tgetSubgroupIndex() {\n\n\t\tthis.enableSubGroups();\n\n\t\treturn this.getBuiltin( 'subgroup_id', 'subgroupIndex', 'u32', 'attribute' );\n\n\t}\n\n\tgetDrawIndex() {\n\n\t\treturn null;\n\n\t}\n\n\tgetFrontFacing() {\n\n\t\treturn this.getBuiltin( 'front_facing', 'isFront', 'bool' );\n\n\t}\n\n\tgetFragCoord() {\n\n\t\treturn this.getBuiltin( 'position', 'fragCoord', 'vec4<f32>' ) + '.xy';\n\n\t}\n\n\tgetFragDepth() {\n\n\t\treturn 'output.' + this.getBuiltin( 'frag_depth', 'depth', 'f32', 'output' );\n\n\t}\n\n\tgetClipDistance() {\n\n\t\treturn 'varyings.hw_clip_distances';\n\n\t}\n\n\tisFlipY() {\n\n\t\treturn false;\n\n\t}\n\n\tenableDirective( name, shaderStage = this.shaderStage ) {\n\n\t\tconst stage = this.directives[ shaderStage ] || ( this.directives[ shaderStage ] = new Set() );\n\t\tstage.add( name );\n\n\t}\n\n\tgetDirectives( shaderStage ) {\n\n\t\tconst snippets = [];\n\t\tconst directives = this.directives[ shaderStage ];\n\n\t\tif ( directives !== undefined ) {\n\n\t\t\tfor ( const directive of directives ) {\n\n\t\t\t\tsnippets.push( `enable ${directive};` );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn snippets.join( '\\n' );\n\n\t}\n\n\tenableSubGroups() {\n\n\t\tthis.enableDirective( 'subgroups' );\n\n\t}\n\n\tenableSubgroupsF16() {\n\n\t\tthis.enableDirective( 'subgroups-f16' );\n\n\t}\n\n\tenableClipDistances() {\n\n\t\tthis.enableDirective( 'clip_distances' );\n\n\t}\n\n\tenableShaderF16() {\n\n\t\tthis.enableDirective( 'f16' );\n\n\t}\n\n\tenableDualSourceBlending() {\n\n\t\tthis.enableDirective( 'dual_source_blending' );\n\n\t}\n\n\tenableHardwareClipping( planeCount ) {\n\n\t\tthis.enableClipDistances();\n\t\tthis.getBuiltin( 'clip_distances', 'hw_clip_distances', `array<f32, ${ planeCount } >`, 'vertex' );\n\n\t}\n\n\tgetBuiltins( shaderStage ) {\n\n\t\tconst snippets = [];\n\t\tconst builtins = this.builtins[ shaderStage ];\n\n\t\tif ( builtins !== undefined ) {\n\n\t\t\tfor ( const { name, property, type } of builtins.values() ) {\n\n\t\t\t\tsnippets.push( `@builtin( ${name} ) ${property} : ${type}` );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn snippets.join( ',\\n\\t' );\n\n\t}\n\n\tgetScopedArray( name, scope, bufferType, bufferCount ) {\n\n\t\tif ( this.scopedArrays.has( name ) === false ) {\n\n\t\t\tthis.scopedArrays.set( name, {\n\t\t\t\tname,\n\t\t\t\tscope,\n\t\t\t\tbufferType,\n\t\t\t\tbufferCount\n\t\t\t} );\n\n\t\t}\n\n\t\treturn name;\n\n\t}\n\n\tgetScopedArrays( shaderStage ) {\n\n\t\tif ( shaderStage !== 'compute' ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst snippets = [];\n\n\t\tfor ( const { name, scope, bufferType, bufferCount } of this.scopedArrays.values() ) {\n\n\t\t\tconst type = this.getType( bufferType );\n\n\t\t\tsnippets.push( `var<${scope}> ${name}: array< ${type}, ${bufferCount} >;` );\n\n\t\t}\n\n\t\treturn snippets.join( '\\n' );\n\n\t}\n\n\tgetAttributes( shaderStage ) {\n\n\t\tconst snippets = [];\n\n\t\tif ( shaderStage === 'compute' ) {\n\n\t\t\tthis.getBuiltin( 'global_invocation_id', 'id', 'vec3<u32>', 'attribute' );\n\t\t\tthis.getBuiltin( 'workgroup_id', 'workgroupId', 'vec3<u32>', 'attribute' );\n\t\t\tthis.getBuiltin( 'local_invocation_id', 'localId', 'vec3<u32>', 'attribute' );\n\t\t\tthis.getBuiltin( 'num_workgroups', 'numWorkgroups', 'vec3<u32>', 'attribute' );\n\n\t\t\tif ( this.renderer.hasFeature( 'subgroups' ) ) {\n\n\t\t\t\tthis.enableDirective( 'subgroups', shaderStage );\n\t\t\t\tthis.getBuiltin( 'subgroup_size', 'subgroupSize', 'u32', 'attribute' );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( shaderStage === 'vertex' || shaderStage === 'compute' ) {\n\n\t\t\tconst builtins = this.getBuiltins( 'attribute' );\n\n\t\t\tif ( builtins ) snippets.push( builtins );\n\n\t\t\tconst attributes = this.getAttributesArray();\n\n\t\t\tfor ( let index = 0, length = attributes.length; index < length; index ++ ) {\n\n\t\t\t\tconst attribute = attributes[ index ];\n\t\t\t\tconst name = attribute.name;\n\t\t\t\tconst type = this.getType( attribute.type );\n\n\t\t\t\tsnippets.push( `@location( ${index} ) ${ name } : ${ type }` );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn snippets.join( ',\\n\\t' );\n\n\t}\n\n\tgetStructMembers( struct ) {\n\n\t\tconst snippets = [];\n\t\tconst members = struct.getMemberTypes();\n\n\t\tfor ( let i = 0; i < members.length; i ++ ) {\n\n\t\t\tconst member = members[ i ];\n\t\t\tsnippets.push( `\\t@location( ${i} ) m${i} : ${ member }<f32>` );\n\n\t\t}\n\n\t\tconst builtins = this.getBuiltins( 'output' );\n\n\t\tif ( builtins ) snippets.push( '\\t' + builtins );\n\n\t\treturn snippets.join( ',\\n' );\n\n\t}\n\n\tgetStructs( shaderStage ) {\n\n\t\tconst snippets = [];\n\t\tconst structs = this.structs[ shaderStage ];\n\n\t\tfor ( let index = 0, length = structs.length; index < length; index ++ ) {\n\n\t\t\tconst struct = structs[ index ];\n\t\t\tconst name = struct.name;\n\n\t\t\tlet snippet = `\\struct ${ name } {\\n`;\n\t\t\tsnippet += this.getStructMembers( struct );\n\t\t\tsnippet += '\\n}';\n\n\n\t\t\tsnippets.push( snippet );\n\n\t\t\tsnippets.push( `\\nvar<private> output : ${ name };\\n\\n` );\n\n\t\t}\n\n\t\treturn snippets.join( '\\n\\n' );\n\n\t}\n\n\tgetVar( type, name ) {\n\n\t\treturn `var ${ name } : ${ this.getType( type ) }`;\n\n\t}\n\n\tgetVars( shaderStage ) {\n\n\t\tconst snippets = [];\n\t\tconst vars = this.vars[ shaderStage ];\n\n\t\tif ( vars !== undefined ) {\n\n\t\t\tfor ( const variable of vars ) {\n\n\t\t\t\tsnippets.push( `\\t${ this.getVar( variable.type, variable.name ) };` );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn `\\n${ snippets.join( '\\n' ) }\\n`;\n\n\t}\n\n\tgetVaryings( shaderStage ) {\n\n\t\tconst snippets = [];\n\n\t\tif ( shaderStage === 'vertex' ) {\n\n\t\t\tthis.getBuiltin( 'position', 'Vertex', 'vec4<f32>', 'vertex' );\n\n\t\t}\n\n\t\tif ( shaderStage === 'vertex' || shaderStage === 'fragment' ) {\n\n\t\t\tconst varyings = this.varyings;\n\t\t\tconst vars = this.vars[ shaderStage ];\n\n\t\t\tfor ( let index = 0; index < varyings.length; index ++ ) {\n\n\t\t\t\tconst varying = varyings[ index ];\n\n\t\t\t\tif ( varying.needsInterpolation ) {\n\n\t\t\t\t\tlet attributesSnippet = `@location( ${index} )`;\n\n\t\t\t\t\tif ( /^(int|uint|ivec|uvec)/.test( varying.type ) ) {\n\n\t\t\t\t\t\tattributesSnippet += ' @interpolate( flat )';\n\n\n\t\t\t\t\t}\n\n\t\t\t\t\tsnippets.push( `${ attributesSnippet } ${ varying.name } : ${ this.getType( varying.type ) }` );\n\n\t\t\t\t} else if ( shaderStage === 'vertex' && vars.includes( varying ) === false ) {\n\n\t\t\t\t\tvars.push( varying );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst builtins = this.getBuiltins( shaderStage );\n\n\t\tif ( builtins ) snippets.push( builtins );\n\n\t\tconst code = snippets.join( ',\\n\\t' );\n\n\t\treturn shaderStage === 'vertex' ? this._getWGSLStruct( 'VaryingsStruct', '\\t' + code ) : code;\n\n\t}\n\n\tgetUniforms( shaderStage ) {\n\n\t\tconst uniforms = this.uniforms[ shaderStage ];\n\n\t\tconst bindingSnippets = [];\n\t\tconst bufferSnippets = [];\n\t\tconst structSnippets = [];\n\t\tconst uniformGroups = {};\n\n\t\tfor ( const uniform of uniforms ) {\n\n\t\t\tconst groupName = uniform.groupNode.name;\n\t\t\tconst uniformIndexes = this.bindingsIndexes[ groupName ];\n\n\t\t\tif ( uniform.type === 'texture' || uniform.type === 'cubeTexture' || uniform.type === 'storageTexture' || uniform.type === 'texture3D' ) {\n\n\t\t\t\tconst texture = uniform.node.value;\n\n\t\t\t\tif ( shaderStage === 'fragment' && this.isUnfilterable( texture ) === false && uniform.node.isStorageTextureNode !== true ) {\n\n\t\t\t\t\tif ( this.isSampleCompare( texture ) ) {\n\n\t\t\t\t\t\tbindingSnippets.push( `@binding( ${ uniformIndexes.binding ++ } ) @group( ${ uniformIndexes.group } ) var ${ uniform.name }_sampler : sampler_comparison;` );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tbindingSnippets.push( `@binding( ${ uniformIndexes.binding ++ } ) @group( ${ uniformIndexes.group } ) var ${ uniform.name }_sampler : sampler;` );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tlet textureType;\n\n\t\t\t\tlet multisampled = '';\n\n\t\t\t\tif ( texture.isMultisampleRenderTargetTexture === true ) {\n\n\t\t\t\t\tmultisampled = '_multisampled';\n\n\t\t\t\t}\n\n\t\t\t\tif ( texture.isCubeTexture === true ) {\n\n\t\t\t\t\ttextureType = 'texture_cube<f32>';\n\n\t\t\t\t} else if ( texture.isDataArrayTexture === true || texture.isCompressedArrayTexture === true ) {\n\n\t\t\t\t\ttextureType = 'texture_2d_array<f32>';\n\n\t\t\t\t} else if ( texture.isDepthTexture === true ) {\n\n\t\t\t\t\ttextureType = `texture_depth${multisampled}_2d`;\n\n\t\t\t\t} else if ( texture.isVideoTexture === true ) {\n\n\t\t\t\t\ttextureType = 'texture_external';\n\n\t\t\t\t} else if ( texture.isData3DTexture === true ) {\n\n\t\t\t\t\ttextureType = 'texture_3d<f32>';\n\n\t\t\t\t} else if ( uniform.node.isStorageTextureNode === true ) {\n\n\t\t\t\t\tconst format = getFormat( texture );\n\t\t\t\t\tconst access = this.getStorageAccess( uniform.node, shaderStage );\n\n\t\t\t\t\ttextureType = `texture_storage_2d<${ format }, ${ access }>`;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst componentPrefix = this.getComponentTypeFromTexture( texture ).charAt( 0 );\n\n\t\t\t\t\ttextureType = `texture${multisampled}_2d<${ componentPrefix }32>`;\n\n\t\t\t\t}\n\n\t\t\t\tbindingSnippets.push( `@binding( ${ uniformIndexes.binding ++ } ) @group( ${ uniformIndexes.group } ) var ${ uniform.name } : ${ textureType };` );\n\n\t\t\t} else if ( uniform.type === 'buffer' || uniform.type === 'storageBuffer' || uniform.type === 'indirectStorageBuffer' ) {\n\n\t\t\t\tconst bufferNode = uniform.node;\n\t\t\t\tconst bufferType = this.getType( bufferNode.bufferType );\n\t\t\t\tconst bufferCount = bufferNode.bufferCount;\n\n\t\t\t\tconst bufferCountSnippet = bufferCount > 0 && uniform.type === 'buffer' ? ', ' + bufferCount : '';\n\t\t\t\tconst bufferTypeSnippet = bufferNode.isAtomic ? `atomic<${bufferType}>` : `${bufferType}`;\n\t\t\t\tconst bufferSnippet = `\\t${ uniform.name } : array< ${ bufferTypeSnippet }${ bufferCountSnippet } >\\n`;\n\t\t\t\tconst bufferAccessMode = bufferNode.isStorageBufferNode ? `storage, ${ this.getStorageAccess( bufferNode, shaderStage ) }` : 'uniform';\n\n\t\t\t\tbufferSnippets.push( this._getWGSLStructBinding( 'NodeBuffer_' + bufferNode.id, bufferSnippet, bufferAccessMode, uniformIndexes.binding ++, uniformIndexes.group ) );\n\n\t\t\t} else {\n\n\t\t\t\tconst vectorType = this.getType( this.getVectorType( uniform.type ) );\n\t\t\t\tconst groupName = uniform.groupNode.name;\n\n\t\t\t\tconst group = uniformGroups[ groupName ] || ( uniformGroups[ groupName ] = {\n\t\t\t\t\tindex: uniformIndexes.binding ++,\n\t\t\t\t\tid: uniformIndexes.group,\n\t\t\t\t\tsnippets: []\n\t\t\t\t} );\n\n\t\t\t\tgroup.snippets.push( `\\t${ uniform.name } : ${ vectorType }` );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( const name in uniformGroups ) {\n\n\t\t\tconst group = uniformGroups[ name ];\n\n\t\t\tstructSnippets.push( this._getWGSLStructBinding( name, group.snippets.join( ',\\n' ), 'uniform', group.index, group.id ) );\n\n\t\t}\n\n\t\tlet code = bindingSnippets.join( '\\n' );\n\t\tcode += bufferSnippets.join( '\\n' );\n\t\tcode += structSnippets.join( '\\n' );\n\n\t\treturn code;\n\n\t}\n\n\tbuildCode() {\n\n\t\tconst shadersData = this.material !== null ? { fragment: {}, vertex: {} } : { compute: {} };\n\n\t\tthis.sortBindingGroups();\n\n\t\tfor ( const shaderStage in shadersData ) {\n\n\t\t\tconst stageData = shadersData[ shaderStage ];\n\t\t\tstageData.uniforms = this.getUniforms( shaderStage );\n\t\t\tstageData.attributes = this.getAttributes( shaderStage );\n\t\t\tstageData.varyings = this.getVaryings( shaderStage );\n\t\t\tstageData.structs = this.getStructs( shaderStage );\n\t\t\tstageData.vars = this.getVars( shaderStage );\n\t\t\tstageData.codes = this.getCodes( shaderStage );\n\t\t\tstageData.directives = this.getDirectives( shaderStage );\n\t\t\tstageData.scopedArrays = this.getScopedArrays( shaderStage );\n\n\t\t\t//\n\n\t\t\tlet flow = '// code\\n\\n';\n\t\t\tflow += this.flowCode[ shaderStage ];\n\n\t\t\tconst flowNodes = this.flowNodes[ shaderStage ];\n\t\t\tconst mainNode = flowNodes[ flowNodes.length - 1 ];\n\n\t\t\tconst outputNode = mainNode.outputNode;\n\t\t\tconst isOutputStruct = ( outputNode !== undefined && outputNode.isOutputStructNode === true );\n\n\t\t\tfor ( const node of flowNodes ) {\n\n\t\t\t\tconst flowSlotData = this.getFlowData( node/*, shaderStage*/ );\n\t\t\t\tconst slotName = node.name;\n\n\t\t\t\tif ( slotName ) {\n\n\t\t\t\t\tif ( flow.length > 0 ) flow += '\\n';\n\n\t\t\t\t\tflow += `\\t// flow -> ${ slotName }\\n\\t`;\n\n\t\t\t\t}\n\n\t\t\t\tflow += `${ flowSlotData.code }\\n\\t`;\n\n\t\t\t\tif ( node === mainNode && shaderStage !== 'compute' ) {\n\n\t\t\t\t\tflow += '// result\\n\\n\\t';\n\n\t\t\t\t\tif ( shaderStage === 'vertex' ) {\n\n\t\t\t\t\t\tflow += `varyings.Vertex = ${ flowSlotData.result };`;\n\n\t\t\t\t\t} else if ( shaderStage === 'fragment' ) {\n\n\t\t\t\t\t\tif ( isOutputStruct ) {\n\n\t\t\t\t\t\t\tstageData.returnType = outputNode.nodeType;\n\n\t\t\t\t\t\t\tflow += `return ${ flowSlotData.result };`;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tlet structSnippet = '\\t@location(0) color: vec4<f32>';\n\n\t\t\t\t\t\t\tconst builtins = this.getBuiltins( 'output' );\n\n\t\t\t\t\t\t\tif ( builtins ) structSnippet += ',\\n\\t' + builtins;\n\n\t\t\t\t\t\t\tstageData.returnType = 'OutputStruct';\n\t\t\t\t\t\t\tstageData.structs += this._getWGSLStruct( 'OutputStruct', structSnippet );\n\t\t\t\t\t\t\tstageData.structs += '\\nvar<private> output : OutputStruct;\\n\\n';\n\n\t\t\t\t\t\t\tflow += `output.color = ${ flowSlotData.result };\\n\\n\\treturn output;`;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tstageData.flow = flow;\n\n\n\t\t}\n\n\t\tif ( this.material !== null ) {\n\n\t\t\tthis.vertexShader = this._getWGSLVertexCode( shadersData.vertex );\n\t\t\tthis.fragmentShader = this._getWGSLFragmentCode( shadersData.fragment );\n\n\t\t} else {\n\n\t\t\tthis.computeShader = this._getWGSLComputeCode( shadersData.compute, ( this.object.workgroupSize || [ 64 ] ).join( ', ' ) );\n\n\t\t}\n\n\t}\n\n\tgetMethod( method, output = null ) {\n\n\t\tlet wgslMethod;\n\n\t\tif ( output !== null ) {\n\n\t\t\twgslMethod = this._getWGSLMethod( method + '_' + output );\n\n\t\t}\n\n\t\tif ( wgslMethod === undefined ) {\n\n\t\t\twgslMethod = this._getWGSLMethod( method );\n\n\t\t}\n\n\t\treturn wgslMethod || method;\n\n\t}\n\n\tgetType( type ) {\n\n\t\treturn wgslTypeLib[ type ] || type;\n\n\t}\n\n\tisAvailable( name ) {\n\n\t\tlet result = supports[ name ];\n\n\t\tif ( result === undefined ) {\n\n\t\t\tif ( name === 'float32Filterable' ) {\n\n\t\t\t\tresult = this.renderer.hasFeature( 'float32-filterable' );\n\n\t\t\t} else if ( name === 'clipDistance' ) {\n\n\t\t\t\tresult = this.renderer.hasFeature( 'clip-distances' );\n\n\t\t\t}\n\n\t\t\tsupports[ name ] = result;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\t_getWGSLMethod( method ) {\n\n\t\tif ( wgslPolyfill[ method ] !== undefined ) {\n\n\t\t\tthis._include( method );\n\n\t\t}\n\n\t\treturn wgslMethods[ method ];\n\n\t}\n\n\t_include( name ) {\n\n\t\tconst codeNode = wgslPolyfill[ name ];\n\t\tcodeNode.build( this );\n\n\t\tif ( this.currentFunctionNode !== null ) {\n\n\t\t\tthis.currentFunctionNode.includes.push( codeNode );\n\n\t\t}\n\n\t\treturn codeNode;\n\n\t}\n\n\t_getWGSLVertexCode( shaderData ) {\n\n\t\treturn `${ this.getSignature() }\n// directives\n${shaderData.directives}\n\n// uniforms\n${shaderData.uniforms}\n\n// varyings\n${shaderData.varyings}\nvar<private> varyings : VaryingsStruct;\n\n// codes\n${shaderData.codes}\n\n@vertex\nfn main( ${shaderData.attributes} ) -> VaryingsStruct {\n\n\t// vars\n\t${shaderData.vars}\n\n\t// flow\n\t${shaderData.flow}\n\n\treturn varyings;\n\n}\n`;\n\n\t}\n\n\t_getWGSLFragmentCode( shaderData ) {\n\n\t\treturn `${ this.getSignature() }\n// global\n${ diagnostics }\n\n// uniforms\n${shaderData.uniforms}\n\n// structs\n${shaderData.structs}\n\n// codes\n${shaderData.codes}\n\n@fragment\nfn main( ${shaderData.varyings} ) -> ${shaderData.returnType} {\n\n\t// vars\n\t${shaderData.vars}\n\n\t// flow\n\t${shaderData.flow}\n\n}\n`;\n\n\t}\n\n\t_getWGSLComputeCode( shaderData, workgroupSize ) {\n\n\t\treturn `${ this.getSignature() }\n// directives\n${shaderData.directives}\n\n// system\nvar<private> instanceIndex : u32;\n\n// locals\n${shaderData.scopedArrays}\n\n// uniforms\n${shaderData.uniforms}\n\n// codes\n${shaderData.codes}\n\n@compute @workgroup_size( ${workgroupSize} )\nfn main( ${shaderData.attributes} ) {\n\n\t// system\n\tinstanceIndex = id.x + id.y * numWorkgroups.x * u32(${workgroupSize}) + id.z * numWorkgroups.x * numWorkgroups.y * u32(${workgroupSize});\n\n\t// vars\n\t${shaderData.vars}\n\n\t// flow\n\t${shaderData.flow}\n\n}\n`;\n\n\t}\n\n\t_getWGSLStruct( name, vars ) {\n\n\t\treturn `\nstruct ${name} {\n${vars}\n};`;\n\n\t}\n\n\t_getWGSLStructBinding( name, vars, access, binding = 0, group = 0 ) {\n\n\t\tconst structName = name + 'Struct';\n\t\tconst structSnippet = this._getWGSLStruct( structName, vars );\n\n\t\treturn `${structSnippet}\n@binding( ${binding} ) @group( ${group} )\nvar<${access}> ${name} : ${structName};`;\n\n\t}\n\n}\n\nclass WebGPUUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t}\n\n\tgetCurrentDepthStencilFormat( renderContext ) {\n\n\t\tlet format;\n\n\t\tif ( renderContext.depthTexture !== null ) {\n\n\t\t\tformat = this.getTextureFormatGPU( renderContext.depthTexture );\n\n\t\t} else if ( renderContext.depth && renderContext.stencil ) {\n\n\t\t\tformat = GPUTextureFormat.Depth24PlusStencil8;\n\n\t\t} else if ( renderContext.depth ) {\n\n\t\t\tformat = GPUTextureFormat.Depth24Plus;\n\n\t\t}\n\n\t\treturn format;\n\n\t}\n\n\tgetTextureFormatGPU( texture ) {\n\n\t\treturn this.backend.get( texture ).format;\n\n\t}\n\n\tgetCurrentColorFormat( renderContext ) {\n\n\t\tlet format;\n\n\t\tif ( renderContext.textures !== null ) {\n\n\t\t\tformat = this.getTextureFormatGPU( renderContext.textures[ 0 ] );\n\n\t\t} else {\n\n\t\t\tformat = this.getPreferredCanvasFormat(); // default context format\n\n\t\t}\n\n\t\treturn format;\n\n\t}\n\n\tgetCurrentColorSpace( renderContext ) {\n\n\t\tif ( renderContext.textures !== null ) {\n\n\t\t\treturn renderContext.textures[ 0 ].colorSpace;\n\n\t\t}\n\n\t\treturn this.backend.renderer.outputColorSpace;\n\n\t}\n\n\tgetPrimitiveTopology( object, material ) {\n\n\t\tif ( object.isPoints ) return GPUPrimitiveTopology.PointList;\n\t\telse if ( object.isLineSegments || ( object.isMesh && material.wireframe === true ) ) return GPUPrimitiveTopology.LineList;\n\t\telse if ( object.isLine ) return GPUPrimitiveTopology.LineStrip;\n\t\telse if ( object.isMesh ) return GPUPrimitiveTopology.TriangleList;\n\n\t}\n\n\tgetSampleCount( sampleCount ) {\n\n\t\tlet count = 1;\n\n\t\tif ( sampleCount > 1 ) {\n\n\t\t\t// WebGPU only supports power-of-two sample counts and 2 is not a valid value\n\t\t\tcount = Math.pow( 2, Math.floor( Math.log2( sampleCount ) ) );\n\n\t\t\tif ( count === 2 ) {\n\n\t\t\t\tcount = 4;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn count;\n\n\t}\n\n\tgetSampleCountRenderContext( renderContext ) {\n\n\t\tif ( renderContext.textures !== null ) {\n\n\t\t\treturn this.getSampleCount( renderContext.sampleCount );\n\n\t\t}\n\n\t\treturn this.getSampleCount( this.backend.renderer.samples );\n\n\t}\n\n\tgetPreferredCanvasFormat() {\n\n\t\t// TODO: Remove this check when Quest 34.5 is out\n\t\t// https://github.com/mrdoob/three.js/pull/29221/files#r1731833949\n\n\t\tif ( navigator.userAgent.includes( 'Quest' ) ) {\n\n\t\t\treturn GPUTextureFormat.BGRA8Unorm;\n\n\t\t} else {\n\n\t\t\treturn navigator.gpu.getPreferredCanvasFormat();\n\n\t\t}\n\n\t}\n\n}\n\nconst typedArraysToVertexFormatPrefix = new Map( [\n\t[ Int8Array, [ 'sint8', 'snorm8' ]],\n\t[ Uint8Array, [ 'uint8', 'unorm8' ]],\n\t[ Int16Array, [ 'sint16', 'snorm16' ]],\n\t[ Uint16Array, [ 'uint16', 'unorm16' ]],\n\t[ Int32Array, [ 'sint32', 'snorm32' ]],\n\t[ Uint32Array, [ 'uint32', 'unorm32' ]],\n\t[ Float32Array, [ 'float32', ]],\n] );\n\nconst typedAttributeToVertexFormatPrefix = new Map( [\n\t[ Float16BufferAttribute, [ 'float16', ]],\n] );\n\nconst typeArraysToVertexFormatPrefixForItemSize1 = new Map( [\n\t[ Int32Array, 'sint32' ],\n\t[ Int16Array, 'sint32' ], // patch for INT16\n\t[ Uint32Array, 'uint32' ],\n\t[ Uint16Array, 'uint32' ], // patch for UINT16\n\t[ Float32Array, 'float32' ]\n] );\n\nclass WebGPUAttributeUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t}\n\n\tcreateAttribute( attribute, usage ) {\n\n\t\tconst bufferAttribute = this._getBufferAttribute( attribute );\n\n\t\tconst backend = this.backend;\n\t\tconst bufferData = backend.get( bufferAttribute );\n\n\t\tlet buffer = bufferData.buffer;\n\n\t\tif ( buffer === undefined ) {\n\n\t\t\tconst device = backend.device;\n\n\t\t\tlet array = bufferAttribute.array;\n\n\t\t\t// patch for INT16 and UINT16\n\t\t\tif ( attribute.normalized === false && ( array.constructor === Int16Array || array.constructor === Uint16Array ) ) {\n\n\t\t\t\tconst tempArray = new Uint32Array( array.length );\n\t\t\t\tfor ( let i = 0; i < array.length; i ++ ) {\n\n\t\t\t\t\ttempArray[ i ] = array[ i ];\n\n\t\t\t\t}\n\n\t\t\t\tarray = tempArray;\n\n\t\t\t}\n\n\t\t\tbufferAttribute.array = array;\n\n\t\t\tif ( ( bufferAttribute.isStorageBufferAttribute || bufferAttribute.isStorageInstancedBufferAttribute ) && bufferAttribute.itemSize === 3 ) {\n\n\t\t\t\tarray = new array.constructor( bufferAttribute.count * 4 );\n\n\t\t\t\tfor ( let i = 0; i < bufferAttribute.count; i ++ ) {\n\n\t\t\t\t\tarray.set( bufferAttribute.array.subarray( i * 3, i * 3 + 3 ), i * 4 );\n\n\t\t\t\t}\n\n\t\t\t\t// Update BufferAttribute\n\t\t\t\tbufferAttribute.itemSize = 4;\n\t\t\t\tbufferAttribute.array = array;\n\n\t\t\t}\n\n\t\t\tconst size = array.byteLength + ( ( 4 - ( array.byteLength % 4 ) ) % 4 ); // ensure 4 byte alignment, see #20441\n\n\t\t\tbuffer = device.createBuffer( {\n\t\t\t\tlabel: bufferAttribute.name,\n\t\t\t\tsize: size,\n\t\t\t\tusage: usage,\n\t\t\t\tmappedAtCreation: true\n\t\t\t} );\n\n\t\t\tnew array.constructor( buffer.getMappedRange() ).set( array );\n\n\t\t\tbuffer.unmap();\n\n\t\t\tbufferData.buffer = buffer;\n\n\t\t}\n\n\t}\n\n\tupdateAttribute( attribute ) {\n\n\t\tconst bufferAttribute = this._getBufferAttribute( attribute );\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\n\t\tconst buffer = backend.get( bufferAttribute ).buffer;\n\n\t\tconst array = bufferAttribute.array;\n\t\tconst isTypedArray = this._isTypedArray( array );\n\t\tconst updateRanges = bufferAttribute.updateRanges;\n\n\t\tif ( updateRanges.length === 0 ) {\n\n\t\t\t// Not using update ranges\n\n\t\t\tdevice.queue.writeBuffer(\n\t\t\t\tbuffer,\n\t\t\t\t0,\n\t\t\t\tarray,\n\t\t\t\t0\n\t\t\t);\n\n\t\t} else {\n\n\t\t\tconst byteOffsetFactor = isTypedArray ? 1 : array.BYTES_PER_ELEMENT;\n\n\t\t\tfor ( let i = 0, l = updateRanges.length; i < l; i ++ ) {\n\n\t\t\t\tconst range = updateRanges[ i ];\n\n\t\t\t\tconst dataOffset = range.start * byteOffsetFactor;\n\t\t\t\tconst size = range.count * byteOffsetFactor;\n\n\t\t\t\tdevice.queue.writeBuffer(\n\t\t\t\t\tbuffer,\n\t\t\t\t\t0,\n\t\t\t\t\tarray,\n\t\t\t\t\tdataOffset,\n\t\t\t\t\tsize\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t\tbufferAttribute.clearUpdateRanges();\n\n\t\t}\n\n\t}\n\n\tcreateShaderVertexBuffers( renderObject ) {\n\n\t\tconst attributes = renderObject.getAttributes();\n\t\tconst vertexBuffers = new Map();\n\n\t\tfor ( let slot = 0; slot < attributes.length; slot ++ ) {\n\n\t\t\tconst geometryAttribute = attributes[ slot ];\n\t\t\tconst bytesPerElement = geometryAttribute.array.BYTES_PER_ELEMENT;\n\t\t\tconst bufferAttribute = this._getBufferAttribute( geometryAttribute );\n\n\t\t\tlet vertexBufferLayout = vertexBuffers.get( bufferAttribute );\n\n\t\t\tif ( vertexBufferLayout === undefined ) {\n\n\t\t\t\tlet arrayStride, stepMode;\n\n\t\t\t\tif ( geometryAttribute.isInterleavedBufferAttribute === true ) {\n\n\t\t\t\t\tarrayStride = geometryAttribute.data.stride * bytesPerElement;\n\t\t\t\t\tstepMode = geometryAttribute.data.isInstancedInterleavedBuffer ? GPUInputStepMode.Instance : GPUInputStepMode.Vertex;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarrayStride = geometryAttribute.itemSize * bytesPerElement;\n\t\t\t\t\tstepMode = geometryAttribute.isInstancedBufferAttribute ? GPUInputStepMode.Instance : GPUInputStepMode.Vertex;\n\n\t\t\t\t}\n\n\t\t\t\t// patch for INT16 and UINT16\n\t\t\t\tif ( geometryAttribute.normalized === false && ( geometryAttribute.array.constructor === Int16Array || geometryAttribute.array.constructor === Uint16Array ) ) {\n\n\t\t\t\t\tarrayStride = 4;\n\n\t\t\t\t}\n\n\t\t\t\tvertexBufferLayout = {\n\t\t\t\t\tarrayStride,\n\t\t\t\t\tattributes: [],\n\t\t\t\t\tstepMode\n\t\t\t\t};\n\n\t\t\t\tvertexBuffers.set( bufferAttribute, vertexBufferLayout );\n\n\t\t\t}\n\n\t\t\tconst format = this._getVertexFormat( geometryAttribute );\n\t\t\tconst offset = ( geometryAttribute.isInterleavedBufferAttribute === true ) ? geometryAttribute.offset * bytesPerElement : 0;\n\n\t\t\tvertexBufferLayout.attributes.push( {\n\t\t\t\tshaderLocation: slot,\n\t\t\t\toffset,\n\t\t\t\tformat\n\t\t\t} );\n\n\t\t}\n\n\t\treturn Array.from( vertexBuffers.values() );\n\n\t}\n\n\tdestroyAttribute( attribute ) {\n\n\t\tconst backend = this.backend;\n\t\tconst data = backend.get( this._getBufferAttribute( attribute ) );\n\n\t\tdata.buffer.destroy();\n\n\t\tbackend.delete( attribute );\n\n\t}\n\n\tasync getArrayBufferAsync( attribute ) {\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\n\t\tconst data = backend.get( this._getBufferAttribute( attribute ) );\n\n\t\tconst bufferGPU = data.buffer;\n\t\tconst size = bufferGPU.size;\n\n\t\tconst readBufferGPU = device.createBuffer( {\n\t\t\tlabel: attribute.name,\n\t\t\tsize,\n\t\t\tusage: GPUBufferUsage.COPY_DST | GPUBufferUsage.MAP_READ\n\t\t} );\n\n\n\t\tconst cmdEncoder = device.createCommandEncoder( {} );\n\n\t\tcmdEncoder.copyBufferToBuffer(\n\t\t\tbufferGPU,\n\t\t\t0,\n\t\t\treadBufferGPU,\n\t\t\t0,\n\t\t\tsize\n\t\t);\n\n\t\treadBufferGPU.unmap();\n\n\t\tconst gpuCommands = cmdEncoder.finish();\n\t\tdevice.queue.submit( [ gpuCommands ] );\n\n\t\tawait readBufferGPU.mapAsync( GPUMapMode.READ );\n\n\t\tconst arrayBuffer = readBufferGPU.getMappedRange();\n\n\t\treturn arrayBuffer;\n\n\t}\n\n\t_getVertexFormat( geometryAttribute ) {\n\n\t\tconst { itemSize, normalized } = geometryAttribute;\n\t\tconst ArrayType = geometryAttribute.array.constructor;\n\t\tconst AttributeType = geometryAttribute.constructor;\n\n\t\tlet format;\n\n\t\tif ( itemSize == 1 ) {\n\n\t\t\tformat = typeArraysToVertexFormatPrefixForItemSize1.get( ArrayType );\n\n\t\t} else {\n\n\t\t\tconst prefixOptions = typedAttributeToVertexFormatPrefix.get( AttributeType ) || typedArraysToVertexFormatPrefix.get( ArrayType );\n\t\t\tconst prefix = prefixOptions[ normalized ? 1 : 0 ];\n\n\t\t\tif ( prefix ) {\n\n\t\t\t\tconst bytesPerUnit = ArrayType.BYTES_PER_ELEMENT * itemSize;\n\t\t\t\tconst paddedBytesPerUnit = Math.floor( ( bytesPerUnit + 3 ) / 4 ) * 4;\n\t\t\t\tconst paddedItemSize = paddedBytesPerUnit / ArrayType.BYTES_PER_ELEMENT;\n\n\t\t\t\tif ( paddedItemSize % 1 ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.WebGPUAttributeUtils: Bad vertex format item size.' );\n\n\t\t\t\t}\n\n\t\t\t\tformat = `${prefix}x${paddedItemSize}`;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( ! format ) {\n\n\t\t\tconsole.error( 'THREE.WebGPUAttributeUtils: Vertex format not supported yet.' );\n\n\t\t}\n\n\t\treturn format;\n\n\t}\n\n\t_isTypedArray( array ) {\n\n\t\treturn ArrayBuffer.isView( array ) && ! ( array instanceof DataView );\n\n\t}\n\n\t_getBufferAttribute( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\treturn attribute;\n\n\t}\n\n}\n\nclass WebGPUBindingUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\t\tthis.bindGroupLayoutCache = new WeakMap();\n\n\t}\n\n\tcreateBindingsLayout( bindGroup ) {\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\n\t\tconst entries = [];\n\n\t\tlet index = 0;\n\n\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\tconst bindingGPU = {\n\t\t\t\tbinding: index ++,\n\t\t\t\tvisibility: binding.visibility\n\t\t\t};\n\n\t\t\tif ( binding.isUniformBuffer || binding.isStorageBuffer ) {\n\n\t\t\t\tconst buffer = {}; // GPUBufferBindingLayout\n\n\t\t\t\tif ( binding.isStorageBuffer ) {\n\n\t\t\t\t\tif ( binding.visibility & 4 ) {\n\n\t\t\t\t\t\t// compute\n\n\t\t\t\t\t\tif ( binding.access === NodeAccess.READ_WRITE || binding.access === NodeAccess.WRITE_ONLY ) {\n\n\t\t\t\t\t\t\tbuffer.type = GPUBufferBindingType.Storage;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tbuffer.type = GPUBufferBindingType.ReadOnlyStorage;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tbuffer.type = GPUBufferBindingType.ReadOnlyStorage;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tbindingGPU.buffer = buffer;\n\n\t\t\t} else if ( binding.isSampler ) {\n\n\t\t\t\tconst sampler = {}; // GPUSamplerBindingLayout\n\n\t\t\t\tif ( binding.texture.isDepthTexture ) {\n\n\t\t\t\t\tif ( binding.texture.compareFunction !== null ) {\n\n\t\t\t\t\t\tsampler.type = 'comparison';\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tbindingGPU.sampler = sampler;\n\n\t\t\t} else if ( binding.isSampledTexture && binding.texture.isVideoTexture ) {\n\n\t\t\t\tbindingGPU.externalTexture = {}; // GPUExternalTextureBindingLayout\n\n\t\t\t} else if ( binding.isSampledTexture && binding.store ) {\n\n\t\t\t\tconst storageTexture = {}; // GPUStorageTextureBindingLayout\n\t\t\t\tstorageTexture.format = this.backend.get( binding.texture ).texture.format;\n\n\t\t\t\tconst access = binding.access;\n\n\t\t\t\tif ( access === NodeAccess.READ_WRITE ) {\n\n\t\t\t\t\tstorageTexture.access = GPUStorageTextureAccess.ReadWrite;\n\n\t\t\t\t} else if ( access === NodeAccess.WRITE_ONLY ) {\n\n\t\t\t\t\tstorageTexture.access = GPUStorageTextureAccess.WriteOnly;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tstorageTexture.access = GPUStorageTextureAccess.ReadOnly;\n\n\t\t\t\t}\n\n\t\t\t\tbindingGPU.storageTexture = storageTexture;\n\n\t\t\t} else if ( binding.isSampledTexture ) {\n\n\t\t\t\tconst texture = {}; // GPUTextureBindingLayout\n\n\t\t\t\tif ( binding.texture.isMultisampleRenderTargetTexture === true ) {\n\n\t\t\t\t\ttexture.multisampled = true;\n\n\t\t\t\t}\n\n\t\t\t\tif ( binding.texture.isDepthTexture ) {\n\n\t\t\t\t\ttexture.sampleType = GPUTextureSampleType.Depth;\n\n\t\t\t\t} else if ( binding.texture.isDataTexture || binding.texture.isDataArrayTexture || binding.texture.isData3DTexture ) {\n\n\t\t\t\t\tconst type = binding.texture.type;\n\n\t\t\t\t\tif ( type === IntType ) {\n\n\t\t\t\t\t\ttexture.sampleType = GPUTextureSampleType.SInt;\n\n\t\t\t\t\t} else if ( type === UnsignedIntType ) {\n\n\t\t\t\t\t\ttexture.sampleType = GPUTextureSampleType.UInt;\n\n\t\t\t\t\t} else if ( type === FloatType ) {\n\n\t\t\t\t\t\tif ( this.backend.hasFeature( 'float32-filterable' ) ) {\n\n\t\t\t\t\t\t\ttexture.sampleType = GPUTextureSampleType.Float;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\ttexture.sampleType = GPUTextureSampleType.UnfilterableFloat;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( binding.isSampledCubeTexture ) {\n\n\t\t\t\t\ttexture.viewDimension = GPUTextureViewDimension.Cube;\n\n\t\t\t\t} else if ( binding.texture.isDataArrayTexture || binding.texture.isCompressedArrayTexture ) {\n\n\t\t\t\t\ttexture.viewDimension = GPUTextureViewDimension.TwoDArray;\n\n\t\t\t\t} else if ( binding.isSampledTexture3D ) {\n\n\t\t\t\t\ttexture.viewDimension = GPUTextureViewDimension.ThreeD;\n\n\t\t\t\t}\n\n\t\t\t\tbindingGPU.texture = texture;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( `WebGPUBindingUtils: Unsupported binding \"${ binding }\".` );\n\n\t\t\t}\n\n\t\t\tentries.push( bindingGPU );\n\n\t\t}\n\n\t\treturn device.createBindGroupLayout( { entries } );\n\n\t}\n\n\tcreateBindings( bindGroup, bindings, cacheIndex, version = 0 ) {\n\n\t\tconst { backend, bindGroupLayoutCache } = this;\n\t\tconst bindingsData = backend.get( bindGroup );\n\n\t\t// setup (static) binding layout and (dynamic) binding group\n\n\t\tlet bindLayoutGPU = bindGroupLayoutCache.get( bindGroup.bindingsReference );\n\n\t\tif ( bindLayoutGPU === undefined ) {\n\n\t\t\tbindLayoutGPU = this.createBindingsLayout( bindGroup );\n\t\t\tbindGroupLayoutCache.set( bindGroup.bindingsReference, bindLayoutGPU );\n\n\t\t}\n\n\t\tlet bindGroupGPU;\n\n\t\tif ( cacheIndex > 0 ) {\n\n\t\t\tif ( bindingsData.groups === undefined ) {\n\n\t\t\t\tbindingsData.groups = [];\n\t\t\t\tbindingsData.versions = [];\n\n\t\t\t}\n\n\t\t\tif ( bindingsData.versions[ cacheIndex ] === version ) {\n\n\t\t\t\tbindGroupGPU = bindingsData.groups[ cacheIndex ];\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( bindGroupGPU === undefined ) {\n\n\t\t\tbindGroupGPU = this.createBindGroup( bindGroup, bindLayoutGPU );\n\n\t\t\tif ( cacheIndex > 0 ) {\n\n\t\t\t\tbindingsData.groups[ cacheIndex ] = bindGroupGPU;\n\t\t\t\tbindingsData.versions[ cacheIndex ] = version;\n\n\t\t\t}\n\n\t\t}\n\n\t\tbindingsData.group = bindGroupGPU;\n\t\tbindingsData.layout = bindLayoutGPU;\n\n\t}\n\n\tupdateBinding( binding ) {\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\n\t\tconst buffer = binding.buffer;\n\t\tconst bufferGPU = backend.get( binding ).buffer;\n\n\t\tdevice.queue.writeBuffer( bufferGPU, 0, buffer, 0 );\n\n\t}\n\n\tcreateBindGroup( bindGroup, layoutGPU ) {\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\n\t\tlet bindingPoint = 0;\n\t\tconst entriesGPU = [];\n\n\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\tif ( binding.isUniformBuffer ) {\n\n\t\t\t\tconst bindingData = backend.get( binding );\n\n\t\t\t\tif ( bindingData.buffer === undefined ) {\n\n\t\t\t\t\tconst byteLength = binding.byteLength;\n\n\t\t\t\t\tconst usage = GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST;\n\n\t\t\t\t\tconst bufferGPU = device.createBuffer( {\n\t\t\t\t\t\tlabel: 'bindingBuffer_' + binding.name,\n\t\t\t\t\t\tsize: byteLength,\n\t\t\t\t\t\tusage: usage\n\t\t\t\t\t} );\n\n\t\t\t\t\tbindingData.buffer = bufferGPU;\n\n\t\t\t\t}\n\n\t\t\t\tentriesGPU.push( { binding: bindingPoint, resource: { buffer: bindingData.buffer } } );\n\n\t\t\t} else if ( binding.isStorageBuffer ) {\n\n\t\t\t\tconst bindingData = backend.get( binding );\n\n\t\t\t\tif ( bindingData.buffer === undefined ) {\n\n\t\t\t\t\tconst attribute = binding.attribute;\n\t\t\t\t\t//const usage = GPUBufferUsage.STORAGE | GPUBufferUsage.VERTEX | /*GPUBufferUsage.COPY_SRC |*/ GPUBufferUsage.COPY_DST;\n\n\t\t\t\t\t//backend.attributeUtils.createAttribute( attribute, usage ); // @TODO: Move it to universal renderer\n\n\t\t\t\t\tbindingData.buffer = backend.get( attribute ).buffer;\n\n\t\t\t\t}\n\n\t\t\t\tentriesGPU.push( { binding: bindingPoint, resource: { buffer: bindingData.buffer } } );\n\n\t\t\t} else if ( binding.isSampler ) {\n\n\t\t\t\tconst textureGPU = backend.get( binding.texture );\n\n\t\t\t\tentriesGPU.push( { binding: bindingPoint, resource: textureGPU.sampler } );\n\n\t\t\t} else if ( binding.isSampledTexture ) {\n\n\t\t\t\tconst textureData = backend.get( binding.texture );\n\n\t\t\t\tlet resourceGPU;\n\n\t\t\t\tif ( textureData.externalTexture !== undefined ) {\n\n\t\t\t\t\tresourceGPU = device.importExternalTexture( { source: textureData.externalTexture } );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst mipLevelCount = binding.store ? 1 : textureData.texture.mipLevelCount;\n\t\t\t\t\tconst propertyName = `view-${ textureData.texture.width }-${ textureData.texture.height }-${ mipLevelCount }`;\n\n\t\t\t\t\tresourceGPU = textureData[ propertyName ];\n\n\t\t\t\t\tif ( resourceGPU === undefined ) {\n\n\t\t\t\t\t\tconst aspectGPU = GPUTextureAspect.All;\n\n\t\t\t\t\t\tlet dimensionViewGPU;\n\n\t\t\t\t\t\tif ( binding.isSampledCubeTexture ) {\n\n\t\t\t\t\t\t\tdimensionViewGPU = GPUTextureViewDimension.Cube;\n\n\t\t\t\t\t\t} else if ( binding.isSampledTexture3D ) {\n\n\t\t\t\t\t\t\tdimensionViewGPU = GPUTextureViewDimension.ThreeD;\n\n\t\t\t\t\t\t} else if ( binding.texture.isDataArrayTexture || binding.texture.isCompressedArrayTexture ) {\n\n\t\t\t\t\t\t\tdimensionViewGPU = GPUTextureViewDimension.TwoDArray;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tdimensionViewGPU = GPUTextureViewDimension.TwoD;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresourceGPU = textureData[ propertyName ] = textureData.texture.createView( { aspect: aspectGPU, dimension: dimensionViewGPU, mipLevelCount } );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tentriesGPU.push( { binding: bindingPoint, resource: resourceGPU } );\n\n\t\t\t}\n\n\t\t\tbindingPoint ++;\n\n\t\t}\n\n\t\treturn device.createBindGroup( {\n\t\t\tlabel: 'bindGroup_' + bindGroup.name,\n\t\t\tlayout: layoutGPU,\n\t\t\tentries: entriesGPU\n\t\t} );\n\n\t}\n\n}\n\nclass WebGPUPipelineUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t}\n\n\t_getSampleCount( renderObjectContext ) {\n\n\t\treturn this.backend.utils.getSampleCountRenderContext( renderObjectContext );\n\n\t}\n\n\tcreateRenderPipeline( renderObject, promises ) {\n\n\t\tconst { object, material, geometry, pipeline } = renderObject;\n\t\tconst { vertexProgram, fragmentProgram } = pipeline;\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\t\tconst utils = backend.utils;\n\n\t\tconst pipelineData = backend.get( pipeline );\n\n\t\t// bind group layouts\n\n\t\tconst bindGroupLayouts = [];\n\n\t\tfor ( const bindGroup of renderObject.getBindings() ) {\n\n\t\t\tconst bindingsData = backend.get( bindGroup );\n\n\t\t\tbindGroupLayouts.push( bindingsData.layout );\n\n\t\t}\n\n\t\t// vertex buffers\n\n\t\tconst vertexBuffers = backend.attributeUtils.createShaderVertexBuffers( renderObject );\n\n\t\t// blending\n\n\t\tlet blending;\n\n\t\tif ( material.transparent === true && material.blending !== NoBlending ) {\n\n\t\t\tblending = this._getBlending( material );\n\n\t\t}\n\n\t\t// stencil\n\n\t\tlet stencilFront = {};\n\n\t\tif ( material.stencilWrite === true ) {\n\n\t\t\tstencilFront = {\n\t\t\t\tcompare: this._getStencilCompare( material ),\n\t\t\t\tfailOp: this._getStencilOperation( material.stencilFail ),\n\t\t\t\tdepthFailOp: this._getStencilOperation( material.stencilZFail ),\n\t\t\t\tpassOp: this._getStencilOperation( material.stencilZPass )\n\t\t\t};\n\n\t\t}\n\n\t\tconst colorWriteMask = this._getColorWriteMask( material );\n\n\t\tconst targets = [];\n\n\t\tif ( renderObject.context.textures !== null ) {\n\n\t\t\tconst textures = renderObject.context.textures;\n\n\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\tconst colorFormat = utils.getTextureFormatGPU( textures[ i ] );\n\n\t\t\t\ttargets.push( {\n\t\t\t\t\tformat: colorFormat,\n\t\t\t\t\tblend: blending,\n\t\t\t\t\twriteMask: colorWriteMask\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst colorFormat = utils.getCurrentColorFormat( renderObject.context );\n\n\t\t\ttargets.push( {\n\t\t\t\tformat: colorFormat,\n\t\t\t\tblend: blending,\n\t\t\t\twriteMask: colorWriteMask\n\t\t\t} );\n\n\t\t}\n\n\t\tconst vertexModule = backend.get( vertexProgram ).module;\n\t\tconst fragmentModule = backend.get( fragmentProgram ).module;\n\n\t\tconst primitiveState = this._getPrimitiveState( object, geometry, material );\n\t\tconst depthCompare = this._getDepthCompare( material );\n\t\tconst depthStencilFormat = utils.getCurrentDepthStencilFormat( renderObject.context );\n\n\t\tconst sampleCount = this._getSampleCount( renderObject.context );\n\n\t\tconst pipelineDescriptor = {\n\t\t\tlabel: `renderPipeline_${ material.name || material.type }_${ material.id }`,\n\t\t\tvertex: Object.assign( {}, vertexModule, { buffers: vertexBuffers } ),\n\t\t\tfragment: Object.assign( {}, fragmentModule, { targets } ),\n\t\t\tprimitive: primitiveState,\n\t\t\tmultisample: {\n\t\t\t\tcount: sampleCount,\n\t\t\t\talphaToCoverageEnabled: material.alphaToCoverage && sampleCount > 1\n\t\t\t},\n\t\t\tlayout: device.createPipelineLayout( {\n\t\t\t\tbindGroupLayouts\n\t\t\t} )\n\t\t};\n\n\n\t\tconst depthStencil = {};\n\t\tconst renderDepth = renderObject.context.depth;\n\t\tconst renderStencil = renderObject.context.stencil;\n\n\t\tif ( renderDepth === true || renderStencil === true ) {\n\n\t\t\tif ( renderDepth === true ) {\n\n\t\t\t\tdepthStencil.format = depthStencilFormat;\n\t\t\t\tdepthStencil.depthWriteEnabled = material.depthWrite;\n\t\t\t\tdepthStencil.depthCompare = depthCompare;\n\n\t\t\t}\n\n\t\t\tif ( renderStencil === true ) {\n\n\t\t\t\tdepthStencil.stencilFront = stencilFront;\n\t\t\t\tdepthStencil.stencilBack = {}; // three.js does not provide an API to configure the back function (gl.stencilFuncSeparate() was never used)\n\t\t\t\tdepthStencil.stencilReadMask = material.stencilFuncMask;\n\t\t\t\tdepthStencil.stencilWriteMask = material.stencilWriteMask;\n\n\t\t\t}\n\n\t\t\tpipelineDescriptor.depthStencil = depthStencil;\n\n\t\t}\n\n\n\t\tif ( promises === null ) {\n\n\t\t\tpipelineData.pipeline = device.createRenderPipeline( pipelineDescriptor );\n\n\t\t} else {\n\n\t\t\tconst p = new Promise( ( resolve /*, reject*/ ) => {\n\n\t\t\t\tdevice.createRenderPipelineAsync( pipelineDescriptor ).then( pipeline => {\n\n\t\t\t\t\tpipelineData.pipeline = pipeline;\n\t\t\t\t\tresolve();\n\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t\tpromises.push( p );\n\n\t\t}\n\n\t}\n\n\tcreateBundleEncoder( renderContext ) {\n\n\t\tconst backend = this.backend;\n\t\tconst { utils, device } = backend;\n\n\t\tconst depthStencilFormat = utils.getCurrentDepthStencilFormat( renderContext );\n\t\tconst colorFormat = utils.getCurrentColorFormat( renderContext );\n\t\tconst sampleCount = this._getSampleCount( renderContext );\n\n\t\tconst descriptor = {\n\t\t\tlabel: 'renderBundleEncoder',\n\t\t\tcolorFormats: [ colorFormat ],\n\t\t\tdepthStencilFormat,\n\t\t\tsampleCount\n\t\t};\n\n\t\treturn device.createRenderBundleEncoder( descriptor );\n\n\t}\n\n\tcreateComputePipeline( pipeline, bindings ) {\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\n\t\tconst computeProgram = backend.get( pipeline.computeProgram ).module;\n\n\t\tconst pipelineGPU = backend.get( pipeline );\n\n\t\t// bind group layouts\n\n\t\tconst bindGroupLayouts = [];\n\n\t\tfor ( const bindingsGroup of bindings ) {\n\n\t\t\tconst bindingsData = backend.get( bindingsGroup );\n\n\t\t\tbindGroupLayouts.push( bindingsData.layout );\n\n\t\t}\n\n\t\tpipelineGPU.pipeline = device.createComputePipeline( {\n\t\t\tcompute: computeProgram,\n\t\t\tlayout: device.createPipelineLayout( {\n\t\t\t\tbindGroupLayouts\n\t\t\t} )\n\t\t} );\n\n\t}\n\n\t_getBlending( material ) {\n\n\t\tlet color, alpha;\n\n\t\tconst blending = material.blending;\n\t\tconst blendSrc = material.blendSrc;\n\t\tconst blendDst = material.blendDst;\n\t\tconst blendEquation = material.blendEquation;\n\n\n\t\tif ( blending === CustomBlending ) {\n\n\t\t\tconst blendSrcAlpha = material.blendSrcAlpha !== null ? material.blendSrcAlpha : blendSrc;\n\t\t\tconst blendDstAlpha = material.blendDstAlpha !== null ? material.blendDstAlpha : blendDst;\n\t\t\tconst blendEquationAlpha = material.blendEquationAlpha !== null ? material.blendEquationAlpha : blendEquation;\n\n\t\t\tcolor = {\n\t\t\t\tsrcFactor: this._getBlendFactor( blendSrc ),\n\t\t\t\tdstFactor: this._getBlendFactor( blendDst ),\n\t\t\t\toperation: this._getBlendOperation( blendEquation )\n\t\t\t};\n\n\t\t\talpha = {\n\t\t\t\tsrcFactor: this._getBlendFactor( blendSrcAlpha ),\n\t\t\t\tdstFactor: this._getBlendFactor( blendDstAlpha ),\n\t\t\t\toperation: this._getBlendOperation( blendEquationAlpha )\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tconst premultipliedAlpha = material.premultipliedAlpha;\n\n\t\t\tconst setBlend = ( srcRGB, dstRGB, srcAlpha, dstAlpha ) => {\n\n\t\t\t\tcolor = {\n\t\t\t\t\tsrcFactor: srcRGB,\n\t\t\t\t\tdstFactor: dstRGB,\n\t\t\t\t\toperation: GPUBlendOperation.Add\n\t\t\t\t};\n\n\t\t\t\talpha = {\n\t\t\t\t\tsrcFactor: srcAlpha,\n\t\t\t\t\tdstFactor: dstAlpha,\n\t\t\t\t\toperation: GPUBlendOperation.Add\n\t\t\t\t};\n\n\t\t\t};\n\n\t\t\tif ( premultipliedAlpha ) {\n\n\t\t\t\tswitch ( blending ) {\n\n\t\t\t\t\tcase NormalBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.One, GPUBlendFactor.OneMinusSrcAlpha, GPUBlendFactor.One, GPUBlendFactor.OneMinusSrcAlpha );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase AdditiveBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.One, GPUBlendFactor.One, GPUBlendFactor.One, GPUBlendFactor.One );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase SubtractiveBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.Zero, GPUBlendFactor.OneMinusSrc, GPUBlendFactor.Zero, GPUBlendFactor.One );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase MultiplyBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.Zero, GPUBlendFactor.Src, GPUBlendFactor.Zero, GPUBlendFactor.SrcAlpha );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tswitch ( blending ) {\n\n\t\t\t\t\tcase NormalBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.SrcAlpha, GPUBlendFactor.OneMinusSrcAlpha, GPUBlendFactor.One, GPUBlendFactor.OneMinusSrcAlpha );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase AdditiveBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.SrcAlpha, GPUBlendFactor.One, GPUBlendFactor.SrcAlpha, GPUBlendFactor.One );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase SubtractiveBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.Zero, GPUBlendFactor.OneMinusSrc, GPUBlendFactor.Zero, GPUBlendFactor.One );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase MultiplyBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.Zero, GPUBlendFactor.Src, GPUBlendFactor.Zero, GPUBlendFactor.Src );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( color !== undefined && alpha !== undefined ) {\n\n\t\t\treturn { color, alpha };\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.WebGPURenderer: Invalid blending: ', blending );\n\n\t\t}\n\n\t}\n\n\t_getBlendFactor( blend ) {\n\n\t\tlet blendFactor;\n\n\t\tswitch ( blend ) {\n\n\t\t\tcase ZeroFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.Zero;\n\t\t\t\tbreak;\n\n\t\t\tcase OneFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.One;\n\t\t\t\tbreak;\n\n\t\t\tcase SrcColorFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.Src;\n\t\t\t\tbreak;\n\n\t\t\tcase OneMinusSrcColorFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.OneMinusSrc;\n\t\t\t\tbreak;\n\n\t\t\tcase SrcAlphaFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.SrcAlpha;\n\t\t\t\tbreak;\n\n\t\t\tcase OneMinusSrcAlphaFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.OneMinusSrcAlpha;\n\t\t\t\tbreak;\n\n\t\t\tcase DstColorFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.Dst;\n\t\t\t\tbreak;\n\n\t\t\tcase OneMinusDstColorFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.OneMinusDstColor;\n\t\t\t\tbreak;\n\n\t\t\tcase DstAlphaFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.DstAlpha;\n\t\t\t\tbreak;\n\n\t\t\tcase OneMinusDstAlphaFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.OneMinusDstAlpha;\n\t\t\t\tbreak;\n\n\t\t\tcase SrcAlphaSaturateFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.SrcAlphaSaturated;\n\t\t\t\tbreak;\n\n\t\t\tcase BlendColorFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.Constant;\n\t\t\t\tbreak;\n\n\t\t\tcase OneMinusBlendColorFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.OneMinusConstant;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'THREE.WebGPURenderer: Blend factor not supported.', blend );\n\n\t\t}\n\n\t\treturn blendFactor;\n\n\t}\n\n\t_getStencilCompare( material ) {\n\n\t\tlet stencilCompare;\n\n\t\tconst stencilFunc = material.stencilFunc;\n\n\t\tswitch ( stencilFunc ) {\n\n\t\t\tcase NeverStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.Never;\n\t\t\t\tbreak;\n\n\t\t\tcase AlwaysStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.Always;\n\t\t\t\tbreak;\n\n\t\t\tcase LessStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.Less;\n\t\t\t\tbreak;\n\n\t\t\tcase LessEqualStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.LessEqual;\n\t\t\t\tbreak;\n\n\t\t\tcase EqualStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.Equal;\n\t\t\t\tbreak;\n\n\t\t\tcase GreaterEqualStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.GreaterEqual;\n\t\t\t\tbreak;\n\n\t\t\tcase GreaterStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.Greater;\n\t\t\t\tbreak;\n\n\t\t\tcase NotEqualStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.NotEqual;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'THREE.WebGPURenderer: Invalid stencil function.', stencilFunc );\n\n\t\t}\n\n\t\treturn stencilCompare;\n\n\t}\n\n\t_getStencilOperation( op ) {\n\n\t\tlet stencilOperation;\n\n\t\tswitch ( op ) {\n\n\t\t\tcase KeepStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.Keep;\n\t\t\t\tbreak;\n\n\t\t\tcase ZeroStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.Zero;\n\t\t\t\tbreak;\n\n\t\t\tcase ReplaceStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.Replace;\n\t\t\t\tbreak;\n\n\t\t\tcase InvertStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.Invert;\n\t\t\t\tbreak;\n\n\t\t\tcase IncrementStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.IncrementClamp;\n\t\t\t\tbreak;\n\n\t\t\tcase DecrementStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.DecrementClamp;\n\t\t\t\tbreak;\n\n\t\t\tcase IncrementWrapStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.IncrementWrap;\n\t\t\t\tbreak;\n\n\t\t\tcase DecrementWrapStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.DecrementWrap;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'THREE.WebGPURenderer: Invalid stencil operation.', stencilOperation );\n\n\t\t}\n\n\t\treturn stencilOperation;\n\n\t}\n\n\t_getBlendOperation( blendEquation ) {\n\n\t\tlet blendOperation;\n\n\t\tswitch ( blendEquation ) {\n\n\t\t\tcase AddEquation:\n\t\t\t\tblendOperation = GPUBlendOperation.Add;\n\t\t\t\tbreak;\n\n\t\t\tcase SubtractEquation:\n\t\t\t\tblendOperation = GPUBlendOperation.Subtract;\n\t\t\t\tbreak;\n\n\t\t\tcase ReverseSubtractEquation:\n\t\t\t\tblendOperation = GPUBlendOperation.ReverseSubtract;\n\t\t\t\tbreak;\n\n\t\t\tcase MinEquation:\n\t\t\t\tblendOperation = GPUBlendOperation.Min;\n\t\t\t\tbreak;\n\n\t\t\tcase MaxEquation:\n\t\t\t\tblendOperation = GPUBlendOperation.Max;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'THREE.WebGPUPipelineUtils: Blend equation not supported.', blendEquation );\n\n\t\t}\n\n\t\treturn blendOperation;\n\n\t}\n\n\t_getPrimitiveState( object, geometry, material ) {\n\n\t\tconst descriptor = {};\n\t\tconst utils = this.backend.utils;\n\n\t\tdescriptor.topology = utils.getPrimitiveTopology( object, material );\n\n\t\tif ( geometry.index !== null && object.isLine === true && object.isLineSegments !== true ) {\n\n\t\t\tdescriptor.stripIndexFormat = ( geometry.index.array instanceof Uint16Array ) ? GPUIndexFormat.Uint16 : GPUIndexFormat.Uint32;\n\n\t\t}\n\n\t\tswitch ( material.side ) {\n\n\t\t\tcase FrontSide:\n\t\t\t\tdescriptor.frontFace = GPUFrontFace.CCW;\n\t\t\t\tdescriptor.cullMode = GPUCullMode.Back;\n\t\t\t\tbreak;\n\n\t\t\tcase BackSide:\n\t\t\t\tdescriptor.frontFace = GPUFrontFace.CCW;\n\t\t\t\tdescriptor.cullMode = GPUCullMode.Front;\n\t\t\t\tbreak;\n\n\t\t\tcase DoubleSide:\n\t\t\t\tdescriptor.frontFace = GPUFrontFace.CCW;\n\t\t\t\tdescriptor.cullMode = GPUCullMode.None;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'THREE.WebGPUPipelineUtils: Unknown material.side value.', material.side );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\treturn descriptor;\n\n\t}\n\n\t_getColorWriteMask( material ) {\n\n\t\treturn ( material.colorWrite === true ) ? GPUColorWriteFlags.All : GPUColorWriteFlags.None;\n\n\t}\n\n\t_getDepthCompare( material ) {\n\n\t\tlet depthCompare;\n\n\t\tif ( material.depthTest === false ) {\n\n\t\t\tdepthCompare = GPUCompareFunction.Always;\n\n\t\t} else {\n\n\t\t\tconst depthFunc = material.depthFunc;\n\n\t\t\tswitch ( depthFunc ) {\n\n\t\t\t\tcase NeverDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.Never;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AlwaysDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.Always;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase LessDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.Less;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase LessEqualDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.LessEqual;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase EqualDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.Equal;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase GreaterEqualDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.GreaterEqual;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase GreaterDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.Greater;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase NotEqualDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.NotEqual;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.error( 'THREE.WebGPUPipelineUtils: Invalid depth function.', depthFunc );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn depthCompare;\n\n\t}\n\n}\n\n/*// debugger tools\nimport 'https://greggman.github.io/webgpu-avoid-redundant-state-setting/webgpu-check-redundant-state-setting.js';\n//*/\n\n\n//\n\nclass WebGPUBackend extends Backend {\n\n\tconstructor( parameters = {} ) {\n\n\t\tsuper( parameters );\n\n\t\tthis.isWebGPUBackend = true;\n\n\t\t// some parameters require default values other than \"undefined\"\n\t\tthis.parameters.alpha = ( parameters.alpha === undefined ) ? true : parameters.alpha;\n\n\t\tthis.parameters.requiredLimits = ( parameters.requiredLimits === undefined ) ? {} : parameters.requiredLimits;\n\n\t\tthis.trackTimestamp = ( parameters.trackTimestamp === true );\n\n\t\tthis.device = null;\n\t\tthis.context = null;\n\t\tthis.colorBuffer = null;\n\t\tthis.defaultRenderPassdescriptor = null;\n\n\t\tthis.utils = new WebGPUUtils( this );\n\t\tthis.attributeUtils = new WebGPUAttributeUtils( this );\n\t\tthis.bindingUtils = new WebGPUBindingUtils( this );\n\t\tthis.pipelineUtils = new WebGPUPipelineUtils( this );\n\t\tthis.textureUtils = new WebGPUTextureUtils( this );\n\t\tthis.occludedResolveCache = new Map();\n\n\t}\n\n\tasync init( renderer ) {\n\n\t\tawait super.init( renderer );\n\n\t\t//\n\n\t\tconst parameters = this.parameters;\n\n\t\t// create the device if it is not passed with parameters\n\n\t\tlet device;\n\n\t\tif ( parameters.device === undefined ) {\n\n\t\t\tconst adapterOptions = {\n\t\t\t\tpowerPreference: parameters.powerPreference\n\t\t\t};\n\n\t\t\tconst adapter = ( typeof navigator !== 'undefined' ) ? await navigator.gpu.requestAdapter( adapterOptions ) : null;\n\n\t\t\tif ( adapter === null ) {\n\n\t\t\t\tthrow new Error( 'WebGPUBackend: Unable to create WebGPU adapter.' );\n\n\t\t\t}\n\n\t\t\t// feature support\n\n\t\t\tconst features = Object.values( GPUFeatureName );\n\n\t\t\tconst supportedFeatures = [];\n\n\t\t\tfor ( const name of features ) {\n\n\t\t\t\tif ( adapter.features.has( name ) ) {\n\n\t\t\t\t\tsupportedFeatures.push( name );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst deviceDescriptor = {\n\t\t\t\trequiredFeatures: supportedFeatures,\n\t\t\t\trequiredLimits: parameters.requiredLimits\n\t\t\t};\n\n\t\t\tdevice = await adapter.requestDevice( deviceDescriptor );\n\n\t\t} else {\n\n\t\t\tdevice = parameters.device;\n\n\t\t}\n\n\t\tdevice.lost.then( ( info ) => {\n\n\t\t\tconst deviceLossInfo = {\n\t\t\t\tapi: 'WebGPU',\n\t\t\t\tmessage: info.message || 'Unknown reason',\n\t\t\t\treason: info.reason || null,\n\t\t\t\toriginalEvent: info\n\t\t\t};\n\n\t\t\trenderer.onDeviceLost( deviceLossInfo );\n\n\t\t} );\n\n\t\tconst context = ( parameters.context !== undefined ) ? parameters.context : renderer.domElement.getContext( 'webgpu' );\n\n\t\tthis.device = device;\n\t\tthis.context = context;\n\n\t\tconst alphaMode = parameters.alpha ? 'premultiplied' : 'opaque';\n\n\t\tthis.trackTimestamp = this.trackTimestamp && this.hasFeature( GPUFeatureName.TimestampQuery );\n\n\t\tthis.context.configure( {\n\t\t\tdevice: this.device,\n\t\t\tformat: this.utils.getPreferredCanvasFormat(),\n\t\t\tusage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,\n\t\t\talphaMode: alphaMode\n\t\t} );\n\n\t\tthis.updateSize();\n\n\t}\n\n\tget coordinateSystem() {\n\n\t\treturn WebGPUCoordinateSystem;\n\n\t}\n\n\tasync getArrayBufferAsync( attribute ) {\n\n\t\treturn await this.attributeUtils.getArrayBufferAsync( attribute );\n\n\t}\n\n\tgetContext() {\n\n\t\treturn this.context;\n\n\t}\n\n\t_getDefaultRenderPassDescriptor() {\n\n\t\tlet descriptor = this.defaultRenderPassdescriptor;\n\n\t\tif ( descriptor === null ) {\n\n\t\t\tconst renderer = this.renderer;\n\n\t\t\tdescriptor = {\n\t\t\t\tcolorAttachments: [ {\n\t\t\t\t\tview: null\n\t\t\t\t} ],\n\t\t\t};\n\n\t\t\tif ( this.renderer.depth === true || this.renderer.stencil === true ) {\n\n\t\t\t\tdescriptor.depthStencilAttachment = {\n\t\t\t\t\tview: this.textureUtils.getDepthBuffer( renderer.depth, renderer.stencil ).createView()\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\tconst colorAttachment = descriptor.colorAttachments[ 0 ];\n\n\t\t\tif ( this.renderer.samples > 0 ) {\n\n\t\t\t\tcolorAttachment.view = this.colorBuffer.createView();\n\n\t\t\t} else {\n\n\t\t\t\tcolorAttachment.resolveTarget = undefined;\n\n\t\t\t}\n\n\t\t\tthis.defaultRenderPassdescriptor = descriptor;\n\n\t\t}\n\n\t\tconst colorAttachment = descriptor.colorAttachments[ 0 ];\n\n\t\tif ( this.renderer.samples > 0 ) {\n\n\t\t\tcolorAttachment.resolveTarget = this.context.getCurrentTexture().createView();\n\n\t\t} else {\n\n\t\t\tcolorAttachment.view = this.context.getCurrentTexture().createView();\n\n\t\t}\n\n\t\treturn descriptor;\n\n\t}\n\n\t_getRenderPassDescriptor( renderContext ) {\n\n\t\tconst renderTarget = renderContext.renderTarget;\n\t\tconst renderTargetData = this.get( renderTarget );\n\n\t\tlet descriptors = renderTargetData.descriptors;\n\n\t\tif ( descriptors === undefined ||\n\t\t\trenderTargetData.width !== renderTarget.width ||\n\t\t\trenderTargetData.height !== renderTarget.height ||\n\t\t\trenderTargetData.activeMipmapLevel !== renderTarget.activeMipmapLevel ||\n\t\t\trenderTargetData.samples !== renderTarget.samples\n\t\t) {\n\n\t\t\tdescriptors = {};\n\n\t\t\trenderTargetData.descriptors = descriptors;\n\n\t\t\t// dispose\n\n\t\t\tconst onDispose = () => {\n\n\t\t\t\trenderTarget.removeEventListener( 'dispose', onDispose );\n\n\t\t\t\tthis.delete( renderTarget );\n\n\t\t\t};\n\n\t\t\trenderTarget.addEventListener( 'dispose', onDispose );\n\n\t\t}\n\n\t\tconst cacheKey = renderContext.getCacheKey();\n\n\t\tlet descriptor = descriptors[ cacheKey ];\n\n\t\tif ( descriptor === undefined ) {\n\n\t\t\tconst textures = renderContext.textures;\n\t\t\tconst colorAttachments = [];\n\n\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\tconst textureData = this.get( textures[ i ] );\n\n\t\t\t\tconst textureView = textureData.texture.createView( {\n\t\t\t\t\tbaseMipLevel: renderContext.activeMipmapLevel,\n\t\t\t\t\tmipLevelCount: 1,\n\t\t\t\t\tbaseArrayLayer: renderContext.activeCubeFace,\n\t\t\t\t\tdimension: GPUTextureViewDimension.TwoD\n\t\t\t\t} );\n\n\t\t\t\tlet view, resolveTarget;\n\n\t\t\t\tif ( textureData.msaaTexture !== undefined ) {\n\n\t\t\t\t\tview = textureData.msaaTexture.createView();\n\t\t\t\t\tresolveTarget = textureView;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tview = textureView;\n\t\t\t\t\tresolveTarget = undefined;\n\n\t\t\t\t}\n\n\t\t\t\tcolorAttachments.push( {\n\t\t\t\t\tview,\n\t\t\t\t\tresolveTarget,\n\t\t\t\t\tloadOp: GPULoadOp.Load,\n\t\t\t\t\tstoreOp: GPUStoreOp.Store\n\t\t\t\t} );\n\n\t\t\t}\n\n\n\t\t\tdescriptor = {\n\t\t\t\tcolorAttachments,\n\t\t\t};\n\n\t\t\tif ( renderContext.depth ) {\n\n\t\t\t\tconst depthTextureData = this.get( renderContext.depthTexture );\n\n\t\t\t\tconst depthStencilAttachment = {\n\t\t\t\t\tview: depthTextureData.texture.createView()\n\t\t\t\t};\n\t\t\t\tdescriptor.depthStencilAttachment = depthStencilAttachment;\n\n\t\t\t}\n\n\t\t\tdescriptors[ cacheKey ] = descriptor;\n\n\t\t\trenderTargetData.width = renderTarget.width;\n\t\t\trenderTargetData.height = renderTarget.height;\n\t\t\trenderTargetData.samples = renderTarget.samples;\n\t\t\trenderTargetData.activeMipmapLevel = renderTarget.activeMipmapLevel;\n\n\t\t}\n\n\t\treturn descriptor;\n\n\t}\n\n\tbeginRender( renderContext ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tconst device = this.device;\n\t\tconst occlusionQueryCount = renderContext.occlusionQueryCount;\n\n\t\tlet occlusionQuerySet;\n\n\t\tif ( occlusionQueryCount > 0 ) {\n\n\t\t\tif ( renderContextData.currentOcclusionQuerySet ) renderContextData.currentOcclusionQuerySet.destroy();\n\t\t\tif ( renderContextData.currentOcclusionQueryBuffer ) renderContextData.currentOcclusionQueryBuffer.destroy();\n\n\t\t\t// Get a reference to the array of objects with queries. The renderContextData property\n\t\t\t// can be changed by another render pass before the buffer.mapAsyc() completes.\n\t\t\trenderContextData.currentOcclusionQuerySet = renderContextData.occlusionQuerySet;\n\t\t\trenderContextData.currentOcclusionQueryBuffer = renderContextData.occlusionQueryBuffer;\n\t\t\trenderContextData.currentOcclusionQueryObjects = renderContextData.occlusionQueryObjects;\n\n\t\t\t//\n\n\t\t\tocclusionQuerySet = device.createQuerySet( { type: 'occlusion', count: occlusionQueryCount, label: `occlusionQuerySet_${ renderContext.id }` } );\n\n\t\t\trenderContextData.occlusionQuerySet = occlusionQuerySet;\n\t\t\trenderContextData.occlusionQueryIndex = 0;\n\t\t\trenderContextData.occlusionQueryObjects = new Array( occlusionQueryCount );\n\n\t\t\trenderContextData.lastOcclusionObject = null;\n\n\t\t}\n\n\t\tlet descriptor;\n\n\t\tif ( renderContext.textures === null ) {\n\n\t\t\tdescriptor = this._getDefaultRenderPassDescriptor();\n\n\t\t} else {\n\n\t\t\tdescriptor = this._getRenderPassDescriptor( renderContext );\n\n\t\t}\n\n\t\tthis.initTimestampQuery( renderContext, descriptor );\n\n\t\tdescriptor.occlusionQuerySet = occlusionQuerySet;\n\n\t\tconst depthStencilAttachment = descriptor.depthStencilAttachment;\n\n\t\tif ( renderContext.textures !== null ) {\n\n\t\t\tconst colorAttachments = descriptor.colorAttachments;\n\n\t\t\tfor ( let i = 0; i < colorAttachments.length; i ++ ) {\n\n\t\t\t\tconst colorAttachment = colorAttachments[ i ];\n\n\t\t\t\tif ( renderContext.clearColor ) {\n\n\t\t\t\t\tcolorAttachment.clearValue = i === 0 ? renderContext.clearColorValue : { r: 0, g: 0, b: 0, a: 1 };\n\t\t\t\t\tcolorAttachment.loadOp = GPULoadOp.Clear;\n\t\t\t\t\tcolorAttachment.storeOp = GPUStoreOp.Store;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcolorAttachment.loadOp = GPULoadOp.Load;\n\t\t\t\t\tcolorAttachment.storeOp = GPUStoreOp.Store;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst colorAttachment = descriptor.colorAttachments[ 0 ];\n\n\t\t\tif ( renderContext.clearColor ) {\n\n\t\t\t\tcolorAttachment.clearValue = renderContext.clearColorValue;\n\t\t\t\tcolorAttachment.loadOp = GPULoadOp.Clear;\n\t\t\t\tcolorAttachment.storeOp = GPUStoreOp.Store;\n\n\t\t\t} else {\n\n\t\t\t\tcolorAttachment.loadOp = GPULoadOp.Load;\n\t\t\t\tcolorAttachment.storeOp = GPUStoreOp.Store;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( renderContext.depth ) {\n\n\t\t\tif ( renderContext.clearDepth ) {\n\n\t\t\t\tdepthStencilAttachment.depthClearValue = renderContext.clearDepthValue;\n\t\t\t\tdepthStencilAttachment.depthLoadOp = GPULoadOp.Clear;\n\t\t\t\tdepthStencilAttachment.depthStoreOp = GPUStoreOp.Store;\n\n\t\t\t} else {\n\n\t\t\t\tdepthStencilAttachment.depthLoadOp = GPULoadOp.Load;\n\t\t\t\tdepthStencilAttachment.depthStoreOp = GPUStoreOp.Store;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( renderContext.stencil ) {\n\n\t\t\tif ( renderContext.clearStencil ) {\n\n\t\t\t\tdepthStencilAttachment.stencilClearValue = renderContext.clearStencilValue;\n\t\t\t\tdepthStencilAttachment.stencilLoadOp = GPULoadOp.Clear;\n\t\t\t\tdepthStencilAttachment.stencilStoreOp = GPUStoreOp.Store;\n\n\t\t\t} else {\n\n\t\t\t\tdepthStencilAttachment.stencilLoadOp = GPULoadOp.Load;\n\t\t\t\tdepthStencilAttachment.stencilStoreOp = GPUStoreOp.Store;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst encoder = device.createCommandEncoder( { label: 'renderContext_' + renderContext.id } );\n\t\tconst currentPass = encoder.beginRenderPass( descriptor );\n\n\t\t//\n\n\t\trenderContextData.descriptor = descriptor;\n\t\trenderContextData.encoder = encoder;\n\t\trenderContextData.currentPass = currentPass;\n\t\trenderContextData.currentSets = { attributes: {}, bindingGroups: [], pipeline: null, index: null };\n\t\trenderContextData.renderBundles = [];\n\n\t\t//\n\n\t\tif ( renderContext.viewport ) {\n\n\t\t\tthis.updateViewport( renderContext );\n\n\t\t}\n\n\t\tif ( renderContext.scissor ) {\n\n\t\t\tconst { x, y, width, height } = renderContext.scissorValue;\n\n\t\t\tcurrentPass.setScissorRect( x, y, width, height );\n\n\t\t}\n\n\t}\n\n\tfinishRender( renderContext ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\t\tconst occlusionQueryCount = renderContext.occlusionQueryCount;\n\n\t\tif ( renderContextData.renderBundles.length > 0 ) {\n\n\t\t\trenderContextData.currentPass.executeBundles( renderContextData.renderBundles );\n\n\t\t}\n\n\t\tif ( occlusionQueryCount > renderContextData.occlusionQueryIndex ) {\n\n\t\t\trenderContextData.currentPass.endOcclusionQuery();\n\n\t\t}\n\n\t\trenderContextData.currentPass.end();\n\n\t\tif ( occlusionQueryCount > 0 ) {\n\n\t\t\tconst bufferSize = occlusionQueryCount * 8; // 8 byte entries for query results\n\n\t\t\t//\n\n\t\t\tlet queryResolveBuffer = this.occludedResolveCache.get( bufferSize );\n\n\t\t\tif ( queryResolveBuffer === undefined ) {\n\n\t\t\t\tqueryResolveBuffer = this.device.createBuffer(\n\t\t\t\t\t{\n\t\t\t\t\t\tsize: bufferSize,\n\t\t\t\t\t\tusage: GPUBufferUsage.QUERY_RESOLVE | GPUBufferUsage.COPY_SRC\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tthis.occludedResolveCache.set( bufferSize, queryResolveBuffer );\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tconst readBuffer = this.device.createBuffer(\n\t\t\t\t{\n\t\t\t\t\tsize: bufferSize,\n\t\t\t\t\tusage: GPUBufferUsage.COPY_DST | GPUBufferUsage.MAP_READ\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t// two buffers required here - WebGPU doesn't allow usage of QUERY_RESOLVE & MAP_READ to be combined\n\t\t\trenderContextData.encoder.resolveQuerySet( renderContextData.occlusionQuerySet, 0, occlusionQueryCount, queryResolveBuffer, 0 );\n\t\t\trenderContextData.encoder.copyBufferToBuffer( queryResolveBuffer, 0, readBuffer, 0, bufferSize );\n\n\t\t\trenderContextData.occlusionQueryBuffer = readBuffer;\n\n\t\t\t//\n\n\t\t\tthis.resolveOccludedAsync( renderContext );\n\n\t\t}\n\n\t\tthis.prepareTimestampBuffer( renderContext, renderContextData.encoder );\n\n\t\tthis.device.queue.submit( [ renderContextData.encoder.finish() ] );\n\n\n\t\t//\n\n\t\tif ( renderContext.textures !== null ) {\n\n\t\t\tconst textures = renderContext.textures;\n\n\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\tconst texture = textures[ i ];\n\n\t\t\t\tif ( texture.generateMipmaps === true ) {\n\n\t\t\t\t\tthis.textureUtils.generateMipmaps( texture );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tisOccluded( renderContext, object ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\treturn renderContextData.occluded && renderContextData.occluded.has( object );\n\n\t}\n\n\tasync resolveOccludedAsync( renderContext ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\t// handle occlusion query results\n\n\t\tconst { currentOcclusionQueryBuffer, currentOcclusionQueryObjects } = renderContextData;\n\n\t\tif ( currentOcclusionQueryBuffer && currentOcclusionQueryObjects ) {\n\n\t\t\tconst occluded = new WeakSet();\n\n\t\t\trenderContextData.currentOcclusionQueryObjects = null;\n\t\t\trenderContextData.currentOcclusionQueryBuffer = null;\n\n\t\t\tawait currentOcclusionQueryBuffer.mapAsync( GPUMapMode.READ );\n\n\t\t\tconst buffer = currentOcclusionQueryBuffer.getMappedRange();\n\t\t\tconst results = new BigUint64Array( buffer );\n\n\t\t\tfor ( let i = 0; i < currentOcclusionQueryObjects.length; i ++ ) {\n\n\t\t\t\tif ( results[ i ] !== BigInt( 0 ) ) {\n\n\t\t\t\t\toccluded.add( currentOcclusionQueryObjects[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tcurrentOcclusionQueryBuffer.destroy();\n\n\t\t\trenderContextData.occluded = occluded;\n\n\t\t}\n\n\t}\n\n\tupdateViewport( renderContext ) {\n\n\t\tconst { currentPass } = this.get( renderContext );\n\t\tconst { x, y, width, height, minDepth, maxDepth } = renderContext.viewportValue;\n\n\t\tcurrentPass.setViewport( x, y, width, height, minDepth, maxDepth );\n\n\t}\n\n\tclear( color, depth, stencil, renderTargetData = null ) {\n\n\t\tconst device = this.device;\n\t\tconst renderer = this.renderer;\n\n\t\tlet colorAttachments = [];\n\n\t\tlet depthStencilAttachment;\n\t\tlet clearValue;\n\n\t\tlet supportsDepth;\n\t\tlet supportsStencil;\n\n\t\tif ( color ) {\n\n\t\t\tconst clearColor = this.getClearColor();\n\n\t\t\tif ( this.renderer.alpha === true ) {\n\n\t\t\t\t// premultiply alpha\n\n\t\t\t\tconst a = clearColor.a;\n\n\t\t\t\tclearValue = { r: clearColor.r * a, g: clearColor.g * a, b: clearColor.b * a, a: a };\n\n\t\t\t} else {\n\n\t\t\t\tclearValue = { r: clearColor.r, g: clearColor.g, b: clearColor.b, a: clearColor.a };\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( renderTargetData === null ) {\n\n\t\t\tsupportsDepth = renderer.depth;\n\t\t\tsupportsStencil = renderer.stencil;\n\n\t\t\tconst descriptor = this._getDefaultRenderPassDescriptor();\n\n\t\t\tif ( color ) {\n\n\t\t\t\tcolorAttachments = descriptor.colorAttachments;\n\n\t\t\t\tconst colorAttachment = colorAttachments[ 0 ];\n\n\t\t\t\tcolorAttachment.clearValue = clearValue;\n\t\t\t\tcolorAttachment.loadOp = GPULoadOp.Clear;\n\t\t\t\tcolorAttachment.storeOp = GPUStoreOp.Store;\n\n\t\t\t}\n\n\t\t\tif ( supportsDepth || supportsStencil ) {\n\n\t\t\t\tdepthStencilAttachment = descriptor.depthStencilAttachment;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tsupportsDepth = renderTargetData.depth;\n\t\t\tsupportsStencil = renderTargetData.stencil;\n\n\t\t\tif ( color ) {\n\n\t\t\t\tfor ( const texture of renderTargetData.textures ) {\n\n\t\t\t\t\tconst textureData = this.get( texture );\n\t\t\t\t\tconst textureView = textureData.texture.createView();\n\n\t\t\t\t\tlet view, resolveTarget;\n\n\t\t\t\t\tif ( textureData.msaaTexture !== undefined ) {\n\n\t\t\t\t\t\tview = textureData.msaaTexture.createView();\n\t\t\t\t\t\tresolveTarget = textureView;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tview = textureView;\n\t\t\t\t\t\tresolveTarget = undefined;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcolorAttachments.push( {\n\t\t\t\t\t\tview,\n\t\t\t\t\t\tresolveTarget,\n\t\t\t\t\t\tclearValue,\n\t\t\t\t\t\tloadOp: GPULoadOp.Clear,\n\t\t\t\t\t\tstoreOp: GPUStoreOp.Store\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( supportsDepth || supportsStencil ) {\n\n\t\t\t\tconst depthTextureData = this.get( renderTargetData.depthTexture );\n\n\t\t\t\tdepthStencilAttachment = {\n\t\t\t\t\tview: depthTextureData.texture.createView()\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( supportsDepth ) {\n\n\t\t\tif ( depth ) {\n\n\t\t\t\tdepthStencilAttachment.depthLoadOp = GPULoadOp.Clear;\n\t\t\t\tdepthStencilAttachment.depthClearValue = renderer.getClearDepth();\n\t\t\t\tdepthStencilAttachment.depthStoreOp = GPUStoreOp.Store;\n\n\t\t\t} else {\n\n\t\t\t\tdepthStencilAttachment.depthLoadOp = GPULoadOp.Load;\n\t\t\t\tdepthStencilAttachment.depthStoreOp = GPUStoreOp.Store;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( supportsStencil ) {\n\n\t\t\tif ( stencil ) {\n\n\t\t\t\tdepthStencilAttachment.stencilLoadOp = GPULoadOp.Clear;\n\t\t\t\tdepthStencilAttachment.stencilClearValue = renderer.getClearStencil();\n\t\t\t\tdepthStencilAttachment.stencilStoreOp = GPUStoreOp.Store;\n\n\t\t\t} else {\n\n\t\t\t\tdepthStencilAttachment.stencilLoadOp = GPULoadOp.Load;\n\t\t\t\tdepthStencilAttachment.stencilStoreOp = GPUStoreOp.Store;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst encoder = device.createCommandEncoder( {} );\n\t\tconst currentPass = encoder.beginRenderPass( {\n\t\t\tcolorAttachments,\n\t\t\tdepthStencilAttachment\n\t\t} );\n\n\t\tcurrentPass.end();\n\n\t\tdevice.queue.submit( [ encoder.finish() ] );\n\n\t}\n\n\t// compute\n\n\tbeginCompute( computeGroup ) {\n\n\t\tconst groupGPU = this.get( computeGroup );\n\n\n\t\tconst descriptor = {};\n\n\t\tthis.initTimestampQuery( computeGroup, descriptor );\n\n\t\tgroupGPU.cmdEncoderGPU = this.device.createCommandEncoder();\n\n\t\tgroupGPU.passEncoderGPU = groupGPU.cmdEncoderGPU.beginComputePass( descriptor );\n\n\t}\n\n\tcompute( computeGroup, computeNode, bindings, pipeline ) {\n\n\t\tconst { passEncoderGPU } = this.get( computeGroup );\n\n\t\t// pipeline\n\n\t\tconst pipelineGPU = this.get( pipeline ).pipeline;\n\t\tpassEncoderGPU.setPipeline( pipelineGPU );\n\n\t\t// bind groups\n\n\t\tfor ( let i = 0, l = bindings.length; i < l; i ++ ) {\n\n\t\t\tconst bindGroup = bindings[ i ];\n\t\t\tconst bindingsData = this.get( bindGroup );\n\n\t\t\tpassEncoderGPU.setBindGroup( i, bindingsData.group );\n\n\t\t}\n\n\t\tconst maxComputeWorkgroupsPerDimension = this.device.limits.maxComputeWorkgroupsPerDimension;\n\n\t\tconst computeNodeData = this.get( computeNode );\n\n\t\tif ( computeNodeData.dispatchSize === undefined ) computeNodeData.dispatchSize = { x: 0, y: 1, z: 1 };\n\n\t\tconst { dispatchSize } = computeNodeData;\n\n\t\tif ( computeNode.dispatchCount > maxComputeWorkgroupsPerDimension ) {\n\n\t\t\tdispatchSize.x = Math.min( computeNode.dispatchCount, maxComputeWorkgroupsPerDimension );\n\t\t\tdispatchSize.y = Math.ceil( computeNode.dispatchCount / maxComputeWorkgroupsPerDimension );\n\n\t\t} else {\n\n\t\t\tdispatchSize.x = computeNode.dispatchCount;\n\n\t\t}\n\n\t\tpassEncoderGPU.dispatchWorkgroups(\n\t\t\tdispatchSize.x,\n\t\t\tdispatchSize.y,\n\t\t\tdispatchSize.z\n\t\t);\n\n\t}\n\n\tfinishCompute( computeGroup ) {\n\n\t\tconst groupData = this.get( computeGroup );\n\n\t\tgroupData.passEncoderGPU.end();\n\n\t\tthis.prepareTimestampBuffer( computeGroup, groupData.cmdEncoderGPU );\n\n\t\tthis.device.queue.submit( [ groupData.cmdEncoderGPU.finish() ] );\n\n\t}\n\n\tasync waitForGPU() {\n\n\t\tawait this.device.queue.onSubmittedWorkDone();\n\n\t}\n\n\t// render object\n\n\tdraw( renderObject, info ) {\n\n\t\tconst { object, context, pipeline } = renderObject;\n\t\tconst bindings = renderObject.getBindings();\n\t\tconst renderContextData = this.get( context );\n\t\tconst pipelineGPU = this.get( pipeline ).pipeline;\n\t\tconst currentSets = renderContextData.currentSets;\n\t\tconst passEncoderGPU = renderContextData.currentPass;\n\n\t\tconst drawParams = renderObject.getDrawParameters();\n\n\t\tif ( drawParams === null ) return;\n\n\t\t// pipeline\n\n\t\tif ( currentSets.pipeline !== pipelineGPU ) {\n\n\t\t\tpassEncoderGPU.setPipeline( pipelineGPU );\n\n\t\t\tcurrentSets.pipeline = pipelineGPU;\n\n\t\t}\n\n\t\t// bind groups\n\n\t\tconst currentBindingGroups = currentSets.bindingGroups;\n\n\t\tfor ( let i = 0, l = bindings.length; i < l; i ++ ) {\n\n\t\t\tconst bindGroup = bindings[ i ];\n\t\t\tconst bindingsData = this.get( bindGroup );\n\n\t\t\tif ( currentBindingGroups[ bindGroup.index ] !== bindGroup.id ) {\n\n\t\t\t\tpassEncoderGPU.setBindGroup( bindGroup.index, bindingsData.group );\n\t\t\t\tcurrentBindingGroups[ bindGroup.index ] = bindGroup.id;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// attributes\n\n\t\tconst index = renderObject.getIndex();\n\n\t\tconst hasIndex = ( index !== null );\n\n\t\t// index\n\n\t\tif ( hasIndex === true ) {\n\n\t\t\tif ( currentSets.index !== index ) {\n\n\t\t\t\tconst buffer = this.get( index ).buffer;\n\t\t\t\tconst indexFormat = ( index.array instanceof Uint16Array ) ? GPUIndexFormat.Uint16 : GPUIndexFormat.Uint32;\n\n\t\t\t\tpassEncoderGPU.setIndexBuffer( buffer, indexFormat );\n\n\t\t\t\tcurrentSets.index = index;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// vertex buffers\n\n\t\tconst vertexBuffers = renderObject.getVertexBuffers();\n\n\t\tfor ( let i = 0, l = vertexBuffers.length; i < l; i ++ ) {\n\n\t\t\tconst vertexBuffer = vertexBuffers[ i ];\n\n\t\t\tif ( currentSets.attributes[ i ] !== vertexBuffer ) {\n\n\t\t\t\tconst buffer = this.get( vertexBuffer ).buffer;\n\t\t\t\tpassEncoderGPU.setVertexBuffer( i, buffer );\n\n\t\t\t\tcurrentSets.attributes[ i ] = vertexBuffer;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// occlusion queries - handle multiple consecutive draw calls for an object\n\n\t\tif ( renderContextData.occlusionQuerySet !== undefined ) {\n\n\t\t\tconst lastObject = renderContextData.lastOcclusionObject;\n\n\t\t\tif ( lastObject !== object ) {\n\n\t\t\t\tif ( lastObject !== null && lastObject.occlusionTest === true ) {\n\n\t\t\t\t\tpassEncoderGPU.endOcclusionQuery();\n\t\t\t\t\trenderContextData.occlusionQueryIndex ++;\n\n\t\t\t\t}\n\n\t\t\t\tif ( object.occlusionTest === true ) {\n\n\t\t\t\t\tpassEncoderGPU.beginOcclusionQuery( renderContextData.occlusionQueryIndex );\n\t\t\t\t\trenderContextData.occlusionQueryObjects[ renderContextData.occlusionQueryIndex ] = object;\n\n\t\t\t\t}\n\n\t\t\t\trenderContextData.lastOcclusionObject = object;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// draw\n\n\t\tif ( object.isBatchedMesh === true ) {\n\n\t\t\tconst starts = object._multiDrawStarts;\n\t\t\tconst counts = object._multiDrawCounts;\n\t\t\tconst drawCount = object._multiDrawCount;\n\t\t\tconst drawInstances = object._multiDrawInstances;\n\n\t\t\tconst bytesPerElement = hasIndex ? index.array.BYTES_PER_ELEMENT : 1;\n\n\t\t\tfor ( let i = 0; i < drawCount; i ++ ) {\n\n\t\t\t\tconst count = drawInstances ? drawInstances[ i ] : 1;\n\t\t\t\tconst firstInstance = count > 1 ? 0 : i;\n\n\t\t\t\tpassEncoderGPU.drawIndexed( counts[ i ], count, starts[ i ] / bytesPerElement, 0, firstInstance );\n\n\t\t\t}\n\n\t\t} else if ( hasIndex === true ) {\n\n\t\t\tconst { vertexCount: indexCount, instanceCount, firstVertex: firstIndex } = drawParams;\n\n\t\t\tconst indirect = renderObject.getIndirect();\n\n\t\t\tif ( indirect !== null ) {\n\n\t\t\t\tconst buffer = this.get( indirect ).buffer;\n\n\t\t\t\tpassEncoderGPU.drawIndexedIndirect( buffer, 0 );\n\n\t\t\t} else {\n\n\t\t\t\tpassEncoderGPU.drawIndexed( indexCount, instanceCount, firstIndex, 0, 0 );\n\n\t\t\t}\n\n\t\t\tinfo.update( object, indexCount, instanceCount );\n\n\t\t} else {\n\n\t\t\tconst { vertexCount, instanceCount, firstVertex } = drawParams;\n\n\t\t\tconst indirect = renderObject.getIndirect();\n\n\t\t\tif ( indirect !== null ) {\n\n\t\t\t\tconst buffer = this.get( indirect ).buffer;\n\n\t\t\t\tpassEncoderGPU.drawIndirect( buffer, 0 );\n\n\t\t\t} else {\n\n\t\t\t\tpassEncoderGPU.draw( vertexCount, instanceCount, firstVertex, 0 );\n\n\t\t\t}\n\n\t\t\tinfo.update( object, vertexCount, instanceCount );\n\n\t\t}\n\n\t}\n\n\t// cache key\n\n\tneedsRenderUpdate( renderObject ) {\n\n\t\tconst data = this.get( renderObject );\n\n\t\tconst { object, material } = renderObject;\n\n\t\tconst utils = this.utils;\n\n\t\tconst sampleCount = utils.getSampleCountRenderContext( renderObject.context );\n\t\tconst colorSpace = utils.getCurrentColorSpace( renderObject.context );\n\t\tconst colorFormat = utils.getCurrentColorFormat( renderObject.context );\n\t\tconst depthStencilFormat = utils.getCurrentDepthStencilFormat( renderObject.context );\n\t\tconst primitiveTopology = utils.getPrimitiveTopology( object, material );\n\n\t\tlet needsUpdate = false;\n\n\t\tif ( data.material !== material || data.materialVersion !== material.version ||\n\t\t\tdata.transparent !== material.transparent || data.blending !== material.blending || data.premultipliedAlpha !== material.premultipliedAlpha ||\n\t\t\tdata.blendSrc !== material.blendSrc || data.blendDst !== material.blendDst || data.blendEquation !== material.blendEquation ||\n\t\t\tdata.blendSrcAlpha !== material.blendSrcAlpha || data.blendDstAlpha !== material.blendDstAlpha || data.blendEquationAlpha !== material.blendEquationAlpha ||\n\t\t\tdata.colorWrite !== material.colorWrite || data.depthWrite !== material.depthWrite || data.depthTest !== material.depthTest || data.depthFunc !== material.depthFunc ||\n\t\t\tdata.stencilWrite !== material.stencilWrite || data.stencilFunc !== material.stencilFunc ||\n\t\t\tdata.stencilFail !== material.stencilFail || data.stencilZFail !== material.stencilZFail || data.stencilZPass !== material.stencilZPass ||\n\t\t\tdata.stencilFuncMask !== material.stencilFuncMask || data.stencilWriteMask !== material.stencilWriteMask ||\n\t\t\tdata.side !== material.side || data.alphaToCoverage !== material.alphaToCoverage ||\n\t\t\tdata.sampleCount !== sampleCount || data.colorSpace !== colorSpace ||\n\t\t\tdata.colorFormat !== colorFormat || data.depthStencilFormat !== depthStencilFormat ||\n\t\t\tdata.primitiveTopology !== primitiveTopology ||\n\t\t\tdata.clippingContextCacheKey !== renderObject.clippingContextCacheKey\n\t\t) {\n\n\t\t\tdata.material = material; data.materialVersion = material.version;\n\t\t\tdata.transparent = material.transparent; data.blending = material.blending; data.premultipliedAlpha = material.premultipliedAlpha;\n\t\t\tdata.blendSrc = material.blendSrc; data.blendDst = material.blendDst; data.blendEquation = material.blendEquation;\n\t\t\tdata.blendSrcAlpha = material.blendSrcAlpha; data.blendDstAlpha = material.blendDstAlpha; data.blendEquationAlpha = material.blendEquationAlpha;\n\t\t\tdata.colorWrite = material.colorWrite;\n\t\t\tdata.depthWrite = material.depthWrite; data.depthTest = material.depthTest; data.depthFunc = material.depthFunc;\n\t\t\tdata.stencilWrite = material.stencilWrite; data.stencilFunc = material.stencilFunc;\n\t\t\tdata.stencilFail = material.stencilFail; data.stencilZFail = material.stencilZFail; data.stencilZPass = material.stencilZPass;\n\t\t\tdata.stencilFuncMask = material.stencilFuncMask; data.stencilWriteMask = material.stencilWriteMask;\n\t\t\tdata.side = material.side; data.alphaToCoverage = material.alphaToCoverage;\n\t\t\tdata.sampleCount = sampleCount;\n\t\t\tdata.colorSpace = colorSpace;\n\t\t\tdata.colorFormat = colorFormat;\n\t\t\tdata.depthStencilFormat = depthStencilFormat;\n\t\t\tdata.primitiveTopology = primitiveTopology;\n\t\t\tdata.clippingContextCacheKey = renderObject.clippingContextCacheKey;\n\n\t\t\tneedsUpdate = true;\n\n\t\t}\n\n\t\treturn needsUpdate;\n\n\t}\n\n\tgetRenderCacheKey( renderObject ) {\n\n\t\tconst { object, material } = renderObject;\n\n\t\tconst utils = this.utils;\n\t\tconst renderContext = renderObject.context;\n\n\t\treturn [\n\t\t\tmaterial.transparent, material.blending, material.premultipliedAlpha,\n\t\t\tmaterial.blendSrc, material.blendDst, material.blendEquation,\n\t\t\tmaterial.blendSrcAlpha, material.blendDstAlpha, material.blendEquationAlpha,\n\t\t\tmaterial.colorWrite,\n\t\t\tmaterial.depthWrite, material.depthTest, material.depthFunc,\n\t\t\tmaterial.stencilWrite, material.stencilFunc,\n\t\t\tmaterial.stencilFail, material.stencilZFail, material.stencilZPass,\n\t\t\tmaterial.stencilFuncMask, material.stencilWriteMask,\n\t\t\tmaterial.side,\n\t\t\tutils.getSampleCountRenderContext( renderContext ),\n\t\t\tutils.getCurrentColorSpace( renderContext ), utils.getCurrentColorFormat( renderContext ), utils.getCurrentDepthStencilFormat( renderContext ),\n\t\t\tutils.getPrimitiveTopology( object, material ),\n\t\t\trenderObject.getGeometryCacheKey(),\n\t\t\trenderObject.clippingContextCacheKey\n\t\t].join();\n\n\t}\n\n\t// textures\n\n\tcreateSampler( texture ) {\n\n\t\tthis.textureUtils.createSampler( texture );\n\n\t}\n\n\tdestroySampler( texture ) {\n\n\t\tthis.textureUtils.destroySampler( texture );\n\n\t}\n\n\tcreateDefaultTexture( texture ) {\n\n\t\tthis.textureUtils.createDefaultTexture( texture );\n\n\t}\n\n\tcreateTexture( texture, options ) {\n\n\t\tthis.textureUtils.createTexture( texture, options );\n\n\t}\n\n\tupdateTexture( texture, options ) {\n\n\t\tthis.textureUtils.updateTexture( texture, options );\n\n\t}\n\n\tgenerateMipmaps( texture ) {\n\n\t\tthis.textureUtils.generateMipmaps( texture );\n\n\t}\n\n\tdestroyTexture( texture ) {\n\n\t\tthis.textureUtils.destroyTexture( texture );\n\n\t}\n\n\tcopyTextureToBuffer( texture, x, y, width, height, faceIndex ) {\n\n\t\treturn this.textureUtils.copyTextureToBuffer( texture, x, y, width, height, faceIndex );\n\n\t}\n\n\n\tinitTimestampQuery( renderContext, descriptor ) {\n\n\t\tif ( ! this.trackTimestamp ) return;\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tif ( ! renderContextData.timeStampQuerySet ) {\n\n\n\t\t\tconst type = renderContext.isComputeNode ? 'compute' : 'render';\n\t\t\tconst timeStampQuerySet = this.device.createQuerySet( { type: 'timestamp', count: 2, label: `timestamp_${type}_${renderContext.id}` } );\n\n\t\t\tconst timestampWrites = {\n\t\t\t\tquerySet: timeStampQuerySet,\n\t\t\t\tbeginningOfPassWriteIndex: 0, // Write timestamp in index 0 when pass begins.\n\t\t\t\tendOfPassWriteIndex: 1, // Write timestamp in index 1 when pass ends.\n\t\t\t};\n\n\t\t\tObject.assign( descriptor, { timestampWrites } );\n\n\t\t\trenderContextData.timeStampQuerySet = timeStampQuerySet;\n\n\t\t}\n\n\t}\n\n\t// timestamp utils\n\n\tprepareTimestampBuffer( renderContext, encoder ) {\n\n\t\tif ( ! this.trackTimestamp ) return;\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\n\t\tconst size = 2 * BigInt64Array.BYTES_PER_ELEMENT;\n\n\t\tif ( renderContextData.currentTimestampQueryBuffers === undefined ) {\n\n\t\t\trenderContextData.currentTimestampQueryBuffers = {\n\t\t\t\tresolveBuffer: this.device.createBuffer( {\n\t\t\t\t\tlabel: 'timestamp resolve buffer',\n\t\t\t\t\tsize: size,\n\t\t\t\t\tusage: GPUBufferUsage.QUERY_RESOLVE | GPUBufferUsage.COPY_SRC,\n\t\t\t\t} ),\n\t\t\t\tresultBuffer: this.device.createBuffer( {\n\t\t\t\t\tlabel: 'timestamp result buffer',\n\t\t\t\t\tsize: size,\n\t\t\t\t\tusage: GPUBufferUsage.COPY_DST | GPUBufferUsage.MAP_READ,\n\t\t\t\t} )\n\t\t\t};\n\n\t\t}\n\n\t\tconst { resolveBuffer, resultBuffer } = renderContextData.currentTimestampQueryBuffers;\n\n\n\t\tencoder.resolveQuerySet( renderContextData.timeStampQuerySet, 0, 2, resolveBuffer, 0 );\n\n\t\tif ( resultBuffer.mapState === 'unmapped' ) {\n\n\t\t\tencoder.copyBufferToBuffer( resolveBuffer, 0, resultBuffer, 0, size );\n\n\t\t}\n\n\t}\n\n\tasync resolveTimestampAsync( renderContext, type = 'render' ) {\n\n\t\tif ( ! this.trackTimestamp ) return;\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tif ( renderContextData.currentTimestampQueryBuffers === undefined ) return;\n\n\t\tconst { resultBuffer } = renderContextData.currentTimestampQueryBuffers;\n\n\t\tawait this.device.queue.onSubmittedWorkDone();\n\n\t\tif ( resultBuffer.mapState === 'unmapped' ) {\n\n\t\t\tresultBuffer.mapAsync( GPUMapMode.READ ).then( () => {\n\n\t\t\t\tconst times = new BigUint64Array( resultBuffer.getMappedRange() );\n\t\t\t\tconst duration = Number( times[ 1 ] - times[ 0 ] ) / 1000000;\n\n\n\t\t\t\tthis.renderer.info.updateTimestamp( type, duration );\n\n\t\t\t\tresultBuffer.unmap();\n\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\t// node builder\n\n\tcreateNodeBuilder( object, renderer ) {\n\n\t\treturn new WGSLNodeBuilder( object, renderer );\n\n\t}\n\n\t// program\n\n\tcreateProgram( program ) {\n\n\t\tconst programGPU = this.get( program );\n\n\t\tprogramGPU.module = {\n\t\t\tmodule: this.device.createShaderModule( { code: program.code, label: program.stage } ),\n\t\t\tentryPoint: 'main'\n\t\t};\n\n\t}\n\n\tdestroyProgram( program ) {\n\n\t\tthis.delete( program );\n\n\t}\n\n\t// pipelines\n\n\tcreateRenderPipeline( renderObject, promises ) {\n\n\t\tthis.pipelineUtils.createRenderPipeline( renderObject, promises );\n\n\t}\n\n\tcreateComputePipeline( computePipeline, bindings ) {\n\n\t\tthis.pipelineUtils.createComputePipeline( computePipeline, bindings );\n\n\t}\n\n\tbeginBundle( renderContext ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\trenderContextData._currentPass = renderContextData.currentPass;\n\t\trenderContextData._currentSets = renderContextData.currentSets;\n\n\t\trenderContextData.currentSets = { attributes: {}, bindingGroups: [], pipeline: null, index: null };\n\t\trenderContextData.currentPass = this.pipelineUtils.createBundleEncoder( renderContext );\n\n\t}\n\n\tfinishBundle( renderContext, bundle ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tconst bundleEncoder = renderContextData.currentPass;\n\t\tconst bundleGPU = bundleEncoder.finish();\n\n\t\tthis.get( bundle ).bundleGPU = bundleGPU;\n\n\t\t// restore render pass state\n\n\t\trenderContextData.currentSets = renderContextData._currentSets;\n\t\trenderContextData.currentPass = renderContextData._currentPass;\n\n\t}\n\n\taddBundle( renderContext, bundle ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\trenderContextData.renderBundles.push( this.get( bundle ).bundleGPU );\n\n\t}\n\n\t// bindings\n\n\tcreateBindings( bindGroup, bindings, cacheIndex, version ) {\n\n\t\tthis.bindingUtils.createBindings( bindGroup, bindings, cacheIndex, version );\n\n\t}\n\n\tupdateBindings( bindGroup, bindings, cacheIndex, version ) {\n\n\t\tthis.bindingUtils.createBindings( bindGroup, bindings, cacheIndex, version );\n\n\t}\n\n\tupdateBinding( binding ) {\n\n\t\tthis.bindingUtils.updateBinding( binding );\n\n\t}\n\n\t// attributes\n\n\tcreateIndexAttribute( attribute ) {\n\n\t\tthis.attributeUtils.createAttribute( attribute, GPUBufferUsage.INDEX | GPUBufferUsage.COPY_SRC | GPUBufferUsage.COPY_DST );\n\n\t}\n\n\tcreateAttribute( attribute ) {\n\n\t\tthis.attributeUtils.createAttribute( attribute, GPUBufferUsage.VERTEX | GPUBufferUsage.COPY_SRC | GPUBufferUsage.COPY_DST );\n\n\t}\n\n\tcreateStorageAttribute( attribute ) {\n\n\t\tthis.attributeUtils.createAttribute( attribute, GPUBufferUsage.STORAGE | GPUBufferUsage.VERTEX | GPUBufferUsage.COPY_SRC | GPUBufferUsage.COPY_DST );\n\n\t}\n\n\tcreateIndirectStorageAttribute( attribute ) {\n\n\t\tthis.attributeUtils.createAttribute( attribute, GPUBufferUsage.STORAGE | GPUBufferUsage.INDIRECT | GPUBufferUsage.COPY_SRC | GPUBufferUsage.COPY_DST );\n\n\t}\n\n\tupdateAttribute( attribute ) {\n\n\t\tthis.attributeUtils.updateAttribute( attribute );\n\n\t}\n\n\tdestroyAttribute( attribute ) {\n\n\t\tthis.attributeUtils.destroyAttribute( attribute );\n\n\t}\n\n\t// canvas\n\n\tupdateSize() {\n\n\t\tthis.colorBuffer = this.textureUtils.getColorBuffer();\n\t\tthis.defaultRenderPassdescriptor = null;\n\n\t}\n\n\t// utils public\n\n\tgetMaxAnisotropy() {\n\n\t\treturn 16;\n\n\t}\n\n\thasFeature( name ) {\n\n\t\treturn this.device.features.has( name );\n\n\t}\n\n\tcopyTextureToTexture( srcTexture, dstTexture, srcRegion = null, dstPosition = null, level = 0 ) {\n\n\t\tlet dstX = 0;\n\t\tlet dstY = 0;\n\t\tlet dstLayer = 0;\n\n\t\tlet srcX = 0;\n\t\tlet srcY = 0;\n\t\tlet srcLayer = 0;\n\n\t\tlet srcWidth = srcTexture.image.width;\n\t\tlet srcHeight = srcTexture.image.height;\n\n\t\tif ( srcRegion !== null ) {\n\n\t\t\tsrcX = srcRegion.x;\n\t\t\tsrcY = srcRegion.y;\n\t\t\tsrcLayer = srcRegion.z || 0;\n\t\t\tsrcWidth = srcRegion.width;\n\t\t\tsrcHeight = srcRegion.height;\n\n\t\t}\n\n\t\tif ( dstPosition !== null ) {\n\n\t\t\tdstX = dstPosition.x;\n\t\t\tdstY = dstPosition.y;\n\t\t\tdstLayer = dstPosition.z || 0;\n\n\t\t}\n\n\t\tconst encoder = this.device.createCommandEncoder( { label: 'copyTextureToTexture_' + srcTexture.id + '_' + dstTexture.id } );\n\n\t\tconst sourceGPU = this.get( srcTexture ).texture;\n\t\tconst destinationGPU = this.get( dstTexture ).texture;\n\n\t\tencoder.copyTextureToTexture(\n\t\t\t{\n\t\t\t\ttexture: sourceGPU,\n\t\t\t\tmipLevel: level,\n\t\t\t\torigin: { x: srcX, y: srcY, z: srcLayer }\n\t\t\t},\n\t\t\t{\n\t\t\t\ttexture: destinationGPU,\n\t\t\t\tmipLevel: level,\n\t\t\t\torigin: { x: dstX, y: dstY, z: dstLayer }\n\t\t\t},\n\t\t\t[\n\t\t\t\tsrcWidth,\n\t\t\t\tsrcHeight,\n\t\t\t\t1\n\t\t\t]\n\t\t);\n\n\t\tthis.device.queue.submit( [ encoder.finish() ] );\n\n\t}\n\n\tcopyFramebufferToTexture( texture, renderContext, rectangle ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tlet sourceGPU = null;\n\n\t\tif ( renderContext.renderTarget ) {\n\n\t\t\tif ( texture.isDepthTexture ) {\n\n\t\t\t\tsourceGPU = this.get( renderContext.depthTexture ).texture;\n\n\t\t\t} else {\n\n\t\t\t\tsourceGPU = this.get( renderContext.textures[ 0 ] ).texture;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( texture.isDepthTexture ) {\n\n\t\t\t\tsourceGPU = this.textureUtils.getDepthBuffer( renderContext.depth, renderContext.stencil );\n\n\t\t\t} else {\n\n\t\t\t\tsourceGPU = this.context.getCurrentTexture();\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst destinationGPU = this.get( texture ).texture;\n\n\t\tif ( sourceGPU.format !== destinationGPU.format ) {\n\n\t\t\tconsole.error( 'WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.', sourceGPU.format, destinationGPU.format );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tlet encoder;\n\n\t\tif ( renderContextData.currentPass ) {\n\n\t\t\trenderContextData.currentPass.end();\n\n\t\t\tencoder = renderContextData.encoder;\n\n\t\t} else {\n\n\t\t\tencoder = this.device.createCommandEncoder( { label: 'copyFramebufferToTexture_' + texture.id } );\n\n\t\t}\n\n\t\tencoder.copyTextureToTexture(\n\t\t\t{\n\t\t\t\ttexture: sourceGPU,\n\t\t\t\torigin: [ rectangle.x, rectangle.y, 0 ],\n\t\t\t},\n\t\t\t{\n\t\t\t\ttexture: destinationGPU\n\t\t\t},\n\t\t\t[\n\t\t\t\trectangle.z,\n\t\t\t\trectangle.w\n\t\t\t]\n\t\t);\n\n\t\tif ( texture.generateMipmaps ) this.textureUtils.generateMipmaps( texture );\n\n\t\tif ( renderContextData.currentPass ) {\n\n\t\t\tconst { descriptor } = renderContextData;\n\n\t\t\tfor ( let i = 0; i < descriptor.colorAttachments.length; i ++ ) {\n\n\t\t\t\tdescriptor.colorAttachments[ i ].loadOp = GPULoadOp.Load;\n\n\t\t\t}\n\n\t\t\tif ( renderContext.depth ) descriptor.depthStencilAttachment.depthLoadOp = GPULoadOp.Load;\n\t\t\tif ( renderContext.stencil ) descriptor.depthStencilAttachment.stencilLoadOp = GPULoadOp.Load;\n\n\t\t\trenderContextData.currentPass = encoder.beginRenderPass( descriptor );\n\t\t\trenderContextData.currentSets = { attributes: {}, bindingGroups: [], pipeline: null, index: null };\n\n\t\t\tif ( renderContext.viewport ) {\n\n\t\t\t\tthis.updateViewport( renderContext );\n\n\t\t\t}\n\n\t\t\tif ( renderContext.scissor ) {\n\n\t\t\t\tconst { x, y, width, height } = renderContext.scissorValue;\n\n\t\t\t\trenderContextData.currentPass.setScissorRect( x, y, width, height );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis.device.queue.submit( [ encoder.finish() ] );\n\n\t\t}\n\n\t}\n\n}\n\nclass IESSpotLight extends SpotLight {\n\n\tconstructor( color, intensity, distance, angle, penumbra, decay ) {\n\n\t\tsuper( color, intensity, distance, angle, penumbra, decay );\n\n\t\tthis.iesMap = null;\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.iesMap = source.iesMap;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass StandardNodeLibrary extends NodeLibrary {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.addMaterial( MeshPhongNodeMaterial, 'MeshPhongMaterial' );\n\t\tthis.addMaterial( MeshStandardNodeMaterial, 'MeshStandardMaterial' );\n\t\tthis.addMaterial( MeshPhysicalNodeMaterial, 'MeshPhysicalMaterial' );\n\t\tthis.addMaterial( MeshToonNodeMaterial, 'MeshToonMaterial' );\n\t\tthis.addMaterial( MeshBasicNodeMaterial, 'MeshBasicMaterial' );\n\t\tthis.addMaterial( MeshLambertNodeMaterial, 'MeshLambertMaterial' );\n\t\tthis.addMaterial( MeshNormalNodeMaterial, 'MeshNormalMaterial' );\n\t\tthis.addMaterial( MeshMatcapNodeMaterial, 'MeshMatcapMaterial' );\n\t\tthis.addMaterial( LineBasicNodeMaterial, 'LineBasicMaterial' );\n\t\tthis.addMaterial( LineDashedNodeMaterial, 'LineDashedMaterial' );\n\t\tthis.addMaterial( PointsNodeMaterial, 'PointsMaterial' );\n\t\tthis.addMaterial( SpriteNodeMaterial, 'SpriteMaterial' );\n\t\tthis.addMaterial( ShadowNodeMaterial, 'ShadowMaterial' );\n\n\t\tthis.addLight( PointLightNode, PointLight );\n\t\tthis.addLight( DirectionalLightNode, DirectionalLight );\n\t\tthis.addLight( RectAreaLightNode, RectAreaLight );\n\t\tthis.addLight( SpotLightNode, SpotLight );\n\t\tthis.addLight( AmbientLightNode, AmbientLight );\n\t\tthis.addLight( HemisphereLightNode, HemisphereLight );\n\t\tthis.addLight( LightProbeNode, LightProbe );\n\t\tthis.addLight( IESSpotLightNode, IESSpotLight );\n\n\t\tthis.addToneMapping( linearToneMapping, LinearToneMapping );\n\t\tthis.addToneMapping( reinhardToneMapping, ReinhardToneMapping );\n\t\tthis.addToneMapping( cineonToneMapping, CineonToneMapping );\n\t\tthis.addToneMapping( acesFilmicToneMapping, ACESFilmicToneMapping );\n\t\tthis.addToneMapping( agxToneMapping, AgXToneMapping );\n\t\tthis.addToneMapping( neutralToneMapping, NeutralToneMapping );\n\n\t}\n\n}\n\n/*\nconst debugHandler = {\n\n\tget: function ( target, name ) {\n\n\t\t// Add |update\n\t\tif ( /^(create|destroy)/.test( name ) ) console.log( 'WebGPUBackend.' + name );\n\n\t\treturn target[ name ];\n\n\t}\n\n};\n*/\nclass WebGPURenderer extends Renderer {\n\n\tconstructor( parameters = {} ) {\n\n\t\tlet BackendClass;\n\n\t\tif ( parameters.forceWebGL ) {\n\n\t\t\tBackendClass = WebGLBackend;\n\n\t\t} else {\n\n\t\t\tBackendClass = WebGPUBackend;\n\n\t\t\tparameters.getFallback = () => {\n\n\t\t\t\tconsole.warn( 'THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend.' );\n\n\t\t\t\treturn new WebGLBackend( parameters );\n\n\t\t\t};\n\n\t\t}\n\n\t\tconst backend = new BackendClass( parameters );\n\n\t\t//super( new Proxy( backend, debugHandler ) );\n\t\tsuper( backend, parameters );\n\n\t\tthis.library = new StandardNodeLibrary();\n\n\t\tthis.isWebGPURenderer = true;\n\n\t}\n\n}\n\nclass BundleGroup extends Group {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isBundleGroup = true;\n\n\t\tthis.type = 'BundleGroup';\n\n\t\tthis.static = true;\n\t\tthis.version = 0;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n}\n\nconst _material = /*@__PURE__*/ new NodeMaterial();\nconst _quadMesh = /*@__PURE__*/ new QuadMesh( _material );\n\nclass PostProcessing {\n\n\tconstructor( renderer, outputNode = vec4( 0, 0, 1, 1 ) ) {\n\n\t\tthis.renderer = renderer;\n\t\tthis.outputNode = outputNode;\n\n\t\tthis.outputColorTransform = true;\n\n\t\tthis.needsUpdate = true;\n\n\t\t_material.name = 'PostProcessing';\n\n\t}\n\n\trender() {\n\n\t\tthis.update();\n\n\t\tconst renderer = this.renderer;\n\n\t\tconst toneMapping = renderer.toneMapping;\n\t\tconst outputColorSpace = renderer.outputColorSpace;\n\n\t\trenderer.toneMapping = NoToneMapping;\n\t\trenderer.outputColorSpace = LinearSRGBColorSpace;\n\n\t\t//\n\n\t\t_quadMesh.render( renderer );\n\n\t\t//\n\n\t\trenderer.toneMapping = toneMapping;\n\t\trenderer.outputColorSpace = outputColorSpace;\n\n\t}\n\n\tupdate() {\n\n\t\tif ( this.needsUpdate === true ) {\n\n\t\t\tconst renderer = this.renderer;\n\n\t\t\tconst toneMapping = renderer.toneMapping;\n\t\t\tconst outputColorSpace = renderer.outputColorSpace;\n\n\t\t\t_quadMesh.material.fragmentNode = this.outputColorTransform === true ? renderOutput( this.outputNode, toneMapping, outputColorSpace ) : this.outputNode.context( { toneMapping, outputColorSpace } );\n\t\t\t_quadMesh.material.needsUpdate = true;\n\n\t\t\tthis.needsUpdate = false;\n\n\t\t}\n\n\t}\n\n\tasync renderAsync() {\n\n\t\tthis.update();\n\n\t\tconst renderer = this.renderer;\n\n\t\tconst toneMapping = renderer.toneMapping;\n\t\tconst outputColorSpace = renderer.outputColorSpace;\n\n\t\trenderer.toneMapping = NoToneMapping;\n\t\trenderer.outputColorSpace = LinearSRGBColorSpace;\n\n\t\t//\n\n\t\tawait _quadMesh.renderAsync( renderer );\n\n\t\t//\n\n\t\trenderer.toneMapping = toneMapping;\n\t\trenderer.outputColorSpace = outputColorSpace;\n\n\t}\n\n}\n\n// renderer state\n\nfunction saveRendererState( renderer, state = {} ) {\n\n\tstate.toneMapping = renderer.toneMapping;\n\tstate.toneMappingExposure = renderer.toneMappingExposure;\n\tstate.outputColorSpace = renderer.outputColorSpace;\n\tstate.renderTarget = renderer.getRenderTarget();\n\tstate.activeCubeFace = renderer.getActiveCubeFace();\n\tstate.activeMipmapLevel = renderer.getActiveMipmapLevel();\n\tstate.renderObjectFunction = renderer.getRenderObjectFunction();\n\tstate.pixelRatio = renderer.getPixelRatio();\n\tstate.mrt = renderer.getMRT();\n\tstate.clearColor = renderer.getClearColor( state.clearColor || new Color() );\n\tstate.clearAlpha = renderer.getClearAlpha();\n\tstate.autoClear = renderer.autoClear;\n\tstate.scissorTest = renderer.getScissorTest();\n\n\treturn state;\n\n}\n\nfunction resetRendererState( renderer, state ) {\n\n\tstate = saveRendererState( renderer, state );\n\n\trenderer.setMRT( null );\n\trenderer.setRenderObjectFunction( null );\n\trenderer.setClearColor( 0x000000, 1 );\n\trenderer.autoClear = true;\n\n\treturn state;\n\n}\n\nfunction restoreRendererState( renderer, state ) {\n\n\trenderer.toneMapping = state.toneMapping;\n\trenderer.toneMappingExposure = state.toneMappingExposure;\n\trenderer.outputColorSpace = state.outputColorSpace;\n\trenderer.setRenderTarget( state.renderTarget, state.activeCubeFace, state.activeMipmapLevel );\n\trenderer.setRenderObjectFunction( state.renderObjectFunction );\n\trenderer.setPixelRatio( state.pixelRatio );\n\trenderer.setMRT( state.mrt );\n\trenderer.setClearColor( state.clearColor, state.clearAlpha );\n\trenderer.autoClear = state.autoClear;\n\trenderer.setScissorTest( state.scissorTest );\n\n}\n\n// renderer and scene state\n\nfunction saveRendererAndSceneState( renderer, scene, state = {} ) {\n\n\tstate = saveRendererState( renderer, state );\n\tstate.background = scene.background;\n\tstate.backgroundNode = scene.backgroundNode;\n\tstate.overrideMaterial = scene.overrideMaterial;\n\n\treturn state;\n\n}\n\nfunction resetRendererAndSceneState( renderer, scene, state ) {\n\n\tstate = saveRendererAndSceneState( renderer, scene, state );\n\n\tscene.background = null;\n\tscene.backgroundNode = null;\n\tscene.overrideMaterial = null;\n\n\treturn state;\n\n}\n\nfunction restoreRendererAndSceneState( renderer, scene, state ) {\n\n\trestoreRendererState( renderer, state );\n\n\tscene.background = state.background;\n\tscene.backgroundNode = state.backgroundNode;\n\tscene.overrideMaterial = state.overrideMaterial;\n\n}\n\nvar PostProcessingUtils = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tresetRendererAndSceneState: resetRendererAndSceneState,\n\tresetRendererState: resetRendererState,\n\trestoreRendererAndSceneState: restoreRendererAndSceneState,\n\trestoreRendererState: restoreRendererState,\n\tsaveRendererAndSceneState: saveRendererAndSceneState,\n\tsaveRendererState: saveRendererState\n});\n\nclass StorageTexture extends Texture {\n\n\tconstructor( width = 1, height = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.image = { width, height };\n\n\t\tthis.magFilter = LinearFilter;\n\t\tthis.minFilter = LinearFilter;\n\n\t\tthis.isStorageTexture = true;\n\n\t}\n\n}\n\nclass IndirectStorageBufferAttribute extends StorageBufferAttribute {\n\n\tconstructor( array, itemSize ) {\n\n\t\tsuper( array, itemSize, Uint32Array );\n\n\t\tthis.isIndirectStorageBufferAttribute = true;\n\n\t}\n\n}\n\nclass NodeLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.textures = {};\n\t\tthis.nodes = {};\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, ( text ) => {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( this.parse( JSON.parse( text ) ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tthis.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparseNodes( json ) {\n\n\t\tconst nodes = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( const nodeJSON of json ) {\n\n\t\t\t\tconst { uuid, type } = nodeJSON;\n\n\t\t\t\tnodes[ uuid ] = this.createNodeFromType( type );\n\t\t\t\tnodes[ uuid ].uuid = uuid;\n\n\t\t\t}\n\n\t\t\tconst meta = { nodes, textures: this.textures };\n\n\t\t\tfor ( const nodeJSON of json ) {\n\n\t\t\t\tnodeJSON.meta = meta;\n\n\t\t\t\tconst node = nodes[ nodeJSON.uuid ];\n\t\t\t\tnode.deserialize( nodeJSON );\n\n\t\t\t\tdelete nodeJSON.meta;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn nodes;\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst node = this.createNodeFromType( json.type );\n\t\tnode.uuid = json.uuid;\n\n\t\tconst nodes = this.parseNodes( json.nodes );\n\t\tconst meta = { nodes, textures: this.textures };\n\n\t\tjson.meta = meta;\n\n\t\tnode.deserialize( json );\n\n\t\tdelete json.meta;\n\n\t\treturn node;\n\n\t}\n\n\tsetTextures( value ) {\n\n\t\tthis.textures = value;\n\t\treturn this;\n\n\t}\n\n\tsetNodes( value ) {\n\n\t\tthis.nodes = value;\n\t\treturn this;\n\n\t}\n\n\tcreateNodeFromType( type ) {\n\n\t\tif ( this.nodes[ type ] === undefined ) {\n\n\t\t\tconsole.error( 'THREE.NodeLoader: Node type not found:', type );\n\t\t\treturn float();\n\n\t\t}\n\n\t\treturn nodeObject( new this.nodes[ type ]() );\n\n\t}\n\n}\n\nclass NodeMaterialLoader extends MaterialLoader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.nodes = {};\n\t\tthis.nodeMaterials = {};\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst material = super.parse( json );\n\n\t\tconst nodes = this.nodes;\n\t\tconst inputNodes = json.inputNodes;\n\n\t\tfor ( const property in inputNodes ) {\n\n\t\t\tconst uuid = inputNodes[ property ];\n\n\t\t\tmaterial[ property ] = nodes[ uuid ];\n\n\t\t}\n\n\t\treturn material;\n\n\t}\n\n\tsetNodes( value ) {\n\n\t\tthis.nodes = value;\n\t\treturn this;\n\n\t}\n\n\tsetNodeMaterials( value ) {\n\n\t\tthis.nodeMaterials = value;\n\t\treturn this;\n\n\t}\n\n\tcreateMaterialFromType( type ) {\n\n\t\tconst materialClass = this.nodeMaterials[ type ];\n\n\t\tif ( materialClass !== undefined ) {\n\n\t\t\treturn new materialClass();\n\n\t\t}\n\n\t\treturn super.createMaterialFromType( type );\n\n\t}\n\n}\n\nclass NodeObjectLoader extends ObjectLoader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.nodes = {};\n\t\tthis.nodeMaterials = {};\n\n\t\tthis._nodesJSON = null;\n\n\t}\n\n\tsetNodes( value ) {\n\n\t\tthis.nodes = value;\n\t\treturn this;\n\n\t}\n\n\tsetNodeMaterials( value ) {\n\n\t\tthis.nodeMaterials = value;\n\t\treturn this;\n\n\t}\n\n\tparse( json, onLoad ) {\n\n\t\tthis._nodesJSON = json.nodes;\n\n\t\tconst data = super.parse( json, onLoad );\n\n\t\tthis._nodesJSON = null; // dispose\n\n\t\treturn data;\n\n\t}\n\n\tparseNodes( json, textures ) {\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tconst loader = new NodeLoader();\n\t\t\tloader.setNodes( this.nodes );\n\t\t\tloader.setTextures( textures );\n\n\t\t\treturn loader.parseNodes( json );\n\n\t\t}\n\n\t\treturn {};\n\n\t}\n\n\tparseMaterials( json, textures ) {\n\n\t\tconst materials = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tconst nodes = this.parseNodes( this._nodesJSON, textures );\n\n\t\t\tconst loader = new NodeMaterialLoader();\n\t\t\tloader.setTextures( textures );\n\t\t\tloader.setNodes( nodes );\n\t\t\tloader.setNodeMaterials( this.nodeMaterials );\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tmaterials[ data.uuid ] = loader.parse( data );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn materials;\n\n\t}\n\n}\n\nclass ClippingGroup extends Group {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isClippingGroup = true;\n\t\tthis.clippingPlanes = [];\n\t\tthis.enabled = true;\n\t\tthis.clipIntersection = false;\n\t\tthis.clipShadows = false;\n\n\t}\n\n}\n\nexport { ACESFilmicToneMapping, AONode, AddEquation, AddOperation, AdditiveBlending, AgXToneMapping, AlphaFormat, AlwaysCompare, AlwaysDepth, AlwaysStencilFunc, AmbientLight, AmbientLightNode, AnalyticLightNode, ArrayElementNode, AssignNode, AttributeNode, BackSide, BasicEnvironmentNode, BasicShadowMap, BatchNode, BoxGeometry, BufferAttribute, BufferAttributeNode, BufferGeometry, BufferNode, BumpMapNode, BundleGroup, BypassNode, ByteType, CacheNode, CineonToneMapping, ClampToEdgeWrapping, ClippingGroup, CodeNode, Color, ColorManagement, ColorSpaceNode, ComputeNode, ConstNode, ContextNode, ConvertNode, CubeCamera, CubeReflectionMapping, CubeRefractionMapping, CubeTexture, CubeTextureNode, CubeUVReflectionMapping, CullFaceBack, CullFaceFront, CullFaceNone, CustomBlending, DataArrayTexture, DataTexture, DecrementStencilOp, DecrementWrapStencilOp, DepthFormat, DepthStencilFormat, DepthTexture, DirectionalLight, DirectionalLightNode, DoubleSide, DstAlphaFactor, DstColorFactor, DynamicDrawUsage, EnvironmentNode, EqualCompare, EqualDepth, EqualStencilFunc, EquirectUVNode, EquirectangularReflectionMapping, EquirectangularRefractionMapping, Euler, EventDispatcher, ExpressionNode, FileLoader, Float16BufferAttribute, Float32BufferAttribute, FloatType, FogExp2Node, FogNode, FogRangeNode, FramebufferTexture, FrontFacingNode, FrontSide, Frustum, FunctionCallNode, FunctionNode, FunctionOverloadingNode, GLSLNodeParser, GreaterCompare, GreaterDepth, GreaterEqualCompare, GreaterEqualDepth, GreaterEqualStencilFunc, GreaterStencilFunc, Group, HalfFloatType, HemisphereLight, HemisphereLightNode, IESSpotLight, IESSpotLightNode, IncrementStencilOp, IncrementWrapStencilOp, IndexNode, IndirectStorageBufferAttribute, InstanceNode, InstancedBufferAttribute, InstancedInterleavedBuffer, InstancedMeshNode, InstancedPointsNodeMaterial, IntType, InterleavedBuffer, InterleavedBufferAttribute, InvertStencilOp, IrradianceNode, JoinNode, KeepStencilOp, LessCompare, LessDepth, LessEqualCompare, LessEqualDepth, LessEqualStencilFunc, LessStencilFunc, LightProbe, LightProbeNode, Lighting, LightingContextNode, LightingModel, LightingNode, LightsNode, Line2NodeMaterial, LineBasicMaterial, LineBasicNodeMaterial, LineDashedMaterial, LineDashedNodeMaterial, LinearFilter, LinearMipMapLinearFilter, LinearMipmapLinearFilter, LinearMipmapNearestFilter, LinearSRGBColorSpace, LinearToneMapping, Loader, LoopNode, LuminanceAlphaFormat, LuminanceFormat, MRTNode, MatcapUVNode, Material, MaterialLoader, MaterialNode, MaterialReferenceNode, MathUtils, Matrix3, Matrix4, MaxEquation, MaxMipLevelNode, Mesh, MeshBasicMaterial, MeshBasicNodeMaterial, MeshLambertMaterial, MeshLambertNodeMaterial, MeshMatcapMaterial, MeshMatcapNodeMaterial, MeshNormalMaterial, MeshNormalNodeMaterial, MeshPhongMaterial, MeshPhongNodeMaterial, MeshPhysicalMaterial, MeshPhysicalNodeMaterial, MeshSSSNodeMaterial, MeshStandardMaterial, MeshStandardNodeMaterial, MeshToonMaterial, MeshToonNodeMaterial, MinEquation, MirroredRepeatWrapping, MixOperation, ModelNode, ModelViewProjectionNode, MorphNode, MultiplyBlending, MultiplyOperation, NearestFilter, NearestMipmapLinearFilter, NearestMipmapNearestFilter, NeutralToneMapping, NeverCompare, NeverDepth, NeverStencilFunc, NoBlending, NoColorSpace, NoToneMapping, Node, NodeAccess, NodeAttribute, NodeBuilder, NodeCache, NodeCode, NodeFrame, NodeFunctionInput, NodeLoader, NodeMaterial, NodeMaterialLoader, NodeMaterialObserver, NodeObjectLoader, NodeShaderStage, NodeType, NodeUniform, NodeUpdateType, NodeUtils, NodeVar, NodeVarying, NormalBlending, NormalMapNode, NotEqualCompare, NotEqualDepth, NotEqualStencilFunc, Object3D, Object3DNode, ObjectLoader, ObjectSpaceNormalMap, OneFactor, OneMinusDstAlphaFactor, OneMinusDstColorFactor, OneMinusSrcAlphaFactor, OneMinusSrcColorFactor, OrthographicCamera, OutputStructNode, PCFShadowMap, PMREMGenerator, PMREMNode, ParameterNode, PassNode, PerspectiveCamera, PhongLightingModel, PhysicalLightingModel, Plane, PointLight, PointLightNode, PointUVNode, PointsMaterial, PointsNodeMaterial, PostProcessing, PostProcessingUtils, PosterizeNode, PropertyNode, QuadMesh, RED_GREEN_RGTC2_Format, RED_RGTC1_Format, REVISION, RGBAFormat, RGBAIntegerFormat, RGBA_ASTC_10x10_Format, RGBA_ASTC_10x5_Format, RGBA_ASTC_10x6_Format, RGBA_ASTC_10x8_Format, RGBA_ASTC_12x10_Format, RGBA_ASTC_12x12_Format, RGBA_ASTC_4x4_Format, RGBA_ASTC_5x4_Format, RGBA_ASTC_5x5_Format, RGBA_ASTC_6x5_Format, RGBA_ASTC_6x6_Format, RGBA_ASTC_8x5_Format, RGBA_ASTC_8x6_Format, RGBA_ASTC_8x8_Format, RGBA_BPTC_Format, RGBA_ETC2_EAC_Format, RGBA_PVRTC_2BPPV1_Format, RGBA_PVRTC_4BPPV1_Format, RGBA_S3TC_DXT1_Format, RGBA_S3TC_DXT3_Format, RGBA_S3TC_DXT5_Format, RGBFormat, RGBIntegerFormat, RGB_ETC1_Format, RGB_ETC2_Format, RGB_PVRTC_2BPPV1_Format, RGB_PVRTC_4BPPV1_Format, RGB_S3TC_DXT1_Format, RGFormat, RGIntegerFormat, RTTNode, RangeNode, RectAreaLight, RectAreaLightNode, RedFormat, RedIntegerFormat, ReferenceNode, ReflectorNode, ReinhardToneMapping, RemapNode, RenderOutputNode, RenderTarget, RendererReferenceNode, RepeatWrapping, ReplaceStencilOp, ReverseSubtractEquation, RotateNode, SIGNED_RED_GREEN_RGTC2_Format, SIGNED_RED_RGTC1_Format, SRGBColorSpace, SRGBTransfer, Scene, SceneNode, ScreenNode, ScriptableNode, ScriptableValueNode, SetNode, ShadowMaterial, ShadowNode, ShadowNodeMaterial, ShortType, SkinningNode, SphereGeometry, SplitNode, SpotLight, SpotLightNode, SpriteMaterial, SpriteNodeMaterial, SpriteSheetUVNode, SrcAlphaFactor, SrcAlphaSaturateFactor, SrcColorFactor, StackNode, StaticDrawUsage, StorageArrayElementNode, StorageBufferAttribute, StorageBufferNode, StorageInstancedBufferAttribute, StorageTexture, StorageTextureNode, SubtractEquation, SubtractiveBlending, TSL, TangentSpaceNormalMap, TempNode, Texture, Texture3DNode, TextureNode, TextureSizeNode, ToneMappingNode, ToonOutlinePassNode, TriplanarTexturesNode, UVMapping, Uint16BufferAttribute, Uint32BufferAttribute, UniformArrayNode, UniformGroupNode, UniformNode, UnsignedByteType, UnsignedInt248Type, UnsignedInt5999Type, UnsignedIntType, UnsignedShort4444Type, UnsignedShort5551Type, UnsignedShortType, UserDataNode, VSMShadowMap, VarNode, VaryingNode, Vector2, Vector3, Vector4, VertexColorNode, ViewportDepthNode, ViewportDepthTextureNode, ViewportSharedTextureNode, ViewportTextureNode, VolumeNodeMaterial, WebGLCoordinateSystem, WebGLCubeRenderTarget, WebGPUCoordinateSystem, WebGPURenderer, ZeroFactor, ZeroStencilOp, createCanvasElement, defaultBuildStages, defaultShaderStages, shaderStages, vectorComponents };\n","import {\n\tBufferAttribute,\n\tBufferGeometry,\n\tFloat32BufferAttribute,\n\tInstancedBufferAttribute,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tTrianglesDrawMode,\n\tVector3,\n} from 'three';\n\nfunction computeMikkTSpaceTangents( geometry, MikkTSpace, negateSign = true ) {\n\n\tif ( ! MikkTSpace || ! MikkTSpace.isReady ) {\n\n\t\tthrow new Error( 'BufferGeometryUtils: Initialized MikkTSpace library required.' );\n\n\t}\n\n\tif ( ! geometry.hasAttribute( 'position' ) || ! geometry.hasAttribute( 'normal' ) || ! geometry.hasAttribute( 'uv' ) ) {\n\n\t\tthrow new Error( 'BufferGeometryUtils: Tangents require \"position\", \"normal\", and \"uv\" attributes.' );\n\n\t}\n\n\tfunction getAttributeArray( attribute ) {\n\n\t\tif ( attribute.normalized || attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tconst dstArray = new Float32Array( attribute.count * attribute.itemSize );\n\n\t\t\tfor ( let i = 0, j = 0; i < attribute.count; i ++ ) {\n\n\t\t\t\tdstArray[ j ++ ] = attribute.getX( i );\n\t\t\t\tdstArray[ j ++ ] = attribute.getY( i );\n\n\t\t\t\tif ( attribute.itemSize > 2 ) {\n\n\t\t\t\t\tdstArray[ j ++ ] = attribute.getZ( i );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn dstArray;\n\n\t\t}\n\n\t\tif ( attribute.array instanceof Float32Array ) {\n\n\t\t\treturn attribute.array;\n\n\t\t}\n\n\t\treturn new Float32Array( attribute.array );\n\n\t}\n\n\t// MikkTSpace algorithm requires non-indexed input.\n\n\tconst _geometry = geometry.index ? geometry.toNonIndexed() : geometry;\n\n\t// Compute vertex tangents.\n\n\tconst tangents = MikkTSpace.generateTangents(\n\n\t\tgetAttributeArray( _geometry.attributes.position ),\n\t\tgetAttributeArray( _geometry.attributes.normal ),\n\t\tgetAttributeArray( _geometry.attributes.uv )\n\n\t);\n\n\t// Texture coordinate convention of glTF differs from the apparent\n\t// default of the MikkTSpace library; .w component must be flipped.\n\n\tif ( negateSign ) {\n\n\t\tfor ( let i = 3; i < tangents.length; i += 4 ) {\n\n\t\t\ttangents[ i ] *= - 1;\n\n\t\t}\n\n\t}\n\n\t//\n\n\t_geometry.setAttribute( 'tangent', new BufferAttribute( tangents, 4 ) );\n\n\tif ( geometry !== _geometry ) {\n\n\t\tgeometry.copy( _geometry );\n\n\t}\n\n\treturn geometry;\n\n}\n\n/**\n * @param  {Array<BufferGeometry>} geometries\n * @param  {Boolean} useGroups\n * @return {BufferGeometry}\n */\nfunction mergeGeometries( geometries, useGroups = false ) {\n\n\tconst isIndexed = geometries[ 0 ].index !== null;\n\n\tconst attributesUsed = new Set( Object.keys( geometries[ 0 ].attributes ) );\n\tconst morphAttributesUsed = new Set( Object.keys( geometries[ 0 ].morphAttributes ) );\n\n\tconst attributes = {};\n\tconst morphAttributes = {};\n\n\tconst morphTargetsRelative = geometries[ 0 ].morphTargetsRelative;\n\n\tconst mergedGeometry = new BufferGeometry();\n\n\tlet offset = 0;\n\n\tfor ( let i = 0; i < geometries.length; ++ i ) {\n\n\t\tconst geometry = geometries[ i ];\n\t\tlet attributesCount = 0;\n\n\t\t// ensure that all geometries are indexed, or none\n\n\t\tif ( isIndexed !== ( geometry.index !== null ) ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// gather attributes, exit early if they're different\n\n\t\tfor ( const name in geometry.attributes ) {\n\n\t\t\tif ( ! attributesUsed.has( name ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. All geometries must have compatible attributes; make sure \"' + name + '\" attribute exists among all geometries, or in none of them.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tif ( attributes[ name ] === undefined ) attributes[ name ] = [];\n\n\t\t\tattributes[ name ].push( geometry.attributes[ name ] );\n\n\t\t\tattributesCount ++;\n\n\t\t}\n\n\t\t// ensure geometries have the same number of attributes\n\n\t\tif ( attributesCount !== attributesUsed.size ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. Make sure all geometries have the same number of attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// gather morph attributes, exit early if they're different\n\n\t\tif ( morphTargetsRelative !== geometry.morphTargetsRelative ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. .morphTargetsRelative must be consistent throughout all geometries.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tfor ( const name in geometry.morphAttributes ) {\n\n\t\t\tif ( ! morphAttributesUsed.has( name ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '.  .morphAttributes must be consistent throughout all geometries.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tif ( morphAttributes[ name ] === undefined ) morphAttributes[ name ] = [];\n\n\t\t\tmorphAttributes[ name ].push( geometry.morphAttributes[ name ] );\n\n\t\t}\n\n\t\tif ( useGroups ) {\n\n\t\t\tlet count;\n\n\t\t\tif ( isIndexed ) {\n\n\t\t\t\tcount = geometry.index.count;\n\n\t\t\t} else if ( geometry.attributes.position !== undefined ) {\n\n\t\t\t\tcount = geometry.attributes.position.count;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. The geometry must have either an index or a position attribute' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tmergedGeometry.addGroup( offset, count, i );\n\n\t\t\toffset += count;\n\n\t\t}\n\n\t}\n\n\t// merge indices\n\n\tif ( isIndexed ) {\n\n\t\tlet indexOffset = 0;\n\t\tconst mergedIndex = [];\n\n\t\tfor ( let i = 0; i < geometries.length; ++ i ) {\n\n\t\t\tconst index = geometries[ i ].index;\n\n\t\t\tfor ( let j = 0; j < index.count; ++ j ) {\n\n\t\t\t\tmergedIndex.push( index.getX( j ) + indexOffset );\n\n\t\t\t}\n\n\t\t\tindexOffset += geometries[ i ].attributes.position.count;\n\n\t\t}\n\n\t\tmergedGeometry.setIndex( mergedIndex );\n\n\t}\n\n\t// merge attributes\n\n\tfor ( const name in attributes ) {\n\n\t\tconst mergedAttribute = mergeAttributes( attributes[ name ] );\n\n\t\tif ( ! mergedAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the ' + name + ' attribute.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tmergedGeometry.setAttribute( name, mergedAttribute );\n\n\t}\n\n\t// merge morph attributes\n\n\tfor ( const name in morphAttributes ) {\n\n\t\tconst numMorphTargets = morphAttributes[ name ][ 0 ].length;\n\n\t\tif ( numMorphTargets === 0 ) break;\n\n\t\tmergedGeometry.morphAttributes = mergedGeometry.morphAttributes || {};\n\t\tmergedGeometry.morphAttributes[ name ] = [];\n\n\t\tfor ( let i = 0; i < numMorphTargets; ++ i ) {\n\n\t\t\tconst morphAttributesToMerge = [];\n\n\t\t\tfor ( let j = 0; j < morphAttributes[ name ].length; ++ j ) {\n\n\t\t\t\tmorphAttributesToMerge.push( morphAttributes[ name ][ j ][ i ] );\n\n\t\t\t}\n\n\t\t\tconst mergedMorphAttribute = mergeAttributes( morphAttributesToMerge );\n\n\t\t\tif ( ! mergedMorphAttribute ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the ' + name + ' morphAttribute.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tmergedGeometry.morphAttributes[ name ].push( mergedMorphAttribute );\n\n\t\t}\n\n\t}\n\n\treturn mergedGeometry;\n\n}\n\n/**\n * @param {Array<BufferAttribute>} attributes\n * @return {BufferAttribute}\n */\nfunction mergeAttributes( attributes ) {\n\n\tlet TypedArray;\n\tlet itemSize;\n\tlet normalized;\n\tlet gpuType = - 1;\n\tlet arrayLength = 0;\n\n\tfor ( let i = 0; i < attributes.length; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\n\t\tif ( TypedArray === undefined ) TypedArray = attribute.array.constructor;\n\t\tif ( TypedArray !== attribute.array.constructor ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( itemSize === undefined ) itemSize = attribute.itemSize;\n\t\tif ( itemSize !== attribute.itemSize ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( normalized === undefined ) normalized = attribute.normalized;\n\t\tif ( normalized !== attribute.normalized ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( gpuType === - 1 ) gpuType = attribute.gpuType;\n\t\tif ( gpuType !== attribute.gpuType ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tarrayLength += attribute.count * itemSize;\n\n\t}\n\n\tconst array = new TypedArray( arrayLength );\n\tconst result = new BufferAttribute( array, itemSize, normalized );\n\tlet offset = 0;\n\n\tfor ( let i = 0; i < attributes.length; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tconst tupleOffset = offset / itemSize;\n\t\t\tfor ( let j = 0, l = attribute.count; j < l; j ++ ) {\n\n\t\t\t\tfor ( let c = 0; c < itemSize; c ++ ) {\n\n\t\t\t\t\tconst value = attribute.getComponent( j, c );\n\t\t\t\t\tresult.setComponent( j + tupleOffset, c, value );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tarray.set( attribute.array, offset );\n\n\t\t}\n\n\t\toffset += attribute.count * itemSize;\n\n\t}\n\n\tif ( gpuType !== undefined ) {\n\n\t\tresult.gpuType = gpuType;\n\n\t}\n\n\treturn result;\n\n}\n\n/**\n * @param {BufferAttribute}\n * @return {BufferAttribute}\n */\nexport function deepCloneAttribute( attribute ) {\n\n\tif ( attribute.isInstancedInterleavedBufferAttribute || attribute.isInterleavedBufferAttribute ) {\n\n\t\treturn deinterleaveAttribute( attribute );\n\n\t}\n\n\tif ( attribute.isInstancedBufferAttribute ) {\n\n\t\treturn new InstancedBufferAttribute().copy( attribute );\n\n\t}\n\n\treturn new BufferAttribute().copy( attribute );\n\n}\n\n/**\n * @param {Array<BufferAttribute>} attributes\n * @return {Array<InterleavedBufferAttribute>}\n */\nfunction interleaveAttributes( attributes ) {\n\n\t// Interleaves the provided attributes into an InterleavedBuffer and returns\n\t// a set of InterleavedBufferAttributes for each attribute\n\tlet TypedArray;\n\tlet arrayLength = 0;\n\tlet stride = 0;\n\n\t// calculate the length and type of the interleavedBuffer\n\tfor ( let i = 0, l = attributes.length; i < l; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\n\t\tif ( TypedArray === undefined ) TypedArray = attribute.array.constructor;\n\t\tif ( TypedArray !== attribute.array.constructor ) {\n\n\t\t\tconsole.error( 'AttributeBuffers of different types cannot be interleaved' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tarrayLength += attribute.array.length;\n\t\tstride += attribute.itemSize;\n\n\t}\n\n\t// Create the set of buffer attributes\n\tconst interleavedBuffer = new InterleavedBuffer( new TypedArray( arrayLength ), stride );\n\tlet offset = 0;\n\tconst res = [];\n\tconst getters = [ 'getX', 'getY', 'getZ', 'getW' ];\n\tconst setters = [ 'setX', 'setY', 'setZ', 'setW' ];\n\n\tfor ( let j = 0, l = attributes.length; j < l; j ++ ) {\n\n\t\tconst attribute = attributes[ j ];\n\t\tconst itemSize = attribute.itemSize;\n\t\tconst count = attribute.count;\n\t\tconst iba = new InterleavedBufferAttribute( interleavedBuffer, itemSize, offset, attribute.normalized );\n\t\tres.push( iba );\n\n\t\toffset += itemSize;\n\n\t\t// Move the data for each attribute into the new interleavedBuffer\n\t\t// at the appropriate offset\n\t\tfor ( let c = 0; c < count; c ++ ) {\n\n\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\tiba[ setters[ k ] ]( c, attribute[ getters[ k ] ]( c ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn res;\n\n}\n\n// returns a new, non-interleaved version of the provided attribute\nexport function deinterleaveAttribute( attribute ) {\n\n\tconst cons = attribute.data.array.constructor;\n\tconst count = attribute.count;\n\tconst itemSize = attribute.itemSize;\n\tconst normalized = attribute.normalized;\n\n\tconst array = new cons( count * itemSize );\n\tlet newAttribute;\n\tif ( attribute.isInstancedInterleavedBufferAttribute ) {\n\n\t\tnewAttribute = new InstancedBufferAttribute( array, itemSize, normalized, attribute.meshPerAttribute );\n\n\t} else {\n\n\t\tnewAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t}\n\n\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\tnewAttribute.setX( i, attribute.getX( i ) );\n\n\t\tif ( itemSize >= 2 ) {\n\n\t\t\tnewAttribute.setY( i, attribute.getY( i ) );\n\n\t\t}\n\n\t\tif ( itemSize >= 3 ) {\n\n\t\t\tnewAttribute.setZ( i, attribute.getZ( i ) );\n\n\t\t}\n\n\t\tif ( itemSize >= 4 ) {\n\n\t\t\tnewAttribute.setW( i, attribute.getW( i ) );\n\n\t\t}\n\n\t}\n\n\treturn newAttribute;\n\n}\n\n// deinterleaves all attributes on the geometry\nexport function deinterleaveGeometry( geometry ) {\n\n\tconst attributes = geometry.attributes;\n\tconst morphTargets = geometry.morphTargets;\n\tconst attrMap = new Map();\n\n\tfor ( const key in attributes ) {\n\n\t\tconst attr = attributes[ key ];\n\t\tif ( attr.isInterleavedBufferAttribute ) {\n\n\t\t\tif ( ! attrMap.has( attr ) ) {\n\n\t\t\t\tattrMap.set( attr, deinterleaveAttribute( attr ) );\n\n\t\t\t}\n\n\t\t\tattributes[ key ] = attrMap.get( attr );\n\n\t\t}\n\n\t}\n\n\tfor ( const key in morphTargets ) {\n\n\t\tconst attr = morphTargets[ key ];\n\t\tif ( attr.isInterleavedBufferAttribute ) {\n\n\t\t\tif ( ! attrMap.has( attr ) ) {\n\n\t\t\t\tattrMap.set( attr, deinterleaveAttribute( attr ) );\n\n\t\t\t}\n\n\t\t\tmorphTargets[ key ] = attrMap.get( attr );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @return {number}\n */\nfunction estimateBytesUsed( geometry ) {\n\n\t// Return the estimated memory used by this geometry in bytes\n\t// Calculate using itemSize, count, and BYTES_PER_ELEMENT to account\n\t// for InterleavedBufferAttributes.\n\tlet mem = 0;\n\tfor ( const name in geometry.attributes ) {\n\n\t\tconst attr = geometry.getAttribute( name );\n\t\tmem += attr.count * attr.itemSize * attr.array.BYTES_PER_ELEMENT;\n\n\t}\n\n\tconst indices = geometry.getIndex();\n\tmem += indices ? indices.count * indices.itemSize * indices.array.BYTES_PER_ELEMENT : 0;\n\treturn mem;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {number} tolerance\n * @return {BufferGeometry}\n */\nfunction mergeVertices( geometry, tolerance = 1e-4 ) {\n\n\ttolerance = Math.max( tolerance, Number.EPSILON );\n\n\t// Generate an index buffer if the geometry doesn't have one, or optimize it\n\t// if it's already available.\n\tconst hashToIndex = {};\n\tconst indices = geometry.getIndex();\n\tconst positions = geometry.getAttribute( 'position' );\n\tconst vertexCount = indices ? indices.count : positions.count;\n\n\t// next value for triangle indices\n\tlet nextIndex = 0;\n\n\t// attributes and new attribute arrays\n\tconst attributeNames = Object.keys( geometry.attributes );\n\tconst tmpAttributes = {};\n\tconst tmpMorphAttributes = {};\n\tconst newIndices = [];\n\tconst getters = [ 'getX', 'getY', 'getZ', 'getW' ];\n\tconst setters = [ 'setX', 'setY', 'setZ', 'setW' ];\n\n\t// Initialize the arrays, allocating space conservatively. Extra\n\t// space will be trimmed in the last step.\n\tfor ( let i = 0, l = attributeNames.length; i < l; i ++ ) {\n\n\t\tconst name = attributeNames[ i ];\n\t\tconst attr = geometry.attributes[ name ];\n\n\t\ttmpAttributes[ name ] = new attr.constructor(\n\t\t\tnew attr.array.constructor( attr.count * attr.itemSize ),\n\t\t\tattr.itemSize,\n\t\t\tattr.normalized\n\t\t);\n\n\t\tconst morphAttributes = geometry.morphAttributes[ name ];\n\t\tif ( morphAttributes ) {\n\n\t\t\tif ( ! tmpMorphAttributes[ name ] ) tmpMorphAttributes[ name ] = [];\n\t\t\tmorphAttributes.forEach( ( morphAttr, i ) => {\n\n\t\t\t\tconst array = new morphAttr.array.constructor( morphAttr.count * morphAttr.itemSize );\n\t\t\t\ttmpMorphAttributes[ name ][ i ] = new morphAttr.constructor( array, morphAttr.itemSize, morphAttr.normalized );\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\t// convert the error tolerance to an amount of decimal places to truncate to\n\tconst halfTolerance = tolerance * 0.5;\n\tconst exponent = Math.log10( 1 / tolerance );\n\tconst hashMultiplier = Math.pow( 10, exponent );\n\tconst hashAdditive = halfTolerance * hashMultiplier;\n\tfor ( let i = 0; i < vertexCount; i ++ ) {\n\n\t\tconst index = indices ? indices.getX( i ) : i;\n\n\t\t// Generate a hash for the vertex attributes at the current index 'i'\n\t\tlet hash = '';\n\t\tfor ( let j = 0, l = attributeNames.length; j < l; j ++ ) {\n\n\t\t\tconst name = attributeNames[ j ];\n\t\t\tconst attribute = geometry.getAttribute( name );\n\t\t\tconst itemSize = attribute.itemSize;\n\n\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\t// double tilde truncates the decimal value\n\t\t\t\thash += `${ ~ ~ ( attribute[ getters[ k ] ]( index ) * hashMultiplier + hashAdditive ) },`;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Add another reference to the vertex if it's already\n\t\t// used by another index\n\t\tif ( hash in hashToIndex ) {\n\n\t\t\tnewIndices.push( hashToIndex[ hash ] );\n\n\t\t} else {\n\n\t\t\t// copy data to the new index in the temporary attributes\n\t\t\tfor ( let j = 0, l = attributeNames.length; j < l; j ++ ) {\n\n\t\t\t\tconst name = attributeNames[ j ];\n\t\t\t\tconst attribute = geometry.getAttribute( name );\n\t\t\t\tconst morphAttributes = geometry.morphAttributes[ name ];\n\t\t\t\tconst itemSize = attribute.itemSize;\n\t\t\t\tconst newArray = tmpAttributes[ name ];\n\t\t\t\tconst newMorphArrays = tmpMorphAttributes[ name ];\n\n\t\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\t\tconst getterFunc = getters[ k ];\n\t\t\t\t\tconst setterFunc = setters[ k ];\n\t\t\t\t\tnewArray[ setterFunc ]( nextIndex, attribute[ getterFunc ]( index ) );\n\n\t\t\t\t\tif ( morphAttributes ) {\n\n\t\t\t\t\t\tfor ( let m = 0, ml = morphAttributes.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\t\tnewMorphArrays[ m ][ setterFunc ]( nextIndex, morphAttributes[ m ][ getterFunc ]( index ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\thashToIndex[ hash ] = nextIndex;\n\t\t\tnewIndices.push( nextIndex );\n\t\t\tnextIndex ++;\n\n\t\t}\n\n\t}\n\n\t// generate result BufferGeometry\n\tconst result = geometry.clone();\n\tfor ( const name in geometry.attributes ) {\n\n\t\tconst tmpAttribute = tmpAttributes[ name ];\n\n\t\tresult.setAttribute( name, new tmpAttribute.constructor(\n\t\t\ttmpAttribute.array.slice( 0, nextIndex * tmpAttribute.itemSize ),\n\t\t\ttmpAttribute.itemSize,\n\t\t\ttmpAttribute.normalized,\n\t\t) );\n\n\t\tif ( ! ( name in tmpMorphAttributes ) ) continue;\n\n\t\tfor ( let j = 0; j < tmpMorphAttributes[ name ].length; j ++ ) {\n\n\t\t\tconst tmpMorphAttribute = tmpMorphAttributes[ name ][ j ];\n\n\t\t\tresult.morphAttributes[ name ][ j ] = new tmpMorphAttribute.constructor(\n\t\t\t\ttmpMorphAttribute.array.slice( 0, nextIndex * tmpMorphAttribute.itemSize ),\n\t\t\t\ttmpMorphAttribute.itemSize,\n\t\t\t\ttmpMorphAttribute.normalized,\n\t\t\t);\n\n\t\t}\n\n\t}\n\n\t// indices\n\n\tresult.setIndex( newIndices );\n\n\treturn result;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {number} drawMode\n * @return {BufferGeometry}\n */\nfunction toTrianglesDrawMode( geometry, drawMode ) {\n\n\tif ( drawMode === TrianglesDrawMode ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles.' );\n\t\treturn geometry;\n\n\t}\n\n\tif ( drawMode === TriangleFanDrawMode || drawMode === TriangleStripDrawMode ) {\n\n\t\tlet index = geometry.getIndex();\n\n\t\t// generate index if not present\n\n\t\tif ( index === null ) {\n\n\t\t\tconst indices = [];\n\n\t\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\t\tif ( position !== undefined ) {\n\n\t\t\t\tfor ( let i = 0; i < position.count; i ++ ) {\n\n\t\t\t\t\tindices.push( i );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setIndex( indices );\n\t\t\t\tindex = geometry.getIndex();\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.' );\n\t\t\t\treturn geometry;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst numberOfTriangles = index.count - 2;\n\t\tconst newIndices = [];\n\n\t\tif ( drawMode === TriangleFanDrawMode ) {\n\n\t\t\t// gl.TRIANGLE_FAN\n\n\t\t\tfor ( let i = 1; i <= numberOfTriangles; i ++ ) {\n\n\t\t\t\tnewIndices.push( index.getX( 0 ) );\n\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// gl.TRIANGLE_STRIP\n\n\t\t\tfor ( let i = 0; i < numberOfTriangles; i ++ ) {\n\n\t\t\t\tif ( i % 2 === 0 ) {\n\n\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( ( newIndices.length / 3 ) !== numberOfTriangles ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.' );\n\n\t\t}\n\n\t\t// build final geometry\n\n\t\tconst newGeometry = geometry.clone();\n\t\tnewGeometry.setIndex( newIndices );\n\t\tnewGeometry.clearGroups();\n\n\t\treturn newGeometry;\n\n\t} else {\n\n\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:', drawMode );\n\t\treturn geometry;\n\n\t}\n\n}\n\n/**\n * Calculates the morphed attributes of a morphed/skinned BufferGeometry.\n * Helpful for Raytracing or Decals.\n * @param {Mesh | Line | Points} object An instance of Mesh, Line or Points.\n * @return {Object} An Object with original position/normal attributes and morphed ones.\n */\nfunction computeMorphedAttributes( object ) {\n\n\tconst _vA = new Vector3();\n\tconst _vB = new Vector3();\n\tconst _vC = new Vector3();\n\n\tconst _tempA = new Vector3();\n\tconst _tempB = new Vector3();\n\tconst _tempC = new Vector3();\n\n\tconst _morphA = new Vector3();\n\tconst _morphB = new Vector3();\n\tconst _morphC = new Vector3();\n\n\tfunction _calculateMorphedAttributeData(\n\t\tobject,\n\t\tattribute,\n\t\tmorphAttribute,\n\t\tmorphTargetsRelative,\n\t\ta,\n\t\tb,\n\t\tc,\n\t\tmodifiedAttributeArray\n\t) {\n\n\t\t_vA.fromBufferAttribute( attribute, a );\n\t\t_vB.fromBufferAttribute( attribute, b );\n\t\t_vC.fromBufferAttribute( attribute, c );\n\n\t\tconst morphInfluences = object.morphTargetInfluences;\n\n\t\tif ( morphAttribute && morphInfluences ) {\n\n\t\t\t_morphA.set( 0, 0, 0 );\n\t\t\t_morphB.set( 0, 0, 0 );\n\t\t\t_morphC.set( 0, 0, 0 );\n\n\t\t\tfor ( let i = 0, il = morphAttribute.length; i < il; i ++ ) {\n\n\t\t\t\tconst influence = morphInfluences[ i ];\n\t\t\t\tconst morph = morphAttribute[ i ];\n\n\t\t\t\tif ( influence === 0 ) continue;\n\n\t\t\t\t_tempA.fromBufferAttribute( morph, a );\n\t\t\t\t_tempB.fromBufferAttribute( morph, b );\n\t\t\t\t_tempC.fromBufferAttribute( morph, c );\n\n\t\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA, influence );\n\t\t\t\t\t_morphB.addScaledVector( _tempB, influence );\n\t\t\t\t\t_morphC.addScaledVector( _tempC, influence );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA.sub( _vA ), influence );\n\t\t\t\t\t_morphB.addScaledVector( _tempB.sub( _vB ), influence );\n\t\t\t\t\t_morphC.addScaledVector( _tempC.sub( _vC ), influence );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_vA.add( _morphA );\n\t\t\t_vB.add( _morphB );\n\t\t\t_vC.add( _morphC );\n\n\t\t}\n\n\t\tif ( object.isSkinnedMesh ) {\n\n\t\t\tobject.applyBoneTransform( a, _vA );\n\t\t\tobject.applyBoneTransform( b, _vB );\n\t\t\tobject.applyBoneTransform( c, _vC );\n\n\t\t}\n\n\t\tmodifiedAttributeArray[ a * 3 + 0 ] = _vA.x;\n\t\tmodifiedAttributeArray[ a * 3 + 1 ] = _vA.y;\n\t\tmodifiedAttributeArray[ a * 3 + 2 ] = _vA.z;\n\t\tmodifiedAttributeArray[ b * 3 + 0 ] = _vB.x;\n\t\tmodifiedAttributeArray[ b * 3 + 1 ] = _vB.y;\n\t\tmodifiedAttributeArray[ b * 3 + 2 ] = _vB.z;\n\t\tmodifiedAttributeArray[ c * 3 + 0 ] = _vC.x;\n\t\tmodifiedAttributeArray[ c * 3 + 1 ] = _vC.y;\n\t\tmodifiedAttributeArray[ c * 3 + 2 ] = _vC.z;\n\n\t}\n\n\tconst geometry = object.geometry;\n\tconst material = object.material;\n\n\tlet a, b, c;\n\tconst index = geometry.index;\n\tconst positionAttribute = geometry.attributes.position;\n\tconst morphPosition = geometry.morphAttributes.position;\n\tconst morphTargetsRelative = geometry.morphTargetsRelative;\n\tconst normalAttribute = geometry.attributes.normal;\n\tconst morphNormal = geometry.morphAttributes.position;\n\n\tconst groups = geometry.groups;\n\tconst drawRange = geometry.drawRange;\n\tlet i, j, il, jl;\n\tlet group;\n\tlet start, end;\n\n\tconst modifiedPosition = new Float32Array( positionAttribute.count * positionAttribute.itemSize );\n\tconst modifiedNormal = new Float32Array( normalAttribute.count * normalAttribute.itemSize );\n\n\tif ( index !== null ) {\n\n\t\t// indexed buffer geometry\n\n\t\tif ( Array.isArray( material ) ) {\n\n\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\tgroup = groups[ i ];\n\n\t\t\t\tstart = Math.max( group.start, drawRange.start );\n\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\ta = index.getX( j );\n\t\t\t\t\tb = index.getX( j + 1 );\n\t\t\t\t\tc = index.getX( j + 2 );\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tpositionAttribute,\n\t\t\t\t\t\tmorphPosition,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedPosition\n\t\t\t\t\t);\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tnormalAttribute,\n\t\t\t\t\t\tmorphNormal,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedNormal\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tstart = Math.max( 0, drawRange.start );\n\t\t\tend = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\ta = index.getX( i );\n\t\t\t\tb = index.getX( i + 1 );\n\t\t\t\tc = index.getX( i + 2 );\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tpositionAttribute,\n\t\t\t\t\tmorphPosition,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedPosition\n\t\t\t\t);\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tnormalAttribute,\n\t\t\t\t\tmorphNormal,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedNormal\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t} else {\n\n\t\t// non-indexed buffer geometry\n\n\t\tif ( Array.isArray( material ) ) {\n\n\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\tgroup = groups[ i ];\n\n\t\t\t\tstart = Math.max( group.start, drawRange.start );\n\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\ta = j;\n\t\t\t\t\tb = j + 1;\n\t\t\t\t\tc = j + 2;\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tpositionAttribute,\n\t\t\t\t\t\tmorphPosition,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedPosition\n\t\t\t\t\t);\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tnormalAttribute,\n\t\t\t\t\t\tmorphNormal,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedNormal\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tstart = Math.max( 0, drawRange.start );\n\t\t\tend = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\ta = i;\n\t\t\t\tb = i + 1;\n\t\t\t\tc = i + 2;\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tpositionAttribute,\n\t\t\t\t\tmorphPosition,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedPosition\n\t\t\t\t);\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tnormalAttribute,\n\t\t\t\t\tmorphNormal,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedNormal\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tconst morphedPositionAttribute = new Float32BufferAttribute( modifiedPosition, 3 );\n\tconst morphedNormalAttribute = new Float32BufferAttribute( modifiedNormal, 3 );\n\n\treturn {\n\n\t\tpositionAttribute: positionAttribute,\n\t\tnormalAttribute: normalAttribute,\n\t\tmorphedPositionAttribute: morphedPositionAttribute,\n\t\tmorphedNormalAttribute: morphedNormalAttribute\n\n\t};\n\n}\n\nfunction mergeGroups( geometry ) {\n\n\tif ( geometry.groups.length === 0 ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge.' );\n\t\treturn geometry;\n\n\t}\n\n\tlet groups = geometry.groups;\n\n\t// sort groups by material index\n\n\tgroups = groups.sort( ( a, b ) => {\n\n\t\tif ( a.materialIndex !== b.materialIndex ) return a.materialIndex - b.materialIndex;\n\n\t\treturn a.start - b.start;\n\n\t} );\n\n\t// create index for non-indexed geometries\n\n\tif ( geometry.getIndex() === null ) {\n\n\t\tconst positionAttribute = geometry.getAttribute( 'position' );\n\t\tconst indices = [];\n\n\t\tfor ( let i = 0; i < positionAttribute.count; i += 3 ) {\n\n\t\t\tindices.push( i, i + 1, i + 2 );\n\n\t\t}\n\n\t\tgeometry.setIndex( indices );\n\n\t}\n\n\t// sort index\n\n\tconst index = geometry.getIndex();\n\n\tconst newIndices = [];\n\n\tfor ( let i = 0; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tconst groupStart = group.start;\n\t\tconst groupLength = groupStart + group.count;\n\n\t\tfor ( let j = groupStart; j < groupLength; j ++ ) {\n\n\t\t\tnewIndices.push( index.getX( j ) );\n\n\t\t}\n\n\t}\n\n\tgeometry.dispose(); // Required to force buffer recreation\n\tgeometry.setIndex( newIndices );\n\n\t// update groups indices\n\n\tlet start = 0;\n\n\tfor ( let i = 0; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tgroup.start = start;\n\t\tstart += group.count;\n\n\t}\n\n\t// merge groups\n\n\tlet currentGroup = groups[ 0 ];\n\n\tgeometry.groups = [ currentGroup ];\n\n\tfor ( let i = 1; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tif ( currentGroup.materialIndex === group.materialIndex ) {\n\n\t\t\tcurrentGroup.count += group.count;\n\n\t\t} else {\n\n\t\t\tcurrentGroup = group;\n\t\t\tgeometry.groups.push( currentGroup );\n\n\t\t}\n\n\t}\n\n\treturn geometry;\n\n}\n\n\n/**\n * Modifies the supplied geometry if it is non-indexed, otherwise creates a new,\n * non-indexed geometry. Returns the geometry with smooth normals everywhere except\n * faces that meet at an angle greater than the crease angle.\n *\n * @param {BufferGeometry} geometry\n * @param {number} [creaseAngle]\n * @return {BufferGeometry}\n */\nfunction toCreasedNormals( geometry, creaseAngle = Math.PI / 3 /* 60 degrees */ ) {\n\n\tconst creaseDot = Math.cos( creaseAngle );\n\tconst hashMultiplier = ( 1 + 1e-10 ) * 1e2;\n\n\t// reusable vectors\n\tconst verts = [ new Vector3(), new Vector3(), new Vector3() ];\n\tconst tempVec1 = new Vector3();\n\tconst tempVec2 = new Vector3();\n\tconst tempNorm = new Vector3();\n\tconst tempNorm2 = new Vector3();\n\n\t// hashes a vector\n\tfunction hashVertex( v ) {\n\n\t\tconst x = ~ ~ ( v.x * hashMultiplier );\n\t\tconst y = ~ ~ ( v.y * hashMultiplier );\n\t\tconst z = ~ ~ ( v.z * hashMultiplier );\n\t\treturn `${x},${y},${z}`;\n\n\t}\n\n\t// BufferGeometry.toNonIndexed() warns if the geometry is non-indexed\n\t// and returns the original geometry\n\tconst resultGeometry = geometry.index ? geometry.toNonIndexed() : geometry;\n\tconst posAttr = resultGeometry.attributes.position;\n\tconst vertexMap = {};\n\n\t// find all the normals shared by commonly located vertices\n\tfor ( let i = 0, l = posAttr.count / 3; i < l; i ++ ) {\n\n\t\tconst i3 = 3 * i;\n\t\tconst a = verts[ 0 ].fromBufferAttribute( posAttr, i3 + 0 );\n\t\tconst b = verts[ 1 ].fromBufferAttribute( posAttr, i3 + 1 );\n\t\tconst c = verts[ 2 ].fromBufferAttribute( posAttr, i3 + 2 );\n\n\t\ttempVec1.subVectors( c, b );\n\t\ttempVec2.subVectors( a, b );\n\n\t\t// add the normal to the map for all vertices\n\t\tconst normal = new Vector3().crossVectors( tempVec1, tempVec2 ).normalize();\n\t\tfor ( let n = 0; n < 3; n ++ ) {\n\n\t\t\tconst vert = verts[ n ];\n\t\t\tconst hash = hashVertex( vert );\n\t\t\tif ( ! ( hash in vertexMap ) ) {\n\n\t\t\t\tvertexMap[ hash ] = [];\n\n\t\t\t}\n\n\t\t\tvertexMap[ hash ].push( normal );\n\n\t\t}\n\n\t}\n\n\t// average normals from all vertices that share a common location if they are within the\n\t// provided crease threshold\n\tconst normalArray = new Float32Array( posAttr.count * 3 );\n\tconst normAttr = new BufferAttribute( normalArray, 3, false );\n\tfor ( let i = 0, l = posAttr.count / 3; i < l; i ++ ) {\n\n\t\t// get the face normal for this vertex\n\t\tconst i3 = 3 * i;\n\t\tconst a = verts[ 0 ].fromBufferAttribute( posAttr, i3 + 0 );\n\t\tconst b = verts[ 1 ].fromBufferAttribute( posAttr, i3 + 1 );\n\t\tconst c = verts[ 2 ].fromBufferAttribute( posAttr, i3 + 2 );\n\n\t\ttempVec1.subVectors( c, b );\n\t\ttempVec2.subVectors( a, b );\n\n\t\ttempNorm.crossVectors( tempVec1, tempVec2 ).normalize();\n\n\t\t// average all normals that meet the threshold and set the normal value\n\t\tfor ( let n = 0; n < 3; n ++ ) {\n\n\t\t\tconst vert = verts[ n ];\n\t\t\tconst hash = hashVertex( vert );\n\t\t\tconst otherNormals = vertexMap[ hash ];\n\t\t\ttempNorm2.set( 0, 0, 0 );\n\n\t\t\tfor ( let k = 0, lk = otherNormals.length; k < lk; k ++ ) {\n\n\t\t\t\tconst otherNorm = otherNormals[ k ];\n\t\t\t\tif ( tempNorm.dot( otherNorm ) > creaseDot ) {\n\n\t\t\t\t\ttempNorm2.add( otherNorm );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttempNorm2.normalize();\n\t\t\tnormAttr.setXYZ( i3 + n, tempNorm2.x, tempNorm2.y, tempNorm2.z );\n\n\t\t}\n\n\t}\n\n\tresultGeometry.setAttribute( 'normal', normAttr );\n\treturn resultGeometry;\n\n}\n\nexport {\n\tcomputeMikkTSpaceTangents,\n\tmergeGeometries,\n\tmergeAttributes,\n\tinterleaveAttributes,\n\testimateBytesUsed,\n\tmergeVertices,\n\ttoTrianglesDrawMode,\n\tcomputeMorphedAttributes,\n\tmergeGroups,\n\ttoCreasedNormals\n};\n","import {\n\tAnimationClip,\n\tBone,\n\tBox3,\n\tBufferAttribute,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tColorManagement,\n\tDirectionalLight,\n\tDoubleSide,\n\tFileLoader,\n\tFrontSide,\n\tGroup,\n\tImageBitmapLoader,\n\tInstancedMesh,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tInterpolant,\n\tInterpolateDiscrete,\n\tInterpolateLinear,\n\tLine,\n\tLineBasicMaterial,\n\tLineLoop,\n\tLineSegments,\n\tLinearFilter,\n\tLinearMipmapLinearFilter,\n\tLinearMipmapNearestFilter,\n\tLinearSRGBColorSpace,\n\tLoader,\n\tLoaderUtils,\n\tMaterial,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tMeshPhysicalMaterial,\n\tMeshStandardMaterial,\n\tMirroredRepeatWrapping,\n\tNearestFilter,\n\tNearestMipmapLinearFilter,\n\tNearestMipmapNearestFilter,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPoints,\n\tPointsMaterial,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSphere,\n\tSpotLight,\n\tTexture,\n\tTextureLoader,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tVector2,\n\tVector3,\n\tVectorKeyframeTrack,\n\tSRGBColorSpace,\n\tInstancedBufferAttribute\n} from 'three';\nimport { toTrianglesDrawMode } from '../utils/BufferGeometryUtils.js';\n\nclass GLTFLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.dracoLoader = null;\n\t\tthis.ktx2Loader = null;\n\t\tthis.meshoptDecoder = null;\n\n\t\tthis.pluginCallbacks = [];\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsClearcoatExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsDispersionExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureBasisUExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureWebPExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureAVIFExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSheenExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsTransmissionExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsVolumeExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsIorExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsEmissiveStrengthExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSpecularExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsIridescenceExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsAnisotropyExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsBumpExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFLightsExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshoptCompression( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshGpuInstancing( parser );\n\n\t\t} );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tlet resourcePath;\n\n\t\tif ( this.resourcePath !== '' ) {\n\n\t\t\tresourcePath = this.resourcePath;\n\n\t\t} else if ( this.path !== '' ) {\n\n\t\t\t// If a base path is set, resources will be relative paths from that plus the relative path of the gltf file\n\t\t\t// Example  path = 'https://my-cnd-server.com/', url = 'assets/models/model.gltf'\n\t\t\t// resourcePath = 'https://my-cnd-server.com/assets/models/'\n\t\t\t// referenced resource 'model.bin' will be loaded from 'https://my-cnd-server.com/assets/models/model.bin'\n\t\t\t// referenced resource '../textures/texture.png' will be loaded from 'https://my-cnd-server.com/assets/textures/texture.png'\n\t\t\tconst relativeUrl = LoaderUtils.extractUrlBase( url );\n\t\t\tresourcePath = LoaderUtils.resolveURL( relativeUrl, this.path );\n\n\t\t} else {\n\n\t\t\tresourcePath = LoaderUtils.extractUrlBase( url );\n\n\t\t}\n\n\t\t// Tells the LoadingManager to track an extra item, which resolves after\n\t\t// the model is fully loaded. This means the count of items loaded will\n\t\t// be incorrect, but ensures manager.onLoad() does not fire early.\n\t\tthis.manager.itemStart( url );\n\n\t\tconst _onError = function ( e ) {\n\n\t\t\tif ( onError ) {\n\n\t\t\t\tonError( e );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( e );\n\n\t\t\t}\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t};\n\n\t\tconst loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tloader.load( url, function ( data ) {\n\n\t\t\ttry {\n\n\t\t\t\tscope.parse( data, resourcePath, function ( gltf ) {\n\n\t\t\t\t\tonLoad( gltf );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, _onError );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\t_onError( e );\n\n\t\t\t}\n\n\t\t}, onProgress, _onError );\n\n\t}\n\n\tsetDRACOLoader( dracoLoader ) {\n\n\t\tthis.dracoLoader = dracoLoader;\n\t\treturn this;\n\n\t}\n\n\tsetKTX2Loader( ktx2Loader ) {\n\n\t\tthis.ktx2Loader = ktx2Loader;\n\t\treturn this;\n\n\t}\n\n\tsetMeshoptDecoder( meshoptDecoder ) {\n\n\t\tthis.meshoptDecoder = meshoptDecoder;\n\t\treturn this;\n\n\t}\n\n\tregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) === - 1 ) {\n\n\t\t\tthis.pluginCallbacks.push( callback );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) !== - 1 ) {\n\n\t\t\tthis.pluginCallbacks.splice( this.pluginCallbacks.indexOf( callback ), 1 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tparse( data, path, onLoad, onError ) {\n\n\t\tlet json;\n\t\tconst extensions = {};\n\t\tconst plugins = {};\n\t\tconst textDecoder = new TextDecoder();\n\n\t\tif ( typeof data === 'string' ) {\n\n\t\t\tjson = JSON.parse( data );\n\n\t\t} else if ( data instanceof ArrayBuffer ) {\n\n\t\t\tconst magic = textDecoder.decode( new Uint8Array( data, 0, 4 ) );\n\n\t\t\tif ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\textensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\n\n\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\tif ( onError ) onError( error );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tjson = JSON.parse( extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content );\n\n\t\t\t} else {\n\n\t\t\t\tjson = JSON.parse( textDecoder.decode( data ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tjson = data;\n\n\t\t}\n\n\t\tif ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\n\n\t\t\tif ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.' ) );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst parser = new GLTFParser( json, {\n\n\t\t\tpath: path || this.resourcePath || '',\n\t\t\tcrossOrigin: this.crossOrigin,\n\t\t\trequestHeader: this.requestHeader,\n\t\t\tmanager: this.manager,\n\t\t\tktx2Loader: this.ktx2Loader,\n\t\t\tmeshoptDecoder: this.meshoptDecoder\n\n\t\t} );\n\n\t\tparser.fileLoader.setRequestHeader( this.requestHeader );\n\n\t\tfor ( let i = 0; i < this.pluginCallbacks.length; i ++ ) {\n\n\t\t\tconst plugin = this.pluginCallbacks[ i ]( parser );\n\n\t\t\tif ( ! plugin.name ) console.error( 'THREE.GLTFLoader: Invalid plugin found: missing name' );\n\n\t\t\tplugins[ plugin.name ] = plugin;\n\n\t\t\t// Workaround to avoid determining as unknown extension\n\t\t\t// in addUnknownExtensionsToUserData().\n\t\t\t// Remove this workaround if we move all the existing\n\t\t\t// extension handlers to plugin system\n\t\t\textensions[ plugin.name ] = true;\n\n\t\t}\n\n\t\tif ( json.extensionsUsed ) {\n\n\t\t\tfor ( let i = 0; i < json.extensionsUsed.length; ++ i ) {\n\n\t\t\t\tconst extensionName = json.extensionsUsed[ i ];\n\t\t\t\tconst extensionsRequired = json.extensionsRequired || [];\n\n\t\t\t\tswitch ( extensionName ) {\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_UNLIT:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsUnlitExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFTextureTransformExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MESH_QUANTIZATION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMeshQuantizationExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( extensionsRequired.indexOf( extensionName ) >= 0 && plugins[ extensionName ] === undefined ) {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tparser.setExtensions( extensions );\n\t\tparser.setPlugins( plugins );\n\t\tparser.parse( onLoad, onError );\n\n\t}\n\n\tparseAsync( data, path ) {\n\n\t\tconst scope = this;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tscope.parse( data, path, resolve, reject );\n\n\t\t} );\n\n\t}\n\n}\n\n/* GLTFREGISTRY */\n\nfunction GLTFRegistry() {\n\n\tlet objects = {};\n\n\treturn\t{\n\n\t\tget: function ( key ) {\n\n\t\t\treturn objects[ key ];\n\n\t\t},\n\n\t\tadd: function ( key, object ) {\n\n\t\t\tobjects[ key ] = object;\n\n\t\t},\n\n\t\tremove: function ( key ) {\n\n\t\t\tdelete objects[ key ];\n\n\t\t},\n\n\t\tremoveAll: function () {\n\n\t\t\tobjects = {};\n\n\t\t}\n\n\t};\n\n}\n\n/*********************************/\n/********** EXTENSIONS ***********/\n/*********************************/\n\nconst EXTENSIONS = {\n\tKHR_BINARY_GLTF: 'KHR_binary_glTF',\n\tKHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n\tKHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n\tKHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n\tKHR_MATERIALS_DISPERSION: 'KHR_materials_dispersion',\n\tKHR_MATERIALS_IOR: 'KHR_materials_ior',\n\tKHR_MATERIALS_SHEEN: 'KHR_materials_sheen',\n\tKHR_MATERIALS_SPECULAR: 'KHR_materials_specular',\n\tKHR_MATERIALS_TRANSMISSION: 'KHR_materials_transmission',\n\tKHR_MATERIALS_IRIDESCENCE: 'KHR_materials_iridescence',\n\tKHR_MATERIALS_ANISOTROPY: 'KHR_materials_anisotropy',\n\tKHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n\tKHR_MATERIALS_VOLUME: 'KHR_materials_volume',\n\tKHR_TEXTURE_BASISU: 'KHR_texture_basisu',\n\tKHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n\tKHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n\tKHR_MATERIALS_EMISSIVE_STRENGTH: 'KHR_materials_emissive_strength',\n\tEXT_MATERIALS_BUMP: 'EXT_materials_bump',\n\tEXT_TEXTURE_WEBP: 'EXT_texture_webp',\n\tEXT_TEXTURE_AVIF: 'EXT_texture_avif',\n\tEXT_MESHOPT_COMPRESSION: 'EXT_meshopt_compression',\n\tEXT_MESH_GPU_INSTANCING: 'EXT_mesh_gpu_instancing'\n};\n\n/**\n * Punctual Lights Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n */\nclass GLTFLightsExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n\t\t// Object3D instance caches\n\t\tthis.cache = { refs: {}, uses: {} };\n\n\t}\n\n\t_markDefs() {\n\n\t\tconst parser = this.parser;\n\t\tconst nodeDefs = this.parser.json.nodes || [];\n\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.extensions\n\t\t\t\t\t&& nodeDef.extensions[ this.name ]\n\t\t\t\t\t&& nodeDef.extensions[ this.name ].light !== undefined ) {\n\n\t\t\t\tparser._addNodeRef( this.cache, nodeDef.extensions[ this.name ].light );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_loadLight( lightIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst cacheKey = 'light:' + lightIndex;\n\t\tlet dependency = parser.cache.get( cacheKey );\n\n\t\tif ( dependency ) return dependency;\n\n\t\tconst json = parser.json;\n\t\tconst extensions = ( json.extensions && json.extensions[ this.name ] ) || {};\n\t\tconst lightDefs = extensions.lights || [];\n\t\tconst lightDef = lightDefs[ lightIndex ];\n\t\tlet lightNode;\n\n\t\tconst color = new Color( 0xffffff );\n\n\t\tif ( lightDef.color !== undefined ) color.setRGB( lightDef.color[ 0 ], lightDef.color[ 1 ], lightDef.color[ 2 ], LinearSRGBColorSpace );\n\n\t\tconst range = lightDef.range !== undefined ? lightDef.range : 0;\n\n\t\tswitch ( lightDef.type ) {\n\n\t\t\tcase 'directional':\n\t\t\t\tlightNode = new DirectionalLight( color );\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tcase 'point':\n\t\t\t\tlightNode = new PointLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\tbreak;\n\n\t\t\tcase 'spot':\n\t\t\t\tlightNode = new SpotLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\t// Handle spotlight properties.\n\t\t\t\tlightDef.spot = lightDef.spot || {};\n\t\t\t\tlightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n\t\t\t\tlightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n\t\t\t\tlightNode.angle = lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unexpected light type: ' + lightDef.type );\n\n\t\t}\n\n\t\t// Some lights (e.g. spot) default to a position other than the origin. Reset the position\n\t\t// here, because node-level parsing will only override position if explicitly specified.\n\t\tlightNode.position.set( 0, 0, 0 );\n\n\t\tlightNode.decay = 2;\n\n\t\tassignExtrasToUserData( lightNode, lightDef );\n\n\t\tif ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\n\n\t\tlightNode.name = parser.createUniqueName( lightDef.name || ( 'light_' + lightIndex ) );\n\n\t\tdependency = Promise.resolve( lightNode );\n\n\t\tparser.cache.add( cacheKey, dependency );\n\n\t\treturn dependency;\n\n\t}\n\n\tgetDependency( type, index ) {\n\n\t\tif ( type !== 'light' ) return;\n\n\t\treturn this._loadLight( index );\n\n\t}\n\n\tcreateNodeAttachment( nodeIndex ) {\n\n\t\tconst self = this;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\t\tconst lightDef = ( nodeDef.extensions && nodeDef.extensions[ this.name ] ) || {};\n\t\tconst lightIndex = lightDef.light;\n\n\t\tif ( lightIndex === undefined ) return null;\n\n\t\treturn this._loadLight( lightIndex ).then( function ( light ) {\n\n\t\t\treturn parser._getNodeRef( self.cache, lightIndex, light );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Unlit Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n */\nclass GLTFMaterialsUnlitExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n\n\t}\n\n\tgetMaterialType() {\n\n\t\treturn MeshBasicMaterial;\n\n\t}\n\n\textendParams( materialParams, materialDef, parser ) {\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness;\n\n\t\tif ( metallicRoughness ) {\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.setRGB( array[ 0 ], array[ 1 ], array[ 2 ], LinearSRGBColorSpace );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture, SRGBColorSpace ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials Emissive Strength Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/blob/5768b3ce0ef32bc39cdf1bef10b948586635ead3/extensions/2.0/Khronos/KHR_materials_emissive_strength/README.md\n */\nclass GLTFMaterialsEmissiveStrengthExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst emissiveStrength = materialDef.extensions[ this.name ].emissiveStrength;\n\n\t\tif ( emissiveStrength !== undefined ) {\n\n\t\t\tmaterialParams.emissiveIntensity = emissiveStrength;\n\n\t\t}\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Clearcoat Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n */\nclass GLTFMaterialsClearcoatExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.clearcoatFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoat = extension.clearcoatFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatMap', extension.clearcoatTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatRoughnessMap', extension.clearcoatRoughnessTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatNormalTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatNormalMap', extension.clearcoatNormalTexture ) );\n\n\t\t\tif ( extension.clearcoatNormalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = extension.clearcoatNormalTexture.scale;\n\n\t\t\t\tmaterialParams.clearcoatNormalScale = new Vector2( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials dispersion Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_dispersion\n */\nclass GLTFMaterialsDispersionExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_DISPERSION;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.dispersion = extension.dispersion !== undefined ? extension.dispersion : 0;\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Iridescence Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_iridescence\n */\nclass GLTFMaterialsIridescenceExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_IRIDESCENCE;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.iridescenceFactor !== undefined ) {\n\n\t\t\tmaterialParams.iridescence = extension.iridescenceFactor;\n\n\t\t}\n\n\t\tif ( extension.iridescenceTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'iridescenceMap', extension.iridescenceTexture ) );\n\n\t\t}\n\n\t\tif ( extension.iridescenceIor !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceIOR = extension.iridescenceIor;\n\n\t\t}\n\n\t\tif ( materialParams.iridescenceThicknessRange === undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange = [ 100, 400 ];\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessMinimum !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange[ 0 ] = extension.iridescenceThicknessMinimum;\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessMaximum !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange[ 1 ] = extension.iridescenceThicknessMaximum;\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'iridescenceThicknessMap', extension.iridescenceThicknessTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Sheen Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_sheen\n */\nclass GLTFMaterialsSheenExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SHEEN;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.sheenColor = new Color( 0, 0, 0 );\n\t\tmaterialParams.sheenRoughness = 0;\n\t\tmaterialParams.sheen = 1;\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.sheenColorFactor !== undefined ) {\n\n\t\t\tconst colorFactor = extension.sheenColorFactor;\n\t\t\tmaterialParams.sheenColor.setRGB( colorFactor[ 0 ], colorFactor[ 1 ], colorFactor[ 2 ], LinearSRGBColorSpace );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.sheenRoughness = extension.sheenRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.sheenColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenColorMap', extension.sheenColorTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenRoughnessMap', extension.sheenRoughnessTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Transmission Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_transmission\n * Draft: https://github.com/KhronosGroup/glTF/pull/1698\n */\nclass GLTFMaterialsTransmissionExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_TRANSMISSION;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.transmissionFactor !== undefined ) {\n\n\t\t\tmaterialParams.transmission = extension.transmissionFactor;\n\n\t\t}\n\n\t\tif ( extension.transmissionTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'transmissionMap', extension.transmissionTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials Volume Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_volume\n */\nclass GLTFMaterialsVolumeExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_VOLUME;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.thickness = extension.thicknessFactor !== undefined ? extension.thicknessFactor : 0;\n\n\t\tif ( extension.thicknessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'thicknessMap', extension.thicknessTexture ) );\n\n\t\t}\n\n\t\tmaterialParams.attenuationDistance = extension.attenuationDistance || Infinity;\n\n\t\tconst colorArray = extension.attenuationColor || [ 1, 1, 1 ];\n\t\tmaterialParams.attenuationColor = new Color().setRGB( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ], LinearSRGBColorSpace );\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials ior Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_ior\n */\nclass GLTFMaterialsIorExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_IOR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.ior = extension.ior !== undefined ? extension.ior : 1.5;\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Materials specular Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_specular\n */\nclass GLTFMaterialsSpecularExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SPECULAR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.specularIntensity = extension.specularFactor !== undefined ? extension.specularFactor : 1.0;\n\n\t\tif ( extension.specularTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularIntensityMap', extension.specularTexture ) );\n\n\t\t}\n\n\t\tconst colorArray = extension.specularColorFactor || [ 1, 1, 1 ];\n\t\tmaterialParams.specularColor = new Color().setRGB( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ], LinearSRGBColorSpace );\n\n\t\tif ( extension.specularColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularColorMap', extension.specularColorTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n\n/**\n * Materials bump Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/EXT_materials_bump\n */\nclass GLTFMaterialsBumpExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_MATERIALS_BUMP;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.bumpScale = extension.bumpFactor !== undefined ? extension.bumpFactor : 1.0;\n\n\t\tif ( extension.bumpTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'bumpMap', extension.bumpTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials anisotropy Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_anisotropy\n */\nclass GLTFMaterialsAnisotropyExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_ANISOTROPY;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.anisotropyStrength !== undefined ) {\n\n\t\t\tmaterialParams.anisotropy = extension.anisotropyStrength;\n\n\t\t}\n\n\t\tif ( extension.anisotropyRotation !== undefined ) {\n\n\t\t\tmaterialParams.anisotropyRotation = extension.anisotropyRotation;\n\n\t\t}\n\n\t\tif ( extension.anisotropyTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'anisotropyMap', extension.anisotropyTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * BasisU Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_basisu\n */\nclass GLTFTextureBasisUExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_BASISU;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ this.name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ this.name ];\n\t\tconst loader = parser.options.ktx2Loader;\n\n\t\tif ( ! loader ) {\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures' );\n\n\t\t\t} else {\n\n\t\t\t\t// Assumes that the extension is optional and that a fallback texture is present\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t}\n\n}\n\n/**\n * WebP Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_webp\n */\nclass GLTFTextureWebPExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_WEBP;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: WebP required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image. Support for lossy images doesn't guarantee support for all\n\t\t\t\t// WebP images, unfortunately.\n\t\t\t\timage.src = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';\n\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * AVIF Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_avif\n */\nclass GLTFTextureAVIFExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_AVIF;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: AVIF required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image.\n\t\t\t\timage.src = 'data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=';\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * meshopt BufferView Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_meshopt_compression\n */\nclass GLTFMeshoptCompression {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESHOPT_COMPRESSION;\n\t\tthis.parser = parser;\n\n\t}\n\n\tloadBufferView( index ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst bufferView = json.bufferViews[ index ];\n\n\t\tif ( bufferView.extensions && bufferView.extensions[ this.name ] ) {\n\n\t\t\tconst extensionDef = bufferView.extensions[ this.name ];\n\n\t\t\tconst buffer = this.parser.getDependency( 'buffer', extensionDef.buffer );\n\t\t\tconst decoder = this.parser.options.meshoptDecoder;\n\n\t\t\tif ( ! decoder || ! decoder.supported ) {\n\n\t\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Assumes that the extension is optional and that fallback buffer data is present\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn buffer.then( function ( res ) {\n\n\t\t\t\tconst byteOffset = extensionDef.byteOffset || 0;\n\t\t\t\tconst byteLength = extensionDef.byteLength || 0;\n\n\t\t\t\tconst count = extensionDef.count;\n\t\t\t\tconst stride = extensionDef.byteStride;\n\n\t\t\t\tconst source = new Uint8Array( res, byteOffset, byteLength );\n\n\t\t\t\tif ( decoder.decodeGltfBufferAsync ) {\n\n\t\t\t\t\treturn decoder.decodeGltfBufferAsync( count, stride, source, extensionDef.mode, extensionDef.filter ).then( function ( res ) {\n\n\t\t\t\t\t\treturn res.buffer;\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Support for MeshoptDecoder 0.18 or earlier, without decodeGltfBufferAsync\n\t\t\t\t\treturn decoder.ready.then( function () {\n\n\t\t\t\t\t\tconst result = new ArrayBuffer( count * stride );\n\t\t\t\t\t\tdecoder.decodeGltfBuffer( new Uint8Array( result ), count, stride, source, extensionDef.mode, extensionDef.filter );\n\t\t\t\t\t\treturn result;\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * GPU Instancing Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_mesh_gpu_instancing\n *\n */\nclass GLTFMeshGpuInstancing {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESH_GPU_INSTANCING;\n\t\tthis.parser = parser;\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( ! nodeDef.extensions || ! nodeDef.extensions[ this.name ] ||\n\t\t\tnodeDef.mesh === undefined ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst meshDef = json.meshes[ nodeDef.mesh ];\n\n\t\t// No Points or Lines + Instancing support yet\n\n\t\tfor ( const primitive of meshDef.primitives ) {\n\n\t\t\tif ( primitive.mode !== WEBGL_CONSTANTS.TRIANGLES &&\n\t\t\t\t primitive.mode !== WEBGL_CONSTANTS.TRIANGLE_STRIP &&\n\t\t\t\t primitive.mode !== WEBGL_CONSTANTS.TRIANGLE_FAN &&\n\t\t\t\t primitive.mode !== undefined ) {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst extensionDef = nodeDef.extensions[ this.name ];\n\t\tconst attributesDef = extensionDef.attributes;\n\n\t\t// @TODO: Can we support InstancedMesh + SkinnedMesh?\n\n\t\tconst pending = [];\n\t\tconst attributes = {};\n\n\t\tfor ( const key in attributesDef ) {\n\n\t\t\tpending.push( this.parser.getDependency( 'accessor', attributesDef[ key ] ).then( accessor => {\n\n\t\t\t\tattributes[ key ] = accessor;\n\t\t\t\treturn attributes[ key ];\n\n\t\t\t} ) );\n\n\t\t}\n\n\t\tif ( pending.length < 1 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tpending.push( this.parser.createNodeMesh( nodeIndex ) );\n\n\t\treturn Promise.all( pending ).then( results => {\n\n\t\t\tconst nodeObject = results.pop();\n\t\t\tconst meshes = nodeObject.isGroup ? nodeObject.children : [ nodeObject ];\n\t\t\tconst count = results[ 0 ].count; // All attribute counts should be same\n\t\t\tconst instancedMeshes = [];\n\n\t\t\tfor ( const mesh of meshes ) {\n\n\t\t\t\t// Temporal variables\n\t\t\t\tconst m = new Matrix4();\n\t\t\t\tconst p = new Vector3();\n\t\t\t\tconst q = new Quaternion();\n\t\t\t\tconst s = new Vector3( 1, 1, 1 );\n\n\t\t\t\tconst instancedMesh = new InstancedMesh( mesh.geometry, mesh.material, count );\n\n\t\t\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\t\t\tif ( attributes.TRANSLATION ) {\n\n\t\t\t\t\t\tp.fromBufferAttribute( attributes.TRANSLATION, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attributes.ROTATION ) {\n\n\t\t\t\t\t\tq.fromBufferAttribute( attributes.ROTATION, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attributes.SCALE ) {\n\n\t\t\t\t\t\ts.fromBufferAttribute( attributes.SCALE, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tinstancedMesh.setMatrixAt( i, m.compose( p, q, s ) );\n\n\t\t\t\t}\n\n\t\t\t\t// Add instance attributes to the geometry, excluding TRS.\n\t\t\t\tfor ( const attributeName in attributes ) {\n\n\t\t\t\t\tif ( attributeName === '_COLOR_0' ) {\n\n\t\t\t\t\t\tconst attr = attributes[ attributeName ];\n\t\t\t\t\t\tinstancedMesh.instanceColor = new InstancedBufferAttribute( attr.array, attr.itemSize, attr.normalized );\n\n\t\t\t\t\t} else if ( attributeName !== 'TRANSLATION' &&\n\t\t\t\t\t\t attributeName !== 'ROTATION' &&\n\t\t\t\t\t\t attributeName !== 'SCALE' ) {\n\n\t\t\t\t\t\tmesh.geometry.setAttribute( attributeName, attributes[ attributeName ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// Just in case\n\t\t\t\tObject3D.prototype.copy.call( instancedMesh, mesh );\n\n\t\t\t\tthis.parser.assignFinalMaterial( instancedMesh );\n\n\t\t\t\tinstancedMeshes.push( instancedMesh );\n\n\t\t\t}\n\n\t\t\tif ( nodeObject.isGroup ) {\n\n\t\t\t\tnodeObject.clear();\n\n\t\t\t\tnodeObject.add( ... instancedMeshes );\n\n\t\t\t\treturn nodeObject;\n\n\t\t\t}\n\n\t\t\treturn instancedMeshes[ 0 ];\n\n\t\t} );\n\n\t}\n\n}\n\n/* BINARY EXTENSION */\nconst BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\nconst BINARY_EXTENSION_HEADER_LENGTH = 12;\nconst BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\n\nclass GLTFBinaryExtension {\n\n\tconstructor( data ) {\n\n\t\tthis.name = EXTENSIONS.KHR_BINARY_GLTF;\n\t\tthis.content = null;\n\t\tthis.body = null;\n\n\t\tconst headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tconst textDecoder = new TextDecoder();\n\n\t\tthis.header = {\n\t\t\tmagic: textDecoder.decode( new Uint8Array( data.slice( 0, 4 ) ) ),\n\t\t\tversion: headerView.getUint32( 4, true ),\n\t\t\tlength: headerView.getUint32( 8, true )\n\t\t};\n\n\t\tif ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\n\n\t\t} else if ( this.header.version < 2.0 ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Legacy binary file detected.' );\n\n\t\t}\n\n\t\tconst chunkContentsLength = this.header.length - BINARY_EXTENSION_HEADER_LENGTH;\n\t\tconst chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tlet chunkIndex = 0;\n\n\t\twhile ( chunkIndex < chunkContentsLength ) {\n\n\t\t\tconst chunkLength = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tconst chunkType = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tif ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\n\n\t\t\t\tconst contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\n\t\t\t\tthis.content = textDecoder.decode( contentArray );\n\n\t\t\t} else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\n\n\t\t\t\tconst byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n\t\t\t\tthis.body = data.slice( byteOffset, byteOffset + chunkLength );\n\n\t\t\t}\n\n\t\t\t// Clients must ignore chunks with unknown types.\n\n\t\t\tchunkIndex += chunkLength;\n\n\t\t}\n\n\t\tif ( this.content === null ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: JSON content not found.' );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * DRACO Mesh Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n */\nclass GLTFDracoMeshCompressionExtension {\n\n\tconstructor( json, dracoLoader ) {\n\n\t\tif ( ! dracoLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n\t\tthis.json = json;\n\t\tthis.dracoLoader = dracoLoader;\n\t\tthis.dracoLoader.preload();\n\n\t}\n\n\tdecodePrimitive( primitive, parser ) {\n\n\t\tconst json = this.json;\n\t\tconst dracoLoader = this.dracoLoader;\n\t\tconst bufferViewIndex = primitive.extensions[ this.name ].bufferView;\n\t\tconst gltfAttributeMap = primitive.extensions[ this.name ].attributes;\n\t\tconst threeAttributeMap = {};\n\t\tconst attributeNormalizedMap = {};\n\t\tconst attributeTypeMap = {};\n\n\t\tfor ( const attributeName in gltfAttributeMap ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tthreeAttributeMap[ threeAttributeName ] = gltfAttributeMap[ attributeName ];\n\n\t\t}\n\n\t\tfor ( const attributeName in primitive.attributes ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tif ( gltfAttributeMap[ attributeName ] !== undefined ) {\n\n\t\t\t\tconst accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\n\t\t\t\tconst componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t\tattributeTypeMap[ threeAttributeName ] = componentType.name;\n\t\t\t\tattributeNormalizedMap[ threeAttributeName ] = accessorDef.normalized === true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tdracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\n\n\t\t\t\t\tfor ( const attributeName in geometry.attributes ) {\n\n\t\t\t\t\t\tconst attribute = geometry.attributes[ attributeName ];\n\t\t\t\t\t\tconst normalized = attributeNormalizedMap[ attributeName ];\n\n\t\t\t\t\t\tif ( normalized !== undefined ) attribute.normalized = normalized;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve( geometry );\n\n\t\t\t\t}, threeAttributeMap, attributeTypeMap, LinearSRGBColorSpace, reject );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Texture Transform Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n */\nclass GLTFTextureTransformExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n\n\t}\n\n\textendTexture( texture, transform ) {\n\n\t\tif ( ( transform.texCoord === undefined || transform.texCoord === texture.channel )\n\t\t\t&& transform.offset === undefined\n\t\t\t&& transform.rotation === undefined\n\t\t\t&& transform.scale === undefined ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21819.\n\t\t\treturn texture;\n\n\t\t}\n\n\t\ttexture = texture.clone();\n\n\t\tif ( transform.texCoord !== undefined ) {\n\n\t\t\ttexture.channel = transform.texCoord;\n\n\t\t}\n\n\t\tif ( transform.offset !== undefined ) {\n\n\t\t\ttexture.offset.fromArray( transform.offset );\n\n\t\t}\n\n\t\tif ( transform.rotation !== undefined ) {\n\n\t\t\ttexture.rotation = transform.rotation;\n\n\t\t}\n\n\t\tif ( transform.scale !== undefined ) {\n\n\t\t\ttexture.repeat.fromArray( transform.scale );\n\n\t\t}\n\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t}\n\n}\n\n/**\n * Mesh Quantization Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n */\nclass GLTFMeshQuantizationExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\n\n\t}\n\n}\n\n/*********************************/\n/********** INTERPOLATION ********/\n/*********************************/\n\n// Spline Interpolation\n// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\nclass GLTFCubicSplineInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// Copies a sample value to the result buffer. See description of glTF\n\t\t// CUBICSPLINE values layout in interpolate_() function below.\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tvalueSize = this.valueSize,\n\t\t\toffset = index * valueSize * 3 + valueSize;\n\n\t\tfor ( let i = 0; i !== valueSize; i ++ ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer;\n\t\tconst values = this.sampleValues;\n\t\tconst stride = this.valueSize;\n\n\t\tconst stride2 = stride * 2;\n\t\tconst stride3 = stride * 3;\n\n\t\tconst td = t1 - t0;\n\n\t\tconst p = ( t - t0 ) / td;\n\t\tconst pp = p * p;\n\t\tconst ppp = pp * p;\n\n\t\tconst offset1 = i1 * stride3;\n\t\tconst offset0 = offset1 - stride3;\n\n\t\tconst s2 = - 2 * ppp + 3 * pp;\n\t\tconst s3 = ppp - pp;\n\t\tconst s0 = 1 - s2;\n\t\tconst s1 = s3 - pp + p;\n\n\t\t// Layout of keyframe output values for CUBICSPLINE animations:\n\t\t//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n\t\tfor ( let i = 0; i !== stride; i ++ ) {\n\n\t\t\tconst p0 = values[ offset0 + i + stride ]; // splineVertex_k\n\t\t\tconst m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\n\t\t\tconst p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\n\t\t\tconst m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n\t\t\tresult[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nconst _q = new Quaternion();\n\nclass GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant {\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = super.interpolate_( i1, t0, t, t1 );\n\n\t\t_q.fromArray( result ).normalize().toArray( result );\n\n\t\treturn result;\n\n\t}\n\n}\n\n\n/*********************************/\n/********** INTERNALS ************/\n/*********************************/\n\n/* CONSTANTS */\n\nconst WEBGL_CONSTANTS = {\n\tFLOAT: 5126,\n\t//FLOAT_MAT2: 35674,\n\tFLOAT_MAT3: 35675,\n\tFLOAT_MAT4: 35676,\n\tFLOAT_VEC2: 35664,\n\tFLOAT_VEC3: 35665,\n\tFLOAT_VEC4: 35666,\n\tLINEAR: 9729,\n\tREPEAT: 10497,\n\tSAMPLER_2D: 35678,\n\tPOINTS: 0,\n\tLINES: 1,\n\tLINE_LOOP: 2,\n\tLINE_STRIP: 3,\n\tTRIANGLES: 4,\n\tTRIANGLE_STRIP: 5,\n\tTRIANGLE_FAN: 6,\n\tUNSIGNED_BYTE: 5121,\n\tUNSIGNED_SHORT: 5123\n};\n\nconst WEBGL_COMPONENT_TYPES = {\n\t5120: Int8Array,\n\t5121: Uint8Array,\n\t5122: Int16Array,\n\t5123: Uint16Array,\n\t5125: Uint32Array,\n\t5126: Float32Array\n};\n\nconst WEBGL_FILTERS = {\n\t9728: NearestFilter,\n\t9729: LinearFilter,\n\t9984: NearestMipmapNearestFilter,\n\t9985: LinearMipmapNearestFilter,\n\t9986: NearestMipmapLinearFilter,\n\t9987: LinearMipmapLinearFilter\n};\n\nconst WEBGL_WRAPPINGS = {\n\t33071: ClampToEdgeWrapping,\n\t33648: MirroredRepeatWrapping,\n\t10497: RepeatWrapping\n};\n\nconst WEBGL_TYPE_SIZES = {\n\t'SCALAR': 1,\n\t'VEC2': 2,\n\t'VEC3': 3,\n\t'VEC4': 4,\n\t'MAT2': 4,\n\t'MAT3': 9,\n\t'MAT4': 16\n};\n\nconst ATTRIBUTES = {\n\tPOSITION: 'position',\n\tNORMAL: 'normal',\n\tTANGENT: 'tangent',\n\tTEXCOORD_0: 'uv',\n\tTEXCOORD_1: 'uv1',\n\tTEXCOORD_2: 'uv2',\n\tTEXCOORD_3: 'uv3',\n\tCOLOR_0: 'color',\n\tWEIGHTS_0: 'skinWeight',\n\tJOINTS_0: 'skinIndex',\n};\n\nconst PATH_PROPERTIES = {\n\tscale: 'scale',\n\ttranslation: 'position',\n\trotation: 'quaternion',\n\tweights: 'morphTargetInfluences'\n};\n\nconst INTERPOLATION = {\n\tCUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n\t\t                        // keyframe track will be initialized with a default interpolation type, then modified.\n\tLINEAR: InterpolateLinear,\n\tSTEP: InterpolateDiscrete\n};\n\nconst ALPHA_MODES = {\n\tOPAQUE: 'OPAQUE',\n\tMASK: 'MASK',\n\tBLEND: 'BLEND'\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n */\nfunction createDefaultMaterial( cache ) {\n\n\tif ( cache[ 'DefaultMaterial' ] === undefined ) {\n\n\t\tcache[ 'DefaultMaterial' ] = new MeshStandardMaterial( {\n\t\t\tcolor: 0xFFFFFF,\n\t\t\temissive: 0x000000,\n\t\t\tmetalness: 1,\n\t\t\troughness: 1,\n\t\t\ttransparent: false,\n\t\t\tdepthTest: true,\n\t\t\tside: FrontSide\n\t\t} );\n\n\t}\n\n\treturn cache[ 'DefaultMaterial' ];\n\n}\n\nfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\n\n\t// Add unknown glTF extensions to an object's userData.\n\n\tfor ( const name in objectDef.extensions ) {\n\n\t\tif ( knownExtensions[ name ] === undefined ) {\n\n\t\t\tobject.userData.gltfExtensions = object.userData.gltfExtensions || {};\n\t\t\tobject.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {Object3D|Material|BufferGeometry} object\n * @param {GLTF.definition} gltfDef\n */\nfunction assignExtrasToUserData( object, gltfDef ) {\n\n\tif ( gltfDef.extras !== undefined ) {\n\n\t\tif ( typeof gltfDef.extras === 'object' ) {\n\n\t\t\tObject.assign( object.userData, gltfDef.extras );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n *\n * @param {BufferGeometry} geometry\n * @param {Array<GLTF.Target>} targets\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addMorphTargets( geometry, targets, parser ) {\n\n\tlet hasMorphPosition = false;\n\tlet hasMorphNormal = false;\n\tlet hasMorphColor = false;\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( target.POSITION !== undefined ) hasMorphPosition = true;\n\t\tif ( target.NORMAL !== undefined ) hasMorphNormal = true;\n\t\tif ( target.COLOR_0 !== undefined ) hasMorphColor = true;\n\n\t\tif ( hasMorphPosition && hasMorphNormal && hasMorphColor ) break;\n\n\t}\n\n\tif ( ! hasMorphPosition && ! hasMorphNormal && ! hasMorphColor ) return Promise.resolve( geometry );\n\n\tconst pendingPositionAccessors = [];\n\tconst pendingNormalAccessors = [];\n\tconst pendingColorAccessors = [];\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( hasMorphPosition ) {\n\n\t\t\tconst pendingAccessor = target.POSITION !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.POSITION )\n\t\t\t\t: geometry.attributes.position;\n\n\t\t\tpendingPositionAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphNormal ) {\n\n\t\t\tconst pendingAccessor = target.NORMAL !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.NORMAL )\n\t\t\t\t: geometry.attributes.normal;\n\n\t\t\tpendingNormalAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphColor ) {\n\n\t\t\tconst pendingAccessor = target.COLOR_0 !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.COLOR_0 )\n\t\t\t\t: geometry.attributes.color;\n\n\t\t\tpendingColorAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t}\n\n\treturn Promise.all( [\n\t\tPromise.all( pendingPositionAccessors ),\n\t\tPromise.all( pendingNormalAccessors ),\n\t\tPromise.all( pendingColorAccessors )\n\t] ).then( function ( accessors ) {\n\n\t\tconst morphPositions = accessors[ 0 ];\n\t\tconst morphNormals = accessors[ 1 ];\n\t\tconst morphColors = accessors[ 2 ];\n\n\t\tif ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\n\t\tif ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\n\t\tif ( hasMorphColor ) geometry.morphAttributes.color = morphColors;\n\t\tgeometry.morphTargetsRelative = true;\n\n\t\treturn geometry;\n\n\t} );\n\n}\n\n/**\n * @param {Mesh} mesh\n * @param {GLTF.Mesh} meshDef\n */\nfunction updateMorphTargets( mesh, meshDef ) {\n\n\tmesh.updateMorphTargets();\n\n\tif ( meshDef.weights !== undefined ) {\n\n\t\tfor ( let i = 0, il = meshDef.weights.length; i < il; i ++ ) {\n\n\t\t\tmesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\n\n\t\t}\n\n\t}\n\n\t// .extras has user-defined data, so check that .extras.targetNames is an array.\n\tif ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\n\n\t\tconst targetNames = meshDef.extras.targetNames;\n\n\t\tif ( mesh.morphTargetInfluences.length === targetNames.length ) {\n\n\t\t\tmesh.morphTargetDictionary = {};\n\n\t\t\tfor ( let i = 0, il = targetNames.length; i < il; i ++ ) {\n\n\t\t\t\tmesh.morphTargetDictionary[ targetNames[ i ] ] = i;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\n\n\t\t}\n\n\t}\n\n}\n\nfunction createPrimitiveKey( primitiveDef ) {\n\n\tlet geometryKey;\n\n\tconst dracoExtension = primitiveDef.extensions && primitiveDef.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ];\n\n\tif ( dracoExtension ) {\n\n\t\tgeometryKey = 'draco:' + dracoExtension.bufferView\n\t\t\t\t+ ':' + dracoExtension.indices\n\t\t\t\t+ ':' + createAttributesKey( dracoExtension.attributes );\n\n\t} else {\n\n\t\tgeometryKey = primitiveDef.indices + ':' + createAttributesKey( primitiveDef.attributes ) + ':' + primitiveDef.mode;\n\n\t}\n\n\tif ( primitiveDef.targets !== undefined ) {\n\n\t\tfor ( let i = 0, il = primitiveDef.targets.length; i < il; i ++ ) {\n\n\t\t\tgeometryKey += ':' + createAttributesKey( primitiveDef.targets[ i ] );\n\n\t\t}\n\n\t}\n\n\treturn geometryKey;\n\n}\n\nfunction createAttributesKey( attributes ) {\n\n\tlet attributesKey = '';\n\n\tconst keys = Object.keys( attributes ).sort();\n\n\tfor ( let i = 0, il = keys.length; i < il; i ++ ) {\n\n\t\tattributesKey += keys[ i ] + ':' + attributes[ keys[ i ] ] + ';';\n\n\t}\n\n\treturn attributesKey;\n\n}\n\nfunction getNormalizedComponentScale( constructor ) {\n\n\t// Reference:\n\t// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization#encoding-quantized-data\n\n\tswitch ( constructor ) {\n\n\t\tcase Int8Array:\n\t\t\treturn 1 / 127;\n\n\t\tcase Uint8Array:\n\t\t\treturn 1 / 255;\n\n\t\tcase Int16Array:\n\t\t\treturn 1 / 32767;\n\n\t\tcase Uint16Array:\n\t\t\treturn 1 / 65535;\n\n\t\tdefault:\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported normalized accessor component type.' );\n\n\t}\n\n}\n\nfunction getImageURIMimeType( uri ) {\n\n\tif ( uri.search( /\\.jpe?g($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/jpeg/ ) === 0 ) return 'image/jpeg';\n\tif ( uri.search( /\\.webp($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/webp/ ) === 0 ) return 'image/webp';\n\tif ( uri.search( /\\.ktx2($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/ktx2/ ) === 0 ) return 'image/ktx2';\n\n\treturn 'image/png';\n\n}\n\nconst _identityMatrix = new Matrix4();\n\n/* GLTF PARSER */\n\nclass GLTFParser {\n\n\tconstructor( json = {}, options = {} ) {\n\n\t\tthis.json = json;\n\t\tthis.extensions = {};\n\t\tthis.plugins = {};\n\t\tthis.options = options;\n\n\t\t// loader object cache\n\t\tthis.cache = new GLTFRegistry();\n\n\t\t// associations between Three.js objects and glTF elements\n\t\tthis.associations = new Map();\n\n\t\t// BufferGeometry caching\n\t\tthis.primitiveCache = {};\n\n\t\t// Node cache\n\t\tthis.nodeCache = {};\n\n\t\t// Object3D instance caches\n\t\tthis.meshCache = { refs: {}, uses: {} };\n\t\tthis.cameraCache = { refs: {}, uses: {} };\n\t\tthis.lightCache = { refs: {}, uses: {} };\n\n\t\tthis.sourceCache = {};\n\t\tthis.textureCache = {};\n\n\t\t// Track node names, to ensure no duplicates\n\t\tthis.nodeNamesUsed = {};\n\n\t\t// Use an ImageBitmapLoader if imageBitmaps are supported. Moves much of the\n\t\t// expensive work of uploading a texture to the GPU off the main thread.\n\n\t\tlet isSafari = false;\n\t\tlet safariVersion = - 1;\n\t\tlet isFirefox = false;\n\t\tlet firefoxVersion = - 1;\n\n\t\tif ( typeof navigator !== 'undefined' ) {\n\n\t\t\tconst userAgent = navigator.userAgent;\n\n\t\t\tisSafari = /^((?!chrome|android).)*safari/i.test( userAgent ) === true;\n\t\t\tconst safariMatch = userAgent.match( /Version\\/(\\d+)/ );\n\t\t\tsafariVersion = isSafari && safariMatch ? parseInt( safariMatch[ 1 ], 10 ) : - 1;\n\n\t\t\tisFirefox = userAgent.indexOf( 'Firefox' ) > - 1;\n\t\t\tfirefoxVersion = isFirefox ? userAgent.match( /Firefox\\/([0-9]+)\\./ )[ 1 ] : - 1;\n\n\t\t}\n\n\t\tif ( typeof createImageBitmap === 'undefined' || ( isSafari && safariVersion < 17 ) || ( isFirefox && firefoxVersion < 98 ) ) {\n\n\t\t\tthis.textureLoader = new TextureLoader( this.options.manager );\n\n\t\t} else {\n\n\t\t\tthis.textureLoader = new ImageBitmapLoader( this.options.manager );\n\n\t\t}\n\n\t\tthis.textureLoader.setCrossOrigin( this.options.crossOrigin );\n\t\tthis.textureLoader.setRequestHeader( this.options.requestHeader );\n\n\t\tthis.fileLoader = new FileLoader( this.options.manager );\n\t\tthis.fileLoader.setResponseType( 'arraybuffer' );\n\n\t\tif ( this.options.crossOrigin === 'use-credentials' ) {\n\n\t\t\tthis.fileLoader.setWithCredentials( true );\n\n\t\t}\n\n\t}\n\n\tsetExtensions( extensions ) {\n\n\t\tthis.extensions = extensions;\n\n\t}\n\n\tsetPlugins( plugins ) {\n\n\t\tthis.plugins = plugins;\n\n\t}\n\n\tparse( onLoad, onError ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\t// Clear the loader cache\n\t\tthis.cache.removeAll();\n\t\tthis.nodeCache = {};\n\n\t\t// Mark the special nodes/meshes in json for efficient parse\n\t\tthis._invokeAll( function ( ext ) {\n\n\t\t\treturn ext._markDefs && ext._markDefs();\n\n\t\t} );\n\n\t\tPromise.all( this._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.beforeRoot && ext.beforeRoot();\n\n\t\t} ) ).then( function () {\n\n\t\t\treturn Promise.all( [\n\n\t\t\t\tparser.getDependencies( 'scene' ),\n\t\t\t\tparser.getDependencies( 'animation' ),\n\t\t\t\tparser.getDependencies( 'camera' ),\n\n\t\t\t] );\n\n\t\t} ).then( function ( dependencies ) {\n\n\t\t\tconst result = {\n\t\t\t\tscene: dependencies[ 0 ][ json.scene || 0 ],\n\t\t\t\tscenes: dependencies[ 0 ],\n\t\t\t\tanimations: dependencies[ 1 ],\n\t\t\t\tcameras: dependencies[ 2 ],\n\t\t\t\tasset: json.asset,\n\t\t\t\tparser: parser,\n\t\t\t\tuserData: {}\n\t\t\t};\n\n\t\t\taddUnknownExtensionsToUserData( extensions, result, json );\n\n\t\t\tassignExtrasToUserData( result, json );\n\n\t\t\treturn Promise.all( parser._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.afterRoot && ext.afterRoot( result );\n\n\t\t\t} ) ).then( function () {\n\n\t\t\t\tfor ( const scene of result.scenes ) {\n\n\t\t\t\t\tscene.updateMatrixWorld();\n\n\t\t\t\t}\n\n\t\t\t\tonLoad( result );\n\n\t\t\t} );\n\n\t\t} ).catch( onError );\n\n\t}\n\n\t/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */\n\t_markDefs() {\n\n\t\tconst nodeDefs = this.json.nodes || [];\n\t\tconst skinDefs = this.json.skins || [];\n\t\tconst meshDefs = this.json.meshes || [];\n\n\t\t// Nothing in the node definition indicates whether it is a Bone or an\n\t\t// Object3D. Use the skins' joint references to mark bones.\n\t\tfor ( let skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\n\n\t\t\tconst joints = skinDefs[ skinIndex ].joints;\n\n\t\t\tfor ( let i = 0, il = joints.length; i < il; i ++ ) {\n\n\t\t\t\tnodeDefs[ joints[ i ] ].isBone = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Iterate over all nodes, marking references to shared resources,\n\t\t// as well as skeleton joints.\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.meshCache, nodeDef.mesh );\n\n\t\t\t\t// Nothing in the mesh definition indicates whether it is\n\t\t\t\t// a SkinnedMesh or Mesh. Use the node's mesh reference\n\t\t\t\t// to mark SkinnedMesh if node has skin.\n\t\t\t\tif ( nodeDef.skin !== undefined ) {\n\n\t\t\t\t\tmeshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.cameraCache, nodeDef.camera );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Counts references to shared node / Object3D resources. These resources\n\t * can be reused, or \"instantiated\", at multiple nodes in the scene\n\t * hierarchy. Mesh, Camera, and Light instances are instantiated and must\n\t * be marked. Non-scenegraph resources (like Materials, Geometries, and\n\t * Textures) can be reused directly and are not marked here.\n\t *\n\t * Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t */\n\t_addNodeRef( cache, index ) {\n\n\t\tif ( index === undefined ) return;\n\n\t\tif ( cache.refs[ index ] === undefined ) {\n\n\t\t\tcache.refs[ index ] = cache.uses[ index ] = 0;\n\n\t\t}\n\n\t\tcache.refs[ index ] ++;\n\n\t}\n\n\t/** Returns a reference to a shared resource, cloning it if necessary. */\n\t_getNodeRef( cache, index, object ) {\n\n\t\tif ( cache.refs[ index ] <= 1 ) return object;\n\n\t\tconst ref = object.clone();\n\n\t\t// Propagates mappings to the cloned object, prevents mappings on the\n\t\t// original object from being lost.\n\t\tconst updateMappings = ( original, clone ) => {\n\n\t\t\tconst mappings = this.associations.get( original );\n\t\t\tif ( mappings != null ) {\n\n\t\t\t\tthis.associations.set( clone, mappings );\n\n\t\t\t}\n\n\t\t\tfor ( const [ i, child ] of original.children.entries() ) {\n\n\t\t\t\tupdateMappings( child, clone.children[ i ] );\n\n\t\t\t}\n\n\t\t};\n\n\t\tupdateMappings( object, ref );\n\n\t\tref.name += '_instance_' + ( cache.uses[ index ] ++ );\n\n\t\treturn ref;\n\n\t}\n\n\t_invokeOne( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.push( this );\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) return result;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t_invokeAll( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.unshift( this );\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) pending.push( result );\n\n\t\t}\n\n\t\treturn pending;\n\n\t}\n\n\t/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n\t */\n\tgetDependency( type, index ) {\n\n\t\tconst cacheKey = type + ':' + index;\n\t\tlet dependency = this.cache.get( cacheKey );\n\n\t\tif ( ! dependency ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'scene':\n\t\t\t\t\tdependency = this.loadScene( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'node':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadNode && ext.loadNode( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mesh':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMesh && ext.loadMesh( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'accessor':\n\t\t\t\t\tdependency = this.loadAccessor( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bufferView':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadBufferView && ext.loadBufferView( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdependency = this.loadBuffer( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'material':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMaterial && ext.loadMaterial( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'texture':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadTexture && ext.loadTexture( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'skin':\n\t\t\t\t\tdependency = this.loadSkin( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'animation':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadAnimation && ext.loadAnimation( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'camera':\n\t\t\t\t\tdependency = this.loadCamera( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext != this && ext.getDependency && ext.getDependency( type, index );\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tif ( ! dependency ) {\n\n\t\t\t\t\t\tthrow new Error( 'Unknown type: ' + type );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tthis.cache.add( cacheKey, dependency );\n\n\t\t}\n\n\t\treturn dependency;\n\n\t}\n\n\t/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */\n\tgetDependencies( type ) {\n\n\t\tlet dependencies = this.cache.get( type );\n\n\t\tif ( ! dependencies ) {\n\n\t\t\tconst parser = this;\n\t\t\tconst defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\n\n\t\t\tdependencies = Promise.all( defs.map( function ( def, index ) {\n\n\t\t\t\treturn parser.getDependency( type, index );\n\n\t\t\t} ) );\n\n\t\t\tthis.cache.add( type, dependencies );\n\n\t\t}\n\n\t\treturn dependencies;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBuffer( bufferIndex ) {\n\n\t\tconst bufferDef = this.json.buffers[ bufferIndex ];\n\t\tconst loader = this.fileLoader;\n\n\t\tif ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\n\n\t\t}\n\n\t\t// If present, GLB container is required to be the first buffer.\n\t\tif ( bufferDef.uri === undefined && bufferIndex === 0 ) {\n\n\t\t\treturn Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\n\n\t\t}\n\n\t\tconst options = this.options;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tloader.load( LoaderUtils.resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\n\n\t\t\t\treject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBufferView( bufferViewIndex ) {\n\n\t\tconst bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\n\n\t\treturn this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\n\n\t\t\tconst byteLength = bufferViewDef.byteLength || 0;\n\t\t\tconst byteOffset = bufferViewDef.byteOffset || 0;\n\t\t\treturn buffer.slice( byteOffset, byteOffset + byteLength );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n\t */\n\tloadAccessor( accessorIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst accessorDef = this.json.accessors[ accessorIndex ];\n\n\t\tif ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\t\t\tconst normalized = accessorDef.normalized === true;\n\n\t\t\tconst array = new TypedArray( accessorDef.count * itemSize );\n\t\t\treturn Promise.resolve( new BufferAttribute( array, itemSize, normalized ) );\n\n\t\t}\n\n\t\tconst pendingBufferViews = [];\n\n\t\tif ( accessorDef.bufferView !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\n\n\t\t} else {\n\n\t\t\tpendingBufferViews.push( null );\n\n\t\t}\n\n\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\n\n\t\t}\n\n\t\treturn Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\n\n\t\t\tconst bufferView = bufferViews[ 0 ];\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n\t\t\tconst elementBytes = TypedArray.BYTES_PER_ELEMENT;\n\t\t\tconst itemBytes = elementBytes * itemSize;\n\t\t\tconst byteOffset = accessorDef.byteOffset || 0;\n\t\t\tconst byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\n\t\t\tconst normalized = accessorDef.normalized === true;\n\t\t\tlet array, bufferAttribute;\n\n\t\t\t// The buffer is not interleaved if the stride is the item size in bytes.\n\t\t\tif ( byteStride && byteStride !== itemBytes ) {\n\n\t\t\t\t// Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n\t\t\t\t// This makes sure that IBA.count reflects accessor.count properly\n\t\t\t\tconst ibSlice = Math.floor( byteOffset / byteStride );\n\t\t\t\tconst ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType + ':' + ibSlice + ':' + accessorDef.count;\n\t\t\t\tlet ib = parser.cache.get( ibCacheKey );\n\n\t\t\t\tif ( ! ib ) {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, ibSlice * byteStride, accessorDef.count * byteStride / elementBytes );\n\n\t\t\t\t\t// Integer parameters to IB/IBA are in array elements, not bytes.\n\t\t\t\t\tib = new InterleavedBuffer( array, byteStride / elementBytes );\n\n\t\t\t\t\tparser.cache.add( ibCacheKey, ib );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( ib, itemSize, ( byteOffset % byteStride ) / elementBytes, normalized );\n\n\t\t\t} else {\n\n\t\t\t\tif ( bufferView === null ) {\n\n\t\t\t\t\tarray = new TypedArray( accessorDef.count * itemSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t\t\t}\n\n\t\t\t// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n\t\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\t\tconst itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n\t\t\t\tconst TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\n\n\t\t\t\tconst byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n\t\t\t\tconst byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n\t\t\t\tconst sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\n\t\t\t\tconst sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\n\n\t\t\t\tif ( bufferView !== null ) {\n\n\t\t\t\t\t// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n\t\t\t\t\tbufferAttribute = new BufferAttribute( bufferAttribute.array.slice(), bufferAttribute.itemSize, bufferAttribute.normalized );\n\n\t\t\t\t}\n\n\t\t\t\t// Ignore normalized since we copy from sparse\n\t\t\t\tbufferAttribute.normalized = false;\n\n\t\t\t\tfor ( let i = 0, il = sparseIndices.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst index = sparseIndices[ i ];\n\n\t\t\t\t\tbufferAttribute.setX( index, sparseValues[ i * itemSize ] );\n\t\t\t\t\tif ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\n\t\t\t\t\tif ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\n\t\t\t\t\tif ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\n\t\t\t\t\tif ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute.normalized = normalized;\n\n\t\t\t}\n\n\t\t\treturn bufferAttribute;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture|null>}\n\t */\n\tloadTexture( textureIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst sourceIndex = textureDef.source;\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tlet loader = this.textureLoader;\n\n\t\tif ( sourceDef.uri ) {\n\n\t\t\tconst handler = options.manager.getHandler( sourceDef.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.loadTextureImage( textureIndex, sourceIndex, loader );\n\n\t}\n\n\tloadTextureImage( textureIndex, sourceIndex, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tconst cacheKey = ( sourceDef.uri || sourceDef.bufferView ) + ':' + textureDef.sampler;\n\n\t\tif ( this.textureCache[ cacheKey ] ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21559.\n\t\t\treturn this.textureCache[ cacheKey ];\n\n\t\t}\n\n\t\tconst promise = this.loadImageSource( sourceIndex, loader ).then( function ( texture ) {\n\n\t\t\ttexture.flipY = false;\n\n\t\t\ttexture.name = textureDef.name || sourceDef.name || '';\n\n\t\t\tif ( texture.name === '' && typeof sourceDef.uri === 'string' && sourceDef.uri.startsWith( 'data:image/' ) === false ) {\n\n\t\t\t\ttexture.name = sourceDef.uri;\n\n\t\t\t}\n\n\t\t\tconst samplers = json.samplers || {};\n\t\t\tconst sampler = samplers[ textureDef.sampler ] || {};\n\n\t\t\ttexture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || LinearFilter;\n\t\t\ttexture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || LinearMipmapLinearFilter;\n\t\t\ttexture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || RepeatWrapping;\n\t\t\ttexture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || RepeatWrapping;\n\t\t\ttexture.generateMipmaps = ! texture.isCompressedTexture && texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter;\n\n\t\t\tparser.associations.set( texture, { textures: textureIndex } );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function () {\n\n\t\t\treturn null;\n\n\t\t} );\n\n\t\tthis.textureCache[ cacheKey ] = promise;\n\n\t\treturn promise;\n\n\t}\n\n\tloadImageSource( sourceIndex, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\n\t\tif ( this.sourceCache[ sourceIndex ] !== undefined ) {\n\n\t\t\treturn this.sourceCache[ sourceIndex ].then( ( texture ) => texture.clone() );\n\n\t\t}\n\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tconst URL = self.URL || self.webkitURL;\n\n\t\tlet sourceURI = sourceDef.uri || '';\n\t\tlet isObjectURL = false;\n\n\t\tif ( sourceDef.bufferView !== undefined ) {\n\n\t\t\t// Load binary image data from bufferView, if provided.\n\n\t\t\tsourceURI = parser.getDependency( 'bufferView', sourceDef.bufferView ).then( function ( bufferView ) {\n\n\t\t\t\tisObjectURL = true;\n\t\t\t\tconst blob = new Blob( [ bufferView ], { type: sourceDef.mimeType } );\n\t\t\t\tsourceURI = URL.createObjectURL( blob );\n\t\t\t\treturn sourceURI;\n\n\t\t\t} );\n\n\t\t} else if ( sourceDef.uri === undefined ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Image ' + sourceIndex + ' is missing URI and bufferView' );\n\n\t\t}\n\n\t\tconst promise = Promise.resolve( sourceURI ).then( function ( sourceURI ) {\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tlet onLoad = resolve;\n\n\t\t\t\tif ( loader.isImageBitmapLoader === true ) {\n\n\t\t\t\t\tonLoad = function ( imageBitmap ) {\n\n\t\t\t\t\t\tconst texture = new Texture( imageBitmap );\n\t\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\t\tresolve( texture );\n\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t\tloader.load( LoaderUtils.resolveURL( sourceURI, options.path ), onLoad, undefined, reject );\n\n\t\t\t} );\n\n\t\t} ).then( function ( texture ) {\n\n\t\t\t// Clean up resources and configure Texture.\n\n\t\t\tif ( isObjectURL === true ) {\n\n\t\t\t\tURL.revokeObjectURL( sourceURI );\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( texture, sourceDef );\n\n\t\t\ttexture.userData.mimeType = sourceDef.mimeType || getImageURIMimeType( sourceDef.uri );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function ( error ) {\n\n\t\t\tconsole.error( 'THREE.GLTFLoader: Couldn\\'t load texture', sourceURI );\n\t\t\tthrow error;\n\n\t\t} );\n\n\t\tthis.sourceCache[ sourceIndex ] = promise;\n\t\treturn promise;\n\n\t}\n\n\t/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @return {Promise<Texture>}\n\t */\n\tassignTexture( materialParams, mapName, mapDef, colorSpace ) {\n\n\t\tconst parser = this;\n\n\t\treturn this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\n\n\t\t\tif ( ! texture ) return null;\n\n\t\t\tif ( mapDef.texCoord !== undefined && mapDef.texCoord > 0 ) {\n\n\t\t\t\ttexture = texture.clone();\n\t\t\t\ttexture.channel = mapDef.texCoord;\n\n\t\t\t}\n\n\t\t\tif ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\n\n\t\t\t\tconst transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\n\n\t\t\t\tif ( transform ) {\n\n\t\t\t\t\tconst gltfReference = parser.associations.get( texture );\n\t\t\t\t\ttexture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\n\t\t\t\t\tparser.associations.set( texture, gltfReference );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( colorSpace !== undefined ) {\n\n\t\t\t\ttexture.colorSpace = colorSpace;\n\n\t\t\t}\n\n\t\t\tmaterialParams[ mapName ] = texture;\n\n\t\t\treturn texture;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Assigns final material to a Mesh, Line, or Points instance. The instance\n\t * already has a material (generated from the glTF material options alone)\n\t * but reuse of the same glTF material may require multiple threejs materials\n\t * to accommodate different primitive types, defines, etc. New materials will\n\t * be created if necessary, and reused from a cache.\n\t * @param  {Object3D} mesh Mesh, Line, or Points instance.\n\t */\n\tassignFinalMaterial( mesh ) {\n\n\t\tconst geometry = mesh.geometry;\n\t\tlet material = mesh.material;\n\n\t\tconst useDerivativeTangents = geometry.attributes.tangent === undefined;\n\t\tconst useVertexColors = geometry.attributes.color !== undefined;\n\t\tconst useFlatShading = geometry.attributes.normal === undefined;\n\n\t\tif ( mesh.isPoints ) {\n\n\t\t\tconst cacheKey = 'PointsMaterial:' + material.uuid;\n\n\t\t\tlet pointsMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! pointsMaterial ) {\n\n\t\t\t\tpointsMaterial = new PointsMaterial();\n\t\t\t\tMaterial.prototype.copy.call( pointsMaterial, material );\n\t\t\t\tpointsMaterial.color.copy( material.color );\n\t\t\t\tpointsMaterial.map = material.map;\n\t\t\t\tpointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\n\n\t\t\t\tthis.cache.add( cacheKey, pointsMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = pointsMaterial;\n\n\t\t} else if ( mesh.isLine ) {\n\n\t\t\tconst cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n\t\t\tlet lineMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! lineMaterial ) {\n\n\t\t\t\tlineMaterial = new LineBasicMaterial();\n\t\t\t\tMaterial.prototype.copy.call( lineMaterial, material );\n\t\t\t\tlineMaterial.color.copy( material.color );\n\t\t\t\tlineMaterial.map = material.map;\n\n\t\t\t\tthis.cache.add( cacheKey, lineMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = lineMaterial;\n\n\t\t}\n\n\t\t// Clone the material if it will be modified\n\t\tif ( useDerivativeTangents || useVertexColors || useFlatShading ) {\n\n\t\t\tlet cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n\t\t\tif ( useDerivativeTangents ) cacheKey += 'derivative-tangents:';\n\t\t\tif ( useVertexColors ) cacheKey += 'vertex-colors:';\n\t\t\tif ( useFlatShading ) cacheKey += 'flat-shading:';\n\n\t\t\tlet cachedMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! cachedMaterial ) {\n\n\t\t\t\tcachedMaterial = material.clone();\n\n\t\t\t\tif ( useVertexColors ) cachedMaterial.vertexColors = true;\n\t\t\t\tif ( useFlatShading ) cachedMaterial.flatShading = true;\n\n\t\t\t\tif ( useDerivativeTangents ) {\n\n\t\t\t\t\t// https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n\t\t\t\t\tif ( cachedMaterial.normalScale ) cachedMaterial.normalScale.y *= - 1;\n\t\t\t\t\tif ( cachedMaterial.clearcoatNormalScale ) cachedMaterial.clearcoatNormalScale.y *= - 1;\n\n\t\t\t\t}\n\n\t\t\t\tthis.cache.add( cacheKey, cachedMaterial );\n\n\t\t\t\tthis.associations.set( cachedMaterial, this.associations.get( material ) );\n\n\t\t\t}\n\n\t\t\tmaterial = cachedMaterial;\n\n\t\t}\n\n\t\tmesh.material = material;\n\n\t}\n\n\tgetMaterialType( /* materialIndex */ ) {\n\n\t\treturn MeshStandardMaterial;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<Material>}\n\t */\n\tloadMaterial( materialIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst materialDef = json.materials[ materialIndex ];\n\n\t\tlet materialType;\n\t\tconst materialParams = {};\n\t\tconst materialExtensions = materialDef.extensions || {};\n\n\t\tconst pending = [];\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\n\n\t\t\tconst kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\n\t\t\tmaterialType = kmuExtension.getMaterialType();\n\t\t\tpending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else {\n\n\t\t\t// Specification:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n\t\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n\t\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.setRGB( array[ 0 ], array[ 1 ], array[ 2 ], LinearSRGBColorSpace );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture, SRGBColorSpace ) );\n\n\t\t\t}\n\n\t\t\tmaterialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n\t\t\tmaterialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n\t\t\tif ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialType = this._invokeOne( function ( ext ) {\n\n\t\t\t\treturn ext.getMaterialType && ext.getMaterialType( materialIndex );\n\n\t\t\t} );\n\n\t\t\tpending.push( Promise.all( this._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.extendMaterialParams && ext.extendMaterialParams( materialIndex, materialParams );\n\n\t\t\t} ) ) );\n\n\t\t}\n\n\t\tif ( materialDef.doubleSided === true ) {\n\n\t\t\tmaterialParams.side = DoubleSide;\n\n\t\t}\n\n\t\tconst alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n\t\tif ( alphaMode === ALPHA_MODES.BLEND ) {\n\n\t\t\tmaterialParams.transparent = true;\n\n\t\t\t// See: https://github.com/mrdoob/three.js/issues/17706\n\t\t\tmaterialParams.depthWrite = false;\n\n\t\t} else {\n\n\t\t\tmaterialParams.transparent = false;\n\n\t\t\tif ( alphaMode === ALPHA_MODES.MASK ) {\n\n\t\t\t\tmaterialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\n\n\t\t\tmaterialParams.normalScale = new Vector2( 1, 1 );\n\n\t\t\tif ( materialDef.normalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = materialDef.normalTexture.scale;\n\n\t\t\t\tmaterialParams.normalScale.set( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\n\n\t\t\tif ( materialDef.occlusionTexture.strength !== undefined ) {\n\n\t\t\t\tmaterialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tconst emissiveFactor = materialDef.emissiveFactor;\n\t\t\tmaterialParams.emissive = new Color().setRGB( emissiveFactor[ 0 ], emissiveFactor[ 1 ], emissiveFactor[ 2 ], LinearSRGBColorSpace );\n\n\t\t}\n\n\t\tif ( materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\tconst material = new materialType( materialParams );\n\n\t\t\tif ( materialDef.name ) material.name = materialDef.name;\n\n\t\t\tassignExtrasToUserData( material, materialDef );\n\n\t\t\tparser.associations.set( material, { materials: materialIndex } );\n\n\t\t\tif ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\n\n\t\t\treturn material;\n\n\t\t} );\n\n\t}\n\n\t/** When Object3D instances are targeted by animation, they need unique names. */\n\tcreateUniqueName( originalName ) {\n\n\t\tconst sanitizedName = PropertyBinding.sanitizeNodeName( originalName || '' );\n\n\t\tif ( sanitizedName in this.nodeNamesUsed ) {\n\n\t\t\treturn sanitizedName + '_' + ( ++ this.nodeNamesUsed[ sanitizedName ] );\n\n\t\t} else {\n\n\t\t\tthis.nodeNamesUsed[ sanitizedName ] = 0;\n\n\t\t\treturn sanitizedName;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<BufferGeometry>>}\n\t */\n\tloadGeometries( primitives ) {\n\n\t\tconst parser = this;\n\t\tconst extensions = this.extensions;\n\t\tconst cache = this.primitiveCache;\n\n\t\tfunction createDracoPrimitive( primitive ) {\n\n\t\t\treturn extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\n\t\t\t\t.decodePrimitive( primitive, parser )\n\t\t\t\t.then( function ( geometry ) {\n\n\t\t\t\t\treturn addPrimitiveAttributes( geometry, primitive, parser );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst primitive = primitives[ i ];\n\t\t\tconst cacheKey = createPrimitiveKey( primitive );\n\n\t\t\t// See if we've already created this geometry\n\t\t\tconst cached = cache[ cacheKey ];\n\n\t\t\tif ( cached ) {\n\n\t\t\t\t// Use the cached geometry if it exists\n\t\t\t\tpending.push( cached.promise );\n\n\t\t\t} else {\n\n\t\t\t\tlet geometryPromise;\n\n\t\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\n\n\t\t\t\t\t// Use DRACO geometry if available\n\t\t\t\t\tgeometryPromise = createDracoPrimitive( primitive );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Otherwise create a new geometry\n\t\t\t\t\tgeometryPromise = addPrimitiveAttributes( new BufferGeometry(), primitive, parser );\n\n\t\t\t\t}\n\n\t\t\t\t// Cache this geometry\n\t\t\t\tcache[ cacheKey ] = { primitive: primitive, promise: geometryPromise };\n\n\t\t\t\tpending.push( geometryPromise );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<Group|Mesh|SkinnedMesh>}\n\t */\n\tloadMesh( meshIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\tconst meshDef = json.meshes[ meshIndex ];\n\t\tconst primitives = meshDef.primitives;\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst material = primitives[ i ].material === undefined\n\t\t\t\t? createDefaultMaterial( this.cache )\n\t\t\t\t: this.getDependency( 'material', primitives[ i ].material );\n\n\t\t\tpending.push( material );\n\n\t\t}\n\n\t\tpending.push( parser.loadGeometries( primitives ) );\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst materials = results.slice( 0, results.length - 1 );\n\t\t\tconst geometries = results[ results.length - 1 ];\n\n\t\t\tconst meshes = [];\n\n\t\t\tfor ( let i = 0, il = geometries.length; i < il; i ++ ) {\n\n\t\t\t\tconst geometry = geometries[ i ];\n\t\t\t\tconst primitive = primitives[ i ];\n\n\t\t\t\t// 1. create Mesh\n\n\t\t\t\tlet mesh;\n\n\t\t\t\tconst material = materials[ i ];\n\n\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n\t\t\t\t\t\tprimitive.mode === undefined ) {\n\n\t\t\t\t\t// .isSkinnedMesh isn't in glTF spec. See ._markDefs()\n\t\t\t\t\tmesh = meshDef.isSkinnedMesh === true\n\t\t\t\t\t\t? new SkinnedMesh( geometry, material )\n\t\t\t\t\t\t: new Mesh( geometry, material );\n\n\t\t\t\t\tif ( mesh.isSkinnedMesh === true ) {\n\n\t\t\t\t\t\t// normalize skin weights to fix malformed assets (see #15319)\n\t\t\t\t\t\tmesh.normalizeSkinWeights();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleStripDrawMode );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleFanDrawMode );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\n\n\t\t\t\t\tmesh = new LineSegments( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\n\n\t\t\t\t\tmesh = new Line( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\n\n\t\t\t\t\tmesh = new LineLoop( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\n\n\t\t\t\t\tmesh = new Points( geometry, material );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\n\n\t\t\t\t}\n\n\t\t\t\tif ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\n\n\t\t\t\t\tupdateMorphTargets( mesh, meshDef );\n\n\t\t\t\t}\n\n\t\t\t\tmesh.name = parser.createUniqueName( meshDef.name || ( 'mesh_' + meshIndex ) );\n\n\t\t\t\tassignExtrasToUserData( mesh, meshDef );\n\n\t\t\t\tif ( primitive.extensions ) addUnknownExtensionsToUserData( extensions, mesh, primitive );\n\n\t\t\t\tparser.assignFinalMaterial( mesh );\n\n\t\t\t\tmeshes.push( mesh );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tparser.associations.set( meshes[ i ], {\n\t\t\t\t\tmeshes: meshIndex,\n\t\t\t\t\tprimitives: i\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tif ( meshes.length === 1 ) {\n\n\t\t\t\tif ( meshDef.extensions ) addUnknownExtensionsToUserData( extensions, meshes[ 0 ], meshDef );\n\n\t\t\t\treturn meshes[ 0 ];\n\n\t\t\t}\n\n\t\t\tconst group = new Group();\n\n\t\t\tif ( meshDef.extensions ) addUnknownExtensionsToUserData( extensions, group, meshDef );\n\n\t\t\tparser.associations.set( group, { meshes: meshIndex } );\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tgroup.add( meshes[ i ] );\n\n\t\t\t}\n\n\t\t\treturn group;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */\n\tloadCamera( cameraIndex ) {\n\n\t\tlet camera;\n\t\tconst cameraDef = this.json.cameras[ cameraIndex ];\n\t\tconst params = cameraDef[ cameraDef.type ];\n\n\t\tif ( ! params ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( cameraDef.type === 'perspective' ) {\n\n\t\t\tcamera = new PerspectiveCamera( MathUtils.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\n\n\t\t} else if ( cameraDef.type === 'orthographic' ) {\n\n\t\t\tcamera = new OrthographicCamera( - params.xmag, params.xmag, params.ymag, - params.ymag, params.znear, params.zfar );\n\n\t\t}\n\n\t\tif ( cameraDef.name ) camera.name = this.createUniqueName( cameraDef.name );\n\n\t\tassignExtrasToUserData( camera, cameraDef );\n\n\t\treturn Promise.resolve( camera );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Skeleton>}\n\t */\n\tloadSkin( skinIndex ) {\n\n\t\tconst skinDef = this.json.skins[ skinIndex ];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = skinDef.joints.length; i < il; i ++ ) {\n\n\t\t\tpending.push( this._loadNodeShallow( skinDef.joints[ i ] ) );\n\n\t\t}\n\n\t\tif ( skinDef.inverseBindMatrices !== undefined ) {\n\n\t\t\tpending.push( this.getDependency( 'accessor', skinDef.inverseBindMatrices ) );\n\n\t\t} else {\n\n\t\t\tpending.push( null );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst inverseBindMatrices = results.pop();\n\t\t\tconst jointNodes = results;\n\n\t\t\t// Note that bones (joint nodes) may or may not be in the\n\t\t\t// scene graph at this time.\n\n\t\t\tconst bones = [];\n\t\t\tconst boneInverses = [];\n\n\t\t\tfor ( let i = 0, il = jointNodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst jointNode = jointNodes[ i ];\n\n\t\t\t\tif ( jointNode ) {\n\n\t\t\t\t\tbones.push( jointNode );\n\n\t\t\t\t\tconst mat = new Matrix4();\n\n\t\t\t\t\tif ( inverseBindMatrices !== null ) {\n\n\t\t\t\t\t\tmat.fromArray( inverseBindMatrices.array, i * 16 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tboneInverses.push( mat );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinDef.joints[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new Skeleton( bones, boneInverses );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<AnimationClip>}\n\t */\n\tloadAnimation( animationIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\n\t\tconst animationDef = json.animations[ animationIndex ];\n\t\tconst animationName = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\n\n\t\tconst pendingNodes = [];\n\t\tconst pendingInputAccessors = [];\n\t\tconst pendingOutputAccessors = [];\n\t\tconst pendingSamplers = [];\n\t\tconst pendingTargets = [];\n\n\t\tfor ( let i = 0, il = animationDef.channels.length; i < il; i ++ ) {\n\n\t\t\tconst channel = animationDef.channels[ i ];\n\t\t\tconst sampler = animationDef.samplers[ channel.sampler ];\n\t\t\tconst target = channel.target;\n\t\t\tconst name = target.node;\n\t\t\tconst input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\n\t\t\tconst output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\n\n\t\t\tif ( target.node === undefined ) continue;\n\n\t\t\tpendingNodes.push( this.getDependency( 'node', name ) );\n\t\t\tpendingInputAccessors.push( this.getDependency( 'accessor', input ) );\n\t\t\tpendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\n\t\t\tpendingSamplers.push( sampler );\n\t\t\tpendingTargets.push( target );\n\n\t\t}\n\n\t\treturn Promise.all( [\n\n\t\t\tPromise.all( pendingNodes ),\n\t\t\tPromise.all( pendingInputAccessors ),\n\t\t\tPromise.all( pendingOutputAccessors ),\n\t\t\tPromise.all( pendingSamplers ),\n\t\t\tPromise.all( pendingTargets )\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tconst nodes = dependencies[ 0 ];\n\t\t\tconst inputAccessors = dependencies[ 1 ];\n\t\t\tconst outputAccessors = dependencies[ 2 ];\n\t\t\tconst samplers = dependencies[ 3 ];\n\t\t\tconst targets = dependencies[ 4 ];\n\n\t\t\tconst tracks = [];\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst node = nodes[ i ];\n\t\t\t\tconst inputAccessor = inputAccessors[ i ];\n\t\t\t\tconst outputAccessor = outputAccessors[ i ];\n\t\t\t\tconst sampler = samplers[ i ];\n\t\t\t\tconst target = targets[ i ];\n\n\t\t\t\tif ( node === undefined ) continue;\n\n\t\t\t\tif ( node.updateMatrix ) {\n\n\t\t\t\t\tnode.updateMatrix();\n\n\t\t\t\t}\n\n\t\t\t\tconst createdTracks = parser._createAnimationTracks( node, inputAccessor, outputAccessor, sampler, target );\n\n\t\t\t\tif ( createdTracks ) {\n\n\t\t\t\t\tfor ( let k = 0; k < createdTracks.length; k ++ ) {\n\n\t\t\t\t\t\ttracks.push( createdTracks[ k ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new AnimationClip( animationName, undefined, tracks );\n\n\t\t} );\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( nodeDef.mesh === undefined ) return null;\n\n\t\treturn parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\n\n\t\t\tconst node = parser._getNodeRef( parser.meshCache, nodeDef.mesh, mesh );\n\n\t\t\t// if weights are provided on the node, override weights on the mesh.\n\t\t\tif ( nodeDef.weights !== undefined ) {\n\n\t\t\t\tnode.traverse( function ( o ) {\n\n\t\t\t\t\tif ( ! o.isMesh ) return;\n\n\t\t\t\t\tfor ( let i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\t\t\to.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<Object3D>}\n\t */\n\tloadNode( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tconst nodePending = parser._loadNodeShallow( nodeIndex );\n\n\t\tconst childPending = [];\n\t\tconst childrenDef = nodeDef.children || [];\n\n\t\tfor ( let i = 0, il = childrenDef.length; i < il; i ++ ) {\n\n\t\t\tchildPending.push( parser.getDependency( 'node', childrenDef[ i ] ) );\n\n\t\t}\n\n\t\tconst skeletonPending = nodeDef.skin === undefined\n\t\t\t? Promise.resolve( null )\n\t\t\t: parser.getDependency( 'skin', nodeDef.skin );\n\n\t\treturn Promise.all( [\n\t\t\tnodePending,\n\t\t\tPromise.all( childPending ),\n\t\t\tskeletonPending\n\t\t] ).then( function ( results ) {\n\n\t\t\tconst node = results[ 0 ];\n\t\t\tconst children = results[ 1 ];\n\t\t\tconst skeleton = results[ 2 ];\n\n\t\t\tif ( skeleton !== null ) {\n\n\t\t\t\t// This full traverse should be fine because\n\t\t\t\t// child glTF nodes have not been added to this node yet.\n\t\t\t\tnode.traverse( function ( mesh ) {\n\n\t\t\t\t\tif ( ! mesh.isSkinnedMesh ) return;\n\n\t\t\t\t\tmesh.bind( skeleton, _identityMatrix );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = children.length; i < il; i ++ ) {\n\n\t\t\t\tnode.add( children[ i ] );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t// ._loadNodeShallow() parses a single node.\n\t// skin and child nodes are created and added in .loadNode() (no '_' prefix).\n\t_loadNodeShallow( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst parser = this;\n\n\t\t// This method is called from .loadNode() and .loadSkin().\n\t\t// Cache a node to avoid duplication.\n\n\t\tif ( this.nodeCache[ nodeIndex ] !== undefined ) {\n\n\t\t\treturn this.nodeCache[ nodeIndex ];\n\n\t\t}\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\t// reserve node's name before its dependencies, so the root has the intended name.\n\t\tconst nodeName = nodeDef.name ? parser.createUniqueName( nodeDef.name ) : '';\n\n\t\tconst pending = [];\n\n\t\tconst meshPromise = parser._invokeOne( function ( ext ) {\n\n\t\t\treturn ext.createNodeMesh && ext.createNodeMesh( nodeIndex );\n\n\t\t} );\n\n\t\tif ( meshPromise ) {\n\n\t\t\tpending.push( meshPromise );\n\n\t\t}\n\n\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\tpending.push( parser.getDependency( 'camera', nodeDef.camera ).then( function ( camera ) {\n\n\t\t\t\treturn parser._getNodeRef( parser.cameraCache, nodeDef.camera, camera );\n\n\t\t\t} ) );\n\n\t\t}\n\n\t\tparser._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.createNodeAttachment && ext.createNodeAttachment( nodeIndex );\n\n\t\t} ).forEach( function ( promise ) {\n\n\t\t\tpending.push( promise );\n\n\t\t} );\n\n\t\tthis.nodeCache[ nodeIndex ] = Promise.all( pending ).then( function ( objects ) {\n\n\t\t\tlet node;\n\n\t\t\t// .isBone isn't in glTF spec. See ._markDefs\n\t\t\tif ( nodeDef.isBone === true ) {\n\n\t\t\t\tnode = new Bone();\n\n\t\t\t} else if ( objects.length > 1 ) {\n\n\t\t\t\tnode = new Group();\n\n\t\t\t} else if ( objects.length === 1 ) {\n\n\t\t\t\tnode = objects[ 0 ];\n\n\t\t\t} else {\n\n\t\t\t\tnode = new Object3D();\n\n\t\t\t}\n\n\t\t\tif ( node !== objects[ 0 ] ) {\n\n\t\t\t\tfor ( let i = 0, il = objects.length; i < il; i ++ ) {\n\n\t\t\t\t\tnode.add( objects[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.name ) {\n\n\t\t\t\tnode.userData.name = nodeDef.name;\n\t\t\t\tnode.name = nodeName;\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( node, nodeDef );\n\n\t\t\tif ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\n\n\t\t\tif ( nodeDef.matrix !== undefined ) {\n\n\t\t\t\tconst matrix = new Matrix4();\n\t\t\t\tmatrix.fromArray( nodeDef.matrix );\n\t\t\t\tnode.applyMatrix4( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tif ( nodeDef.translation !== undefined ) {\n\n\t\t\t\t\tnode.position.fromArray( nodeDef.translation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.rotation !== undefined ) {\n\n\t\t\t\t\tnode.quaternion.fromArray( nodeDef.rotation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.scale !== undefined ) {\n\n\t\t\t\t\tnode.scale.fromArray( nodeDef.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( ! parser.associations.has( node ) ) {\n\n\t\t\t\tparser.associations.set( node, {} );\n\n\t\t\t}\n\n\t\t\tparser.associations.get( node ).nodes = nodeIndex;\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t\treturn this.nodeCache[ nodeIndex ];\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<Group>}\n\t */\n\tloadScene( sceneIndex ) {\n\n\t\tconst extensions = this.extensions;\n\t\tconst sceneDef = this.json.scenes[ sceneIndex ];\n\t\tconst parser = this;\n\n\t\t// Loader returns Group, not Scene.\n\t\t// See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n\t\tconst scene = new Group();\n\t\tif ( sceneDef.name ) scene.name = parser.createUniqueName( sceneDef.name );\n\n\t\tassignExtrasToUserData( scene, sceneDef );\n\n\t\tif ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\n\n\t\tconst nodeIds = sceneDef.nodes || [];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = nodeIds.length; i < il; i ++ ) {\n\n\t\t\tpending.push( parser.getDependency( 'node', nodeIds[ i ] ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( nodes ) {\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tscene.add( nodes[ i ] );\n\n\t\t\t}\n\n\t\t\t// Removes dangling associations, associations that reference a node that\n\t\t\t// didn't make it into the scene.\n\t\t\tconst reduceAssociations = ( node ) => {\n\n\t\t\t\tconst reducedAssociations = new Map();\n\n\t\t\t\tfor ( const [ key, value ] of parser.associations ) {\n\n\t\t\t\t\tif ( key instanceof Material || key instanceof Texture ) {\n\n\t\t\t\t\t\treducedAssociations.set( key, value );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tnode.traverse( ( node ) => {\n\n\t\t\t\t\tconst mappings = parser.associations.get( node );\n\n\t\t\t\t\tif ( mappings != null ) {\n\n\t\t\t\t\t\treducedAssociations.set( node, mappings );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\treturn reducedAssociations;\n\n\t\t\t};\n\n\t\t\tparser.associations = reduceAssociations( scene );\n\n\t\t\treturn scene;\n\n\t\t} );\n\n\t}\n\n\t_createAnimationTracks( node, inputAccessor, outputAccessor, sampler, target ) {\n\n\t\tconst tracks = [];\n\n\t\tconst targetName = node.name ? node.name : node.uuid;\n\t\tconst targetNames = [];\n\n\t\tif ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\n\n\t\t\tnode.traverse( function ( object ) {\n\n\t\t\t\tif ( object.morphTargetInfluences ) {\n\n\t\t\t\t\ttargetNames.push( object.name ? object.name : object.uuid );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\ttargetNames.push( targetName );\n\n\t\t}\n\n\t\tlet TypedKeyframeTrack;\n\n\t\tswitch ( PATH_PROPERTIES[ target.path ] ) {\n\n\t\t\tcase PATH_PROPERTIES.weights:\n\n\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tcase PATH_PROPERTIES.rotation:\n\n\t\t\t\tTypedKeyframeTrack = QuaternionKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tcase PATH_PROPERTIES.position:\n\t\t\tcase PATH_PROPERTIES.scale:\n\n\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tswitch ( outputAccessor.itemSize ) {\n\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\tcase 3:\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tconst interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : InterpolateLinear;\n\n\n\t\tconst outputArray = this._getArrayFromAccessor( outputAccessor );\n\n\t\tfor ( let j = 0, jl = targetNames.length; j < jl; j ++ ) {\n\n\t\t\tconst track = new TypedKeyframeTrack(\n\t\t\t\ttargetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\n\t\t\t\tinputAccessor.array,\n\t\t\t\toutputArray,\n\t\t\t\tinterpolation\n\t\t\t);\n\n\t\t\t// Override interpolation with custom factory method.\n\t\t\tif ( sampler.interpolation === 'CUBICSPLINE' ) {\n\n\t\t\t\tthis._createCubicSplineTrackInterpolant( track );\n\n\t\t\t}\n\n\t\t\ttracks.push( track );\n\n\t\t}\n\n\t\treturn tracks;\n\n\t}\n\n\t_getArrayFromAccessor( accessor ) {\n\n\t\tlet outputArray = accessor.array;\n\n\t\tif ( accessor.normalized ) {\n\n\t\t\tconst scale = getNormalizedComponentScale( outputArray.constructor );\n\t\t\tconst scaled = new Float32Array( outputArray.length );\n\n\t\t\tfor ( let j = 0, jl = outputArray.length; j < jl; j ++ ) {\n\n\t\t\t\tscaled[ j ] = outputArray[ j ] * scale;\n\n\t\t\t}\n\n\t\t\toutputArray = scaled;\n\n\t\t}\n\n\t\treturn outputArray;\n\n\t}\n\n\t_createCubicSplineTrackInterpolant( track ) {\n\n\t\ttrack.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\n\n\t\t\t// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n\t\t\t// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n\t\t\t// must be divided by three to get the interpolant's sampleSize argument.\n\n\t\t\tconst interpolantType = ( this instanceof QuaternionKeyframeTrack ) ? GLTFCubicSplineQuaternionInterpolant : GLTFCubicSplineInterpolant;\n\n\t\t\treturn new interpolantType( this.times, this.values, this.getValueSize() / 3, result );\n\n\t\t};\n\n\t\t// Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n\t\ttrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n\n\t}\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n */\nfunction computeBounds( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst box = new Box3();\n\n\tif ( attributes.POSITION !== undefined ) {\n\n\t\tconst accessor = parser.json.accessors[ attributes.POSITION ];\n\n\t\tconst min = accessor.min;\n\t\tconst max = accessor.max;\n\n\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\tbox.set(\n\t\t\t\tnew Vector3( min[ 0 ], min[ 1 ], min[ 2 ] ),\n\t\t\t\tnew Vector3( max[ 0 ], max[ 1 ], max[ 2 ] )\n\t\t\t);\n\n\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\tbox.min.multiplyScalar( boxScale );\n\t\t\t\tbox.max.multiplyScalar( boxScale );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\treturn;\n\n\t\t}\n\n\t} else {\n\n\t\treturn;\n\n\t}\n\n\tconst targets = primitiveDef.targets;\n\n\tif ( targets !== undefined ) {\n\n\t\tconst maxDisplacement = new Vector3();\n\t\tconst vector = new Vector3();\n\n\t\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tconst target = targets[ i ];\n\n\t\t\tif ( target.POSITION !== undefined ) {\n\n\t\t\t\tconst accessor = parser.json.accessors[ target.POSITION ];\n\t\t\t\tconst min = accessor.min;\n\t\t\t\tconst max = accessor.max;\n\n\t\t\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\t\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\t\t\t// we need to get max of absolute components because target weight is [-1,1]\n\t\t\t\t\tvector.setX( Math.max( Math.abs( min[ 0 ] ), Math.abs( max[ 0 ] ) ) );\n\t\t\t\t\tvector.setY( Math.max( Math.abs( min[ 1 ] ), Math.abs( max[ 1 ] ) ) );\n\t\t\t\t\tvector.setZ( Math.max( Math.abs( min[ 2 ] ), Math.abs( max[ 2 ] ) ) );\n\n\n\t\t\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\t\t\tvector.multiplyScalar( boxScale );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n\t\t\t\t\t// to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n\t\t\t\t\t// are used to implement key-frame animations and as such only two are active at a time - this results in very large\n\t\t\t\t\t// boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n\t\t\t\t\tmaxDisplacement.max( vector );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n\t\tbox.expandByVector( maxDisplacement );\n\n\t}\n\n\tgeometry.boundingBox = box;\n\n\tconst sphere = new Sphere();\n\n\tbox.getCenter( sphere.center );\n\tsphere.radius = box.min.distanceTo( box.max ) / 2;\n\n\tgeometry.boundingSphere = sphere;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst pending = [];\n\n\tfunction assignAttributeAccessor( accessorIndex, attributeName ) {\n\n\t\treturn parser.getDependency( 'accessor', accessorIndex )\n\t\t\t.then( function ( accessor ) {\n\n\t\t\t\tgeometry.setAttribute( attributeName, accessor );\n\n\t\t\t} );\n\n\t}\n\n\tfor ( const gltfAttributeName in attributes ) {\n\n\t\tconst threeAttributeName = ATTRIBUTES[ gltfAttributeName ] || gltfAttributeName.toLowerCase();\n\n\t\t// Skip attributes already provided by e.g. Draco extension.\n\t\tif ( threeAttributeName in geometry.attributes ) continue;\n\n\t\tpending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\n\n\t}\n\n\tif ( primitiveDef.indices !== undefined && ! geometry.index ) {\n\n\t\tconst accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\n\n\t\t\tgeometry.setIndex( accessor );\n\n\t\t} );\n\n\t\tpending.push( accessor );\n\n\t}\n\n\tif ( ColorManagement.workingColorSpace !== LinearSRGBColorSpace && 'COLOR_0' in attributes ) {\n\n\t\tconsole.warn( `THREE.GLTFLoader: Converting vertex colors from \"srgb-linear\" to \"${ColorManagement.workingColorSpace}\" not supported.` );\n\n\t}\n\n\tassignExtrasToUserData( geometry, primitiveDef );\n\n\tcomputeBounds( geometry, primitiveDef, parser );\n\n\treturn Promise.all( pending ).then( function () {\n\n\t\treturn primitiveDef.targets !== undefined\n\t\t\t? addMorphTargets( geometry, primitiveDef.targets, parser )\n\t\t\t: geometry;\n\n\t} );\n\n}\n\nexport { GLTFLoader };\n","import {\n\tBufferAttribute,\n\tBufferGeometry,\n\tColor,\n\tColorManagement,\n\tFileLoader,\n\tLoader,\n\tLinearSRGBColorSpace,\n\tSRGBColorSpace\n} from 'three';\n\nconst _taskCache = new WeakMap();\n\nclass DRACOLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.decoderPath = '';\n\t\tthis.decoderConfig = {};\n\t\tthis.decoderBinary = null;\n\t\tthis.decoderPending = null;\n\n\t\tthis.workerLimit = 4;\n\t\tthis.workerPool = [];\n\t\tthis.workerNextTaskID = 1;\n\t\tthis.workerSourceURL = '';\n\n\t\tthis.defaultAttributeIDs = {\n\t\t\tposition: 'POSITION',\n\t\t\tnormal: 'NORMAL',\n\t\t\tcolor: 'COLOR',\n\t\t\tuv: 'TEX_COORD'\n\t\t};\n\t\tthis.defaultAttributeTypes = {\n\t\t\tposition: 'Float32Array',\n\t\t\tnormal: 'Float32Array',\n\t\t\tcolor: 'Float32Array',\n\t\t\tuv: 'Float32Array'\n\t\t};\n\n\t}\n\n\tsetDecoderPath( path ) {\n\n\t\tthis.decoderPath = path;\n\n\t\treturn this;\n\n\t}\n\n\tsetDecoderConfig( config ) {\n\n\t\tthis.decoderConfig = config;\n\n\t\treturn this;\n\n\t}\n\n\tsetWorkerLimit( workerLimit ) {\n\n\t\tthis.workerLimit = workerLimit;\n\n\t\treturn this;\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tloader.load( url, ( buffer ) => {\n\n\t\t\tthis.parse( buffer, onLoad, onError );\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\n\tparse( buffer, onLoad, onError = ()=>{} ) {\n\n\t\tthis.decodeDracoFile( buffer, onLoad, null, null, SRGBColorSpace, onError ).catch( onError );\n\n\t}\n\n\tdecodeDracoFile( buffer, callback, attributeIDs, attributeTypes, vertexColorSpace = LinearSRGBColorSpace, onError = () => {} ) {\n\n\t\tconst taskConfig = {\n\t\t\tattributeIDs: attributeIDs || this.defaultAttributeIDs,\n\t\t\tattributeTypes: attributeTypes || this.defaultAttributeTypes,\n\t\t\tuseUniqueIDs: !! attributeIDs,\n\t\t\tvertexColorSpace: vertexColorSpace,\n\t\t};\n\n\t\treturn this.decodeGeometry( buffer, taskConfig ).then( callback ).catch( onError );\n\n\t}\n\n\tdecodeGeometry( buffer, taskConfig ) {\n\n\t\tconst taskKey = JSON.stringify( taskConfig );\n\n\t\t// Check for an existing task using this buffer. A transferred buffer cannot be transferred\n\t\t// again from this thread.\n\t\tif ( _taskCache.has( buffer ) ) {\n\n\t\t\tconst cachedTask = _taskCache.get( buffer );\n\n\t\t\tif ( cachedTask.key === taskKey ) {\n\n\t\t\t\treturn cachedTask.promise;\n\n\t\t\t} else if ( buffer.byteLength === 0 ) {\n\n\t\t\t\t// Technically, it would be possible to wait for the previous task to complete,\n\t\t\t\t// transfer the buffer back, and decode again with the second configuration. That\n\t\t\t\t// is complex, and I don't know of any reason to decode a Draco buffer twice in\n\t\t\t\t// different ways, so this is left unimplemented.\n\t\t\t\tthrow new Error(\n\n\t\t\t\t\t'THREE.DRACOLoader: Unable to re-decode a buffer with different ' +\n\t\t\t\t\t'settings. Buffer has already been transferred.'\n\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tlet worker;\n\t\tconst taskID = this.workerNextTaskID ++;\n\t\tconst taskCost = buffer.byteLength;\n\n\t\t// Obtain a worker and assign a task, and construct a geometry instance\n\t\t// when the task completes.\n\t\tconst geometryPending = this._getWorker( taskID, taskCost )\n\t\t\t.then( ( _worker ) => {\n\n\t\t\t\tworker = _worker;\n\n\t\t\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\t\t\tworker._callbacks[ taskID ] = { resolve, reject };\n\n\t\t\t\t\tworker.postMessage( { type: 'decode', id: taskID, taskConfig, buffer }, [ buffer ] );\n\n\t\t\t\t\t// this.debug();\n\n\t\t\t\t} );\n\n\t\t\t} )\n\t\t\t.then( ( message ) => this._createGeometry( message.geometry ) );\n\n\t\t// Remove task from the task list.\n\t\t// Note: replaced '.finally()' with '.catch().then()' block - iOS 11 support (#19416)\n\t\tgeometryPending\n\t\t\t.catch( () => true )\n\t\t\t.then( () => {\n\n\t\t\t\tif ( worker && taskID ) {\n\n\t\t\t\t\tthis._releaseTask( worker, taskID );\n\n\t\t\t\t\t// this.debug();\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t// Cache the task result.\n\t\t_taskCache.set( buffer, {\n\n\t\t\tkey: taskKey,\n\t\t\tpromise: geometryPending\n\n\t\t} );\n\n\t\treturn geometryPending;\n\n\t}\n\n\t_createGeometry( geometryData ) {\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tif ( geometryData.index ) {\n\n\t\t\tgeometry.setIndex( new BufferAttribute( geometryData.index.array, 1 ) );\n\n\t\t}\n\n\t\tfor ( let i = 0; i < geometryData.attributes.length; i ++ ) {\n\n\t\t\tconst result = geometryData.attributes[ i ];\n\t\t\tconst name = result.name;\n\t\t\tconst array = result.array;\n\t\t\tconst itemSize = result.itemSize;\n\n\t\t\tconst attribute = new BufferAttribute( array, itemSize );\n\n\t\t\tif ( name === 'color' ) {\n\n\t\t\t\tthis._assignVertexColorSpace( attribute, result.vertexColorSpace );\n\n\t\t\t\tattribute.normalized = ( array instanceof Float32Array ) === false;\n\n\t\t\t}\n\n\t\t\tgeometry.setAttribute( name, attribute );\n\n\t\t}\n\n\t\treturn geometry;\n\n\t}\n\n\t_assignVertexColorSpace( attribute, inputColorSpace ) {\n\n\t\t// While .drc files do not specify colorspace, the only 'official' tooling\n\t\t// is PLY and OBJ converters, which use sRGB. We'll assume sRGB when a .drc\n\t\t// file is passed into .load() or .parse(). GLTFLoader uses internal APIs\n\t\t// to decode geometry, and vertex colors are already Linear-sRGB in there.\n\n\t\tif ( inputColorSpace !== SRGBColorSpace ) return;\n\n\t\tconst _color = new Color();\n\n\t\tfor ( let i = 0, il = attribute.count; i < il; i ++ ) {\n\n\t\t\t_color.fromBufferAttribute( attribute, i );\n\t\t\tColorManagement.toWorkingColorSpace( _color, SRGBColorSpace );\n\t\t\tattribute.setXYZ( i, _color.r, _color.g, _color.b );\n\n\t\t}\n\n\t}\n\n\t_loadLibrary( url, responseType ) {\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.decoderPath );\n\t\tloader.setResponseType( responseType );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\tloader.load( url, resolve, undefined, reject );\n\n\t\t} );\n\n\t}\n\n\tpreload() {\n\n\t\tthis._initDecoder();\n\n\t\treturn this;\n\n\t}\n\n\t_initDecoder() {\n\n\t\tif ( this.decoderPending ) return this.decoderPending;\n\n\t\tconst useJS = typeof WebAssembly !== 'object' || this.decoderConfig.type === 'js';\n\t\tconst librariesPending = [];\n\n\t\tif ( useJS ) {\n\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_decoder.js', 'text' ) );\n\n\t\t} else {\n\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_wasm_wrapper.js', 'text' ) );\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_decoder.wasm', 'arraybuffer' ) );\n\n\t\t}\n\n\t\tthis.decoderPending = Promise.all( librariesPending )\n\t\t\t.then( ( libraries ) => {\n\n\t\t\t\tconst jsContent = libraries[ 0 ];\n\n\t\t\t\tif ( ! useJS ) {\n\n\t\t\t\t\tthis.decoderConfig.wasmBinary = libraries[ 1 ];\n\n\t\t\t\t}\n\n\t\t\t\tconst fn = DRACOWorker.toString();\n\n\t\t\t\tconst body = [\n\t\t\t\t\t'/* draco decoder */',\n\t\t\t\t\tjsContent,\n\t\t\t\t\t'',\n\t\t\t\t\t'/* worker */',\n\t\t\t\t\tfn.substring( fn.indexOf( '{' ) + 1, fn.lastIndexOf( '}' ) )\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tthis.workerSourceURL = URL.createObjectURL( new Blob( [ body ] ) );\n\n\t\t\t} );\n\n\t\treturn this.decoderPending;\n\n\t}\n\n\t_getWorker( taskID, taskCost ) {\n\n\t\treturn this._initDecoder().then( () => {\n\n\t\t\tif ( this.workerPool.length < this.workerLimit ) {\n\n\t\t\t\tconst worker = new Worker( this.workerSourceURL );\n\n\t\t\t\tworker._callbacks = {};\n\t\t\t\tworker._taskCosts = {};\n\t\t\t\tworker._taskLoad = 0;\n\n\t\t\t\tworker.postMessage( { type: 'init', decoderConfig: this.decoderConfig } );\n\n\t\t\t\tworker.onmessage = function ( e ) {\n\n\t\t\t\t\tconst message = e.data;\n\n\t\t\t\t\tswitch ( message.type ) {\n\n\t\t\t\t\t\tcase 'decode':\n\t\t\t\t\t\t\tworker._callbacks[ message.id ].resolve( message );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'error':\n\t\t\t\t\t\t\tworker._callbacks[ message.id ].reject( message );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.DRACOLoader: Unexpected message, \"' + message.type + '\"' );\n\n\t\t\t\t\t}\n\n\t\t\t\t};\n\n\t\t\t\tthis.workerPool.push( worker );\n\n\t\t\t} else {\n\n\t\t\t\tthis.workerPool.sort( function ( a, b ) {\n\n\t\t\t\t\treturn a._taskLoad > b._taskLoad ? - 1 : 1;\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tconst worker = this.workerPool[ this.workerPool.length - 1 ];\n\t\t\tworker._taskCosts[ taskID ] = taskCost;\n\t\t\tworker._taskLoad += taskCost;\n\t\t\treturn worker;\n\n\t\t} );\n\n\t}\n\n\t_releaseTask( worker, taskID ) {\n\n\t\tworker._taskLoad -= worker._taskCosts[ taskID ];\n\t\tdelete worker._callbacks[ taskID ];\n\t\tdelete worker._taskCosts[ taskID ];\n\n\t}\n\n\tdebug() {\n\n\t\tconsole.log( 'Task load: ', this.workerPool.map( ( worker ) => worker._taskLoad ) );\n\n\t}\n\n\tdispose() {\n\n\t\tfor ( let i = 0; i < this.workerPool.length; ++ i ) {\n\n\t\t\tthis.workerPool[ i ].terminate();\n\n\t\t}\n\n\t\tthis.workerPool.length = 0;\n\n\t\tif ( this.workerSourceURL !== '' ) {\n\n\t\t\tURL.revokeObjectURL( this.workerSourceURL );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\n/* WEB WORKER */\n\nfunction DRACOWorker() {\n\n\tlet decoderConfig;\n\tlet decoderPending;\n\n\tonmessage = function ( e ) {\n\n\t\tconst message = e.data;\n\n\t\tswitch ( message.type ) {\n\n\t\t\tcase 'init':\n\t\t\t\tdecoderConfig = message.decoderConfig;\n\t\t\t\tdecoderPending = new Promise( function ( resolve/*, reject*/ ) {\n\n\t\t\t\t\tdecoderConfig.onModuleLoaded = function ( draco ) {\n\n\t\t\t\t\t\t// Module is Promise-like. Wrap before resolving to avoid loop.\n\t\t\t\t\t\tresolve( { draco: draco } );\n\n\t\t\t\t\t};\n\n\t\t\t\t\tDracoDecoderModule( decoderConfig ); // eslint-disable-line no-undef\n\n\t\t\t\t} );\n\t\t\t\tbreak;\n\n\t\t\tcase 'decode':\n\t\t\t\tconst buffer = message.buffer;\n\t\t\t\tconst taskConfig = message.taskConfig;\n\t\t\t\tdecoderPending.then( ( module ) => {\n\n\t\t\t\t\tconst draco = module.draco;\n\t\t\t\t\tconst decoder = new draco.Decoder();\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\tconst geometry = decodeGeometry( draco, decoder, new Int8Array( buffer ), taskConfig );\n\n\t\t\t\t\t\tconst buffers = geometry.attributes.map( ( attr ) => attr.array.buffer );\n\n\t\t\t\t\t\tif ( geometry.index ) buffers.push( geometry.index.array.buffer );\n\n\t\t\t\t\t\tself.postMessage( { type: 'decode', id: message.id, geometry }, buffers );\n\n\t\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t\tconsole.error( error );\n\n\t\t\t\t\t\tself.postMessage( { type: 'error', id: message.id, error: error.message } );\n\n\t\t\t\t\t} finally {\n\n\t\t\t\t\t\tdraco.destroy( decoder );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t};\n\n\tfunction decodeGeometry( draco, decoder, array, taskConfig ) {\n\n\t\tconst attributeIDs = taskConfig.attributeIDs;\n\t\tconst attributeTypes = taskConfig.attributeTypes;\n\n\t\tlet dracoGeometry;\n\t\tlet decodingStatus;\n\n\t\tconst geometryType = decoder.GetEncodedGeometryType( array );\n\n\t\tif ( geometryType === draco.TRIANGULAR_MESH ) {\n\n\t\t\tdracoGeometry = new draco.Mesh();\n\t\t\tdecodingStatus = decoder.DecodeArrayToMesh( array, array.byteLength, dracoGeometry );\n\n\t\t} else if ( geometryType === draco.POINT_CLOUD ) {\n\n\t\t\tdracoGeometry = new draco.PointCloud();\n\t\t\tdecodingStatus = decoder.DecodeArrayToPointCloud( array, array.byteLength, dracoGeometry );\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.DRACOLoader: Unexpected geometry type.' );\n\n\t\t}\n\n\t\tif ( ! decodingStatus.ok() || dracoGeometry.ptr === 0 ) {\n\n\t\t\tthrow new Error( 'THREE.DRACOLoader: Decoding failed: ' + decodingStatus.error_msg() );\n\n\t\t}\n\n\t\tconst geometry = { index: null, attributes: [] };\n\n\t\t// Gather all vertex attributes.\n\t\tfor ( const attributeName in attributeIDs ) {\n\n\t\t\tconst attributeType = self[ attributeTypes[ attributeName ] ];\n\n\t\t\tlet attribute;\n\t\t\tlet attributeID;\n\n\t\t\t// A Draco file may be created with default vertex attributes, whose attribute IDs\n\t\t\t// are mapped 1:1 from their semantic name (POSITION, NORMAL, ...). Alternatively,\n\t\t\t// a Draco file may contain a custom set of attributes, identified by known unique\n\t\t\t// IDs. glTF files always do the latter, and `.drc` files typically do the former.\n\t\t\tif ( taskConfig.useUniqueIDs ) {\n\n\t\t\t\tattributeID = attributeIDs[ attributeName ];\n\t\t\t\tattribute = decoder.GetAttributeByUniqueId( dracoGeometry, attributeID );\n\n\t\t\t} else {\n\n\t\t\t\tattributeID = decoder.GetAttributeId( dracoGeometry, draco[ attributeIDs[ attributeName ] ] );\n\n\t\t\t\tif ( attributeID === - 1 ) continue;\n\n\t\t\t\tattribute = decoder.GetAttribute( dracoGeometry, attributeID );\n\n\t\t\t}\n\n\t\t\tconst attributeResult = decodeAttribute( draco, decoder, dracoGeometry, attributeName, attributeType, attribute );\n\n\t\t\tif ( attributeName === 'color' ) {\n\n\t\t\t\tattributeResult.vertexColorSpace = taskConfig.vertexColorSpace;\n\n\t\t\t}\n\n\t\t\tgeometry.attributes.push( attributeResult );\n\n\t\t}\n\n\t\t// Add index.\n\t\tif ( geometryType === draco.TRIANGULAR_MESH ) {\n\n\t\t\tgeometry.index = decodeIndex( draco, decoder, dracoGeometry );\n\n\t\t}\n\n\t\tdraco.destroy( dracoGeometry );\n\n\t\treturn geometry;\n\n\t}\n\n\tfunction decodeIndex( draco, decoder, dracoGeometry ) {\n\n\t\tconst numFaces = dracoGeometry.num_faces();\n\t\tconst numIndices = numFaces * 3;\n\t\tconst byteLength = numIndices * 4;\n\n\t\tconst ptr = draco._malloc( byteLength );\n\t\tdecoder.GetTrianglesUInt32Array( dracoGeometry, byteLength, ptr );\n\t\tconst index = new Uint32Array( draco.HEAPF32.buffer, ptr, numIndices ).slice();\n\t\tdraco._free( ptr );\n\n\t\treturn { array: index, itemSize: 1 };\n\n\t}\n\n\tfunction decodeAttribute( draco, decoder, dracoGeometry, attributeName, attributeType, attribute ) {\n\n\t\tconst numComponents = attribute.num_components();\n\t\tconst numPoints = dracoGeometry.num_points();\n\t\tconst numValues = numPoints * numComponents;\n\t\tconst byteLength = numValues * attributeType.BYTES_PER_ELEMENT;\n\t\tconst dataType = getDracoDataType( draco, attributeType );\n\n\t\tconst ptr = draco._malloc( byteLength );\n\t\tdecoder.GetAttributeDataArrayForAllPoints( dracoGeometry, attribute, dataType, byteLength, ptr );\n\t\tconst array = new attributeType( draco.HEAPF32.buffer, ptr, numValues ).slice();\n\t\tdraco._free( ptr );\n\n\t\treturn {\n\t\t\tname: attributeName,\n\t\t\tarray: array,\n\t\t\titemSize: numComponents\n\t\t};\n\n\t}\n\n\tfunction getDracoDataType( draco, attributeType ) {\n\n\t\tswitch ( attributeType ) {\n\n\t\t\tcase Float32Array: return draco.DT_FLOAT32;\n\t\t\tcase Int8Array: return draco.DT_INT8;\n\t\t\tcase Int16Array: return draco.DT_INT16;\n\t\t\tcase Int32Array: return draco.DT_INT32;\n\t\t\tcase Uint8Array: return draco.DT_UINT8;\n\t\t\tcase Uint16Array: return draco.DT_UINT16;\n\t\t\tcase Uint32Array: return draco.DT_UINT32;\n\n\t\t}\n\n\t}\n\n}\n\nexport { DRACOLoader };\n","const assetsRegistry = {};\n\nconst progressBar = document.querySelector('.load-indicator-bar');\nconst indicator = document.querySelector('.load-indicator');\nconst text = document.querySelectorAll('.text-container');\nconst container = document.querySelector('.load-indicator-container');\n\nlet frameRequested = false;\nconst updateLoadIndicator = () => {\n    if (frameRequested) {\n        return;\n    }\n\n    frameRequested = true;\n    requestAnimationFrame(() => {\n        frameRequested = false;\n        let l = 0;\n        let t = 0;\n        const textContent = Object.entries(assetsRegistry).reduce(\n            (msg, [assetType, { total, loaded }]) => {\n                l += loaded;\n                t += total;\n                return `${msg} ${assetType} (${loaded}/${total})`;\n            },\n            'Loading:'\n        );\n        text.forEach((el) => (el.textContent = textContent));\n        progressBar.style.width = `${(l / t) * 100}%`;\n\n        if (l === t) {\n            setTimeout(() => {\n                container.addEventListener(\n                    'transitionend',\n                    (evt) =>\n                        evt.target === container &&\n                        container.parentElement &&\n                        container.parentElement.removeChild(container)\n                );\n                container.classList.add('hidden');\n            }, 1000);\n        }\n    });\n};\n\nconst initLoadIndicator = () => {\n    indicator.style.display = 'block';\n};\n\nexport const addAsset = (assetType, count = 1) => {\n    assetsRegistry[assetType]\n        ? (assetsRegistry[assetType].total += count)\n        : (assetsRegistry[assetType] = { total: count, loaded: 0 });\n    initLoadIndicator();\n    updateLoadIndicator();\n};\n\nexport const assetLoaded = (assetType) => {\n    assetsRegistry[assetType].loaded += 1;\n    updateLoadIndicator();\n};\n","import { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\nimport { DRACOLoader } from 'three/examples/jsm/loaders/DRACOLoader.js';\nimport { addAsset } from './assetsLoadingIndicator';\n\nconst dracoLoader = new DRACOLoader();\ndracoLoader.setDecoderPath('draco/');\n\nconst gltfLoader = new GLTFLoader();\ngltfLoader.setDRACOLoader(dracoLoader);\n\nexport const loadMesh = (path) => {\n    addAsset('Meshes');\n    return new Promise((resolve) => {\n        gltfLoader.load(path, (gltf) => {\n            let mesh = null;\n            gltf.scene.traverse((child) => {\n                child.type === 'Mesh' && (mesh = child);\n            });\n\n            mesh.material.emissiveIntensity = 0;\n            mesh.material.aoMapIntensity = 0;\n            mesh.castShadow = false;\n\n            const { geometry } = mesh;\n            geometry.center();\n            const scale =\n                1.8 /\n                geometry.boundingBox.max.sub(geometry.boundingBox.min).length();\n            geometry.scale(scale, scale, scale);\n            mesh.scale.set(1, 1, 1);\n            mesh.rotation.set(0, 0, 0);\n\n            resolve(mesh);\n        });\n    });\n};\n","/**\n * @license\n * Copyright 2010-2024 Three.js Authors\n * SPDX-License-Identifier: MIT\n */\nimport { TSL } from 'three/webgpu';\n\nconst BRDF_GGX = TSL.BRDF_GGX;\nconst BRDF_Lambert = TSL.BRDF_Lambert;\nconst BasicShadowFilter = TSL.BasicShadowFilter;\nconst Break = TSL.Break;\nconst Continue = TSL.Continue;\nconst DFGApprox = TSL.DFGApprox;\nconst D_GGX = TSL.D_GGX;\nconst Discard = TSL.Discard;\nconst EPSILON = TSL.EPSILON;\nconst F_Schlick = TSL.F_Schlick;\nconst Fn = TSL.Fn;\nconst INFINITY = TSL.INFINITY;\nconst If = TSL.If;\nconst Loop = TSL.Loop;\nconst NodeShaderStage = TSL.NodeShaderStage;\nconst NodeType = TSL.NodeType;\nconst NodeUpdateType = TSL.NodeUpdateType;\nconst NodeAccess = TSL.NodeAccess;\nconst PCFShadowFilter = TSL.PCFShadowFilter;\nconst PCFSoftShadowFilter = TSL.PCFSoftShadowFilter;\nconst PI = TSL.PI;\nconst PI2 = TSL.PI2;\nconst Return = TSL.Return;\nconst Schlick_to_F0 = TSL.Schlick_to_F0;\nconst ScriptableNodeResources = TSL.ScriptableNodeResources;\nconst ShaderNode = TSL.ShaderNode;\nconst TBNViewMatrix = TSL.TBNViewMatrix;\nconst VSMShadowFilter = TSL.VSMShadowFilter;\nconst V_GGX_SmithCorrelated = TSL.V_GGX_SmithCorrelated;\nconst abs = TSL.abs;\nconst acesFilmicToneMapping = TSL.acesFilmicToneMapping;\nconst acos = TSL.acos;\nconst add = TSL.add;\nconst addMethodChaining = TSL.addMethodChaining;\nconst addNodeElement = TSL.addNodeElement;\nconst agxToneMapping = TSL.agxToneMapping;\nconst all = TSL.all;\nconst alphaT = TSL.alphaT;\nconst and = TSL.and;\nconst anisotropy = TSL.anisotropy;\nconst anisotropyB = TSL.anisotropyB;\nconst anisotropyT = TSL.anisotropyT;\nconst any = TSL.any;\nconst append = TSL.append;\nconst arrayBuffer = TSL.arrayBuffer;\nconst asin = TSL.asin;\nconst assign = TSL.assign;\nconst atan = TSL.atan;\nconst atan2 = TSL.atan2;\nconst atomicAdd = TSL.atomicAdd;\nconst atomicAnd = TSL.atomicAnd;\nconst atomicFunc = TSL.atomicFunc;\nconst atomicMax = TSL.atomicMax;\nconst atomicMin = TSL.atomicMin;\nconst atomicOr = TSL.atomicOr;\nconst atomicStore = TSL.atomicStore;\nconst atomicSub = TSL.atomicSub;\nconst atomicXor = TSL.atomicXor;\nconst attenuationColor = TSL.attenuationColor;\nconst attenuationDistance = TSL.attenuationDistance;\nconst attribute = TSL.attribute;\nconst attributeArray = TSL.attributeArray;\nconst backgroundBlurriness = TSL.backgroundBlurriness;\nconst backgroundIntensity = TSL.backgroundIntensity;\nconst backgroundRotation = TSL.backgroundRotation;\nconst batch = TSL.batch;\nconst billboarding = TSL.billboarding;\nconst bitAnd = TSL.bitAnd;\nconst bitNot = TSL.bitNot;\nconst bitOr = TSL.bitOr;\nconst bitXor = TSL.bitXor;\nconst bitangentGeometry = TSL.bitangentGeometry;\nconst bitangentLocal = TSL.bitangentLocal;\nconst bitangentView = TSL.bitangentView;\nconst bitangentWorld = TSL.bitangentWorld;\nconst bitcast = TSL.bitcast;\nconst blendBurn = TSL.blendBurn;\nconst blendColor = TSL.blendColor;\nconst blendDodge = TSL.blendDodge;\nconst blendOverlay = TSL.blendOverlay;\nconst blendScreen = TSL.blendScreen;\nconst blur = TSL.blur;\nconst bool = TSL.bool;\nconst buffer = TSL.buffer;\nconst bufferAttribute = TSL.bufferAttribute;\nconst bumpMap = TSL.bumpMap;\nconst burn = TSL.burn;\nconst bvec2 = TSL.bvec2;\nconst bvec3 = TSL.bvec3;\nconst bvec4 = TSL.bvec4;\nconst bypass = TSL.bypass;\nconst cache = TSL.cache;\nconst call = TSL.call;\nconst cameraFar = TSL.cameraFar;\nconst cameraNear = TSL.cameraNear;\nconst cameraNormalMatrix = TSL.cameraNormalMatrix;\nconst cameraPosition = TSL.cameraPosition;\nconst cameraProjectionMatrix = TSL.cameraProjectionMatrix;\nconst cameraProjectionMatrixInverse = TSL.cameraProjectionMatrixInverse;\nconst cameraViewMatrix = TSL.cameraViewMatrix;\nconst cameraWorldMatrix = TSL.cameraWorldMatrix;\nconst cbrt = TSL.cbrt;\nconst cdl = TSL.cdl;\nconst ceil = TSL.ceil;\nconst checker = TSL.checker;\nconst cineonToneMapping = TSL.cineonToneMapping;\nconst clamp = TSL.clamp;\nconst clearcoat = TSL.clearcoat;\nconst clearcoatRoughness = TSL.clearcoatRoughness;\nconst code = TSL.code;\nconst color = TSL.color;\nconst colorSpaceToWorking = TSL.colorSpaceToWorking;\nconst colorToDirection = TSL.colorToDirection;\nconst compute = TSL.compute;\nconst cond = TSL.cond;\nconst context = TSL.context;\nconst convert = TSL.convert;\nconst convertColorSpace = TSL.convertColorSpace;\nconst convertToTexture = TSL.convertToTexture;\nconst cos = TSL.cos;\nconst cross = TSL.cross;\nconst cubeTexture = TSL.cubeTexture;\nconst dFdx = TSL.dFdx;\nconst dFdy = TSL.dFdy;\nconst dashSize = TSL.dashSize;\nconst defaultBuildStages = TSL.defaultBuildStages;\nconst defaultShaderStages = TSL.defaultShaderStages;\nconst defined = TSL.defined;\nconst degrees = TSL.degrees;\nconst deltaTime = TSL.deltaTime;\nconst densityFog = TSL.densityFog;\nconst depth = TSL.depth;\nconst depthPass = TSL.depthPass;\nconst difference = TSL.difference;\nconst diffuseColor = TSL.diffuseColor;\nconst directPointLight = TSL.directPointLight;\nconst directionToColor = TSL.directionToColor;\nconst dispersion = TSL.dispersion;\nconst distance = TSL.distance;\nconst div = TSL.div;\nconst dodge = TSL.dodge;\nconst dot = TSL.dot;\nconst drawIndex = TSL.drawIndex;\nconst dynamicBufferAttribute = TSL.dynamicBufferAttribute;\nconst element = TSL.element;\nconst emissive = TSL.emissive;\nconst equal = TSL.equal;\nconst equals = TSL.equals;\nconst equirectUV = TSL.equirectUV;\nconst exp = TSL.exp;\nconst exp2 = TSL.exp2;\nconst expression = TSL.expression;\nconst faceDirection = TSL.faceDirection;\nconst faceForward = TSL.faceForward;\nconst float = TSL.float;\nconst floor = TSL.floor;\nconst fog = TSL.fog;\nconst fract = TSL.fract;\nconst frameGroup = TSL.frameGroup;\nconst frameId = TSL.frameId;\nconst frontFacing = TSL.frontFacing;\nconst fwidth = TSL.fwidth;\nconst gain = TSL.gain;\nconst gapSize = TSL.gapSize;\nconst getConstNodeType = TSL.getConstNodeType;\nconst getCurrentStack = TSL.getCurrentStack;\nconst getDirection = TSL.getDirection;\nconst getDistanceAttenuation = TSL.getDistanceAttenuation;\nconst getGeometryRoughness = TSL.getGeometryRoughness;\nconst getNormalFromDepth = TSL.getNormalFromDepth;\nconst getParallaxCorrectNormal = TSL.getParallaxCorrectNormal;\nconst getRoughness = TSL.getRoughness;\nconst getScreenPosition = TSL.getScreenPosition;\nconst getShIrradianceAt = TSL.getShIrradianceAt;\nconst getTextureIndex = TSL.getTextureIndex;\nconst getViewPosition = TSL.getViewPosition;\nconst glsl = TSL.glsl;\nconst glslFn = TSL.glslFn;\nconst grayscale = TSL.grayscale;\nconst greaterThan = TSL.greaterThan;\nconst greaterThanEqual = TSL.greaterThanEqual;\nconst hash = TSL.hash;\nconst highPrecisionModelNormalViewMatrix = TSL.highPrecisionModelNormalViewMatrix;\nconst highPrecisionModelViewMatrix = TSL.highPrecisionModelViewMatrix;\nconst hue = TSL.hue;\nconst instance = TSL.instance;\nconst instanceIndex = TSL.instanceIndex;\nconst instancedArray = TSL.instancedArray;\nconst instancedBufferAttribute = TSL.instancedBufferAttribute;\nconst instancedDynamicBufferAttribute = TSL.instancedDynamicBufferAttribute;\nconst instancedMesh = TSL.instancedMesh;\nconst int = TSL.int;\nconst inverseSqrt = TSL.inverseSqrt;\nconst invocationLocalIndex = TSL.invocationLocalIndex;\nconst invocationSubgroupIndex = TSL.invocationSubgroupIndex;\nconst ior = TSL.ior;\nconst iridescence = TSL.iridescence;\nconst iridescenceIOR = TSL.iridescenceIOR;\nconst iridescenceThickness = TSL.iridescenceThickness;\nconst ivec2 = TSL.ivec2;\nconst ivec3 = TSL.ivec3;\nconst ivec4 = TSL.ivec4;\nconst js = TSL.js;\nconst label = TSL.label;\nconst length = TSL.length;\nconst lengthSq = TSL.lengthSq;\nconst lessThan = TSL.lessThan;\nconst lessThanEqual = TSL.lessThanEqual;\nconst lightPosition = TSL.lightPosition;\nconst lightTargetDirection = TSL.lightTargetDirection;\nconst lightTargetPosition = TSL.lightTargetPosition;\nconst lightViewPosition = TSL.lightViewPosition;\nconst lightingContext = TSL.lightingContext;\nconst lights = TSL.lights;\nconst linearDepth = TSL.linearDepth;\nconst linearToneMapping = TSL.linearToneMapping;\nconst localId = TSL.localId;\nconst log = TSL.log;\nconst log2 = TSL.log2;\nconst logarithmicDepthToViewZ = TSL.logarithmicDepthToViewZ;\nconst loop = TSL.loop;\nconst luminance = TSL.luminance;\nconst mat2 = TSL.mat2;\nconst mat3 = TSL.mat3;\nconst mat4 = TSL.mat4;\nconst matcapUV = TSL.matcapUV;\nconst materialAOMap = TSL.materialAOMap;\nconst materialAlphaTest = TSL.materialAlphaTest;\nconst materialAnisotropy = TSL.materialAnisotropy;\nconst materialAnisotropyVector = TSL.materialAnisotropyVector;\nconst materialAttenuationColor = TSL.materialAttenuationColor;\nconst materialAttenuationDistance = TSL.materialAttenuationDistance;\nconst materialClearcoat = TSL.materialClearcoat;\nconst materialClearcoatNormal = TSL.materialClearcoatNormal;\nconst materialClearcoatRoughness = TSL.materialClearcoatRoughness;\nconst materialColor = TSL.materialColor;\nconst materialDispersion = TSL.materialDispersion;\nconst materialEmissive = TSL.materialEmissive;\nconst materialIOR = TSL.materialIOR;\nconst materialIridescence = TSL.materialIridescence;\nconst materialIridescenceIOR = TSL.materialIridescenceIOR;\nconst materialIridescenceThickness = TSL.materialIridescenceThickness;\nconst materialLightMap = TSL.materialLightMap;\nconst materialLineDashOffset = TSL.materialLineDashOffset;\nconst materialLineDashSize = TSL.materialLineDashSize;\nconst materialLineGapSize = TSL.materialLineGapSize;\nconst materialLineScale = TSL.materialLineScale;\nconst materialLineWidth = TSL.materialLineWidth;\nconst materialMetalness = TSL.materialMetalness;\nconst materialNormal = TSL.materialNormal;\nconst materialOpacity = TSL.materialOpacity;\nconst materialPointWidth = TSL.materialPointWidth;\nconst materialReference = TSL.materialReference;\nconst materialReflectivity = TSL.materialReflectivity;\nconst materialRefractionRatio = TSL.materialRefractionRatio;\nconst materialRotation = TSL.materialRotation;\nconst materialRoughness = TSL.materialRoughness;\nconst materialSheen = TSL.materialSheen;\nconst materialSheenRoughness = TSL.materialSheenRoughness;\nconst materialShininess = TSL.materialShininess;\nconst materialSpecular = TSL.materialSpecular;\nconst materialSpecularColor = TSL.materialSpecularColor;\nconst materialSpecularIntensity = TSL.materialSpecularIntensity;\nconst materialSpecularStrength = TSL.materialSpecularStrength;\nconst materialThickness = TSL.materialThickness;\nconst materialTransmission = TSL.materialTransmission;\nconst max = TSL.max;\nconst maxMipLevel = TSL.maxMipLevel;\nconst metalness = TSL.metalness;\nconst min = TSL.min;\nconst mix = TSL.mix;\nconst mixElement = TSL.mixElement;\nconst mod = TSL.mod;\nconst modInt = TSL.modInt;\nconst modelDirection = TSL.modelDirection;\nconst modelNormalMatrix = TSL.modelNormalMatrix;\nconst modelPosition = TSL.modelPosition;\nconst modelScale = TSL.modelScale;\nconst modelViewMatrix = TSL.modelViewMatrix;\nconst modelViewPosition = TSL.modelViewPosition;\nconst modelViewProjection = TSL.modelViewProjection;\nconst modelWorldMatrix = TSL.modelWorldMatrix;\nconst modelWorldMatrixInverse = TSL.modelWorldMatrixInverse;\nconst morphReference = TSL.morphReference;\nconst mrt = TSL.mrt;\nconst mul = TSL.mul;\nconst mx_aastep = TSL.mx_aastep;\nconst mx_cell_noise_float = TSL.mx_cell_noise_float;\nconst mx_contrast = TSL.mx_contrast;\nconst mx_fractal_noise_float = TSL.mx_fractal_noise_float;\nconst mx_fractal_noise_vec2 = TSL.mx_fractal_noise_vec2;\nconst mx_fractal_noise_vec3 = TSL.mx_fractal_noise_vec3;\nconst mx_fractal_noise_vec4 = TSL.mx_fractal_noise_vec4;\nconst mx_hsvtorgb = TSL.mx_hsvtorgb;\nconst mx_noise_float = TSL.mx_noise_float;\nconst mx_noise_vec3 = TSL.mx_noise_vec3;\nconst mx_noise_vec4 = TSL.mx_noise_vec4;\nconst mx_ramplr = TSL.mx_ramplr;\nconst mx_ramptb = TSL.mx_ramptb;\nconst mx_rgbtohsv = TSL.mx_rgbtohsv;\nconst mx_safepower = TSL.mx_safepower;\nconst mx_splitlr = TSL.mx_splitlr;\nconst mx_splittb = TSL.mx_splittb;\nconst mx_srgb_texture_to_lin_rec709 = TSL.mx_srgb_texture_to_lin_rec709;\nconst mx_transform_uv = TSL.mx_transform_uv;\nconst mx_worley_noise_float = TSL.mx_worley_noise_float;\nconst mx_worley_noise_vec2 = TSL.mx_worley_noise_vec2;\nconst mx_worley_noise_vec3 = TSL.mx_worley_noise_vec3;\nconst negate = TSL.negate;\nconst neutralToneMapping = TSL.neutralToneMapping;\nconst nodeArray = TSL.nodeArray;\nconst nodeImmutable = TSL.nodeImmutable;\nconst nodeObject = TSL.nodeObject;\nconst nodeObjects = TSL.nodeObjects;\nconst nodeProxy = TSL.nodeProxy;\nconst normalFlat = TSL.normalFlat;\nconst normalGeometry = TSL.normalGeometry;\nconst normalLocal = TSL.normalLocal;\nconst normalMap = TSL.normalMap;\nconst normalView = TSL.normalView;\nconst normalWorld = TSL.normalWorld;\nconst normalize = TSL.normalize;\nconst not = TSL.not;\nconst notEqual = TSL.notEqual;\nconst numWorkgroups = TSL.numWorkgroups;\nconst objectDirection = TSL.objectDirection;\nconst objectGroup = TSL.objectGroup;\nconst objectPosition = TSL.objectPosition;\nconst objectScale = TSL.objectScale;\nconst objectViewPosition = TSL.objectViewPosition;\nconst objectWorldMatrix = TSL.objectWorldMatrix;\nconst oneMinus = TSL.oneMinus;\nconst or = TSL.or;\nconst orthographicDepthToViewZ = TSL.orthographicDepthToViewZ;\nconst oscSawtooth = TSL.oscSawtooth;\nconst oscSine = TSL.oscSine;\nconst oscSquare = TSL.oscSquare;\nconst oscTriangle = TSL.oscTriangle;\nconst output = TSL.output;\nconst outputStruct = TSL.outputStruct;\nconst overlay = TSL.overlay;\nconst overloadingFn = TSL.overloadingFn;\nconst parabola = TSL.parabola;\nconst parallaxDirection = TSL.parallaxDirection;\nconst parallaxUV = TSL.parallaxUV;\nconst parameter = TSL.parameter;\nconst pass = TSL.pass;\nconst passTexture = TSL.passTexture;\nconst pcurve = TSL.pcurve;\nconst perspectiveDepthToViewZ = TSL.perspectiveDepthToViewZ;\nconst pmremTexture = TSL.pmremTexture;\nconst pointUV = TSL.pointUV;\nconst pointWidth = TSL.pointWidth;\nconst positionGeometry = TSL.positionGeometry;\nconst positionLocal = TSL.positionLocal;\nconst positionPrevious = TSL.positionPrevious;\nconst positionView = TSL.positionView;\nconst positionViewDirection = TSL.positionViewDirection;\nconst positionWorld = TSL.positionWorld;\nconst positionWorldDirection = TSL.positionWorldDirection;\nconst posterize = TSL.posterize;\nconst pow = TSL.pow;\nconst pow2 = TSL.pow2;\nconst pow3 = TSL.pow3;\nconst pow4 = TSL.pow4;\nconst property = TSL.property;\nconst radians = TSL.radians;\nconst rand = TSL.rand;\nconst range = TSL.range;\nconst rangeFog = TSL.rangeFog;\nconst reciprocal = TSL.reciprocal;\nconst reference = TSL.reference;\nconst referenceBuffer = TSL.referenceBuffer;\nconst reflect = TSL.reflect;\nconst reflectVector = TSL.reflectVector;\nconst reflectView = TSL.reflectView;\nconst reflector = TSL.reflector;\nconst refract = TSL.refract;\nconst refractVector = TSL.refractVector;\nconst refractView = TSL.refractView;\nconst reinhardToneMapping = TSL.reinhardToneMapping;\nconst remainder = TSL.remainder;\nconst remap = TSL.remap;\nconst remapClamp = TSL.remapClamp;\nconst renderGroup = TSL.renderGroup;\nconst renderOutput = TSL.renderOutput;\nconst rendererReference = TSL.rendererReference;\nconst rotate = TSL.rotate;\nconst rotateUV = TSL.rotateUV;\nconst roughness = TSL.roughness;\nconst round = TSL.round;\nconst rtt = TSL.rtt;\nconst sRGBTransferEOTF = TSL.sRGBTransferEOTF;\nconst sRGBTransferOETF = TSL.sRGBTransferOETF;\nconst sampler = TSL.sampler;\nconst saturate = TSL.saturate;\nconst saturation = TSL.saturation;\nconst screen = TSL.screen;\nconst screenCoordinate = TSL.screenCoordinate;\nconst screenSize = TSL.screenSize;\nconst screenUV = TSL.screenUV;\nconst scriptable = TSL.scriptable;\nconst scriptableValue = TSL.scriptableValue;\nconst select = TSL.select;\nconst setCurrentStack = TSL.setCurrentStack;\nconst shaderStages = TSL.shaderStages;\nconst shadow = TSL.shadow;\nconst sharedUniformGroup = TSL.sharedUniformGroup;\nconst sheen = TSL.sheen;\nconst sheenRoughness = TSL.sheenRoughness;\nconst shiftLeft = TSL.shiftLeft;\nconst shiftRight = TSL.shiftRight;\nconst shininess = TSL.shininess;\nconst sign = TSL.sign;\nconst sin = TSL.sin;\nconst sinc = TSL.sinc;\nconst skinning = TSL.skinning;\nconst skinningReference = TSL.skinningReference;\nconst smoothstep = TSL.smoothstep;\nconst smoothstepElement = TSL.smoothstepElement;\nconst specularColor = TSL.specularColor;\nconst specularF90 = TSL.specularF90;\nconst spherizeUV = TSL.spherizeUV;\nconst split = TSL.split;\nconst spritesheetUV = TSL.spritesheetUV;\nconst sqrt = TSL.sqrt;\nconst stack = TSL.stack;\nconst step = TSL.step;\nconst storage = TSL.storage;\nconst storageBarrier = TSL.storageBarrier;\nconst storageObject = TSL.storageObject;\nconst storageTexture = TSL.storageTexture;\nconst string = TSL.string;\nconst sub = TSL.sub;\nconst subgroupIndex = TSL.subgroupIndex;\nconst subgroupSize = TSL.subgroupSize;\nconst tan = TSL.tan;\nconst tangentGeometry = TSL.tangentGeometry;\nconst tangentLocal = TSL.tangentLocal;\nconst tangentView = TSL.tangentView;\nconst tangentWorld = TSL.tangentWorld;\nconst temp = TSL.temp;\nconst texture = TSL.texture;\nconst texture3D = TSL.texture3D;\nconst textureBarrier = TSL.textureBarrier;\nconst textureBicubic = TSL.textureBicubic;\nconst textureCubeUV = TSL.textureCubeUV;\nconst textureLoad = TSL.textureLoad;\nconst textureSize = TSL.textureSize;\nconst textureStore = TSL.textureStore;\nconst thickness = TSL.thickness;\nconst threshold = TSL.threshold;\nconst time = TSL.time;\nconst timerDelta = TSL.timerDelta;\nconst timerGlobal = TSL.timerGlobal;\nconst timerLocal = TSL.timerLocal;\nconst toOutputColorSpace = TSL.toOutputColorSpace;\nconst toWorkingColorSpace = TSL.toWorkingColorSpace;\nconst toneMapping = TSL.toneMapping;\nconst toneMappingExposure = TSL.toneMappingExposure;\nconst toonOutlinePass = TSL.toonOutlinePass;\nconst transformDirection = TSL.transformDirection;\nconst transformNormal = TSL.transformNormal;\nconst transformNormalToView = TSL.transformNormalToView;\nconst transformedBentNormalView = TSL.transformedBentNormalView;\nconst transformedBitangentView = TSL.transformedBitangentView;\nconst transformedBitangentWorld = TSL.transformedBitangentWorld;\nconst transformedClearcoatNormalView = TSL.transformedClearcoatNormalView;\nconst transformedNormalView = TSL.transformedNormalView;\nconst transformedNormalWorld = TSL.transformedNormalWorld;\nconst transformedTangentView = TSL.transformedTangentView;\nconst transformedTangentWorld = TSL.transformedTangentWorld;\nconst transmission = TSL.transmission;\nconst transpose = TSL.transpose;\nconst tri = TSL.tri;\nconst tri3 = TSL.tri3;\nconst triNoise3D = TSL.triNoise3D;\nconst triplanarTexture = TSL.triplanarTexture;\nconst triplanarTextures = TSL.triplanarTextures;\nconst trunc = TSL.trunc;\nconst tslFn = TSL.tslFn;\nconst uint = TSL.uint;\nconst uniform = TSL.uniform;\nconst uniformArray = TSL.uniformArray;\nconst uniformGroup = TSL.uniformGroup;\nconst uniforms = TSL.uniforms;\nconst userData = TSL.userData;\nconst uv = TSL.uv;\nconst uvec2 = TSL.uvec2;\nconst uvec3 = TSL.uvec3;\nconst uvec4 = TSL.uvec4;\nconst varying = TSL.varying;\nconst varyingProperty = TSL.varyingProperty;\nconst vec2 = TSL.vec2;\nconst vec3 = TSL.vec3;\nconst vec4 = TSL.vec4;\nconst vectorComponents = TSL.vectorComponents;\nconst velocity = TSL.velocity;\nconst vertexColor = TSL.vertexColor;\nconst vertexIndex = TSL.vertexIndex;\nconst vibrance = TSL.vibrance;\nconst viewZToLogarithmicDepth = TSL.viewZToLogarithmicDepth;\nconst viewZToOrthographicDepth = TSL.viewZToOrthographicDepth;\nconst viewZToPerspectiveDepth = TSL.viewZToPerspectiveDepth;\nconst viewport = TSL.viewport;\nconst viewportBottomLeft = TSL.viewportBottomLeft;\nconst viewportCoordinate = TSL.viewportCoordinate;\nconst viewportDepthTexture = TSL.viewportDepthTexture;\nconst viewportLinearDepth = TSL.viewportLinearDepth;\nconst viewportMipTexture = TSL.viewportMipTexture;\nconst viewportResolution = TSL.viewportResolution;\nconst viewportSafeUV = TSL.viewportSafeUV;\nconst viewportSharedTexture = TSL.viewportSharedTexture;\nconst viewportSize = TSL.viewportSize;\nconst viewportTexture = TSL.viewportTexture;\nconst viewportTopLeft = TSL.viewportTopLeft;\nconst viewportUV = TSL.viewportUV;\nconst wgsl = TSL.wgsl;\nconst wgslFn = TSL.wgslFn;\nconst workgroupArray = TSL.workgroupArray;\nconst workgroupBarrier = TSL.workgroupBarrier;\nconst workgroupId = TSL.workgroupId;\nconst workingToColorSpace = TSL.workingToColorSpace;\nconst xor = TSL.xor;\n\nexport { BRDF_GGX, BRDF_Lambert, BasicShadowFilter, Break, Continue, DFGApprox, D_GGX, Discard, EPSILON, F_Schlick, Fn, INFINITY, If, Loop, NodeAccess, NodeShaderStage, NodeType, NodeUpdateType, PCFShadowFilter, PCFSoftShadowFilter, PI, PI2, Return, Schlick_to_F0, ScriptableNodeResources, ShaderNode, TBNViewMatrix, VSMShadowFilter, V_GGX_SmithCorrelated, abs, acesFilmicToneMapping, acos, add, addMethodChaining, addNodeElement, agxToneMapping, all, alphaT, and, anisotropy, anisotropyB, anisotropyT, any, append, arrayBuffer, asin, assign, atan, atan2, atomicAdd, atomicAnd, atomicFunc, atomicMax, atomicMin, atomicOr, atomicStore, atomicSub, atomicXor, attenuationColor, attenuationDistance, attribute, attributeArray, backgroundBlurriness, backgroundIntensity, backgroundRotation, batch, billboarding, bitAnd, bitNot, bitOr, bitXor, bitangentGeometry, bitangentLocal, bitangentView, bitangentWorld, bitcast, blendBurn, blendColor, blendDodge, blendOverlay, blendScreen, blur, bool, buffer, bufferAttribute, bumpMap, burn, bvec2, bvec3, bvec4, bypass, cache, call, cameraFar, cameraNear, cameraNormalMatrix, cameraPosition, cameraProjectionMatrix, cameraProjectionMatrixInverse, cameraViewMatrix, cameraWorldMatrix, cbrt, cdl, ceil, checker, cineonToneMapping, clamp, clearcoat, clearcoatRoughness, code, color, colorSpaceToWorking, colorToDirection, compute, cond, context, convert, convertColorSpace, convertToTexture, cos, cross, cubeTexture, dFdx, dFdy, dashSize, defaultBuildStages, defaultShaderStages, defined, degrees, deltaTime, densityFog, depth, depthPass, difference, diffuseColor, directPointLight, directionToColor, dispersion, distance, div, dodge, dot, drawIndex, dynamicBufferAttribute, element, emissive, equal, equals, equirectUV, exp, exp2, expression, faceDirection, faceForward, float, floor, fog, fract, frameGroup, frameId, frontFacing, fwidth, gain, gapSize, getConstNodeType, getCurrentStack, getDirection, getDistanceAttenuation, getGeometryRoughness, getNormalFromDepth, getParallaxCorrectNormal, getRoughness, getScreenPosition, getShIrradianceAt, getTextureIndex, getViewPosition, glsl, glslFn, grayscale, greaterThan, greaterThanEqual, hash, highPrecisionModelNormalViewMatrix, highPrecisionModelViewMatrix, hue, instance, instanceIndex, instancedArray, instancedBufferAttribute, instancedDynamicBufferAttribute, instancedMesh, int, inverseSqrt, invocationLocalIndex, invocationSubgroupIndex, ior, iridescence, iridescenceIOR, iridescenceThickness, ivec2, ivec3, ivec4, js, label, length, lengthSq, lessThan, lessThanEqual, lightPosition, lightTargetDirection, lightTargetPosition, lightViewPosition, lightingContext, lights, linearDepth, linearToneMapping, localId, log, log2, logarithmicDepthToViewZ, loop, luminance, mat2, mat3, mat4, matcapUV, materialAOMap, materialAlphaTest, materialAnisotropy, materialAnisotropyVector, materialAttenuationColor, materialAttenuationDistance, materialClearcoat, materialClearcoatNormal, materialClearcoatRoughness, materialColor, materialDispersion, materialEmissive, materialIOR, materialIridescence, materialIridescenceIOR, materialIridescenceThickness, materialLightMap, materialLineDashOffset, materialLineDashSize, materialLineGapSize, materialLineScale, materialLineWidth, materialMetalness, materialNormal, materialOpacity, materialPointWidth, materialReference, materialReflectivity, materialRefractionRatio, materialRotation, materialRoughness, materialSheen, materialSheenRoughness, materialShininess, materialSpecular, materialSpecularColor, materialSpecularIntensity, materialSpecularStrength, materialThickness, materialTransmission, max, maxMipLevel, metalness, min, mix, mixElement, mod, modInt, modelDirection, modelNormalMatrix, modelPosition, modelScale, modelViewMatrix, modelViewPosition, modelViewProjection, modelWorldMatrix, modelWorldMatrixInverse, morphReference, mrt, mul, mx_aastep, mx_cell_noise_float, mx_contrast, mx_fractal_noise_float, mx_fractal_noise_vec2, mx_fractal_noise_vec3, mx_fractal_noise_vec4, mx_hsvtorgb, mx_noise_float, mx_noise_vec3, mx_noise_vec4, mx_ramplr, mx_ramptb, mx_rgbtohsv, mx_safepower, mx_splitlr, mx_splittb, mx_srgb_texture_to_lin_rec709, mx_transform_uv, mx_worley_noise_float, mx_worley_noise_vec2, mx_worley_noise_vec3, negate, neutralToneMapping, nodeArray, nodeImmutable, nodeObject, nodeObjects, nodeProxy, normalFlat, normalGeometry, normalLocal, normalMap, normalView, normalWorld, normalize, not, notEqual, numWorkgroups, objectDirection, objectGroup, objectPosition, objectScale, objectViewPosition, objectWorldMatrix, oneMinus, or, orthographicDepthToViewZ, oscSawtooth, oscSine, oscSquare, oscTriangle, output, outputStruct, overlay, overloadingFn, parabola, parallaxDirection, parallaxUV, parameter, pass, passTexture, pcurve, perspectiveDepthToViewZ, pmremTexture, pointUV, pointWidth, positionGeometry, positionLocal, positionPrevious, positionView, positionViewDirection, positionWorld, positionWorldDirection, posterize, pow, pow2, pow3, pow4, property, radians, rand, range, rangeFog, reciprocal, reference, referenceBuffer, reflect, reflectVector, reflectView, reflector, refract, refractVector, refractView, reinhardToneMapping, remainder, remap, remapClamp, renderGroup, renderOutput, rendererReference, rotate, rotateUV, roughness, round, rtt, sRGBTransferEOTF, sRGBTransferOETF, sampler, saturate, saturation, screen, screenCoordinate, screenSize, screenUV, scriptable, scriptableValue, select, setCurrentStack, shaderStages, shadow, sharedUniformGroup, sheen, sheenRoughness, shiftLeft, shiftRight, shininess, sign, sin, sinc, skinning, skinningReference, smoothstep, smoothstepElement, specularColor, specularF90, spherizeUV, split, spritesheetUV, sqrt, stack, step, storage, storageBarrier, storageObject, storageTexture, string, sub, subgroupIndex, subgroupSize, tan, tangentGeometry, tangentLocal, tangentView, tangentWorld, temp, texture, texture3D, textureBarrier, textureBicubic, textureCubeUV, textureLoad, textureSize, textureStore, thickness, threshold, time, timerDelta, timerGlobal, timerLocal, toOutputColorSpace, toWorkingColorSpace, toneMapping, toneMappingExposure, toonOutlinePass, transformDirection, transformNormal, transformNormalToView, transformedBentNormalView, transformedBitangentView, transformedBitangentWorld, transformedClearcoatNormalView, transformedNormalView, transformedNormalWorld, transformedTangentView, transformedTangentWorld, transmission, transpose, tri, tri3, triNoise3D, triplanarTexture, triplanarTextures, trunc, tslFn, uint, uniform, uniformArray, uniformGroup, uniforms, userData, uv, uvec2, uvec3, uvec4, varying, varyingProperty, vec2, vec3, vec4, vectorComponents, velocity, vertexColor, vertexIndex, vibrance, viewZToLogarithmicDepth, viewZToOrthographicDepth, viewZToPerspectiveDepth, viewport, viewportBottomLeft, viewportCoordinate, viewportDepthTexture, viewportLinearDepth, viewportMipTexture, viewportResolution, viewportSafeUV, viewportSharedTexture, viewportSize, viewportTexture, viewportTopLeft, viewportUV, wgsl, wgslFn, workgroupArray, workgroupBarrier, workgroupId, workingToColorSpace, xor };\n","import { HalfFloatType, RenderTarget, Vector2, Vector3, TempNode, QuadMesh, NodeMaterial, PostProcessingUtils, NodeUpdateType } from 'three/webgpu';\nimport { nodeObject, Fn, float, uv, passTexture, uniform, Loop, texture, luminance, smoothstep, mix, vec4, uniformArray, add, int } from 'three/tsl';\n\nconst _quadMesh = /*@__PURE__*/ new QuadMesh();\nconst _size = /*@__PURE__*/ new Vector2();\n\nconst _BlurDirectionX = /*@__PURE__*/ new Vector2( 1.0, 0.0 );\nconst _BlurDirectionY = /*@__PURE__*/ new Vector2( 0.0, 1.0 );\n\nlet _rendererState;\n\nclass BloomNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'BloomNode';\n\n\t}\n\n\tconstructor( inputNode, strength = 1, radius = 0, threshold = 0 ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.inputNode = inputNode;\n\t\tthis.strength = uniform( strength );\n\t\tthis.radius = uniform( radius );\n\t\tthis.threshold = uniform( threshold );\n\n\t\tthis.smoothWidth = uniform( 0.01 );\n\n\t\t//\n\n\t\tthis._renderTargetsHorizontal = [];\n\t\tthis._renderTargetsVertical = [];\n\t\tthis._nMips = 5;\n\n\t\t// render targets\n\n\t\tthis._renderTargetBright = new RenderTarget( 1, 1, { depthBuffer: false, type: HalfFloatType } );\n\t\tthis._renderTargetBright.texture.name = 'UnrealBloomPass.bright';\n\t\tthis._renderTargetBright.texture.generateMipmaps = false;\n\n\t\tfor ( let i = 0; i < this._nMips; i ++ ) {\n\n\t\t\tconst renderTargetHorizontal = new RenderTarget( 1, 1, { depthBuffer: false, type: HalfFloatType } );\n\n\t\t\trenderTargetHorizontal.texture.name = 'UnrealBloomPass.h' + i;\n\t\t\trenderTargetHorizontal.texture.generateMipmaps = false;\n\n\t\t\tthis._renderTargetsHorizontal.push( renderTargetHorizontal );\n\n\t\t\tconst renderTargetVertical = new RenderTarget( 1, 1, { depthBuffer: false, type: HalfFloatType } );\n\n\t\t\trenderTargetVertical.texture.name = 'UnrealBloomPass.v' + i;\n\t\t\trenderTargetVertical.texture.generateMipmaps = false;\n\n\t\t\tthis._renderTargetsVertical.push( renderTargetVertical );\n\n\t\t}\n\n\t\t// materials\n\n\t\tthis._compositeMaterial = null;\n\t\tthis._highPassFilterMaterial = null;\n\t\tthis._separableBlurMaterials = [];\n\n\t\t// pass and texture nodes\n\n\t\tthis._textureNodeBright = texture( this._renderTargetBright.texture );\n\t\tthis._textureNodeBlur0 = texture( this._renderTargetsVertical[ 0 ].texture );\n\t\tthis._textureNodeBlur1 = texture( this._renderTargetsVertical[ 1 ].texture );\n\t\tthis._textureNodeBlur2 = texture( this._renderTargetsVertical[ 2 ].texture );\n\t\tthis._textureNodeBlur3 = texture( this._renderTargetsVertical[ 3 ].texture );\n\t\tthis._textureNodeBlur4 = texture( this._renderTargetsVertical[ 4 ].texture );\n\n\t\tthis._textureOutput = passTexture( this, this._renderTargetsHorizontal[ 0 ].texture );\n\n\t\tthis.updateBeforeType = NodeUpdateType.FRAME;\n\n\t}\n\n\tgetTextureNode() {\n\n\t\treturn this._textureOutput;\n\n\t}\n\n\tsetSize( width, height ) {\n\n\t\tlet resx = Math.round( width / 2 );\n\t\tlet resy = Math.round( height / 2 );\n\n\t\tthis._renderTargetBright.setSize( resx, resy );\n\n\t\tfor ( let i = 0; i < this._nMips; i ++ ) {\n\n\t\t\tthis._renderTargetsHorizontal[ i ].setSize( resx, resy );\n\t\t\tthis._renderTargetsVertical[ i ].setSize( resx, resy );\n\n\t\t\tthis._separableBlurMaterials[ i ].invSize.value.set( 1 / resx, 1 / resy );\n\n\t\t\tresx = Math.round( resx / 2 );\n\t\t\tresy = Math.round( resy / 2 );\n\n\t\t}\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst { renderer } = frame;\n\n\t\t_rendererState = PostProcessingUtils.resetRendererState( renderer, _rendererState );\n\n\t\t//\n\n\t\tconst size = renderer.getDrawingBufferSize( _size );\n\t\tthis.setSize( size.width, size.height );\n\n\t\t// 1. Extract Bright Areas\n\n\t\trenderer.setRenderTarget( this._renderTargetBright );\n\t\t_quadMesh.material = this._highPassFilterMaterial;\n\t\t_quadMesh.render( renderer );\n\n\t\t// 2. Blur All the mips progressively\n\n\t\tlet inputRenderTarget = this._renderTargetBright;\n\n\t\tfor ( let i = 0; i < this._nMips; i ++ ) {\n\n\t\t\t_quadMesh.material = this._separableBlurMaterials[ i ];\n\n\t\t\tthis._separableBlurMaterials[ i ].colorTexture.value = inputRenderTarget.texture;\n\t\t\tthis._separableBlurMaterials[ i ].direction.value = _BlurDirectionX;\n\t\t\trenderer.setRenderTarget( this._renderTargetsHorizontal[ i ] );\n\t\t\t_quadMesh.render( renderer );\n\n\t\t\tthis._separableBlurMaterials[ i ].colorTexture.value = this._renderTargetsHorizontal[ i ].texture;\n\t\t\tthis._separableBlurMaterials[ i ].direction.value = _BlurDirectionY;\n\t\t\trenderer.setRenderTarget( this._renderTargetsVertical[ i ] );\n\t\t\t_quadMesh.render( renderer );\n\n\t\t\tinputRenderTarget = this._renderTargetsVertical[ i ];\n\n\t\t}\n\n\t\t// 3. Composite All the mips\n\n\t\trenderer.setRenderTarget( this._renderTargetsHorizontal[ 0 ] );\n\t\t_quadMesh.material = this._compositeMaterial;\n\t\t_quadMesh.render( renderer );\n\n\t\t// restore\n\n\t\tPostProcessingUtils.restoreRendererState( renderer, _rendererState );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\t// luminosity high pass material\n\n\t\tconst luminosityHighPass = Fn( () => {\n\n\t\t\tconst texel = this.inputNode;\n\t\t\tconst v = luminance( texel.rgb );\n\n\t\t\tconst alpha = smoothstep( this.threshold, this.threshold.add( this.smoothWidth ), v );\n\n\t\t\treturn mix( vec4( 0 ), texel, alpha );\n\n\t\t} );\n\n\t\tthis._highPassFilterMaterial = this._highPassFilterMaterial || new NodeMaterial();\n\t\tthis._highPassFilterMaterial.fragmentNode = luminosityHighPass().context( builder.getSharedContext() );\n\t\tthis._highPassFilterMaterial.name = 'Bloom_highPass';\n\t\tthis._highPassFilterMaterial.needsUpdate = true;\n\n\t\t// gaussian blur materials\n\n\t\tconst kernelSizeArray = [ 3, 5, 7, 9, 11 ];\n\n\t\tfor ( let i = 0; i < this._nMips; i ++ ) {\n\n\t\t\tthis._separableBlurMaterials.push( this._getSeperableBlurMaterial( builder, kernelSizeArray[ i ] ) );\n\n\t\t}\n\n\t\t// composite material\n\n\t\tconst bloomFactors = uniformArray( [ 1.0, 0.8, 0.6, 0.4, 0.2 ] );\n\t\tconst bloomTintColors = uniformArray( [ new Vector3( 1, 1, 1 ), new Vector3( 1, 1, 1 ), new Vector3( 1, 1, 1 ), new Vector3( 1, 1, 1 ), new Vector3( 1, 1, 1 ) ] );\n\n\t\tconst lerpBloomFactor = Fn( ( [ factor, radius ] ) => {\n\n\t\t\tconst mirrorFactor = float( 1.2 ).sub( factor );\n\t\t\treturn mix( factor, mirrorFactor, radius );\n\n\t\t} ).setLayout( {\n\t\t\tname: 'lerpBloomFactor',\n\t\t\ttype: 'float',\n\t\t\tinputs: [\n\t\t\t\t{ name: 'factor', type: 'float' },\n\t\t\t\t{ name: 'radius', type: 'float' },\n\t\t\t]\n\t\t} );\n\n\n\t\tconst compositePass = Fn( () => {\n\n\t\t\tconst color0 = lerpBloomFactor( bloomFactors.element( 0 ), this.radius ).mul( vec4( bloomTintColors.element( 0 ), 1.0 ) ).mul( this._textureNodeBlur0 );\n\t\t\tconst color1 = lerpBloomFactor( bloomFactors.element( 1 ), this.radius ).mul( vec4( bloomTintColors.element( 1 ), 1.0 ) ).mul( this._textureNodeBlur1 );\n\t\t\tconst color2 = lerpBloomFactor( bloomFactors.element( 2 ), this.radius ).mul( vec4( bloomTintColors.element( 2 ), 1.0 ) ).mul( this._textureNodeBlur2 );\n\t\t\tconst color3 = lerpBloomFactor( bloomFactors.element( 3 ), this.radius ).mul( vec4( bloomTintColors.element( 3 ), 1.0 ) ).mul( this._textureNodeBlur3 );\n\t\t\tconst color4 = lerpBloomFactor( bloomFactors.element( 4 ), this.radius ).mul( vec4( bloomTintColors.element( 4 ), 1.0 ) ).mul( this._textureNodeBlur4 );\n\n\t\t\tconst sum = color0.add( color1 ).add( color2 ).add( color3 ).add( color4 );\n\n\t\t\treturn sum.mul( this.strength );\n\n\t\t} );\n\n\t\tthis._compositeMaterial = this._compositeMaterial || new NodeMaterial();\n\t\tthis._compositeMaterial.fragmentNode = compositePass().context( builder.getSharedContext() );\n\t\tthis._compositeMaterial.name = 'Bloom_comp';\n\t\tthis._compositeMaterial.needsUpdate = true;\n\n\t\t//\n\n\t\treturn this._textureOutput;\n\n\t}\n\n\tdispose() {\n\n\t\tfor ( let i = 0; i < this._renderTargetsHorizontal.length; i ++ ) {\n\n\t\t\tthis._renderTargetsHorizontal[ i ].dispose();\n\n\t\t}\n\n\t\tfor ( let i = 0; i < this._renderTargetsVertical.length; i ++ ) {\n\n\t\t\tthis._renderTargetsVertical[ i ].dispose();\n\n\t\t}\n\n\t\tthis._renderTargetBright.dispose();\n\n\t}\n\n\t_getSeperableBlurMaterial( builder, kernelRadius ) {\n\n\t\tconst coefficients = [];\n\n\t\tfor ( let i = 0; i < kernelRadius; i ++ ) {\n\n\t\t\tcoefficients.push( 0.39894 * Math.exp( - 0.5 * i * i / ( kernelRadius * kernelRadius ) ) / kernelRadius );\n\n\t\t}\n\n\t\t//\n\n\t\tconst colorTexture = texture();\n\t\tconst gaussianCoefficients = uniformArray( coefficients );\n\t\tconst invSize = uniform( new Vector2() );\n\t\tconst direction = uniform( new Vector2( 0.5, 0.5 ) );\n\n\t\tconst uvNode = uv();\n\t\tconst sampleTexel = ( uv ) => colorTexture.uv( uv );\n\n\t\tconst seperableBlurPass = Fn( () => {\n\n\t\t\tconst weightSum = gaussianCoefficients.element( 0 ).toVar();\n\t\t\tconst diffuseSum = sampleTexel( uvNode ).rgb.mul( weightSum ).toVar();\n\n\t\t\tLoop( { start: int( 1 ), end: int( kernelRadius ), type: 'int', condition: '<' }, ( { i } ) => {\n\n\t\t\t\tconst x = float( i );\n\t\t\t\tconst w = gaussianCoefficients.element( i );\n\t\t\t\tconst uvOffset = direction.mul( invSize ).mul( x );\n\t\t\t\tconst sample1 = sampleTexel( uvNode.add( uvOffset ) ).rgb;\n\t\t\t\tconst sample2 = sampleTexel( uvNode.sub( uvOffset ) ).rgb;\n\t\t\t\tdiffuseSum.addAssign( add( sample1, sample2 ).mul( w ) );\n\t\t\t\tweightSum.addAssign( float( 2.0 ).mul( w ) );\n\n\t\t\t} );\n\n\t\t\treturn vec4( diffuseSum.div( weightSum ), 1.0 );\n\n\t\t} );\n\n\t\tconst seperableBlurMaterial = new NodeMaterial();\n\t\tseperableBlurMaterial.fragmentNode = seperableBlurPass().context( builder.getSharedContext() );\n\t\tseperableBlurMaterial.name = 'Bloom_seperable';\n\t\tseperableBlurMaterial.needsUpdate = true;\n\n\t\t// uniforms\n\t\tseperableBlurMaterial.colorTexture = colorTexture;\n\t\tseperableBlurMaterial.direction = direction;\n\t\tseperableBlurMaterial.invSize = invSize;\n\n\t\treturn seperableBlurMaterial;\n\n\t}\n\n}\n\nexport const bloom = ( node, strength, radius, threshold ) => nodeObject( new BloomNode( nodeObject( node ), strength, radius, threshold ) );\n\nexport default BloomNode;\n","import {\n\tControls,\n\tMOUSE,\n\tQuaternion,\n\tSpherical,\n\tTOUCH,\n\tVector2,\n\tVector3,\n\tPlane,\n\tRay,\n\tMathUtils\n} from 'three';\n\n// OrbitControls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one-finger move\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\n\nconst _changeEvent = { type: 'change' };\nconst _startEvent = { type: 'start' };\nconst _endEvent = { type: 'end' };\nconst _ray = new Ray();\nconst _plane = new Plane();\nconst _TILT_LIMIT = Math.cos( 70 * MathUtils.DEG2RAD );\n\nconst _v = new Vector3();\nconst _twoPI = 2 * Math.PI;\n\nconst _STATE = {\n\tNONE: - 1,\n\tROTATE: 0,\n\tDOLLY: 1,\n\tPAN: 2,\n\tTOUCH_ROTATE: 3,\n\tTOUCH_PAN: 4,\n\tTOUCH_DOLLY_PAN: 5,\n\tTOUCH_DOLLY_ROTATE: 6\n};\nconst _EPS = 0.000001;\n\nclass OrbitControls extends Controls {\n\n\tconstructor( object, domElement = null ) {\n\n\t\tsuper( object, domElement );\n\n\t\tthis.state = _STATE.NONE;\n\n\t\t// Set to false to disable this control\n\t\tthis.enabled = true;\n\n\t\t// \"target\" sets the location of focus, where the object orbits around\n\t\tthis.target = new Vector3();\n\n\t\t// Sets the 3D cursor (similar to Blender), from which the maxTargetRadius takes effect\n\t\tthis.cursor = new Vector3();\n\n\t\t// How far you can dolly in and out ( PerspectiveCamera only )\n\t\tthis.minDistance = 0;\n\t\tthis.maxDistance = Infinity;\n\n\t\t// How far you can zoom in and out ( OrthographicCamera only )\n\t\tthis.minZoom = 0;\n\t\tthis.maxZoom = Infinity;\n\n\t\t// Limit camera target within a spherical area around the cursor\n\t\tthis.minTargetRadius = 0;\n\t\tthis.maxTargetRadius = Infinity;\n\n\t\t// How far you can orbit vertically, upper and lower limits.\n\t\t// Range is 0 to Math.PI radians.\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\n\t\t// How far you can orbit horizontally, upper and lower limits.\n\t\t// If set, the interval [ min, max ] must be a sub-interval of [ - 2 PI, 2 PI ], with ( max - min < 2 PI )\n\t\tthis.minAzimuthAngle = - Infinity; // radians\n\t\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t\t// Set to true to enable damping (inertia)\n\t\t// If damping is enabled, you must call controls.update() in your animation loop\n\t\tthis.enableDamping = false;\n\t\tthis.dampingFactor = 0.05;\n\n\t\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t\t// Set to false to disable zooming\n\t\tthis.enableZoom = true;\n\t\tthis.zoomSpeed = 1.0;\n\n\t\t// Set to false to disable rotating\n\t\tthis.enableRotate = true;\n\t\tthis.rotateSpeed = 1.0;\n\n\t\t// Set to false to disable panning\n\t\tthis.enablePan = true;\n\t\tthis.panSpeed = 1.0;\n\t\tthis.screenSpacePanning = true; // if false, pan orthogonal to world-space direction camera.up\n\t\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\t\tthis.zoomToCursor = false;\n\n\t\t// Set to true to automatically rotate around the target\n\t\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\t\tthis.autoRotate = false;\n\t\tthis.autoRotateSpeed = 2.0; // 30 seconds per orbit when fps is 60\n\n\t\t// The four arrow keys\n\t\tthis.keys = { LEFT: 'ArrowLeft', UP: 'ArrowUp', RIGHT: 'ArrowRight', BOTTOM: 'ArrowDown' };\n\n\t\t// Mouse buttons\n\t\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\n\n\t\t// Touch fingers\n\t\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\n\n\t\t// for reset\n\t\tthis.target0 = this.target.clone();\n\t\tthis.position0 = this.object.position.clone();\n\t\tthis.zoom0 = this.object.zoom;\n\n\t\t// the target DOM element for key events\n\t\tthis._domElementKeyEvents = null;\n\n\t\t// internals\n\n\t\tthis._lastPosition = new Vector3();\n\t\tthis._lastQuaternion = new Quaternion();\n\t\tthis._lastTargetPosition = new Vector3();\n\n\t\t// so camera.up is the orbit axis\n\t\tthis._quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\n\t\tthis._quatInverse = this._quat.clone().invert();\n\n\t\t// current position in spherical coordinates\n\t\tthis._spherical = new Spherical();\n\t\tthis._sphericalDelta = new Spherical();\n\n\t\tthis._scale = 1;\n\t\tthis._panOffset = new Vector3();\n\n\t\tthis._rotateStart = new Vector2();\n\t\tthis._rotateEnd = new Vector2();\n\t\tthis._rotateDelta = new Vector2();\n\n\t\tthis._panStart = new Vector2();\n\t\tthis._panEnd = new Vector2();\n\t\tthis._panDelta = new Vector2();\n\n\t\tthis._dollyStart = new Vector2();\n\t\tthis._dollyEnd = new Vector2();\n\t\tthis._dollyDelta = new Vector2();\n\n\t\tthis._dollyDirection = new Vector3();\n\t\tthis._mouse = new Vector2();\n\t\tthis._performCursorZoom = false;\n\n\t\tthis._pointers = [];\n\t\tthis._pointerPositions = {};\n\n\t\tthis._controlActive = false;\n\n\t\t// event listeners\n\n\t\tthis._onPointerMove = onPointerMove.bind( this );\n\t\tthis._onPointerDown = onPointerDown.bind( this );\n\t\tthis._onPointerUp = onPointerUp.bind( this );\n\t\tthis._onContextMenu = onContextMenu.bind( this );\n\t\tthis._onMouseWheel = onMouseWheel.bind( this );\n\t\tthis._onKeyDown = onKeyDown.bind( this );\n\n\t\tthis._onTouchStart = onTouchStart.bind( this );\n\t\tthis._onTouchMove = onTouchMove.bind( this );\n\n\t\tthis._onMouseDown = onMouseDown.bind( this );\n\t\tthis._onMouseMove = onMouseMove.bind( this );\n\n\t\tthis._interceptControlDown = interceptControlDown.bind( this );\n\t\tthis._interceptControlUp = interceptControlUp.bind( this );\n\n\t\t//\n\n\t\tif ( this.domElement !== null ) {\n\n\t\t\tthis.connect();\n\n\t\t}\n\n\t\tthis.update();\n\n\t}\n\n\tconnect() {\n\n\t\tthis.domElement.addEventListener( 'pointerdown', this._onPointerDown );\n\t\tthis.domElement.addEventListener( 'pointercancel', this._onPointerUp );\n\n\t\tthis.domElement.addEventListener( 'contextmenu', this._onContextMenu );\n\t\tthis.domElement.addEventListener( 'wheel', this._onMouseWheel, { passive: false } );\n\n\t\tconst document = this.domElement.getRootNode(); // offscreen canvas compatibility\n\t\tdocument.addEventListener( 'keydown', this._interceptControlDown, { passive: true, capture: true } );\n\n\t\tthis.domElement.style.touchAction = 'none'; // disable touch scroll\n\n\t}\n\n\tdisconnect() {\n\n\t\tthis.domElement.removeEventListener( 'pointerdown', this._onPointerDown );\n\t\tthis.domElement.removeEventListener( 'pointermove', this._onPointerMove );\n\t\tthis.domElement.removeEventListener( 'pointerup', this._onPointerUp );\n\t\tthis.domElement.removeEventListener( 'pointercancel', this._onPointerUp );\n\n\t\tthis.domElement.removeEventListener( 'wheel', this._onMouseWheel );\n\t\tthis.domElement.removeEventListener( 'contextmenu', this._onContextMenu );\n\n\t\tthis.stopListenToKeyEvents();\n\n\t\tconst document = this.domElement.getRootNode(); // offscreen canvas compatibility\n\t\tdocument.removeEventListener( 'keydown', this._interceptControlDown, { capture: true } );\n\n\t\tthis.domElement.style.touchAction = 'auto';\n\n\t}\n\n\tdispose() {\n\n\t\tthis.disconnect();\n\n\t}\n\n\tgetPolarAngle() {\n\n\t\treturn this._spherical.phi;\n\n\t}\n\n\tgetAzimuthalAngle() {\n\n\t\treturn this._spherical.theta;\n\n\t}\n\n\tgetDistance() {\n\n\t\treturn this.object.position.distanceTo( this.target );\n\n\t}\n\n\tlistenToKeyEvents( domElement ) {\n\n\t\tdomElement.addEventListener( 'keydown', this._onKeyDown );\n\t\tthis._domElementKeyEvents = domElement;\n\n\t}\n\n\tstopListenToKeyEvents() {\n\n\t\tif ( this._domElementKeyEvents !== null ) {\n\n\t\t\tthis._domElementKeyEvents.removeEventListener( 'keydown', this._onKeyDown );\n\t\t\tthis._domElementKeyEvents = null;\n\n\t\t}\n\n\t}\n\n\tsaveState() {\n\n\t\tthis.target0.copy( this.target );\n\t\tthis.position0.copy( this.object.position );\n\t\tthis.zoom0 = this.object.zoom;\n\n\t}\n\n\treset() {\n\n\t\tthis.target.copy( this.target0 );\n\t\tthis.object.position.copy( this.position0 );\n\t\tthis.object.zoom = this.zoom0;\n\n\t\tthis.object.updateProjectionMatrix();\n\t\tthis.dispatchEvent( _changeEvent );\n\n\t\tthis.update();\n\n\t\tthis.state = _STATE.NONE;\n\n\t}\n\n\tupdate( deltaTime = null ) {\n\n\t\tconst position = this.object.position;\n\n\t\t_v.copy( position ).sub( this.target );\n\n\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t_v.applyQuaternion( this._quat );\n\n\t\t// angle from z-axis around y-axis\n\t\tthis._spherical.setFromVector3( _v );\n\n\t\tif ( this.autoRotate && this.state === _STATE.NONE ) {\n\n\t\t\tthis._rotateLeft( this._getAutoRotationAngle( deltaTime ) );\n\n\t\t}\n\n\t\tif ( this.enableDamping ) {\n\n\t\t\tthis._spherical.theta += this._sphericalDelta.theta * this.dampingFactor;\n\t\t\tthis._spherical.phi += this._sphericalDelta.phi * this.dampingFactor;\n\n\t\t} else {\n\n\t\t\tthis._spherical.theta += this._sphericalDelta.theta;\n\t\t\tthis._spherical.phi += this._sphericalDelta.phi;\n\n\t\t}\n\n\t\t// restrict theta to be between desired limits\n\n\t\tlet min = this.minAzimuthAngle;\n\t\tlet max = this.maxAzimuthAngle;\n\n\t\tif ( isFinite( min ) && isFinite( max ) ) {\n\n\t\t\tif ( min < - Math.PI ) min += _twoPI; else if ( min > Math.PI ) min -= _twoPI;\n\n\t\t\tif ( max < - Math.PI ) max += _twoPI; else if ( max > Math.PI ) max -= _twoPI;\n\n\t\t\tif ( min <= max ) {\n\n\t\t\t\tthis._spherical.theta = Math.max( min, Math.min( max, this._spherical.theta ) );\n\n\t\t\t} else {\n\n\t\t\t\tthis._spherical.theta = ( this._spherical.theta > ( min + max ) / 2 ) ?\n\t\t\t\t\tMath.max( min, this._spherical.theta ) :\n\t\t\t\t\tMath.min( max, this._spherical.theta );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// restrict phi to be between desired limits\n\t\tthis._spherical.phi = Math.max( this.minPolarAngle, Math.min( this.maxPolarAngle, this._spherical.phi ) );\n\n\t\tthis._spherical.makeSafe();\n\n\n\t\t// move target to panned location\n\n\t\tif ( this.enableDamping === true ) {\n\n\t\t\tthis.target.addScaledVector( this._panOffset, this.dampingFactor );\n\n\t\t} else {\n\n\t\t\tthis.target.add( this._panOffset );\n\n\t\t}\n\n\t\t// Limit the target distance from the cursor to create a sphere around the center of interest\n\t\tthis.target.sub( this.cursor );\n\t\tthis.target.clampLength( this.minTargetRadius, this.maxTargetRadius );\n\t\tthis.target.add( this.cursor );\n\n\t\tlet zoomChanged = false;\n\t\t// adjust the camera position based on zoom only if we're not zooming to the cursor or if it's an ortho camera\n\t\t// we adjust zoom later in these cases\n\t\tif ( this.zoomToCursor && this._performCursorZoom || this.object.isOrthographicCamera ) {\n\n\t\t\tthis._spherical.radius = this._clampDistance( this._spherical.radius );\n\n\t\t} else {\n\n\t\t\tconst prevRadius = this._spherical.radius;\n\t\t\tthis._spherical.radius = this._clampDistance( this._spherical.radius * this._scale );\n\t\t\tzoomChanged = prevRadius != this._spherical.radius;\n\n\t\t}\n\n\t\t_v.setFromSpherical( this._spherical );\n\n\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t_v.applyQuaternion( this._quatInverse );\n\n\t\tposition.copy( this.target ).add( _v );\n\n\t\tthis.object.lookAt( this.target );\n\n\t\tif ( this.enableDamping === true ) {\n\n\t\t\tthis._sphericalDelta.theta *= ( 1 - this.dampingFactor );\n\t\t\tthis._sphericalDelta.phi *= ( 1 - this.dampingFactor );\n\n\t\t\tthis._panOffset.multiplyScalar( 1 - this.dampingFactor );\n\n\t\t} else {\n\n\t\t\tthis._sphericalDelta.set( 0, 0, 0 );\n\n\t\t\tthis._panOffset.set( 0, 0, 0 );\n\n\t\t}\n\n\t\t// adjust camera position\n\t\tif ( this.zoomToCursor && this._performCursorZoom ) {\n\n\t\t\tlet newRadius = null;\n\t\t\tif ( this.object.isPerspectiveCamera ) {\n\n\t\t\t\t// move the camera down the pointer ray\n\t\t\t\t// this method avoids floating point error\n\t\t\t\tconst prevRadius = _v.length();\n\t\t\t\tnewRadius = this._clampDistance( prevRadius * this._scale );\n\n\t\t\t\tconst radiusDelta = prevRadius - newRadius;\n\t\t\t\tthis.object.position.addScaledVector( this._dollyDirection, radiusDelta );\n\t\t\t\tthis.object.updateMatrixWorld();\n\n\t\t\t\tzoomChanged = !! radiusDelta;\n\n\t\t\t} else if ( this.object.isOrthographicCamera ) {\n\n\t\t\t\t// adjust the ortho camera position based on zoom changes\n\t\t\t\tconst mouseBefore = new Vector3( this._mouse.x, this._mouse.y, 0 );\n\t\t\t\tmouseBefore.unproject( this.object );\n\n\t\t\t\tconst prevZoom = this.object.zoom;\n\t\t\t\tthis.object.zoom = Math.max( this.minZoom, Math.min( this.maxZoom, this.object.zoom / this._scale ) );\n\t\t\t\tthis.object.updateProjectionMatrix();\n\n\t\t\t\tzoomChanged = prevZoom !== this.object.zoom;\n\n\t\t\t\tconst mouseAfter = new Vector3( this._mouse.x, this._mouse.y, 0 );\n\t\t\t\tmouseAfter.unproject( this.object );\n\n\t\t\t\tthis.object.position.sub( mouseAfter ).add( mouseBefore );\n\t\t\t\tthis.object.updateMatrixWorld();\n\n\t\t\t\tnewRadius = _v.length();\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled.' );\n\t\t\t\tthis.zoomToCursor = false;\n\n\t\t\t}\n\n\t\t\t// handle the placement of the target\n\t\t\tif ( newRadius !== null ) {\n\n\t\t\t\tif ( this.screenSpacePanning ) {\n\n\t\t\t\t\t// position the orbit target in front of the new camera position\n\t\t\t\t\tthis.target.set( 0, 0, - 1 )\n\t\t\t\t\t\t.transformDirection( this.object.matrix )\n\t\t\t\t\t\t.multiplyScalar( newRadius )\n\t\t\t\t\t\t.add( this.object.position );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// get the ray and translation plane to compute target\n\t\t\t\t\t_ray.origin.copy( this.object.position );\n\t\t\t\t\t_ray.direction.set( 0, 0, - 1 ).transformDirection( this.object.matrix );\n\n\t\t\t\t\t// if the camera is 20 degrees above the horizon then don't adjust the focus target to avoid\n\t\t\t\t\t// extremely large values\n\t\t\t\t\tif ( Math.abs( this.object.up.dot( _ray.direction ) ) < _TILT_LIMIT ) {\n\n\t\t\t\t\t\tthis.object.lookAt( this.target );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t_plane.setFromNormalAndCoplanarPoint( this.object.up, this.target );\n\t\t\t\t\t\t_ray.intersectPlane( _plane, this.target );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( this.object.isOrthographicCamera ) {\n\n\t\t\tconst prevZoom = this.object.zoom;\n\t\t\tthis.object.zoom = Math.max( this.minZoom, Math.min( this.maxZoom, this.object.zoom / this._scale ) );\n\n\t\t\tif ( prevZoom !== this.object.zoom ) {\n\n\t\t\t\tthis.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis._scale = 1;\n\t\tthis._performCursorZoom = false;\n\n\t\t// update condition is:\n\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\tif ( zoomChanged ||\n\t\t\tthis._lastPosition.distanceToSquared( this.object.position ) > _EPS ||\n\t\t\t8 * ( 1 - this._lastQuaternion.dot( this.object.quaternion ) ) > _EPS ||\n\t\t\tthis._lastTargetPosition.distanceToSquared( this.target ) > _EPS ) {\n\n\t\t\tthis.dispatchEvent( _changeEvent );\n\n\t\t\tthis._lastPosition.copy( this.object.position );\n\t\t\tthis._lastQuaternion.copy( this.object.quaternion );\n\t\t\tthis._lastTargetPosition.copy( this.target );\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\t_getAutoRotationAngle( deltaTime ) {\n\n\t\tif ( deltaTime !== null ) {\n\n\t\t\treturn ( _twoPI / 60 * this.autoRotateSpeed ) * deltaTime;\n\n\t\t} else {\n\n\t\t\treturn _twoPI / 60 / 60 * this.autoRotateSpeed;\n\n\t\t}\n\n\t}\n\n\t_getZoomScale( delta ) {\n\n\t\tconst normalizedDelta = Math.abs( delta * 0.01 );\n\t\treturn Math.pow( 0.95, this.zoomSpeed * normalizedDelta );\n\n\t}\n\n\t_rotateLeft( angle ) {\n\n\t\tthis._sphericalDelta.theta -= angle;\n\n\t}\n\n\t_rotateUp( angle ) {\n\n\t\tthis._sphericalDelta.phi -= angle;\n\n\t}\n\n\t_panLeft( distance, objectMatrix ) {\n\n\t\t_v.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t_v.multiplyScalar( - distance );\n\n\t\tthis._panOffset.add( _v );\n\n\t}\n\n\t_panUp( distance, objectMatrix ) {\n\n\t\tif ( this.screenSpacePanning === true ) {\n\n\t\t\t_v.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t} else {\n\n\t\t\t_v.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t_v.crossVectors( this.object.up, _v );\n\n\t\t}\n\n\t\t_v.multiplyScalar( distance );\n\n\t\tthis._panOffset.add( _v );\n\n\t}\n\n\t// deltaX and deltaY are in pixels; right and down are positive\n\t_pan( deltaX, deltaY ) {\n\n\t\tconst element = this.domElement;\n\n\t\tif ( this.object.isPerspectiveCamera ) {\n\n\t\t\t// perspective\n\t\t\tconst position = this.object.position;\n\t\t\t_v.copy( position ).sub( this.target );\n\t\t\tlet targetDistance = _v.length();\n\n\t\t\t// half of the fov is center to top of screen\n\t\t\ttargetDistance *= Math.tan( ( this.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\tthis._panLeft( 2 * deltaX * targetDistance / element.clientHeight, this.object.matrix );\n\t\t\tthis._panUp( 2 * deltaY * targetDistance / element.clientHeight, this.object.matrix );\n\n\t\t} else if ( this.object.isOrthographicCamera ) {\n\n\t\t\t// orthographic\n\t\t\tthis._panLeft( deltaX * ( this.object.right - this.object.left ) / this.object.zoom / element.clientWidth, this.object.matrix );\n\t\t\tthis._panUp( deltaY * ( this.object.top - this.object.bottom ) / this.object.zoom / element.clientHeight, this.object.matrix );\n\n\t\t} else {\n\n\t\t\t// camera neither orthographic nor perspective\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\tthis.enablePan = false;\n\n\t\t}\n\n\t}\n\n\t_dollyOut( dollyScale ) {\n\n\t\tif ( this.object.isPerspectiveCamera || this.object.isOrthographicCamera ) {\n\n\t\t\tthis._scale /= dollyScale;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tthis.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\t_dollyIn( dollyScale ) {\n\n\t\tif ( this.object.isPerspectiveCamera || this.object.isOrthographicCamera ) {\n\n\t\t\tthis._scale *= dollyScale;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tthis.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\t_updateZoomParameters( x, y ) {\n\n\t\tif ( ! this.zoomToCursor ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis._performCursorZoom = true;\n\n\t\tconst rect = this.domElement.getBoundingClientRect();\n\t\tconst dx = x - rect.left;\n\t\tconst dy = y - rect.top;\n\t\tconst w = rect.width;\n\t\tconst h = rect.height;\n\n\t\tthis._mouse.x = ( dx / w ) * 2 - 1;\n\t\tthis._mouse.y = - ( dy / h ) * 2 + 1;\n\n\t\tthis._dollyDirection.set( this._mouse.x, this._mouse.y, 1 ).unproject( this.object ).sub( this.object.position ).normalize();\n\n\t}\n\n\t_clampDistance( dist ) {\n\n\t\treturn Math.max( this.minDistance, Math.min( this.maxDistance, dist ) );\n\n\t}\n\n\t//\n\t// event callbacks - update the object state\n\t//\n\n\t_handleMouseDownRotate( event ) {\n\n\t\tthis._rotateStart.set( event.clientX, event.clientY );\n\n\t}\n\n\t_handleMouseDownDolly( event ) {\n\n\t\tthis._updateZoomParameters( event.clientX, event.clientX );\n\t\tthis._dollyStart.set( event.clientX, event.clientY );\n\n\t}\n\n\t_handleMouseDownPan( event ) {\n\n\t\tthis._panStart.set( event.clientX, event.clientY );\n\n\t}\n\n\t_handleMouseMoveRotate( event ) {\n\n\t\tthis._rotateEnd.set( event.clientX, event.clientY );\n\n\t\tthis._rotateDelta.subVectors( this._rotateEnd, this._rotateStart ).multiplyScalar( this.rotateSpeed );\n\n\t\tconst element = this.domElement;\n\n\t\tthis._rotateLeft( _twoPI * this._rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\tthis._rotateUp( _twoPI * this._rotateDelta.y / element.clientHeight );\n\n\t\tthis._rotateStart.copy( this._rotateEnd );\n\n\t\tthis.update();\n\n\t}\n\n\t_handleMouseMoveDolly( event ) {\n\n\t\tthis._dollyEnd.set( event.clientX, event.clientY );\n\n\t\tthis._dollyDelta.subVectors( this._dollyEnd, this._dollyStart );\n\n\t\tif ( this._dollyDelta.y > 0 ) {\n\n\t\t\tthis._dollyOut( this._getZoomScale( this._dollyDelta.y ) );\n\n\t\t} else if ( this._dollyDelta.y < 0 ) {\n\n\t\t\tthis._dollyIn( this._getZoomScale( this._dollyDelta.y ) );\n\n\t\t}\n\n\t\tthis._dollyStart.copy( this._dollyEnd );\n\n\t\tthis.update();\n\n\t}\n\n\t_handleMouseMovePan( event ) {\n\n\t\tthis._panEnd.set( event.clientX, event.clientY );\n\n\t\tthis._panDelta.subVectors( this._panEnd, this._panStart ).multiplyScalar( this.panSpeed );\n\n\t\tthis._pan( this._panDelta.x, this._panDelta.y );\n\n\t\tthis._panStart.copy( this._panEnd );\n\n\t\tthis.update();\n\n\t}\n\n\t_handleMouseWheel( event ) {\n\n\t\tthis._updateZoomParameters( event.clientX, event.clientY );\n\n\t\tif ( event.deltaY < 0 ) {\n\n\t\t\tthis._dollyIn( this._getZoomScale( event.deltaY ) );\n\n\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\tthis._dollyOut( this._getZoomScale( event.deltaY ) );\n\n\t\t}\n\n\t\tthis.update();\n\n\t}\n\n\t_handleKeyDown( event ) {\n\n\t\tlet needsUpdate = false;\n\n\t\tswitch ( event.code ) {\n\n\t\t\tcase this.keys.UP:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\tif ( this.enableRotate ) {\n\n\t\t\t\t\t\tthis._rotateUp( _twoPI * this.rotateSpeed / this.domElement.clientHeight );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( this.enablePan ) {\n\n\t\t\t\t\t\tthis._pan( 0, this.keyPanSpeed );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase this.keys.BOTTOM:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\tif ( this.enableRotate ) {\n\n\t\t\t\t\t\tthis._rotateUp( - _twoPI * this.rotateSpeed / this.domElement.clientHeight );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( this.enablePan ) {\n\n\t\t\t\t\t\tthis._pan( 0, - this.keyPanSpeed );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase this.keys.LEFT:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\tif ( this.enableRotate ) {\n\n\t\t\t\t\t\tthis._rotateLeft( _twoPI * this.rotateSpeed / this.domElement.clientHeight );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( this.enablePan ) {\n\n\t\t\t\t\t\tthis._pan( this.keyPanSpeed, 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase this.keys.RIGHT:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\tif ( this.enableRotate ) {\n\n\t\t\t\t\t\tthis._rotateLeft( - _twoPI * this.rotateSpeed / this.domElement.clientHeight );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( this.enablePan ) {\n\n\t\t\t\t\t\tthis._pan( - this.keyPanSpeed, 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( needsUpdate ) {\n\n\t\t\t// prevent the browser from scrolling on cursor keys\n\t\t\tevent.preventDefault();\n\n\t\t\tthis.update();\n\n\t\t}\n\n\n\t}\n\n\t_handleTouchStartRotate( event ) {\n\n\t\tif ( this._pointers.length === 1 ) {\n\n\t\t\tthis._rotateStart.set( event.pageX, event.pageY );\n\n\t\t} else {\n\n\t\t\tconst position = this._getSecondPointerPosition( event );\n\n\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\tthis._rotateStart.set( x, y );\n\n\t\t}\n\n\t}\n\n\t_handleTouchStartPan( event ) {\n\n\t\tif ( this._pointers.length === 1 ) {\n\n\t\t\tthis._panStart.set( event.pageX, event.pageY );\n\n\t\t} else {\n\n\t\t\tconst position = this._getSecondPointerPosition( event );\n\n\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\tthis._panStart.set( x, y );\n\n\t\t}\n\n\t}\n\n\t_handleTouchStartDolly( event ) {\n\n\t\tconst position = this._getSecondPointerPosition( event );\n\n\t\tconst dx = event.pageX - position.x;\n\t\tconst dy = event.pageY - position.y;\n\n\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tthis._dollyStart.set( 0, distance );\n\n\t}\n\n\t_handleTouchStartDollyPan( event ) {\n\n\t\tif ( this.enableZoom ) this._handleTouchStartDolly( event );\n\n\t\tif ( this.enablePan ) this._handleTouchStartPan( event );\n\n\t}\n\n\t_handleTouchStartDollyRotate( event ) {\n\n\t\tif ( this.enableZoom ) this._handleTouchStartDolly( event );\n\n\t\tif ( this.enableRotate ) this._handleTouchStartRotate( event );\n\n\t}\n\n\t_handleTouchMoveRotate( event ) {\n\n\t\tif ( this._pointers.length == 1 ) {\n\n\t\t\tthis._rotateEnd.set( event.pageX, event.pageY );\n\n\t\t} else {\n\n\t\t\tconst position = this._getSecondPointerPosition( event );\n\n\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\tthis._rotateEnd.set( x, y );\n\n\t\t}\n\n\t\tthis._rotateDelta.subVectors( this._rotateEnd, this._rotateStart ).multiplyScalar( this.rotateSpeed );\n\n\t\tconst element = this.domElement;\n\n\t\tthis._rotateLeft( _twoPI * this._rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\tthis._rotateUp( _twoPI * this._rotateDelta.y / element.clientHeight );\n\n\t\tthis._rotateStart.copy( this._rotateEnd );\n\n\t}\n\n\t_handleTouchMovePan( event ) {\n\n\t\tif ( this._pointers.length === 1 ) {\n\n\t\t\tthis._panEnd.set( event.pageX, event.pageY );\n\n\t\t} else {\n\n\t\t\tconst position = this._getSecondPointerPosition( event );\n\n\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\tthis._panEnd.set( x, y );\n\n\t\t}\n\n\t\tthis._panDelta.subVectors( this._panEnd, this._panStart ).multiplyScalar( this.panSpeed );\n\n\t\tthis._pan( this._panDelta.x, this._panDelta.y );\n\n\t\tthis._panStart.copy( this._panEnd );\n\n\t}\n\n\t_handleTouchMoveDolly( event ) {\n\n\t\tconst position = this._getSecondPointerPosition( event );\n\n\t\tconst dx = event.pageX - position.x;\n\t\tconst dy = event.pageY - position.y;\n\n\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tthis._dollyEnd.set( 0, distance );\n\n\t\tthis._dollyDelta.set( 0, Math.pow( this._dollyEnd.y / this._dollyStart.y, this.zoomSpeed ) );\n\n\t\tthis._dollyOut( this._dollyDelta.y );\n\n\t\tthis._dollyStart.copy( this._dollyEnd );\n\n\t\tconst centerX = ( event.pageX + position.x ) * 0.5;\n\t\tconst centerY = ( event.pageY + position.y ) * 0.5;\n\n\t\tthis._updateZoomParameters( centerX, centerY );\n\n\t}\n\n\t_handleTouchMoveDollyPan( event ) {\n\n\t\tif ( this.enableZoom ) this._handleTouchMoveDolly( event );\n\n\t\tif ( this.enablePan ) this._handleTouchMovePan( event );\n\n\t}\n\n\t_handleTouchMoveDollyRotate( event ) {\n\n\t\tif ( this.enableZoom ) this._handleTouchMoveDolly( event );\n\n\t\tif ( this.enableRotate ) this._handleTouchMoveRotate( event );\n\n\t}\n\n\t// pointers\n\n\t_addPointer( event ) {\n\n\t\tthis._pointers.push( event.pointerId );\n\n\t}\n\n\t_removePointer( event ) {\n\n\t\tdelete this._pointerPositions[ event.pointerId ];\n\n\t\tfor ( let i = 0; i < this._pointers.length; i ++ ) {\n\n\t\t\tif ( this._pointers[ i ] == event.pointerId ) {\n\n\t\t\t\tthis._pointers.splice( i, 1 );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_isTrackingPointer( event ) {\n\n\t\tfor ( let i = 0; i < this._pointers.length; i ++ ) {\n\n\t\t\tif ( this._pointers[ i ] == event.pointerId ) return true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\t_trackPointer( event ) {\n\n\t\tlet position = this._pointerPositions[ event.pointerId ];\n\n\t\tif ( position === undefined ) {\n\n\t\t\tposition = new Vector2();\n\t\t\tthis._pointerPositions[ event.pointerId ] = position;\n\n\t\t}\n\n\t\tposition.set( event.pageX, event.pageY );\n\n\t}\n\n\t_getSecondPointerPosition( event ) {\n\n\t\tconst pointerId = ( event.pointerId === this._pointers[ 0 ] ) ? this._pointers[ 1 ] : this._pointers[ 0 ];\n\n\t\treturn this._pointerPositions[ pointerId ];\n\n\t}\n\n\t//\n\n\t_customWheelEvent( event ) {\n\n\t\tconst mode = event.deltaMode;\n\n\t\t// minimal wheel event altered to meet delta-zoom demand\n\t\tconst newEvent = {\n\t\t\tclientX: event.clientX,\n\t\t\tclientY: event.clientY,\n\t\t\tdeltaY: event.deltaY,\n\t\t};\n\n\t\tswitch ( mode ) {\n\n\t\t\tcase 1: // LINE_MODE\n\t\t\t\tnewEvent.deltaY *= 16;\n\t\t\t\tbreak;\n\n\t\t\tcase 2: // PAGE_MODE\n\t\t\t\tnewEvent.deltaY *= 100;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t// detect if event was triggered by pinching\n\t\tif ( event.ctrlKey && ! this._controlActive ) {\n\n\t\t\tnewEvent.deltaY *= 10;\n\n\t\t}\n\n\t\treturn newEvent;\n\n\t}\n\n}\n\nfunction onPointerDown( event ) {\n\n\tif ( this.enabled === false ) return;\n\n\tif ( this._pointers.length === 0 ) {\n\n\t\tthis.domElement.setPointerCapture( event.pointerId );\n\n\t\tthis.domElement.addEventListener( 'pointermove', this._onPointerMove );\n\t\tthis.domElement.addEventListener( 'pointerup', this._onPointerUp );\n\n\t}\n\n\t//\n\n\tif ( this._isTrackingPointer( event ) ) return;\n\n\t//\n\n\tthis._addPointer( event );\n\n\tif ( event.pointerType === 'touch' ) {\n\n\t\tthis._onTouchStart( event );\n\n\t} else {\n\n\t\tthis._onMouseDown( event );\n\n\t}\n\n}\n\nfunction onPointerMove( event ) {\n\n\tif ( this.enabled === false ) return;\n\n\tif ( event.pointerType === 'touch' ) {\n\n\t\tthis._onTouchMove( event );\n\n\t} else {\n\n\t\tthis._onMouseMove( event );\n\n\t}\n\n}\n\nfunction onPointerUp( event ) {\n\n\tthis._removePointer( event );\n\n\tswitch ( this._pointers.length ) {\n\n\t\tcase 0:\n\n\t\t\tthis.domElement.releasePointerCapture( event.pointerId );\n\n\t\t\tthis.domElement.removeEventListener( 'pointermove', this._onPointerMove );\n\t\t\tthis.domElement.removeEventListener( 'pointerup', this._onPointerUp );\n\n\t\t\tthis.dispatchEvent( _endEvent );\n\n\t\t\tthis.state = _STATE.NONE;\n\n\t\t\tbreak;\n\n\t\tcase 1:\n\n\t\t\tconst pointerId = this._pointers[ 0 ];\n\t\t\tconst position = this._pointerPositions[ pointerId ];\n\n\t\t\t// minimal placeholder event - allows state correction on pointer-up\n\t\t\tthis._onTouchStart( { pointerId: pointerId, pageX: position.x, pageY: position.y } );\n\n\t\t\tbreak;\n\n\t}\n\n}\n\nfunction onMouseDown( event ) {\n\n\tlet mouseAction;\n\n\tswitch ( event.button ) {\n\n\t\tcase 0:\n\n\t\t\tmouseAction = this.mouseButtons.LEFT;\n\t\t\tbreak;\n\n\t\tcase 1:\n\n\t\t\tmouseAction = this.mouseButtons.MIDDLE;\n\t\t\tbreak;\n\n\t\tcase 2:\n\n\t\t\tmouseAction = this.mouseButtons.RIGHT;\n\t\t\tbreak;\n\n\t\tdefault:\n\n\t\t\tmouseAction = - 1;\n\n\t}\n\n\tswitch ( mouseAction ) {\n\n\t\tcase MOUSE.DOLLY:\n\n\t\t\tif ( this.enableZoom === false ) return;\n\n\t\t\tthis._handleMouseDownDolly( event );\n\n\t\t\tthis.state = _STATE.DOLLY;\n\n\t\t\tbreak;\n\n\t\tcase MOUSE.ROTATE:\n\n\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\tif ( this.enablePan === false ) return;\n\n\t\t\t\tthis._handleMouseDownPan( event );\n\n\t\t\t\tthis.state = _STATE.PAN;\n\n\t\t\t} else {\n\n\t\t\t\tif ( this.enableRotate === false ) return;\n\n\t\t\t\tthis._handleMouseDownRotate( event );\n\n\t\t\t\tthis.state = _STATE.ROTATE;\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\tcase MOUSE.PAN:\n\n\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\tif ( this.enableRotate === false ) return;\n\n\t\t\t\tthis._handleMouseDownRotate( event );\n\n\t\t\t\tthis.state = _STATE.ROTATE;\n\n\t\t\t} else {\n\n\t\t\t\tif ( this.enablePan === false ) return;\n\n\t\t\t\tthis._handleMouseDownPan( event );\n\n\t\t\t\tthis.state = _STATE.PAN;\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\tdefault:\n\n\t\t\tthis.state = _STATE.NONE;\n\n\t}\n\n\tif ( this.state !== _STATE.NONE ) {\n\n\t\tthis.dispatchEvent( _startEvent );\n\n\t}\n\n}\n\nfunction onMouseMove( event ) {\n\n\tswitch ( this.state ) {\n\n\t\tcase _STATE.ROTATE:\n\n\t\t\tif ( this.enableRotate === false ) return;\n\n\t\t\tthis._handleMouseMoveRotate( event );\n\n\t\t\tbreak;\n\n\t\tcase _STATE.DOLLY:\n\n\t\t\tif ( this.enableZoom === false ) return;\n\n\t\t\tthis._handleMouseMoveDolly( event );\n\n\t\t\tbreak;\n\n\t\tcase _STATE.PAN:\n\n\t\t\tif ( this.enablePan === false ) return;\n\n\t\t\tthis._handleMouseMovePan( event );\n\n\t\t\tbreak;\n\n\t}\n\n}\n\nfunction onMouseWheel( event ) {\n\n\tif ( this.enabled === false || this.enableZoom === false || this.state !== _STATE.NONE ) return;\n\n\tevent.preventDefault();\n\n\tthis.dispatchEvent( _startEvent );\n\n\tthis._handleMouseWheel( this._customWheelEvent( event ) );\n\n\tthis.dispatchEvent( _endEvent );\n\n}\n\nfunction onKeyDown( event ) {\n\n\tif ( this.enabled === false ) return;\n\n\tthis._handleKeyDown( event );\n\n}\n\nfunction onTouchStart( event ) {\n\n\tthis._trackPointer( event );\n\n\tswitch ( this._pointers.length ) {\n\n\t\tcase 1:\n\n\t\t\tswitch ( this.touches.ONE ) {\n\n\t\t\t\tcase TOUCH.ROTATE:\n\n\t\t\t\t\tif ( this.enableRotate === false ) return;\n\n\t\t\t\t\tthis._handleTouchStartRotate( event );\n\n\t\t\t\t\tthis.state = _STATE.TOUCH_ROTATE;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase TOUCH.PAN:\n\n\t\t\t\t\tif ( this.enablePan === false ) return;\n\n\t\t\t\t\tthis._handleTouchStartPan( event );\n\n\t\t\t\t\tthis.state = _STATE.TOUCH_PAN;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tthis.state = _STATE.NONE;\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\tcase 2:\n\n\t\t\tswitch ( this.touches.TWO ) {\n\n\t\t\t\tcase TOUCH.DOLLY_PAN:\n\n\t\t\t\t\tif ( this.enableZoom === false && this.enablePan === false ) return;\n\n\t\t\t\t\tthis._handleTouchStartDollyPan( event );\n\n\t\t\t\t\tthis.state = _STATE.TOUCH_DOLLY_PAN;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase TOUCH.DOLLY_ROTATE:\n\n\t\t\t\t\tif ( this.enableZoom === false && this.enableRotate === false ) return;\n\n\t\t\t\t\tthis._handleTouchStartDollyRotate( event );\n\n\t\t\t\t\tthis.state = _STATE.TOUCH_DOLLY_ROTATE;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tthis.state = _STATE.NONE;\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\tdefault:\n\n\t\t\tthis.state = _STATE.NONE;\n\n\t}\n\n\tif ( this.state !== _STATE.NONE ) {\n\n\t\tthis.dispatchEvent( _startEvent );\n\n\t}\n\n}\n\nfunction onTouchMove( event ) {\n\n\tthis._trackPointer( event );\n\n\tswitch ( this.state ) {\n\n\t\tcase _STATE.TOUCH_ROTATE:\n\n\t\t\tif ( this.enableRotate === false ) return;\n\n\t\t\tthis._handleTouchMoveRotate( event );\n\n\t\t\tthis.update();\n\n\t\t\tbreak;\n\n\t\tcase _STATE.TOUCH_PAN:\n\n\t\t\tif ( this.enablePan === false ) return;\n\n\t\t\tthis._handleTouchMovePan( event );\n\n\t\t\tthis.update();\n\n\t\t\tbreak;\n\n\t\tcase _STATE.TOUCH_DOLLY_PAN:\n\n\t\t\tif ( this.enableZoom === false && this.enablePan === false ) return;\n\n\t\t\tthis._handleTouchMoveDollyPan( event );\n\n\t\t\tthis.update();\n\n\t\t\tbreak;\n\n\t\tcase _STATE.TOUCH_DOLLY_ROTATE:\n\n\t\t\tif ( this.enableZoom === false && this.enableRotate === false ) return;\n\n\t\t\tthis._handleTouchMoveDollyRotate( event );\n\n\t\t\tthis.update();\n\n\t\t\tbreak;\n\n\t\tdefault:\n\n\t\t\tthis.state = _STATE.NONE;\n\n\t}\n\n}\n\nfunction onContextMenu( event ) {\n\n\tif ( this.enabled === false ) return;\n\n\tevent.preventDefault();\n\n}\n\nfunction interceptControlDown( event ) {\n\n\tif ( event.key === 'Control' ) {\n\n\t\tthis._controlActive = true;\n\n\t\tconst document = this.domElement.getRootNode(); // offscreen canvas compatibility\n\n\t\tdocument.addEventListener( 'keyup', this._interceptControlUp, { passive: true, capture: true } );\n\n\t}\n\n}\n\nfunction interceptControlUp( event ) {\n\n\tif ( event.key === 'Control' ) {\n\n\t\tthis._controlActive = false;\n\n\t\tconst document = this.domElement.getRootNode(); // offscreen canvas compatibility\n\n\t\tdocument.removeEventListener( 'keyup', this._interceptControlUp, { passive: true, capture: true } );\n\n\t}\n\n}\n\nexport { OrbitControls };\n","/*! Tweakpane 4.0.5 (c) 2016 cocopon, licensed under the MIT license. */\nfunction forceCast(v) {\n    return v;\n}\nfunction isEmpty(value) {\n    return value === null || value === undefined;\n}\nfunction isObject$1(value) {\n    return value !== null && typeof value === 'object';\n}\nfunction isRecord(value) {\n    return value !== null && typeof value === 'object';\n}\nfunction deepEqualsArray(a1, a2) {\n    if (a1.length !== a2.length) {\n        return false;\n    }\n    for (let i = 0; i < a1.length; i++) {\n        if (a1[i] !== a2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction deepMerge(r1, r2) {\n    const keys = Array.from(new Set([...Object.keys(r1), ...Object.keys(r2)]));\n    return keys.reduce((result, key) => {\n        const v1 = r1[key];\n        const v2 = r2[key];\n        return isRecord(v1) && isRecord(v2)\n            ? Object.assign(Object.assign({}, result), { [key]: deepMerge(v1, v2) }) : Object.assign(Object.assign({}, result), { [key]: key in r2 ? v2 : v1 });\n    }, {});\n}\n\nfunction isBinding(value) {\n    if (!isObject$1(value)) {\n        return false;\n    }\n    return 'target' in value;\n}\n\nconst CREATE_MESSAGE_MAP = {\n    alreadydisposed: () => 'View has been already disposed',\n    invalidparams: (context) => `Invalid parameters for '${context.name}'`,\n    nomatchingcontroller: (context) => `No matching controller for '${context.key}'`,\n    nomatchingview: (context) => `No matching view for '${JSON.stringify(context.params)}'`,\n    notbindable: () => `Value is not bindable`,\n    notcompatible: (context) => `Not compatible with  plugin '${context.id}'`,\n    propertynotfound: (context) => `Property '${context.name}' not found`,\n    shouldneverhappen: () => 'This error should never happen',\n};\nclass TpError {\n    static alreadyDisposed() {\n        return new TpError({ type: 'alreadydisposed' });\n    }\n    static notBindable() {\n        return new TpError({\n            type: 'notbindable',\n        });\n    }\n    static notCompatible(bundleId, id) {\n        return new TpError({\n            type: 'notcompatible',\n            context: {\n                id: `${bundleId}.${id}`,\n            },\n        });\n    }\n    static propertyNotFound(name) {\n        return new TpError({\n            type: 'propertynotfound',\n            context: {\n                name: name,\n            },\n        });\n    }\n    static shouldNeverHappen() {\n        return new TpError({ type: 'shouldneverhappen' });\n    }\n    constructor(config) {\n        var _a;\n        this.message =\n            (_a = CREATE_MESSAGE_MAP[config.type](forceCast(config.context))) !== null && _a !== void 0 ? _a : 'Unexpected error';\n        this.name = this.constructor.name;\n        this.stack = new Error(this.message).stack;\n        this.type = config.type;\n    }\n    toString() {\n        return this.message;\n    }\n}\n\nclass BindingTarget {\n    constructor(obj, key) {\n        this.obj_ = obj;\n        this.key = key;\n    }\n    static isBindable(obj) {\n        if (obj === null) {\n            return false;\n        }\n        if (typeof obj !== 'object' && typeof obj !== 'function') {\n            return false;\n        }\n        return true;\n    }\n    read() {\n        return this.obj_[this.key];\n    }\n    write(value) {\n        this.obj_[this.key] = value;\n    }\n    writeProperty(name, value) {\n        const valueObj = this.read();\n        if (!BindingTarget.isBindable(valueObj)) {\n            throw TpError.notBindable();\n        }\n        if (!(name in valueObj)) {\n            throw TpError.propertyNotFound(name);\n        }\n        valueObj[name] = value;\n    }\n}\n\nclass Emitter {\n    constructor() {\n        this.observers_ = {};\n    }\n    on(eventName, handler, opt_options) {\n        var _a;\n        let observers = this.observers_[eventName];\n        if (!observers) {\n            observers = this.observers_[eventName] = [];\n        }\n        observers.push({\n            handler: handler,\n            key: (_a = opt_options === null || opt_options === void 0 ? void 0 : opt_options.key) !== null && _a !== void 0 ? _a : handler,\n        });\n        return this;\n    }\n    off(eventName, key) {\n        const observers = this.observers_[eventName];\n        if (observers) {\n            this.observers_[eventName] = observers.filter((observer) => {\n                return observer.key !== key;\n            });\n        }\n        return this;\n    }\n    emit(eventName, event) {\n        const observers = this.observers_[eventName];\n        if (!observers) {\n            return;\n        }\n        observers.forEach((observer) => {\n            observer.handler(event);\n        });\n    }\n}\n\nclass ComplexValue {\n    constructor(initialValue, config) {\n        var _a;\n        this.constraint_ = config === null || config === void 0 ? void 0 : config.constraint;\n        this.equals_ = (_a = config === null || config === void 0 ? void 0 : config.equals) !== null && _a !== void 0 ? _a : ((v1, v2) => v1 === v2);\n        this.emitter = new Emitter();\n        this.rawValue_ = initialValue;\n    }\n    get constraint() {\n        return this.constraint_;\n    }\n    get rawValue() {\n        return this.rawValue_;\n    }\n    set rawValue(rawValue) {\n        this.setRawValue(rawValue, {\n            forceEmit: false,\n            last: true,\n        });\n    }\n    setRawValue(rawValue, options) {\n        const opts = options !== null && options !== void 0 ? options : {\n            forceEmit: false,\n            last: true,\n        };\n        const constrainedValue = this.constraint_\n            ? this.constraint_.constrain(rawValue)\n            : rawValue;\n        const prevValue = this.rawValue_;\n        const changed = !this.equals_(prevValue, constrainedValue);\n        if (!changed && !opts.forceEmit) {\n            return;\n        }\n        this.emitter.emit('beforechange', {\n            sender: this,\n        });\n        this.rawValue_ = constrainedValue;\n        this.emitter.emit('change', {\n            options: opts,\n            previousRawValue: prevValue,\n            rawValue: constrainedValue,\n            sender: this,\n        });\n    }\n}\n\nclass PrimitiveValue {\n    constructor(initialValue) {\n        this.emitter = new Emitter();\n        this.value_ = initialValue;\n    }\n    get rawValue() {\n        return this.value_;\n    }\n    set rawValue(value) {\n        this.setRawValue(value, {\n            forceEmit: false,\n            last: true,\n        });\n    }\n    setRawValue(value, options) {\n        const opts = options !== null && options !== void 0 ? options : {\n            forceEmit: false,\n            last: true,\n        };\n        const prevValue = this.value_;\n        if (prevValue === value && !opts.forceEmit) {\n            return;\n        }\n        this.emitter.emit('beforechange', {\n            sender: this,\n        });\n        this.value_ = value;\n        this.emitter.emit('change', {\n            options: opts,\n            previousRawValue: prevValue,\n            rawValue: this.value_,\n            sender: this,\n        });\n    }\n}\n\nclass ReadonlyPrimitiveValue {\n    constructor(value) {\n        this.emitter = new Emitter();\n        this.onValueBeforeChange_ = this.onValueBeforeChange_.bind(this);\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.value_ = value;\n        this.value_.emitter.on('beforechange', this.onValueBeforeChange_);\n        this.value_.emitter.on('change', this.onValueChange_);\n    }\n    get rawValue() {\n        return this.value_.rawValue;\n    }\n    onValueBeforeChange_(ev) {\n        this.emitter.emit('beforechange', Object.assign(Object.assign({}, ev), { sender: this }));\n    }\n    onValueChange_(ev) {\n        this.emitter.emit('change', Object.assign(Object.assign({}, ev), { sender: this }));\n    }\n}\n\nfunction createValue(initialValue, config) {\n    const constraint = config === null || config === void 0 ? void 0 : config.constraint;\n    const equals = config === null || config === void 0 ? void 0 : config.equals;\n    if (!constraint && !equals) {\n        return new PrimitiveValue(initialValue);\n    }\n    return new ComplexValue(initialValue, config);\n}\nfunction createReadonlyValue(value) {\n    return [\n        new ReadonlyPrimitiveValue(value),\n        (rawValue, options) => {\n            value.setRawValue(rawValue, options);\n        },\n    ];\n}\n\nclass ValueMap {\n    constructor(valueMap) {\n        this.emitter = new Emitter();\n        this.valMap_ = valueMap;\n        for (const key in this.valMap_) {\n            const v = this.valMap_[key];\n            v.emitter.on('change', () => {\n                this.emitter.emit('change', {\n                    key: key,\n                    sender: this,\n                });\n            });\n        }\n    }\n    static createCore(initialValue) {\n        const keys = Object.keys(initialValue);\n        return keys.reduce((o, key) => {\n            return Object.assign(o, {\n                [key]: createValue(initialValue[key]),\n            });\n        }, {});\n    }\n    static fromObject(initialValue) {\n        const core = this.createCore(initialValue);\n        return new ValueMap(core);\n    }\n    get(key) {\n        return this.valMap_[key].rawValue;\n    }\n    set(key, value) {\n        this.valMap_[key].rawValue = value;\n    }\n    value(key) {\n        return this.valMap_[key];\n    }\n}\n\nclass DefiniteRangeConstraint {\n    constructor(config) {\n        this.values = ValueMap.fromObject({\n            max: config.max,\n            min: config.min,\n        });\n    }\n    constrain(value) {\n        const max = this.values.get('max');\n        const min = this.values.get('min');\n        return Math.min(Math.max(value, min), max);\n    }\n}\n\nclass RangeConstraint {\n    constructor(config) {\n        this.values = ValueMap.fromObject({\n            max: config.max,\n            min: config.min,\n        });\n    }\n    constrain(value) {\n        const max = this.values.get('max');\n        const min = this.values.get('min');\n        let result = value;\n        if (!isEmpty(min)) {\n            result = Math.max(result, min);\n        }\n        if (!isEmpty(max)) {\n            result = Math.min(result, max);\n        }\n        return result;\n    }\n}\n\nclass StepConstraint {\n    constructor(step, origin = 0) {\n        this.step = step;\n        this.origin = origin;\n    }\n    constrain(value) {\n        const o = this.origin % this.step;\n        const r = Math.round((value - o) / this.step);\n        return o + r * this.step;\n    }\n}\n\nclass NumberLiteralNode {\n    constructor(text) {\n        this.text = text;\n    }\n    evaluate() {\n        return Number(this.text);\n    }\n    toString() {\n        return this.text;\n    }\n}\nconst BINARY_OPERATION_MAP = {\n    '**': (v1, v2) => Math.pow(v1, v2),\n    '*': (v1, v2) => v1 * v2,\n    '/': (v1, v2) => v1 / v2,\n    '%': (v1, v2) => v1 % v2,\n    '+': (v1, v2) => v1 + v2,\n    '-': (v1, v2) => v1 - v2,\n    '<<': (v1, v2) => v1 << v2,\n    '>>': (v1, v2) => v1 >> v2,\n    '>>>': (v1, v2) => v1 >>> v2,\n    '&': (v1, v2) => v1 & v2,\n    '^': (v1, v2) => v1 ^ v2,\n    '|': (v1, v2) => v1 | v2,\n};\nclass BinaryOperationNode {\n    constructor(operator, left, right) {\n        this.left = left;\n        this.operator = operator;\n        this.right = right;\n    }\n    evaluate() {\n        const op = BINARY_OPERATION_MAP[this.operator];\n        if (!op) {\n            throw new Error(`unexpected binary operator: '${this.operator}`);\n        }\n        return op(this.left.evaluate(), this.right.evaluate());\n    }\n    toString() {\n        return [\n            'b(',\n            this.left.toString(),\n            this.operator,\n            this.right.toString(),\n            ')',\n        ].join(' ');\n    }\n}\nconst UNARY_OPERATION_MAP = {\n    '+': (v) => v,\n    '-': (v) => -v,\n    '~': (v) => ~v,\n};\nclass UnaryOperationNode {\n    constructor(operator, expr) {\n        this.operator = operator;\n        this.expression = expr;\n    }\n    evaluate() {\n        const op = UNARY_OPERATION_MAP[this.operator];\n        if (!op) {\n            throw new Error(`unexpected unary operator: '${this.operator}`);\n        }\n        return op(this.expression.evaluate());\n    }\n    toString() {\n        return ['u(', this.operator, this.expression.toString(), ')'].join(' ');\n    }\n}\n\nfunction combineReader(parsers) {\n    return (text, cursor) => {\n        for (let i = 0; i < parsers.length; i++) {\n            const result = parsers[i](text, cursor);\n            if (result !== '') {\n                return result;\n            }\n        }\n        return '';\n    };\n}\nfunction readWhitespace(text, cursor) {\n    var _a;\n    const m = text.substr(cursor).match(/^\\s+/);\n    return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n}\nfunction readNonZeroDigit(text, cursor) {\n    const ch = text.substr(cursor, 1);\n    return ch.match(/^[1-9]$/) ? ch : '';\n}\nfunction readDecimalDigits(text, cursor) {\n    var _a;\n    const m = text.substr(cursor).match(/^[0-9]+/);\n    return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n}\nfunction readSignedInteger(text, cursor) {\n    const ds = readDecimalDigits(text, cursor);\n    if (ds !== '') {\n        return ds;\n    }\n    const sign = text.substr(cursor, 1);\n    cursor += 1;\n    if (sign !== '-' && sign !== '+') {\n        return '';\n    }\n    const sds = readDecimalDigits(text, cursor);\n    if (sds === '') {\n        return '';\n    }\n    return sign + sds;\n}\nfunction readExponentPart(text, cursor) {\n    const e = text.substr(cursor, 1);\n    cursor += 1;\n    if (e.toLowerCase() !== 'e') {\n        return '';\n    }\n    const si = readSignedInteger(text, cursor);\n    if (si === '') {\n        return '';\n    }\n    return e + si;\n}\nfunction readDecimalIntegerLiteral(text, cursor) {\n    const ch = text.substr(cursor, 1);\n    if (ch === '0') {\n        return ch;\n    }\n    const nzd = readNonZeroDigit(text, cursor);\n    cursor += nzd.length;\n    if (nzd === '') {\n        return '';\n    }\n    return nzd + readDecimalDigits(text, cursor);\n}\nfunction readDecimalLiteral1(text, cursor) {\n    const dil = readDecimalIntegerLiteral(text, cursor);\n    cursor += dil.length;\n    if (dil === '') {\n        return '';\n    }\n    const dot = text.substr(cursor, 1);\n    cursor += dot.length;\n    if (dot !== '.') {\n        return '';\n    }\n    const dds = readDecimalDigits(text, cursor);\n    cursor += dds.length;\n    return dil + dot + dds + readExponentPart(text, cursor);\n}\nfunction readDecimalLiteral2(text, cursor) {\n    const dot = text.substr(cursor, 1);\n    cursor += dot.length;\n    if (dot !== '.') {\n        return '';\n    }\n    const dds = readDecimalDigits(text, cursor);\n    cursor += dds.length;\n    if (dds === '') {\n        return '';\n    }\n    return dot + dds + readExponentPart(text, cursor);\n}\nfunction readDecimalLiteral3(text, cursor) {\n    const dil = readDecimalIntegerLiteral(text, cursor);\n    cursor += dil.length;\n    if (dil === '') {\n        return '';\n    }\n    return dil + readExponentPart(text, cursor);\n}\nconst readDecimalLiteral = combineReader([\n    readDecimalLiteral1,\n    readDecimalLiteral2,\n    readDecimalLiteral3,\n]);\nfunction parseBinaryDigits(text, cursor) {\n    var _a;\n    const m = text.substr(cursor).match(/^[01]+/);\n    return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n}\nfunction readBinaryIntegerLiteral(text, cursor) {\n    const prefix = text.substr(cursor, 2);\n    cursor += prefix.length;\n    if (prefix.toLowerCase() !== '0b') {\n        return '';\n    }\n    const bds = parseBinaryDigits(text, cursor);\n    if (bds === '') {\n        return '';\n    }\n    return prefix + bds;\n}\nfunction readOctalDigits(text, cursor) {\n    var _a;\n    const m = text.substr(cursor).match(/^[0-7]+/);\n    return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n}\nfunction readOctalIntegerLiteral(text, cursor) {\n    const prefix = text.substr(cursor, 2);\n    cursor += prefix.length;\n    if (prefix.toLowerCase() !== '0o') {\n        return '';\n    }\n    const ods = readOctalDigits(text, cursor);\n    if (ods === '') {\n        return '';\n    }\n    return prefix + ods;\n}\nfunction readHexDigits(text, cursor) {\n    var _a;\n    const m = text.substr(cursor).match(/^[0-9a-f]+/i);\n    return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n}\nfunction readHexIntegerLiteral(text, cursor) {\n    const prefix = text.substr(cursor, 2);\n    cursor += prefix.length;\n    if (prefix.toLowerCase() !== '0x') {\n        return '';\n    }\n    const hds = readHexDigits(text, cursor);\n    if (hds === '') {\n        return '';\n    }\n    return prefix + hds;\n}\nconst readNonDecimalIntegerLiteral = combineReader([\n    readBinaryIntegerLiteral,\n    readOctalIntegerLiteral,\n    readHexIntegerLiteral,\n]);\nconst readNumericLiteral = combineReader([\n    readNonDecimalIntegerLiteral,\n    readDecimalLiteral,\n]);\n\nfunction parseLiteral(text, cursor) {\n    const num = readNumericLiteral(text, cursor);\n    cursor += num.length;\n    if (num === '') {\n        return null;\n    }\n    return {\n        evaluable: new NumberLiteralNode(num),\n        cursor: cursor,\n    };\n}\nfunction parseParenthesizedExpression(text, cursor) {\n    const op = text.substr(cursor, 1);\n    cursor += op.length;\n    if (op !== '(') {\n        return null;\n    }\n    const expr = parseExpression(text, cursor);\n    if (!expr) {\n        return null;\n    }\n    cursor = expr.cursor;\n    cursor += readWhitespace(text, cursor).length;\n    const cl = text.substr(cursor, 1);\n    cursor += cl.length;\n    if (cl !== ')') {\n        return null;\n    }\n    return {\n        evaluable: expr.evaluable,\n        cursor: cursor,\n    };\n}\nfunction parsePrimaryExpression(text, cursor) {\n    var _a;\n    return ((_a = parseLiteral(text, cursor)) !== null && _a !== void 0 ? _a : parseParenthesizedExpression(text, cursor));\n}\nfunction parseUnaryExpression(text, cursor) {\n    const expr = parsePrimaryExpression(text, cursor);\n    if (expr) {\n        return expr;\n    }\n    const op = text.substr(cursor, 1);\n    cursor += op.length;\n    if (op !== '+' && op !== '-' && op !== '~') {\n        return null;\n    }\n    const num = parseUnaryExpression(text, cursor);\n    if (!num) {\n        return null;\n    }\n    cursor = num.cursor;\n    return {\n        cursor: cursor,\n        evaluable: new UnaryOperationNode(op, num.evaluable),\n    };\n}\nfunction readBinaryOperator(ops, text, cursor) {\n    cursor += readWhitespace(text, cursor).length;\n    const op = ops.filter((op) => text.startsWith(op, cursor))[0];\n    if (!op) {\n        return null;\n    }\n    cursor += op.length;\n    cursor += readWhitespace(text, cursor).length;\n    return {\n        cursor: cursor,\n        operator: op,\n    };\n}\nfunction createBinaryOperationExpressionParser(exprParser, ops) {\n    return (text, cursor) => {\n        const firstExpr = exprParser(text, cursor);\n        if (!firstExpr) {\n            return null;\n        }\n        cursor = firstExpr.cursor;\n        let expr = firstExpr.evaluable;\n        for (;;) {\n            const op = readBinaryOperator(ops, text, cursor);\n            if (!op) {\n                break;\n            }\n            cursor = op.cursor;\n            const nextExpr = exprParser(text, cursor);\n            if (!nextExpr) {\n                return null;\n            }\n            cursor = nextExpr.cursor;\n            expr = new BinaryOperationNode(op.operator, expr, nextExpr.evaluable);\n        }\n        return expr\n            ? {\n                cursor: cursor,\n                evaluable: expr,\n            }\n            : null;\n    };\n}\nconst parseBinaryOperationExpression = [\n    ['**'],\n    ['*', '/', '%'],\n    ['+', '-'],\n    ['<<', '>>>', '>>'],\n    ['&'],\n    ['^'],\n    ['|'],\n].reduce((parser, ops) => {\n    return createBinaryOperationExpressionParser(parser, ops);\n}, parseUnaryExpression);\nfunction parseExpression(text, cursor) {\n    cursor += readWhitespace(text, cursor).length;\n    return parseBinaryOperationExpression(text, cursor);\n}\nfunction parseEcmaNumberExpression(text) {\n    const expr = parseExpression(text, 0);\n    if (!expr) {\n        return null;\n    }\n    const cursor = expr.cursor + readWhitespace(text, expr.cursor).length;\n    if (cursor !== text.length) {\n        return null;\n    }\n    return expr.evaluable;\n}\n\nfunction parseNumber(text) {\n    var _a;\n    const r = parseEcmaNumberExpression(text);\n    return (_a = r === null || r === void 0 ? void 0 : r.evaluate()) !== null && _a !== void 0 ? _a : null;\n}\nfunction numberFromUnknown(value) {\n    if (typeof value === 'number') {\n        return value;\n    }\n    if (typeof value === 'string') {\n        const pv = parseNumber(value);\n        if (!isEmpty(pv)) {\n            return pv;\n        }\n    }\n    return 0;\n}\nfunction numberToString(value) {\n    return String(value);\n}\nfunction createNumberFormatter(digits) {\n    return (value) => {\n        return value.toFixed(Math.max(Math.min(digits, 20), 0));\n    };\n}\n\nfunction mapRange(value, start1, end1, start2, end2) {\n    const p = (value - start1) / (end1 - start1);\n    return start2 + p * (end2 - start2);\n}\nfunction getDecimalDigits(value) {\n    const text = String(value.toFixed(10));\n    const frac = text.split('.')[1];\n    return frac.replace(/0+$/, '').length;\n}\nfunction constrainRange(value, min, max) {\n    return Math.min(Math.max(value, min), max);\n}\nfunction loopRange(value, max) {\n    return ((value % max) + max) % max;\n}\nfunction getSuitableDecimalDigits(params, rawValue) {\n    return !isEmpty(params.step)\n        ? getDecimalDigits(params.step)\n        : Math.max(getDecimalDigits(rawValue), 2);\n}\nfunction getSuitableKeyScale(params) {\n    var _a;\n    return (_a = params.step) !== null && _a !== void 0 ? _a : 1;\n}\nfunction getSuitablePointerScale(params, rawValue) {\n    var _a;\n    const base = Math.abs((_a = params.step) !== null && _a !== void 0 ? _a : rawValue);\n    return base === 0 ? 0.1 : Math.pow(10, Math.floor(Math.log10(base)) - 1);\n}\nfunction createStepConstraint(params, initialValue) {\n    if (!isEmpty(params.step)) {\n        return new StepConstraint(params.step, initialValue);\n    }\n    return null;\n}\nfunction createRangeConstraint(params) {\n    if (!isEmpty(params.max) && !isEmpty(params.min)) {\n        return new DefiniteRangeConstraint({\n            max: params.max,\n            min: params.min,\n        });\n    }\n    if (!isEmpty(params.max) || !isEmpty(params.min)) {\n        return new RangeConstraint({\n            max: params.max,\n            min: params.min,\n        });\n    }\n    return null;\n}\nfunction createNumberTextPropsObject(params, initialValue) {\n    var _a, _b, _c;\n    return {\n        formatter: (_a = params.format) !== null && _a !== void 0 ? _a : createNumberFormatter(getSuitableDecimalDigits(params, initialValue)),\n        keyScale: (_b = params.keyScale) !== null && _b !== void 0 ? _b : getSuitableKeyScale(params),\n        pointerScale: (_c = params.pointerScale) !== null && _c !== void 0 ? _c : getSuitablePointerScale(params, initialValue),\n    };\n}\nfunction createNumberTextInputParamsParser(p) {\n    return {\n        format: p.optional.function,\n        keyScale: p.optional.number,\n        max: p.optional.number,\n        min: p.optional.number,\n        pointerScale: p.optional.number,\n        step: p.optional.number,\n    };\n}\n\nfunction createPointAxis(config) {\n    return {\n        constraint: config.constraint,\n        textProps: ValueMap.fromObject(createNumberTextPropsObject(config.params, config.initialValue)),\n    };\n}\n\nclass BladeApi {\n    constructor(controller) {\n        this.controller = controller;\n    }\n    get element() {\n        return this.controller.view.element;\n    }\n    get disabled() {\n        return this.controller.viewProps.get('disabled');\n    }\n    set disabled(disabled) {\n        this.controller.viewProps.set('disabled', disabled);\n    }\n    get hidden() {\n        return this.controller.viewProps.get('hidden');\n    }\n    set hidden(hidden) {\n        this.controller.viewProps.set('hidden', hidden);\n    }\n    dispose() {\n        this.controller.viewProps.set('disposed', true);\n    }\n    importState(state) {\n        return this.controller.importState(state);\n    }\n    exportState() {\n        return this.controller.exportState();\n    }\n}\n\nclass TpEvent {\n    constructor(target) {\n        this.target = target;\n    }\n}\nclass TpChangeEvent extends TpEvent {\n    constructor(target, value, last) {\n        super(target);\n        this.value = value;\n        this.last = last !== null && last !== void 0 ? last : true;\n    }\n}\nclass TpFoldEvent extends TpEvent {\n    constructor(target, expanded) {\n        super(target);\n        this.expanded = expanded;\n    }\n}\nclass TpTabSelectEvent extends TpEvent {\n    constructor(target, index) {\n        super(target);\n        this.index = index;\n    }\n}\nclass TpMouseEvent extends TpEvent {\n    constructor(target, nativeEvent) {\n        super(target);\n        this.native = nativeEvent;\n    }\n}\n\nclass BindingApi extends BladeApi {\n    constructor(controller) {\n        super(controller);\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.emitter_ = new Emitter();\n        this.controller.value.emitter.on('change', this.onValueChange_);\n    }\n    get label() {\n        return this.controller.labelController.props.get('label');\n    }\n    set label(label) {\n        this.controller.labelController.props.set('label', label);\n    }\n    get key() {\n        return this.controller.value.binding.target.key;\n    }\n    get tag() {\n        return this.controller.tag;\n    }\n    set tag(tag) {\n        this.controller.tag = tag;\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        this.emitter_.on(eventName, (ev) => {\n            bh(ev);\n        }, {\n            key: handler,\n        });\n        return this;\n    }\n    off(eventName, handler) {\n        this.emitter_.off(eventName, handler);\n        return this;\n    }\n    refresh() {\n        this.controller.value.fetch();\n    }\n    onValueChange_(ev) {\n        const value = this.controller.value;\n        this.emitter_.emit('change', new TpChangeEvent(this, forceCast(value.binding.target.read()), ev.options.last));\n    }\n}\n\nclass InputBindingValue {\n    constructor(value, binding) {\n        this.onValueBeforeChange_ = this.onValueBeforeChange_.bind(this);\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.binding = binding;\n        this.value_ = value;\n        this.value_.emitter.on('beforechange', this.onValueBeforeChange_);\n        this.value_.emitter.on('change', this.onValueChange_);\n        this.emitter = new Emitter();\n    }\n    get rawValue() {\n        return this.value_.rawValue;\n    }\n    set rawValue(rawValue) {\n        this.value_.rawValue = rawValue;\n    }\n    setRawValue(rawValue, options) {\n        this.value_.setRawValue(rawValue, options);\n    }\n    fetch() {\n        this.value_.rawValue = this.binding.read();\n    }\n    push() {\n        this.binding.write(this.value_.rawValue);\n    }\n    onValueBeforeChange_(ev) {\n        this.emitter.emit('beforechange', Object.assign(Object.assign({}, ev), { sender: this }));\n    }\n    onValueChange_(ev) {\n        this.push();\n        this.emitter.emit('change', Object.assign(Object.assign({}, ev), { sender: this }));\n    }\n}\nfunction isInputBindingValue(v) {\n    if (!('binding' in v)) {\n        return false;\n    }\n    const b = v['binding'];\n    return isBinding(b) && 'read' in b && 'write' in b;\n}\n\nfunction parseObject(value, keyToParserMap) {\n    const keys = Object.keys(keyToParserMap);\n    const result = keys.reduce((tmp, key) => {\n        if (tmp === undefined) {\n            return undefined;\n        }\n        const parser = keyToParserMap[key];\n        const result = parser(value[key]);\n        return result.succeeded\n            ? Object.assign(Object.assign({}, tmp), { [key]: result.value }) : undefined;\n    }, {});\n    return forceCast(result);\n}\nfunction parseArray(value, parseItem) {\n    return value.reduce((tmp, item) => {\n        if (tmp === undefined) {\n            return undefined;\n        }\n        const result = parseItem(item);\n        if (!result.succeeded || result.value === undefined) {\n            return undefined;\n        }\n        return [...tmp, result.value];\n    }, []);\n}\nfunction isObject(value) {\n    if (value === null) {\n        return false;\n    }\n    return typeof value === 'object';\n}\nfunction createMicroParserBuilder(parse) {\n    return (optional) => (v) => {\n        if (!optional && v === undefined) {\n            return {\n                succeeded: false,\n                value: undefined,\n            };\n        }\n        if (optional && v === undefined) {\n            return {\n                succeeded: true,\n                value: undefined,\n            };\n        }\n        const result = parse(v);\n        return result !== undefined\n            ? {\n                succeeded: true,\n                value: result,\n            }\n            : {\n                succeeded: false,\n                value: undefined,\n            };\n    };\n}\nfunction createMicroParserBuilders(optional) {\n    return {\n        custom: (parse) => createMicroParserBuilder(parse)(optional),\n        boolean: createMicroParserBuilder((v) => typeof v === 'boolean' ? v : undefined)(optional),\n        number: createMicroParserBuilder((v) => typeof v === 'number' ? v : undefined)(optional),\n        string: createMicroParserBuilder((v) => typeof v === 'string' ? v : undefined)(optional),\n        function: createMicroParserBuilder((v) =>\n        typeof v === 'function' ? v : undefined)(optional),\n        constant: (value) => createMicroParserBuilder((v) => (v === value ? value : undefined))(optional),\n        raw: createMicroParserBuilder((v) => v)(optional),\n        object: (keyToParserMap) => createMicroParserBuilder((v) => {\n            if (!isObject(v)) {\n                return undefined;\n            }\n            return parseObject(v, keyToParserMap);\n        })(optional),\n        array: (itemParser) => createMicroParserBuilder((v) => {\n            if (!Array.isArray(v)) {\n                return undefined;\n            }\n            return parseArray(v, itemParser);\n        })(optional),\n    };\n}\nconst MicroParsers = {\n    optional: createMicroParserBuilders(true),\n    required: createMicroParserBuilders(false),\n};\nfunction parseRecord(value, keyToParserMap) {\n    const map = keyToParserMap(MicroParsers);\n    const result = MicroParsers.required.object(map)(value);\n    return result.succeeded ? result.value : undefined;\n}\n\nfunction importBladeState(state, superImport, parser, callback) {\n    if (superImport && !superImport(state)) {\n        return false;\n    }\n    const result = parseRecord(state, parser);\n    return result ? callback(result) : false;\n}\nfunction exportBladeState(superExport, thisState) {\n    var _a;\n    return deepMerge((_a = superExport === null || superExport === void 0 ? void 0 : superExport()) !== null && _a !== void 0 ? _a : {}, thisState);\n}\n\nfunction isValueBladeController(bc) {\n    return 'value' in bc;\n}\n\nfunction isBindingValue(v) {\n    if (!isObject$1(v) || !('binding' in v)) {\n        return false;\n    }\n    const b = v.binding;\n    return isBinding(b);\n}\n\nconst SVG_NS = 'http://www.w3.org/2000/svg';\nfunction forceReflow(element) {\n    element.offsetHeight;\n}\nfunction disableTransitionTemporarily(element, callback) {\n    const t = element.style.transition;\n    element.style.transition = 'none';\n    callback();\n    element.style.transition = t;\n}\nfunction supportsTouch(doc) {\n    return doc.ontouchstart !== undefined;\n}\nfunction getGlobalObject() {\n    return globalThis;\n}\nfunction getWindowDocument() {\n    const globalObj = forceCast(getGlobalObject());\n    return globalObj.document;\n}\nfunction getCanvasContext(canvasElement) {\n    const win = canvasElement.ownerDocument.defaultView;\n    if (!win) {\n        return null;\n    }\n    const isBrowser = 'document' in win;\n    return isBrowser\n        ? canvasElement.getContext('2d', {\n            willReadFrequently: true,\n        })\n        : null;\n}\nconst ICON_ID_TO_INNER_HTML_MAP = {\n    check: '<path d=\"M2 8l4 4l8 -8\"/>',\n    dropdown: '<path d=\"M5 7h6l-3 3 z\"/>',\n    p2dpad: '<path d=\"M8 4v8\"/><path d=\"M4 8h8\"/><circle cx=\"12\" cy=\"12\" r=\"1.2\"/>',\n};\nfunction createSvgIconElement(document, iconId) {\n    const elem = document.createElementNS(SVG_NS, 'svg');\n    elem.innerHTML = ICON_ID_TO_INNER_HTML_MAP[iconId];\n    return elem;\n}\nfunction insertElementAt(parentElement, element, index) {\n    parentElement.insertBefore(element, parentElement.children[index]);\n}\nfunction removeElement(element) {\n    if (element.parentElement) {\n        element.parentElement.removeChild(element);\n    }\n}\nfunction removeChildElements(element) {\n    while (element.children.length > 0) {\n        element.removeChild(element.children[0]);\n    }\n}\nfunction removeChildNodes(element) {\n    while (element.childNodes.length > 0) {\n        element.removeChild(element.childNodes[0]);\n    }\n}\nfunction findNextTarget(ev) {\n    if (ev.relatedTarget) {\n        return forceCast(ev.relatedTarget);\n    }\n    if ('explicitOriginalTarget' in ev) {\n        return ev.explicitOriginalTarget;\n    }\n    return null;\n}\n\nfunction bindValue(value, applyValue) {\n    value.emitter.on('change', (ev) => {\n        applyValue(ev.rawValue);\n    });\n    applyValue(value.rawValue);\n}\nfunction bindValueMap(valueMap, key, applyValue) {\n    bindValue(valueMap.value(key), applyValue);\n}\n\nconst PREFIX = 'tp';\nfunction ClassName(viewName) {\n    const fn = (opt_elementName, opt_modifier) => {\n        return [\n            PREFIX,\n            '-',\n            viewName,\n            'v',\n            opt_elementName ? `_${opt_elementName}` : '',\n            opt_modifier ? `-${opt_modifier}` : '',\n        ].join('');\n    };\n    return fn;\n}\n\nconst cn$r = ClassName('lbl');\nfunction createLabelNode(doc, label) {\n    const frag = doc.createDocumentFragment();\n    const lineNodes = label.split('\\n').map((line) => {\n        return doc.createTextNode(line);\n    });\n    lineNodes.forEach((lineNode, index) => {\n        if (index > 0) {\n            frag.appendChild(doc.createElement('br'));\n        }\n        frag.appendChild(lineNode);\n    });\n    return frag;\n}\nclass LabelView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$r());\n        config.viewProps.bindClassModifiers(this.element);\n        const labelElem = doc.createElement('div');\n        labelElem.classList.add(cn$r('l'));\n        bindValueMap(config.props, 'label', (value) => {\n            if (isEmpty(value)) {\n                this.element.classList.add(cn$r(undefined, 'nol'));\n            }\n            else {\n                this.element.classList.remove(cn$r(undefined, 'nol'));\n                removeChildNodes(labelElem);\n                labelElem.appendChild(createLabelNode(doc, value));\n            }\n        });\n        this.element.appendChild(labelElem);\n        this.labelElement = labelElem;\n        const valueElem = doc.createElement('div');\n        valueElem.classList.add(cn$r('v'));\n        this.element.appendChild(valueElem);\n        this.valueElement = valueElem;\n    }\n}\n\nclass LabelController {\n    constructor(doc, config) {\n        this.props = config.props;\n        this.valueController = config.valueController;\n        this.viewProps = config.valueController.viewProps;\n        this.view = new LabelView(doc, {\n            props: config.props,\n            viewProps: this.viewProps,\n        });\n        this.view.valueElement.appendChild(this.valueController.view.element);\n    }\n    importProps(state) {\n        return importBladeState(state, null, (p) => ({\n            label: p.optional.string,\n        }), (result) => {\n            this.props.set('label', result.label);\n            return true;\n        });\n    }\n    exportProps() {\n        return exportBladeState(null, {\n            label: this.props.get('label'),\n        });\n    }\n}\n\nfunction getAllBladePositions() {\n    return ['veryfirst', 'first', 'last', 'verylast'];\n}\n\nconst cn$q = ClassName('');\nconst POS_TO_CLASS_NAME_MAP = {\n    veryfirst: 'vfst',\n    first: 'fst',\n    last: 'lst',\n    verylast: 'vlst',\n};\nclass BladeController {\n    constructor(config) {\n        this.parent_ = null;\n        this.blade = config.blade;\n        this.view = config.view;\n        this.viewProps = config.viewProps;\n        const elem = this.view.element;\n        this.blade.value('positions').emitter.on('change', () => {\n            getAllBladePositions().forEach((pos) => {\n                elem.classList.remove(cn$q(undefined, POS_TO_CLASS_NAME_MAP[pos]));\n            });\n            this.blade.get('positions').forEach((pos) => {\n                elem.classList.add(cn$q(undefined, POS_TO_CLASS_NAME_MAP[pos]));\n            });\n        });\n        this.viewProps.handleDispose(() => {\n            removeElement(elem);\n        });\n    }\n    get parent() {\n        return this.parent_;\n    }\n    set parent(parent) {\n        this.parent_ = parent;\n        this.viewProps.set('parent', this.parent_ ? this.parent_.viewProps : null);\n    }\n    importState(state) {\n        return importBladeState(state, null, (p) => ({\n            disabled: p.required.boolean,\n            hidden: p.required.boolean,\n        }), (result) => {\n            this.viewProps.importState(result);\n            return true;\n        });\n    }\n    exportState() {\n        return exportBladeState(null, Object.assign({}, this.viewProps.exportState()));\n    }\n}\n\nclass LabeledValueBladeController extends BladeController {\n    constructor(doc, config) {\n        if (config.value !== config.valueController.value) {\n            throw TpError.shouldNeverHappen();\n        }\n        const viewProps = config.valueController.viewProps;\n        const lc = new LabelController(doc, {\n            blade: config.blade,\n            props: config.props,\n            valueController: config.valueController,\n        });\n        super(Object.assign(Object.assign({}, config), { view: new LabelView(doc, {\n                props: config.props,\n                viewProps: viewProps,\n            }), viewProps: viewProps }));\n        this.labelController = lc;\n        this.value = config.value;\n        this.valueController = config.valueController;\n        this.view.valueElement.appendChild(this.valueController.view.element);\n    }\n    importState(state) {\n        return importBladeState(state, (s) => {\n            var _a, _b, _c;\n            return super.importState(s) &&\n                this.labelController.importProps(s) &&\n                ((_c = (_b = (_a = this.valueController).importProps) === null || _b === void 0 ? void 0 : _b.call(_a, state)) !== null && _c !== void 0 ? _c : true);\n        }, (p) => ({\n            value: p.optional.raw,\n        }), (result) => {\n            if (result.value) {\n                this.value.rawValue = result.value;\n            }\n            return true;\n        });\n    }\n    exportState() {\n        var _a, _b, _c;\n        return exportBladeState(() => super.exportState(), Object.assign(Object.assign({ value: this.value.rawValue }, this.labelController.exportProps()), ((_c = (_b = (_a = this.valueController).exportProps) === null || _b === void 0 ? void 0 : _b.call(_a)) !== null && _c !== void 0 ? _c : {})));\n    }\n}\n\nfunction excludeValue(state) {\n    const result = Object.assign({}, state);\n    delete result.value;\n    return result;\n}\nclass BindingController extends LabeledValueBladeController {\n    constructor(doc, config) {\n        super(doc, config);\n        this.tag = config.tag;\n    }\n    importState(state) {\n        return importBladeState(state,\n        (_s) => super.importState(excludeValue(state)), (p) => ({\n            tag: p.optional.string,\n        }), (result) => {\n            this.tag = result.tag;\n            return true;\n        });\n    }\n    exportState() {\n        return exportBladeState(() => excludeValue(super.exportState()), {\n            binding: {\n                key: this.value.binding.target.key,\n                value: this.value.binding.target.read(),\n            },\n            tag: this.tag,\n        });\n    }\n}\nfunction isBindingController(bc) {\n    return isValueBladeController(bc) && isBindingValue(bc.value);\n}\n\nclass InputBindingController extends BindingController {\n    importState(state) {\n        return importBladeState(state, (s) => super.importState(s), (p) => ({\n            binding: p.required.object({\n                value: p.required.raw,\n            }),\n        }), (result) => {\n            this.value.binding.inject(result.binding.value);\n            this.value.fetch();\n            return true;\n        });\n    }\n}\nfunction isInputBindingController(bc) {\n    return isValueBladeController(bc) && isInputBindingValue(bc.value);\n}\n\nfunction fillBuffer(buffer, bufferSize) {\n    while (buffer.length < bufferSize) {\n        buffer.push(undefined);\n    }\n}\nfunction initializeBuffer(bufferSize) {\n    const buffer = [];\n    fillBuffer(buffer, bufferSize);\n    return buffer;\n}\nfunction createTrimmedBuffer(buffer) {\n    const index = buffer.indexOf(undefined);\n    return forceCast(index < 0 ? buffer : buffer.slice(0, index));\n}\nfunction createPushedBuffer(buffer, newValue) {\n    const newBuffer = [...createTrimmedBuffer(buffer), newValue];\n    if (newBuffer.length > buffer.length) {\n        newBuffer.splice(0, newBuffer.length - buffer.length);\n    }\n    else {\n        fillBuffer(newBuffer, buffer.length);\n    }\n    return newBuffer;\n}\n\nclass MonitorBindingValue {\n    constructor(config) {\n        this.emitter = new Emitter();\n        this.onTick_ = this.onTick_.bind(this);\n        this.onValueBeforeChange_ = this.onValueBeforeChange_.bind(this);\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.binding = config.binding;\n        this.value_ = createValue(initializeBuffer(config.bufferSize));\n        this.value_.emitter.on('beforechange', this.onValueBeforeChange_);\n        this.value_.emitter.on('change', this.onValueChange_);\n        this.ticker = config.ticker;\n        this.ticker.emitter.on('tick', this.onTick_);\n        this.fetch();\n    }\n    get rawValue() {\n        return this.value_.rawValue;\n    }\n    set rawValue(rawValue) {\n        this.value_.rawValue = rawValue;\n    }\n    setRawValue(rawValue, options) {\n        this.value_.setRawValue(rawValue, options);\n    }\n    fetch() {\n        this.value_.rawValue = createPushedBuffer(this.value_.rawValue, this.binding.read());\n    }\n    onTick_() {\n        this.fetch();\n    }\n    onValueBeforeChange_(ev) {\n        this.emitter.emit('beforechange', Object.assign(Object.assign({}, ev), { sender: this }));\n    }\n    onValueChange_(ev) {\n        this.emitter.emit('change', Object.assign(Object.assign({}, ev), { sender: this }));\n    }\n}\nfunction isMonitorBindingValue(v) {\n    if (!('binding' in v)) {\n        return false;\n    }\n    const b = v['binding'];\n    return isBinding(b) && 'read' in b && !('write' in b);\n}\n\nclass MonitorBindingController extends BindingController {\n    exportState() {\n        return exportBladeState(() => super.exportState(), {\n            binding: {\n                readonly: true,\n            },\n        });\n    }\n}\nfunction isMonitorBindingController(bc) {\n    return (isValueBladeController(bc) &&\n        isMonitorBindingValue(bc.value));\n}\n\nclass ButtonApi extends BladeApi {\n    get label() {\n        return this.controller.labelController.props.get('label');\n    }\n    set label(label) {\n        this.controller.labelController.props.set('label', label);\n    }\n    get title() {\n        var _a;\n        return (_a = this.controller.buttonController.props.get('title')) !== null && _a !== void 0 ? _a : '';\n    }\n    set title(title) {\n        this.controller.buttonController.props.set('title', title);\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        const emitter = this.controller.buttonController.emitter;\n        emitter.on(eventName, (ev) => {\n            bh(new TpMouseEvent(this, ev.nativeEvent));\n        });\n        return this;\n    }\n    off(eventName, handler) {\n        const emitter = this.controller.buttonController.emitter;\n        emitter.off(eventName, handler);\n        return this;\n    }\n}\n\nfunction applyClass(elem, className, active) {\n    if (active) {\n        elem.classList.add(className);\n    }\n    else {\n        elem.classList.remove(className);\n    }\n}\nfunction valueToClassName(elem, className) {\n    return (value) => {\n        applyClass(elem, className, value);\n    };\n}\nfunction bindValueToTextContent(value, elem) {\n    bindValue(value, (text) => {\n        elem.textContent = text !== null && text !== void 0 ? text : '';\n    });\n}\n\nconst cn$p = ClassName('btn');\nclass ButtonView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$p());\n        config.viewProps.bindClassModifiers(this.element);\n        const buttonElem = doc.createElement('button');\n        buttonElem.classList.add(cn$p('b'));\n        config.viewProps.bindDisabled(buttonElem);\n        this.element.appendChild(buttonElem);\n        this.buttonElement = buttonElem;\n        const titleElem = doc.createElement('div');\n        titleElem.classList.add(cn$p('t'));\n        bindValueToTextContent(config.props.value('title'), titleElem);\n        this.buttonElement.appendChild(titleElem);\n    }\n}\n\nclass ButtonController {\n    constructor(doc, config) {\n        this.emitter = new Emitter();\n        this.onClick_ = this.onClick_.bind(this);\n        this.props = config.props;\n        this.viewProps = config.viewProps;\n        this.view = new ButtonView(doc, {\n            props: this.props,\n            viewProps: this.viewProps,\n        });\n        this.view.buttonElement.addEventListener('click', this.onClick_);\n    }\n    importProps(state) {\n        return importBladeState(state, null, (p) => ({\n            title: p.optional.string,\n        }), (result) => {\n            this.props.set('title', result.title);\n            return true;\n        });\n    }\n    exportProps() {\n        return exportBladeState(null, {\n            title: this.props.get('title'),\n        });\n    }\n    onClick_(ev) {\n        this.emitter.emit('click', {\n            nativeEvent: ev,\n            sender: this,\n        });\n    }\n}\n\nclass ButtonBladeController extends BladeController {\n    constructor(doc, config) {\n        const bc = new ButtonController(doc, {\n            props: config.buttonProps,\n            viewProps: config.viewProps,\n        });\n        const lc = new LabelController(doc, {\n            blade: config.blade,\n            props: config.labelProps,\n            valueController: bc,\n        });\n        super({\n            blade: config.blade,\n            view: lc.view,\n            viewProps: config.viewProps,\n        });\n        this.buttonController = bc;\n        this.labelController = lc;\n    }\n    importState(state) {\n        return importBladeState(state, (s) => super.importState(s) &&\n            this.buttonController.importProps(s) &&\n            this.labelController.importProps(s), () => ({}), () => true);\n    }\n    exportState() {\n        return exportBladeState(() => super.exportState(), Object.assign(Object.assign({}, this.buttonController.exportProps()), this.labelController.exportProps()));\n    }\n}\n\nclass Semver {\n    constructor(text) {\n        const [core, prerelease] = text.split('-');\n        const coreComps = core.split('.');\n        this.major = parseInt(coreComps[0], 10);\n        this.minor = parseInt(coreComps[1], 10);\n        this.patch = parseInt(coreComps[2], 10);\n        this.prerelease = prerelease !== null && prerelease !== void 0 ? prerelease : null;\n    }\n    toString() {\n        const core = [this.major, this.minor, this.patch].join('.');\n        return this.prerelease !== null ? [core, this.prerelease].join('-') : core;\n    }\n}\n\nconst VERSION$1 = new Semver('2.0.5');\n\nfunction createPlugin(plugin) {\n    return Object.assign({ core: VERSION$1 }, plugin);\n}\n\nconst ButtonBladePlugin = createPlugin({\n    id: 'button',\n    type: 'blade',\n    accept(params) {\n        const result = parseRecord(params, (p) => ({\n            title: p.required.string,\n            view: p.required.constant('button'),\n            label: p.optional.string,\n        }));\n        return result ? { params: result } : null;\n    },\n    controller(args) {\n        return new ButtonBladeController(args.document, {\n            blade: args.blade,\n            buttonProps: ValueMap.fromObject({\n                title: args.params.title,\n            }),\n            labelProps: ValueMap.fromObject({\n                label: args.params.label,\n            }),\n            viewProps: args.viewProps,\n        });\n    },\n    api(args) {\n        if (args.controller instanceof ButtonBladeController) {\n            return new ButtonApi(args.controller);\n        }\n        return null;\n    },\n});\n\nfunction addButtonAsBlade(api, params) {\n    return api.addBlade(Object.assign(Object.assign({}, params), { view: 'button' }));\n}\nfunction addFolderAsBlade(api, params) {\n    return api.addBlade(Object.assign(Object.assign({}, params), { view: 'folder' }));\n}\nfunction addTabAsBlade(api, params) {\n    return api.addBlade(Object.assign(Object.assign({}, params), { view: 'tab' }));\n}\n\nfunction isRefreshable(value) {\n    if (!isObject$1(value)) {\n        return false;\n    }\n    return 'refresh' in value && typeof value.refresh === 'function';\n}\n\nfunction createBindingTarget(obj, key) {\n    if (!BindingTarget.isBindable(obj)) {\n        throw TpError.notBindable();\n    }\n    return new BindingTarget(obj, key);\n}\nclass RackApi {\n    constructor(controller, pool) {\n        this.onRackValueChange_ = this.onRackValueChange_.bind(this);\n        this.controller_ = controller;\n        this.emitter_ = new Emitter();\n        this.pool_ = pool;\n        const rack = this.controller_.rack;\n        rack.emitter.on('valuechange', this.onRackValueChange_);\n    }\n    get children() {\n        return this.controller_.rack.children.map((bc) => this.pool_.createApi(bc));\n    }\n    addBinding(object, key, opt_params) {\n        const params = opt_params !== null && opt_params !== void 0 ? opt_params : {};\n        const doc = this.controller_.element.ownerDocument;\n        const bc = this.pool_.createBinding(doc, createBindingTarget(object, key), params);\n        const api = this.pool_.createBindingApi(bc);\n        return this.add(api, params.index);\n    }\n    addFolder(params) {\n        return addFolderAsBlade(this, params);\n    }\n    addButton(params) {\n        return addButtonAsBlade(this, params);\n    }\n    addTab(params) {\n        return addTabAsBlade(this, params);\n    }\n    add(api, opt_index) {\n        const bc = api.controller;\n        this.controller_.rack.add(bc, opt_index);\n        return api;\n    }\n    remove(api) {\n        this.controller_.rack.remove(api.controller);\n    }\n    addBlade(params) {\n        const doc = this.controller_.element.ownerDocument;\n        const bc = this.pool_.createBlade(doc, params);\n        const api = this.pool_.createApi(bc);\n        return this.add(api, params.index);\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        this.emitter_.on(eventName, (ev) => {\n            bh(ev);\n        }, {\n            key: handler,\n        });\n        return this;\n    }\n    off(eventName, handler) {\n        this.emitter_.off(eventName, handler);\n        return this;\n    }\n    refresh() {\n        this.children.forEach((c) => {\n            if (isRefreshable(c)) {\n                c.refresh();\n            }\n        });\n    }\n    onRackValueChange_(ev) {\n        const bc = ev.bladeController;\n        const api = this.pool_.createApi(bc);\n        const binding = isBindingValue(bc.value) ? bc.value.binding : null;\n        this.emitter_.emit('change', new TpChangeEvent(api, binding ? binding.target.read() : bc.value.rawValue, ev.options.last));\n    }\n}\n\nclass ContainerBladeApi extends BladeApi {\n    constructor(controller, pool) {\n        super(controller);\n        this.rackApi_ = new RackApi(controller.rackController, pool);\n    }\n    refresh() {\n        this.rackApi_.refresh();\n    }\n}\n\nclass ContainerBladeController extends BladeController {\n    constructor(config) {\n        super({\n            blade: config.blade,\n            view: config.view,\n            viewProps: config.rackController.viewProps,\n        });\n        this.rackController = config.rackController;\n    }\n    importState(state) {\n        return importBladeState(state, (s) => super.importState(s), (p) => ({\n            children: p.required.array(p.required.raw),\n        }), (result) => {\n            return this.rackController.rack.children.every((c, index) => {\n                return c.importState(result.children[index]);\n            });\n        });\n    }\n    exportState() {\n        return exportBladeState(() => super.exportState(), {\n            children: this.rackController.rack.children.map((c) => c.exportState()),\n        });\n    }\n}\nfunction isContainerBladeController(bc) {\n    return 'rackController' in bc;\n}\n\nclass NestedOrderedSet {\n    constructor(extract) {\n        this.emitter = new Emitter();\n        this.items_ = [];\n        this.cache_ = new Set();\n        this.onSubListAdd_ = this.onSubListAdd_.bind(this);\n        this.onSubListRemove_ = this.onSubListRemove_.bind(this);\n        this.extract_ = extract;\n    }\n    get items() {\n        return this.items_;\n    }\n    allItems() {\n        return Array.from(this.cache_);\n    }\n    find(callback) {\n        for (const item of this.allItems()) {\n            if (callback(item)) {\n                return item;\n            }\n        }\n        return null;\n    }\n    includes(item) {\n        return this.cache_.has(item);\n    }\n    add(item, opt_index) {\n        if (this.includes(item)) {\n            throw TpError.shouldNeverHappen();\n        }\n        const index = opt_index !== undefined ? opt_index : this.items_.length;\n        this.items_.splice(index, 0, item);\n        this.cache_.add(item);\n        const subList = this.extract_(item);\n        if (subList) {\n            subList.emitter.on('add', this.onSubListAdd_);\n            subList.emitter.on('remove', this.onSubListRemove_);\n            subList.allItems().forEach((i) => {\n                this.cache_.add(i);\n            });\n        }\n        this.emitter.emit('add', {\n            index: index,\n            item: item,\n            root: this,\n            target: this,\n        });\n    }\n    remove(item) {\n        const index = this.items_.indexOf(item);\n        if (index < 0) {\n            return;\n        }\n        this.items_.splice(index, 1);\n        this.cache_.delete(item);\n        const subList = this.extract_(item);\n        if (subList) {\n            subList.allItems().forEach((i) => {\n                this.cache_.delete(i);\n            });\n            subList.emitter.off('add', this.onSubListAdd_);\n            subList.emitter.off('remove', this.onSubListRemove_);\n        }\n        this.emitter.emit('remove', {\n            index: index,\n            item: item,\n            root: this,\n            target: this,\n        });\n    }\n    onSubListAdd_(ev) {\n        this.cache_.add(ev.item);\n        this.emitter.emit('add', {\n            index: ev.index,\n            item: ev.item,\n            root: this,\n            target: ev.target,\n        });\n    }\n    onSubListRemove_(ev) {\n        this.cache_.delete(ev.item);\n        this.emitter.emit('remove', {\n            index: ev.index,\n            item: ev.item,\n            root: this,\n            target: ev.target,\n        });\n    }\n}\n\nfunction findValueBladeController(bcs, v) {\n    for (let i = 0; i < bcs.length; i++) {\n        const bc = bcs[i];\n        if (isValueBladeController(bc) && bc.value === v) {\n            return bc;\n        }\n    }\n    return null;\n}\nfunction findSubBladeControllerSet(bc) {\n    return isContainerBladeController(bc)\n        ? bc.rackController.rack['bcSet_']\n        : null;\n}\nclass Rack {\n    constructor(config) {\n        var _a, _b;\n        this.emitter = new Emitter();\n        this.onBladePositionsChange_ = this.onBladePositionsChange_.bind(this);\n        this.onSetAdd_ = this.onSetAdd_.bind(this);\n        this.onSetRemove_ = this.onSetRemove_.bind(this);\n        this.onChildDispose_ = this.onChildDispose_.bind(this);\n        this.onChildPositionsChange_ = this.onChildPositionsChange_.bind(this);\n        this.onChildValueChange_ = this.onChildValueChange_.bind(this);\n        this.onChildViewPropsChange_ = this.onChildViewPropsChange_.bind(this);\n        this.onRackLayout_ = this.onRackLayout_.bind(this);\n        this.onRackValueChange_ = this.onRackValueChange_.bind(this);\n        this.blade_ = (_a = config.blade) !== null && _a !== void 0 ? _a : null;\n        (_b = this.blade_) === null || _b === void 0 ? void 0 : _b.value('positions').emitter.on('change', this.onBladePositionsChange_);\n        this.viewProps = config.viewProps;\n        this.bcSet_ = new NestedOrderedSet(findSubBladeControllerSet);\n        this.bcSet_.emitter.on('add', this.onSetAdd_);\n        this.bcSet_.emitter.on('remove', this.onSetRemove_);\n    }\n    get children() {\n        return this.bcSet_.items;\n    }\n    add(bc, opt_index) {\n        var _a;\n        (_a = bc.parent) === null || _a === void 0 ? void 0 : _a.remove(bc);\n        bc.parent = this;\n        this.bcSet_.add(bc, opt_index);\n    }\n    remove(bc) {\n        bc.parent = null;\n        this.bcSet_.remove(bc);\n    }\n    find(finder) {\n        return this.bcSet_.allItems().filter(finder);\n    }\n    onSetAdd_(ev) {\n        this.updatePositions_();\n        const root = ev.target === ev.root;\n        this.emitter.emit('add', {\n            bladeController: ev.item,\n            index: ev.index,\n            root: root,\n            sender: this,\n        });\n        if (!root) {\n            return;\n        }\n        const bc = ev.item;\n        bc.viewProps.emitter.on('change', this.onChildViewPropsChange_);\n        bc.blade\n            .value('positions')\n            .emitter.on('change', this.onChildPositionsChange_);\n        bc.viewProps.handleDispose(this.onChildDispose_);\n        if (isValueBladeController(bc)) {\n            bc.value.emitter.on('change', this.onChildValueChange_);\n        }\n        else if (isContainerBladeController(bc)) {\n            const rack = bc.rackController.rack;\n            if (rack) {\n                const emitter = rack.emitter;\n                emitter.on('layout', this.onRackLayout_);\n                emitter.on('valuechange', this.onRackValueChange_);\n            }\n        }\n    }\n    onSetRemove_(ev) {\n        this.updatePositions_();\n        const root = ev.target === ev.root;\n        this.emitter.emit('remove', {\n            bladeController: ev.item,\n            root: root,\n            sender: this,\n        });\n        if (!root) {\n            return;\n        }\n        const bc = ev.item;\n        if (isValueBladeController(bc)) {\n            bc.value.emitter.off('change', this.onChildValueChange_);\n        }\n        else if (isContainerBladeController(bc)) {\n            const rack = bc.rackController.rack;\n            if (rack) {\n                const emitter = rack.emitter;\n                emitter.off('layout', this.onRackLayout_);\n                emitter.off('valuechange', this.onRackValueChange_);\n            }\n        }\n    }\n    updatePositions_() {\n        const visibleItems = this.bcSet_.items.filter((bc) => !bc.viewProps.get('hidden'));\n        const firstVisibleItem = visibleItems[0];\n        const lastVisibleItem = visibleItems[visibleItems.length - 1];\n        this.bcSet_.items.forEach((bc) => {\n            const ps = [];\n            if (bc === firstVisibleItem) {\n                ps.push('first');\n                if (!this.blade_ ||\n                    this.blade_.get('positions').includes('veryfirst')) {\n                    ps.push('veryfirst');\n                }\n            }\n            if (bc === lastVisibleItem) {\n                ps.push('last');\n                if (!this.blade_ || this.blade_.get('positions').includes('verylast')) {\n                    ps.push('verylast');\n                }\n            }\n            bc.blade.set('positions', ps);\n        });\n    }\n    onChildPositionsChange_() {\n        this.updatePositions_();\n        this.emitter.emit('layout', {\n            sender: this,\n        });\n    }\n    onChildViewPropsChange_(_ev) {\n        this.updatePositions_();\n        this.emitter.emit('layout', {\n            sender: this,\n        });\n    }\n    onChildDispose_() {\n        const disposedUcs = this.bcSet_.items.filter((bc) => {\n            return bc.viewProps.get('disposed');\n        });\n        disposedUcs.forEach((bc) => {\n            this.bcSet_.remove(bc);\n        });\n    }\n    onChildValueChange_(ev) {\n        const bc = findValueBladeController(this.find(isValueBladeController), ev.sender);\n        if (!bc) {\n            throw TpError.alreadyDisposed();\n        }\n        this.emitter.emit('valuechange', {\n            bladeController: bc,\n            options: ev.options,\n            sender: this,\n        });\n    }\n    onRackLayout_(_) {\n        this.updatePositions_();\n        this.emitter.emit('layout', {\n            sender: this,\n        });\n    }\n    onRackValueChange_(ev) {\n        this.emitter.emit('valuechange', {\n            bladeController: ev.bladeController,\n            options: ev.options,\n            sender: this,\n        });\n    }\n    onBladePositionsChange_() {\n        this.updatePositions_();\n    }\n}\n\nclass RackController {\n    constructor(config) {\n        this.onRackAdd_ = this.onRackAdd_.bind(this);\n        this.onRackRemove_ = this.onRackRemove_.bind(this);\n        this.element = config.element;\n        this.viewProps = config.viewProps;\n        const rack = new Rack({\n            blade: config.root ? undefined : config.blade,\n            viewProps: config.viewProps,\n        });\n        rack.emitter.on('add', this.onRackAdd_);\n        rack.emitter.on('remove', this.onRackRemove_);\n        this.rack = rack;\n        this.viewProps.handleDispose(() => {\n            for (let i = this.rack.children.length - 1; i >= 0; i--) {\n                const bc = this.rack.children[i];\n                bc.viewProps.set('disposed', true);\n            }\n        });\n    }\n    onRackAdd_(ev) {\n        if (!ev.root) {\n            return;\n        }\n        insertElementAt(this.element, ev.bladeController.view.element, ev.index);\n    }\n    onRackRemove_(ev) {\n        if (!ev.root) {\n            return;\n        }\n        removeElement(ev.bladeController.view.element);\n    }\n}\n\nfunction createBlade() {\n    return new ValueMap({\n        positions: createValue([], {\n            equals: deepEqualsArray,\n        }),\n    });\n}\n\nclass Foldable extends ValueMap {\n    constructor(valueMap) {\n        super(valueMap);\n    }\n    static create(expanded) {\n        const coreObj = {\n            completed: true,\n            expanded: expanded,\n            expandedHeight: null,\n            shouldFixHeight: false,\n            temporaryExpanded: null,\n        };\n        const core = ValueMap.createCore(coreObj);\n        return new Foldable(core);\n    }\n    get styleExpanded() {\n        var _a;\n        return (_a = this.get('temporaryExpanded')) !== null && _a !== void 0 ? _a : this.get('expanded');\n    }\n    get styleHeight() {\n        if (!this.styleExpanded) {\n            return '0';\n        }\n        const exHeight = this.get('expandedHeight');\n        if (this.get('shouldFixHeight') && !isEmpty(exHeight)) {\n            return `${exHeight}px`;\n        }\n        return 'auto';\n    }\n    bindExpandedClass(elem, expandedClassName) {\n        const onExpand = () => {\n            const expanded = this.styleExpanded;\n            if (expanded) {\n                elem.classList.add(expandedClassName);\n            }\n            else {\n                elem.classList.remove(expandedClassName);\n            }\n        };\n        bindValueMap(this, 'expanded', onExpand);\n        bindValueMap(this, 'temporaryExpanded', onExpand);\n    }\n    cleanUpTransition() {\n        this.set('shouldFixHeight', false);\n        this.set('expandedHeight', null);\n        this.set('completed', true);\n    }\n}\nfunction computeExpandedFolderHeight(folder, containerElement) {\n    let height = 0;\n    disableTransitionTemporarily(containerElement, () => {\n        folder.set('expandedHeight', null);\n        folder.set('temporaryExpanded', true);\n        forceReflow(containerElement);\n        height = containerElement.clientHeight;\n        folder.set('temporaryExpanded', null);\n        forceReflow(containerElement);\n    });\n    return height;\n}\nfunction applyHeight(foldable, elem) {\n    elem.style.height = foldable.styleHeight;\n}\nfunction bindFoldable(foldable, elem) {\n    foldable.value('expanded').emitter.on('beforechange', () => {\n        foldable.set('completed', false);\n        if (isEmpty(foldable.get('expandedHeight'))) {\n            const h = computeExpandedFolderHeight(foldable, elem);\n            if (h > 0) {\n                foldable.set('expandedHeight', h);\n            }\n        }\n        foldable.set('shouldFixHeight', true);\n        forceReflow(elem);\n    });\n    foldable.emitter.on('change', () => {\n        applyHeight(foldable, elem);\n    });\n    applyHeight(foldable, elem);\n    elem.addEventListener('transitionend', (ev) => {\n        if (ev.propertyName !== 'height') {\n            return;\n        }\n        foldable.cleanUpTransition();\n    });\n}\n\nclass FolderApi extends ContainerBladeApi {\n    constructor(controller, pool) {\n        super(controller, pool);\n        this.emitter_ = new Emitter();\n        this.controller.foldable\n            .value('expanded')\n            .emitter.on('change', (ev) => {\n            this.emitter_.emit('fold', new TpFoldEvent(this, ev.sender.rawValue));\n        });\n        this.rackApi_.on('change', (ev) => {\n            this.emitter_.emit('change', ev);\n        });\n    }\n    get expanded() {\n        return this.controller.foldable.get('expanded');\n    }\n    set expanded(expanded) {\n        this.controller.foldable.set('expanded', expanded);\n    }\n    get title() {\n        return this.controller.props.get('title');\n    }\n    set title(title) {\n        this.controller.props.set('title', title);\n    }\n    get children() {\n        return this.rackApi_.children;\n    }\n    addBinding(object, key, opt_params) {\n        return this.rackApi_.addBinding(object, key, opt_params);\n    }\n    addFolder(params) {\n        return this.rackApi_.addFolder(params);\n    }\n    addButton(params) {\n        return this.rackApi_.addButton(params);\n    }\n    addTab(params) {\n        return this.rackApi_.addTab(params);\n    }\n    add(api, opt_index) {\n        return this.rackApi_.add(api, opt_index);\n    }\n    remove(api) {\n        this.rackApi_.remove(api);\n    }\n    addBlade(params) {\n        return this.rackApi_.addBlade(params);\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        this.emitter_.on(eventName, (ev) => {\n            bh(ev);\n        }, {\n            key: handler,\n        });\n        return this;\n    }\n    off(eventName, handler) {\n        this.emitter_.off(eventName, handler);\n        return this;\n    }\n}\n\nconst bladeContainerClassName = ClassName('cnt');\n\nclass FolderView {\n    constructor(doc, config) {\n        var _a;\n        this.className_ = ClassName((_a = config.viewName) !== null && _a !== void 0 ? _a : 'fld');\n        this.element = doc.createElement('div');\n        this.element.classList.add(this.className_(), bladeContainerClassName());\n        config.viewProps.bindClassModifiers(this.element);\n        this.foldable_ = config.foldable;\n        this.foldable_.bindExpandedClass(this.element, this.className_(undefined, 'expanded'));\n        bindValueMap(this.foldable_, 'completed', valueToClassName(this.element, this.className_(undefined, 'cpl')));\n        const buttonElem = doc.createElement('button');\n        buttonElem.classList.add(this.className_('b'));\n        bindValueMap(config.props, 'title', (title) => {\n            if (isEmpty(title)) {\n                this.element.classList.add(this.className_(undefined, 'not'));\n            }\n            else {\n                this.element.classList.remove(this.className_(undefined, 'not'));\n            }\n        });\n        config.viewProps.bindDisabled(buttonElem);\n        this.element.appendChild(buttonElem);\n        this.buttonElement = buttonElem;\n        const indentElem = doc.createElement('div');\n        indentElem.classList.add(this.className_('i'));\n        this.element.appendChild(indentElem);\n        const titleElem = doc.createElement('div');\n        titleElem.classList.add(this.className_('t'));\n        bindValueToTextContent(config.props.value('title'), titleElem);\n        this.buttonElement.appendChild(titleElem);\n        this.titleElement = titleElem;\n        const markElem = doc.createElement('div');\n        markElem.classList.add(this.className_('m'));\n        this.buttonElement.appendChild(markElem);\n        const containerElem = doc.createElement('div');\n        containerElem.classList.add(this.className_('c'));\n        this.element.appendChild(containerElem);\n        this.containerElement = containerElem;\n    }\n}\n\nclass FolderController extends ContainerBladeController {\n    constructor(doc, config) {\n        var _a;\n        const foldable = Foldable.create((_a = config.expanded) !== null && _a !== void 0 ? _a : true);\n        const view = new FolderView(doc, {\n            foldable: foldable,\n            props: config.props,\n            viewName: config.root ? 'rot' : undefined,\n            viewProps: config.viewProps,\n        });\n        super(Object.assign(Object.assign({}, config), { rackController: new RackController({\n                blade: config.blade,\n                element: view.containerElement,\n                root: config.root,\n                viewProps: config.viewProps,\n            }), view: view }));\n        this.onTitleClick_ = this.onTitleClick_.bind(this);\n        this.props = config.props;\n        this.foldable = foldable;\n        bindFoldable(this.foldable, this.view.containerElement);\n        this.rackController.rack.emitter.on('add', () => {\n            this.foldable.cleanUpTransition();\n        });\n        this.rackController.rack.emitter.on('remove', () => {\n            this.foldable.cleanUpTransition();\n        });\n        this.view.buttonElement.addEventListener('click', this.onTitleClick_);\n    }\n    get document() {\n        return this.view.element.ownerDocument;\n    }\n    importState(state) {\n        return importBladeState(state, (s) => super.importState(s), (p) => ({\n            expanded: p.required.boolean,\n            title: p.optional.string,\n        }), (result) => {\n            this.foldable.set('expanded', result.expanded);\n            this.props.set('title', result.title);\n            return true;\n        });\n    }\n    exportState() {\n        return exportBladeState(() => super.exportState(), {\n            expanded: this.foldable.get('expanded'),\n            title: this.props.get('title'),\n        });\n    }\n    onTitleClick_() {\n        this.foldable.set('expanded', !this.foldable.get('expanded'));\n    }\n}\n\nconst FolderBladePlugin = createPlugin({\n    id: 'folder',\n    type: 'blade',\n    accept(params) {\n        const result = parseRecord(params, (p) => ({\n            title: p.required.string,\n            view: p.required.constant('folder'),\n            expanded: p.optional.boolean,\n        }));\n        return result ? { params: result } : null;\n    },\n    controller(args) {\n        return new FolderController(args.document, {\n            blade: args.blade,\n            expanded: args.params.expanded,\n            props: ValueMap.fromObject({\n                title: args.params.title,\n            }),\n            viewProps: args.viewProps,\n        });\n    },\n    api(args) {\n        if (!(args.controller instanceof FolderController)) {\n            return null;\n        }\n        return new FolderApi(args.controller, args.pool);\n    },\n});\n\nconst cn$o = ClassName('');\nfunction valueToModifier(elem, modifier) {\n    return valueToClassName(elem, cn$o(undefined, modifier));\n}\nclass ViewProps extends ValueMap {\n    constructor(valueMap) {\n        var _a;\n        super(valueMap);\n        this.onDisabledChange_ = this.onDisabledChange_.bind(this);\n        this.onParentChange_ = this.onParentChange_.bind(this);\n        this.onParentGlobalDisabledChange_ =\n            this.onParentGlobalDisabledChange_.bind(this);\n        [this.globalDisabled_, this.setGlobalDisabled_] = createReadonlyValue(createValue(this.getGlobalDisabled_()));\n        this.value('disabled').emitter.on('change', this.onDisabledChange_);\n        this.value('parent').emitter.on('change', this.onParentChange_);\n        (_a = this.get('parent')) === null || _a === void 0 ? void 0 : _a.globalDisabled.emitter.on('change', this.onParentGlobalDisabledChange_);\n    }\n    static create(opt_initialValue) {\n        var _a, _b, _c;\n        const initialValue = opt_initialValue !== null && opt_initialValue !== void 0 ? opt_initialValue : {};\n        return new ViewProps(ValueMap.createCore({\n            disabled: (_a = initialValue.disabled) !== null && _a !== void 0 ? _a : false,\n            disposed: false,\n            hidden: (_b = initialValue.hidden) !== null && _b !== void 0 ? _b : false,\n            parent: (_c = initialValue.parent) !== null && _c !== void 0 ? _c : null,\n        }));\n    }\n    get globalDisabled() {\n        return this.globalDisabled_;\n    }\n    bindClassModifiers(elem) {\n        bindValue(this.globalDisabled_, valueToModifier(elem, 'disabled'));\n        bindValueMap(this, 'hidden', valueToModifier(elem, 'hidden'));\n    }\n    bindDisabled(target) {\n        bindValue(this.globalDisabled_, (disabled) => {\n            target.disabled = disabled;\n        });\n    }\n    bindTabIndex(elem) {\n        bindValue(this.globalDisabled_, (disabled) => {\n            elem.tabIndex = disabled ? -1 : 0;\n        });\n    }\n    handleDispose(callback) {\n        this.value('disposed').emitter.on('change', (disposed) => {\n            if (disposed) {\n                callback();\n            }\n        });\n    }\n    importState(state) {\n        this.set('disabled', state.disabled);\n        this.set('hidden', state.hidden);\n    }\n    exportState() {\n        return {\n            disabled: this.get('disabled'),\n            hidden: this.get('hidden'),\n        };\n    }\n    getGlobalDisabled_() {\n        const parent = this.get('parent');\n        const parentDisabled = parent ? parent.globalDisabled.rawValue : false;\n        return parentDisabled || this.get('disabled');\n    }\n    updateGlobalDisabled_() {\n        this.setGlobalDisabled_(this.getGlobalDisabled_());\n    }\n    onDisabledChange_() {\n        this.updateGlobalDisabled_();\n    }\n    onParentGlobalDisabledChange_() {\n        this.updateGlobalDisabled_();\n    }\n    onParentChange_(ev) {\n        var _a;\n        const prevParent = ev.previousRawValue;\n        prevParent === null || prevParent === void 0 ? void 0 : prevParent.globalDisabled.emitter.off('change', this.onParentGlobalDisabledChange_);\n        (_a = this.get('parent')) === null || _a === void 0 ? void 0 : _a.globalDisabled.emitter.on('change', this.onParentGlobalDisabledChange_);\n        this.updateGlobalDisabled_();\n    }\n}\n\nconst cn$n = ClassName('tbp');\nclass TabPageView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$n());\n        config.viewProps.bindClassModifiers(this.element);\n        const containerElem = doc.createElement('div');\n        containerElem.classList.add(cn$n('c'));\n        this.element.appendChild(containerElem);\n        this.containerElement = containerElem;\n    }\n}\n\nconst cn$m = ClassName('tbi');\nclass TabItemView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$m());\n        config.viewProps.bindClassModifiers(this.element);\n        bindValueMap(config.props, 'selected', (selected) => {\n            if (selected) {\n                this.element.classList.add(cn$m(undefined, 'sel'));\n            }\n            else {\n                this.element.classList.remove(cn$m(undefined, 'sel'));\n            }\n        });\n        const buttonElem = doc.createElement('button');\n        buttonElem.classList.add(cn$m('b'));\n        config.viewProps.bindDisabled(buttonElem);\n        this.element.appendChild(buttonElem);\n        this.buttonElement = buttonElem;\n        const titleElem = doc.createElement('div');\n        titleElem.classList.add(cn$m('t'));\n        bindValueToTextContent(config.props.value('title'), titleElem);\n        this.buttonElement.appendChild(titleElem);\n        this.titleElement = titleElem;\n    }\n}\n\nclass TabItemController {\n    constructor(doc, config) {\n        this.emitter = new Emitter();\n        this.onClick_ = this.onClick_.bind(this);\n        this.props = config.props;\n        this.viewProps = config.viewProps;\n        this.view = new TabItemView(doc, {\n            props: config.props,\n            viewProps: config.viewProps,\n        });\n        this.view.buttonElement.addEventListener('click', this.onClick_);\n    }\n    onClick_() {\n        this.emitter.emit('click', {\n            sender: this,\n        });\n    }\n}\n\nclass TabPageController extends ContainerBladeController {\n    constructor(doc, config) {\n        const view = new TabPageView(doc, {\n            viewProps: config.viewProps,\n        });\n        super(Object.assign(Object.assign({}, config), { rackController: new RackController({\n                blade: config.blade,\n                element: view.containerElement,\n                viewProps: config.viewProps,\n            }), view: view }));\n        this.onItemClick_ = this.onItemClick_.bind(this);\n        this.ic_ = new TabItemController(doc, {\n            props: config.itemProps,\n            viewProps: ViewProps.create(),\n        });\n        this.ic_.emitter.on('click', this.onItemClick_);\n        this.props = config.props;\n        bindValueMap(this.props, 'selected', (selected) => {\n            this.itemController.props.set('selected', selected);\n            this.viewProps.set('hidden', !selected);\n        });\n    }\n    get itemController() {\n        return this.ic_;\n    }\n    importState(state) {\n        return importBladeState(state, (s) => super.importState(s), (p) => ({\n            selected: p.required.boolean,\n            title: p.required.string,\n        }), (result) => {\n            this.ic_.props.set('selected', result.selected);\n            this.ic_.props.set('title', result.title);\n            return true;\n        });\n    }\n    exportState() {\n        return exportBladeState(() => super.exportState(), {\n            selected: this.ic_.props.get('selected'),\n            title: this.ic_.props.get('title'),\n        });\n    }\n    onItemClick_() {\n        this.props.set('selected', true);\n    }\n}\n\nclass TabApi extends ContainerBladeApi {\n    constructor(controller, pool) {\n        super(controller, pool);\n        this.emitter_ = new Emitter();\n        this.onSelect_ = this.onSelect_.bind(this);\n        this.pool_ = pool;\n        this.rackApi_.on('change', (ev) => {\n            this.emitter_.emit('change', ev);\n        });\n        this.controller.tab.selectedIndex.emitter.on('change', this.onSelect_);\n    }\n    get pages() {\n        return this.rackApi_.children;\n    }\n    addPage(params) {\n        const doc = this.controller.view.element.ownerDocument;\n        const pc = new TabPageController(doc, {\n            blade: createBlade(),\n            itemProps: ValueMap.fromObject({\n                selected: false,\n                title: params.title,\n            }),\n            props: ValueMap.fromObject({\n                selected: false,\n            }),\n            viewProps: ViewProps.create(),\n        });\n        const papi = this.pool_.createApi(pc);\n        return this.rackApi_.add(papi, params.index);\n    }\n    removePage(index) {\n        this.rackApi_.remove(this.rackApi_.children[index]);\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        this.emitter_.on(eventName, (ev) => {\n            bh(ev);\n        }, {\n            key: handler,\n        });\n        return this;\n    }\n    off(eventName, handler) {\n        this.emitter_.off(eventName, handler);\n        return this;\n    }\n    onSelect_(ev) {\n        this.emitter_.emit('select', new TpTabSelectEvent(this, ev.rawValue));\n    }\n}\n\nclass TabPageApi extends ContainerBladeApi {\n    get title() {\n        var _a;\n        return (_a = this.controller.itemController.props.get('title')) !== null && _a !== void 0 ? _a : '';\n    }\n    set title(title) {\n        this.controller.itemController.props.set('title', title);\n    }\n    get selected() {\n        return this.controller.props.get('selected');\n    }\n    set selected(selected) {\n        this.controller.props.set('selected', selected);\n    }\n    get children() {\n        return this.rackApi_.children;\n    }\n    addButton(params) {\n        return this.rackApi_.addButton(params);\n    }\n    addFolder(params) {\n        return this.rackApi_.addFolder(params);\n    }\n    addTab(params) {\n        return this.rackApi_.addTab(params);\n    }\n    add(api, opt_index) {\n        this.rackApi_.add(api, opt_index);\n    }\n    remove(api) {\n        this.rackApi_.remove(api);\n    }\n    addBinding(object, key, opt_params) {\n        return this.rackApi_.addBinding(object, key, opt_params);\n    }\n    addBlade(params) {\n        return this.rackApi_.addBlade(params);\n    }\n}\n\nconst INDEX_NOT_SELECTED = -1;\nclass Tab {\n    constructor() {\n        this.onItemSelectedChange_ = this.onItemSelectedChange_.bind(this);\n        this.empty = createValue(true);\n        this.selectedIndex = createValue(INDEX_NOT_SELECTED);\n        this.items_ = [];\n    }\n    add(item, opt_index) {\n        const index = opt_index !== null && opt_index !== void 0 ? opt_index : this.items_.length;\n        this.items_.splice(index, 0, item);\n        item.emitter.on('change', this.onItemSelectedChange_);\n        this.keepSelection_();\n    }\n    remove(item) {\n        const index = this.items_.indexOf(item);\n        if (index < 0) {\n            return;\n        }\n        this.items_.splice(index, 1);\n        item.emitter.off('change', this.onItemSelectedChange_);\n        this.keepSelection_();\n    }\n    keepSelection_() {\n        if (this.items_.length === 0) {\n            this.selectedIndex.rawValue = INDEX_NOT_SELECTED;\n            this.empty.rawValue = true;\n            return;\n        }\n        const firstSelIndex = this.items_.findIndex((s) => s.rawValue);\n        if (firstSelIndex < 0) {\n            this.items_.forEach((s, i) => {\n                s.rawValue = i === 0;\n            });\n            this.selectedIndex.rawValue = 0;\n        }\n        else {\n            this.items_.forEach((s, i) => {\n                s.rawValue = i === firstSelIndex;\n            });\n            this.selectedIndex.rawValue = firstSelIndex;\n        }\n        this.empty.rawValue = false;\n    }\n    onItemSelectedChange_(ev) {\n        if (ev.rawValue) {\n            const index = this.items_.findIndex((s) => s === ev.sender);\n            this.items_.forEach((s, i) => {\n                s.rawValue = i === index;\n            });\n            this.selectedIndex.rawValue = index;\n        }\n        else {\n            this.keepSelection_();\n        }\n    }\n}\n\nconst cn$l = ClassName('tab');\nclass TabView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$l(), bladeContainerClassName());\n        config.viewProps.bindClassModifiers(this.element);\n        bindValue(config.empty, valueToClassName(this.element, cn$l(undefined, 'nop')));\n        const titleElem = doc.createElement('div');\n        titleElem.classList.add(cn$l('t'));\n        this.element.appendChild(titleElem);\n        this.itemsElement = titleElem;\n        const indentElem = doc.createElement('div');\n        indentElem.classList.add(cn$l('i'));\n        this.element.appendChild(indentElem);\n        const contentsElem = doc.createElement('div');\n        contentsElem.classList.add(cn$l('c'));\n        this.element.appendChild(contentsElem);\n        this.contentsElement = contentsElem;\n    }\n}\n\nclass TabController extends ContainerBladeController {\n    constructor(doc, config) {\n        const tab = new Tab();\n        const view = new TabView(doc, {\n            empty: tab.empty,\n            viewProps: config.viewProps,\n        });\n        super({\n            blade: config.blade,\n            rackController: new RackController({\n                blade: config.blade,\n                element: view.contentsElement,\n                viewProps: config.viewProps,\n            }),\n            view: view,\n        });\n        this.onRackAdd_ = this.onRackAdd_.bind(this);\n        this.onRackRemove_ = this.onRackRemove_.bind(this);\n        const rack = this.rackController.rack;\n        rack.emitter.on('add', this.onRackAdd_);\n        rack.emitter.on('remove', this.onRackRemove_);\n        this.tab = tab;\n    }\n    add(pc, opt_index) {\n        this.rackController.rack.add(pc, opt_index);\n    }\n    remove(index) {\n        this.rackController.rack.remove(this.rackController.rack.children[index]);\n    }\n    onRackAdd_(ev) {\n        if (!ev.root) {\n            return;\n        }\n        const pc = ev.bladeController;\n        insertElementAt(this.view.itemsElement, pc.itemController.view.element, ev.index);\n        pc.itemController.viewProps.set('parent', this.viewProps);\n        this.tab.add(pc.props.value('selected'));\n    }\n    onRackRemove_(ev) {\n        if (!ev.root) {\n            return;\n        }\n        const pc = ev.bladeController;\n        removeElement(pc.itemController.view.element);\n        pc.itemController.viewProps.set('parent', null);\n        this.tab.remove(pc.props.value('selected'));\n    }\n}\n\nconst TabBladePlugin = createPlugin({\n    id: 'tab',\n    type: 'blade',\n    accept(params) {\n        const result = parseRecord(params, (p) => ({\n            pages: p.required.array(p.required.object({ title: p.required.string })),\n            view: p.required.constant('tab'),\n        }));\n        if (!result || result.pages.length === 0) {\n            return null;\n        }\n        return { params: result };\n    },\n    controller(args) {\n        const c = new TabController(args.document, {\n            blade: args.blade,\n            viewProps: args.viewProps,\n        });\n        args.params.pages.forEach((p) => {\n            const pc = new TabPageController(args.document, {\n                blade: createBlade(),\n                itemProps: ValueMap.fromObject({\n                    selected: false,\n                    title: p.title,\n                }),\n                props: ValueMap.fromObject({\n                    selected: false,\n                }),\n                viewProps: ViewProps.create(),\n            });\n            c.add(pc);\n        });\n        return c;\n    },\n    api(args) {\n        if (args.controller instanceof TabController) {\n            return new TabApi(args.controller, args.pool);\n        }\n        if (args.controller instanceof TabPageController) {\n            return new TabPageApi(args.controller, args.pool);\n        }\n        return null;\n    },\n});\n\nfunction createBladeController(plugin, args) {\n    const ac = plugin.accept(args.params);\n    if (!ac) {\n        return null;\n    }\n    const params = parseRecord(args.params, (p) => ({\n        disabled: p.optional.boolean,\n        hidden: p.optional.boolean,\n    }));\n    return plugin.controller({\n        blade: createBlade(),\n        document: args.document,\n        params: forceCast(Object.assign(Object.assign({}, ac.params), { disabled: params === null || params === void 0 ? void 0 : params.disabled, hidden: params === null || params === void 0 ? void 0 : params.hidden })),\n        viewProps: ViewProps.create({\n            disabled: params === null || params === void 0 ? void 0 : params.disabled,\n            hidden: params === null || params === void 0 ? void 0 : params.hidden,\n        }),\n    });\n}\n\nclass ListInputBindingApi extends BindingApi {\n    get options() {\n        return this.controller.valueController.props.get('options');\n    }\n    set options(options) {\n        this.controller.valueController.props.set('options', options);\n    }\n}\n\nclass ManualTicker {\n    constructor() {\n        this.disabled = false;\n        this.emitter = new Emitter();\n    }\n    dispose() { }\n    tick() {\n        if (this.disabled) {\n            return;\n        }\n        this.emitter.emit('tick', {\n            sender: this,\n        });\n    }\n}\n\nclass IntervalTicker {\n    constructor(doc, interval) {\n        this.disabled_ = false;\n        this.timerId_ = null;\n        this.onTick_ = this.onTick_.bind(this);\n        this.doc_ = doc;\n        this.emitter = new Emitter();\n        this.interval_ = interval;\n        this.setTimer_();\n    }\n    get disabled() {\n        return this.disabled_;\n    }\n    set disabled(inactive) {\n        this.disabled_ = inactive;\n        if (this.disabled_) {\n            this.clearTimer_();\n        }\n        else {\n            this.setTimer_();\n        }\n    }\n    dispose() {\n        this.clearTimer_();\n    }\n    clearTimer_() {\n        if (this.timerId_ === null) {\n            return;\n        }\n        const win = this.doc_.defaultView;\n        if (win) {\n            win.clearInterval(this.timerId_);\n        }\n        this.timerId_ = null;\n    }\n    setTimer_() {\n        this.clearTimer_();\n        if (this.interval_ <= 0) {\n            return;\n        }\n        const win = this.doc_.defaultView;\n        if (win) {\n            this.timerId_ = win.setInterval(this.onTick_, this.interval_);\n        }\n    }\n    onTick_() {\n        if (this.disabled_) {\n            return;\n        }\n        this.emitter.emit('tick', {\n            sender: this,\n        });\n    }\n}\n\nclass CompositeConstraint {\n    constructor(constraints) {\n        this.constraints = constraints;\n    }\n    constrain(value) {\n        return this.constraints.reduce((result, c) => {\n            return c.constrain(result);\n        }, value);\n    }\n}\nfunction findConstraint(c, constraintClass) {\n    if (c instanceof constraintClass) {\n        return c;\n    }\n    if (c instanceof CompositeConstraint) {\n        const result = c.constraints.reduce((tmpResult, sc) => {\n            if (tmpResult) {\n                return tmpResult;\n            }\n            return sc instanceof constraintClass ? sc : null;\n        }, null);\n        if (result) {\n            return result;\n        }\n    }\n    return null;\n}\n\nclass ListConstraint {\n    constructor(options) {\n        this.values = ValueMap.fromObject({\n            options: options,\n        });\n    }\n    constrain(value) {\n        const opts = this.values.get('options');\n        if (opts.length === 0) {\n            return value;\n        }\n        const matched = opts.filter((item) => {\n            return item.value === value;\n        }).length > 0;\n        return matched ? value : opts[0].value;\n    }\n}\n\nfunction parseListOptions(value) {\n    var _a;\n    const p = MicroParsers;\n    if (Array.isArray(value)) {\n        return (_a = parseRecord({ items: value }, (p) => ({\n            items: p.required.array(p.required.object({\n                text: p.required.string,\n                value: p.required.raw,\n            })),\n        }))) === null || _a === void 0 ? void 0 : _a.items;\n    }\n    if (typeof value === 'object') {\n        return p.required.raw(value)\n            .value;\n    }\n    return undefined;\n}\nfunction normalizeListOptions(options) {\n    if (Array.isArray(options)) {\n        return options;\n    }\n    const items = [];\n    Object.keys(options).forEach((text) => {\n        items.push({ text: text, value: options[text] });\n    });\n    return items;\n}\nfunction createListConstraint(options) {\n    return !isEmpty(options)\n        ? new ListConstraint(normalizeListOptions(forceCast(options)))\n        : null;\n}\n\nconst cn$k = ClassName('lst');\nclass ListView {\n    constructor(doc, config) {\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.props_ = config.props;\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$k());\n        config.viewProps.bindClassModifiers(this.element);\n        const selectElem = doc.createElement('select');\n        selectElem.classList.add(cn$k('s'));\n        config.viewProps.bindDisabled(selectElem);\n        this.element.appendChild(selectElem);\n        this.selectElement = selectElem;\n        const markElem = doc.createElement('div');\n        markElem.classList.add(cn$k('m'));\n        markElem.appendChild(createSvgIconElement(doc, 'dropdown'));\n        this.element.appendChild(markElem);\n        config.value.emitter.on('change', this.onValueChange_);\n        this.value_ = config.value;\n        bindValueMap(this.props_, 'options', (opts) => {\n            removeChildElements(this.selectElement);\n            opts.forEach((item) => {\n                const optionElem = doc.createElement('option');\n                optionElem.textContent = item.text;\n                this.selectElement.appendChild(optionElem);\n            });\n            this.update_();\n        });\n    }\n    update_() {\n        const values = this.props_.get('options').map((o) => o.value);\n        this.selectElement.selectedIndex = values.indexOf(this.value_.rawValue);\n    }\n    onValueChange_() {\n        this.update_();\n    }\n}\n\nclass ListController {\n    constructor(doc, config) {\n        this.onSelectChange_ = this.onSelectChange_.bind(this);\n        this.props = config.props;\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new ListView(doc, {\n            props: this.props,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view.selectElement.addEventListener('change', this.onSelectChange_);\n    }\n    onSelectChange_(e) {\n        const selectElem = forceCast(e.currentTarget);\n        this.value.rawValue =\n            this.props.get('options')[selectElem.selectedIndex].value;\n    }\n    importProps(state) {\n        return importBladeState(state, null, (p) => ({\n            options: p.required.custom(parseListOptions),\n        }), (result) => {\n            this.props.set('options', normalizeListOptions(result.options));\n            return true;\n        });\n    }\n    exportProps() {\n        return exportBladeState(null, {\n            options: this.props.get('options'),\n        });\n    }\n}\n\nconst cn$j = ClassName('pop');\nclass PopupView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$j());\n        config.viewProps.bindClassModifiers(this.element);\n        bindValue(config.shows, valueToClassName(this.element, cn$j(undefined, 'v')));\n    }\n}\n\nclass PopupController {\n    constructor(doc, config) {\n        this.shows = createValue(false);\n        this.viewProps = config.viewProps;\n        this.view = new PopupView(doc, {\n            shows: this.shows,\n            viewProps: this.viewProps,\n        });\n    }\n}\n\nconst cn$i = ClassName('txt');\nclass TextView {\n    constructor(doc, config) {\n        this.onChange_ = this.onChange_.bind(this);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$i());\n        config.viewProps.bindClassModifiers(this.element);\n        this.props_ = config.props;\n        this.props_.emitter.on('change', this.onChange_);\n        const inputElem = doc.createElement('input');\n        inputElem.classList.add(cn$i('i'));\n        inputElem.type = 'text';\n        config.viewProps.bindDisabled(inputElem);\n        this.element.appendChild(inputElem);\n        this.inputElement = inputElem;\n        config.value.emitter.on('change', this.onChange_);\n        this.value_ = config.value;\n        this.refresh();\n    }\n    refresh() {\n        const formatter = this.props_.get('formatter');\n        this.inputElement.value = formatter(this.value_.rawValue);\n    }\n    onChange_() {\n        this.refresh();\n    }\n}\n\nclass TextController {\n    constructor(doc, config) {\n        this.onInputChange_ = this.onInputChange_.bind(this);\n        this.parser_ = config.parser;\n        this.props = config.props;\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new TextView(doc, {\n            props: config.props,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view.inputElement.addEventListener('change', this.onInputChange_);\n    }\n    onInputChange_(e) {\n        const inputElem = forceCast(e.currentTarget);\n        const value = inputElem.value;\n        const parsedValue = this.parser_(value);\n        if (!isEmpty(parsedValue)) {\n            this.value.rawValue = parsedValue;\n        }\n        this.view.refresh();\n    }\n}\n\nfunction boolToString(value) {\n    return String(value);\n}\nfunction boolFromUnknown(value) {\n    if (value === 'false') {\n        return false;\n    }\n    return !!value;\n}\nfunction BooleanFormatter(value) {\n    return boolToString(value);\n}\n\nfunction composeParsers(parsers) {\n    return (text) => {\n        return parsers.reduce((result, parser) => {\n            if (result !== null) {\n                return result;\n            }\n            return parser(text);\n        }, null);\n    };\n}\n\nconst innerFormatter = createNumberFormatter(0);\nfunction formatPercentage(value) {\n    return innerFormatter(value) + '%';\n}\n\nfunction stringFromUnknown(value) {\n    return String(value);\n}\nfunction formatString(value) {\n    return value;\n}\n\nfunction connectValues({ primary, secondary, forward, backward, }) {\n    let changing = false;\n    function preventFeedback(callback) {\n        if (changing) {\n            return;\n        }\n        changing = true;\n        callback();\n        changing = false;\n    }\n    primary.emitter.on('change', (ev) => {\n        preventFeedback(() => {\n            secondary.setRawValue(forward(primary.rawValue, secondary.rawValue), ev.options);\n        });\n    });\n    secondary.emitter.on('change', (ev) => {\n        preventFeedback(() => {\n            primary.setRawValue(backward(primary.rawValue, secondary.rawValue), ev.options);\n        });\n        preventFeedback(() => {\n            secondary.setRawValue(forward(primary.rawValue, secondary.rawValue), ev.options);\n        });\n    });\n    preventFeedback(() => {\n        secondary.setRawValue(forward(primary.rawValue, secondary.rawValue), {\n            forceEmit: false,\n            last: true,\n        });\n    });\n}\n\nfunction getStepForKey(keyScale, keys) {\n    const step = keyScale * (keys.altKey ? 0.1 : 1) * (keys.shiftKey ? 10 : 1);\n    if (keys.upKey) {\n        return +step;\n    }\n    else if (keys.downKey) {\n        return -step;\n    }\n    return 0;\n}\nfunction getVerticalStepKeys(ev) {\n    return {\n        altKey: ev.altKey,\n        downKey: ev.key === 'ArrowDown',\n        shiftKey: ev.shiftKey,\n        upKey: ev.key === 'ArrowUp',\n    };\n}\nfunction getHorizontalStepKeys(ev) {\n    return {\n        altKey: ev.altKey,\n        downKey: ev.key === 'ArrowLeft',\n        shiftKey: ev.shiftKey,\n        upKey: ev.key === 'ArrowRight',\n    };\n}\nfunction isVerticalArrowKey(key) {\n    return key === 'ArrowUp' || key === 'ArrowDown';\n}\nfunction isArrowKey(key) {\n    return isVerticalArrowKey(key) || key === 'ArrowLeft' || key === 'ArrowRight';\n}\n\nfunction computeOffset$1(ev, elem) {\n    var _a, _b;\n    const win = elem.ownerDocument.defaultView;\n    const rect = elem.getBoundingClientRect();\n    return {\n        x: ev.pageX - (((_a = (win && win.scrollX)) !== null && _a !== void 0 ? _a : 0) + rect.left),\n        y: ev.pageY - (((_b = (win && win.scrollY)) !== null && _b !== void 0 ? _b : 0) + rect.top),\n    };\n}\nclass PointerHandler {\n    constructor(element) {\n        this.lastTouch_ = null;\n        this.onDocumentMouseMove_ = this.onDocumentMouseMove_.bind(this);\n        this.onDocumentMouseUp_ = this.onDocumentMouseUp_.bind(this);\n        this.onMouseDown_ = this.onMouseDown_.bind(this);\n        this.onTouchEnd_ = this.onTouchEnd_.bind(this);\n        this.onTouchMove_ = this.onTouchMove_.bind(this);\n        this.onTouchStart_ = this.onTouchStart_.bind(this);\n        this.elem_ = element;\n        this.emitter = new Emitter();\n        element.addEventListener('touchstart', this.onTouchStart_, {\n            passive: false,\n        });\n        element.addEventListener('touchmove', this.onTouchMove_, {\n            passive: true,\n        });\n        element.addEventListener('touchend', this.onTouchEnd_);\n        element.addEventListener('mousedown', this.onMouseDown_);\n    }\n    computePosition_(offset) {\n        const rect = this.elem_.getBoundingClientRect();\n        return {\n            bounds: {\n                width: rect.width,\n                height: rect.height,\n            },\n            point: offset\n                ? {\n                    x: offset.x,\n                    y: offset.y,\n                }\n                : null,\n        };\n    }\n    onMouseDown_(ev) {\n        var _a;\n        ev.preventDefault();\n        (_a = ev.currentTarget) === null || _a === void 0 ? void 0 : _a.focus();\n        const doc = this.elem_.ownerDocument;\n        doc.addEventListener('mousemove', this.onDocumentMouseMove_);\n        doc.addEventListener('mouseup', this.onDocumentMouseUp_);\n        this.emitter.emit('down', {\n            altKey: ev.altKey,\n            data: this.computePosition_(computeOffset$1(ev, this.elem_)),\n            sender: this,\n            shiftKey: ev.shiftKey,\n        });\n    }\n    onDocumentMouseMove_(ev) {\n        this.emitter.emit('move', {\n            altKey: ev.altKey,\n            data: this.computePosition_(computeOffset$1(ev, this.elem_)),\n            sender: this,\n            shiftKey: ev.shiftKey,\n        });\n    }\n    onDocumentMouseUp_(ev) {\n        const doc = this.elem_.ownerDocument;\n        doc.removeEventListener('mousemove', this.onDocumentMouseMove_);\n        doc.removeEventListener('mouseup', this.onDocumentMouseUp_);\n        this.emitter.emit('up', {\n            altKey: ev.altKey,\n            data: this.computePosition_(computeOffset$1(ev, this.elem_)),\n            sender: this,\n            shiftKey: ev.shiftKey,\n        });\n    }\n    onTouchStart_(ev) {\n        ev.preventDefault();\n        const touch = ev.targetTouches.item(0);\n        const rect = this.elem_.getBoundingClientRect();\n        this.emitter.emit('down', {\n            altKey: ev.altKey,\n            data: this.computePosition_(touch\n                ? {\n                    x: touch.clientX - rect.left,\n                    y: touch.clientY - rect.top,\n                }\n                : undefined),\n            sender: this,\n            shiftKey: ev.shiftKey,\n        });\n        this.lastTouch_ = touch;\n    }\n    onTouchMove_(ev) {\n        const touch = ev.targetTouches.item(0);\n        const rect = this.elem_.getBoundingClientRect();\n        this.emitter.emit('move', {\n            altKey: ev.altKey,\n            data: this.computePosition_(touch\n                ? {\n                    x: touch.clientX - rect.left,\n                    y: touch.clientY - rect.top,\n                }\n                : undefined),\n            sender: this,\n            shiftKey: ev.shiftKey,\n        });\n        this.lastTouch_ = touch;\n    }\n    onTouchEnd_(ev) {\n        var _a;\n        const touch = (_a = ev.targetTouches.item(0)) !== null && _a !== void 0 ? _a : this.lastTouch_;\n        const rect = this.elem_.getBoundingClientRect();\n        this.emitter.emit('up', {\n            altKey: ev.altKey,\n            data: this.computePosition_(touch\n                ? {\n                    x: touch.clientX - rect.left,\n                    y: touch.clientY - rect.top,\n                }\n                : undefined),\n            sender: this,\n            shiftKey: ev.shiftKey,\n        });\n    }\n}\n\nconst cn$h = ClassName('txt');\nclass NumberTextView {\n    constructor(doc, config) {\n        this.onChange_ = this.onChange_.bind(this);\n        this.props_ = config.props;\n        this.props_.emitter.on('change', this.onChange_);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$h(), cn$h(undefined, 'num'));\n        if (config.arrayPosition) {\n            this.element.classList.add(cn$h(undefined, config.arrayPosition));\n        }\n        config.viewProps.bindClassModifiers(this.element);\n        const inputElem = doc.createElement('input');\n        inputElem.classList.add(cn$h('i'));\n        inputElem.type = 'text';\n        config.viewProps.bindDisabled(inputElem);\n        this.element.appendChild(inputElem);\n        this.inputElement = inputElem;\n        this.onDraggingChange_ = this.onDraggingChange_.bind(this);\n        this.dragging_ = config.dragging;\n        this.dragging_.emitter.on('change', this.onDraggingChange_);\n        this.element.classList.add(cn$h());\n        this.inputElement.classList.add(cn$h('i'));\n        const knobElem = doc.createElement('div');\n        knobElem.classList.add(cn$h('k'));\n        this.element.appendChild(knobElem);\n        this.knobElement = knobElem;\n        const guideElem = doc.createElementNS(SVG_NS, 'svg');\n        guideElem.classList.add(cn$h('g'));\n        this.knobElement.appendChild(guideElem);\n        const bodyElem = doc.createElementNS(SVG_NS, 'path');\n        bodyElem.classList.add(cn$h('gb'));\n        guideElem.appendChild(bodyElem);\n        this.guideBodyElem_ = bodyElem;\n        const headElem = doc.createElementNS(SVG_NS, 'path');\n        headElem.classList.add(cn$h('gh'));\n        guideElem.appendChild(headElem);\n        this.guideHeadElem_ = headElem;\n        const tooltipElem = doc.createElement('div');\n        tooltipElem.classList.add(ClassName('tt')());\n        this.knobElement.appendChild(tooltipElem);\n        this.tooltipElem_ = tooltipElem;\n        config.value.emitter.on('change', this.onChange_);\n        this.value = config.value;\n        this.refresh();\n    }\n    onDraggingChange_(ev) {\n        if (ev.rawValue === null) {\n            this.element.classList.remove(cn$h(undefined, 'drg'));\n            return;\n        }\n        this.element.classList.add(cn$h(undefined, 'drg'));\n        const x = ev.rawValue / this.props_.get('pointerScale');\n        const aox = x + (x > 0 ? -1 : x < 0 ? +1 : 0);\n        const adx = constrainRange(-aox, -4, +4);\n        this.guideHeadElem_.setAttributeNS(null, 'd', [`M ${aox + adx},0 L${aox},4 L${aox + adx},8`, `M ${x},-1 L${x},9`].join(' '));\n        this.guideBodyElem_.setAttributeNS(null, 'd', `M 0,4 L${x},4`);\n        const formatter = this.props_.get('formatter');\n        this.tooltipElem_.textContent = formatter(this.value.rawValue);\n        this.tooltipElem_.style.left = `${x}px`;\n    }\n    refresh() {\n        const formatter = this.props_.get('formatter');\n        this.inputElement.value = formatter(this.value.rawValue);\n    }\n    onChange_() {\n        this.refresh();\n    }\n}\n\nclass NumberTextController {\n    constructor(doc, config) {\n        var _a;\n        this.originRawValue_ = 0;\n        this.onInputChange_ = this.onInputChange_.bind(this);\n        this.onInputKeyDown_ = this.onInputKeyDown_.bind(this);\n        this.onInputKeyUp_ = this.onInputKeyUp_.bind(this);\n        this.onPointerDown_ = this.onPointerDown_.bind(this);\n        this.onPointerMove_ = this.onPointerMove_.bind(this);\n        this.onPointerUp_ = this.onPointerUp_.bind(this);\n        this.parser_ = config.parser;\n        this.props = config.props;\n        this.sliderProps_ = (_a = config.sliderProps) !== null && _a !== void 0 ? _a : null;\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.dragging_ = createValue(null);\n        this.view = new NumberTextView(doc, {\n            arrayPosition: config.arrayPosition,\n            dragging: this.dragging_,\n            props: this.props,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view.inputElement.addEventListener('change', this.onInputChange_);\n        this.view.inputElement.addEventListener('keydown', this.onInputKeyDown_);\n        this.view.inputElement.addEventListener('keyup', this.onInputKeyUp_);\n        const ph = new PointerHandler(this.view.knobElement);\n        ph.emitter.on('down', this.onPointerDown_);\n        ph.emitter.on('move', this.onPointerMove_);\n        ph.emitter.on('up', this.onPointerUp_);\n    }\n    constrainValue_(value) {\n        var _a, _b;\n        const min = (_a = this.sliderProps_) === null || _a === void 0 ? void 0 : _a.get('min');\n        const max = (_b = this.sliderProps_) === null || _b === void 0 ? void 0 : _b.get('max');\n        let v = value;\n        if (min !== undefined) {\n            v = Math.max(v, min);\n        }\n        if (max !== undefined) {\n            v = Math.min(v, max);\n        }\n        return v;\n    }\n    onInputChange_(e) {\n        const inputElem = forceCast(e.currentTarget);\n        const value = inputElem.value;\n        const parsedValue = this.parser_(value);\n        if (!isEmpty(parsedValue)) {\n            this.value.rawValue = this.constrainValue_(parsedValue);\n        }\n        this.view.refresh();\n    }\n    onInputKeyDown_(ev) {\n        const step = getStepForKey(this.props.get('keyScale'), getVerticalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        this.value.setRawValue(this.constrainValue_(this.value.rawValue + step), {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onInputKeyUp_(ev) {\n        const step = getStepForKey(this.props.get('keyScale'), getVerticalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        this.value.setRawValue(this.value.rawValue, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n    onPointerDown_() {\n        this.originRawValue_ = this.value.rawValue;\n        this.dragging_.rawValue = 0;\n    }\n    computeDraggingValue_(data) {\n        if (!data.point) {\n            return null;\n        }\n        const dx = data.point.x - data.bounds.width / 2;\n        return this.constrainValue_(this.originRawValue_ + dx * this.props.get('pointerScale'));\n    }\n    onPointerMove_(ev) {\n        const v = this.computeDraggingValue_(ev.data);\n        if (v === null) {\n            return;\n        }\n        this.value.setRawValue(v, {\n            forceEmit: false,\n            last: false,\n        });\n        this.dragging_.rawValue = this.value.rawValue - this.originRawValue_;\n    }\n    onPointerUp_(ev) {\n        const v = this.computeDraggingValue_(ev.data);\n        if (v === null) {\n            return;\n        }\n        this.value.setRawValue(v, {\n            forceEmit: true,\n            last: true,\n        });\n        this.dragging_.rawValue = null;\n    }\n}\n\nconst cn$g = ClassName('sld');\nclass SliderView {\n    constructor(doc, config) {\n        this.onChange_ = this.onChange_.bind(this);\n        this.props_ = config.props;\n        this.props_.emitter.on('change', this.onChange_);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$g());\n        config.viewProps.bindClassModifiers(this.element);\n        const trackElem = doc.createElement('div');\n        trackElem.classList.add(cn$g('t'));\n        config.viewProps.bindTabIndex(trackElem);\n        this.element.appendChild(trackElem);\n        this.trackElement = trackElem;\n        const knobElem = doc.createElement('div');\n        knobElem.classList.add(cn$g('k'));\n        this.trackElement.appendChild(knobElem);\n        this.knobElement = knobElem;\n        config.value.emitter.on('change', this.onChange_);\n        this.value = config.value;\n        this.update_();\n    }\n    update_() {\n        const p = constrainRange(mapRange(this.value.rawValue, this.props_.get('min'), this.props_.get('max'), 0, 100), 0, 100);\n        this.knobElement.style.width = `${p}%`;\n    }\n    onChange_() {\n        this.update_();\n    }\n}\n\nclass SliderController {\n    constructor(doc, config) {\n        this.onKeyDown_ = this.onKeyDown_.bind(this);\n        this.onKeyUp_ = this.onKeyUp_.bind(this);\n        this.onPointerDownOrMove_ = this.onPointerDownOrMove_.bind(this);\n        this.onPointerUp_ = this.onPointerUp_.bind(this);\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.props = config.props;\n        this.view = new SliderView(doc, {\n            props: this.props,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.ptHandler_ = new PointerHandler(this.view.trackElement);\n        this.ptHandler_.emitter.on('down', this.onPointerDownOrMove_);\n        this.ptHandler_.emitter.on('move', this.onPointerDownOrMove_);\n        this.ptHandler_.emitter.on('up', this.onPointerUp_);\n        this.view.trackElement.addEventListener('keydown', this.onKeyDown_);\n        this.view.trackElement.addEventListener('keyup', this.onKeyUp_);\n    }\n    handlePointerEvent_(d, opts) {\n        if (!d.point) {\n            return;\n        }\n        this.value.setRawValue(mapRange(constrainRange(d.point.x, 0, d.bounds.width), 0, d.bounds.width, this.props.get('min'), this.props.get('max')), opts);\n    }\n    onPointerDownOrMove_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerUp_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n    onKeyDown_(ev) {\n        const step = getStepForKey(this.props.get('keyScale'), getHorizontalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        this.value.setRawValue(this.value.rawValue + step, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onKeyUp_(ev) {\n        const step = getStepForKey(this.props.get('keyScale'), getHorizontalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        this.value.setRawValue(this.value.rawValue, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n}\n\nconst cn$f = ClassName('sldtxt');\nclass SliderTextView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$f());\n        const sliderElem = doc.createElement('div');\n        sliderElem.classList.add(cn$f('s'));\n        this.sliderView_ = config.sliderView;\n        sliderElem.appendChild(this.sliderView_.element);\n        this.element.appendChild(sliderElem);\n        const textElem = doc.createElement('div');\n        textElem.classList.add(cn$f('t'));\n        this.textView_ = config.textView;\n        textElem.appendChild(this.textView_.element);\n        this.element.appendChild(textElem);\n    }\n}\n\nclass SliderTextController {\n    constructor(doc, config) {\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.sliderC_ = new SliderController(doc, {\n            props: config.sliderProps,\n            value: config.value,\n            viewProps: this.viewProps,\n        });\n        this.textC_ = new NumberTextController(doc, {\n            parser: config.parser,\n            props: config.textProps,\n            sliderProps: config.sliderProps,\n            value: config.value,\n            viewProps: config.viewProps,\n        });\n        this.view = new SliderTextView(doc, {\n            sliderView: this.sliderC_.view,\n            textView: this.textC_.view,\n        });\n    }\n    get sliderController() {\n        return this.sliderC_;\n    }\n    get textController() {\n        return this.textC_;\n    }\n    importProps(state) {\n        return importBladeState(state, null, (p) => ({\n            max: p.required.number,\n            min: p.required.number,\n        }), (result) => {\n            const sliderProps = this.sliderC_.props;\n            sliderProps.set('max', result.max);\n            sliderProps.set('min', result.min);\n            return true;\n        });\n    }\n    exportProps() {\n        const sliderProps = this.sliderC_.props;\n        return exportBladeState(null, {\n            max: sliderProps.get('max'),\n            min: sliderProps.get('min'),\n        });\n    }\n}\nfunction createSliderTextProps(config) {\n    return {\n        sliderProps: new ValueMap({\n            keyScale: config.keyScale,\n            max: config.max,\n            min: config.min,\n        }),\n        textProps: new ValueMap({\n            formatter: createValue(config.formatter),\n            keyScale: config.keyScale,\n            pointerScale: createValue(config.pointerScale),\n        }),\n    };\n}\n\nconst CSS_VAR_MAP = {\n    containerUnitSize: 'cnt-usz',\n};\nfunction getCssVar(key) {\n    return `--${CSS_VAR_MAP[key]}`;\n}\n\nfunction createPointDimensionParser(p) {\n    return createNumberTextInputParamsParser(p);\n}\nfunction parsePointDimensionParams(value) {\n    if (!isRecord(value)) {\n        return undefined;\n    }\n    return parseRecord(value, createPointDimensionParser);\n}\nfunction createDimensionConstraint(params, initialValue) {\n    if (!params) {\n        return undefined;\n    }\n    const constraints = [];\n    const cs = createStepConstraint(params, initialValue);\n    if (cs) {\n        constraints.push(cs);\n    }\n    const rs = createRangeConstraint(params);\n    if (rs) {\n        constraints.push(rs);\n    }\n    return new CompositeConstraint(constraints);\n}\n\nfunction isCompatible(ver) {\n    if (!ver) {\n        return false;\n    }\n    return ver.major === VERSION$1.major;\n}\n\nfunction parsePickerLayout(value) {\n    if (value === 'inline' || value === 'popup') {\n        return value;\n    }\n    return undefined;\n}\n\nfunction writePrimitive(target, value) {\n    target.write(value);\n}\n\nconst cn$e = ClassName('ckb');\nclass CheckboxView {\n    constructor(doc, config) {\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$e());\n        config.viewProps.bindClassModifiers(this.element);\n        const labelElem = doc.createElement('label');\n        labelElem.classList.add(cn$e('l'));\n        this.element.appendChild(labelElem);\n        this.labelElement = labelElem;\n        const inputElem = doc.createElement('input');\n        inputElem.classList.add(cn$e('i'));\n        inputElem.type = 'checkbox';\n        this.labelElement.appendChild(inputElem);\n        this.inputElement = inputElem;\n        config.viewProps.bindDisabled(this.inputElement);\n        const wrapperElem = doc.createElement('div');\n        wrapperElem.classList.add(cn$e('w'));\n        this.labelElement.appendChild(wrapperElem);\n        const markElem = createSvgIconElement(doc, 'check');\n        wrapperElem.appendChild(markElem);\n        config.value.emitter.on('change', this.onValueChange_);\n        this.value = config.value;\n        this.update_();\n    }\n    update_() {\n        this.inputElement.checked = this.value.rawValue;\n    }\n    onValueChange_() {\n        this.update_();\n    }\n}\n\nclass CheckboxController {\n    constructor(doc, config) {\n        this.onInputChange_ = this.onInputChange_.bind(this);\n        this.onLabelMouseDown_ = this.onLabelMouseDown_.bind(this);\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new CheckboxView(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view.inputElement.addEventListener('change', this.onInputChange_);\n        this.view.labelElement.addEventListener('mousedown', this.onLabelMouseDown_);\n    }\n    onInputChange_(ev) {\n        const inputElem = forceCast(ev.currentTarget);\n        this.value.rawValue = inputElem.checked;\n        ev.preventDefault();\n        ev.stopPropagation();\n    }\n    onLabelMouseDown_(ev) {\n        ev.preventDefault();\n    }\n}\n\nfunction createConstraint$6(params) {\n    const constraints = [];\n    const lc = createListConstraint(params.options);\n    if (lc) {\n        constraints.push(lc);\n    }\n    return new CompositeConstraint(constraints);\n}\nconst BooleanInputPlugin = createPlugin({\n    id: 'input-bool',\n    type: 'input',\n    accept: (value, params) => {\n        if (typeof value !== 'boolean') {\n            return null;\n        }\n        const result = parseRecord(params, (p) => ({\n            options: p.optional.custom(parseListOptions),\n            readonly: p.optional.constant(false),\n        }));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: (_args) => boolFromUnknown,\n        constraint: (args) => createConstraint$6(args.params),\n        writer: (_args) => writePrimitive,\n    },\n    controller: (args) => {\n        const doc = args.document;\n        const value = args.value;\n        const c = args.constraint;\n        const lc = c && findConstraint(c, ListConstraint);\n        if (lc) {\n            return new ListController(doc, {\n                props: new ValueMap({\n                    options: lc.values.value('options'),\n                }),\n                value: value,\n                viewProps: args.viewProps,\n            });\n        }\n        return new CheckboxController(doc, {\n            value: value,\n            viewProps: args.viewProps,\n        });\n    },\n    api(args) {\n        if (typeof args.controller.value.rawValue !== 'boolean') {\n            return null;\n        }\n        if (args.controller.valueController instanceof ListController) {\n            return new ListInputBindingApi(args.controller);\n        }\n        return null;\n    },\n});\n\nconst cn$d = ClassName('col');\nclass ColorView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$d());\n        config.foldable.bindExpandedClass(this.element, cn$d(undefined, 'expanded'));\n        bindValueMap(config.foldable, 'completed', valueToClassName(this.element, cn$d(undefined, 'cpl')));\n        const headElem = doc.createElement('div');\n        headElem.classList.add(cn$d('h'));\n        this.element.appendChild(headElem);\n        const swatchElem = doc.createElement('div');\n        swatchElem.classList.add(cn$d('s'));\n        headElem.appendChild(swatchElem);\n        this.swatchElement = swatchElem;\n        const textElem = doc.createElement('div');\n        textElem.classList.add(cn$d('t'));\n        headElem.appendChild(textElem);\n        this.textElement = textElem;\n        if (config.pickerLayout === 'inline') {\n            const pickerElem = doc.createElement('div');\n            pickerElem.classList.add(cn$d('p'));\n            this.element.appendChild(pickerElem);\n            this.pickerElement = pickerElem;\n        }\n        else {\n            this.pickerElement = null;\n        }\n    }\n}\n\nfunction rgbToHslInt(r, g, b) {\n    const rp = constrainRange(r / 255, 0, 1);\n    const gp = constrainRange(g / 255, 0, 1);\n    const bp = constrainRange(b / 255, 0, 1);\n    const cmax = Math.max(rp, gp, bp);\n    const cmin = Math.min(rp, gp, bp);\n    const c = cmax - cmin;\n    let h = 0;\n    let s = 0;\n    const l = (cmin + cmax) / 2;\n    if (c !== 0) {\n        s = c / (1 - Math.abs(cmax + cmin - 1));\n        if (rp === cmax) {\n            h = (gp - bp) / c;\n        }\n        else if (gp === cmax) {\n            h = 2 + (bp - rp) / c;\n        }\n        else {\n            h = 4 + (rp - gp) / c;\n        }\n        h = h / 6 + (h < 0 ? 1 : 0);\n    }\n    return [h * 360, s * 100, l * 100];\n}\nfunction hslToRgbInt(h, s, l) {\n    const hp = ((h % 360) + 360) % 360;\n    const sp = constrainRange(s / 100, 0, 1);\n    const lp = constrainRange(l / 100, 0, 1);\n    const c = (1 - Math.abs(2 * lp - 1)) * sp;\n    const x = c * (1 - Math.abs(((hp / 60) % 2) - 1));\n    const m = lp - c / 2;\n    let rp, gp, bp;\n    if (hp >= 0 && hp < 60) {\n        [rp, gp, bp] = [c, x, 0];\n    }\n    else if (hp >= 60 && hp < 120) {\n        [rp, gp, bp] = [x, c, 0];\n    }\n    else if (hp >= 120 && hp < 180) {\n        [rp, gp, bp] = [0, c, x];\n    }\n    else if (hp >= 180 && hp < 240) {\n        [rp, gp, bp] = [0, x, c];\n    }\n    else if (hp >= 240 && hp < 300) {\n        [rp, gp, bp] = [x, 0, c];\n    }\n    else {\n        [rp, gp, bp] = [c, 0, x];\n    }\n    return [(rp + m) * 255, (gp + m) * 255, (bp + m) * 255];\n}\nfunction rgbToHsvInt(r, g, b) {\n    const rp = constrainRange(r / 255, 0, 1);\n    const gp = constrainRange(g / 255, 0, 1);\n    const bp = constrainRange(b / 255, 0, 1);\n    const cmax = Math.max(rp, gp, bp);\n    const cmin = Math.min(rp, gp, bp);\n    const d = cmax - cmin;\n    let h;\n    if (d === 0) {\n        h = 0;\n    }\n    else if (cmax === rp) {\n        h = 60 * (((((gp - bp) / d) % 6) + 6) % 6);\n    }\n    else if (cmax === gp) {\n        h = 60 * ((bp - rp) / d + 2);\n    }\n    else {\n        h = 60 * ((rp - gp) / d + 4);\n    }\n    const s = cmax === 0 ? 0 : d / cmax;\n    const v = cmax;\n    return [h, s * 100, v * 100];\n}\nfunction hsvToRgbInt(h, s, v) {\n    const hp = loopRange(h, 360);\n    const sp = constrainRange(s / 100, 0, 1);\n    const vp = constrainRange(v / 100, 0, 1);\n    const c = vp * sp;\n    const x = c * (1 - Math.abs(((hp / 60) % 2) - 1));\n    const m = vp - c;\n    let rp, gp, bp;\n    if (hp >= 0 && hp < 60) {\n        [rp, gp, bp] = [c, x, 0];\n    }\n    else if (hp >= 60 && hp < 120) {\n        [rp, gp, bp] = [x, c, 0];\n    }\n    else if (hp >= 120 && hp < 180) {\n        [rp, gp, bp] = [0, c, x];\n    }\n    else if (hp >= 180 && hp < 240) {\n        [rp, gp, bp] = [0, x, c];\n    }\n    else if (hp >= 240 && hp < 300) {\n        [rp, gp, bp] = [x, 0, c];\n    }\n    else {\n        [rp, gp, bp] = [c, 0, x];\n    }\n    return [(rp + m) * 255, (gp + m) * 255, (bp + m) * 255];\n}\nfunction hslToHsvInt(h, s, l) {\n    const sd = l + (s * (100 - Math.abs(2 * l - 100))) / (2 * 100);\n    return [\n        h,\n        sd !== 0 ? (s * (100 - Math.abs(2 * l - 100))) / sd : 0,\n        l + (s * (100 - Math.abs(2 * l - 100))) / (2 * 100),\n    ];\n}\nfunction hsvToHslInt(h, s, v) {\n    const sd = 100 - Math.abs((v * (200 - s)) / 100 - 100);\n    return [h, sd !== 0 ? (s * v) / sd : 0, (v * (200 - s)) / (2 * 100)];\n}\nfunction removeAlphaComponent(comps) {\n    return [comps[0], comps[1], comps[2]];\n}\nfunction appendAlphaComponent(comps, alpha) {\n    return [comps[0], comps[1], comps[2], alpha];\n}\nconst MODE_CONVERTER_MAP = {\n    hsl: {\n        hsl: (h, s, l) => [h, s, l],\n        hsv: hslToHsvInt,\n        rgb: hslToRgbInt,\n    },\n    hsv: {\n        hsl: hsvToHslInt,\n        hsv: (h, s, v) => [h, s, v],\n        rgb: hsvToRgbInt,\n    },\n    rgb: {\n        hsl: rgbToHslInt,\n        hsv: rgbToHsvInt,\n        rgb: (r, g, b) => [r, g, b],\n    },\n};\nfunction getColorMaxComponents(mode, type) {\n    return [\n        type === 'float' ? 1 : mode === 'rgb' ? 255 : 360,\n        type === 'float' ? 1 : mode === 'rgb' ? 255 : 100,\n        type === 'float' ? 1 : mode === 'rgb' ? 255 : 100,\n    ];\n}\nfunction loopHueRange(hue, max) {\n    return hue === max ? max : loopRange(hue, max);\n}\nfunction constrainColorComponents(components, mode, type) {\n    var _a;\n    const ms = getColorMaxComponents(mode, type);\n    return [\n        mode === 'rgb'\n            ? constrainRange(components[0], 0, ms[0])\n            : loopHueRange(components[0], ms[0]),\n        constrainRange(components[1], 0, ms[1]),\n        constrainRange(components[2], 0, ms[2]),\n        constrainRange((_a = components[3]) !== null && _a !== void 0 ? _a : 1, 0, 1),\n    ];\n}\nfunction convertColorType(comps, mode, from, to) {\n    const fms = getColorMaxComponents(mode, from);\n    const tms = getColorMaxComponents(mode, to);\n    return comps.map((c, index) => (c / fms[index]) * tms[index]);\n}\nfunction convertColor(components, from, to) {\n    const intComps = convertColorType(components, from.mode, from.type, 'int');\n    const result = MODE_CONVERTER_MAP[from.mode][to.mode](...intComps);\n    return convertColorType(result, to.mode, 'int', to.type);\n}\n\nclass IntColor {\n    static black() {\n        return new IntColor([0, 0, 0], 'rgb');\n    }\n    constructor(comps, mode) {\n        this.type = 'int';\n        this.mode = mode;\n        this.comps_ = constrainColorComponents(comps, mode, this.type);\n    }\n    getComponents(opt_mode) {\n        return appendAlphaComponent(convertColor(removeAlphaComponent(this.comps_), { mode: this.mode, type: this.type }, { mode: opt_mode !== null && opt_mode !== void 0 ? opt_mode : this.mode, type: this.type }), this.comps_[3]);\n    }\n    toRgbaObject() {\n        const rgbComps = this.getComponents('rgb');\n        return {\n            r: rgbComps[0],\n            g: rgbComps[1],\n            b: rgbComps[2],\n            a: rgbComps[3],\n        };\n    }\n}\n\nconst cn$c = ClassName('colp');\nclass ColorPickerView {\n    constructor(doc, config) {\n        this.alphaViews_ = null;\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$c());\n        config.viewProps.bindClassModifiers(this.element);\n        const hsvElem = doc.createElement('div');\n        hsvElem.classList.add(cn$c('hsv'));\n        const svElem = doc.createElement('div');\n        svElem.classList.add(cn$c('sv'));\n        this.svPaletteView_ = config.svPaletteView;\n        svElem.appendChild(this.svPaletteView_.element);\n        hsvElem.appendChild(svElem);\n        const hElem = doc.createElement('div');\n        hElem.classList.add(cn$c('h'));\n        this.hPaletteView_ = config.hPaletteView;\n        hElem.appendChild(this.hPaletteView_.element);\n        hsvElem.appendChild(hElem);\n        this.element.appendChild(hsvElem);\n        const rgbElem = doc.createElement('div');\n        rgbElem.classList.add(cn$c('rgb'));\n        this.textsView_ = config.textsView;\n        rgbElem.appendChild(this.textsView_.element);\n        this.element.appendChild(rgbElem);\n        if (config.alphaViews) {\n            this.alphaViews_ = {\n                palette: config.alphaViews.palette,\n                text: config.alphaViews.text,\n            };\n            const aElem = doc.createElement('div');\n            aElem.classList.add(cn$c('a'));\n            const apElem = doc.createElement('div');\n            apElem.classList.add(cn$c('ap'));\n            apElem.appendChild(this.alphaViews_.palette.element);\n            aElem.appendChild(apElem);\n            const atElem = doc.createElement('div');\n            atElem.classList.add(cn$c('at'));\n            atElem.appendChild(this.alphaViews_.text.element);\n            aElem.appendChild(atElem);\n            this.element.appendChild(aElem);\n        }\n    }\n    get allFocusableElements() {\n        const elems = [\n            this.svPaletteView_.element,\n            this.hPaletteView_.element,\n            this.textsView_.modeSelectElement,\n            ...this.textsView_.inputViews.map((v) => v.inputElement),\n        ];\n        if (this.alphaViews_) {\n            elems.push(this.alphaViews_.palette.element, this.alphaViews_.text.inputElement);\n        }\n        return elems;\n    }\n}\n\nfunction parseColorType(value) {\n    return value === 'int' ? 'int' : value === 'float' ? 'float' : undefined;\n}\nfunction parseColorInputParams(params) {\n    return parseRecord(params, (p) => ({\n        color: p.optional.object({\n            alpha: p.optional.boolean,\n            type: p.optional.custom(parseColorType),\n        }),\n        expanded: p.optional.boolean,\n        picker: p.optional.custom(parsePickerLayout),\n        readonly: p.optional.constant(false),\n    }));\n}\nfunction getKeyScaleForColor(forAlpha) {\n    return forAlpha ? 0.1 : 1;\n}\nfunction extractColorType(params) {\n    var _a;\n    return (_a = params.color) === null || _a === void 0 ? void 0 : _a.type;\n}\n\nclass FloatColor {\n    constructor(comps, mode) {\n        this.type = 'float';\n        this.mode = mode;\n        this.comps_ = constrainColorComponents(comps, mode, this.type);\n    }\n    getComponents(opt_mode) {\n        return appendAlphaComponent(convertColor(removeAlphaComponent(this.comps_), { mode: this.mode, type: this.type }, { mode: opt_mode !== null && opt_mode !== void 0 ? opt_mode : this.mode, type: this.type }), this.comps_[3]);\n    }\n    toRgbaObject() {\n        const rgbComps = this.getComponents('rgb');\n        return {\n            r: rgbComps[0],\n            g: rgbComps[1],\n            b: rgbComps[2],\n            a: rgbComps[3],\n        };\n    }\n}\n\nconst TYPE_TO_CONSTRUCTOR_MAP = {\n    int: (comps, mode) => new IntColor(comps, mode),\n    float: (comps, mode) => new FloatColor(comps, mode),\n};\nfunction createColor(comps, mode, type) {\n    return TYPE_TO_CONSTRUCTOR_MAP[type](comps, mode);\n}\nfunction isFloatColor(c) {\n    return c.type === 'float';\n}\nfunction isIntColor(c) {\n    return c.type === 'int';\n}\nfunction convertFloatToInt(cf) {\n    const comps = cf.getComponents();\n    const ms = getColorMaxComponents(cf.mode, 'int');\n    return new IntColor([\n        Math.round(mapRange(comps[0], 0, 1, 0, ms[0])),\n        Math.round(mapRange(comps[1], 0, 1, 0, ms[1])),\n        Math.round(mapRange(comps[2], 0, 1, 0, ms[2])),\n        comps[3],\n    ], cf.mode);\n}\nfunction convertIntToFloat(ci) {\n    const comps = ci.getComponents();\n    const ms = getColorMaxComponents(ci.mode, 'int');\n    return new FloatColor([\n        mapRange(comps[0], 0, ms[0], 0, 1),\n        mapRange(comps[1], 0, ms[1], 0, 1),\n        mapRange(comps[2], 0, ms[2], 0, 1),\n        comps[3],\n    ], ci.mode);\n}\nfunction mapColorType(c, type) {\n    if (c.type === type) {\n        return c;\n    }\n    if (isIntColor(c) && type === 'float') {\n        return convertIntToFloat(c);\n    }\n    if (isFloatColor(c) && type === 'int') {\n        return convertFloatToInt(c);\n    }\n    throw TpError.shouldNeverHappen();\n}\n\nfunction equalsStringColorFormat(f1, f2) {\n    return (f1.alpha === f2.alpha &&\n        f1.mode === f2.mode &&\n        f1.notation === f2.notation &&\n        f1.type === f2.type);\n}\nfunction parseCssNumberOrPercentage(text, max) {\n    const m = text.match(/^(.+)%$/);\n    if (!m) {\n        return Math.min(parseFloat(text), max);\n    }\n    return Math.min(parseFloat(m[1]) * 0.01 * max, max);\n}\nconst ANGLE_TO_DEG_MAP = {\n    deg: (angle) => angle,\n    grad: (angle) => (angle * 360) / 400,\n    rad: (angle) => (angle * 360) / (2 * Math.PI),\n    turn: (angle) => angle * 360,\n};\nfunction parseCssNumberOrAngle(text) {\n    const m = text.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);\n    if (!m) {\n        return parseFloat(text);\n    }\n    const angle = parseFloat(m[1]);\n    const unit = m[2];\n    return ANGLE_TO_DEG_MAP[unit](angle);\n}\nfunction parseFunctionalRgbColorComponents(text) {\n    const m = text.match(/^rgb\\(\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*\\)$/);\n    if (!m) {\n        return null;\n    }\n    const comps = [\n        parseCssNumberOrPercentage(m[1], 255),\n        parseCssNumberOrPercentage(m[2], 255),\n        parseCssNumberOrPercentage(m[3], 255),\n    ];\n    if (isNaN(comps[0]) || isNaN(comps[1]) || isNaN(comps[2])) {\n        return null;\n    }\n    return comps;\n}\nfunction parseFunctionalRgbColor(text) {\n    const comps = parseFunctionalRgbColorComponents(text);\n    return comps ? new IntColor(comps, 'rgb') : null;\n}\nfunction parseFunctionalRgbaColorComponents(text) {\n    const m = text.match(/^rgba\\(\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*\\)$/);\n    if (!m) {\n        return null;\n    }\n    const comps = [\n        parseCssNumberOrPercentage(m[1], 255),\n        parseCssNumberOrPercentage(m[2], 255),\n        parseCssNumberOrPercentage(m[3], 255),\n        parseCssNumberOrPercentage(m[4], 1),\n    ];\n    if (isNaN(comps[0]) ||\n        isNaN(comps[1]) ||\n        isNaN(comps[2]) ||\n        isNaN(comps[3])) {\n        return null;\n    }\n    return comps;\n}\nfunction parseFunctionalRgbaColor(text) {\n    const comps = parseFunctionalRgbaColorComponents(text);\n    return comps ? new IntColor(comps, 'rgb') : null;\n}\nfunction parseFunctionalHslColorComponents(text) {\n    const m = text.match(/^hsl\\(\\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*\\)$/);\n    if (!m) {\n        return null;\n    }\n    const comps = [\n        parseCssNumberOrAngle(m[1]),\n        parseCssNumberOrPercentage(m[2], 100),\n        parseCssNumberOrPercentage(m[3], 100),\n    ];\n    if (isNaN(comps[0]) || isNaN(comps[1]) || isNaN(comps[2])) {\n        return null;\n    }\n    return comps;\n}\nfunction parseFunctionalHslColor(text) {\n    const comps = parseFunctionalHslColorComponents(text);\n    return comps ? new IntColor(comps, 'hsl') : null;\n}\nfunction parseHslaColorComponents(text) {\n    const m = text.match(/^hsla\\(\\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*\\)$/);\n    if (!m) {\n        return null;\n    }\n    const comps = [\n        parseCssNumberOrAngle(m[1]),\n        parseCssNumberOrPercentage(m[2], 100),\n        parseCssNumberOrPercentage(m[3], 100),\n        parseCssNumberOrPercentage(m[4], 1),\n    ];\n    if (isNaN(comps[0]) ||\n        isNaN(comps[1]) ||\n        isNaN(comps[2]) ||\n        isNaN(comps[3])) {\n        return null;\n    }\n    return comps;\n}\nfunction parseFunctionalHslaColor(text) {\n    const comps = parseHslaColorComponents(text);\n    return comps ? new IntColor(comps, 'hsl') : null;\n}\nfunction parseHexRgbColorComponents(text) {\n    const mRgb = text.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);\n    if (mRgb) {\n        return [\n            parseInt(mRgb[1] + mRgb[1], 16),\n            parseInt(mRgb[2] + mRgb[2], 16),\n            parseInt(mRgb[3] + mRgb[3], 16),\n        ];\n    }\n    const mRrggbb = text.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);\n    if (mRrggbb) {\n        return [\n            parseInt(mRrggbb[1], 16),\n            parseInt(mRrggbb[2], 16),\n            parseInt(mRrggbb[3], 16),\n        ];\n    }\n    return null;\n}\nfunction parseHexRgbColor(text) {\n    const comps = parseHexRgbColorComponents(text);\n    return comps ? new IntColor(comps, 'rgb') : null;\n}\nfunction parseHexRgbaColorComponents(text) {\n    const mRgb = text.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);\n    if (mRgb) {\n        return [\n            parseInt(mRgb[1] + mRgb[1], 16),\n            parseInt(mRgb[2] + mRgb[2], 16),\n            parseInt(mRgb[3] + mRgb[3], 16),\n            mapRange(parseInt(mRgb[4] + mRgb[4], 16), 0, 255, 0, 1),\n        ];\n    }\n    const mRrggbb = text.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);\n    if (mRrggbb) {\n        return [\n            parseInt(mRrggbb[1], 16),\n            parseInt(mRrggbb[2], 16),\n            parseInt(mRrggbb[3], 16),\n            mapRange(parseInt(mRrggbb[4], 16), 0, 255, 0, 1),\n        ];\n    }\n    return null;\n}\nfunction parseHexRgbaColor(text) {\n    const comps = parseHexRgbaColorComponents(text);\n    return comps ? new IntColor(comps, 'rgb') : null;\n}\nfunction parseObjectRgbColorComponents(text) {\n    const m = text.match(/^\\{\\s*r\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*g\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*b\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*\\}$/);\n    if (!m) {\n        return null;\n    }\n    const comps = [\n        parseFloat(m[1]),\n        parseFloat(m[2]),\n        parseFloat(m[3]),\n    ];\n    if (isNaN(comps[0]) || isNaN(comps[1]) || isNaN(comps[2])) {\n        return null;\n    }\n    return comps;\n}\nfunction createObjectRgbColorParser(type) {\n    return (text) => {\n        const comps = parseObjectRgbColorComponents(text);\n        return comps ? createColor(comps, 'rgb', type) : null;\n    };\n}\nfunction parseObjectRgbaColorComponents(text) {\n    const m = text.match(/^\\{\\s*r\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*g\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*b\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*a\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*\\}$/);\n    if (!m) {\n        return null;\n    }\n    const comps = [\n        parseFloat(m[1]),\n        parseFloat(m[2]),\n        parseFloat(m[3]),\n        parseFloat(m[4]),\n    ];\n    if (isNaN(comps[0]) ||\n        isNaN(comps[1]) ||\n        isNaN(comps[2]) ||\n        isNaN(comps[3])) {\n        return null;\n    }\n    return comps;\n}\nfunction createObjectRgbaColorParser(type) {\n    return (text) => {\n        const comps = parseObjectRgbaColorComponents(text);\n        return comps ? createColor(comps, 'rgb', type) : null;\n    };\n}\nconst PARSER_AND_RESULT = [\n    {\n        parser: parseHexRgbColorComponents,\n        result: {\n            alpha: false,\n            mode: 'rgb',\n            notation: 'hex',\n        },\n    },\n    {\n        parser: parseHexRgbaColorComponents,\n        result: {\n            alpha: true,\n            mode: 'rgb',\n            notation: 'hex',\n        },\n    },\n    {\n        parser: parseFunctionalRgbColorComponents,\n        result: {\n            alpha: false,\n            mode: 'rgb',\n            notation: 'func',\n        },\n    },\n    {\n        parser: parseFunctionalRgbaColorComponents,\n        result: {\n            alpha: true,\n            mode: 'rgb',\n            notation: 'func',\n        },\n    },\n    {\n        parser: parseFunctionalHslColorComponents,\n        result: {\n            alpha: false,\n            mode: 'hsl',\n            notation: 'func',\n        },\n    },\n    {\n        parser: parseHslaColorComponents,\n        result: {\n            alpha: true,\n            mode: 'hsl',\n            notation: 'func',\n        },\n    },\n    {\n        parser: parseObjectRgbColorComponents,\n        result: {\n            alpha: false,\n            mode: 'rgb',\n            notation: 'object',\n        },\n    },\n    {\n        parser: parseObjectRgbaColorComponents,\n        result: {\n            alpha: true,\n            mode: 'rgb',\n            notation: 'object',\n        },\n    },\n];\nfunction detectStringColor(text) {\n    return PARSER_AND_RESULT.reduce((prev, { parser, result: detection }) => {\n        if (prev) {\n            return prev;\n        }\n        return parser(text) ? detection : null;\n    }, null);\n}\nfunction detectStringColorFormat(text, type = 'int') {\n    const r = detectStringColor(text);\n    if (!r) {\n        return null;\n    }\n    if (r.notation === 'hex' && type !== 'float') {\n        return Object.assign(Object.assign({}, r), { type: 'int' });\n    }\n    if (r.notation === 'func') {\n        return Object.assign(Object.assign({}, r), { type: type });\n    }\n    return null;\n}\nfunction createColorStringParser(type) {\n    const parsers = [\n        parseHexRgbColor,\n        parseHexRgbaColor,\n        parseFunctionalRgbColor,\n        parseFunctionalRgbaColor,\n        parseFunctionalHslColor,\n        parseFunctionalHslaColor,\n    ];\n    if (type === 'int') {\n        parsers.push(createObjectRgbColorParser('int'), createObjectRgbaColorParser('int'));\n    }\n    if (type === 'float') {\n        parsers.push(createObjectRgbColorParser('float'), createObjectRgbaColorParser('float'));\n    }\n    const parser = composeParsers(parsers);\n    return (text) => {\n        const result = parser(text);\n        return result ? mapColorType(result, type) : null;\n    };\n}\nfunction readIntColorString(value) {\n    const parser = createColorStringParser('int');\n    if (typeof value !== 'string') {\n        return IntColor.black();\n    }\n    const result = parser(value);\n    return result !== null && result !== void 0 ? result : IntColor.black();\n}\nfunction zerofill(comp) {\n    const hex = constrainRange(Math.floor(comp), 0, 255).toString(16);\n    return hex.length === 1 ? `0${hex}` : hex;\n}\nfunction colorToHexRgbString(value, prefix = '#') {\n    const hexes = removeAlphaComponent(value.getComponents('rgb'))\n        .map(zerofill)\n        .join('');\n    return `${prefix}${hexes}`;\n}\nfunction colorToHexRgbaString(value, prefix = '#') {\n    const rgbaComps = value.getComponents('rgb');\n    const hexes = [rgbaComps[0], rgbaComps[1], rgbaComps[2], rgbaComps[3] * 255]\n        .map(zerofill)\n        .join('');\n    return `${prefix}${hexes}`;\n}\nfunction colorToFunctionalRgbString(value) {\n    const formatter = createNumberFormatter(0);\n    const ci = mapColorType(value, 'int');\n    const comps = removeAlphaComponent(ci.getComponents('rgb')).map((comp) => formatter(comp));\n    return `rgb(${comps.join(', ')})`;\n}\nfunction colorToFunctionalRgbaString(value) {\n    const aFormatter = createNumberFormatter(2);\n    const rgbFormatter = createNumberFormatter(0);\n    const ci = mapColorType(value, 'int');\n    const comps = ci.getComponents('rgb').map((comp, index) => {\n        const formatter = index === 3 ? aFormatter : rgbFormatter;\n        return formatter(comp);\n    });\n    return `rgba(${comps.join(', ')})`;\n}\nfunction colorToFunctionalHslString(value) {\n    const formatters = [\n        createNumberFormatter(0),\n        formatPercentage,\n        formatPercentage,\n    ];\n    const ci = mapColorType(value, 'int');\n    const comps = removeAlphaComponent(ci.getComponents('hsl')).map((comp, index) => formatters[index](comp));\n    return `hsl(${comps.join(', ')})`;\n}\nfunction colorToFunctionalHslaString(value) {\n    const formatters = [\n        createNumberFormatter(0),\n        formatPercentage,\n        formatPercentage,\n        createNumberFormatter(2),\n    ];\n    const ci = mapColorType(value, 'int');\n    const comps = ci\n        .getComponents('hsl')\n        .map((comp, index) => formatters[index](comp));\n    return `hsla(${comps.join(', ')})`;\n}\nfunction colorToObjectRgbString(value, type) {\n    const formatter = createNumberFormatter(type === 'float' ? 2 : 0);\n    const names = ['r', 'g', 'b'];\n    const cc = mapColorType(value, type);\n    const comps = removeAlphaComponent(cc.getComponents('rgb')).map((comp, index) => `${names[index]}: ${formatter(comp)}`);\n    return `{${comps.join(', ')}}`;\n}\nfunction createObjectRgbColorFormatter(type) {\n    return (value) => colorToObjectRgbString(value, type);\n}\nfunction colorToObjectRgbaString(value, type) {\n    const aFormatter = createNumberFormatter(2);\n    const rgbFormatter = createNumberFormatter(type === 'float' ? 2 : 0);\n    const names = ['r', 'g', 'b', 'a'];\n    const cc = mapColorType(value, type);\n    const comps = cc.getComponents('rgb').map((comp, index) => {\n        const formatter = index === 3 ? aFormatter : rgbFormatter;\n        return `${names[index]}: ${formatter(comp)}`;\n    });\n    return `{${comps.join(', ')}}`;\n}\nfunction createObjectRgbaColorFormatter(type) {\n    return (value) => colorToObjectRgbaString(value, type);\n}\nconst FORMAT_AND_STRINGIFIERS = [\n    {\n        format: {\n            alpha: false,\n            mode: 'rgb',\n            notation: 'hex',\n            type: 'int',\n        },\n        stringifier: colorToHexRgbString,\n    },\n    {\n        format: {\n            alpha: true,\n            mode: 'rgb',\n            notation: 'hex',\n            type: 'int',\n        },\n        stringifier: colorToHexRgbaString,\n    },\n    {\n        format: {\n            alpha: false,\n            mode: 'rgb',\n            notation: 'func',\n            type: 'int',\n        },\n        stringifier: colorToFunctionalRgbString,\n    },\n    {\n        format: {\n            alpha: true,\n            mode: 'rgb',\n            notation: 'func',\n            type: 'int',\n        },\n        stringifier: colorToFunctionalRgbaString,\n    },\n    {\n        format: {\n            alpha: false,\n            mode: 'hsl',\n            notation: 'func',\n            type: 'int',\n        },\n        stringifier: colorToFunctionalHslString,\n    },\n    {\n        format: {\n            alpha: true,\n            mode: 'hsl',\n            notation: 'func',\n            type: 'int',\n        },\n        stringifier: colorToFunctionalHslaString,\n    },\n    ...['int', 'float'].reduce((prev, type) => {\n        return [\n            ...prev,\n            {\n                format: {\n                    alpha: false,\n                    mode: 'rgb',\n                    notation: 'object',\n                    type: type,\n                },\n                stringifier: createObjectRgbColorFormatter(type),\n            },\n            {\n                format: {\n                    alpha: true,\n                    mode: 'rgb',\n                    notation: 'object',\n                    type: type,\n                },\n                stringifier: createObjectRgbaColorFormatter(type),\n            },\n        ];\n    }, []),\n];\nfunction findColorStringifier(format) {\n    return FORMAT_AND_STRINGIFIERS.reduce((prev, fas) => {\n        if (prev) {\n            return prev;\n        }\n        return equalsStringColorFormat(fas.format, format)\n            ? fas.stringifier\n            : null;\n    }, null);\n}\n\nconst cn$b = ClassName('apl');\nclass APaletteView {\n    constructor(doc, config) {\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.value = config.value;\n        this.value.emitter.on('change', this.onValueChange_);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$b());\n        config.viewProps.bindClassModifiers(this.element);\n        config.viewProps.bindTabIndex(this.element);\n        const barElem = doc.createElement('div');\n        barElem.classList.add(cn$b('b'));\n        this.element.appendChild(barElem);\n        const colorElem = doc.createElement('div');\n        colorElem.classList.add(cn$b('c'));\n        barElem.appendChild(colorElem);\n        this.colorElem_ = colorElem;\n        const markerElem = doc.createElement('div');\n        markerElem.classList.add(cn$b('m'));\n        this.element.appendChild(markerElem);\n        this.markerElem_ = markerElem;\n        const previewElem = doc.createElement('div');\n        previewElem.classList.add(cn$b('p'));\n        this.markerElem_.appendChild(previewElem);\n        this.previewElem_ = previewElem;\n        this.update_();\n    }\n    update_() {\n        const c = this.value.rawValue;\n        const rgbaComps = c.getComponents('rgb');\n        const leftColor = new IntColor([rgbaComps[0], rgbaComps[1], rgbaComps[2], 0], 'rgb');\n        const rightColor = new IntColor([rgbaComps[0], rgbaComps[1], rgbaComps[2], 255], 'rgb');\n        const gradientComps = [\n            'to right',\n            colorToFunctionalRgbaString(leftColor),\n            colorToFunctionalRgbaString(rightColor),\n        ];\n        this.colorElem_.style.background = `linear-gradient(${gradientComps.join(',')})`;\n        this.previewElem_.style.backgroundColor = colorToFunctionalRgbaString(c);\n        const left = mapRange(rgbaComps[3], 0, 1, 0, 100);\n        this.markerElem_.style.left = `${left}%`;\n    }\n    onValueChange_() {\n        this.update_();\n    }\n}\n\nclass APaletteController {\n    constructor(doc, config) {\n        this.onKeyDown_ = this.onKeyDown_.bind(this);\n        this.onKeyUp_ = this.onKeyUp_.bind(this);\n        this.onPointerDown_ = this.onPointerDown_.bind(this);\n        this.onPointerMove_ = this.onPointerMove_.bind(this);\n        this.onPointerUp_ = this.onPointerUp_.bind(this);\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new APaletteView(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.ptHandler_ = new PointerHandler(this.view.element);\n        this.ptHandler_.emitter.on('down', this.onPointerDown_);\n        this.ptHandler_.emitter.on('move', this.onPointerMove_);\n        this.ptHandler_.emitter.on('up', this.onPointerUp_);\n        this.view.element.addEventListener('keydown', this.onKeyDown_);\n        this.view.element.addEventListener('keyup', this.onKeyUp_);\n    }\n    handlePointerEvent_(d, opts) {\n        if (!d.point) {\n            return;\n        }\n        const alpha = d.point.x / d.bounds.width;\n        const c = this.value.rawValue;\n        const [h, s, v] = c.getComponents('hsv');\n        this.value.setRawValue(new IntColor([h, s, v, alpha], 'hsv'), opts);\n    }\n    onPointerDown_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerMove_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerUp_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n    onKeyDown_(ev) {\n        const step = getStepForKey(getKeyScaleForColor(true), getHorizontalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        const c = this.value.rawValue;\n        const [h, s, v, a] = c.getComponents('hsv');\n        this.value.setRawValue(new IntColor([h, s, v, a + step], 'hsv'), {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onKeyUp_(ev) {\n        const step = getStepForKey(getKeyScaleForColor(true), getHorizontalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        this.value.setRawValue(this.value.rawValue, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n}\n\nconst cn$a = ClassName('coltxt');\nfunction createModeSelectElement(doc) {\n    const selectElem = doc.createElement('select');\n    const items = [\n        { text: 'RGB', value: 'rgb' },\n        { text: 'HSL', value: 'hsl' },\n        { text: 'HSV', value: 'hsv' },\n        { text: 'HEX', value: 'hex' },\n    ];\n    selectElem.appendChild(items.reduce((frag, item) => {\n        const optElem = doc.createElement('option');\n        optElem.textContent = item.text;\n        optElem.value = item.value;\n        frag.appendChild(optElem);\n        return frag;\n    }, doc.createDocumentFragment()));\n    return selectElem;\n}\nclass ColorTextsView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$a());\n        config.viewProps.bindClassModifiers(this.element);\n        const modeElem = doc.createElement('div');\n        modeElem.classList.add(cn$a('m'));\n        this.modeElem_ = createModeSelectElement(doc);\n        this.modeElem_.classList.add(cn$a('ms'));\n        modeElem.appendChild(this.modeSelectElement);\n        config.viewProps.bindDisabled(this.modeElem_);\n        const modeMarkerElem = doc.createElement('div');\n        modeMarkerElem.classList.add(cn$a('mm'));\n        modeMarkerElem.appendChild(createSvgIconElement(doc, 'dropdown'));\n        modeElem.appendChild(modeMarkerElem);\n        this.element.appendChild(modeElem);\n        const inputsElem = doc.createElement('div');\n        inputsElem.classList.add(cn$a('w'));\n        this.element.appendChild(inputsElem);\n        this.inputsElem_ = inputsElem;\n        this.inputViews_ = config.inputViews;\n        this.applyInputViews_();\n        bindValue(config.mode, (mode) => {\n            this.modeElem_.value = mode;\n        });\n    }\n    get modeSelectElement() {\n        return this.modeElem_;\n    }\n    get inputViews() {\n        return this.inputViews_;\n    }\n    set inputViews(inputViews) {\n        this.inputViews_ = inputViews;\n        this.applyInputViews_();\n    }\n    applyInputViews_() {\n        removeChildElements(this.inputsElem_);\n        const doc = this.element.ownerDocument;\n        this.inputViews_.forEach((v) => {\n            const compElem = doc.createElement('div');\n            compElem.classList.add(cn$a('c'));\n            compElem.appendChild(v.element);\n            this.inputsElem_.appendChild(compElem);\n        });\n    }\n}\n\nfunction createFormatter$2(type) {\n    return createNumberFormatter(type === 'float' ? 2 : 0);\n}\nfunction createConstraint$5(mode, type, index) {\n    const max = getColorMaxComponents(mode, type)[index];\n    return new DefiniteRangeConstraint({\n        min: 0,\n        max: max,\n    });\n}\nfunction createComponentController(doc, config, index) {\n    return new NumberTextController(doc, {\n        arrayPosition: index === 0 ? 'fst' : index === 3 - 1 ? 'lst' : 'mid',\n        parser: config.parser,\n        props: ValueMap.fromObject({\n            formatter: createFormatter$2(config.colorType),\n            keyScale: getKeyScaleForColor(false),\n            pointerScale: config.colorType === 'float' ? 0.01 : 1,\n        }),\n        value: createValue(0, {\n            constraint: createConstraint$5(config.colorMode, config.colorType, index),\n        }),\n        viewProps: config.viewProps,\n    });\n}\nfunction createComponentControllers(doc, config) {\n    const cc = {\n        colorMode: config.colorMode,\n        colorType: config.colorType,\n        parser: parseNumber,\n        viewProps: config.viewProps,\n    };\n    return [0, 1, 2].map((i) => {\n        const c = createComponentController(doc, cc, i);\n        connectValues({\n            primary: config.value,\n            secondary: c.value,\n            forward(p) {\n                const mc = mapColorType(p, config.colorType);\n                return mc.getComponents(config.colorMode)[i];\n            },\n            backward(p, s) {\n                const pickedMode = config.colorMode;\n                const mc = mapColorType(p, config.colorType);\n                const comps = mc.getComponents(pickedMode);\n                comps[i] = s;\n                const c = createColor(appendAlphaComponent(removeAlphaComponent(comps), comps[3]), pickedMode, config.colorType);\n                return mapColorType(c, 'int');\n            },\n        });\n        return c;\n    });\n}\nfunction createHexController(doc, config) {\n    const c = new TextController(doc, {\n        parser: createColorStringParser('int'),\n        props: ValueMap.fromObject({\n            formatter: colorToHexRgbString,\n        }),\n        value: createValue(IntColor.black()),\n        viewProps: config.viewProps,\n    });\n    connectValues({\n        primary: config.value,\n        secondary: c.value,\n        forward: (p) => new IntColor(removeAlphaComponent(p.getComponents()), p.mode),\n        backward: (p, s) => new IntColor(appendAlphaComponent(removeAlphaComponent(s.getComponents(p.mode)), p.getComponents()[3]), p.mode),\n    });\n    return [c];\n}\nfunction isColorMode(mode) {\n    return mode !== 'hex';\n}\nclass ColorTextsController {\n    constructor(doc, config) {\n        this.onModeSelectChange_ = this.onModeSelectChange_.bind(this);\n        this.colorType_ = config.colorType;\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.colorMode = createValue(this.value.rawValue.mode);\n        this.ccs_ = this.createComponentControllers_(doc);\n        this.view = new ColorTextsView(doc, {\n            mode: this.colorMode,\n            inputViews: [this.ccs_[0].view, this.ccs_[1].view, this.ccs_[2].view],\n            viewProps: this.viewProps,\n        });\n        this.view.modeSelectElement.addEventListener('change', this.onModeSelectChange_);\n    }\n    createComponentControllers_(doc) {\n        const mode = this.colorMode.rawValue;\n        if (isColorMode(mode)) {\n            return createComponentControllers(doc, {\n                colorMode: mode,\n                colorType: this.colorType_,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n        }\n        return createHexController(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n    }\n    onModeSelectChange_(ev) {\n        const selectElem = ev.currentTarget;\n        this.colorMode.rawValue = selectElem.value;\n        this.ccs_ = this.createComponentControllers_(this.view.element.ownerDocument);\n        this.view.inputViews = this.ccs_.map((cc) => cc.view);\n    }\n}\n\nconst cn$9 = ClassName('hpl');\nclass HPaletteView {\n    constructor(doc, config) {\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.value = config.value;\n        this.value.emitter.on('change', this.onValueChange_);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$9());\n        config.viewProps.bindClassModifiers(this.element);\n        config.viewProps.bindTabIndex(this.element);\n        const colorElem = doc.createElement('div');\n        colorElem.classList.add(cn$9('c'));\n        this.element.appendChild(colorElem);\n        const markerElem = doc.createElement('div');\n        markerElem.classList.add(cn$9('m'));\n        this.element.appendChild(markerElem);\n        this.markerElem_ = markerElem;\n        this.update_();\n    }\n    update_() {\n        const c = this.value.rawValue;\n        const [h] = c.getComponents('hsv');\n        this.markerElem_.style.backgroundColor = colorToFunctionalRgbString(new IntColor([h, 100, 100], 'hsv'));\n        const left = mapRange(h, 0, 360, 0, 100);\n        this.markerElem_.style.left = `${left}%`;\n    }\n    onValueChange_() {\n        this.update_();\n    }\n}\n\nclass HPaletteController {\n    constructor(doc, config) {\n        this.onKeyDown_ = this.onKeyDown_.bind(this);\n        this.onKeyUp_ = this.onKeyUp_.bind(this);\n        this.onPointerDown_ = this.onPointerDown_.bind(this);\n        this.onPointerMove_ = this.onPointerMove_.bind(this);\n        this.onPointerUp_ = this.onPointerUp_.bind(this);\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new HPaletteView(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.ptHandler_ = new PointerHandler(this.view.element);\n        this.ptHandler_.emitter.on('down', this.onPointerDown_);\n        this.ptHandler_.emitter.on('move', this.onPointerMove_);\n        this.ptHandler_.emitter.on('up', this.onPointerUp_);\n        this.view.element.addEventListener('keydown', this.onKeyDown_);\n        this.view.element.addEventListener('keyup', this.onKeyUp_);\n    }\n    handlePointerEvent_(d, opts) {\n        if (!d.point) {\n            return;\n        }\n        const hue = mapRange(constrainRange(d.point.x, 0, d.bounds.width), 0, d.bounds.width, 0, 360);\n        const c = this.value.rawValue;\n        const [, s, v, a] = c.getComponents('hsv');\n        this.value.setRawValue(new IntColor([hue, s, v, a], 'hsv'), opts);\n    }\n    onPointerDown_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerMove_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerUp_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n    onKeyDown_(ev) {\n        const step = getStepForKey(getKeyScaleForColor(false), getHorizontalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        const c = this.value.rawValue;\n        const [h, s, v, a] = c.getComponents('hsv');\n        this.value.setRawValue(new IntColor([h + step, s, v, a], 'hsv'), {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onKeyUp_(ev) {\n        const step = getStepForKey(getKeyScaleForColor(false), getHorizontalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        this.value.setRawValue(this.value.rawValue, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n}\n\nconst cn$8 = ClassName('svp');\nconst CANVAS_RESOL = 64;\nclass SvPaletteView {\n    constructor(doc, config) {\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.value = config.value;\n        this.value.emitter.on('change', this.onValueChange_);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$8());\n        config.viewProps.bindClassModifiers(this.element);\n        config.viewProps.bindTabIndex(this.element);\n        const canvasElem = doc.createElement('canvas');\n        canvasElem.height = CANVAS_RESOL;\n        canvasElem.width = CANVAS_RESOL;\n        canvasElem.classList.add(cn$8('c'));\n        this.element.appendChild(canvasElem);\n        this.canvasElement = canvasElem;\n        const markerElem = doc.createElement('div');\n        markerElem.classList.add(cn$8('m'));\n        this.element.appendChild(markerElem);\n        this.markerElem_ = markerElem;\n        this.update_();\n    }\n    update_() {\n        const ctx = getCanvasContext(this.canvasElement);\n        if (!ctx) {\n            return;\n        }\n        const c = this.value.rawValue;\n        const hsvComps = c.getComponents('hsv');\n        const width = this.canvasElement.width;\n        const height = this.canvasElement.height;\n        const imgData = ctx.getImageData(0, 0, width, height);\n        const data = imgData.data;\n        for (let iy = 0; iy < height; iy++) {\n            for (let ix = 0; ix < width; ix++) {\n                const s = mapRange(ix, 0, width, 0, 100);\n                const v = mapRange(iy, 0, height, 100, 0);\n                const rgbComps = hsvToRgbInt(hsvComps[0], s, v);\n                const i = (iy * width + ix) * 4;\n                data[i] = rgbComps[0];\n                data[i + 1] = rgbComps[1];\n                data[i + 2] = rgbComps[2];\n                data[i + 3] = 255;\n            }\n        }\n        ctx.putImageData(imgData, 0, 0);\n        const left = mapRange(hsvComps[1], 0, 100, 0, 100);\n        this.markerElem_.style.left = `${left}%`;\n        const top = mapRange(hsvComps[2], 0, 100, 100, 0);\n        this.markerElem_.style.top = `${top}%`;\n    }\n    onValueChange_() {\n        this.update_();\n    }\n}\n\nclass SvPaletteController {\n    constructor(doc, config) {\n        this.onKeyDown_ = this.onKeyDown_.bind(this);\n        this.onKeyUp_ = this.onKeyUp_.bind(this);\n        this.onPointerDown_ = this.onPointerDown_.bind(this);\n        this.onPointerMove_ = this.onPointerMove_.bind(this);\n        this.onPointerUp_ = this.onPointerUp_.bind(this);\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new SvPaletteView(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.ptHandler_ = new PointerHandler(this.view.element);\n        this.ptHandler_.emitter.on('down', this.onPointerDown_);\n        this.ptHandler_.emitter.on('move', this.onPointerMove_);\n        this.ptHandler_.emitter.on('up', this.onPointerUp_);\n        this.view.element.addEventListener('keydown', this.onKeyDown_);\n        this.view.element.addEventListener('keyup', this.onKeyUp_);\n    }\n    handlePointerEvent_(d, opts) {\n        if (!d.point) {\n            return;\n        }\n        const saturation = mapRange(d.point.x, 0, d.bounds.width, 0, 100);\n        const value = mapRange(d.point.y, 0, d.bounds.height, 100, 0);\n        const [h, , , a] = this.value.rawValue.getComponents('hsv');\n        this.value.setRawValue(new IntColor([h, saturation, value, a], 'hsv'), opts);\n    }\n    onPointerDown_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerMove_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerUp_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n    onKeyDown_(ev) {\n        if (isArrowKey(ev.key)) {\n            ev.preventDefault();\n        }\n        const [h, s, v, a] = this.value.rawValue.getComponents('hsv');\n        const keyScale = getKeyScaleForColor(false);\n        const ds = getStepForKey(keyScale, getHorizontalStepKeys(ev));\n        const dv = getStepForKey(keyScale, getVerticalStepKeys(ev));\n        if (ds === 0 && dv === 0) {\n            return;\n        }\n        this.value.setRawValue(new IntColor([h, s + ds, v + dv, a], 'hsv'), {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onKeyUp_(ev) {\n        const keyScale = getKeyScaleForColor(false);\n        const ds = getStepForKey(keyScale, getHorizontalStepKeys(ev));\n        const dv = getStepForKey(keyScale, getVerticalStepKeys(ev));\n        if (ds === 0 && dv === 0) {\n            return;\n        }\n        this.value.setRawValue(this.value.rawValue, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n}\n\nclass ColorPickerController {\n    constructor(doc, config) {\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.hPaletteC_ = new HPaletteController(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.svPaletteC_ = new SvPaletteController(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.alphaIcs_ = config.supportsAlpha\n            ? {\n                palette: new APaletteController(doc, {\n                    value: this.value,\n                    viewProps: this.viewProps,\n                }),\n                text: new NumberTextController(doc, {\n                    parser: parseNumber,\n                    props: ValueMap.fromObject({\n                        pointerScale: 0.01,\n                        keyScale: 0.1,\n                        formatter: createNumberFormatter(2),\n                    }),\n                    value: createValue(0, {\n                        constraint: new DefiniteRangeConstraint({ min: 0, max: 1 }),\n                    }),\n                    viewProps: this.viewProps,\n                }),\n            }\n            : null;\n        if (this.alphaIcs_) {\n            connectValues({\n                primary: this.value,\n                secondary: this.alphaIcs_.text.value,\n                forward: (p) => p.getComponents()[3],\n                backward: (p, s) => {\n                    const comps = p.getComponents();\n                    comps[3] = s;\n                    return new IntColor(comps, p.mode);\n                },\n            });\n        }\n        this.textsC_ = new ColorTextsController(doc, {\n            colorType: config.colorType,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view = new ColorPickerView(doc, {\n            alphaViews: this.alphaIcs_\n                ? {\n                    palette: this.alphaIcs_.palette.view,\n                    text: this.alphaIcs_.text.view,\n                }\n                : null,\n            hPaletteView: this.hPaletteC_.view,\n            supportsAlpha: config.supportsAlpha,\n            svPaletteView: this.svPaletteC_.view,\n            textsView: this.textsC_.view,\n            viewProps: this.viewProps,\n        });\n    }\n    get textsController() {\n        return this.textsC_;\n    }\n}\n\nconst cn$7 = ClassName('colsw');\nclass ColorSwatchView {\n    constructor(doc, config) {\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        config.value.emitter.on('change', this.onValueChange_);\n        this.value = config.value;\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$7());\n        config.viewProps.bindClassModifiers(this.element);\n        const swatchElem = doc.createElement('div');\n        swatchElem.classList.add(cn$7('sw'));\n        this.element.appendChild(swatchElem);\n        this.swatchElem_ = swatchElem;\n        const buttonElem = doc.createElement('button');\n        buttonElem.classList.add(cn$7('b'));\n        config.viewProps.bindDisabled(buttonElem);\n        this.element.appendChild(buttonElem);\n        this.buttonElement = buttonElem;\n        this.update_();\n    }\n    update_() {\n        const value = this.value.rawValue;\n        this.swatchElem_.style.backgroundColor = colorToHexRgbaString(value);\n    }\n    onValueChange_() {\n        this.update_();\n    }\n}\n\nclass ColorSwatchController {\n    constructor(doc, config) {\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new ColorSwatchView(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n    }\n}\n\nclass ColorController {\n    constructor(doc, config) {\n        this.onButtonBlur_ = this.onButtonBlur_.bind(this);\n        this.onButtonClick_ = this.onButtonClick_.bind(this);\n        this.onPopupChildBlur_ = this.onPopupChildBlur_.bind(this);\n        this.onPopupChildKeydown_ = this.onPopupChildKeydown_.bind(this);\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.foldable_ = Foldable.create(config.expanded);\n        this.swatchC_ = new ColorSwatchController(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        const buttonElem = this.swatchC_.view.buttonElement;\n        buttonElem.addEventListener('blur', this.onButtonBlur_);\n        buttonElem.addEventListener('click', this.onButtonClick_);\n        this.textC_ = new TextController(doc, {\n            parser: config.parser,\n            props: ValueMap.fromObject({\n                formatter: config.formatter,\n            }),\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view = new ColorView(doc, {\n            foldable: this.foldable_,\n            pickerLayout: config.pickerLayout,\n        });\n        this.view.swatchElement.appendChild(this.swatchC_.view.element);\n        this.view.textElement.appendChild(this.textC_.view.element);\n        this.popC_ =\n            config.pickerLayout === 'popup'\n                ? new PopupController(doc, {\n                    viewProps: this.viewProps,\n                })\n                : null;\n        const pickerC = new ColorPickerController(doc, {\n            colorType: config.colorType,\n            supportsAlpha: config.supportsAlpha,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        pickerC.view.allFocusableElements.forEach((elem) => {\n            elem.addEventListener('blur', this.onPopupChildBlur_);\n            elem.addEventListener('keydown', this.onPopupChildKeydown_);\n        });\n        this.pickerC_ = pickerC;\n        if (this.popC_) {\n            this.view.element.appendChild(this.popC_.view.element);\n            this.popC_.view.element.appendChild(pickerC.view.element);\n            connectValues({\n                primary: this.foldable_.value('expanded'),\n                secondary: this.popC_.shows,\n                forward: (p) => p,\n                backward: (_, s) => s,\n            });\n        }\n        else if (this.view.pickerElement) {\n            this.view.pickerElement.appendChild(this.pickerC_.view.element);\n            bindFoldable(this.foldable_, this.view.pickerElement);\n        }\n    }\n    get textController() {\n        return this.textC_;\n    }\n    onButtonBlur_(e) {\n        if (!this.popC_) {\n            return;\n        }\n        const elem = this.view.element;\n        const nextTarget = forceCast(e.relatedTarget);\n        if (!nextTarget || !elem.contains(nextTarget)) {\n            this.popC_.shows.rawValue = false;\n        }\n    }\n    onButtonClick_() {\n        this.foldable_.set('expanded', !this.foldable_.get('expanded'));\n        if (this.foldable_.get('expanded')) {\n            this.pickerC_.view.allFocusableElements[0].focus();\n        }\n    }\n    onPopupChildBlur_(ev) {\n        if (!this.popC_) {\n            return;\n        }\n        const elem = this.popC_.view.element;\n        const nextTarget = findNextTarget(ev);\n        if (nextTarget && elem.contains(nextTarget)) {\n            return;\n        }\n        if (nextTarget &&\n            nextTarget === this.swatchC_.view.buttonElement &&\n            !supportsTouch(elem.ownerDocument)) {\n            return;\n        }\n        this.popC_.shows.rawValue = false;\n    }\n    onPopupChildKeydown_(ev) {\n        if (this.popC_) {\n            if (ev.key === 'Escape') {\n                this.popC_.shows.rawValue = false;\n            }\n        }\n        else if (this.view.pickerElement) {\n            if (ev.key === 'Escape') {\n                this.swatchC_.view.buttonElement.focus();\n            }\n        }\n    }\n}\n\nfunction colorToRgbNumber(value) {\n    return removeAlphaComponent(value.getComponents('rgb')).reduce((result, comp) => {\n        return (result << 8) | (Math.floor(comp) & 0xff);\n    }, 0);\n}\nfunction colorToRgbaNumber(value) {\n    return (value.getComponents('rgb').reduce((result, comp, index) => {\n        const hex = Math.floor(index === 3 ? comp * 255 : comp) & 0xff;\n        return (result << 8) | hex;\n    }, 0) >>> 0);\n}\nfunction numberToRgbColor(num) {\n    return new IntColor([(num >> 16) & 0xff, (num >> 8) & 0xff, num & 0xff], 'rgb');\n}\nfunction numberToRgbaColor(num) {\n    return new IntColor([\n        (num >> 24) & 0xff,\n        (num >> 16) & 0xff,\n        (num >> 8) & 0xff,\n        mapRange(num & 0xff, 0, 255, 0, 1),\n    ], 'rgb');\n}\nfunction colorFromRgbNumber(value) {\n    if (typeof value !== 'number') {\n        return IntColor.black();\n    }\n    return numberToRgbColor(value);\n}\nfunction colorFromRgbaNumber(value) {\n    if (typeof value !== 'number') {\n        return IntColor.black();\n    }\n    return numberToRgbaColor(value);\n}\n\nfunction isRgbColorComponent(obj, key) {\n    if (typeof obj !== 'object' || isEmpty(obj)) {\n        return false;\n    }\n    return key in obj && typeof obj[key] === 'number';\n}\nfunction isRgbColorObject(obj) {\n    return (isRgbColorComponent(obj, 'r') &&\n        isRgbColorComponent(obj, 'g') &&\n        isRgbColorComponent(obj, 'b'));\n}\nfunction isRgbaColorObject(obj) {\n    return isRgbColorObject(obj) && isRgbColorComponent(obj, 'a');\n}\nfunction isColorObject(obj) {\n    return isRgbColorObject(obj);\n}\nfunction equalsColor(v1, v2) {\n    if (v1.mode !== v2.mode) {\n        return false;\n    }\n    if (v1.type !== v2.type) {\n        return false;\n    }\n    const comps1 = v1.getComponents();\n    const comps2 = v2.getComponents();\n    for (let i = 0; i < comps1.length; i++) {\n        if (comps1[i] !== comps2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction createColorComponentsFromRgbObject(obj) {\n    return 'a' in obj ? [obj.r, obj.g, obj.b, obj.a] : [obj.r, obj.g, obj.b];\n}\n\nfunction createColorStringWriter(format) {\n    const stringify = findColorStringifier(format);\n    return stringify\n        ? (target, value) => {\n            writePrimitive(target, stringify(value));\n        }\n        : null;\n}\nfunction createColorNumberWriter(supportsAlpha) {\n    const colorToNumber = supportsAlpha ? colorToRgbaNumber : colorToRgbNumber;\n    return (target, value) => {\n        writePrimitive(target, colorToNumber(value));\n    };\n}\nfunction writeRgbaColorObject(target, value, type) {\n    const cc = mapColorType(value, type);\n    const obj = cc.toRgbaObject();\n    target.writeProperty('r', obj.r);\n    target.writeProperty('g', obj.g);\n    target.writeProperty('b', obj.b);\n    target.writeProperty('a', obj.a);\n}\nfunction writeRgbColorObject(target, value, type) {\n    const cc = mapColorType(value, type);\n    const obj = cc.toRgbaObject();\n    target.writeProperty('r', obj.r);\n    target.writeProperty('g', obj.g);\n    target.writeProperty('b', obj.b);\n}\nfunction createColorObjectWriter(supportsAlpha, type) {\n    return (target, inValue) => {\n        if (supportsAlpha) {\n            writeRgbaColorObject(target, inValue, type);\n        }\n        else {\n            writeRgbColorObject(target, inValue, type);\n        }\n    };\n}\n\nfunction shouldSupportAlpha$1(inputParams) {\n    var _a;\n    if ((_a = inputParams === null || inputParams === void 0 ? void 0 : inputParams.color) === null || _a === void 0 ? void 0 : _a.alpha) {\n        return true;\n    }\n    return false;\n}\nfunction createFormatter$1(supportsAlpha) {\n    return supportsAlpha\n        ? (v) => colorToHexRgbaString(v, '0x')\n        : (v) => colorToHexRgbString(v, '0x');\n}\nfunction isForColor(params) {\n    if ('color' in params) {\n        return true;\n    }\n    if (params.view === 'color') {\n        return true;\n    }\n    return false;\n}\nconst NumberColorInputPlugin = createPlugin({\n    id: 'input-color-number',\n    type: 'input',\n    accept: (value, params) => {\n        if (typeof value !== 'number') {\n            return null;\n        }\n        if (!isForColor(params)) {\n            return null;\n        }\n        const result = parseColorInputParams(params);\n        return result\n            ? {\n                initialValue: value,\n                params: Object.assign(Object.assign({}, result), { supportsAlpha: shouldSupportAlpha$1(params) }),\n            }\n            : null;\n    },\n    binding: {\n        reader: (args) => {\n            return args.params.supportsAlpha\n                ? colorFromRgbaNumber\n                : colorFromRgbNumber;\n        },\n        equals: equalsColor,\n        writer: (args) => {\n            return createColorNumberWriter(args.params.supportsAlpha);\n        },\n    },\n    controller: (args) => {\n        var _a, _b;\n        return new ColorController(args.document, {\n            colorType: 'int',\n            expanded: (_a = args.params.expanded) !== null && _a !== void 0 ? _a : false,\n            formatter: createFormatter$1(args.params.supportsAlpha),\n            parser: createColorStringParser('int'),\n            pickerLayout: (_b = args.params.picker) !== null && _b !== void 0 ? _b : 'popup',\n            supportsAlpha: args.params.supportsAlpha,\n            value: args.value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nfunction colorFromObject(value, type) {\n    if (!isColorObject(value)) {\n        return mapColorType(IntColor.black(), type);\n    }\n    if (type === 'int') {\n        const comps = createColorComponentsFromRgbObject(value);\n        return new IntColor(comps, 'rgb');\n    }\n    if (type === 'float') {\n        const comps = createColorComponentsFromRgbObject(value);\n        return new FloatColor(comps, 'rgb');\n    }\n    return mapColorType(IntColor.black(), 'int');\n}\n\nfunction shouldSupportAlpha(initialValue) {\n    return isRgbaColorObject(initialValue);\n}\nfunction createColorObjectBindingReader(type) {\n    return (value) => {\n        const c = colorFromObject(value, type);\n        return mapColorType(c, 'int');\n    };\n}\nfunction createColorObjectFormatter(supportsAlpha, type) {\n    return (value) => {\n        if (supportsAlpha) {\n            return colorToObjectRgbaString(value, type);\n        }\n        return colorToObjectRgbString(value, type);\n    };\n}\nconst ObjectColorInputPlugin = createPlugin({\n    id: 'input-color-object',\n    type: 'input',\n    accept: (value, params) => {\n        var _a;\n        if (!isColorObject(value)) {\n            return null;\n        }\n        const result = parseColorInputParams(params);\n        return result\n            ? {\n                initialValue: value,\n                params: Object.assign(Object.assign({}, result), { colorType: (_a = extractColorType(params)) !== null && _a !== void 0 ? _a : 'int' }),\n            }\n            : null;\n    },\n    binding: {\n        reader: (args) => createColorObjectBindingReader(args.params.colorType),\n        equals: equalsColor,\n        writer: (args) => createColorObjectWriter(shouldSupportAlpha(args.initialValue), args.params.colorType),\n    },\n    controller: (args) => {\n        var _a, _b;\n        const supportsAlpha = isRgbaColorObject(args.initialValue);\n        return new ColorController(args.document, {\n            colorType: args.params.colorType,\n            expanded: (_a = args.params.expanded) !== null && _a !== void 0 ? _a : false,\n            formatter: createColorObjectFormatter(supportsAlpha, args.params.colorType),\n            parser: createColorStringParser('int'),\n            pickerLayout: (_b = args.params.picker) !== null && _b !== void 0 ? _b : 'popup',\n            supportsAlpha: supportsAlpha,\n            value: args.value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nconst StringColorInputPlugin = createPlugin({\n    id: 'input-color-string',\n    type: 'input',\n    accept: (value, params) => {\n        if (typeof value !== 'string') {\n            return null;\n        }\n        if (params.view === 'text') {\n            return null;\n        }\n        const format = detectStringColorFormat(value, extractColorType(params));\n        if (!format) {\n            return null;\n        }\n        const stringifier = findColorStringifier(format);\n        if (!stringifier) {\n            return null;\n        }\n        const result = parseColorInputParams(params);\n        return result\n            ? {\n                initialValue: value,\n                params: Object.assign(Object.assign({}, result), { format: format, stringifier: stringifier }),\n            }\n            : null;\n    },\n    binding: {\n        reader: () => readIntColorString,\n        equals: equalsColor,\n        writer: (args) => {\n            const writer = createColorStringWriter(args.params.format);\n            if (!writer) {\n                throw TpError.notBindable();\n            }\n            return writer;\n        },\n    },\n    controller: (args) => {\n        var _a, _b;\n        return new ColorController(args.document, {\n            colorType: args.params.format.type,\n            expanded: (_a = args.params.expanded) !== null && _a !== void 0 ? _a : false,\n            formatter: args.params.stringifier,\n            parser: createColorStringParser('int'),\n            pickerLayout: (_b = args.params.picker) !== null && _b !== void 0 ? _b : 'popup',\n            supportsAlpha: args.params.format.alpha,\n            value: args.value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nclass PointNdConstraint {\n    constructor(config) {\n        this.components = config.components;\n        this.asm_ = config.assembly;\n    }\n    constrain(value) {\n        const comps = this.asm_\n            .toComponents(value)\n            .map((comp, index) => { var _a, _b; return (_b = (_a = this.components[index]) === null || _a === void 0 ? void 0 : _a.constrain(comp)) !== null && _b !== void 0 ? _b : comp; });\n        return this.asm_.fromComponents(comps);\n    }\n}\n\nconst cn$6 = ClassName('pndtxt');\nclass PointNdTextView {\n    constructor(doc, config) {\n        this.textViews = config.textViews;\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$6());\n        this.textViews.forEach((v) => {\n            const axisElem = doc.createElement('div');\n            axisElem.classList.add(cn$6('a'));\n            axisElem.appendChild(v.element);\n            this.element.appendChild(axisElem);\n        });\n    }\n}\n\nfunction createAxisController(doc, config, index) {\n    return new NumberTextController(doc, {\n        arrayPosition: index === 0 ? 'fst' : index === config.axes.length - 1 ? 'lst' : 'mid',\n        parser: config.parser,\n        props: config.axes[index].textProps,\n        value: createValue(0, {\n            constraint: config.axes[index].constraint,\n        }),\n        viewProps: config.viewProps,\n    });\n}\nclass PointNdTextController {\n    constructor(doc, config) {\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.acs_ = config.axes.map((_, index) => createAxisController(doc, config, index));\n        this.acs_.forEach((c, index) => {\n            connectValues({\n                primary: this.value,\n                secondary: c.value,\n                forward: (p) => config.assembly.toComponents(p)[index],\n                backward: (p, s) => {\n                    const comps = config.assembly.toComponents(p);\n                    comps[index] = s;\n                    return config.assembly.fromComponents(comps);\n                },\n            });\n        });\n        this.view = new PointNdTextView(doc, {\n            textViews: this.acs_.map((ac) => ac.view),\n        });\n    }\n    get textControllers() {\n        return this.acs_;\n    }\n}\n\nclass SliderInputBindingApi extends BindingApi {\n    get max() {\n        return this.controller.valueController.sliderController.props.get('max');\n    }\n    set max(max) {\n        this.controller.valueController.sliderController.props.set('max', max);\n    }\n    get min() {\n        return this.controller.valueController.sliderController.props.get('min');\n    }\n    set min(max) {\n        this.controller.valueController.sliderController.props.set('min', max);\n    }\n}\n\nfunction createConstraint$4(params, initialValue) {\n    const constraints = [];\n    const sc = createStepConstraint(params, initialValue);\n    if (sc) {\n        constraints.push(sc);\n    }\n    const rc = createRangeConstraint(params);\n    if (rc) {\n        constraints.push(rc);\n    }\n    const lc = createListConstraint(params.options);\n    if (lc) {\n        constraints.push(lc);\n    }\n    return new CompositeConstraint(constraints);\n}\nconst NumberInputPlugin = createPlugin({\n    id: 'input-number',\n    type: 'input',\n    accept: (value, params) => {\n        if (typeof value !== 'number') {\n            return null;\n        }\n        const result = parseRecord(params, (p) => (Object.assign(Object.assign({}, createNumberTextInputParamsParser(p)), { options: p.optional.custom(parseListOptions), readonly: p.optional.constant(false) })));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: (_args) => numberFromUnknown,\n        constraint: (args) => createConstraint$4(args.params, args.initialValue),\n        writer: (_args) => writePrimitive,\n    },\n    controller: (args) => {\n        const value = args.value;\n        const c = args.constraint;\n        const lc = c && findConstraint(c, ListConstraint);\n        if (lc) {\n            return new ListController(args.document, {\n                props: new ValueMap({\n                    options: lc.values.value('options'),\n                }),\n                value: value,\n                viewProps: args.viewProps,\n            });\n        }\n        const textPropsObj = createNumberTextPropsObject(args.params, value.rawValue);\n        const drc = c && findConstraint(c, DefiniteRangeConstraint);\n        if (drc) {\n            return new SliderTextController(args.document, Object.assign(Object.assign({}, createSliderTextProps(Object.assign(Object.assign({}, textPropsObj), { keyScale: createValue(textPropsObj.keyScale), max: drc.values.value('max'), min: drc.values.value('min') }))), { parser: parseNumber, value: value, viewProps: args.viewProps }));\n        }\n        return new NumberTextController(args.document, {\n            parser: parseNumber,\n            props: ValueMap.fromObject(textPropsObj),\n            value: value,\n            viewProps: args.viewProps,\n        });\n    },\n    api(args) {\n        if (typeof args.controller.value.rawValue !== 'number') {\n            return null;\n        }\n        if (args.controller.valueController instanceof SliderTextController) {\n            return new SliderInputBindingApi(args.controller);\n        }\n        if (args.controller.valueController instanceof ListController) {\n            return new ListInputBindingApi(args.controller);\n        }\n        return null;\n    },\n});\n\nclass Point2d {\n    constructor(x = 0, y = 0) {\n        this.x = x;\n        this.y = y;\n    }\n    getComponents() {\n        return [this.x, this.y];\n    }\n    static isObject(obj) {\n        if (isEmpty(obj)) {\n            return false;\n        }\n        const x = obj.x;\n        const y = obj.y;\n        if (typeof x !== 'number' || typeof y !== 'number') {\n            return false;\n        }\n        return true;\n    }\n    static equals(v1, v2) {\n        return v1.x === v2.x && v1.y === v2.y;\n    }\n    toObject() {\n        return {\n            x: this.x,\n            y: this.y,\n        };\n    }\n}\nconst Point2dAssembly = {\n    toComponents: (p) => p.getComponents(),\n    fromComponents: (comps) => new Point2d(...comps),\n};\n\nconst cn$5 = ClassName('p2d');\nclass Point2dView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$5());\n        config.viewProps.bindClassModifiers(this.element);\n        bindValue(config.expanded, valueToClassName(this.element, cn$5(undefined, 'expanded')));\n        const headElem = doc.createElement('div');\n        headElem.classList.add(cn$5('h'));\n        this.element.appendChild(headElem);\n        const buttonElem = doc.createElement('button');\n        buttonElem.classList.add(cn$5('b'));\n        buttonElem.appendChild(createSvgIconElement(doc, 'p2dpad'));\n        config.viewProps.bindDisabled(buttonElem);\n        headElem.appendChild(buttonElem);\n        this.buttonElement = buttonElem;\n        const textElem = doc.createElement('div');\n        textElem.classList.add(cn$5('t'));\n        headElem.appendChild(textElem);\n        this.textElement = textElem;\n        if (config.pickerLayout === 'inline') {\n            const pickerElem = doc.createElement('div');\n            pickerElem.classList.add(cn$5('p'));\n            this.element.appendChild(pickerElem);\n            this.pickerElement = pickerElem;\n        }\n        else {\n            this.pickerElement = null;\n        }\n    }\n}\n\nconst cn$4 = ClassName('p2dp');\nclass Point2dPickerView {\n    constructor(doc, config) {\n        this.onFoldableChange_ = this.onFoldableChange_.bind(this);\n        this.onPropsChange_ = this.onPropsChange_.bind(this);\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.props_ = config.props;\n        this.props_.emitter.on('change', this.onPropsChange_);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$4());\n        if (config.layout === 'popup') {\n            this.element.classList.add(cn$4(undefined, 'p'));\n        }\n        config.viewProps.bindClassModifiers(this.element);\n        const padElem = doc.createElement('div');\n        padElem.classList.add(cn$4('p'));\n        config.viewProps.bindTabIndex(padElem);\n        this.element.appendChild(padElem);\n        this.padElement = padElem;\n        const svgElem = doc.createElementNS(SVG_NS, 'svg');\n        svgElem.classList.add(cn$4('g'));\n        this.padElement.appendChild(svgElem);\n        this.svgElem_ = svgElem;\n        const xAxisElem = doc.createElementNS(SVG_NS, 'line');\n        xAxisElem.classList.add(cn$4('ax'));\n        xAxisElem.setAttributeNS(null, 'x1', '0');\n        xAxisElem.setAttributeNS(null, 'y1', '50%');\n        xAxisElem.setAttributeNS(null, 'x2', '100%');\n        xAxisElem.setAttributeNS(null, 'y2', '50%');\n        this.svgElem_.appendChild(xAxisElem);\n        const yAxisElem = doc.createElementNS(SVG_NS, 'line');\n        yAxisElem.classList.add(cn$4('ax'));\n        yAxisElem.setAttributeNS(null, 'x1', '50%');\n        yAxisElem.setAttributeNS(null, 'y1', '0');\n        yAxisElem.setAttributeNS(null, 'x2', '50%');\n        yAxisElem.setAttributeNS(null, 'y2', '100%');\n        this.svgElem_.appendChild(yAxisElem);\n        const lineElem = doc.createElementNS(SVG_NS, 'line');\n        lineElem.classList.add(cn$4('l'));\n        lineElem.setAttributeNS(null, 'x1', '50%');\n        lineElem.setAttributeNS(null, 'y1', '50%');\n        this.svgElem_.appendChild(lineElem);\n        this.lineElem_ = lineElem;\n        const markerElem = doc.createElement('div');\n        markerElem.classList.add(cn$4('m'));\n        this.padElement.appendChild(markerElem);\n        this.markerElem_ = markerElem;\n        config.value.emitter.on('change', this.onValueChange_);\n        this.value = config.value;\n        this.update_();\n    }\n    get allFocusableElements() {\n        return [this.padElement];\n    }\n    update_() {\n        const [x, y] = this.value.rawValue.getComponents();\n        const max = this.props_.get('max');\n        const px = mapRange(x, -max, +max, 0, 100);\n        const py = mapRange(y, -max, +max, 0, 100);\n        const ipy = this.props_.get('invertsY') ? 100 - py : py;\n        this.lineElem_.setAttributeNS(null, 'x2', `${px}%`);\n        this.lineElem_.setAttributeNS(null, 'y2', `${ipy}%`);\n        this.markerElem_.style.left = `${px}%`;\n        this.markerElem_.style.top = `${ipy}%`;\n    }\n    onValueChange_() {\n        this.update_();\n    }\n    onPropsChange_() {\n        this.update_();\n    }\n    onFoldableChange_() {\n        this.update_();\n    }\n}\n\nfunction computeOffset(ev, keyScales, invertsY) {\n    return [\n        getStepForKey(keyScales[0], getHorizontalStepKeys(ev)),\n        getStepForKey(keyScales[1], getVerticalStepKeys(ev)) * (invertsY ? 1 : -1),\n    ];\n}\nclass Point2dPickerController {\n    constructor(doc, config) {\n        this.onPadKeyDown_ = this.onPadKeyDown_.bind(this);\n        this.onPadKeyUp_ = this.onPadKeyUp_.bind(this);\n        this.onPointerDown_ = this.onPointerDown_.bind(this);\n        this.onPointerMove_ = this.onPointerMove_.bind(this);\n        this.onPointerUp_ = this.onPointerUp_.bind(this);\n        this.props = config.props;\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new Point2dPickerView(doc, {\n            layout: config.layout,\n            props: this.props,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.ptHandler_ = new PointerHandler(this.view.padElement);\n        this.ptHandler_.emitter.on('down', this.onPointerDown_);\n        this.ptHandler_.emitter.on('move', this.onPointerMove_);\n        this.ptHandler_.emitter.on('up', this.onPointerUp_);\n        this.view.padElement.addEventListener('keydown', this.onPadKeyDown_);\n        this.view.padElement.addEventListener('keyup', this.onPadKeyUp_);\n    }\n    handlePointerEvent_(d, opts) {\n        if (!d.point) {\n            return;\n        }\n        const max = this.props.get('max');\n        const px = mapRange(d.point.x, 0, d.bounds.width, -max, +max);\n        const py = mapRange(this.props.get('invertsY') ? d.bounds.height - d.point.y : d.point.y, 0, d.bounds.height, -max, +max);\n        this.value.setRawValue(new Point2d(px, py), opts);\n    }\n    onPointerDown_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerMove_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerUp_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n    onPadKeyDown_(ev) {\n        if (isArrowKey(ev.key)) {\n            ev.preventDefault();\n        }\n        const [dx, dy] = computeOffset(ev, [this.props.get('xKeyScale'), this.props.get('yKeyScale')], this.props.get('invertsY'));\n        if (dx === 0 && dy === 0) {\n            return;\n        }\n        this.value.setRawValue(new Point2d(this.value.rawValue.x + dx, this.value.rawValue.y + dy), {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPadKeyUp_(ev) {\n        const [dx, dy] = computeOffset(ev, [this.props.get('xKeyScale'), this.props.get('yKeyScale')], this.props.get('invertsY'));\n        if (dx === 0 && dy === 0) {\n            return;\n        }\n        this.value.setRawValue(this.value.rawValue, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n}\n\nclass Point2dController {\n    constructor(doc, config) {\n        var _a, _b;\n        this.onPopupChildBlur_ = this.onPopupChildBlur_.bind(this);\n        this.onPopupChildKeydown_ = this.onPopupChildKeydown_.bind(this);\n        this.onPadButtonBlur_ = this.onPadButtonBlur_.bind(this);\n        this.onPadButtonClick_ = this.onPadButtonClick_.bind(this);\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.foldable_ = Foldable.create(config.expanded);\n        this.popC_ =\n            config.pickerLayout === 'popup'\n                ? new PopupController(doc, {\n                    viewProps: this.viewProps,\n                })\n                : null;\n        const padC = new Point2dPickerController(doc, {\n            layout: config.pickerLayout,\n            props: new ValueMap({\n                invertsY: createValue(config.invertsY),\n                max: createValue(config.max),\n                xKeyScale: config.axes[0].textProps.value('keyScale'),\n                yKeyScale: config.axes[1].textProps.value('keyScale'),\n            }),\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        padC.view.allFocusableElements.forEach((elem) => {\n            elem.addEventListener('blur', this.onPopupChildBlur_);\n            elem.addEventListener('keydown', this.onPopupChildKeydown_);\n        });\n        this.pickerC_ = padC;\n        this.textC_ = new PointNdTextController(doc, {\n            assembly: Point2dAssembly,\n            axes: config.axes,\n            parser: config.parser,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view = new Point2dView(doc, {\n            expanded: this.foldable_.value('expanded'),\n            pickerLayout: config.pickerLayout,\n            viewProps: this.viewProps,\n        });\n        this.view.textElement.appendChild(this.textC_.view.element);\n        (_a = this.view.buttonElement) === null || _a === void 0 ? void 0 : _a.addEventListener('blur', this.onPadButtonBlur_);\n        (_b = this.view.buttonElement) === null || _b === void 0 ? void 0 : _b.addEventListener('click', this.onPadButtonClick_);\n        if (this.popC_) {\n            this.view.element.appendChild(this.popC_.view.element);\n            this.popC_.view.element.appendChild(this.pickerC_.view.element);\n            connectValues({\n                primary: this.foldable_.value('expanded'),\n                secondary: this.popC_.shows,\n                forward: (p) => p,\n                backward: (_, s) => s,\n            });\n        }\n        else if (this.view.pickerElement) {\n            this.view.pickerElement.appendChild(this.pickerC_.view.element);\n            bindFoldable(this.foldable_, this.view.pickerElement);\n        }\n    }\n    get textController() {\n        return this.textC_;\n    }\n    onPadButtonBlur_(e) {\n        if (!this.popC_) {\n            return;\n        }\n        const elem = this.view.element;\n        const nextTarget = forceCast(e.relatedTarget);\n        if (!nextTarget || !elem.contains(nextTarget)) {\n            this.popC_.shows.rawValue = false;\n        }\n    }\n    onPadButtonClick_() {\n        this.foldable_.set('expanded', !this.foldable_.get('expanded'));\n        if (this.foldable_.get('expanded')) {\n            this.pickerC_.view.allFocusableElements[0].focus();\n        }\n    }\n    onPopupChildBlur_(ev) {\n        if (!this.popC_) {\n            return;\n        }\n        const elem = this.popC_.view.element;\n        const nextTarget = findNextTarget(ev);\n        if (nextTarget && elem.contains(nextTarget)) {\n            return;\n        }\n        if (nextTarget &&\n            nextTarget === this.view.buttonElement &&\n            !supportsTouch(elem.ownerDocument)) {\n            return;\n        }\n        this.popC_.shows.rawValue = false;\n    }\n    onPopupChildKeydown_(ev) {\n        if (this.popC_) {\n            if (ev.key === 'Escape') {\n                this.popC_.shows.rawValue = false;\n            }\n        }\n        else if (this.view.pickerElement) {\n            if (ev.key === 'Escape') {\n                this.view.buttonElement.focus();\n            }\n        }\n    }\n}\n\nfunction point2dFromUnknown(value) {\n    return Point2d.isObject(value)\n        ? new Point2d(value.x, value.y)\n        : new Point2d();\n}\nfunction writePoint2d(target, value) {\n    target.writeProperty('x', value.x);\n    target.writeProperty('y', value.y);\n}\n\nfunction createConstraint$3(params, initialValue) {\n    return new PointNdConstraint({\n        assembly: Point2dAssembly,\n        components: [\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.x), initialValue.x),\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.y), initialValue.y),\n        ],\n    });\n}\nfunction getSuitableMaxDimensionValue(params, rawValue) {\n    var _a, _b;\n    if (!isEmpty(params.min) || !isEmpty(params.max)) {\n        return Math.max(Math.abs((_a = params.min) !== null && _a !== void 0 ? _a : 0), Math.abs((_b = params.max) !== null && _b !== void 0 ? _b : 0));\n    }\n    const step = getSuitableKeyScale(params);\n    return Math.max(Math.abs(step) * 10, Math.abs(rawValue) * 10);\n}\nfunction getSuitableMax(params, initialValue) {\n    var _a, _b;\n    const xr = getSuitableMaxDimensionValue(deepMerge(params, ((_a = params.x) !== null && _a !== void 0 ? _a : {})), initialValue.x);\n    const yr = getSuitableMaxDimensionValue(deepMerge(params, ((_b = params.y) !== null && _b !== void 0 ? _b : {})), initialValue.y);\n    return Math.max(xr, yr);\n}\nfunction shouldInvertY(params) {\n    if (!('y' in params)) {\n        return false;\n    }\n    const yParams = params.y;\n    if (!yParams) {\n        return false;\n    }\n    return 'inverted' in yParams ? !!yParams.inverted : false;\n}\nconst Point2dInputPlugin = createPlugin({\n    id: 'input-point2d',\n    type: 'input',\n    accept: (value, params) => {\n        if (!Point2d.isObject(value)) {\n            return null;\n        }\n        const result = parseRecord(params, (p) => (Object.assign(Object.assign({}, createPointDimensionParser(p)), { expanded: p.optional.boolean, picker: p.optional.custom(parsePickerLayout), readonly: p.optional.constant(false), x: p.optional.custom(parsePointDimensionParams), y: p.optional.object(Object.assign(Object.assign({}, createPointDimensionParser(p)), { inverted: p.optional.boolean })) })));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: () => point2dFromUnknown,\n        constraint: (args) => createConstraint$3(args.params, args.initialValue),\n        equals: Point2d.equals,\n        writer: () => writePoint2d,\n    },\n    controller: (args) => {\n        var _a, _b;\n        const doc = args.document;\n        const value = args.value;\n        const c = args.constraint;\n        const dParams = [args.params.x, args.params.y];\n        return new Point2dController(doc, {\n            axes: value.rawValue.getComponents().map((comp, i) => {\n                var _a;\n                return createPointAxis({\n                    constraint: c.components[i],\n                    initialValue: comp,\n                    params: deepMerge(args.params, ((_a = dParams[i]) !== null && _a !== void 0 ? _a : {})),\n                });\n            }),\n            expanded: (_a = args.params.expanded) !== null && _a !== void 0 ? _a : false,\n            invertsY: shouldInvertY(args.params),\n            max: getSuitableMax(args.params, value.rawValue),\n            parser: parseNumber,\n            pickerLayout: (_b = args.params.picker) !== null && _b !== void 0 ? _b : 'popup',\n            value: value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nclass Point3d {\n    constructor(x = 0, y = 0, z = 0) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n    }\n    getComponents() {\n        return [this.x, this.y, this.z];\n    }\n    static isObject(obj) {\n        if (isEmpty(obj)) {\n            return false;\n        }\n        const x = obj.x;\n        const y = obj.y;\n        const z = obj.z;\n        if (typeof x !== 'number' ||\n            typeof y !== 'number' ||\n            typeof z !== 'number') {\n            return false;\n        }\n        return true;\n    }\n    static equals(v1, v2) {\n        return v1.x === v2.x && v1.y === v2.y && v1.z === v2.z;\n    }\n    toObject() {\n        return {\n            x: this.x,\n            y: this.y,\n            z: this.z,\n        };\n    }\n}\nconst Point3dAssembly = {\n    toComponents: (p) => p.getComponents(),\n    fromComponents: (comps) => new Point3d(...comps),\n};\n\nfunction point3dFromUnknown(value) {\n    return Point3d.isObject(value)\n        ? new Point3d(value.x, value.y, value.z)\n        : new Point3d();\n}\nfunction writePoint3d(target, value) {\n    target.writeProperty('x', value.x);\n    target.writeProperty('y', value.y);\n    target.writeProperty('z', value.z);\n}\n\nfunction createConstraint$2(params, initialValue) {\n    return new PointNdConstraint({\n        assembly: Point3dAssembly,\n        components: [\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.x), initialValue.x),\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.y), initialValue.y),\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.z), initialValue.z),\n        ],\n    });\n}\nconst Point3dInputPlugin = createPlugin({\n    id: 'input-point3d',\n    type: 'input',\n    accept: (value, params) => {\n        if (!Point3d.isObject(value)) {\n            return null;\n        }\n        const result = parseRecord(params, (p) => (Object.assign(Object.assign({}, createPointDimensionParser(p)), { readonly: p.optional.constant(false), x: p.optional.custom(parsePointDimensionParams), y: p.optional.custom(parsePointDimensionParams), z: p.optional.custom(parsePointDimensionParams) })));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: (_args) => point3dFromUnknown,\n        constraint: (args) => createConstraint$2(args.params, args.initialValue),\n        equals: Point3d.equals,\n        writer: (_args) => writePoint3d,\n    },\n    controller: (args) => {\n        const value = args.value;\n        const c = args.constraint;\n        const dParams = [args.params.x, args.params.y, args.params.z];\n        return new PointNdTextController(args.document, {\n            assembly: Point3dAssembly,\n            axes: value.rawValue.getComponents().map((comp, i) => {\n                var _a;\n                return createPointAxis({\n                    constraint: c.components[i],\n                    initialValue: comp,\n                    params: deepMerge(args.params, ((_a = dParams[i]) !== null && _a !== void 0 ? _a : {})),\n                });\n            }),\n            parser: parseNumber,\n            value: value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nclass Point4d {\n    constructor(x = 0, y = 0, z = 0, w = 0) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n        this.w = w;\n    }\n    getComponents() {\n        return [this.x, this.y, this.z, this.w];\n    }\n    static isObject(obj) {\n        if (isEmpty(obj)) {\n            return false;\n        }\n        const x = obj.x;\n        const y = obj.y;\n        const z = obj.z;\n        const w = obj.w;\n        if (typeof x !== 'number' ||\n            typeof y !== 'number' ||\n            typeof z !== 'number' ||\n            typeof w !== 'number') {\n            return false;\n        }\n        return true;\n    }\n    static equals(v1, v2) {\n        return v1.x === v2.x && v1.y === v2.y && v1.z === v2.z && v1.w === v2.w;\n    }\n    toObject() {\n        return {\n            x: this.x,\n            y: this.y,\n            z: this.z,\n            w: this.w,\n        };\n    }\n}\nconst Point4dAssembly = {\n    toComponents: (p) => p.getComponents(),\n    fromComponents: (comps) => new Point4d(...comps),\n};\n\nfunction point4dFromUnknown(value) {\n    return Point4d.isObject(value)\n        ? new Point4d(value.x, value.y, value.z, value.w)\n        : new Point4d();\n}\nfunction writePoint4d(target, value) {\n    target.writeProperty('x', value.x);\n    target.writeProperty('y', value.y);\n    target.writeProperty('z', value.z);\n    target.writeProperty('w', value.w);\n}\n\nfunction createConstraint$1(params, initialValue) {\n    return new PointNdConstraint({\n        assembly: Point4dAssembly,\n        components: [\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.x), initialValue.x),\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.y), initialValue.y),\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.z), initialValue.z),\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.w), initialValue.w),\n        ],\n    });\n}\nconst Point4dInputPlugin = createPlugin({\n    id: 'input-point4d',\n    type: 'input',\n    accept: (value, params) => {\n        if (!Point4d.isObject(value)) {\n            return null;\n        }\n        const result = parseRecord(params, (p) => (Object.assign(Object.assign({}, createPointDimensionParser(p)), { readonly: p.optional.constant(false), w: p.optional.custom(parsePointDimensionParams), x: p.optional.custom(parsePointDimensionParams), y: p.optional.custom(parsePointDimensionParams), z: p.optional.custom(parsePointDimensionParams) })));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: (_args) => point4dFromUnknown,\n        constraint: (args) => createConstraint$1(args.params, args.initialValue),\n        equals: Point4d.equals,\n        writer: (_args) => writePoint4d,\n    },\n    controller: (args) => {\n        const value = args.value;\n        const c = args.constraint;\n        const dParams = [\n            args.params.x,\n            args.params.y,\n            args.params.z,\n            args.params.w,\n        ];\n        return new PointNdTextController(args.document, {\n            assembly: Point4dAssembly,\n            axes: value.rawValue.getComponents().map((comp, i) => {\n                var _a;\n                return createPointAxis({\n                    constraint: c.components[i],\n                    initialValue: comp,\n                    params: deepMerge(args.params, ((_a = dParams[i]) !== null && _a !== void 0 ? _a : {})),\n                });\n            }),\n            parser: parseNumber,\n            value: value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nfunction createConstraint(params) {\n    const constraints = [];\n    const lc = createListConstraint(params.options);\n    if (lc) {\n        constraints.push(lc);\n    }\n    return new CompositeConstraint(constraints);\n}\nconst StringInputPlugin = createPlugin({\n    id: 'input-string',\n    type: 'input',\n    accept: (value, params) => {\n        if (typeof value !== 'string') {\n            return null;\n        }\n        const result = parseRecord(params, (p) => ({\n            readonly: p.optional.constant(false),\n            options: p.optional.custom(parseListOptions),\n        }));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: (_args) => stringFromUnknown,\n        constraint: (args) => createConstraint(args.params),\n        writer: (_args) => writePrimitive,\n    },\n    controller: (args) => {\n        const doc = args.document;\n        const value = args.value;\n        const c = args.constraint;\n        const lc = c && findConstraint(c, ListConstraint);\n        if (lc) {\n            return new ListController(doc, {\n                props: new ValueMap({\n                    options: lc.values.value('options'),\n                }),\n                value: value,\n                viewProps: args.viewProps,\n            });\n        }\n        return new TextController(doc, {\n            parser: (v) => v,\n            props: ValueMap.fromObject({\n                formatter: formatString,\n            }),\n            value: value,\n            viewProps: args.viewProps,\n        });\n    },\n    api(args) {\n        if (typeof args.controller.value.rawValue !== 'string') {\n            return null;\n        }\n        if (args.controller.valueController instanceof ListController) {\n            return new ListInputBindingApi(args.controller);\n        }\n        return null;\n    },\n});\n\nconst Constants = {\n    monitor: {\n        defaultInterval: 200,\n        defaultRows: 3,\n    },\n};\n\nconst cn$3 = ClassName('mll');\nclass MultiLogView {\n    constructor(doc, config) {\n        this.onValueUpdate_ = this.onValueUpdate_.bind(this);\n        this.formatter_ = config.formatter;\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$3());\n        config.viewProps.bindClassModifiers(this.element);\n        const textareaElem = doc.createElement('textarea');\n        textareaElem.classList.add(cn$3('i'));\n        textareaElem.style.height = `calc(var(${getCssVar('containerUnitSize')}) * ${config.rows})`;\n        textareaElem.readOnly = true;\n        config.viewProps.bindDisabled(textareaElem);\n        this.element.appendChild(textareaElem);\n        this.textareaElem_ = textareaElem;\n        config.value.emitter.on('change', this.onValueUpdate_);\n        this.value = config.value;\n        this.update_();\n    }\n    update_() {\n        const elem = this.textareaElem_;\n        const shouldScroll = elem.scrollTop === elem.scrollHeight - elem.clientHeight;\n        const lines = [];\n        this.value.rawValue.forEach((value) => {\n            if (value !== undefined) {\n                lines.push(this.formatter_(value));\n            }\n        });\n        elem.textContent = lines.join('\\n');\n        if (shouldScroll) {\n            elem.scrollTop = elem.scrollHeight;\n        }\n    }\n    onValueUpdate_() {\n        this.update_();\n    }\n}\n\nclass MultiLogController {\n    constructor(doc, config) {\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new MultiLogView(doc, {\n            formatter: config.formatter,\n            rows: config.rows,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n    }\n}\n\nconst cn$2 = ClassName('sgl');\nclass SingleLogView {\n    constructor(doc, config) {\n        this.onValueUpdate_ = this.onValueUpdate_.bind(this);\n        this.formatter_ = config.formatter;\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$2());\n        config.viewProps.bindClassModifiers(this.element);\n        const inputElem = doc.createElement('input');\n        inputElem.classList.add(cn$2('i'));\n        inputElem.readOnly = true;\n        inputElem.type = 'text';\n        config.viewProps.bindDisabled(inputElem);\n        this.element.appendChild(inputElem);\n        this.inputElement = inputElem;\n        config.value.emitter.on('change', this.onValueUpdate_);\n        this.value = config.value;\n        this.update_();\n    }\n    update_() {\n        const values = this.value.rawValue;\n        const lastValue = values[values.length - 1];\n        this.inputElement.value =\n            lastValue !== undefined ? this.formatter_(lastValue) : '';\n    }\n    onValueUpdate_() {\n        this.update_();\n    }\n}\n\nclass SingleLogController {\n    constructor(doc, config) {\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new SingleLogView(doc, {\n            formatter: config.formatter,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n    }\n}\n\nconst BooleanMonitorPlugin = createPlugin({\n    id: 'monitor-bool',\n    type: 'monitor',\n    accept: (value, params) => {\n        if (typeof value !== 'boolean') {\n            return null;\n        }\n        const result = parseRecord(params, (p) => ({\n            readonly: p.required.constant(true),\n            rows: p.optional.number,\n        }));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: (_args) => boolFromUnknown,\n    },\n    controller: (args) => {\n        var _a;\n        if (args.value.rawValue.length === 1) {\n            return new SingleLogController(args.document, {\n                formatter: BooleanFormatter,\n                value: args.value,\n                viewProps: args.viewProps,\n            });\n        }\n        return new MultiLogController(args.document, {\n            formatter: BooleanFormatter,\n            rows: (_a = args.params.rows) !== null && _a !== void 0 ? _a : Constants.monitor.defaultRows,\n            value: args.value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nclass GraphLogMonitorBindingApi extends BindingApi {\n    get max() {\n        return this.controller.valueController.props.get('max');\n    }\n    set max(max) {\n        this.controller.valueController.props.set('max', max);\n    }\n    get min() {\n        return this.controller.valueController.props.get('min');\n    }\n    set min(min) {\n        this.controller.valueController.props.set('min', min);\n    }\n}\n\nconst cn$1 = ClassName('grl');\nclass GraphLogView {\n    constructor(doc, config) {\n        this.onCursorChange_ = this.onCursorChange_.bind(this);\n        this.onValueUpdate_ = this.onValueUpdate_.bind(this);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$1());\n        config.viewProps.bindClassModifiers(this.element);\n        this.formatter_ = config.formatter;\n        this.props_ = config.props;\n        this.cursor_ = config.cursor;\n        this.cursor_.emitter.on('change', this.onCursorChange_);\n        const svgElem = doc.createElementNS(SVG_NS, 'svg');\n        svgElem.classList.add(cn$1('g'));\n        svgElem.style.height = `calc(var(${getCssVar('containerUnitSize')}) * ${config.rows})`;\n        this.element.appendChild(svgElem);\n        this.svgElem_ = svgElem;\n        const lineElem = doc.createElementNS(SVG_NS, 'polyline');\n        this.svgElem_.appendChild(lineElem);\n        this.lineElem_ = lineElem;\n        const tooltipElem = doc.createElement('div');\n        tooltipElem.classList.add(cn$1('t'), ClassName('tt')());\n        this.element.appendChild(tooltipElem);\n        this.tooltipElem_ = tooltipElem;\n        config.value.emitter.on('change', this.onValueUpdate_);\n        this.value = config.value;\n        this.update_();\n    }\n    get graphElement() {\n        return this.svgElem_;\n    }\n    update_() {\n        const { clientWidth: w, clientHeight: h } = this.element;\n        const maxIndex = this.value.rawValue.length - 1;\n        const min = this.props_.get('min');\n        const max = this.props_.get('max');\n        const points = [];\n        this.value.rawValue.forEach((v, index) => {\n            if (v === undefined) {\n                return;\n            }\n            const x = mapRange(index, 0, maxIndex, 0, w);\n            const y = mapRange(v, min, max, h, 0);\n            points.push([x, y].join(','));\n        });\n        this.lineElem_.setAttributeNS(null, 'points', points.join(' '));\n        const tooltipElem = this.tooltipElem_;\n        const value = this.value.rawValue[this.cursor_.rawValue];\n        if (value === undefined) {\n            tooltipElem.classList.remove(cn$1('t', 'a'));\n            return;\n        }\n        const tx = mapRange(this.cursor_.rawValue, 0, maxIndex, 0, w);\n        const ty = mapRange(value, min, max, h, 0);\n        tooltipElem.style.left = `${tx}px`;\n        tooltipElem.style.top = `${ty}px`;\n        tooltipElem.textContent = `${this.formatter_(value)}`;\n        if (!tooltipElem.classList.contains(cn$1('t', 'a'))) {\n            tooltipElem.classList.add(cn$1('t', 'a'), cn$1('t', 'in'));\n            forceReflow(tooltipElem);\n            tooltipElem.classList.remove(cn$1('t', 'in'));\n        }\n    }\n    onValueUpdate_() {\n        this.update_();\n    }\n    onCursorChange_() {\n        this.update_();\n    }\n}\n\nclass GraphLogController {\n    constructor(doc, config) {\n        this.onGraphMouseMove_ = this.onGraphMouseMove_.bind(this);\n        this.onGraphMouseLeave_ = this.onGraphMouseLeave_.bind(this);\n        this.onGraphPointerDown_ = this.onGraphPointerDown_.bind(this);\n        this.onGraphPointerMove_ = this.onGraphPointerMove_.bind(this);\n        this.onGraphPointerUp_ = this.onGraphPointerUp_.bind(this);\n        this.props = config.props;\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.cursor_ = createValue(-1);\n        this.view = new GraphLogView(doc, {\n            cursor: this.cursor_,\n            formatter: config.formatter,\n            rows: config.rows,\n            props: this.props,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        if (!supportsTouch(doc)) {\n            this.view.element.addEventListener('mousemove', this.onGraphMouseMove_);\n            this.view.element.addEventListener('mouseleave', this.onGraphMouseLeave_);\n        }\n        else {\n            const ph = new PointerHandler(this.view.element);\n            ph.emitter.on('down', this.onGraphPointerDown_);\n            ph.emitter.on('move', this.onGraphPointerMove_);\n            ph.emitter.on('up', this.onGraphPointerUp_);\n        }\n    }\n    importProps(state) {\n        return importBladeState(state, null, (p) => ({\n            max: p.required.number,\n            min: p.required.number,\n        }), (result) => {\n            this.props.set('max', result.max);\n            this.props.set('min', result.min);\n            return true;\n        });\n    }\n    exportProps() {\n        return exportBladeState(null, {\n            max: this.props.get('max'),\n            min: this.props.get('min'),\n        });\n    }\n    onGraphMouseLeave_() {\n        this.cursor_.rawValue = -1;\n    }\n    onGraphMouseMove_(ev) {\n        const { clientWidth: w } = this.view.element;\n        this.cursor_.rawValue = Math.floor(mapRange(ev.offsetX, 0, w, 0, this.value.rawValue.length));\n    }\n    onGraphPointerDown_(ev) {\n        this.onGraphPointerMove_(ev);\n    }\n    onGraphPointerMove_(ev) {\n        if (!ev.data.point) {\n            this.cursor_.rawValue = -1;\n            return;\n        }\n        this.cursor_.rawValue = Math.floor(mapRange(ev.data.point.x, 0, ev.data.bounds.width, 0, this.value.rawValue.length));\n    }\n    onGraphPointerUp_() {\n        this.cursor_.rawValue = -1;\n    }\n}\n\nfunction createFormatter(params) {\n    return !isEmpty(params.format) ? params.format : createNumberFormatter(2);\n}\nfunction createTextMonitor(args) {\n    var _a;\n    if (args.value.rawValue.length === 1) {\n        return new SingleLogController(args.document, {\n            formatter: createFormatter(args.params),\n            value: args.value,\n            viewProps: args.viewProps,\n        });\n    }\n    return new MultiLogController(args.document, {\n        formatter: createFormatter(args.params),\n        rows: (_a = args.params.rows) !== null && _a !== void 0 ? _a : Constants.monitor.defaultRows,\n        value: args.value,\n        viewProps: args.viewProps,\n    });\n}\nfunction createGraphMonitor(args) {\n    var _a, _b, _c;\n    return new GraphLogController(args.document, {\n        formatter: createFormatter(args.params),\n        rows: (_a = args.params.rows) !== null && _a !== void 0 ? _a : Constants.monitor.defaultRows,\n        props: ValueMap.fromObject({\n            max: (_b = args.params.max) !== null && _b !== void 0 ? _b : 100,\n            min: (_c = args.params.min) !== null && _c !== void 0 ? _c : 0,\n        }),\n        value: args.value,\n        viewProps: args.viewProps,\n    });\n}\nfunction shouldShowGraph(params) {\n    return params.view === 'graph';\n}\nconst NumberMonitorPlugin = createPlugin({\n    id: 'monitor-number',\n    type: 'monitor',\n    accept: (value, params) => {\n        if (typeof value !== 'number') {\n            return null;\n        }\n        const result = parseRecord(params, (p) => ({\n            format: p.optional.function,\n            max: p.optional.number,\n            min: p.optional.number,\n            readonly: p.required.constant(true),\n            rows: p.optional.number,\n            view: p.optional.string,\n        }));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        defaultBufferSize: (params) => (shouldShowGraph(params) ? 64 : 1),\n        reader: (_args) => numberFromUnknown,\n    },\n    controller: (args) => {\n        if (shouldShowGraph(args.params)) {\n            return createGraphMonitor(args);\n        }\n        return createTextMonitor(args);\n    },\n    api: (args) => {\n        if (args.controller.valueController instanceof GraphLogController) {\n            return new GraphLogMonitorBindingApi(args.controller);\n        }\n        return null;\n    },\n});\n\nconst StringMonitorPlugin = createPlugin({\n    id: 'monitor-string',\n    type: 'monitor',\n    accept: (value, params) => {\n        if (typeof value !== 'string') {\n            return null;\n        }\n        const result = parseRecord(params, (p) => ({\n            multiline: p.optional.boolean,\n            readonly: p.required.constant(true),\n            rows: p.optional.number,\n        }));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: (_args) => stringFromUnknown,\n    },\n    controller: (args) => {\n        var _a;\n        const value = args.value;\n        const multiline = value.rawValue.length > 1 || args.params.multiline;\n        if (multiline) {\n            return new MultiLogController(args.document, {\n                formatter: formatString,\n                rows: (_a = args.params.rows) !== null && _a !== void 0 ? _a : Constants.monitor.defaultRows,\n                value: value,\n                viewProps: args.viewProps,\n            });\n        }\n        return new SingleLogController(args.document, {\n            formatter: formatString,\n            value: value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nclass BladeApiCache {\n    constructor() {\n        this.map_ = new Map();\n    }\n    get(bc) {\n        var _a;\n        return (_a = this.map_.get(bc)) !== null && _a !== void 0 ? _a : null;\n    }\n    has(bc) {\n        return this.map_.has(bc);\n    }\n    add(bc, api) {\n        this.map_.set(bc, api);\n        bc.viewProps.handleDispose(() => {\n            this.map_.delete(bc);\n        });\n        return api;\n    }\n}\n\nclass ReadWriteBinding {\n    constructor(config) {\n        this.target = config.target;\n        this.reader_ = config.reader;\n        this.writer_ = config.writer;\n    }\n    read() {\n        return this.reader_(this.target.read());\n    }\n    write(value) {\n        this.writer_(this.target, value);\n    }\n    inject(value) {\n        this.write(this.reader_(value));\n    }\n}\n\nfunction createInputBindingController(plugin, args) {\n    var _a;\n    const result = plugin.accept(args.target.read(), args.params);\n    if (isEmpty(result)) {\n        return null;\n    }\n    const valueArgs = {\n        target: args.target,\n        initialValue: result.initialValue,\n        params: result.params,\n    };\n    const params = parseRecord(args.params, (p) => ({\n        disabled: p.optional.boolean,\n        hidden: p.optional.boolean,\n        label: p.optional.string,\n        tag: p.optional.string,\n    }));\n    const reader = plugin.binding.reader(valueArgs);\n    const constraint = plugin.binding.constraint\n        ? plugin.binding.constraint(valueArgs)\n        : undefined;\n    const binding = new ReadWriteBinding({\n        reader: reader,\n        target: args.target,\n        writer: plugin.binding.writer(valueArgs),\n    });\n    const value = new InputBindingValue(createValue(reader(result.initialValue), {\n        constraint: constraint,\n        equals: plugin.binding.equals,\n    }), binding);\n    const controller = plugin.controller({\n        constraint: constraint,\n        document: args.document,\n        initialValue: result.initialValue,\n        params: result.params,\n        value: value,\n        viewProps: ViewProps.create({\n            disabled: params === null || params === void 0 ? void 0 : params.disabled,\n            hidden: params === null || params === void 0 ? void 0 : params.hidden,\n        }),\n    });\n    return new InputBindingController(args.document, {\n        blade: createBlade(),\n        props: ValueMap.fromObject({\n            label: 'label' in args.params ? (_a = params === null || params === void 0 ? void 0 : params.label) !== null && _a !== void 0 ? _a : null : args.target.key,\n        }),\n        tag: params === null || params === void 0 ? void 0 : params.tag,\n        value: value,\n        valueController: controller,\n    });\n}\n\nclass ReadonlyBinding {\n    constructor(config) {\n        this.target = config.target;\n        this.reader_ = config.reader;\n    }\n    read() {\n        return this.reader_(this.target.read());\n    }\n}\n\nfunction createTicker(document, interval) {\n    return interval === 0\n        ? new ManualTicker()\n        : new IntervalTicker(document, interval !== null && interval !== void 0 ? interval : Constants.monitor.defaultInterval);\n}\nfunction createMonitorBindingController(plugin, args) {\n    var _a, _b, _c;\n    const result = plugin.accept(args.target.read(), args.params);\n    if (isEmpty(result)) {\n        return null;\n    }\n    const bindingArgs = {\n        target: args.target,\n        initialValue: result.initialValue,\n        params: result.params,\n    };\n    const params = parseRecord(args.params, (p) => ({\n        bufferSize: p.optional.number,\n        disabled: p.optional.boolean,\n        hidden: p.optional.boolean,\n        interval: p.optional.number,\n        label: p.optional.string,\n    }));\n    const reader = plugin.binding.reader(bindingArgs);\n    const bufferSize = (_b = (_a = params === null || params === void 0 ? void 0 : params.bufferSize) !== null && _a !== void 0 ? _a : (plugin.binding.defaultBufferSize &&\n        plugin.binding.defaultBufferSize(result.params))) !== null && _b !== void 0 ? _b : 1;\n    const value = new MonitorBindingValue({\n        binding: new ReadonlyBinding({\n            reader: reader,\n            target: args.target,\n        }),\n        bufferSize: bufferSize,\n        ticker: createTicker(args.document, params === null || params === void 0 ? void 0 : params.interval),\n    });\n    const controller = plugin.controller({\n        document: args.document,\n        params: result.params,\n        value: value,\n        viewProps: ViewProps.create({\n            disabled: params === null || params === void 0 ? void 0 : params.disabled,\n            hidden: params === null || params === void 0 ? void 0 : params.hidden,\n        }),\n    });\n    controller.viewProps.bindDisabled(value.ticker);\n    controller.viewProps.handleDispose(() => {\n        value.ticker.dispose();\n    });\n    return new MonitorBindingController(args.document, {\n        blade: createBlade(),\n        props: ValueMap.fromObject({\n            label: 'label' in args.params ? (_c = params === null || params === void 0 ? void 0 : params.label) !== null && _c !== void 0 ? _c : null : args.target.key,\n        }),\n        value: value,\n        valueController: controller,\n    });\n}\n\nclass PluginPool {\n    constructor(apiCache) {\n        this.pluginsMap_ = {\n            blades: [],\n            inputs: [],\n            monitors: [],\n        };\n        this.apiCache_ = apiCache;\n    }\n    getAll() {\n        return [\n            ...this.pluginsMap_.blades,\n            ...this.pluginsMap_.inputs,\n            ...this.pluginsMap_.monitors,\n        ];\n    }\n    register(bundleId, r) {\n        if (!isCompatible(r.core)) {\n            throw TpError.notCompatible(bundleId, r.id);\n        }\n        if (r.type === 'blade') {\n            this.pluginsMap_.blades.unshift(r);\n        }\n        else if (r.type === 'input') {\n            this.pluginsMap_.inputs.unshift(r);\n        }\n        else if (r.type === 'monitor') {\n            this.pluginsMap_.monitors.unshift(r);\n        }\n    }\n    createInput_(document, target, params) {\n        return this.pluginsMap_.inputs.reduce((result, plugin) => result !== null && result !== void 0 ? result : createInputBindingController(plugin, {\n            document: document,\n            target: target,\n            params: params,\n        }), null);\n    }\n    createMonitor_(document, target, params) {\n        return this.pluginsMap_.monitors.reduce((result, plugin) => result !== null && result !== void 0 ? result : createMonitorBindingController(plugin, {\n            document: document,\n            params: params,\n            target: target,\n        }), null);\n    }\n    createBinding(doc, target, params) {\n        const initialValue = target.read();\n        if (isEmpty(initialValue)) {\n            throw new TpError({\n                context: {\n                    key: target.key,\n                },\n                type: 'nomatchingcontroller',\n            });\n        }\n        const ic = this.createInput_(doc, target, params);\n        if (ic) {\n            return ic;\n        }\n        const mc = this.createMonitor_(doc, target, params);\n        if (mc) {\n            return mc;\n        }\n        throw new TpError({\n            context: {\n                key: target.key,\n            },\n            type: 'nomatchingcontroller',\n        });\n    }\n    createBlade(document, params) {\n        const bc = this.pluginsMap_.blades.reduce((result, plugin) => result !== null && result !== void 0 ? result : createBladeController(plugin, {\n            document: document,\n            params: params,\n        }), null);\n        if (!bc) {\n            throw new TpError({\n                type: 'nomatchingview',\n                context: {\n                    params: params,\n                },\n            });\n        }\n        return bc;\n    }\n    createInputBindingApi_(bc) {\n        const api = this.pluginsMap_.inputs.reduce((result, plugin) => {\n            var _a, _b;\n            if (result) {\n                return result;\n            }\n            return ((_b = (_a = plugin.api) === null || _a === void 0 ? void 0 : _a.call(plugin, {\n                controller: bc,\n            })) !== null && _b !== void 0 ? _b : null);\n        }, null);\n        return this.apiCache_.add(bc, api !== null && api !== void 0 ? api : new BindingApi(bc));\n    }\n    createMonitorBindingApi_(bc) {\n        const api = this.pluginsMap_.monitors.reduce((result, plugin) => {\n            var _a, _b;\n            if (result) {\n                return result;\n            }\n            return ((_b = (_a = plugin.api) === null || _a === void 0 ? void 0 : _a.call(plugin, {\n                controller: bc,\n            })) !== null && _b !== void 0 ? _b : null);\n        }, null);\n        return this.apiCache_.add(bc, api !== null && api !== void 0 ? api : new BindingApi(bc));\n    }\n    createBindingApi(bc) {\n        if (this.apiCache_.has(bc)) {\n            return this.apiCache_.get(bc);\n        }\n        if (isInputBindingController(bc)) {\n            return this.createInputBindingApi_(bc);\n        }\n        if (isMonitorBindingController(bc)) {\n            return this.createMonitorBindingApi_(bc);\n        }\n        throw TpError.shouldNeverHappen();\n    }\n    createApi(bc) {\n        if (this.apiCache_.has(bc)) {\n            return this.apiCache_.get(bc);\n        }\n        if (isBindingController(bc)) {\n            return this.createBindingApi(bc);\n        }\n        const api = this.pluginsMap_.blades.reduce((result, plugin) => result !== null && result !== void 0 ? result : plugin.api({\n            controller: bc,\n            pool: this,\n        }), null);\n        if (!api) {\n            throw TpError.shouldNeverHappen();\n        }\n        return this.apiCache_.add(bc, api);\n    }\n}\n\nconst sharedCache = new BladeApiCache();\nfunction createDefaultPluginPool() {\n    const pool = new PluginPool(sharedCache);\n    [\n        Point2dInputPlugin,\n        Point3dInputPlugin,\n        Point4dInputPlugin,\n        StringInputPlugin,\n        NumberInputPlugin,\n        StringColorInputPlugin,\n        ObjectColorInputPlugin,\n        NumberColorInputPlugin,\n        BooleanInputPlugin,\n        BooleanMonitorPlugin,\n        StringMonitorPlugin,\n        NumberMonitorPlugin,\n        ButtonBladePlugin,\n        FolderBladePlugin,\n        TabBladePlugin,\n    ].forEach((p) => {\n        pool.register('core', p);\n    });\n    return pool;\n}\n\nclass ListBladeApi extends BladeApi {\n    /**\n     * @hidden\n     */\n    constructor(controller) {\n        super(controller);\n        this.emitter_ = new Emitter();\n        this.controller.value.emitter.on('change', (ev) => {\n            this.emitter_.emit('change', new TpChangeEvent(this, ev.rawValue));\n        });\n    }\n    get label() {\n        return this.controller.labelController.props.get('label');\n    }\n    set label(label) {\n        this.controller.labelController.props.set('label', label);\n    }\n    get options() {\n        return this.controller.valueController.props.get('options');\n    }\n    set options(options) {\n        this.controller.valueController.props.set('options', options);\n    }\n    get value() {\n        return this.controller.value.rawValue;\n    }\n    set value(value) {\n        this.controller.value.rawValue = value;\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        this.emitter_.on(eventName, (ev) => {\n            bh(ev);\n        }, {\n            key: handler,\n        });\n        return this;\n    }\n    off(eventName, handler) {\n        this.emitter_.off(eventName, handler);\n        return this;\n    }\n}\n\nclass SeparatorBladeApi extends BladeApi {\n}\n\nclass SliderBladeApi extends BladeApi {\n    /**\n     * @hidden\n     */\n    constructor(controller) {\n        super(controller);\n        this.emitter_ = new Emitter();\n        this.controller.value.emitter.on('change', (ev) => {\n            this.emitter_.emit('change', new TpChangeEvent(this, ev.rawValue));\n        });\n    }\n    get label() {\n        return this.controller.labelController.props.get('label');\n    }\n    set label(label) {\n        this.controller.labelController.props.set('label', label);\n    }\n    get max() {\n        return this.controller.valueController.sliderController.props.get('max');\n    }\n    set max(max) {\n        this.controller.valueController.sliderController.props.set('max', max);\n    }\n    get min() {\n        return this.controller.valueController.sliderController.props.get('min');\n    }\n    set min(min) {\n        this.controller.valueController.sliderController.props.set('min', min);\n    }\n    get value() {\n        return this.controller.value.rawValue;\n    }\n    set value(value) {\n        this.controller.value.rawValue = value;\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        this.emitter_.on(eventName, (ev) => {\n            bh(ev);\n        }, {\n            key: handler,\n        });\n        return this;\n    }\n    off(eventName, handler) {\n        this.emitter_.off(eventName, handler);\n        return this;\n    }\n}\n\nclass TextBladeApi extends BladeApi {\n    /**\n     * @hidden\n     */\n    constructor(controller) {\n        super(controller);\n        this.emitter_ = new Emitter();\n        this.controller.value.emitter.on('change', (ev) => {\n            this.emitter_.emit('change', new TpChangeEvent(this, ev.rawValue));\n        });\n    }\n    get label() {\n        return this.controller.labelController.props.get('label');\n    }\n    set label(label) {\n        this.controller.labelController.props.set('label', label);\n    }\n    get formatter() {\n        return this.controller.valueController.props.get('formatter');\n    }\n    set formatter(formatter) {\n        this.controller.valueController.props.set('formatter', formatter);\n    }\n    get value() {\n        return this.controller.value.rawValue;\n    }\n    set value(value) {\n        this.controller.value.rawValue = value;\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        this.emitter_.on(eventName, (ev) => {\n            bh(ev);\n        }, {\n            key: handler,\n        });\n        return this;\n    }\n    off(eventName, handler) {\n        this.emitter_.off(eventName, handler);\n        return this;\n    }\n}\n\nconst ListBladePlugin = (function () {\n    return {\n        id: 'list',\n        type: 'blade',\n        core: VERSION$1,\n        accept(params) {\n            const result = parseRecord(params, (p) => ({\n                options: p.required.custom(parseListOptions),\n                value: p.required.raw,\n                view: p.required.constant('list'),\n                label: p.optional.string,\n            }));\n            return result ? { params: result } : null;\n        },\n        controller(args) {\n            const lc = new ListConstraint(normalizeListOptions(args.params.options));\n            const value = createValue(args.params.value, {\n                constraint: lc,\n            });\n            const ic = new ListController(args.document, {\n                props: new ValueMap({\n                    options: lc.values.value('options'),\n                }),\n                value: value,\n                viewProps: args.viewProps,\n            });\n            return new LabeledValueBladeController(args.document, {\n                blade: args.blade,\n                props: ValueMap.fromObject({\n                    label: args.params.label,\n                }),\n                value: value,\n                valueController: ic,\n            });\n        },\n        api(args) {\n            if (!(args.controller instanceof LabeledValueBladeController)) {\n                return null;\n            }\n            if (!(args.controller.valueController instanceof ListController)) {\n                return null;\n            }\n            return new ListBladeApi(args.controller);\n        },\n    };\n})();\n\nclass RootApi extends FolderApi {\n    /**\n     * @hidden\n     */\n    constructor(controller, pool) {\n        super(controller, pool);\n    }\n    get element() {\n        return this.controller.view.element;\n    }\n}\n\n/**\n * @hidden\n */\nclass RootController extends FolderController {\n    constructor(doc, config) {\n        super(doc, {\n            expanded: config.expanded,\n            blade: config.blade,\n            props: config.props,\n            root: true,\n            viewProps: config.viewProps,\n        });\n    }\n}\n\nconst cn = ClassName('spr');\n/**\n * @hidden\n */\nclass SeparatorView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn());\n        config.viewProps.bindClassModifiers(this.element);\n        const hrElem = doc.createElement('hr');\n        hrElem.classList.add(cn('r'));\n        this.element.appendChild(hrElem);\n    }\n}\n\n/**\n * @hidden\n */\nclass SeparatorController extends BladeController {\n    /**\n     * @hidden\n     */\n    constructor(doc, config) {\n        super(Object.assign(Object.assign({}, config), { view: new SeparatorView(doc, {\n                viewProps: config.viewProps,\n            }) }));\n    }\n}\n\nconst SeparatorBladePlugin = {\n    id: 'separator',\n    type: 'blade',\n    core: VERSION$1,\n    accept(params) {\n        const result = parseRecord(params, (p) => ({\n            view: p.required.constant('separator'),\n        }));\n        return result ? { params: result } : null;\n    },\n    controller(args) {\n        return new SeparatorController(args.document, {\n            blade: args.blade,\n            viewProps: args.viewProps,\n        });\n    },\n    api(args) {\n        if (!(args.controller instanceof SeparatorController)) {\n            return null;\n        }\n        return new SeparatorBladeApi(args.controller);\n    },\n};\n\nconst SliderBladePlugin = {\n    id: 'slider',\n    type: 'blade',\n    core: VERSION$1,\n    accept(params) {\n        const result = parseRecord(params, (p) => ({\n            max: p.required.number,\n            min: p.required.number,\n            view: p.required.constant('slider'),\n            format: p.optional.function,\n            label: p.optional.string,\n            value: p.optional.number,\n        }));\n        return result ? { params: result } : null;\n    },\n    controller(args) {\n        var _a, _b;\n        const initialValue = (_a = args.params.value) !== null && _a !== void 0 ? _a : 0;\n        const drc = new DefiniteRangeConstraint({\n            max: args.params.max,\n            min: args.params.min,\n        });\n        const v = createValue(initialValue, {\n            constraint: drc,\n        });\n        const vc = new SliderTextController(args.document, Object.assign(Object.assign({}, createSliderTextProps({\n            formatter: (_b = args.params.format) !== null && _b !== void 0 ? _b : numberToString,\n            keyScale: createValue(1),\n            max: drc.values.value('max'),\n            min: drc.values.value('min'),\n            pointerScale: getSuitablePointerScale(args.params, initialValue),\n        })), { parser: parseNumber, value: v, viewProps: args.viewProps }));\n        return new LabeledValueBladeController(args.document, {\n            blade: args.blade,\n            props: ValueMap.fromObject({\n                label: args.params.label,\n            }),\n            value: v,\n            valueController: vc,\n        });\n    },\n    api(args) {\n        if (!(args.controller instanceof LabeledValueBladeController)) {\n            return null;\n        }\n        if (!(args.controller.valueController instanceof SliderTextController)) {\n            return null;\n        }\n        return new SliderBladeApi(args.controller);\n    },\n};\n\nconst TextBladePlugin = (function () {\n    return {\n        id: 'text',\n        type: 'blade',\n        core: VERSION$1,\n        accept(params) {\n            const result = parseRecord(params, (p) => ({\n                parse: p.required.function,\n                value: p.required.raw,\n                view: p.required.constant('text'),\n                format: p.optional.function,\n                label: p.optional.string,\n            }));\n            return result ? { params: result } : null;\n        },\n        controller(args) {\n            var _a;\n            const v = createValue(args.params.value);\n            const ic = new TextController(args.document, {\n                parser: args.params.parse,\n                props: ValueMap.fromObject({\n                    formatter: (_a = args.params.format) !== null && _a !== void 0 ? _a : ((v) => String(v)),\n                }),\n                value: v,\n                viewProps: args.viewProps,\n            });\n            return new LabeledValueBladeController(args.document, {\n                blade: args.blade,\n                props: ValueMap.fromObject({\n                    label: args.params.label,\n                }),\n                value: v,\n                valueController: ic,\n            });\n        },\n        api(args) {\n            if (!(args.controller instanceof LabeledValueBladeController)) {\n                return null;\n            }\n            if (!(args.controller.valueController instanceof TextController)) {\n                return null;\n            }\n            return new TextBladeApi(args.controller);\n        },\n    };\n})();\n\nfunction createDefaultWrapperElement(doc) {\n    const elem = doc.createElement('div');\n    elem.classList.add(ClassName('dfw')());\n    if (doc.body) {\n        doc.body.appendChild(elem);\n    }\n    return elem;\n}\nfunction embedStyle(doc, id, css) {\n    if (doc.querySelector(`style[data-tp-style=${id}]`)) {\n        return;\n    }\n    const styleElem = doc.createElement('style');\n    styleElem.dataset.tpStyle = id;\n    styleElem.textContent = css;\n    doc.head.appendChild(styleElem);\n}\n/**\n * The root pane of Tweakpane.\n */\nclass Pane extends RootApi {\n    constructor(opt_config) {\n        var _a, _b;\n        const config = opt_config !== null && opt_config !== void 0 ? opt_config : {};\n        const doc = (_a = config.document) !== null && _a !== void 0 ? _a : getWindowDocument();\n        const pool = createDefaultPluginPool();\n        const rootController = new RootController(doc, {\n            expanded: config.expanded,\n            blade: createBlade(),\n            props: ValueMap.fromObject({\n                title: config.title,\n            }),\n            viewProps: ViewProps.create(),\n        });\n        super(rootController, pool);\n        this.pool_ = pool;\n        this.containerElem_ = (_b = config.container) !== null && _b !== void 0 ? _b : createDefaultWrapperElement(doc);\n        this.containerElem_.appendChild(this.element);\n        this.doc_ = doc;\n        this.usesDefaultWrapper_ = !config.container;\n        this.setUpDefaultPlugins_();\n    }\n    get document() {\n        if (!this.doc_) {\n            throw TpError.alreadyDisposed();\n        }\n        return this.doc_;\n    }\n    dispose() {\n        const containerElem = this.containerElem_;\n        if (!containerElem) {\n            throw TpError.alreadyDisposed();\n        }\n        if (this.usesDefaultWrapper_) {\n            const parentElem = containerElem.parentElement;\n            if (parentElem) {\n                parentElem.removeChild(containerElem);\n            }\n        }\n        this.containerElem_ = null;\n        this.doc_ = null;\n        super.dispose();\n    }\n    registerPlugin(bundle) {\n        if (bundle.css) {\n            embedStyle(this.document, `plugin-${bundle.id}`, bundle.css);\n        }\n        const plugins = 'plugin' in bundle\n            ? [bundle.plugin]\n            : 'plugins' in bundle\n                ? bundle.plugins\n                : [];\n        plugins.forEach((p) => {\n            this.pool_.register(bundle.id, p);\n        });\n    }\n    setUpDefaultPlugins_() {\n        this.registerPlugin({\n            id: 'default',\n            // NOTE: This string literal will be replaced with the default CSS by Rollup at the compilation time\n            css: '.tp-tbiv_b,.tp-coltxtv_ms,.tp-colswv_b,.tp-ckbv_i,.tp-sglv_i,.tp-mllv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-rotv_b,.tp-fldv_b,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--bld-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--cnt-usz);line-height:var(--cnt-usz);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tbpv_c>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-vp))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tbpv_c>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--cnt-usp)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tbpv_c>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tbpv_c>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tbpv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tbpv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tbpv_c>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tbpv_c>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--bld-br);border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tbpv_c .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tbpv_c>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tbpv_c>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--bld-br)}.tp-tbpv_c .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--bld-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);overflow:hidden;padding-left:var(--cnt-hp);padding-right:calc(4px + var(--cnt-usz) + var(--cnt-hp));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:\"\";display:block;height:6px;right:calc(var(--cnt-hp) + (var(--cnt-usz) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-vp);padding-top:var(--cnt-vp);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--cnt-usz);line-height:var(--cnt-usz);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-sglv_i,.tp-mllv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--mo-fg);height:var(--cnt-usz);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-sglv_i::-webkit-scrollbar,.tp-mllv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-sglv_i::-webkit-scrollbar-corner,.tp-mllv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-sglv_i::-webkit-scrollbar-thumb,.tp-mllv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-rotv{--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-br: var(--tp-base-border-radius, 6px);--bs-ff: var(--tp-base-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--bld-br: var(--tp-blade-border-radius, 2px);--bld-hp: var(--tp-blade-horizontal-padding, 4px);--bld-vw: var(--tp-blade-value-width, 160px);--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--cnt-hp: var(--tp-container-horizontal-padding, 4px);--cnt-vp: var(--tp-container-vertical-padding, 4px);--cnt-usp: var(--tp-container-unit-spacing, 4px);--cnt-usz: var(--tp-container-unit-size, 20px);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--bld-br);cursor:pointer;display:block;height:var(--cnt-usz);position:relative;width:var(--cnt-usz)}.tp-ckbv_w svg{display:block;height:16px;inset:0;margin:auto;opacity:0;position:absolute;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--cnt-usz)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--cnt-usp);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--cnt-usp)}.tp-colpv_rgb{display:flex;margin-top:var(--cnt-usp);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-vp);padding-top:calc(var(--cnt-vp) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:\"\";height:2px;left:calc(-1*var(--cnt-hp));position:absolute;right:calc(-1*var(--cnt-hp));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--bld-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--cnt-usz)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{inset:0;position:absolute}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--bld-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;inset:0;position:absolute}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--bld-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{cursor:pointer;display:block;height:var(--cnt-usz);left:0;position:absolute;top:0;width:var(--cnt-usz)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--bld-br);content:\"\";display:block;inset:0;position:absolute}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--bld-br);color:var(--lbl-fg);cursor:pointer;height:var(--cnt-usz);line-height:var(--cnt-usz);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:\"\";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--cnt-usz)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-hp);padding-right:var(--cnt-hp)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:var(--bld-vw)}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 var(--bld-hp);width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--cnt-usz)*3);line-height:var(--cnt-usz);padding-left:var(--bld-hp);padding-right:var(--bld-hp);resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--cnt-usz);margin-right:4px;position:relative;width:var(--cnt-usz)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--cnt-usp);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-p2dpv{padding-left:calc(var(--cnt-usz) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:var(--bld-vw);padding:var(--cnt-vp) var(--cnt-hp);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--cnt-usz);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;content:\"\";display:block;height:2px;inset:0;margin:auto;position:absolute}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;content:\"\";display:block;height:2px;inset:0;margin-bottom:auto;margin-top:auto;position:absolute}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--bld-br);bottom:0;content:\"\";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:\"\";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--cnt-usz) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:\"\";height:2px;left:0;position:absolute;right:0}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:\"\";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-hp) + 4px);padding-right:calc(var(--cnt-hp) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);content:\"\";inset:0 0 2px;pointer-events:none;position:absolute}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);opacity:.5;overflow:hidden;position:relative;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-tbpv_c{padding-bottom:var(--cnt-vp);padding-left:4px;padding-top:var(--cnt-vp)}.tp-txtv{position:relative}.tp-txtv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:calc(var(--bld-hp) - 5px);position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:\"\";height:calc(var(--cnt-usz) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--bld-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:\"\";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--bs-ff);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--cnt-usz) + var(--cnt-hp));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0;transition-delay:0s;transition-duration:0s}.tp-rotv.tp-rotv-not>.tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst.tp-fldv-expanded>.tp-fldv_b{transition-delay:0s;transition-duration:0s}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}',\n            plugins: [\n                ListBladePlugin,\n                SeparatorBladePlugin,\n                SliderBladePlugin,\n                TabBladePlugin,\n                TextBladePlugin,\n            ],\n        });\n    }\n}\n\nconst VERSION = new Semver('4.0.5');\n\nexport { BladeApi, ButtonApi, FolderApi, ListBladeApi, ListInputBindingApi, Pane, Semver, SeparatorBladeApi, SliderBladeApi, SliderInputBindingApi, TabApi, TabPageApi, TextBladeApi, TpChangeEvent, VERSION };\n","function forceCast(v) {\n    return v;\n}\nfunction isEmpty(value) {\n    return value === null || value === undefined;\n}\nfunction isObject$1(value) {\n    return value !== null && typeof value === 'object';\n}\nfunction isRecord(value) {\n    return value !== null && typeof value === 'object';\n}\nfunction deepEqualsArray(a1, a2) {\n    if (a1.length !== a2.length) {\n        return false;\n    }\n    for (let i = 0; i < a1.length; i++) {\n        if (a1[i] !== a2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction deepMerge(r1, r2) {\n    const keys = Array.from(new Set([...Object.keys(r1), ...Object.keys(r2)]));\n    return keys.reduce((result, key) => {\n        const v1 = r1[key];\n        const v2 = r2[key];\n        return isRecord(v1) && isRecord(v2)\n            ? Object.assign(Object.assign({}, result), { [key]: deepMerge(v1, v2) }) : Object.assign(Object.assign({}, result), { [key]: key in r2 ? v2 : v1 });\n    }, {});\n}\n\nfunction isBinding(value) {\n    if (!isObject$1(value)) {\n        return false;\n    }\n    return 'target' in value;\n}\n\nconst CREATE_MESSAGE_MAP = {\n    alreadydisposed: () => 'View has been already disposed',\n    invalidparams: (context) => `Invalid parameters for '${context.name}'`,\n    nomatchingcontroller: (context) => `No matching controller for '${context.key}'`,\n    nomatchingview: (context) => `No matching view for '${JSON.stringify(context.params)}'`,\n    notbindable: () => `Value is not bindable`,\n    notcompatible: (context) => `Not compatible with  plugin '${context.id}'`,\n    propertynotfound: (context) => `Property '${context.name}' not found`,\n    shouldneverhappen: () => 'This error should never happen',\n};\nclass TpError {\n    static alreadyDisposed() {\n        return new TpError({ type: 'alreadydisposed' });\n    }\n    static notBindable() {\n        return new TpError({\n            type: 'notbindable',\n        });\n    }\n    static notCompatible(bundleId, id) {\n        return new TpError({\n            type: 'notcompatible',\n            context: {\n                id: `${bundleId}.${id}`,\n            },\n        });\n    }\n    static propertyNotFound(name) {\n        return new TpError({\n            type: 'propertynotfound',\n            context: {\n                name: name,\n            },\n        });\n    }\n    static shouldNeverHappen() {\n        return new TpError({ type: 'shouldneverhappen' });\n    }\n    constructor(config) {\n        var _a;\n        this.message =\n            (_a = CREATE_MESSAGE_MAP[config.type](forceCast(config.context))) !== null && _a !== void 0 ? _a : 'Unexpected error';\n        this.name = this.constructor.name;\n        this.stack = new Error(this.message).stack;\n        this.type = config.type;\n    }\n    toString() {\n        return this.message;\n    }\n}\n\nclass BindingTarget {\n    constructor(obj, key) {\n        this.obj_ = obj;\n        this.key = key;\n    }\n    static isBindable(obj) {\n        if (obj === null) {\n            return false;\n        }\n        if (typeof obj !== 'object' && typeof obj !== 'function') {\n            return false;\n        }\n        return true;\n    }\n    read() {\n        return this.obj_[this.key];\n    }\n    write(value) {\n        this.obj_[this.key] = value;\n    }\n    writeProperty(name, value) {\n        const valueObj = this.read();\n        if (!BindingTarget.isBindable(valueObj)) {\n            throw TpError.notBindable();\n        }\n        if (!(name in valueObj)) {\n            throw TpError.propertyNotFound(name);\n        }\n        valueObj[name] = value;\n    }\n}\n\nclass Emitter {\n    constructor() {\n        this.observers_ = {};\n    }\n    on(eventName, handler) {\n        let observers = this.observers_[eventName];\n        if (!observers) {\n            observers = this.observers_[eventName] = [];\n        }\n        observers.push({\n            handler: handler,\n        });\n        return this;\n    }\n    off(eventName, handler) {\n        const observers = this.observers_[eventName];\n        if (observers) {\n            this.observers_[eventName] = observers.filter((observer) => {\n                return observer.handler !== handler;\n            });\n        }\n        return this;\n    }\n    emit(eventName, event) {\n        const observers = this.observers_[eventName];\n        if (!observers) {\n            return;\n        }\n        observers.forEach((observer) => {\n            observer.handler(event);\n        });\n    }\n}\n\nclass ComplexValue {\n    constructor(initialValue, config) {\n        var _a;\n        this.constraint_ = config === null || config === void 0 ? void 0 : config.constraint;\n        this.equals_ = (_a = config === null || config === void 0 ? void 0 : config.equals) !== null && _a !== void 0 ? _a : ((v1, v2) => v1 === v2);\n        this.emitter = new Emitter();\n        this.rawValue_ = initialValue;\n    }\n    get constraint() {\n        return this.constraint_;\n    }\n    get rawValue() {\n        return this.rawValue_;\n    }\n    set rawValue(rawValue) {\n        this.setRawValue(rawValue, {\n            forceEmit: false,\n            last: true,\n        });\n    }\n    setRawValue(rawValue, options) {\n        const opts = options !== null && options !== void 0 ? options : {\n            forceEmit: false,\n            last: true,\n        };\n        const constrainedValue = this.constraint_\n            ? this.constraint_.constrain(rawValue)\n            : rawValue;\n        const prevValue = this.rawValue_;\n        const changed = !this.equals_(prevValue, constrainedValue);\n        if (!changed && !opts.forceEmit) {\n            return;\n        }\n        this.emitter.emit('beforechange', {\n            sender: this,\n        });\n        this.rawValue_ = constrainedValue;\n        this.emitter.emit('change', {\n            options: opts,\n            previousRawValue: prevValue,\n            rawValue: constrainedValue,\n            sender: this,\n        });\n    }\n}\n\nclass PrimitiveValue {\n    constructor(initialValue) {\n        this.emitter = new Emitter();\n        this.value_ = initialValue;\n    }\n    get rawValue() {\n        return this.value_;\n    }\n    set rawValue(value) {\n        this.setRawValue(value, {\n            forceEmit: false,\n            last: true,\n        });\n    }\n    setRawValue(value, options) {\n        const opts = options !== null && options !== void 0 ? options : {\n            forceEmit: false,\n            last: true,\n        };\n        const prevValue = this.value_;\n        if (prevValue === value && !opts.forceEmit) {\n            return;\n        }\n        this.emitter.emit('beforechange', {\n            sender: this,\n        });\n        this.value_ = value;\n        this.emitter.emit('change', {\n            options: opts,\n            previousRawValue: prevValue,\n            rawValue: this.value_,\n            sender: this,\n        });\n    }\n}\n\nclass ReadonlyPrimitiveValue {\n    constructor(value) {\n        this.emitter = new Emitter();\n        this.onValueBeforeChange_ = this.onValueBeforeChange_.bind(this);\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.value_ = value;\n        this.value_.emitter.on('beforechange', this.onValueBeforeChange_);\n        this.value_.emitter.on('change', this.onValueChange_);\n    }\n    get rawValue() {\n        return this.value_.rawValue;\n    }\n    onValueBeforeChange_(ev) {\n        this.emitter.emit('beforechange', Object.assign(Object.assign({}, ev), { sender: this }));\n    }\n    onValueChange_(ev) {\n        this.emitter.emit('change', Object.assign(Object.assign({}, ev), { sender: this }));\n    }\n}\n\nfunction createValue(initialValue, config) {\n    const constraint = config === null || config === void 0 ? void 0 : config.constraint;\n    const equals = config === null || config === void 0 ? void 0 : config.equals;\n    if (!constraint && !equals) {\n        return new PrimitiveValue(initialValue);\n    }\n    return new ComplexValue(initialValue, config);\n}\nfunction createReadonlyValue(value) {\n    return [\n        new ReadonlyPrimitiveValue(value),\n        (rawValue, options) => {\n            value.setRawValue(rawValue, options);\n        },\n    ];\n}\n\nclass ValueMap {\n    constructor(valueMap) {\n        this.emitter = new Emitter();\n        this.valMap_ = valueMap;\n        for (const key in this.valMap_) {\n            const v = this.valMap_[key];\n            v.emitter.on('change', () => {\n                this.emitter.emit('change', {\n                    key: key,\n                    sender: this,\n                });\n            });\n        }\n    }\n    static createCore(initialValue) {\n        const keys = Object.keys(initialValue);\n        return keys.reduce((o, key) => {\n            return Object.assign(o, {\n                [key]: createValue(initialValue[key]),\n            });\n        }, {});\n    }\n    static fromObject(initialValue) {\n        const core = this.createCore(initialValue);\n        return new ValueMap(core);\n    }\n    get(key) {\n        return this.valMap_[key].rawValue;\n    }\n    set(key, value) {\n        this.valMap_[key].rawValue = value;\n    }\n    value(key) {\n        return this.valMap_[key];\n    }\n}\n\nclass DefiniteRangeConstraint {\n    constructor(config) {\n        this.values = ValueMap.fromObject({\n            max: config.max,\n            min: config.min,\n        });\n    }\n    constrain(value) {\n        const max = this.values.get('max');\n        const min = this.values.get('min');\n        return Math.min(Math.max(value, min), max);\n    }\n}\n\nclass RangeConstraint {\n    constructor(config) {\n        this.values = ValueMap.fromObject({\n            max: config.max,\n            min: config.min,\n        });\n    }\n    constrain(value) {\n        const max = this.values.get('max');\n        const min = this.values.get('min');\n        let result = value;\n        if (!isEmpty(min)) {\n            result = Math.max(result, min);\n        }\n        if (!isEmpty(max)) {\n            result = Math.min(result, max);\n        }\n        return result;\n    }\n}\n\nclass StepConstraint {\n    constructor(step, origin = 0) {\n        this.step = step;\n        this.origin = origin;\n    }\n    constrain(value) {\n        const o = this.origin % this.step;\n        const r = Math.round((value - o) / this.step);\n        return o + r * this.step;\n    }\n}\n\nclass NumberLiteralNode {\n    constructor(text) {\n        this.text = text;\n    }\n    evaluate() {\n        return Number(this.text);\n    }\n    toString() {\n        return this.text;\n    }\n}\nconst BINARY_OPERATION_MAP = {\n    '**': (v1, v2) => Math.pow(v1, v2),\n    '*': (v1, v2) => v1 * v2,\n    '/': (v1, v2) => v1 / v2,\n    '%': (v1, v2) => v1 % v2,\n    '+': (v1, v2) => v1 + v2,\n    '-': (v1, v2) => v1 - v2,\n    '<<': (v1, v2) => v1 << v2,\n    '>>': (v1, v2) => v1 >> v2,\n    '>>>': (v1, v2) => v1 >>> v2,\n    '&': (v1, v2) => v1 & v2,\n    '^': (v1, v2) => v1 ^ v2,\n    '|': (v1, v2) => v1 | v2,\n};\nclass BinaryOperationNode {\n    constructor(operator, left, right) {\n        this.left = left;\n        this.operator = operator;\n        this.right = right;\n    }\n    evaluate() {\n        const op = BINARY_OPERATION_MAP[this.operator];\n        if (!op) {\n            throw new Error(`unexpected binary operator: '${this.operator}`);\n        }\n        return op(this.left.evaluate(), this.right.evaluate());\n    }\n    toString() {\n        return [\n            'b(',\n            this.left.toString(),\n            this.operator,\n            this.right.toString(),\n            ')',\n        ].join(' ');\n    }\n}\nconst UNARY_OPERATION_MAP = {\n    '+': (v) => v,\n    '-': (v) => -v,\n    '~': (v) => ~v,\n};\nclass UnaryOperationNode {\n    constructor(operator, expr) {\n        this.operator = operator;\n        this.expression = expr;\n    }\n    evaluate() {\n        const op = UNARY_OPERATION_MAP[this.operator];\n        if (!op) {\n            throw new Error(`unexpected unary operator: '${this.operator}`);\n        }\n        return op(this.expression.evaluate());\n    }\n    toString() {\n        return ['u(', this.operator, this.expression.toString(), ')'].join(' ');\n    }\n}\n\nfunction combineReader(parsers) {\n    return (text, cursor) => {\n        for (let i = 0; i < parsers.length; i++) {\n            const result = parsers[i](text, cursor);\n            if (result !== '') {\n                return result;\n            }\n        }\n        return '';\n    };\n}\nfunction readWhitespace(text, cursor) {\n    var _a;\n    const m = text.substr(cursor).match(/^\\s+/);\n    return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n}\nfunction readNonZeroDigit(text, cursor) {\n    const ch = text.substr(cursor, 1);\n    return ch.match(/^[1-9]$/) ? ch : '';\n}\nfunction readDecimalDigits(text, cursor) {\n    var _a;\n    const m = text.substr(cursor).match(/^[0-9]+/);\n    return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n}\nfunction readSignedInteger(text, cursor) {\n    const ds = readDecimalDigits(text, cursor);\n    if (ds !== '') {\n        return ds;\n    }\n    const sign = text.substr(cursor, 1);\n    cursor += 1;\n    if (sign !== '-' && sign !== '+') {\n        return '';\n    }\n    const sds = readDecimalDigits(text, cursor);\n    if (sds === '') {\n        return '';\n    }\n    return sign + sds;\n}\nfunction readExponentPart(text, cursor) {\n    const e = text.substr(cursor, 1);\n    cursor += 1;\n    if (e.toLowerCase() !== 'e') {\n        return '';\n    }\n    const si = readSignedInteger(text, cursor);\n    if (si === '') {\n        return '';\n    }\n    return e + si;\n}\nfunction readDecimalIntegerLiteral(text, cursor) {\n    const ch = text.substr(cursor, 1);\n    if (ch === '0') {\n        return ch;\n    }\n    const nzd = readNonZeroDigit(text, cursor);\n    cursor += nzd.length;\n    if (nzd === '') {\n        return '';\n    }\n    return nzd + readDecimalDigits(text, cursor);\n}\nfunction readDecimalLiteral1(text, cursor) {\n    const dil = readDecimalIntegerLiteral(text, cursor);\n    cursor += dil.length;\n    if (dil === '') {\n        return '';\n    }\n    const dot = text.substr(cursor, 1);\n    cursor += dot.length;\n    if (dot !== '.') {\n        return '';\n    }\n    const dds = readDecimalDigits(text, cursor);\n    cursor += dds.length;\n    return dil + dot + dds + readExponentPart(text, cursor);\n}\nfunction readDecimalLiteral2(text, cursor) {\n    const dot = text.substr(cursor, 1);\n    cursor += dot.length;\n    if (dot !== '.') {\n        return '';\n    }\n    const dds = readDecimalDigits(text, cursor);\n    cursor += dds.length;\n    if (dds === '') {\n        return '';\n    }\n    return dot + dds + readExponentPart(text, cursor);\n}\nfunction readDecimalLiteral3(text, cursor) {\n    const dil = readDecimalIntegerLiteral(text, cursor);\n    cursor += dil.length;\n    if (dil === '') {\n        return '';\n    }\n    return dil + readExponentPart(text, cursor);\n}\nconst readDecimalLiteral = combineReader([\n    readDecimalLiteral1,\n    readDecimalLiteral2,\n    readDecimalLiteral3,\n]);\nfunction parseBinaryDigits(text, cursor) {\n    var _a;\n    const m = text.substr(cursor).match(/^[01]+/);\n    return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n}\nfunction readBinaryIntegerLiteral(text, cursor) {\n    const prefix = text.substr(cursor, 2);\n    cursor += prefix.length;\n    if (prefix.toLowerCase() !== '0b') {\n        return '';\n    }\n    const bds = parseBinaryDigits(text, cursor);\n    if (bds === '') {\n        return '';\n    }\n    return prefix + bds;\n}\nfunction readOctalDigits(text, cursor) {\n    var _a;\n    const m = text.substr(cursor).match(/^[0-7]+/);\n    return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n}\nfunction readOctalIntegerLiteral(text, cursor) {\n    const prefix = text.substr(cursor, 2);\n    cursor += prefix.length;\n    if (prefix.toLowerCase() !== '0o') {\n        return '';\n    }\n    const ods = readOctalDigits(text, cursor);\n    if (ods === '') {\n        return '';\n    }\n    return prefix + ods;\n}\nfunction readHexDigits(text, cursor) {\n    var _a;\n    const m = text.substr(cursor).match(/^[0-9a-f]+/i);\n    return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n}\nfunction readHexIntegerLiteral(text, cursor) {\n    const prefix = text.substr(cursor, 2);\n    cursor += prefix.length;\n    if (prefix.toLowerCase() !== '0x') {\n        return '';\n    }\n    const hds = readHexDigits(text, cursor);\n    if (hds === '') {\n        return '';\n    }\n    return prefix + hds;\n}\nconst readNonDecimalIntegerLiteral = combineReader([\n    readBinaryIntegerLiteral,\n    readOctalIntegerLiteral,\n    readHexIntegerLiteral,\n]);\nconst readNumericLiteral = combineReader([\n    readNonDecimalIntegerLiteral,\n    readDecimalLiteral,\n]);\n\nfunction parseLiteral(text, cursor) {\n    const num = readNumericLiteral(text, cursor);\n    cursor += num.length;\n    if (num === '') {\n        return null;\n    }\n    return {\n        evaluable: new NumberLiteralNode(num),\n        cursor: cursor,\n    };\n}\nfunction parseParenthesizedExpression(text, cursor) {\n    const op = text.substr(cursor, 1);\n    cursor += op.length;\n    if (op !== '(') {\n        return null;\n    }\n    const expr = parseExpression(text, cursor);\n    if (!expr) {\n        return null;\n    }\n    cursor = expr.cursor;\n    cursor += readWhitespace(text, cursor).length;\n    const cl = text.substr(cursor, 1);\n    cursor += cl.length;\n    if (cl !== ')') {\n        return null;\n    }\n    return {\n        evaluable: expr.evaluable,\n        cursor: cursor,\n    };\n}\nfunction parsePrimaryExpression(text, cursor) {\n    var _a;\n    return ((_a = parseLiteral(text, cursor)) !== null && _a !== void 0 ? _a : parseParenthesizedExpression(text, cursor));\n}\nfunction parseUnaryExpression(text, cursor) {\n    const expr = parsePrimaryExpression(text, cursor);\n    if (expr) {\n        return expr;\n    }\n    const op = text.substr(cursor, 1);\n    cursor += op.length;\n    if (op !== '+' && op !== '-' && op !== '~') {\n        return null;\n    }\n    const num = parseUnaryExpression(text, cursor);\n    if (!num) {\n        return null;\n    }\n    cursor = num.cursor;\n    return {\n        cursor: cursor,\n        evaluable: new UnaryOperationNode(op, num.evaluable),\n    };\n}\nfunction readBinaryOperator(ops, text, cursor) {\n    cursor += readWhitespace(text, cursor).length;\n    const op = ops.filter((op) => text.startsWith(op, cursor))[0];\n    if (!op) {\n        return null;\n    }\n    cursor += op.length;\n    cursor += readWhitespace(text, cursor).length;\n    return {\n        cursor: cursor,\n        operator: op,\n    };\n}\nfunction createBinaryOperationExpressionParser(exprParser, ops) {\n    return (text, cursor) => {\n        const firstExpr = exprParser(text, cursor);\n        if (!firstExpr) {\n            return null;\n        }\n        cursor = firstExpr.cursor;\n        let expr = firstExpr.evaluable;\n        for (;;) {\n            const op = readBinaryOperator(ops, text, cursor);\n            if (!op) {\n                break;\n            }\n            cursor = op.cursor;\n            const nextExpr = exprParser(text, cursor);\n            if (!nextExpr) {\n                return null;\n            }\n            cursor = nextExpr.cursor;\n            expr = new BinaryOperationNode(op.operator, expr, nextExpr.evaluable);\n        }\n        return expr\n            ? {\n                cursor: cursor,\n                evaluable: expr,\n            }\n            : null;\n    };\n}\nconst parseBinaryOperationExpression = [\n    ['**'],\n    ['*', '/', '%'],\n    ['+', '-'],\n    ['<<', '>>>', '>>'],\n    ['&'],\n    ['^'],\n    ['|'],\n].reduce((parser, ops) => {\n    return createBinaryOperationExpressionParser(parser, ops);\n}, parseUnaryExpression);\nfunction parseExpression(text, cursor) {\n    cursor += readWhitespace(text, cursor).length;\n    return parseBinaryOperationExpression(text, cursor);\n}\nfunction parseEcmaNumberExpression(text) {\n    const expr = parseExpression(text, 0);\n    if (!expr) {\n        return null;\n    }\n    const cursor = expr.cursor + readWhitespace(text, expr.cursor).length;\n    if (cursor !== text.length) {\n        return null;\n    }\n    return expr.evaluable;\n}\n\nfunction parseNumber(text) {\n    var _a;\n    const r = parseEcmaNumberExpression(text);\n    return (_a = r === null || r === void 0 ? void 0 : r.evaluate()) !== null && _a !== void 0 ? _a : null;\n}\nfunction numberFromUnknown(value) {\n    if (typeof value === 'number') {\n        return value;\n    }\n    if (typeof value === 'string') {\n        const pv = parseNumber(value);\n        if (!isEmpty(pv)) {\n            return pv;\n        }\n    }\n    return 0;\n}\nfunction createNumberFormatter(digits) {\n    return (value) => {\n        return value.toFixed(Math.max(Math.min(digits, 20), 0));\n    };\n}\n\nfunction mapRange(value, start1, end1, start2, end2) {\n    const p = (value - start1) / (end1 - start1);\n    return start2 + p * (end2 - start2);\n}\nfunction getDecimalDigits(value) {\n    const text = String(value.toFixed(10));\n    const frac = text.split('.')[1];\n    return frac.replace(/0+$/, '').length;\n}\nfunction constrainRange(value, min, max) {\n    return Math.min(Math.max(value, min), max);\n}\nfunction loopRange(value, max) {\n    return ((value % max) + max) % max;\n}\nfunction getSuitableDecimalDigits(params, rawValue) {\n    return !isEmpty(params.step)\n        ? getDecimalDigits(params.step)\n        : Math.max(getDecimalDigits(rawValue), 2);\n}\nfunction getSuitableKeyScale(params) {\n    var _a;\n    return (_a = params.step) !== null && _a !== void 0 ? _a : 1;\n}\nfunction getSuitablePointerScale(params, rawValue) {\n    var _a;\n    const base = Math.abs((_a = params.step) !== null && _a !== void 0 ? _a : rawValue);\n    return base === 0 ? 0.1 : Math.pow(10, Math.floor(Math.log10(base)) - 1);\n}\nfunction createStepConstraint(params, initialValue) {\n    if (!isEmpty(params.step)) {\n        return new StepConstraint(params.step, initialValue);\n    }\n    return null;\n}\nfunction createRangeConstraint(params) {\n    if (!isEmpty(params.max) && !isEmpty(params.min)) {\n        return new DefiniteRangeConstraint({\n            max: params.max,\n            min: params.min,\n        });\n    }\n    if (!isEmpty(params.max) || !isEmpty(params.min)) {\n        return new RangeConstraint({\n            max: params.max,\n            min: params.min,\n        });\n    }\n    return null;\n}\nfunction createNumberTextPropsObject(params, initialValue) {\n    var _a, _b, _c;\n    return {\n        formatter: (_a = params.format) !== null && _a !== void 0 ? _a : createNumberFormatter(getSuitableDecimalDigits(params, initialValue)),\n        keyScale: (_b = params.keyScale) !== null && _b !== void 0 ? _b : getSuitableKeyScale(params),\n        pointerScale: (_c = params.pointerScale) !== null && _c !== void 0 ? _c : getSuitablePointerScale(params, initialValue),\n    };\n}\nfunction createNumberTextInputParamsParser(p) {\n    return {\n        format: p.optional.function,\n        keyScale: p.optional.number,\n        max: p.optional.number,\n        min: p.optional.number,\n        pointerScale: p.optional.number,\n        step: p.optional.number,\n    };\n}\n\nfunction createPointAxis(config) {\n    return {\n        constraint: config.constraint,\n        textProps: ValueMap.fromObject(createNumberTextPropsObject(config.params, config.initialValue)),\n    };\n}\n\nclass BladeApi {\n    constructor(controller) {\n        this.controller = controller;\n    }\n    get element() {\n        return this.controller.view.element;\n    }\n    get disabled() {\n        return this.controller.viewProps.get('disabled');\n    }\n    set disabled(disabled) {\n        this.controller.viewProps.set('disabled', disabled);\n    }\n    get hidden() {\n        return this.controller.viewProps.get('hidden');\n    }\n    set hidden(hidden) {\n        this.controller.viewProps.set('hidden', hidden);\n    }\n    dispose() {\n        this.controller.viewProps.set('disposed', true);\n    }\n    importState(state) {\n        return this.controller.importState(state);\n    }\n    exportState() {\n        return this.controller.exportState();\n    }\n}\n\nclass TpEvent {\n    constructor(target) {\n        this.target = target;\n    }\n}\nclass TpChangeEvent extends TpEvent {\n    constructor(target, value, last) {\n        super(target);\n        this.value = value;\n        this.last = last !== null && last !== void 0 ? last : true;\n    }\n}\nclass TpFoldEvent extends TpEvent {\n    constructor(target, expanded) {\n        super(target);\n        this.expanded = expanded;\n    }\n}\nclass TpTabSelectEvent extends TpEvent {\n    constructor(target, index) {\n        super(target);\n        this.index = index;\n    }\n}\n\nclass BindingApi extends BladeApi {\n    constructor(controller) {\n        super(controller);\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.emitter_ = new Emitter();\n        this.controller.value.emitter.on('change', this.onValueChange_);\n    }\n    get label() {\n        return this.controller.labelController.props.get('label');\n    }\n    set label(label) {\n        this.controller.labelController.props.set('label', label);\n    }\n    get key() {\n        return this.controller.value.binding.target.key;\n    }\n    get tag() {\n        return this.controller.tag;\n    }\n    set tag(tag) {\n        this.controller.tag = tag;\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        this.emitter_.on(eventName, (ev) => {\n            bh(ev);\n        });\n        return this;\n    }\n    refresh() {\n        this.controller.value.fetch();\n    }\n    onValueChange_(ev) {\n        const value = this.controller.value;\n        this.emitter_.emit('change', new TpChangeEvent(this, forceCast(value.binding.target.read()), ev.options.last));\n    }\n}\n\nfunction parseObject(value, keyToParserMap) {\n    const keys = Object.keys(keyToParserMap);\n    const result = keys.reduce((tmp, key) => {\n        if (tmp === undefined) {\n            return undefined;\n        }\n        const parser = keyToParserMap[key];\n        const result = parser(value[key]);\n        return result.succeeded\n            ? Object.assign(Object.assign({}, tmp), { [key]: result.value }) : undefined;\n    }, {});\n    return forceCast(result);\n}\nfunction parseArray(value, parseItem) {\n    return value.reduce((tmp, item) => {\n        if (tmp === undefined) {\n            return undefined;\n        }\n        const result = parseItem(item);\n        if (!result.succeeded || result.value === undefined) {\n            return undefined;\n        }\n        return [...tmp, result.value];\n    }, []);\n}\nfunction isObject(value) {\n    if (value === null) {\n        return false;\n    }\n    return typeof value === 'object';\n}\nfunction createMicroParserBuilder(parse) {\n    return (optional) => (v) => {\n        if (!optional && v === undefined) {\n            return {\n                succeeded: false,\n                value: undefined,\n            };\n        }\n        if (optional && v === undefined) {\n            return {\n                succeeded: true,\n                value: undefined,\n            };\n        }\n        const result = parse(v);\n        return result !== undefined\n            ? {\n                succeeded: true,\n                value: result,\n            }\n            : {\n                succeeded: false,\n                value: undefined,\n            };\n    };\n}\nfunction createMicroParserBuilders(optional) {\n    return {\n        custom: (parse) => createMicroParserBuilder(parse)(optional),\n        boolean: createMicroParserBuilder((v) => typeof v === 'boolean' ? v : undefined)(optional),\n        number: createMicroParserBuilder((v) => typeof v === 'number' ? v : undefined)(optional),\n        string: createMicroParserBuilder((v) => typeof v === 'string' ? v : undefined)(optional),\n        function: createMicroParserBuilder((v) =>\n        typeof v === 'function' ? v : undefined)(optional),\n        constant: (value) => createMicroParserBuilder((v) => (v === value ? value : undefined))(optional),\n        raw: createMicroParserBuilder((v) => v)(optional),\n        object: (keyToParserMap) => createMicroParserBuilder((v) => {\n            if (!isObject(v)) {\n                return undefined;\n            }\n            return parseObject(v, keyToParserMap);\n        })(optional),\n        array: (itemParser) => createMicroParserBuilder((v) => {\n            if (!Array.isArray(v)) {\n                return undefined;\n            }\n            return parseArray(v, itemParser);\n        })(optional),\n    };\n}\nconst MicroParsers = {\n    optional: createMicroParserBuilders(true),\n    required: createMicroParserBuilders(false),\n};\nfunction parseRecord(value, keyToParserMap) {\n    const map = keyToParserMap(MicroParsers);\n    const result = MicroParsers.required.object(map)(value);\n    return result.succeeded ? result.value : undefined;\n}\n\nfunction importBladeState(state, superImport, parser, callback) {\n    if (superImport && !superImport(state)) {\n        return false;\n    }\n    const result = parseRecord(state, parser);\n    return result ? callback(result) : false;\n}\nfunction exportBladeState(superExport, thisState) {\n    var _a;\n    return deepMerge((_a = superExport === null || superExport === void 0 ? void 0 : superExport()) !== null && _a !== void 0 ? _a : {}, thisState);\n}\n\nfunction isValueBladeController(bc) {\n    return 'value' in bc;\n}\n\nfunction isBindingValue(v) {\n    if (!isObject$1(v) || !('binding' in v)) {\n        return false;\n    }\n    const b = v.binding;\n    return isBinding(b);\n}\n\nconst SVG_NS = 'http://www.w3.org/2000/svg';\nfunction forceReflow(element) {\n    element.offsetHeight;\n}\nfunction disableTransitionTemporarily(element, callback) {\n    const t = element.style.transition;\n    element.style.transition = 'none';\n    callback();\n    element.style.transition = t;\n}\nfunction supportsTouch(doc) {\n    return doc.ontouchstart !== undefined;\n}\nfunction getCanvasContext(canvasElement) {\n    const win = canvasElement.ownerDocument.defaultView;\n    if (!win) {\n        return null;\n    }\n    const isBrowser = 'document' in win;\n    return isBrowser\n        ? canvasElement.getContext('2d', {\n            willReadFrequently: true,\n        })\n        : null;\n}\nconst ICON_ID_TO_INNER_HTML_MAP = {\n    check: '<path d=\"M2 8l4 4l8 -8\"/>',\n    dropdown: '<path d=\"M5 7h6l-3 3 z\"/>',\n    p2dpad: '<path d=\"M8 4v8\"/><path d=\"M4 8h8\"/><circle cx=\"12\" cy=\"12\" r=\"1.2\"/>',\n};\nfunction createSvgIconElement(document, iconId) {\n    const elem = document.createElementNS(SVG_NS, 'svg');\n    elem.innerHTML = ICON_ID_TO_INNER_HTML_MAP[iconId];\n    return elem;\n}\nfunction insertElementAt(parentElement, element, index) {\n    parentElement.insertBefore(element, parentElement.children[index]);\n}\nfunction removeElement(element) {\n    if (element.parentElement) {\n        element.parentElement.removeChild(element);\n    }\n}\nfunction removeChildElements(element) {\n    while (element.children.length > 0) {\n        element.removeChild(element.children[0]);\n    }\n}\nfunction removeChildNodes(element) {\n    while (element.childNodes.length > 0) {\n        element.removeChild(element.childNodes[0]);\n    }\n}\nfunction findNextTarget(ev) {\n    if (ev.relatedTarget) {\n        return forceCast(ev.relatedTarget);\n    }\n    if ('explicitOriginalTarget' in ev) {\n        return ev.explicitOriginalTarget;\n    }\n    return null;\n}\n\nfunction bindValue(value, applyValue) {\n    value.emitter.on('change', (ev) => {\n        applyValue(ev.rawValue);\n    });\n    applyValue(value.rawValue);\n}\nfunction bindValueMap(valueMap, key, applyValue) {\n    bindValue(valueMap.value(key), applyValue);\n}\n\nconst PREFIX = 'tp';\nfunction ClassName(viewName) {\n    const fn = (opt_elementName, opt_modifier) => {\n        return [\n            PREFIX,\n            '-',\n            viewName,\n            'v',\n            opt_elementName ? `_${opt_elementName}` : '',\n            opt_modifier ? `-${opt_modifier}` : '',\n        ].join('');\n    };\n    return fn;\n}\n\nconst cn$q = ClassName('lbl');\nfunction createLabelNode(doc, label) {\n    const frag = doc.createDocumentFragment();\n    const lineNodes = label.split('\\n').map((line) => {\n        return doc.createTextNode(line);\n    });\n    lineNodes.forEach((lineNode, index) => {\n        if (index > 0) {\n            frag.appendChild(doc.createElement('br'));\n        }\n        frag.appendChild(lineNode);\n    });\n    return frag;\n}\nclass LabelView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$q());\n        config.viewProps.bindClassModifiers(this.element);\n        const labelElem = doc.createElement('div');\n        labelElem.classList.add(cn$q('l'));\n        bindValueMap(config.props, 'label', (value) => {\n            if (isEmpty(value)) {\n                this.element.classList.add(cn$q(undefined, 'nol'));\n            }\n            else {\n                this.element.classList.remove(cn$q(undefined, 'nol'));\n                removeChildNodes(labelElem);\n                labelElem.appendChild(createLabelNode(doc, value));\n            }\n        });\n        this.element.appendChild(labelElem);\n        this.labelElement = labelElem;\n        const valueElem = doc.createElement('div');\n        valueElem.classList.add(cn$q('v'));\n        this.element.appendChild(valueElem);\n        this.valueElement = valueElem;\n    }\n}\n\nclass LabelController {\n    constructor(doc, config) {\n        this.props = config.props;\n        this.valueController = config.valueController;\n        this.viewProps = config.valueController.viewProps;\n        this.view = new LabelView(doc, {\n            props: config.props,\n            viewProps: this.viewProps,\n        });\n        this.view.valueElement.appendChild(this.valueController.view.element);\n    }\n    importProps(state) {\n        return importBladeState(state, null, (p) => ({\n            label: p.optional.string,\n        }), (result) => {\n            this.props.set('label', result.label);\n            return true;\n        });\n    }\n    exportProps() {\n        return exportBladeState(null, {\n            label: this.props.get('label'),\n        });\n    }\n}\n\nfunction getAllBladePositions() {\n    return ['veryfirst', 'first', 'last', 'verylast'];\n}\n\nconst cn$p = ClassName('');\nconst POS_TO_CLASS_NAME_MAP = {\n    veryfirst: 'vfst',\n    first: 'fst',\n    last: 'lst',\n    verylast: 'vlst',\n};\nclass BladeController {\n    constructor(config) {\n        this.parent_ = null;\n        this.blade = config.blade;\n        this.view = config.view;\n        this.viewProps = config.viewProps;\n        const elem = this.view.element;\n        this.blade.value('positions').emitter.on('change', () => {\n            getAllBladePositions().forEach((pos) => {\n                elem.classList.remove(cn$p(undefined, POS_TO_CLASS_NAME_MAP[pos]));\n            });\n            this.blade.get('positions').forEach((pos) => {\n                elem.classList.add(cn$p(undefined, POS_TO_CLASS_NAME_MAP[pos]));\n            });\n        });\n        this.viewProps.handleDispose(() => {\n            removeElement(elem);\n        });\n    }\n    get parent() {\n        return this.parent_;\n    }\n    set parent(parent) {\n        this.parent_ = parent;\n        this.viewProps.set('parent', this.parent_ ? this.parent_.viewProps : null);\n    }\n    importState(state) {\n        return importBladeState(state, null, (p) => ({\n            disabled: p.required.boolean,\n            hidden: p.required.boolean,\n        }), (result) => {\n            this.viewProps.importState(result);\n            return true;\n        });\n    }\n    exportState() {\n        return exportBladeState(null, Object.assign({}, this.viewProps.exportState()));\n    }\n}\n\nclass LabeledValueBladeController extends BladeController {\n    constructor(doc, config) {\n        if (config.value !== config.valueController.value) {\n            throw TpError.shouldNeverHappen();\n        }\n        const viewProps = config.valueController.viewProps;\n        const lc = new LabelController(doc, {\n            blade: config.blade,\n            props: config.props,\n            valueController: config.valueController,\n        });\n        super(Object.assign(Object.assign({}, config), { view: new LabelView(doc, {\n                props: config.props,\n                viewProps: viewProps,\n            }), viewProps: viewProps }));\n        this.labelController = lc;\n        this.value = config.value;\n        this.valueController = config.valueController;\n        this.view.valueElement.appendChild(this.valueController.view.element);\n    }\n    importState(state) {\n        return importBladeState(state, (s) => {\n            var _a, _b, _c;\n            return super.importState(s) &&\n                this.labelController.importProps(s) &&\n                ((_c = (_b = (_a = this.valueController).importProps) === null || _b === void 0 ? void 0 : _b.call(_a, state)) !== null && _c !== void 0 ? _c : true);\n        }, (p) => ({\n            value: p.optional.raw,\n        }), (result) => {\n            if (result.value) {\n                this.value.rawValue = result.value;\n            }\n            return true;\n        });\n    }\n    exportState() {\n        var _a, _b, _c;\n        return exportBladeState(() => super.exportState(), Object.assign(Object.assign({ value: this.value.rawValue }, this.labelController.exportProps()), ((_c = (_b = (_a = this.valueController).exportProps) === null || _b === void 0 ? void 0 : _b.call(_a)) !== null && _c !== void 0 ? _c : {})));\n    }\n}\n\nfunction fillBuffer(buffer, bufferSize) {\n    while (buffer.length < bufferSize) {\n        buffer.push(undefined);\n    }\n}\nfunction initializeBuffer(bufferSize) {\n    const buffer = [];\n    fillBuffer(buffer, bufferSize);\n    return buffer;\n}\nfunction createTrimmedBuffer(buffer) {\n    const index = buffer.indexOf(undefined);\n    return forceCast(index < 0 ? buffer : buffer.slice(0, index));\n}\nfunction createPushedBuffer(buffer, newValue) {\n    const newBuffer = [...createTrimmedBuffer(buffer), newValue];\n    if (newBuffer.length > buffer.length) {\n        newBuffer.splice(0, newBuffer.length - buffer.length);\n    }\n    else {\n        fillBuffer(newBuffer, buffer.length);\n    }\n    return newBuffer;\n}\n\nclass ButtonApi extends BladeApi {\n    get label() {\n        return this.controller.labelController.props.get('label');\n    }\n    set label(label) {\n        this.controller.labelController.props.set('label', label);\n    }\n    get title() {\n        var _a;\n        return (_a = this.controller.buttonController.props.get('title')) !== null && _a !== void 0 ? _a : '';\n    }\n    set title(title) {\n        this.controller.buttonController.props.set('title', title);\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        const emitter = this.controller.buttonController.emitter;\n        emitter.on(eventName, () => {\n            bh(new TpEvent(this));\n        });\n        return this;\n    }\n}\n\nfunction applyClass(elem, className, active) {\n    if (active) {\n        elem.classList.add(className);\n    }\n    else {\n        elem.classList.remove(className);\n    }\n}\nfunction valueToClassName(elem, className) {\n    return (value) => {\n        applyClass(elem, className, value);\n    };\n}\nfunction bindValueToTextContent(value, elem) {\n    bindValue(value, (text) => {\n        elem.textContent = text !== null && text !== void 0 ? text : '';\n    });\n}\n\nconst cn$o = ClassName('btn');\nclass ButtonView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$o());\n        config.viewProps.bindClassModifiers(this.element);\n        const buttonElem = doc.createElement('button');\n        buttonElem.classList.add(cn$o('b'));\n        config.viewProps.bindDisabled(buttonElem);\n        this.element.appendChild(buttonElem);\n        this.buttonElement = buttonElem;\n        const titleElem = doc.createElement('div');\n        titleElem.classList.add(cn$o('t'));\n        bindValueToTextContent(config.props.value('title'), titleElem);\n        this.buttonElement.appendChild(titleElem);\n    }\n}\n\nclass ButtonController {\n    constructor(doc, config) {\n        this.emitter = new Emitter();\n        this.onClick_ = this.onClick_.bind(this);\n        this.props = config.props;\n        this.viewProps = config.viewProps;\n        this.view = new ButtonView(doc, {\n            props: this.props,\n            viewProps: this.viewProps,\n        });\n        this.view.buttonElement.addEventListener('click', this.onClick_);\n    }\n    importProps(state) {\n        return importBladeState(state, null, (p) => ({\n            title: p.optional.string,\n        }), (result) => {\n            this.props.set('title', result.title);\n            return true;\n        });\n    }\n    exportProps() {\n        return exportBladeState(null, {\n            title: this.props.get('title'),\n        });\n    }\n    onClick_() {\n        this.emitter.emit('click', {\n            sender: this,\n        });\n    }\n}\n\nclass ButtonBladeController extends BladeController {\n    constructor(doc, config) {\n        const bc = new ButtonController(doc, {\n            props: config.buttonProps,\n            viewProps: config.viewProps,\n        });\n        const lc = new LabelController(doc, {\n            blade: config.blade,\n            props: config.labelProps,\n            valueController: bc,\n        });\n        super({\n            blade: config.blade,\n            view: lc.view,\n            viewProps: config.viewProps,\n        });\n        this.buttonController = bc;\n        this.labelController = lc;\n    }\n    importState(state) {\n        return importBladeState(state, (s) => super.importState(s) &&\n            this.buttonController.importProps(s) &&\n            this.labelController.importProps(s), () => ({}), () => true);\n    }\n    exportState() {\n        return exportBladeState(() => super.exportState(), Object.assign(Object.assign({}, this.buttonController.exportProps()), this.labelController.exportProps()));\n    }\n}\n\nclass Semver {\n    constructor(text) {\n        const [core, prerelease] = text.split('-');\n        const coreComps = core.split('.');\n        this.major = parseInt(coreComps[0], 10);\n        this.minor = parseInt(coreComps[1], 10);\n        this.patch = parseInt(coreComps[2], 10);\n        this.prerelease = prerelease !== null && prerelease !== void 0 ? prerelease : null;\n    }\n    toString() {\n        const core = [this.major, this.minor, this.patch].join('.');\n        return this.prerelease !== null ? [core, this.prerelease].join('-') : core;\n    }\n}\n\nconst VERSION = new Semver('2.0.0-beta.2');\n\nfunction createPlugin(plugin) {\n    return Object.assign({ core: VERSION }, plugin);\n}\n\ncreatePlugin({\n    id: 'button',\n    type: 'blade',\n    accept(params) {\n        const result = parseRecord(params, (p) => ({\n            title: p.required.string,\n            view: p.required.constant('button'),\n            label: p.optional.string,\n        }));\n        return result ? { params: result } : null;\n    },\n    controller(args) {\n        return new ButtonBladeController(args.document, {\n            blade: args.blade,\n            buttonProps: ValueMap.fromObject({\n                title: args.params.title,\n            }),\n            labelProps: ValueMap.fromObject({\n                label: args.params.label,\n            }),\n            viewProps: args.viewProps,\n        });\n    },\n    api(args) {\n        if (args.controller instanceof ButtonBladeController) {\n            return new ButtonApi(args.controller);\n        }\n        return null;\n    },\n});\n\nfunction addButtonAsBlade(api, params) {\n    return api.addBlade(Object.assign(Object.assign({}, params), { view: 'button' }));\n}\nfunction addFolderAsBlade(api, params) {\n    return api.addBlade(Object.assign(Object.assign({}, params), { view: 'folder' }));\n}\nfunction addTabAsBlade(api, params) {\n    return api.addBlade(Object.assign(Object.assign({}, params), { view: 'tab' }));\n}\n\nfunction isRefreshable(value) {\n    if (!isObject$1(value)) {\n        return false;\n    }\n    return 'refresh' in value && typeof value.refresh === 'function';\n}\n\nfunction createBindingTarget(obj, key) {\n    if (!BindingTarget.isBindable(obj)) {\n        throw TpError.notBindable();\n    }\n    return new BindingTarget(obj, key);\n}\nclass RackApi {\n    constructor(controller, pool) {\n        this.onRackValueChange_ = this.onRackValueChange_.bind(this);\n        this.controller_ = controller;\n        this.emitter_ = new Emitter();\n        this.pool_ = pool;\n        const rack = this.controller_.rack;\n        rack.emitter.on('valuechange', this.onRackValueChange_);\n    }\n    get children() {\n        return this.controller_.rack.children.map((bc) => this.pool_.createApi(bc));\n    }\n    addBinding(object, key, opt_params) {\n        const params = opt_params !== null && opt_params !== void 0 ? opt_params : {};\n        const doc = this.controller_.element.ownerDocument;\n        const bc = this.pool_.createBinding(doc, createBindingTarget(object, key), params);\n        const api = this.pool_.createBindingApi(bc);\n        return this.add(api, params.index);\n    }\n    addFolder(params) {\n        return addFolderAsBlade(this, params);\n    }\n    addButton(params) {\n        return addButtonAsBlade(this, params);\n    }\n    addTab(params) {\n        return addTabAsBlade(this, params);\n    }\n    add(api, opt_index) {\n        const bc = api.controller;\n        this.controller_.rack.add(bc, opt_index);\n        return api;\n    }\n    remove(api) {\n        this.controller_.rack.remove(api.controller);\n    }\n    addBlade(params) {\n        const doc = this.controller_.element.ownerDocument;\n        const bc = this.pool_.createBlade(doc, params);\n        const api = this.pool_.createApi(bc);\n        return this.add(api, params.index);\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        this.emitter_.on(eventName, (ev) => {\n            bh(ev);\n        });\n        return this;\n    }\n    refresh() {\n        this.children.forEach((c) => {\n            if (isRefreshable(c)) {\n                c.refresh();\n            }\n        });\n    }\n    onRackValueChange_(ev) {\n        const bc = ev.bladeController;\n        const api = this.pool_.createApi(bc);\n        const binding = isBindingValue(bc.value) ? bc.value.binding : null;\n        this.emitter_.emit('change', new TpChangeEvent(api, binding ? binding.target.read() : bc.value.rawValue, ev.options.last));\n    }\n}\n\nclass ContainerBladeApi extends BladeApi {\n    constructor(controller, pool) {\n        super(controller);\n        this.rackApi_ = new RackApi(controller.rackController, pool);\n    }\n}\n\nclass ContainerBladeController extends BladeController {\n    constructor(config) {\n        super({\n            blade: config.blade,\n            view: config.view,\n            viewProps: config.rackController.viewProps,\n        });\n        this.rackController = config.rackController;\n    }\n    importState(state) {\n        return importBladeState(state, (s) => super.importState(s), (p) => ({\n            children: p.required.array(p.required.raw),\n        }), (result) => {\n            return this.rackController.rack.children.every((c, index) => {\n                return c.importState(result.children[index]);\n            });\n        });\n    }\n    exportState() {\n        return exportBladeState(() => super.exportState(), {\n            children: this.rackController.rack.children.map((c) => c.exportState()),\n        });\n    }\n}\nfunction isContainerBladeController(bc) {\n    return 'rackController' in bc;\n}\n\nclass NestedOrderedSet {\n    constructor(extract) {\n        this.emitter = new Emitter();\n        this.items_ = [];\n        this.cache_ = new Set();\n        this.onSubListAdd_ = this.onSubListAdd_.bind(this);\n        this.onSubListRemove_ = this.onSubListRemove_.bind(this);\n        this.extract_ = extract;\n    }\n    get items() {\n        return this.items_;\n    }\n    allItems() {\n        return Array.from(this.cache_);\n    }\n    find(callback) {\n        for (const item of this.allItems()) {\n            if (callback(item)) {\n                return item;\n            }\n        }\n        return null;\n    }\n    includes(item) {\n        return this.cache_.has(item);\n    }\n    add(item, opt_index) {\n        if (this.includes(item)) {\n            throw TpError.shouldNeverHappen();\n        }\n        const index = opt_index !== undefined ? opt_index : this.items_.length;\n        this.items_.splice(index, 0, item);\n        this.cache_.add(item);\n        const subList = this.extract_(item);\n        if (subList) {\n            subList.emitter.on('add', this.onSubListAdd_);\n            subList.emitter.on('remove', this.onSubListRemove_);\n            subList.allItems().forEach((i) => {\n                this.cache_.add(i);\n            });\n        }\n        this.emitter.emit('add', {\n            index: index,\n            item: item,\n            root: this,\n            target: this,\n        });\n    }\n    remove(item) {\n        const index = this.items_.indexOf(item);\n        if (index < 0) {\n            return;\n        }\n        this.items_.splice(index, 1);\n        this.cache_.delete(item);\n        const subList = this.extract_(item);\n        if (subList) {\n            subList.allItems().forEach((i) => {\n                this.cache_.delete(i);\n            });\n            subList.emitter.off('add', this.onSubListAdd_);\n            subList.emitter.off('remove', this.onSubListRemove_);\n        }\n        this.emitter.emit('remove', {\n            index: index,\n            item: item,\n            root: this,\n            target: this,\n        });\n    }\n    onSubListAdd_(ev) {\n        this.cache_.add(ev.item);\n        this.emitter.emit('add', {\n            index: ev.index,\n            item: ev.item,\n            root: this,\n            target: ev.target,\n        });\n    }\n    onSubListRemove_(ev) {\n        this.cache_.delete(ev.item);\n        this.emitter.emit('remove', {\n            index: ev.index,\n            item: ev.item,\n            root: this,\n            target: ev.target,\n        });\n    }\n}\n\nfunction findValueBladeController(bcs, v) {\n    for (let i = 0; i < bcs.length; i++) {\n        const bc = bcs[i];\n        if (isValueBladeController(bc) && bc.value === v) {\n            return bc;\n        }\n    }\n    return null;\n}\nfunction findSubBladeControllerSet(bc) {\n    return isContainerBladeController(bc)\n        ? bc.rackController.rack['bcSet_']\n        : null;\n}\nclass Rack {\n    constructor(config) {\n        var _a, _b;\n        this.emitter = new Emitter();\n        this.onBladePositionsChange_ = this.onBladePositionsChange_.bind(this);\n        this.onSetAdd_ = this.onSetAdd_.bind(this);\n        this.onSetRemove_ = this.onSetRemove_.bind(this);\n        this.onChildDispose_ = this.onChildDispose_.bind(this);\n        this.onChildPositionsChange_ = this.onChildPositionsChange_.bind(this);\n        this.onChildValueChange_ = this.onChildValueChange_.bind(this);\n        this.onChildViewPropsChange_ = this.onChildViewPropsChange_.bind(this);\n        this.onRackLayout_ = this.onRackLayout_.bind(this);\n        this.onRackValueChange_ = this.onRackValueChange_.bind(this);\n        this.blade_ = (_a = config.blade) !== null && _a !== void 0 ? _a : null;\n        (_b = this.blade_) === null || _b === void 0 ? void 0 : _b.value('positions').emitter.on('change', this.onBladePositionsChange_);\n        this.viewProps = config.viewProps;\n        this.bcSet_ = new NestedOrderedSet(findSubBladeControllerSet);\n        this.bcSet_.emitter.on('add', this.onSetAdd_);\n        this.bcSet_.emitter.on('remove', this.onSetRemove_);\n    }\n    get children() {\n        return this.bcSet_.items;\n    }\n    add(bc, opt_index) {\n        var _a;\n        (_a = bc.parent) === null || _a === void 0 ? void 0 : _a.remove(bc);\n        bc.parent = this;\n        this.bcSet_.add(bc, opt_index);\n    }\n    remove(bc) {\n        bc.parent = null;\n        this.bcSet_.remove(bc);\n    }\n    find(finder) {\n        return this.bcSet_.allItems().filter(finder);\n    }\n    onSetAdd_(ev) {\n        this.updatePositions_();\n        const root = ev.target === ev.root;\n        this.emitter.emit('add', {\n            bladeController: ev.item,\n            index: ev.index,\n            root: root,\n            sender: this,\n        });\n        if (!root) {\n            return;\n        }\n        const bc = ev.item;\n        bc.viewProps.emitter.on('change', this.onChildViewPropsChange_);\n        bc.blade\n            .value('positions')\n            .emitter.on('change', this.onChildPositionsChange_);\n        bc.viewProps.handleDispose(this.onChildDispose_);\n        if (isValueBladeController(bc)) {\n            bc.value.emitter.on('change', this.onChildValueChange_);\n        }\n        else if (isContainerBladeController(bc)) {\n            const rack = bc.rackController.rack;\n            if (rack) {\n                const emitter = rack.emitter;\n                emitter.on('layout', this.onRackLayout_);\n                emitter.on('valuechange', this.onRackValueChange_);\n            }\n        }\n    }\n    onSetRemove_(ev) {\n        this.updatePositions_();\n        const root = ev.target === ev.root;\n        this.emitter.emit('remove', {\n            bladeController: ev.item,\n            root: root,\n            sender: this,\n        });\n        if (!root) {\n            return;\n        }\n        const bc = ev.item;\n        if (isValueBladeController(bc)) {\n            bc.value.emitter.off('change', this.onChildValueChange_);\n        }\n        else if (isContainerBladeController(bc)) {\n            const rack = bc.rackController.rack;\n            if (rack) {\n                const emitter = rack.emitter;\n                emitter.off('layout', this.onRackLayout_);\n                emitter.off('valuechange', this.onRackValueChange_);\n            }\n        }\n    }\n    updatePositions_() {\n        const visibleItems = this.bcSet_.items.filter((bc) => !bc.viewProps.get('hidden'));\n        const firstVisibleItem = visibleItems[0];\n        const lastVisibleItem = visibleItems[visibleItems.length - 1];\n        this.bcSet_.items.forEach((bc) => {\n            const ps = [];\n            if (bc === firstVisibleItem) {\n                ps.push('first');\n                if (!this.blade_ ||\n                    this.blade_.get('positions').includes('veryfirst')) {\n                    ps.push('veryfirst');\n                }\n            }\n            if (bc === lastVisibleItem) {\n                ps.push('last');\n                if (!this.blade_ || this.blade_.get('positions').includes('verylast')) {\n                    ps.push('verylast');\n                }\n            }\n            bc.blade.set('positions', ps);\n        });\n    }\n    onChildPositionsChange_() {\n        this.updatePositions_();\n        this.emitter.emit('layout', {\n            sender: this,\n        });\n    }\n    onChildViewPropsChange_(_ev) {\n        this.updatePositions_();\n        this.emitter.emit('layout', {\n            sender: this,\n        });\n    }\n    onChildDispose_() {\n        const disposedUcs = this.bcSet_.items.filter((bc) => {\n            return bc.viewProps.get('disposed');\n        });\n        disposedUcs.forEach((bc) => {\n            this.bcSet_.remove(bc);\n        });\n    }\n    onChildValueChange_(ev) {\n        const bc = findValueBladeController(this.find(isValueBladeController), ev.sender);\n        if (!bc) {\n            throw TpError.alreadyDisposed();\n        }\n        this.emitter.emit('valuechange', {\n            bladeController: bc,\n            options: ev.options,\n            sender: this,\n        });\n    }\n    onRackLayout_(_) {\n        this.updatePositions_();\n        this.emitter.emit('layout', {\n            sender: this,\n        });\n    }\n    onRackValueChange_(ev) {\n        this.emitter.emit('valuechange', {\n            bladeController: ev.bladeController,\n            options: ev.options,\n            sender: this,\n        });\n    }\n    onBladePositionsChange_() {\n        this.updatePositions_();\n    }\n}\n\nclass RackController {\n    constructor(config) {\n        this.onRackAdd_ = this.onRackAdd_.bind(this);\n        this.onRackRemove_ = this.onRackRemove_.bind(this);\n        this.element = config.element;\n        this.viewProps = config.viewProps;\n        const rack = new Rack({\n            blade: config.root ? undefined : config.blade,\n            viewProps: config.viewProps,\n        });\n        rack.emitter.on('add', this.onRackAdd_);\n        rack.emitter.on('remove', this.onRackRemove_);\n        this.rack = rack;\n        this.viewProps.handleDispose(() => {\n            for (let i = this.rack.children.length - 1; i >= 0; i--) {\n                const bc = this.rack.children[i];\n                bc.viewProps.set('disposed', true);\n            }\n        });\n    }\n    onRackAdd_(ev) {\n        if (!ev.root) {\n            return;\n        }\n        insertElementAt(this.element, ev.bladeController.view.element, ev.index);\n    }\n    onRackRemove_(ev) {\n        if (!ev.root) {\n            return;\n        }\n        removeElement(ev.bladeController.view.element);\n    }\n}\n\nfunction createBlade() {\n    return new ValueMap({\n        positions: createValue([], {\n            equals: deepEqualsArray,\n        }),\n    });\n}\n\nclass Foldable extends ValueMap {\n    constructor(valueMap) {\n        super(valueMap);\n    }\n    static create(expanded) {\n        const coreObj = {\n            completed: true,\n            expanded: expanded,\n            expandedHeight: null,\n            shouldFixHeight: false,\n            temporaryExpanded: null,\n        };\n        const core = ValueMap.createCore(coreObj);\n        return new Foldable(core);\n    }\n    get styleExpanded() {\n        var _a;\n        return (_a = this.get('temporaryExpanded')) !== null && _a !== void 0 ? _a : this.get('expanded');\n    }\n    get styleHeight() {\n        if (!this.styleExpanded) {\n            return '0';\n        }\n        const exHeight = this.get('expandedHeight');\n        if (this.get('shouldFixHeight') && !isEmpty(exHeight)) {\n            return `${exHeight}px`;\n        }\n        return 'auto';\n    }\n    bindExpandedClass(elem, expandedClassName) {\n        const onExpand = () => {\n            const expanded = this.styleExpanded;\n            if (expanded) {\n                elem.classList.add(expandedClassName);\n            }\n            else {\n                elem.classList.remove(expandedClassName);\n            }\n        };\n        bindValueMap(this, 'expanded', onExpand);\n        bindValueMap(this, 'temporaryExpanded', onExpand);\n    }\n    cleanUpTransition() {\n        this.set('shouldFixHeight', false);\n        this.set('expandedHeight', null);\n        this.set('completed', true);\n    }\n}\nfunction computeExpandedFolderHeight(folder, containerElement) {\n    let height = 0;\n    disableTransitionTemporarily(containerElement, () => {\n        folder.set('expandedHeight', null);\n        folder.set('temporaryExpanded', true);\n        forceReflow(containerElement);\n        height = containerElement.clientHeight;\n        folder.set('temporaryExpanded', null);\n        forceReflow(containerElement);\n    });\n    return height;\n}\nfunction applyHeight(foldable, elem) {\n    elem.style.height = foldable.styleHeight;\n}\nfunction bindFoldable(foldable, elem) {\n    foldable.value('expanded').emitter.on('beforechange', () => {\n        foldable.set('completed', false);\n        if (isEmpty(foldable.get('expandedHeight'))) {\n            const h = computeExpandedFolderHeight(foldable, elem);\n            if (h > 0) {\n                foldable.set('expandedHeight', h);\n            }\n        }\n        foldable.set('shouldFixHeight', true);\n        forceReflow(elem);\n    });\n    foldable.emitter.on('change', () => {\n        applyHeight(foldable, elem);\n    });\n    applyHeight(foldable, elem);\n    elem.addEventListener('transitionend', (ev) => {\n        if (ev.propertyName !== 'height') {\n            return;\n        }\n        foldable.cleanUpTransition();\n    });\n}\n\nclass FolderApi extends ContainerBladeApi {\n    constructor(controller, pool) {\n        super(controller, pool);\n        this.emitter_ = new Emitter();\n        this.controller.foldable\n            .value('expanded')\n            .emitter.on('change', (ev) => {\n            this.emitter_.emit('fold', new TpFoldEvent(this, ev.sender.rawValue));\n        });\n        this.rackApi_.on('change', (ev) => {\n            this.emitter_.emit('change', ev);\n        });\n    }\n    get expanded() {\n        return this.controller.foldable.get('expanded');\n    }\n    set expanded(expanded) {\n        this.controller.foldable.set('expanded', expanded);\n    }\n    get title() {\n        return this.controller.props.get('title');\n    }\n    set title(title) {\n        this.controller.props.set('title', title);\n    }\n    get children() {\n        return this.rackApi_.children;\n    }\n    addBinding(object, key, opt_params) {\n        return this.rackApi_.addBinding(object, key, opt_params);\n    }\n    addFolder(params) {\n        return this.rackApi_.addFolder(params);\n    }\n    addButton(params) {\n        return this.rackApi_.addButton(params);\n    }\n    addTab(params) {\n        return this.rackApi_.addTab(params);\n    }\n    add(api, opt_index) {\n        return this.rackApi_.add(api, opt_index);\n    }\n    remove(api) {\n        this.rackApi_.remove(api);\n    }\n    addBlade(params) {\n        return this.rackApi_.addBlade(params);\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        this.emitter_.on(eventName, (ev) => {\n            bh(ev);\n        });\n        return this;\n    }\n    refresh() {\n        this.rackApi_.refresh();\n    }\n}\n\nconst bladeContainerClassName = ClassName('cnt');\n\nclass FolderView {\n    constructor(doc, config) {\n        var _a;\n        this.className_ = ClassName((_a = config.viewName) !== null && _a !== void 0 ? _a : 'fld');\n        this.element = doc.createElement('div');\n        this.element.classList.add(this.className_(), bladeContainerClassName());\n        config.viewProps.bindClassModifiers(this.element);\n        this.foldable_ = config.foldable;\n        this.foldable_.bindExpandedClass(this.element, this.className_(undefined, 'expanded'));\n        bindValueMap(this.foldable_, 'completed', valueToClassName(this.element, this.className_(undefined, 'cpl')));\n        const buttonElem = doc.createElement('button');\n        buttonElem.classList.add(this.className_('b'));\n        bindValueMap(config.props, 'title', (title) => {\n            if (isEmpty(title)) {\n                this.element.classList.add(this.className_(undefined, 'not'));\n            }\n            else {\n                this.element.classList.remove(this.className_(undefined, 'not'));\n            }\n        });\n        config.viewProps.bindDisabled(buttonElem);\n        this.element.appendChild(buttonElem);\n        this.buttonElement = buttonElem;\n        const indentElem = doc.createElement('div');\n        indentElem.classList.add(this.className_('i'));\n        this.element.appendChild(indentElem);\n        const titleElem = doc.createElement('div');\n        titleElem.classList.add(this.className_('t'));\n        bindValueToTextContent(config.props.value('title'), titleElem);\n        this.buttonElement.appendChild(titleElem);\n        this.titleElement = titleElem;\n        const markElem = doc.createElement('div');\n        markElem.classList.add(this.className_('m'));\n        this.buttonElement.appendChild(markElem);\n        const containerElem = doc.createElement('div');\n        containerElem.classList.add(this.className_('c'));\n        this.element.appendChild(containerElem);\n        this.containerElement = containerElem;\n    }\n}\n\nclass FolderController extends ContainerBladeController {\n    constructor(doc, config) {\n        var _a;\n        const foldable = Foldable.create((_a = config.expanded) !== null && _a !== void 0 ? _a : true);\n        const view = new FolderView(doc, {\n            foldable: foldable,\n            props: config.props,\n            viewName: config.root ? 'rot' : undefined,\n            viewProps: config.viewProps,\n        });\n        super(Object.assign(Object.assign({}, config), { rackController: new RackController({\n                blade: config.blade,\n                element: view.containerElement,\n                root: config.root,\n                viewProps: config.viewProps,\n            }), view: view }));\n        this.onTitleClick_ = this.onTitleClick_.bind(this);\n        this.props = config.props;\n        this.foldable = foldable;\n        bindFoldable(this.foldable, this.view.containerElement);\n        this.rackController.rack.emitter.on('add', () => {\n            this.foldable.cleanUpTransition();\n        });\n        this.rackController.rack.emitter.on('remove', () => {\n            this.foldable.cleanUpTransition();\n        });\n        this.view.buttonElement.addEventListener('click', this.onTitleClick_);\n    }\n    get document() {\n        return this.view.element.ownerDocument;\n    }\n    importState(state) {\n        return importBladeState(state, (s) => super.importState(s), (p) => ({\n            expanded: p.required.boolean,\n            title: p.optional.string,\n        }), (result) => {\n            this.foldable.set('expanded', result.expanded);\n            this.props.set('title', result.title);\n            return true;\n        });\n    }\n    exportState() {\n        return exportBladeState(() => super.exportState(), {\n            expanded: this.foldable.get('expanded'),\n            title: this.props.get('title'),\n        });\n    }\n    onTitleClick_() {\n        this.foldable.set('expanded', !this.foldable.get('expanded'));\n    }\n}\n\ncreatePlugin({\n    id: 'folder',\n    type: 'blade',\n    accept(params) {\n        const result = parseRecord(params, (p) => ({\n            title: p.required.string,\n            view: p.required.constant('folder'),\n            expanded: p.optional.boolean,\n        }));\n        return result ? { params: result } : null;\n    },\n    controller(args) {\n        return new FolderController(args.document, {\n            blade: args.blade,\n            expanded: args.params.expanded,\n            props: ValueMap.fromObject({\n                title: args.params.title,\n            }),\n            viewProps: args.viewProps,\n        });\n    },\n    api(args) {\n        if (!(args.controller instanceof FolderController)) {\n            return null;\n        }\n        return new FolderApi(args.controller, args.pool);\n    },\n});\n\nconst cn$n = ClassName('');\nfunction valueToModifier(elem, modifier) {\n    return valueToClassName(elem, cn$n(undefined, modifier));\n}\nclass ViewProps extends ValueMap {\n    constructor(valueMap) {\n        var _a;\n        super(valueMap);\n        this.onDisabledChange_ = this.onDisabledChange_.bind(this);\n        this.onParentChange_ = this.onParentChange_.bind(this);\n        this.onParentGlobalDisabledChange_ =\n            this.onParentGlobalDisabledChange_.bind(this);\n        [this.globalDisabled_, this.setGlobalDisabled_] = createReadonlyValue(createValue(this.getGlobalDisabled_()));\n        this.value('disabled').emitter.on('change', this.onDisabledChange_);\n        this.value('parent').emitter.on('change', this.onParentChange_);\n        (_a = this.get('parent')) === null || _a === void 0 ? void 0 : _a.globalDisabled.emitter.on('change', this.onParentGlobalDisabledChange_);\n    }\n    static create(opt_initialValue) {\n        var _a, _b, _c;\n        const initialValue = opt_initialValue !== null && opt_initialValue !== void 0 ? opt_initialValue : {};\n        return new ViewProps(ValueMap.createCore({\n            disabled: (_a = initialValue.disabled) !== null && _a !== void 0 ? _a : false,\n            disposed: false,\n            hidden: (_b = initialValue.hidden) !== null && _b !== void 0 ? _b : false,\n            parent: (_c = initialValue.parent) !== null && _c !== void 0 ? _c : null,\n        }));\n    }\n    get globalDisabled() {\n        return this.globalDisabled_;\n    }\n    bindClassModifiers(elem) {\n        bindValue(this.globalDisabled_, valueToModifier(elem, 'disabled'));\n        bindValueMap(this, 'hidden', valueToModifier(elem, 'hidden'));\n    }\n    bindDisabled(target) {\n        bindValue(this.globalDisabled_, (disabled) => {\n            target.disabled = disabled;\n        });\n    }\n    bindTabIndex(elem) {\n        bindValue(this.globalDisabled_, (disabled) => {\n            elem.tabIndex = disabled ? -1 : 0;\n        });\n    }\n    handleDispose(callback) {\n        this.value('disposed').emitter.on('change', (disposed) => {\n            if (disposed) {\n                callback();\n            }\n        });\n    }\n    importState(state) {\n        this.set('disabled', state.disabled);\n        this.set('hidden', state.hidden);\n    }\n    exportState() {\n        return {\n            disabled: this.get('disabled'),\n            hidden: this.get('hidden'),\n        };\n    }\n    getGlobalDisabled_() {\n        const parent = this.get('parent');\n        const parentDisabled = parent ? parent.globalDisabled.rawValue : false;\n        return parentDisabled || this.get('disabled');\n    }\n    updateGlobalDisabled_() {\n        this.setGlobalDisabled_(this.getGlobalDisabled_());\n    }\n    onDisabledChange_() {\n        this.updateGlobalDisabled_();\n    }\n    onParentGlobalDisabledChange_() {\n        this.updateGlobalDisabled_();\n    }\n    onParentChange_(ev) {\n        var _a;\n        const prevParent = ev.previousRawValue;\n        prevParent === null || prevParent === void 0 ? void 0 : prevParent.globalDisabled.emitter.off('change', this.onParentGlobalDisabledChange_);\n        (_a = this.get('parent')) === null || _a === void 0 ? void 0 : _a.globalDisabled.emitter.on('change', this.onParentGlobalDisabledChange_);\n        this.updateGlobalDisabled_();\n    }\n}\n\nconst cn$m = ClassName('tbp');\nclass TabPageView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$m());\n        config.viewProps.bindClassModifiers(this.element);\n        const containerElem = doc.createElement('div');\n        containerElem.classList.add(cn$m('c'));\n        this.element.appendChild(containerElem);\n        this.containerElement = containerElem;\n    }\n}\n\nconst cn$l = ClassName('tbi');\nclass TabItemView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$l());\n        config.viewProps.bindClassModifiers(this.element);\n        bindValueMap(config.props, 'selected', (selected) => {\n            if (selected) {\n                this.element.classList.add(cn$l(undefined, 'sel'));\n            }\n            else {\n                this.element.classList.remove(cn$l(undefined, 'sel'));\n            }\n        });\n        const buttonElem = doc.createElement('button');\n        buttonElem.classList.add(cn$l('b'));\n        config.viewProps.bindDisabled(buttonElem);\n        this.element.appendChild(buttonElem);\n        this.buttonElement = buttonElem;\n        const titleElem = doc.createElement('div');\n        titleElem.classList.add(cn$l('t'));\n        bindValueToTextContent(config.props.value('title'), titleElem);\n        this.buttonElement.appendChild(titleElem);\n        this.titleElement = titleElem;\n    }\n}\n\nclass TabItemController {\n    constructor(doc, config) {\n        this.emitter = new Emitter();\n        this.onClick_ = this.onClick_.bind(this);\n        this.props = config.props;\n        this.viewProps = config.viewProps;\n        this.view = new TabItemView(doc, {\n            props: config.props,\n            viewProps: config.viewProps,\n        });\n        this.view.buttonElement.addEventListener('click', this.onClick_);\n    }\n    onClick_() {\n        this.emitter.emit('click', {\n            sender: this,\n        });\n    }\n}\n\nclass TabPageController extends ContainerBladeController {\n    constructor(doc, config) {\n        const view = new TabPageView(doc, {\n            viewProps: config.viewProps,\n        });\n        super(Object.assign(Object.assign({}, config), { rackController: new RackController({\n                blade: config.blade,\n                element: view.containerElement,\n                viewProps: config.viewProps,\n            }), view: view }));\n        this.onItemClick_ = this.onItemClick_.bind(this);\n        this.ic_ = new TabItemController(doc, {\n            props: config.itemProps,\n            viewProps: ViewProps.create(),\n        });\n        this.ic_.emitter.on('click', this.onItemClick_);\n        this.props = config.props;\n        bindValueMap(this.props, 'selected', (selected) => {\n            this.itemController.props.set('selected', selected);\n            this.viewProps.set('hidden', !selected);\n        });\n    }\n    get itemController() {\n        return this.ic_;\n    }\n    importState(state) {\n        return importBladeState(state, (s) => super.importState(s), (p) => ({\n            selected: p.required.boolean,\n            title: p.required.string,\n        }), (result) => {\n            this.ic_.props.set('selected', result.selected);\n            this.ic_.props.set('title', result.title);\n            return true;\n        });\n    }\n    exportState() {\n        return exportBladeState(() => super.exportState(), {\n            selected: this.ic_.props.get('selected'),\n            title: this.ic_.props.get('title'),\n        });\n    }\n    onItemClick_() {\n        this.props.set('selected', true);\n    }\n}\n\nclass TabApi extends ContainerBladeApi {\n    constructor(controller, pool) {\n        super(controller, pool);\n        this.emitter_ = new Emitter();\n        this.onSelect_ = this.onSelect_.bind(this);\n        this.pool_ = pool;\n        this.rackApi_.on('change', (ev) => {\n            this.emitter_.emit('change', ev);\n        });\n        this.controller.tab.selectedIndex.emitter.on('change', this.onSelect_);\n    }\n    get pages() {\n        return this.rackApi_.children;\n    }\n    addPage(params) {\n        const doc = this.controller.view.element.ownerDocument;\n        const pc = new TabPageController(doc, {\n            blade: createBlade(),\n            itemProps: ValueMap.fromObject({\n                selected: false,\n                title: params.title,\n            }),\n            props: ValueMap.fromObject({\n                selected: false,\n            }),\n            viewProps: ViewProps.create(),\n        });\n        const papi = this.pool_.createApi(pc);\n        return this.rackApi_.add(papi, params.index);\n    }\n    removePage(index) {\n        this.rackApi_.remove(this.rackApi_.children[index]);\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        this.emitter_.on(eventName, (ev) => {\n            bh(ev);\n        });\n        return this;\n    }\n    onSelect_(ev) {\n        this.emitter_.emit('select', new TpTabSelectEvent(this, ev.rawValue));\n    }\n}\n\nclass TabPageApi extends ContainerBladeApi {\n    get title() {\n        var _a;\n        return (_a = this.controller.itemController.props.get('title')) !== null && _a !== void 0 ? _a : '';\n    }\n    set title(title) {\n        this.controller.itemController.props.set('title', title);\n    }\n    get selected() {\n        return this.controller.props.get('selected');\n    }\n    set selected(selected) {\n        this.controller.props.set('selected', selected);\n    }\n    get children() {\n        return this.rackApi_.children;\n    }\n    addButton(params) {\n        return this.rackApi_.addButton(params);\n    }\n    addFolder(params) {\n        return this.rackApi_.addFolder(params);\n    }\n    addTab(params) {\n        return this.rackApi_.addTab(params);\n    }\n    add(api, opt_index) {\n        this.rackApi_.add(api, opt_index);\n    }\n    remove(api) {\n        this.rackApi_.remove(api);\n    }\n    addBinding(object, key, opt_params) {\n        return this.rackApi_.addBinding(object, key, opt_params);\n    }\n    addBlade(params) {\n        return this.rackApi_.addBlade(params);\n    }\n    refresh() {\n        this.rackApi_.refresh();\n    }\n}\n\nconst INDEX_NOT_SELECTED = -1;\nclass Tab {\n    constructor() {\n        this.onItemSelectedChange_ = this.onItemSelectedChange_.bind(this);\n        this.empty = createValue(true);\n        this.selectedIndex = createValue(INDEX_NOT_SELECTED);\n        this.items_ = [];\n    }\n    add(item, opt_index) {\n        const index = opt_index !== null && opt_index !== void 0 ? opt_index : this.items_.length;\n        this.items_.splice(index, 0, item);\n        item.emitter.on('change', this.onItemSelectedChange_);\n        this.keepSelection_();\n    }\n    remove(item) {\n        const index = this.items_.indexOf(item);\n        if (index < 0) {\n            return;\n        }\n        this.items_.splice(index, 1);\n        item.emitter.off('change', this.onItemSelectedChange_);\n        this.keepSelection_();\n    }\n    keepSelection_() {\n        if (this.items_.length === 0) {\n            this.selectedIndex.rawValue = INDEX_NOT_SELECTED;\n            this.empty.rawValue = true;\n            return;\n        }\n        const firstSelIndex = this.items_.findIndex((s) => s.rawValue);\n        if (firstSelIndex < 0) {\n            this.items_.forEach((s, i) => {\n                s.rawValue = i === 0;\n            });\n            this.selectedIndex.rawValue = 0;\n        }\n        else {\n            this.items_.forEach((s, i) => {\n                s.rawValue = i === firstSelIndex;\n            });\n            this.selectedIndex.rawValue = firstSelIndex;\n        }\n        this.empty.rawValue = false;\n    }\n    onItemSelectedChange_(ev) {\n        if (ev.rawValue) {\n            const index = this.items_.findIndex((s) => s === ev.sender);\n            this.items_.forEach((s, i) => {\n                s.rawValue = i === index;\n            });\n            this.selectedIndex.rawValue = index;\n        }\n        else {\n            this.keepSelection_();\n        }\n    }\n}\n\nconst cn$k = ClassName('tab');\nclass TabView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$k(), bladeContainerClassName());\n        config.viewProps.bindClassModifiers(this.element);\n        bindValue(config.empty, valueToClassName(this.element, cn$k(undefined, 'nop')));\n        const titleElem = doc.createElement('div');\n        titleElem.classList.add(cn$k('t'));\n        this.element.appendChild(titleElem);\n        this.itemsElement = titleElem;\n        const indentElem = doc.createElement('div');\n        indentElem.classList.add(cn$k('i'));\n        this.element.appendChild(indentElem);\n        const contentsElem = doc.createElement('div');\n        contentsElem.classList.add(cn$k('c'));\n        this.element.appendChild(contentsElem);\n        this.contentsElement = contentsElem;\n    }\n}\n\nclass TabController extends ContainerBladeController {\n    constructor(doc, config) {\n        const tab = new Tab();\n        const view = new TabView(doc, {\n            empty: tab.empty,\n            viewProps: config.viewProps,\n        });\n        super({\n            blade: config.blade,\n            rackController: new RackController({\n                blade: config.blade,\n                element: view.contentsElement,\n                viewProps: config.viewProps,\n            }),\n            view: view,\n        });\n        this.onRackAdd_ = this.onRackAdd_.bind(this);\n        this.onRackRemove_ = this.onRackRemove_.bind(this);\n        const rack = this.rackController.rack;\n        rack.emitter.on('add', this.onRackAdd_);\n        rack.emitter.on('remove', this.onRackRemove_);\n        this.tab = tab;\n    }\n    add(pc, opt_index) {\n        this.rackController.rack.add(pc, opt_index);\n    }\n    remove(index) {\n        this.rackController.rack.remove(this.rackController.rack.children[index]);\n    }\n    onRackAdd_(ev) {\n        if (!ev.root) {\n            return;\n        }\n        const pc = ev.bladeController;\n        insertElementAt(this.view.itemsElement, pc.itemController.view.element, ev.index);\n        pc.itemController.viewProps.set('parent', this.viewProps);\n        this.tab.add(pc.props.value('selected'));\n    }\n    onRackRemove_(ev) {\n        if (!ev.root) {\n            return;\n        }\n        const pc = ev.bladeController;\n        removeElement(pc.itemController.view.element);\n        pc.itemController.viewProps.set('parent', null);\n        this.tab.remove(pc.props.value('selected'));\n    }\n}\n\ncreatePlugin({\n    id: 'tab',\n    type: 'blade',\n    accept(params) {\n        const result = parseRecord(params, (p) => ({\n            pages: p.required.array(p.required.object({ title: p.required.string })),\n            view: p.required.constant('tab'),\n        }));\n        if (!result || result.pages.length === 0) {\n            return null;\n        }\n        return { params: result };\n    },\n    controller(args) {\n        const c = new TabController(args.document, {\n            blade: args.blade,\n            viewProps: args.viewProps,\n        });\n        args.params.pages.forEach((p) => {\n            const pc = new TabPageController(args.document, {\n                blade: createBlade(),\n                itemProps: ValueMap.fromObject({\n                    selected: false,\n                    title: p.title,\n                }),\n                props: ValueMap.fromObject({\n                    selected: false,\n                }),\n                viewProps: ViewProps.create(),\n            });\n            c.add(pc);\n        });\n        return c;\n    },\n    api(args) {\n        if (args.controller instanceof TabController) {\n            return new TabApi(args.controller, args.pool);\n        }\n        if (args.controller instanceof TabPageController) {\n            return new TabPageApi(args.controller, args.pool);\n        }\n        return null;\n    },\n});\n\nclass ListInputBindingApi extends BindingApi {\n    get options() {\n        return this.controller.valueController.props.get('options');\n    }\n    set options(options) {\n        this.controller.valueController.props.set('options', options);\n    }\n}\n\nclass ManualTicker {\n    constructor() {\n        this.disabled = false;\n        this.emitter = new Emitter();\n    }\n    dispose() { }\n    tick() {\n        if (this.disabled) {\n            return;\n        }\n        this.emitter.emit('tick', {\n            sender: this,\n        });\n    }\n}\n\nclass IntervalTicker {\n    constructor(doc, interval) {\n        this.disabled_ = false;\n        this.timerId_ = null;\n        this.onTick_ = this.onTick_.bind(this);\n        this.doc_ = doc;\n        this.emitter = new Emitter();\n        this.interval_ = interval;\n        this.setTimer_();\n    }\n    get disabled() {\n        return this.disabled_;\n    }\n    set disabled(inactive) {\n        this.disabled_ = inactive;\n        if (this.disabled_) {\n            this.clearTimer_();\n        }\n        else {\n            this.setTimer_();\n        }\n    }\n    dispose() {\n        this.clearTimer_();\n    }\n    clearTimer_() {\n        if (this.timerId_ === null) {\n            return;\n        }\n        const win = this.doc_.defaultView;\n        if (win) {\n            win.clearInterval(this.timerId_);\n        }\n        this.timerId_ = null;\n    }\n    setTimer_() {\n        this.clearTimer_();\n        if (this.interval_ <= 0) {\n            return;\n        }\n        const win = this.doc_.defaultView;\n        if (win) {\n            this.timerId_ = win.setInterval(this.onTick_, this.interval_);\n        }\n    }\n    onTick_() {\n        if (this.disabled_) {\n            return;\n        }\n        this.emitter.emit('tick', {\n            sender: this,\n        });\n    }\n}\n\nclass CompositeConstraint {\n    constructor(constraints) {\n        this.constraints = constraints;\n    }\n    constrain(value) {\n        return this.constraints.reduce((result, c) => {\n            return c.constrain(result);\n        }, value);\n    }\n}\nfunction findConstraint(c, constraintClass) {\n    if (c instanceof constraintClass) {\n        return c;\n    }\n    if (c instanceof CompositeConstraint) {\n        const result = c.constraints.reduce((tmpResult, sc) => {\n            if (tmpResult) {\n                return tmpResult;\n            }\n            return sc instanceof constraintClass ? sc : null;\n        }, null);\n        if (result) {\n            return result;\n        }\n    }\n    return null;\n}\n\nclass ListConstraint {\n    constructor(options) {\n        this.values = ValueMap.fromObject({\n            options: options,\n        });\n    }\n    constrain(value) {\n        const opts = this.values.get('options');\n        if (opts.length === 0) {\n            return value;\n        }\n        const matched = opts.filter((item) => {\n            return item.value === value;\n        }).length > 0;\n        return matched ? value : opts[0].value;\n    }\n}\n\nfunction parseListOptions(value) {\n    var _a;\n    const p = MicroParsers;\n    if (Array.isArray(value)) {\n        return (_a = parseRecord({ items: value }, (p) => ({\n            items: p.required.array(p.required.object({\n                text: p.required.string,\n                value: p.required.raw,\n            })),\n        }))) === null || _a === void 0 ? void 0 : _a.items;\n    }\n    if (typeof value === 'object') {\n        return p.required.raw(value)\n            .value;\n    }\n    return undefined;\n}\nfunction normalizeListOptions(options) {\n    if (Array.isArray(options)) {\n        return options;\n    }\n    const items = [];\n    Object.keys(options).forEach((text) => {\n        items.push({ text: text, value: options[text] });\n    });\n    return items;\n}\nfunction createListConstraint(options) {\n    return !isEmpty(options)\n        ? new ListConstraint(normalizeListOptions(forceCast(options)))\n        : null;\n}\n\nconst cn$j = ClassName('lst');\nclass ListView {\n    constructor(doc, config) {\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.props_ = config.props;\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$j());\n        config.viewProps.bindClassModifiers(this.element);\n        const selectElem = doc.createElement('select');\n        selectElem.classList.add(cn$j('s'));\n        config.viewProps.bindDisabled(selectElem);\n        this.element.appendChild(selectElem);\n        this.selectElement = selectElem;\n        const markElem = doc.createElement('div');\n        markElem.classList.add(cn$j('m'));\n        markElem.appendChild(createSvgIconElement(doc, 'dropdown'));\n        this.element.appendChild(markElem);\n        config.value.emitter.on('change', this.onValueChange_);\n        this.value_ = config.value;\n        bindValueMap(this.props_, 'options', (opts) => {\n            removeChildElements(this.selectElement);\n            opts.forEach((item) => {\n                const optionElem = doc.createElement('option');\n                optionElem.textContent = item.text;\n                this.selectElement.appendChild(optionElem);\n            });\n            this.update_();\n        });\n    }\n    update_() {\n        const values = this.props_.get('options').map((o) => o.value);\n        this.selectElement.selectedIndex = values.indexOf(this.value_.rawValue);\n    }\n    onValueChange_() {\n        this.update_();\n    }\n}\n\nclass ListController {\n    constructor(doc, config) {\n        this.onSelectChange_ = this.onSelectChange_.bind(this);\n        this.props = config.props;\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new ListView(doc, {\n            props: this.props,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view.selectElement.addEventListener('change', this.onSelectChange_);\n    }\n    onSelectChange_(e) {\n        const selectElem = forceCast(e.currentTarget);\n        this.value.rawValue =\n            this.props.get('options')[selectElem.selectedIndex].value;\n    }\n    importProps(state) {\n        return importBladeState(state, null, (p) => ({\n            options: p.required.custom(parseListOptions),\n        }), (result) => {\n            this.props.set('options', normalizeListOptions(result.options));\n            return true;\n        });\n    }\n    exportProps() {\n        return exportBladeState(null, {\n            options: this.props.get('options'),\n        });\n    }\n}\n\nconst cn$i = ClassName('pop');\nclass PopupView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$i());\n        config.viewProps.bindClassModifiers(this.element);\n        bindValue(config.shows, valueToClassName(this.element, cn$i(undefined, 'v')));\n    }\n}\n\nclass PopupController {\n    constructor(doc, config) {\n        this.shows = createValue(false);\n        this.viewProps = config.viewProps;\n        this.view = new PopupView(doc, {\n            shows: this.shows,\n            viewProps: this.viewProps,\n        });\n    }\n}\n\nconst cn$h = ClassName('txt');\nclass TextView {\n    constructor(doc, config) {\n        this.onChange_ = this.onChange_.bind(this);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$h());\n        config.viewProps.bindClassModifiers(this.element);\n        this.props_ = config.props;\n        this.props_.emitter.on('change', this.onChange_);\n        const inputElem = doc.createElement('input');\n        inputElem.classList.add(cn$h('i'));\n        inputElem.type = 'text';\n        config.viewProps.bindDisabled(inputElem);\n        this.element.appendChild(inputElem);\n        this.inputElement = inputElem;\n        config.value.emitter.on('change', this.onChange_);\n        this.value_ = config.value;\n        this.refresh();\n    }\n    refresh() {\n        const formatter = this.props_.get('formatter');\n        this.inputElement.value = formatter(this.value_.rawValue);\n    }\n    onChange_() {\n        this.refresh();\n    }\n}\n\nclass TextController {\n    constructor(doc, config) {\n        this.onInputChange_ = this.onInputChange_.bind(this);\n        this.parser_ = config.parser;\n        this.props = config.props;\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new TextView(doc, {\n            props: config.props,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view.inputElement.addEventListener('change', this.onInputChange_);\n    }\n    onInputChange_(e) {\n        const inputElem = forceCast(e.currentTarget);\n        const value = inputElem.value;\n        const parsedValue = this.parser_(value);\n        if (!isEmpty(parsedValue)) {\n            this.value.rawValue = parsedValue;\n        }\n        this.view.refresh();\n    }\n}\n\nfunction boolToString(value) {\n    return String(value);\n}\nfunction boolFromUnknown(value) {\n    if (value === 'false') {\n        return false;\n    }\n    return !!value;\n}\nfunction BooleanFormatter(value) {\n    return boolToString(value);\n}\n\nfunction composeParsers(parsers) {\n    return (text) => {\n        return parsers.reduce((result, parser) => {\n            if (result !== null) {\n                return result;\n            }\n            return parser(text);\n        }, null);\n    };\n}\n\nconst innerFormatter = createNumberFormatter(0);\nfunction formatPercentage(value) {\n    return innerFormatter(value) + '%';\n}\n\nfunction stringFromUnknown(value) {\n    return String(value);\n}\nfunction formatString(value) {\n    return value;\n}\n\nfunction connectValues({ primary, secondary, forward, backward, }) {\n    let changing = false;\n    function preventFeedback(callback) {\n        if (changing) {\n            return;\n        }\n        changing = true;\n        callback();\n        changing = false;\n    }\n    primary.emitter.on('change', (ev) => {\n        preventFeedback(() => {\n            secondary.setRawValue(forward(primary.rawValue, secondary.rawValue), ev.options);\n        });\n    });\n    secondary.emitter.on('change', (ev) => {\n        preventFeedback(() => {\n            primary.setRawValue(backward(primary.rawValue, secondary.rawValue), ev.options);\n        });\n        preventFeedback(() => {\n            secondary.setRawValue(forward(primary.rawValue, secondary.rawValue), ev.options);\n        });\n    });\n    preventFeedback(() => {\n        secondary.setRawValue(forward(primary.rawValue, secondary.rawValue), {\n            forceEmit: false,\n            last: true,\n        });\n    });\n}\n\nfunction getStepForKey(keyScale, keys) {\n    const step = keyScale * (keys.altKey ? 0.1 : 1) * (keys.shiftKey ? 10 : 1);\n    if (keys.upKey) {\n        return +step;\n    }\n    else if (keys.downKey) {\n        return -step;\n    }\n    return 0;\n}\nfunction getVerticalStepKeys(ev) {\n    return {\n        altKey: ev.altKey,\n        downKey: ev.key === 'ArrowDown',\n        shiftKey: ev.shiftKey,\n        upKey: ev.key === 'ArrowUp',\n    };\n}\nfunction getHorizontalStepKeys(ev) {\n    return {\n        altKey: ev.altKey,\n        downKey: ev.key === 'ArrowLeft',\n        shiftKey: ev.shiftKey,\n        upKey: ev.key === 'ArrowRight',\n    };\n}\nfunction isVerticalArrowKey(key) {\n    return key === 'ArrowUp' || key === 'ArrowDown';\n}\nfunction isArrowKey(key) {\n    return isVerticalArrowKey(key) || key === 'ArrowLeft' || key === 'ArrowRight';\n}\n\nfunction computeOffset$1(ev, elem) {\n    var _a, _b;\n    const win = elem.ownerDocument.defaultView;\n    const rect = elem.getBoundingClientRect();\n    return {\n        x: ev.pageX - (((_a = (win && win.scrollX)) !== null && _a !== void 0 ? _a : 0) + rect.left),\n        y: ev.pageY - (((_b = (win && win.scrollY)) !== null && _b !== void 0 ? _b : 0) + rect.top),\n    };\n}\nclass PointerHandler {\n    constructor(element) {\n        this.lastTouch_ = null;\n        this.onDocumentMouseMove_ = this.onDocumentMouseMove_.bind(this);\n        this.onDocumentMouseUp_ = this.onDocumentMouseUp_.bind(this);\n        this.onMouseDown_ = this.onMouseDown_.bind(this);\n        this.onTouchEnd_ = this.onTouchEnd_.bind(this);\n        this.onTouchMove_ = this.onTouchMove_.bind(this);\n        this.onTouchStart_ = this.onTouchStart_.bind(this);\n        this.elem_ = element;\n        this.emitter = new Emitter();\n        element.addEventListener('touchstart', this.onTouchStart_, {\n            passive: false,\n        });\n        element.addEventListener('touchmove', this.onTouchMove_, {\n            passive: true,\n        });\n        element.addEventListener('touchend', this.onTouchEnd_);\n        element.addEventListener('mousedown', this.onMouseDown_);\n    }\n    computePosition_(offset) {\n        const rect = this.elem_.getBoundingClientRect();\n        return {\n            bounds: {\n                width: rect.width,\n                height: rect.height,\n            },\n            point: offset\n                ? {\n                    x: offset.x,\n                    y: offset.y,\n                }\n                : null,\n        };\n    }\n    onMouseDown_(ev) {\n        var _a;\n        ev.preventDefault();\n        (_a = ev.currentTarget) === null || _a === void 0 ? void 0 : _a.focus();\n        const doc = this.elem_.ownerDocument;\n        doc.addEventListener('mousemove', this.onDocumentMouseMove_);\n        doc.addEventListener('mouseup', this.onDocumentMouseUp_);\n        this.emitter.emit('down', {\n            altKey: ev.altKey,\n            data: this.computePosition_(computeOffset$1(ev, this.elem_)),\n            sender: this,\n            shiftKey: ev.shiftKey,\n        });\n    }\n    onDocumentMouseMove_(ev) {\n        this.emitter.emit('move', {\n            altKey: ev.altKey,\n            data: this.computePosition_(computeOffset$1(ev, this.elem_)),\n            sender: this,\n            shiftKey: ev.shiftKey,\n        });\n    }\n    onDocumentMouseUp_(ev) {\n        const doc = this.elem_.ownerDocument;\n        doc.removeEventListener('mousemove', this.onDocumentMouseMove_);\n        doc.removeEventListener('mouseup', this.onDocumentMouseUp_);\n        this.emitter.emit('up', {\n            altKey: ev.altKey,\n            data: this.computePosition_(computeOffset$1(ev, this.elem_)),\n            sender: this,\n            shiftKey: ev.shiftKey,\n        });\n    }\n    onTouchStart_(ev) {\n        ev.preventDefault();\n        const touch = ev.targetTouches.item(0);\n        const rect = this.elem_.getBoundingClientRect();\n        this.emitter.emit('down', {\n            altKey: ev.altKey,\n            data: this.computePosition_(touch\n                ? {\n                    x: touch.clientX - rect.left,\n                    y: touch.clientY - rect.top,\n                }\n                : undefined),\n            sender: this,\n            shiftKey: ev.shiftKey,\n        });\n        this.lastTouch_ = touch;\n    }\n    onTouchMove_(ev) {\n        const touch = ev.targetTouches.item(0);\n        const rect = this.elem_.getBoundingClientRect();\n        this.emitter.emit('move', {\n            altKey: ev.altKey,\n            data: this.computePosition_(touch\n                ? {\n                    x: touch.clientX - rect.left,\n                    y: touch.clientY - rect.top,\n                }\n                : undefined),\n            sender: this,\n            shiftKey: ev.shiftKey,\n        });\n        this.lastTouch_ = touch;\n    }\n    onTouchEnd_(ev) {\n        var _a;\n        const touch = (_a = ev.targetTouches.item(0)) !== null && _a !== void 0 ? _a : this.lastTouch_;\n        const rect = this.elem_.getBoundingClientRect();\n        this.emitter.emit('up', {\n            altKey: ev.altKey,\n            data: this.computePosition_(touch\n                ? {\n                    x: touch.clientX - rect.left,\n                    y: touch.clientY - rect.top,\n                }\n                : undefined),\n            sender: this,\n            shiftKey: ev.shiftKey,\n        });\n    }\n}\n\nconst cn$g = ClassName('txt');\nclass NumberTextView {\n    constructor(doc, config) {\n        this.onChange_ = this.onChange_.bind(this);\n        this.props_ = config.props;\n        this.props_.emitter.on('change', this.onChange_);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$g(), cn$g(undefined, 'num'));\n        if (config.arrayPosition) {\n            this.element.classList.add(cn$g(undefined, config.arrayPosition));\n        }\n        config.viewProps.bindClassModifiers(this.element);\n        const inputElem = doc.createElement('input');\n        inputElem.classList.add(cn$g('i'));\n        inputElem.type = 'text';\n        config.viewProps.bindDisabled(inputElem);\n        this.element.appendChild(inputElem);\n        this.inputElement = inputElem;\n        this.onDraggingChange_ = this.onDraggingChange_.bind(this);\n        this.dragging_ = config.dragging;\n        this.dragging_.emitter.on('change', this.onDraggingChange_);\n        this.element.classList.add(cn$g());\n        this.inputElement.classList.add(cn$g('i'));\n        const knobElem = doc.createElement('div');\n        knobElem.classList.add(cn$g('k'));\n        this.element.appendChild(knobElem);\n        this.knobElement = knobElem;\n        const guideElem = doc.createElementNS(SVG_NS, 'svg');\n        guideElem.classList.add(cn$g('g'));\n        this.knobElement.appendChild(guideElem);\n        const bodyElem = doc.createElementNS(SVG_NS, 'path');\n        bodyElem.classList.add(cn$g('gb'));\n        guideElem.appendChild(bodyElem);\n        this.guideBodyElem_ = bodyElem;\n        const headElem = doc.createElementNS(SVG_NS, 'path');\n        headElem.classList.add(cn$g('gh'));\n        guideElem.appendChild(headElem);\n        this.guideHeadElem_ = headElem;\n        const tooltipElem = doc.createElement('div');\n        tooltipElem.classList.add(ClassName('tt')());\n        this.knobElement.appendChild(tooltipElem);\n        this.tooltipElem_ = tooltipElem;\n        config.value.emitter.on('change', this.onChange_);\n        this.value = config.value;\n        this.refresh();\n    }\n    onDraggingChange_(ev) {\n        if (ev.rawValue === null) {\n            this.element.classList.remove(cn$g(undefined, 'drg'));\n            return;\n        }\n        this.element.classList.add(cn$g(undefined, 'drg'));\n        const x = ev.rawValue / this.props_.get('pointerScale');\n        const aox = x + (x > 0 ? -1 : x < 0 ? +1 : 0);\n        const adx = constrainRange(-aox, -4, +4);\n        this.guideHeadElem_.setAttributeNS(null, 'd', [`M ${aox + adx},0 L${aox},4 L${aox + adx},8`, `M ${x},-1 L${x},9`].join(' '));\n        this.guideBodyElem_.setAttributeNS(null, 'd', `M 0,4 L${x},4`);\n        const formatter = this.props_.get('formatter');\n        this.tooltipElem_.textContent = formatter(this.value.rawValue);\n        this.tooltipElem_.style.left = `${x}px`;\n    }\n    refresh() {\n        const formatter = this.props_.get('formatter');\n        this.inputElement.value = formatter(this.value.rawValue);\n    }\n    onChange_() {\n        this.refresh();\n    }\n}\n\nclass NumberTextController {\n    constructor(doc, config) {\n        var _a;\n        this.originRawValue_ = 0;\n        this.onInputChange_ = this.onInputChange_.bind(this);\n        this.onInputKeyDown_ = this.onInputKeyDown_.bind(this);\n        this.onInputKeyUp_ = this.onInputKeyUp_.bind(this);\n        this.onPointerDown_ = this.onPointerDown_.bind(this);\n        this.onPointerMove_ = this.onPointerMove_.bind(this);\n        this.onPointerUp_ = this.onPointerUp_.bind(this);\n        this.parser_ = config.parser;\n        this.props = config.props;\n        this.sliderProps_ = (_a = config.sliderProps) !== null && _a !== void 0 ? _a : null;\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.dragging_ = createValue(null);\n        this.view = new NumberTextView(doc, {\n            arrayPosition: config.arrayPosition,\n            dragging: this.dragging_,\n            props: this.props,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view.inputElement.addEventListener('change', this.onInputChange_);\n        this.view.inputElement.addEventListener('keydown', this.onInputKeyDown_);\n        this.view.inputElement.addEventListener('keyup', this.onInputKeyUp_);\n        const ph = new PointerHandler(this.view.knobElement);\n        ph.emitter.on('down', this.onPointerDown_);\n        ph.emitter.on('move', this.onPointerMove_);\n        ph.emitter.on('up', this.onPointerUp_);\n    }\n    constrainValue_(value) {\n        var _a, _b;\n        const min = (_a = this.sliderProps_) === null || _a === void 0 ? void 0 : _a.get('min');\n        const max = (_b = this.sliderProps_) === null || _b === void 0 ? void 0 : _b.get('max');\n        let v = value;\n        if (min !== undefined) {\n            v = Math.max(v, min);\n        }\n        if (max !== undefined) {\n            v = Math.min(v, max);\n        }\n        return v;\n    }\n    onInputChange_(e) {\n        const inputElem = forceCast(e.currentTarget);\n        const value = inputElem.value;\n        const parsedValue = this.parser_(value);\n        if (!isEmpty(parsedValue)) {\n            this.value.rawValue = this.constrainValue_(parsedValue);\n        }\n        this.view.refresh();\n    }\n    onInputKeyDown_(ev) {\n        const step = getStepForKey(this.props.get('keyScale'), getVerticalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        this.value.setRawValue(this.constrainValue_(this.value.rawValue + step), {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onInputKeyUp_(ev) {\n        const step = getStepForKey(this.props.get('keyScale'), getVerticalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        this.value.setRawValue(this.value.rawValue, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n    onPointerDown_() {\n        this.originRawValue_ = this.value.rawValue;\n        this.dragging_.rawValue = 0;\n    }\n    computeDraggingValue_(data) {\n        if (!data.point) {\n            return null;\n        }\n        const dx = data.point.x - data.bounds.width / 2;\n        return this.constrainValue_(this.originRawValue_ + dx * this.props.get('pointerScale'));\n    }\n    onPointerMove_(ev) {\n        const v = this.computeDraggingValue_(ev.data);\n        if (v === null) {\n            return;\n        }\n        this.value.setRawValue(v, {\n            forceEmit: false,\n            last: false,\n        });\n        this.dragging_.rawValue = this.value.rawValue - this.originRawValue_;\n    }\n    onPointerUp_(ev) {\n        const v = this.computeDraggingValue_(ev.data);\n        if (v === null) {\n            return;\n        }\n        this.value.setRawValue(v, {\n            forceEmit: true,\n            last: true,\n        });\n        this.dragging_.rawValue = null;\n    }\n}\n\nconst cn$f = ClassName('sld');\nclass SliderView {\n    constructor(doc, config) {\n        this.onChange_ = this.onChange_.bind(this);\n        this.props_ = config.props;\n        this.props_.emitter.on('change', this.onChange_);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$f());\n        config.viewProps.bindClassModifiers(this.element);\n        const trackElem = doc.createElement('div');\n        trackElem.classList.add(cn$f('t'));\n        config.viewProps.bindTabIndex(trackElem);\n        this.element.appendChild(trackElem);\n        this.trackElement = trackElem;\n        const knobElem = doc.createElement('div');\n        knobElem.classList.add(cn$f('k'));\n        this.trackElement.appendChild(knobElem);\n        this.knobElement = knobElem;\n        config.value.emitter.on('change', this.onChange_);\n        this.value = config.value;\n        this.update_();\n    }\n    update_() {\n        const p = constrainRange(mapRange(this.value.rawValue, this.props_.get('min'), this.props_.get('max'), 0, 100), 0, 100);\n        this.knobElement.style.width = `${p}%`;\n    }\n    onChange_() {\n        this.update_();\n    }\n}\n\nclass SliderController {\n    constructor(doc, config) {\n        this.onKeyDown_ = this.onKeyDown_.bind(this);\n        this.onKeyUp_ = this.onKeyUp_.bind(this);\n        this.onPointerDownOrMove_ = this.onPointerDownOrMove_.bind(this);\n        this.onPointerUp_ = this.onPointerUp_.bind(this);\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.props = config.props;\n        this.view = new SliderView(doc, {\n            props: this.props,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.ptHandler_ = new PointerHandler(this.view.trackElement);\n        this.ptHandler_.emitter.on('down', this.onPointerDownOrMove_);\n        this.ptHandler_.emitter.on('move', this.onPointerDownOrMove_);\n        this.ptHandler_.emitter.on('up', this.onPointerUp_);\n        this.view.trackElement.addEventListener('keydown', this.onKeyDown_);\n        this.view.trackElement.addEventListener('keyup', this.onKeyUp_);\n    }\n    handlePointerEvent_(d, opts) {\n        if (!d.point) {\n            return;\n        }\n        this.value.setRawValue(mapRange(constrainRange(d.point.x, 0, d.bounds.width), 0, d.bounds.width, this.props.get('min'), this.props.get('max')), opts);\n    }\n    onPointerDownOrMove_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerUp_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n    onKeyDown_(ev) {\n        const step = getStepForKey(this.props.get('keyScale'), getHorizontalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        this.value.setRawValue(this.value.rawValue + step, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onKeyUp_(ev) {\n        const step = getStepForKey(this.props.get('keyScale'), getHorizontalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        this.value.setRawValue(this.value.rawValue, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n}\n\nconst cn$e = ClassName('sldtxt');\nclass SliderTextView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$e());\n        const sliderElem = doc.createElement('div');\n        sliderElem.classList.add(cn$e('s'));\n        this.sliderView_ = config.sliderView;\n        sliderElem.appendChild(this.sliderView_.element);\n        this.element.appendChild(sliderElem);\n        const textElem = doc.createElement('div');\n        textElem.classList.add(cn$e('t'));\n        this.textView_ = config.textView;\n        textElem.appendChild(this.textView_.element);\n        this.element.appendChild(textElem);\n    }\n}\n\nclass SliderTextController {\n    constructor(doc, config) {\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.sliderC_ = new SliderController(doc, {\n            props: config.sliderProps,\n            value: config.value,\n            viewProps: this.viewProps,\n        });\n        this.textC_ = new NumberTextController(doc, {\n            parser: config.parser,\n            props: config.textProps,\n            sliderProps: config.sliderProps,\n            value: config.value,\n            viewProps: config.viewProps,\n        });\n        this.view = new SliderTextView(doc, {\n            sliderView: this.sliderC_.view,\n            textView: this.textC_.view,\n        });\n    }\n    get sliderController() {\n        return this.sliderC_;\n    }\n    get textController() {\n        return this.textC_;\n    }\n    importProps(state) {\n        return importBladeState(state, null, (p) => ({\n            max: p.required.number,\n            min: p.required.number,\n        }), (result) => {\n            const sliderProps = this.sliderC_.props;\n            sliderProps.set('max', result.max);\n            sliderProps.set('min', result.min);\n            return true;\n        });\n    }\n    exportProps() {\n        const sliderProps = this.sliderC_.props;\n        return exportBladeState(null, {\n            max: sliderProps.get('max'),\n            min: sliderProps.get('min'),\n        });\n    }\n}\nfunction createSliderTextProps(config) {\n    return {\n        sliderProps: new ValueMap({\n            keyScale: config.keyScale,\n            max: config.max,\n            min: config.min,\n        }),\n        textProps: new ValueMap({\n            formatter: createValue(config.formatter),\n            keyScale: config.keyScale,\n            pointerScale: createValue(config.pointerScale),\n        }),\n    };\n}\n\nconst CSS_VAR_MAP = {\n    containerUnitSize: 'cnt-usz',\n};\nfunction getCssVar(key) {\n    return `--${CSS_VAR_MAP[key]}`;\n}\n\nclass PlainView {\n    constructor(doc, config) {\n        const cn = ClassName(config.viewName);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn());\n        config.viewProps.bindClassModifiers(this.element);\n    }\n}\n\nfunction createPointDimensionParser(p) {\n    return createNumberTextInputParamsParser(p);\n}\nfunction parsePointDimensionParams(value) {\n    if (!isRecord(value)) {\n        return undefined;\n    }\n    return parseRecord(value, createPointDimensionParser);\n}\nfunction createDimensionConstraint(params, initialValue) {\n    if (!params) {\n        return undefined;\n    }\n    const constraints = [];\n    const cs = createStepConstraint(params, initialValue);\n    if (cs) {\n        constraints.push(cs);\n    }\n    const rs = createRangeConstraint(params);\n    if (rs) {\n        constraints.push(rs);\n    }\n    return new CompositeConstraint(constraints);\n}\n\nfunction parsePickerLayout(value) {\n    if (value === 'inline' || value === 'popup') {\n        return value;\n    }\n    return undefined;\n}\n\nfunction writePrimitive(target, value) {\n    target.write(value);\n}\n\nconst cn$d = ClassName('ckb');\nclass CheckboxView {\n    constructor(doc, config) {\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$d());\n        config.viewProps.bindClassModifiers(this.element);\n        const labelElem = doc.createElement('label');\n        labelElem.classList.add(cn$d('l'));\n        this.element.appendChild(labelElem);\n        const inputElem = doc.createElement('input');\n        inputElem.classList.add(cn$d('i'));\n        inputElem.type = 'checkbox';\n        labelElem.appendChild(inputElem);\n        this.inputElement = inputElem;\n        config.viewProps.bindDisabled(this.inputElement);\n        const wrapperElem = doc.createElement('div');\n        wrapperElem.classList.add(cn$d('w'));\n        labelElem.appendChild(wrapperElem);\n        const markElem = createSvgIconElement(doc, 'check');\n        wrapperElem.appendChild(markElem);\n        config.value.emitter.on('change', this.onValueChange_);\n        this.value = config.value;\n        this.update_();\n    }\n    update_() {\n        this.inputElement.checked = this.value.rawValue;\n    }\n    onValueChange_() {\n        this.update_();\n    }\n}\n\nclass CheckboxController {\n    constructor(doc, config) {\n        this.onInputChange_ = this.onInputChange_.bind(this);\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new CheckboxView(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view.inputElement.addEventListener('change', this.onInputChange_);\n    }\n    onInputChange_(e) {\n        const inputElem = forceCast(e.currentTarget);\n        this.value.rawValue = inputElem.checked;\n    }\n}\n\nfunction createConstraint$8(params) {\n    const constraints = [];\n    const lc = createListConstraint(params.options);\n    if (lc) {\n        constraints.push(lc);\n    }\n    return new CompositeConstraint(constraints);\n}\ncreatePlugin({\n    id: 'input-bool',\n    type: 'input',\n    accept: (value, params) => {\n        if (typeof value !== 'boolean') {\n            return null;\n        }\n        const result = parseRecord(params, (p) => ({\n            options: p.optional.custom(parseListOptions),\n            readonly: p.optional.constant(false),\n        }));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: (_args) => boolFromUnknown,\n        constraint: (args) => createConstraint$8(args.params),\n        writer: (_args) => writePrimitive,\n    },\n    controller: (args) => {\n        const doc = args.document;\n        const value = args.value;\n        const c = args.constraint;\n        const lc = c && findConstraint(c, ListConstraint);\n        if (lc) {\n            return new ListController(doc, {\n                props: new ValueMap({\n                    options: lc.values.value('options'),\n                }),\n                value: value,\n                viewProps: args.viewProps,\n            });\n        }\n        return new CheckboxController(doc, {\n            value: value,\n            viewProps: args.viewProps,\n        });\n    },\n    api(args) {\n        if (typeof args.controller.value.rawValue !== 'boolean') {\n            return null;\n        }\n        if (args.controller.valueController instanceof ListController) {\n            return new ListInputBindingApi(args.controller);\n        }\n        return null;\n    },\n});\n\nconst cn$c = ClassName('col');\nclass ColorView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$c());\n        config.foldable.bindExpandedClass(this.element, cn$c(undefined, 'expanded'));\n        bindValueMap(config.foldable, 'completed', valueToClassName(this.element, cn$c(undefined, 'cpl')));\n        const headElem = doc.createElement('div');\n        headElem.classList.add(cn$c('h'));\n        this.element.appendChild(headElem);\n        const swatchElem = doc.createElement('div');\n        swatchElem.classList.add(cn$c('s'));\n        headElem.appendChild(swatchElem);\n        this.swatchElement = swatchElem;\n        const textElem = doc.createElement('div');\n        textElem.classList.add(cn$c('t'));\n        headElem.appendChild(textElem);\n        this.textElement = textElem;\n        if (config.pickerLayout === 'inline') {\n            const pickerElem = doc.createElement('div');\n            pickerElem.classList.add(cn$c('p'));\n            this.element.appendChild(pickerElem);\n            this.pickerElement = pickerElem;\n        }\n        else {\n            this.pickerElement = null;\n        }\n    }\n}\n\nfunction rgbToHslInt(r, g, b) {\n    const rp = constrainRange(r / 255, 0, 1);\n    const gp = constrainRange(g / 255, 0, 1);\n    const bp = constrainRange(b / 255, 0, 1);\n    const cmax = Math.max(rp, gp, bp);\n    const cmin = Math.min(rp, gp, bp);\n    const c = cmax - cmin;\n    let h = 0;\n    let s = 0;\n    const l = (cmin + cmax) / 2;\n    if (c !== 0) {\n        s = c / (1 - Math.abs(cmax + cmin - 1));\n        if (rp === cmax) {\n            h = (gp - bp) / c;\n        }\n        else if (gp === cmax) {\n            h = 2 + (bp - rp) / c;\n        }\n        else {\n            h = 4 + (rp - gp) / c;\n        }\n        h = h / 6 + (h < 0 ? 1 : 0);\n    }\n    return [h * 360, s * 100, l * 100];\n}\nfunction hslToRgbInt(h, s, l) {\n    const hp = ((h % 360) + 360) % 360;\n    const sp = constrainRange(s / 100, 0, 1);\n    const lp = constrainRange(l / 100, 0, 1);\n    const c = (1 - Math.abs(2 * lp - 1)) * sp;\n    const x = c * (1 - Math.abs(((hp / 60) % 2) - 1));\n    const m = lp - c / 2;\n    let rp, gp, bp;\n    if (hp >= 0 && hp < 60) {\n        [rp, gp, bp] = [c, x, 0];\n    }\n    else if (hp >= 60 && hp < 120) {\n        [rp, gp, bp] = [x, c, 0];\n    }\n    else if (hp >= 120 && hp < 180) {\n        [rp, gp, bp] = [0, c, x];\n    }\n    else if (hp >= 180 && hp < 240) {\n        [rp, gp, bp] = [0, x, c];\n    }\n    else if (hp >= 240 && hp < 300) {\n        [rp, gp, bp] = [x, 0, c];\n    }\n    else {\n        [rp, gp, bp] = [c, 0, x];\n    }\n    return [(rp + m) * 255, (gp + m) * 255, (bp + m) * 255];\n}\nfunction rgbToHsvInt(r, g, b) {\n    const rp = constrainRange(r / 255, 0, 1);\n    const gp = constrainRange(g / 255, 0, 1);\n    const bp = constrainRange(b / 255, 0, 1);\n    const cmax = Math.max(rp, gp, bp);\n    const cmin = Math.min(rp, gp, bp);\n    const d = cmax - cmin;\n    let h;\n    if (d === 0) {\n        h = 0;\n    }\n    else if (cmax === rp) {\n        h = 60 * (((((gp - bp) / d) % 6) + 6) % 6);\n    }\n    else if (cmax === gp) {\n        h = 60 * ((bp - rp) / d + 2);\n    }\n    else {\n        h = 60 * ((rp - gp) / d + 4);\n    }\n    const s = cmax === 0 ? 0 : d / cmax;\n    const v = cmax;\n    return [h, s * 100, v * 100];\n}\nfunction hsvToRgbInt(h, s, v) {\n    const hp = loopRange(h, 360);\n    const sp = constrainRange(s / 100, 0, 1);\n    const vp = constrainRange(v / 100, 0, 1);\n    const c = vp * sp;\n    const x = c * (1 - Math.abs(((hp / 60) % 2) - 1));\n    const m = vp - c;\n    let rp, gp, bp;\n    if (hp >= 0 && hp < 60) {\n        [rp, gp, bp] = [c, x, 0];\n    }\n    else if (hp >= 60 && hp < 120) {\n        [rp, gp, bp] = [x, c, 0];\n    }\n    else if (hp >= 120 && hp < 180) {\n        [rp, gp, bp] = [0, c, x];\n    }\n    else if (hp >= 180 && hp < 240) {\n        [rp, gp, bp] = [0, x, c];\n    }\n    else if (hp >= 240 && hp < 300) {\n        [rp, gp, bp] = [x, 0, c];\n    }\n    else {\n        [rp, gp, bp] = [c, 0, x];\n    }\n    return [(rp + m) * 255, (gp + m) * 255, (bp + m) * 255];\n}\nfunction hslToHsvInt(h, s, l) {\n    const sd = l + (s * (100 - Math.abs(2 * l - 100))) / (2 * 100);\n    return [\n        h,\n        sd !== 0 ? (s * (100 - Math.abs(2 * l - 100))) / sd : 0,\n        l + (s * (100 - Math.abs(2 * l - 100))) / (2 * 100),\n    ];\n}\nfunction hsvToHslInt(h, s, v) {\n    const sd = 100 - Math.abs((v * (200 - s)) / 100 - 100);\n    return [h, sd !== 0 ? (s * v) / sd : 0, (v * (200 - s)) / (2 * 100)];\n}\nfunction removeAlphaComponent(comps) {\n    return [comps[0], comps[1], comps[2]];\n}\nfunction appendAlphaComponent(comps, alpha) {\n    return [comps[0], comps[1], comps[2], alpha];\n}\nconst MODE_CONVERTER_MAP = {\n    hsl: {\n        hsl: (h, s, l) => [h, s, l],\n        hsv: hslToHsvInt,\n        rgb: hslToRgbInt,\n    },\n    hsv: {\n        hsl: hsvToHslInt,\n        hsv: (h, s, v) => [h, s, v],\n        rgb: hsvToRgbInt,\n    },\n    rgb: {\n        hsl: rgbToHslInt,\n        hsv: rgbToHsvInt,\n        rgb: (r, g, b) => [r, g, b],\n    },\n};\nfunction getColorMaxComponents(mode, type) {\n    return [\n        type === 'float' ? 1 : mode === 'rgb' ? 255 : 360,\n        type === 'float' ? 1 : mode === 'rgb' ? 255 : 100,\n        type === 'float' ? 1 : mode === 'rgb' ? 255 : 100,\n    ];\n}\nfunction loopHueRange(hue, max) {\n    return hue === max ? max : loopRange(hue, max);\n}\nfunction constrainColorComponents(components, mode, type) {\n    var _a;\n    const ms = getColorMaxComponents(mode, type);\n    return [\n        mode === 'rgb'\n            ? constrainRange(components[0], 0, ms[0])\n            : loopHueRange(components[0], ms[0]),\n        constrainRange(components[1], 0, ms[1]),\n        constrainRange(components[2], 0, ms[2]),\n        constrainRange((_a = components[3]) !== null && _a !== void 0 ? _a : 1, 0, 1),\n    ];\n}\nfunction convertColorType(comps, mode, from, to) {\n    const fms = getColorMaxComponents(mode, from);\n    const tms = getColorMaxComponents(mode, to);\n    return comps.map((c, index) => (c / fms[index]) * tms[index]);\n}\nfunction convertColor(components, from, to) {\n    const intComps = convertColorType(components, from.mode, from.type, 'int');\n    const result = MODE_CONVERTER_MAP[from.mode][to.mode](...intComps);\n    return convertColorType(result, to.mode, 'int', to.type);\n}\n\nclass IntColor {\n    static black() {\n        return new IntColor([0, 0, 0], 'rgb');\n    }\n    constructor(comps, mode) {\n        this.type = 'int';\n        this.mode = mode;\n        this.comps_ = constrainColorComponents(comps, mode, this.type);\n    }\n    getComponents(opt_mode) {\n        return appendAlphaComponent(convertColor(removeAlphaComponent(this.comps_), { mode: this.mode, type: this.type }, { mode: opt_mode !== null && opt_mode !== void 0 ? opt_mode : this.mode, type: this.type }), this.comps_[3]);\n    }\n    toRgbaObject() {\n        const rgbComps = this.getComponents('rgb');\n        return {\n            r: rgbComps[0],\n            g: rgbComps[1],\n            b: rgbComps[2],\n            a: rgbComps[3],\n        };\n    }\n}\n\nconst cn$b = ClassName('colp');\nclass ColorPickerView {\n    constructor(doc, config) {\n        this.alphaViews_ = null;\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$b());\n        config.viewProps.bindClassModifiers(this.element);\n        const hsvElem = doc.createElement('div');\n        hsvElem.classList.add(cn$b('hsv'));\n        const svElem = doc.createElement('div');\n        svElem.classList.add(cn$b('sv'));\n        this.svPaletteView_ = config.svPaletteView;\n        svElem.appendChild(this.svPaletteView_.element);\n        hsvElem.appendChild(svElem);\n        const hElem = doc.createElement('div');\n        hElem.classList.add(cn$b('h'));\n        this.hPaletteView_ = config.hPaletteView;\n        hElem.appendChild(this.hPaletteView_.element);\n        hsvElem.appendChild(hElem);\n        this.element.appendChild(hsvElem);\n        const rgbElem = doc.createElement('div');\n        rgbElem.classList.add(cn$b('rgb'));\n        this.textsView_ = config.textsView;\n        rgbElem.appendChild(this.textsView_.element);\n        this.element.appendChild(rgbElem);\n        if (config.alphaViews) {\n            this.alphaViews_ = {\n                palette: config.alphaViews.palette,\n                text: config.alphaViews.text,\n            };\n            const aElem = doc.createElement('div');\n            aElem.classList.add(cn$b('a'));\n            const apElem = doc.createElement('div');\n            apElem.classList.add(cn$b('ap'));\n            apElem.appendChild(this.alphaViews_.palette.element);\n            aElem.appendChild(apElem);\n            const atElem = doc.createElement('div');\n            atElem.classList.add(cn$b('at'));\n            atElem.appendChild(this.alphaViews_.text.element);\n            aElem.appendChild(atElem);\n            this.element.appendChild(aElem);\n        }\n    }\n    get allFocusableElements() {\n        const elems = [\n            this.svPaletteView_.element,\n            this.hPaletteView_.element,\n            this.textsView_.modeSelectElement,\n            ...this.textsView_.inputViews.map((v) => v.inputElement),\n        ];\n        if (this.alphaViews_) {\n            elems.push(this.alphaViews_.palette.element, this.alphaViews_.text.inputElement);\n        }\n        return elems;\n    }\n}\n\nfunction parseColorType(value) {\n    return value === 'int' ? 'int' : value === 'float' ? 'float' : undefined;\n}\nfunction parseColorInputParams(params) {\n    return parseRecord(params, (p) => ({\n        color: p.optional.object({\n            alpha: p.optional.boolean,\n            type: p.optional.custom(parseColorType),\n        }),\n        expanded: p.optional.boolean,\n        picker: p.optional.custom(parsePickerLayout),\n        readonly: p.optional.constant(false),\n    }));\n}\nfunction getKeyScaleForColor(forAlpha) {\n    return forAlpha ? 0.1 : 1;\n}\nfunction extractColorType(params) {\n    var _a;\n    return (_a = params.color) === null || _a === void 0 ? void 0 : _a.type;\n}\n\nclass FloatColor {\n    constructor(comps, mode) {\n        this.type = 'float';\n        this.mode = mode;\n        this.comps_ = constrainColorComponents(comps, mode, this.type);\n    }\n    getComponents(opt_mode) {\n        return appendAlphaComponent(convertColor(removeAlphaComponent(this.comps_), { mode: this.mode, type: this.type }, { mode: opt_mode !== null && opt_mode !== void 0 ? opt_mode : this.mode, type: this.type }), this.comps_[3]);\n    }\n    toRgbaObject() {\n        const rgbComps = this.getComponents('rgb');\n        return {\n            r: rgbComps[0],\n            g: rgbComps[1],\n            b: rgbComps[2],\n            a: rgbComps[3],\n        };\n    }\n}\n\nconst TYPE_TO_CONSTRUCTOR_MAP = {\n    int: (comps, mode) => new IntColor(comps, mode),\n    float: (comps, mode) => new FloatColor(comps, mode),\n};\nfunction createColor(comps, mode, type) {\n    return TYPE_TO_CONSTRUCTOR_MAP[type](comps, mode);\n}\nfunction isFloatColor(c) {\n    return c.type === 'float';\n}\nfunction isIntColor(c) {\n    return c.type === 'int';\n}\nfunction convertFloatToInt(cf) {\n    const comps = cf.getComponents();\n    const ms = getColorMaxComponents(cf.mode, 'int');\n    return new IntColor([\n        Math.round(mapRange(comps[0], 0, 1, 0, ms[0])),\n        Math.round(mapRange(comps[1], 0, 1, 0, ms[1])),\n        Math.round(mapRange(comps[2], 0, 1, 0, ms[2])),\n        comps[3],\n    ], cf.mode);\n}\nfunction convertIntToFloat(ci) {\n    const comps = ci.getComponents();\n    const ms = getColorMaxComponents(ci.mode, 'int');\n    return new FloatColor([\n        mapRange(comps[0], 0, ms[0], 0, 1),\n        mapRange(comps[1], 0, ms[1], 0, 1),\n        mapRange(comps[2], 0, ms[2], 0, 1),\n        comps[3],\n    ], ci.mode);\n}\nfunction mapColorType(c, type) {\n    if (c.type === type) {\n        return c;\n    }\n    if (isIntColor(c) && type === 'float') {\n        return convertIntToFloat(c);\n    }\n    if (isFloatColor(c) && type === 'int') {\n        return convertFloatToInt(c);\n    }\n    throw TpError.shouldNeverHappen();\n}\n\nfunction equalsStringColorFormat(f1, f2) {\n    return (f1.alpha === f2.alpha &&\n        f1.mode === f2.mode &&\n        f1.notation === f2.notation &&\n        f1.type === f2.type);\n}\nfunction parseCssNumberOrPercentage(text, max) {\n    const m = text.match(/^(.+)%$/);\n    if (!m) {\n        return Math.min(parseFloat(text), max);\n    }\n    return Math.min(parseFloat(m[1]) * 0.01 * max, max);\n}\nconst ANGLE_TO_DEG_MAP = {\n    deg: (angle) => angle,\n    grad: (angle) => (angle * 360) / 400,\n    rad: (angle) => (angle * 360) / (2 * Math.PI),\n    turn: (angle) => angle * 360,\n};\nfunction parseCssNumberOrAngle(text) {\n    const m = text.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);\n    if (!m) {\n        return parseFloat(text);\n    }\n    const angle = parseFloat(m[1]);\n    const unit = m[2];\n    return ANGLE_TO_DEG_MAP[unit](angle);\n}\nfunction parseFunctionalRgbColorComponents(text) {\n    const m = text.match(/^rgb\\(\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*\\)$/);\n    if (!m) {\n        return null;\n    }\n    const comps = [\n        parseCssNumberOrPercentage(m[1], 255),\n        parseCssNumberOrPercentage(m[2], 255),\n        parseCssNumberOrPercentage(m[3], 255),\n    ];\n    if (isNaN(comps[0]) || isNaN(comps[1]) || isNaN(comps[2])) {\n        return null;\n    }\n    return comps;\n}\nfunction parseFunctionalRgbColor(text) {\n    const comps = parseFunctionalRgbColorComponents(text);\n    return comps ? new IntColor(comps, 'rgb') : null;\n}\nfunction parseFunctionalRgbaColorComponents(text) {\n    const m = text.match(/^rgba\\(\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*\\)$/);\n    if (!m) {\n        return null;\n    }\n    const comps = [\n        parseCssNumberOrPercentage(m[1], 255),\n        parseCssNumberOrPercentage(m[2], 255),\n        parseCssNumberOrPercentage(m[3], 255),\n        parseCssNumberOrPercentage(m[4], 1),\n    ];\n    if (isNaN(comps[0]) ||\n        isNaN(comps[1]) ||\n        isNaN(comps[2]) ||\n        isNaN(comps[3])) {\n        return null;\n    }\n    return comps;\n}\nfunction parseFunctionalRgbaColor(text) {\n    const comps = parseFunctionalRgbaColorComponents(text);\n    return comps ? new IntColor(comps, 'rgb') : null;\n}\nfunction parseFunctionalHslColorComponents(text) {\n    const m = text.match(/^hsl\\(\\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*\\)$/);\n    if (!m) {\n        return null;\n    }\n    const comps = [\n        parseCssNumberOrAngle(m[1]),\n        parseCssNumberOrPercentage(m[2], 100),\n        parseCssNumberOrPercentage(m[3], 100),\n    ];\n    if (isNaN(comps[0]) || isNaN(comps[1]) || isNaN(comps[2])) {\n        return null;\n    }\n    return comps;\n}\nfunction parseFunctionalHslColor(text) {\n    const comps = parseFunctionalHslColorComponents(text);\n    return comps ? new IntColor(comps, 'hsl') : null;\n}\nfunction parseHslaColorComponents(text) {\n    const m = text.match(/^hsla\\(\\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*\\)$/);\n    if (!m) {\n        return null;\n    }\n    const comps = [\n        parseCssNumberOrAngle(m[1]),\n        parseCssNumberOrPercentage(m[2], 100),\n        parseCssNumberOrPercentage(m[3], 100),\n        parseCssNumberOrPercentage(m[4], 1),\n    ];\n    if (isNaN(comps[0]) ||\n        isNaN(comps[1]) ||\n        isNaN(comps[2]) ||\n        isNaN(comps[3])) {\n        return null;\n    }\n    return comps;\n}\nfunction parseFunctionalHslaColor(text) {\n    const comps = parseHslaColorComponents(text);\n    return comps ? new IntColor(comps, 'hsl') : null;\n}\nfunction parseHexRgbColorComponents(text) {\n    const mRgb = text.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);\n    if (mRgb) {\n        return [\n            parseInt(mRgb[1] + mRgb[1], 16),\n            parseInt(mRgb[2] + mRgb[2], 16),\n            parseInt(mRgb[3] + mRgb[3], 16),\n        ];\n    }\n    const mRrggbb = text.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);\n    if (mRrggbb) {\n        return [\n            parseInt(mRrggbb[1], 16),\n            parseInt(mRrggbb[2], 16),\n            parseInt(mRrggbb[3], 16),\n        ];\n    }\n    return null;\n}\nfunction parseHexRgbColor(text) {\n    const comps = parseHexRgbColorComponents(text);\n    return comps ? new IntColor(comps, 'rgb') : null;\n}\nfunction parseHexRgbaColorComponents(text) {\n    const mRgb = text.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);\n    if (mRgb) {\n        return [\n            parseInt(mRgb[1] + mRgb[1], 16),\n            parseInt(mRgb[2] + mRgb[2], 16),\n            parseInt(mRgb[3] + mRgb[3], 16),\n            mapRange(parseInt(mRgb[4] + mRgb[4], 16), 0, 255, 0, 1),\n        ];\n    }\n    const mRrggbb = text.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);\n    if (mRrggbb) {\n        return [\n            parseInt(mRrggbb[1], 16),\n            parseInt(mRrggbb[2], 16),\n            parseInt(mRrggbb[3], 16),\n            mapRange(parseInt(mRrggbb[4], 16), 0, 255, 0, 1),\n        ];\n    }\n    return null;\n}\nfunction parseHexRgbaColor(text) {\n    const comps = parseHexRgbaColorComponents(text);\n    return comps ? new IntColor(comps, 'rgb') : null;\n}\nfunction parseObjectRgbColorComponents(text) {\n    const m = text.match(/^\\{\\s*r\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*g\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*b\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*\\}$/);\n    if (!m) {\n        return null;\n    }\n    const comps = [\n        parseFloat(m[1]),\n        parseFloat(m[2]),\n        parseFloat(m[3]),\n    ];\n    if (isNaN(comps[0]) || isNaN(comps[1]) || isNaN(comps[2])) {\n        return null;\n    }\n    return comps;\n}\nfunction createObjectRgbColorParser(type) {\n    return (text) => {\n        const comps = parseObjectRgbColorComponents(text);\n        return comps ? createColor(comps, 'rgb', type) : null;\n    };\n}\nfunction parseObjectRgbaColorComponents(text) {\n    const m = text.match(/^\\{\\s*r\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*g\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*b\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*a\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*\\}$/);\n    if (!m) {\n        return null;\n    }\n    const comps = [\n        parseFloat(m[1]),\n        parseFloat(m[2]),\n        parseFloat(m[3]),\n        parseFloat(m[4]),\n    ];\n    if (isNaN(comps[0]) ||\n        isNaN(comps[1]) ||\n        isNaN(comps[2]) ||\n        isNaN(comps[3])) {\n        return null;\n    }\n    return comps;\n}\nfunction createObjectRgbaColorParser(type) {\n    return (text) => {\n        const comps = parseObjectRgbaColorComponents(text);\n        return comps ? createColor(comps, 'rgb', type) : null;\n    };\n}\nconst PARSER_AND_RESULT = [\n    {\n        parser: parseHexRgbColorComponents,\n        result: {\n            alpha: false,\n            mode: 'rgb',\n            notation: 'hex',\n        },\n    },\n    {\n        parser: parseHexRgbaColorComponents,\n        result: {\n            alpha: true,\n            mode: 'rgb',\n            notation: 'hex',\n        },\n    },\n    {\n        parser: parseFunctionalRgbColorComponents,\n        result: {\n            alpha: false,\n            mode: 'rgb',\n            notation: 'func',\n        },\n    },\n    {\n        parser: parseFunctionalRgbaColorComponents,\n        result: {\n            alpha: true,\n            mode: 'rgb',\n            notation: 'func',\n        },\n    },\n    {\n        parser: parseFunctionalHslColorComponents,\n        result: {\n            alpha: false,\n            mode: 'hsl',\n            notation: 'func',\n        },\n    },\n    {\n        parser: parseHslaColorComponents,\n        result: {\n            alpha: true,\n            mode: 'hsl',\n            notation: 'func',\n        },\n    },\n    {\n        parser: parseObjectRgbColorComponents,\n        result: {\n            alpha: false,\n            mode: 'rgb',\n            notation: 'object',\n        },\n    },\n    {\n        parser: parseObjectRgbaColorComponents,\n        result: {\n            alpha: true,\n            mode: 'rgb',\n            notation: 'object',\n        },\n    },\n];\nfunction detectStringColor(text) {\n    return PARSER_AND_RESULT.reduce((prev, { parser, result: detection }) => {\n        if (prev) {\n            return prev;\n        }\n        return parser(text) ? detection : null;\n    }, null);\n}\nfunction detectStringColorFormat(text, type = 'int') {\n    const r = detectStringColor(text);\n    if (!r) {\n        return null;\n    }\n    if (r.notation === 'hex' && type !== 'float') {\n        return Object.assign(Object.assign({}, r), { type: 'int' });\n    }\n    if (r.notation === 'func') {\n        return Object.assign(Object.assign({}, r), { type: type });\n    }\n    return null;\n}\nfunction createColorStringParser(type) {\n    const parsers = [\n        parseHexRgbColor,\n        parseHexRgbaColor,\n        parseFunctionalRgbColor,\n        parseFunctionalRgbaColor,\n        parseFunctionalHslColor,\n        parseFunctionalHslaColor,\n    ];\n    if (type === 'int') {\n        parsers.push(createObjectRgbColorParser('int'), createObjectRgbaColorParser('int'));\n    }\n    if (type === 'float') {\n        parsers.push(createObjectRgbColorParser('float'), createObjectRgbaColorParser('float'));\n    }\n    const parser = composeParsers(parsers);\n    return (text) => {\n        const result = parser(text);\n        return result ? mapColorType(result, type) : null;\n    };\n}\nfunction readIntColorString(value) {\n    const parser = createColorStringParser('int');\n    if (typeof value !== 'string') {\n        return IntColor.black();\n    }\n    const result = parser(value);\n    return result !== null && result !== void 0 ? result : IntColor.black();\n}\nfunction zerofill(comp) {\n    const hex = constrainRange(Math.floor(comp), 0, 255).toString(16);\n    return hex.length === 1 ? `0${hex}` : hex;\n}\nfunction colorToHexRgbString(value, prefix = '#') {\n    const hexes = removeAlphaComponent(value.getComponents('rgb'))\n        .map(zerofill)\n        .join('');\n    return `${prefix}${hexes}`;\n}\nfunction colorToHexRgbaString(value, prefix = '#') {\n    const rgbaComps = value.getComponents('rgb');\n    const hexes = [rgbaComps[0], rgbaComps[1], rgbaComps[2], rgbaComps[3] * 255]\n        .map(zerofill)\n        .join('');\n    return `${prefix}${hexes}`;\n}\nfunction colorToFunctionalRgbString(value) {\n    const formatter = createNumberFormatter(0);\n    const ci = mapColorType(value, 'int');\n    const comps = removeAlphaComponent(ci.getComponents('rgb')).map((comp) => formatter(comp));\n    return `rgb(${comps.join(', ')})`;\n}\nfunction colorToFunctionalRgbaString(value) {\n    const aFormatter = createNumberFormatter(2);\n    const rgbFormatter = createNumberFormatter(0);\n    const ci = mapColorType(value, 'int');\n    const comps = ci.getComponents('rgb').map((comp, index) => {\n        const formatter = index === 3 ? aFormatter : rgbFormatter;\n        return formatter(comp);\n    });\n    return `rgba(${comps.join(', ')})`;\n}\nfunction colorToFunctionalHslString(value) {\n    const formatters = [\n        createNumberFormatter(0),\n        formatPercentage,\n        formatPercentage,\n    ];\n    const ci = mapColorType(value, 'int');\n    const comps = removeAlphaComponent(ci.getComponents('hsl')).map((comp, index) => formatters[index](comp));\n    return `hsl(${comps.join(', ')})`;\n}\nfunction colorToFunctionalHslaString(value) {\n    const formatters = [\n        createNumberFormatter(0),\n        formatPercentage,\n        formatPercentage,\n        createNumberFormatter(2),\n    ];\n    const ci = mapColorType(value, 'int');\n    const comps = ci\n        .getComponents('hsl')\n        .map((comp, index) => formatters[index](comp));\n    return `hsla(${comps.join(', ')})`;\n}\nfunction colorToObjectRgbString(value, type) {\n    const formatter = createNumberFormatter(type === 'float' ? 2 : 0);\n    const names = ['r', 'g', 'b'];\n    const cc = mapColorType(value, type);\n    const comps = removeAlphaComponent(cc.getComponents('rgb')).map((comp, index) => `${names[index]}: ${formatter(comp)}`);\n    return `{${comps.join(', ')}}`;\n}\nfunction createObjectRgbColorFormatter(type) {\n    return (value) => colorToObjectRgbString(value, type);\n}\nfunction colorToObjectRgbaString(value, type) {\n    const aFormatter = createNumberFormatter(2);\n    const rgbFormatter = createNumberFormatter(type === 'float' ? 2 : 0);\n    const names = ['r', 'g', 'b', 'a'];\n    const cc = mapColorType(value, type);\n    const comps = cc.getComponents('rgb').map((comp, index) => {\n        const formatter = index === 3 ? aFormatter : rgbFormatter;\n        return `${names[index]}: ${formatter(comp)}`;\n    });\n    return `{${comps.join(', ')}}`;\n}\nfunction createObjectRgbaColorFormatter(type) {\n    return (value) => colorToObjectRgbaString(value, type);\n}\nconst FORMAT_AND_STRINGIFIERS = [\n    {\n        format: {\n            alpha: false,\n            mode: 'rgb',\n            notation: 'hex',\n            type: 'int',\n        },\n        stringifier: colorToHexRgbString,\n    },\n    {\n        format: {\n            alpha: true,\n            mode: 'rgb',\n            notation: 'hex',\n            type: 'int',\n        },\n        stringifier: colorToHexRgbaString,\n    },\n    {\n        format: {\n            alpha: false,\n            mode: 'rgb',\n            notation: 'func',\n            type: 'int',\n        },\n        stringifier: colorToFunctionalRgbString,\n    },\n    {\n        format: {\n            alpha: true,\n            mode: 'rgb',\n            notation: 'func',\n            type: 'int',\n        },\n        stringifier: colorToFunctionalRgbaString,\n    },\n    {\n        format: {\n            alpha: false,\n            mode: 'hsl',\n            notation: 'func',\n            type: 'int',\n        },\n        stringifier: colorToFunctionalHslString,\n    },\n    {\n        format: {\n            alpha: true,\n            mode: 'hsl',\n            notation: 'func',\n            type: 'int',\n        },\n        stringifier: colorToFunctionalHslaString,\n    },\n    ...['int', 'float'].reduce((prev, type) => {\n        return [\n            ...prev,\n            {\n                format: {\n                    alpha: false,\n                    mode: 'rgb',\n                    notation: 'object',\n                    type: type,\n                },\n                stringifier: createObjectRgbColorFormatter(type),\n            },\n            {\n                format: {\n                    alpha: true,\n                    mode: 'rgb',\n                    notation: 'object',\n                    type: type,\n                },\n                stringifier: createObjectRgbaColorFormatter(type),\n            },\n        ];\n    }, []),\n];\nfunction findColorStringifier(format) {\n    return FORMAT_AND_STRINGIFIERS.reduce((prev, fas) => {\n        if (prev) {\n            return prev;\n        }\n        return equalsStringColorFormat(fas.format, format)\n            ? fas.stringifier\n            : null;\n    }, null);\n}\n\nconst cn$a = ClassName('apl');\nclass APaletteView {\n    constructor(doc, config) {\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.value = config.value;\n        this.value.emitter.on('change', this.onValueChange_);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$a());\n        config.viewProps.bindClassModifiers(this.element);\n        config.viewProps.bindTabIndex(this.element);\n        const barElem = doc.createElement('div');\n        barElem.classList.add(cn$a('b'));\n        this.element.appendChild(barElem);\n        const colorElem = doc.createElement('div');\n        colorElem.classList.add(cn$a('c'));\n        barElem.appendChild(colorElem);\n        this.colorElem_ = colorElem;\n        const markerElem = doc.createElement('div');\n        markerElem.classList.add(cn$a('m'));\n        this.element.appendChild(markerElem);\n        this.markerElem_ = markerElem;\n        const previewElem = doc.createElement('div');\n        previewElem.classList.add(cn$a('p'));\n        this.markerElem_.appendChild(previewElem);\n        this.previewElem_ = previewElem;\n        this.update_();\n    }\n    update_() {\n        const c = this.value.rawValue;\n        const rgbaComps = c.getComponents('rgb');\n        const leftColor = new IntColor([rgbaComps[0], rgbaComps[1], rgbaComps[2], 0], 'rgb');\n        const rightColor = new IntColor([rgbaComps[0], rgbaComps[1], rgbaComps[2], 255], 'rgb');\n        const gradientComps = [\n            'to right',\n            colorToFunctionalRgbaString(leftColor),\n            colorToFunctionalRgbaString(rightColor),\n        ];\n        this.colorElem_.style.background = `linear-gradient(${gradientComps.join(',')})`;\n        this.previewElem_.style.backgroundColor = colorToFunctionalRgbaString(c);\n        const left = mapRange(rgbaComps[3], 0, 1, 0, 100);\n        this.markerElem_.style.left = `${left}%`;\n    }\n    onValueChange_() {\n        this.update_();\n    }\n}\n\nclass APaletteController {\n    constructor(doc, config) {\n        this.onKeyDown_ = this.onKeyDown_.bind(this);\n        this.onKeyUp_ = this.onKeyUp_.bind(this);\n        this.onPointerDown_ = this.onPointerDown_.bind(this);\n        this.onPointerMove_ = this.onPointerMove_.bind(this);\n        this.onPointerUp_ = this.onPointerUp_.bind(this);\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new APaletteView(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.ptHandler_ = new PointerHandler(this.view.element);\n        this.ptHandler_.emitter.on('down', this.onPointerDown_);\n        this.ptHandler_.emitter.on('move', this.onPointerMove_);\n        this.ptHandler_.emitter.on('up', this.onPointerUp_);\n        this.view.element.addEventListener('keydown', this.onKeyDown_);\n        this.view.element.addEventListener('keyup', this.onKeyUp_);\n    }\n    handlePointerEvent_(d, opts) {\n        if (!d.point) {\n            return;\n        }\n        const alpha = d.point.x / d.bounds.width;\n        const c = this.value.rawValue;\n        const [h, s, v] = c.getComponents('hsv');\n        this.value.setRawValue(new IntColor([h, s, v, alpha], 'hsv'), opts);\n    }\n    onPointerDown_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerMove_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerUp_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n    onKeyDown_(ev) {\n        const step = getStepForKey(getKeyScaleForColor(true), getHorizontalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        const c = this.value.rawValue;\n        const [h, s, v, a] = c.getComponents('hsv');\n        this.value.setRawValue(new IntColor([h, s, v, a + step], 'hsv'), {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onKeyUp_(ev) {\n        const step = getStepForKey(getKeyScaleForColor(true), getHorizontalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        this.value.setRawValue(this.value.rawValue, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n}\n\nconst cn$9 = ClassName('coltxt');\nfunction createModeSelectElement(doc) {\n    const selectElem = doc.createElement('select');\n    const items = [\n        { text: 'RGB', value: 'rgb' },\n        { text: 'HSL', value: 'hsl' },\n        { text: 'HSV', value: 'hsv' },\n        { text: 'HEX', value: 'hex' },\n    ];\n    selectElem.appendChild(items.reduce((frag, item) => {\n        const optElem = doc.createElement('option');\n        optElem.textContent = item.text;\n        optElem.value = item.value;\n        frag.appendChild(optElem);\n        return frag;\n    }, doc.createDocumentFragment()));\n    return selectElem;\n}\nclass ColorTextsView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$9());\n        config.viewProps.bindClassModifiers(this.element);\n        const modeElem = doc.createElement('div');\n        modeElem.classList.add(cn$9('m'));\n        this.modeElem_ = createModeSelectElement(doc);\n        this.modeElem_.classList.add(cn$9('ms'));\n        modeElem.appendChild(this.modeSelectElement);\n        config.viewProps.bindDisabled(this.modeElem_);\n        const modeMarkerElem = doc.createElement('div');\n        modeMarkerElem.classList.add(cn$9('mm'));\n        modeMarkerElem.appendChild(createSvgIconElement(doc, 'dropdown'));\n        modeElem.appendChild(modeMarkerElem);\n        this.element.appendChild(modeElem);\n        const inputsElem = doc.createElement('div');\n        inputsElem.classList.add(cn$9('w'));\n        this.element.appendChild(inputsElem);\n        this.inputsElem_ = inputsElem;\n        this.inputViews_ = config.inputViews;\n        this.applyInputViews_();\n        bindValue(config.mode, (mode) => {\n            this.modeElem_.value = mode;\n        });\n    }\n    get modeSelectElement() {\n        return this.modeElem_;\n    }\n    get inputViews() {\n        return this.inputViews_;\n    }\n    set inputViews(inputViews) {\n        this.inputViews_ = inputViews;\n        this.applyInputViews_();\n    }\n    applyInputViews_() {\n        removeChildElements(this.inputsElem_);\n        const doc = this.element.ownerDocument;\n        this.inputViews_.forEach((v) => {\n            const compElem = doc.createElement('div');\n            compElem.classList.add(cn$9('c'));\n            compElem.appendChild(v.element);\n            this.inputsElem_.appendChild(compElem);\n        });\n    }\n}\n\nfunction createFormatter$2(type) {\n    return createNumberFormatter(type === 'float' ? 2 : 0);\n}\nfunction createConstraint$7(mode, type, index) {\n    const max = getColorMaxComponents(mode, type)[index];\n    return new DefiniteRangeConstraint({\n        min: 0,\n        max: max,\n    });\n}\nfunction createComponentController(doc, config, index) {\n    return new NumberTextController(doc, {\n        arrayPosition: index === 0 ? 'fst' : index === 3 - 1 ? 'lst' : 'mid',\n        parser: config.parser,\n        props: ValueMap.fromObject({\n            formatter: createFormatter$2(config.colorType),\n            keyScale: getKeyScaleForColor(false),\n            pointerScale: config.colorType === 'float' ? 0.01 : 1,\n        }),\n        value: createValue(0, {\n            constraint: createConstraint$7(config.colorMode, config.colorType, index),\n        }),\n        viewProps: config.viewProps,\n    });\n}\nfunction createComponentControllers(doc, config) {\n    const cc = {\n        colorMode: config.colorMode,\n        colorType: config.colorType,\n        parser: parseNumber,\n        viewProps: config.viewProps,\n    };\n    return [0, 1, 2].map((i) => {\n        const c = createComponentController(doc, cc, i);\n        connectValues({\n            primary: config.value,\n            secondary: c.value,\n            forward(p) {\n                const mc = mapColorType(p, config.colorType);\n                return mc.getComponents(config.colorMode)[i];\n            },\n            backward(p, s) {\n                const pickedMode = config.colorMode;\n                const mc = mapColorType(p, config.colorType);\n                const comps = mc.getComponents(pickedMode);\n                comps[i] = s;\n                const c = createColor(appendAlphaComponent(removeAlphaComponent(comps), comps[3]), pickedMode, config.colorType);\n                return mapColorType(c, 'int');\n            },\n        });\n        return c;\n    });\n}\nfunction createHexController(doc, config) {\n    const c = new TextController(doc, {\n        parser: createColorStringParser('int'),\n        props: ValueMap.fromObject({\n            formatter: colorToHexRgbString,\n        }),\n        value: createValue(IntColor.black()),\n        viewProps: config.viewProps,\n    });\n    connectValues({\n        primary: config.value,\n        secondary: c.value,\n        forward: (p) => new IntColor(removeAlphaComponent(p.getComponents()), p.mode),\n        backward: (p, s) => new IntColor(appendAlphaComponent(removeAlphaComponent(s.getComponents(p.mode)), p.getComponents()[3]), p.mode),\n    });\n    return [c];\n}\nfunction isColorMode(mode) {\n    return mode !== 'hex';\n}\nclass ColorTextsController {\n    constructor(doc, config) {\n        this.onModeSelectChange_ = this.onModeSelectChange_.bind(this);\n        this.colorType_ = config.colorType;\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.colorMode = createValue(this.value.rawValue.mode);\n        this.ccs_ = this.createComponentControllers_(doc);\n        this.view = new ColorTextsView(doc, {\n            mode: this.colorMode,\n            inputViews: [this.ccs_[0].view, this.ccs_[1].view, this.ccs_[2].view],\n            viewProps: this.viewProps,\n        });\n        this.view.modeSelectElement.addEventListener('change', this.onModeSelectChange_);\n    }\n    createComponentControllers_(doc) {\n        const mode = this.colorMode.rawValue;\n        if (isColorMode(mode)) {\n            return createComponentControllers(doc, {\n                colorMode: mode,\n                colorType: this.colorType_,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n        }\n        return createHexController(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n    }\n    onModeSelectChange_(ev) {\n        const selectElem = ev.currentTarget;\n        this.colorMode.rawValue = selectElem.value;\n        this.ccs_ = this.createComponentControllers_(this.view.element.ownerDocument);\n        this.view.inputViews = this.ccs_.map((cc) => cc.view);\n    }\n}\n\nconst cn$8 = ClassName('hpl');\nclass HPaletteView {\n    constructor(doc, config) {\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.value = config.value;\n        this.value.emitter.on('change', this.onValueChange_);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$8());\n        config.viewProps.bindClassModifiers(this.element);\n        config.viewProps.bindTabIndex(this.element);\n        const colorElem = doc.createElement('div');\n        colorElem.classList.add(cn$8('c'));\n        this.element.appendChild(colorElem);\n        const markerElem = doc.createElement('div');\n        markerElem.classList.add(cn$8('m'));\n        this.element.appendChild(markerElem);\n        this.markerElem_ = markerElem;\n        this.update_();\n    }\n    update_() {\n        const c = this.value.rawValue;\n        const [h] = c.getComponents('hsv');\n        this.markerElem_.style.backgroundColor = colorToFunctionalRgbString(new IntColor([h, 100, 100], 'hsv'));\n        const left = mapRange(h, 0, 360, 0, 100);\n        this.markerElem_.style.left = `${left}%`;\n    }\n    onValueChange_() {\n        this.update_();\n    }\n}\n\nclass HPaletteController {\n    constructor(doc, config) {\n        this.onKeyDown_ = this.onKeyDown_.bind(this);\n        this.onKeyUp_ = this.onKeyUp_.bind(this);\n        this.onPointerDown_ = this.onPointerDown_.bind(this);\n        this.onPointerMove_ = this.onPointerMove_.bind(this);\n        this.onPointerUp_ = this.onPointerUp_.bind(this);\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new HPaletteView(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.ptHandler_ = new PointerHandler(this.view.element);\n        this.ptHandler_.emitter.on('down', this.onPointerDown_);\n        this.ptHandler_.emitter.on('move', this.onPointerMove_);\n        this.ptHandler_.emitter.on('up', this.onPointerUp_);\n        this.view.element.addEventListener('keydown', this.onKeyDown_);\n        this.view.element.addEventListener('keyup', this.onKeyUp_);\n    }\n    handlePointerEvent_(d, opts) {\n        if (!d.point) {\n            return;\n        }\n        const hue = mapRange(constrainRange(d.point.x, 0, d.bounds.width), 0, d.bounds.width, 0, 360);\n        const c = this.value.rawValue;\n        const [, s, v, a] = c.getComponents('hsv');\n        this.value.setRawValue(new IntColor([hue, s, v, a], 'hsv'), opts);\n    }\n    onPointerDown_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerMove_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerUp_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n    onKeyDown_(ev) {\n        const step = getStepForKey(getKeyScaleForColor(false), getHorizontalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        const c = this.value.rawValue;\n        const [h, s, v, a] = c.getComponents('hsv');\n        this.value.setRawValue(new IntColor([h + step, s, v, a], 'hsv'), {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onKeyUp_(ev) {\n        const step = getStepForKey(getKeyScaleForColor(false), getHorizontalStepKeys(ev));\n        if (step === 0) {\n            return;\n        }\n        this.value.setRawValue(this.value.rawValue, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n}\n\nconst cn$7 = ClassName('svp');\nconst CANVAS_RESOL = 64;\nclass SvPaletteView {\n    constructor(doc, config) {\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.value = config.value;\n        this.value.emitter.on('change', this.onValueChange_);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$7());\n        config.viewProps.bindClassModifiers(this.element);\n        config.viewProps.bindTabIndex(this.element);\n        const canvasElem = doc.createElement('canvas');\n        canvasElem.height = CANVAS_RESOL;\n        canvasElem.width = CANVAS_RESOL;\n        canvasElem.classList.add(cn$7('c'));\n        this.element.appendChild(canvasElem);\n        this.canvasElement = canvasElem;\n        const markerElem = doc.createElement('div');\n        markerElem.classList.add(cn$7('m'));\n        this.element.appendChild(markerElem);\n        this.markerElem_ = markerElem;\n        this.update_();\n    }\n    update_() {\n        const ctx = getCanvasContext(this.canvasElement);\n        if (!ctx) {\n            return;\n        }\n        const c = this.value.rawValue;\n        const hsvComps = c.getComponents('hsv');\n        const width = this.canvasElement.width;\n        const height = this.canvasElement.height;\n        const imgData = ctx.getImageData(0, 0, width, height);\n        const data = imgData.data;\n        for (let iy = 0; iy < height; iy++) {\n            for (let ix = 0; ix < width; ix++) {\n                const s = mapRange(ix, 0, width, 0, 100);\n                const v = mapRange(iy, 0, height, 100, 0);\n                const rgbComps = hsvToRgbInt(hsvComps[0], s, v);\n                const i = (iy * width + ix) * 4;\n                data[i] = rgbComps[0];\n                data[i + 1] = rgbComps[1];\n                data[i + 2] = rgbComps[2];\n                data[i + 3] = 255;\n            }\n        }\n        ctx.putImageData(imgData, 0, 0);\n        const left = mapRange(hsvComps[1], 0, 100, 0, 100);\n        this.markerElem_.style.left = `${left}%`;\n        const top = mapRange(hsvComps[2], 0, 100, 100, 0);\n        this.markerElem_.style.top = `${top}%`;\n    }\n    onValueChange_() {\n        this.update_();\n    }\n}\n\nclass SvPaletteController {\n    constructor(doc, config) {\n        this.onKeyDown_ = this.onKeyDown_.bind(this);\n        this.onKeyUp_ = this.onKeyUp_.bind(this);\n        this.onPointerDown_ = this.onPointerDown_.bind(this);\n        this.onPointerMove_ = this.onPointerMove_.bind(this);\n        this.onPointerUp_ = this.onPointerUp_.bind(this);\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new SvPaletteView(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.ptHandler_ = new PointerHandler(this.view.element);\n        this.ptHandler_.emitter.on('down', this.onPointerDown_);\n        this.ptHandler_.emitter.on('move', this.onPointerMove_);\n        this.ptHandler_.emitter.on('up', this.onPointerUp_);\n        this.view.element.addEventListener('keydown', this.onKeyDown_);\n        this.view.element.addEventListener('keyup', this.onKeyUp_);\n    }\n    handlePointerEvent_(d, opts) {\n        if (!d.point) {\n            return;\n        }\n        const saturation = mapRange(d.point.x, 0, d.bounds.width, 0, 100);\n        const value = mapRange(d.point.y, 0, d.bounds.height, 100, 0);\n        const [h, , , a] = this.value.rawValue.getComponents('hsv');\n        this.value.setRawValue(new IntColor([h, saturation, value, a], 'hsv'), opts);\n    }\n    onPointerDown_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerMove_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerUp_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n    onKeyDown_(ev) {\n        if (isArrowKey(ev.key)) {\n            ev.preventDefault();\n        }\n        const [h, s, v, a] = this.value.rawValue.getComponents('hsv');\n        const keyScale = getKeyScaleForColor(false);\n        const ds = getStepForKey(keyScale, getHorizontalStepKeys(ev));\n        const dv = getStepForKey(keyScale, getVerticalStepKeys(ev));\n        if (ds === 0 && dv === 0) {\n            return;\n        }\n        this.value.setRawValue(new IntColor([h, s + ds, v + dv, a], 'hsv'), {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onKeyUp_(ev) {\n        const keyScale = getKeyScaleForColor(false);\n        const ds = getStepForKey(keyScale, getHorizontalStepKeys(ev));\n        const dv = getStepForKey(keyScale, getVerticalStepKeys(ev));\n        if (ds === 0 && dv === 0) {\n            return;\n        }\n        this.value.setRawValue(this.value.rawValue, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n}\n\nclass ColorPickerController {\n    constructor(doc, config) {\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.hPaletteC_ = new HPaletteController(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.svPaletteC_ = new SvPaletteController(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.alphaIcs_ = config.supportsAlpha\n            ? {\n                palette: new APaletteController(doc, {\n                    value: this.value,\n                    viewProps: this.viewProps,\n                }),\n                text: new NumberTextController(doc, {\n                    parser: parseNumber,\n                    props: ValueMap.fromObject({\n                        pointerScale: 0.01,\n                        keyScale: 0.1,\n                        formatter: createNumberFormatter(2),\n                    }),\n                    value: createValue(0, {\n                        constraint: new DefiniteRangeConstraint({ min: 0, max: 1 }),\n                    }),\n                    viewProps: this.viewProps,\n                }),\n            }\n            : null;\n        if (this.alphaIcs_) {\n            connectValues({\n                primary: this.value,\n                secondary: this.alphaIcs_.text.value,\n                forward: (p) => p.getComponents()[3],\n                backward: (p, s) => {\n                    const comps = p.getComponents();\n                    comps[3] = s;\n                    return new IntColor(comps, p.mode);\n                },\n            });\n        }\n        this.textsC_ = new ColorTextsController(doc, {\n            colorType: config.colorType,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view = new ColorPickerView(doc, {\n            alphaViews: this.alphaIcs_\n                ? {\n                    palette: this.alphaIcs_.palette.view,\n                    text: this.alphaIcs_.text.view,\n                }\n                : null,\n            hPaletteView: this.hPaletteC_.view,\n            supportsAlpha: config.supportsAlpha,\n            svPaletteView: this.svPaletteC_.view,\n            textsView: this.textsC_.view,\n            viewProps: this.viewProps,\n        });\n    }\n    get textsController() {\n        return this.textsC_;\n    }\n}\n\nconst cn$6 = ClassName('colsw');\nclass ColorSwatchView {\n    constructor(doc, config) {\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        config.value.emitter.on('change', this.onValueChange_);\n        this.value = config.value;\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$6());\n        config.viewProps.bindClassModifiers(this.element);\n        const swatchElem = doc.createElement('div');\n        swatchElem.classList.add(cn$6('sw'));\n        this.element.appendChild(swatchElem);\n        this.swatchElem_ = swatchElem;\n        const buttonElem = doc.createElement('button');\n        buttonElem.classList.add(cn$6('b'));\n        config.viewProps.bindDisabled(buttonElem);\n        this.element.appendChild(buttonElem);\n        this.buttonElement = buttonElem;\n        this.update_();\n    }\n    update_() {\n        const value = this.value.rawValue;\n        this.swatchElem_.style.backgroundColor = colorToHexRgbaString(value);\n    }\n    onValueChange_() {\n        this.update_();\n    }\n}\n\nclass ColorSwatchController {\n    constructor(doc, config) {\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new ColorSwatchView(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n    }\n}\n\nclass ColorController {\n    constructor(doc, config) {\n        this.onButtonBlur_ = this.onButtonBlur_.bind(this);\n        this.onButtonClick_ = this.onButtonClick_.bind(this);\n        this.onPopupChildBlur_ = this.onPopupChildBlur_.bind(this);\n        this.onPopupChildKeydown_ = this.onPopupChildKeydown_.bind(this);\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.foldable_ = Foldable.create(config.expanded);\n        this.swatchC_ = new ColorSwatchController(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        const buttonElem = this.swatchC_.view.buttonElement;\n        buttonElem.addEventListener('blur', this.onButtonBlur_);\n        buttonElem.addEventListener('click', this.onButtonClick_);\n        this.textC_ = new TextController(doc, {\n            parser: config.parser,\n            props: ValueMap.fromObject({\n                formatter: config.formatter,\n            }),\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view = new ColorView(doc, {\n            foldable: this.foldable_,\n            pickerLayout: config.pickerLayout,\n        });\n        this.view.swatchElement.appendChild(this.swatchC_.view.element);\n        this.view.textElement.appendChild(this.textC_.view.element);\n        this.popC_ =\n            config.pickerLayout === 'popup'\n                ? new PopupController(doc, {\n                    viewProps: this.viewProps,\n                })\n                : null;\n        const pickerC = new ColorPickerController(doc, {\n            colorType: config.colorType,\n            supportsAlpha: config.supportsAlpha,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        pickerC.view.allFocusableElements.forEach((elem) => {\n            elem.addEventListener('blur', this.onPopupChildBlur_);\n            elem.addEventListener('keydown', this.onPopupChildKeydown_);\n        });\n        this.pickerC_ = pickerC;\n        if (this.popC_) {\n            this.view.element.appendChild(this.popC_.view.element);\n            this.popC_.view.element.appendChild(pickerC.view.element);\n            connectValues({\n                primary: this.foldable_.value('expanded'),\n                secondary: this.popC_.shows,\n                forward: (p) => p,\n                backward: (_, s) => s,\n            });\n        }\n        else if (this.view.pickerElement) {\n            this.view.pickerElement.appendChild(this.pickerC_.view.element);\n            bindFoldable(this.foldable_, this.view.pickerElement);\n        }\n    }\n    get textController() {\n        return this.textC_;\n    }\n    onButtonBlur_(e) {\n        if (!this.popC_) {\n            return;\n        }\n        const elem = this.view.element;\n        const nextTarget = forceCast(e.relatedTarget);\n        if (!nextTarget || !elem.contains(nextTarget)) {\n            this.popC_.shows.rawValue = false;\n        }\n    }\n    onButtonClick_() {\n        this.foldable_.set('expanded', !this.foldable_.get('expanded'));\n        if (this.foldable_.get('expanded')) {\n            this.pickerC_.view.allFocusableElements[0].focus();\n        }\n    }\n    onPopupChildBlur_(ev) {\n        if (!this.popC_) {\n            return;\n        }\n        const elem = this.popC_.view.element;\n        const nextTarget = findNextTarget(ev);\n        if (nextTarget && elem.contains(nextTarget)) {\n            return;\n        }\n        if (nextTarget &&\n            nextTarget === this.swatchC_.view.buttonElement &&\n            !supportsTouch(elem.ownerDocument)) {\n            return;\n        }\n        this.popC_.shows.rawValue = false;\n    }\n    onPopupChildKeydown_(ev) {\n        if (this.popC_) {\n            if (ev.key === 'Escape') {\n                this.popC_.shows.rawValue = false;\n            }\n        }\n        else if (this.view.pickerElement) {\n            if (ev.key === 'Escape') {\n                this.swatchC_.view.buttonElement.focus();\n            }\n        }\n    }\n}\n\nfunction colorToRgbNumber(value) {\n    return removeAlphaComponent(value.getComponents('rgb')).reduce((result, comp) => {\n        return (result << 8) | (Math.floor(comp) & 0xff);\n    }, 0);\n}\nfunction colorToRgbaNumber(value) {\n    return (value.getComponents('rgb').reduce((result, comp, index) => {\n        const hex = Math.floor(index === 3 ? comp * 255 : comp) & 0xff;\n        return (result << 8) | hex;\n    }, 0) >>> 0);\n}\nfunction numberToRgbColor(num) {\n    return new IntColor([(num >> 16) & 0xff, (num >> 8) & 0xff, num & 0xff], 'rgb');\n}\nfunction numberToRgbaColor(num) {\n    return new IntColor([\n        (num >> 24) & 0xff,\n        (num >> 16) & 0xff,\n        (num >> 8) & 0xff,\n        mapRange(num & 0xff, 0, 255, 0, 1),\n    ], 'rgb');\n}\nfunction colorFromRgbNumber(value) {\n    if (typeof value !== 'number') {\n        return IntColor.black();\n    }\n    return numberToRgbColor(value);\n}\nfunction colorFromRgbaNumber(value) {\n    if (typeof value !== 'number') {\n        return IntColor.black();\n    }\n    return numberToRgbaColor(value);\n}\n\nfunction isRgbColorComponent(obj, key) {\n    if (typeof obj !== 'object' || isEmpty(obj)) {\n        return false;\n    }\n    return key in obj && typeof obj[key] === 'number';\n}\nfunction isRgbColorObject(obj) {\n    return (isRgbColorComponent(obj, 'r') &&\n        isRgbColorComponent(obj, 'g') &&\n        isRgbColorComponent(obj, 'b'));\n}\nfunction isRgbaColorObject(obj) {\n    return isRgbColorObject(obj) && isRgbColorComponent(obj, 'a');\n}\nfunction isColorObject(obj) {\n    return isRgbColorObject(obj);\n}\nfunction equalsColor(v1, v2) {\n    if (v1.mode !== v2.mode) {\n        return false;\n    }\n    if (v1.type !== v2.type) {\n        return false;\n    }\n    const comps1 = v1.getComponents();\n    const comps2 = v2.getComponents();\n    for (let i = 0; i < comps1.length; i++) {\n        if (comps1[i] !== comps2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction createColorComponentsFromRgbObject(obj) {\n    return 'a' in obj ? [obj.r, obj.g, obj.b, obj.a] : [obj.r, obj.g, obj.b];\n}\n\nfunction createColorStringWriter(format) {\n    const stringify = findColorStringifier(format);\n    return stringify\n        ? (target, value) => {\n            writePrimitive(target, stringify(value));\n        }\n        : null;\n}\nfunction createColorNumberWriter(supportsAlpha) {\n    const colorToNumber = supportsAlpha ? colorToRgbaNumber : colorToRgbNumber;\n    return (target, value) => {\n        writePrimitive(target, colorToNumber(value));\n    };\n}\nfunction writeRgbaColorObject(target, value, type) {\n    const cc = mapColorType(value, type);\n    const obj = cc.toRgbaObject();\n    target.writeProperty('r', obj.r);\n    target.writeProperty('g', obj.g);\n    target.writeProperty('b', obj.b);\n    target.writeProperty('a', obj.a);\n}\nfunction writeRgbColorObject(target, value, type) {\n    const cc = mapColorType(value, type);\n    const obj = cc.toRgbaObject();\n    target.writeProperty('r', obj.r);\n    target.writeProperty('g', obj.g);\n    target.writeProperty('b', obj.b);\n}\nfunction createColorObjectWriter(supportsAlpha, type) {\n    return (target, inValue) => {\n        if (supportsAlpha) {\n            writeRgbaColorObject(target, inValue, type);\n        }\n        else {\n            writeRgbColorObject(target, inValue, type);\n        }\n    };\n}\n\nfunction shouldSupportAlpha$1(inputParams) {\n    var _a;\n    if ((_a = inputParams === null || inputParams === void 0 ? void 0 : inputParams.color) === null || _a === void 0 ? void 0 : _a.alpha) {\n        return true;\n    }\n    return false;\n}\nfunction createFormatter$1(supportsAlpha) {\n    return supportsAlpha\n        ? (v) => colorToHexRgbaString(v, '0x')\n        : (v) => colorToHexRgbString(v, '0x');\n}\nfunction isForColor(params) {\n    if ('color' in params) {\n        return true;\n    }\n    if (params.view === 'color') {\n        return true;\n    }\n    return false;\n}\ncreatePlugin({\n    id: 'input-color-number',\n    type: 'input',\n    accept: (value, params) => {\n        if (typeof value !== 'number') {\n            return null;\n        }\n        if (!isForColor(params)) {\n            return null;\n        }\n        const result = parseColorInputParams(params);\n        return result\n            ? {\n                initialValue: value,\n                params: Object.assign(Object.assign({}, result), { supportsAlpha: shouldSupportAlpha$1(params) }),\n            }\n            : null;\n    },\n    binding: {\n        reader: (args) => {\n            return args.params.supportsAlpha\n                ? colorFromRgbaNumber\n                : colorFromRgbNumber;\n        },\n        equals: equalsColor,\n        writer: (args) => {\n            return createColorNumberWriter(args.params.supportsAlpha);\n        },\n    },\n    controller: (args) => {\n        var _a, _b;\n        return new ColorController(args.document, {\n            colorType: 'int',\n            expanded: (_a = args.params.expanded) !== null && _a !== void 0 ? _a : false,\n            formatter: createFormatter$1(args.params.supportsAlpha),\n            parser: createColorStringParser('int'),\n            pickerLayout: (_b = args.params.picker) !== null && _b !== void 0 ? _b : 'popup',\n            supportsAlpha: args.params.supportsAlpha,\n            value: args.value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nfunction colorFromObject(value, type) {\n    if (!isColorObject(value)) {\n        return mapColorType(IntColor.black(), type);\n    }\n    if (type === 'int') {\n        const comps = createColorComponentsFromRgbObject(value);\n        return new IntColor(comps, 'rgb');\n    }\n    if (type === 'float') {\n        const comps = createColorComponentsFromRgbObject(value);\n        return new FloatColor(comps, 'rgb');\n    }\n    return mapColorType(IntColor.black(), 'int');\n}\n\nfunction shouldSupportAlpha(initialValue) {\n    return isRgbaColorObject(initialValue);\n}\nfunction createColorObjectBindingReader(type) {\n    return (value) => {\n        const c = colorFromObject(value, type);\n        return mapColorType(c, 'int');\n    };\n}\nfunction createColorObjectFormatter(supportsAlpha, type) {\n    return (value) => {\n        if (supportsAlpha) {\n            return colorToObjectRgbaString(value, type);\n        }\n        return colorToObjectRgbString(value, type);\n    };\n}\ncreatePlugin({\n    id: 'input-color-object',\n    type: 'input',\n    accept: (value, params) => {\n        var _a;\n        if (!isColorObject(value)) {\n            return null;\n        }\n        const result = parseColorInputParams(params);\n        return result\n            ? {\n                initialValue: value,\n                params: Object.assign(Object.assign({}, result), { colorType: (_a = extractColorType(params)) !== null && _a !== void 0 ? _a : 'int' }),\n            }\n            : null;\n    },\n    binding: {\n        reader: (args) => createColorObjectBindingReader(args.params.colorType),\n        equals: equalsColor,\n        writer: (args) => createColorObjectWriter(shouldSupportAlpha(args.initialValue), args.params.colorType),\n    },\n    controller: (args) => {\n        var _a, _b;\n        const supportsAlpha = isRgbaColorObject(args.initialValue);\n        return new ColorController(args.document, {\n            colorType: args.params.colorType,\n            expanded: (_a = args.params.expanded) !== null && _a !== void 0 ? _a : false,\n            formatter: createColorObjectFormatter(supportsAlpha, args.params.colorType),\n            parser: createColorStringParser('int'),\n            pickerLayout: (_b = args.params.picker) !== null && _b !== void 0 ? _b : 'popup',\n            supportsAlpha: supportsAlpha,\n            value: args.value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\ncreatePlugin({\n    id: 'input-color-string',\n    type: 'input',\n    accept: (value, params) => {\n        if (typeof value !== 'string') {\n            return null;\n        }\n        if (params.view === 'text') {\n            return null;\n        }\n        const format = detectStringColorFormat(value, extractColorType(params));\n        if (!format) {\n            return null;\n        }\n        const stringifier = findColorStringifier(format);\n        if (!stringifier) {\n            return null;\n        }\n        const result = parseColorInputParams(params);\n        return result\n            ? {\n                initialValue: value,\n                params: Object.assign(Object.assign({}, result), { format: format, stringifier: stringifier }),\n            }\n            : null;\n    },\n    binding: {\n        reader: () => readIntColorString,\n        equals: equalsColor,\n        writer: (args) => {\n            const writer = createColorStringWriter(args.params.format);\n            if (!writer) {\n                throw TpError.notBindable();\n            }\n            return writer;\n        },\n    },\n    controller: (args) => {\n        var _a, _b;\n        return new ColorController(args.document, {\n            colorType: args.params.format.type,\n            expanded: (_a = args.params.expanded) !== null && _a !== void 0 ? _a : false,\n            formatter: args.params.stringifier,\n            parser: createColorStringParser('int'),\n            pickerLayout: (_b = args.params.picker) !== null && _b !== void 0 ? _b : 'popup',\n            supportsAlpha: args.params.format.alpha,\n            value: args.value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nclass PointNdConstraint {\n    constructor(config) {\n        this.components = config.components;\n        this.asm_ = config.assembly;\n    }\n    constrain(value) {\n        const comps = this.asm_\n            .toComponents(value)\n            .map((comp, index) => { var _a, _b; return (_b = (_a = this.components[index]) === null || _a === void 0 ? void 0 : _a.constrain(comp)) !== null && _b !== void 0 ? _b : comp; });\n        return this.asm_.fromComponents(comps);\n    }\n}\n\nconst cn$5 = ClassName('pndtxt');\nclass PointNdTextView {\n    constructor(doc, config) {\n        this.textViews = config.textViews;\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$5());\n        this.textViews.forEach((v) => {\n            const axisElem = doc.createElement('div');\n            axisElem.classList.add(cn$5('a'));\n            axisElem.appendChild(v.element);\n            this.element.appendChild(axisElem);\n        });\n    }\n}\n\nfunction createAxisController(doc, config, index) {\n    return new NumberTextController(doc, {\n        arrayPosition: index === 0 ? 'fst' : index === config.axes.length - 1 ? 'lst' : 'mid',\n        parser: config.parser,\n        props: config.axes[index].textProps,\n        value: createValue(0, {\n            constraint: config.axes[index].constraint,\n        }),\n        viewProps: config.viewProps,\n    });\n}\nclass PointNdTextController {\n    constructor(doc, config) {\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.acs_ = config.axes.map((_, index) => createAxisController(doc, config, index));\n        this.acs_.forEach((c, index) => {\n            connectValues({\n                primary: this.value,\n                secondary: c.value,\n                forward: (p) => config.assembly.toComponents(p)[index],\n                backward: (p, s) => {\n                    const comps = config.assembly.toComponents(p);\n                    comps[index] = s;\n                    return config.assembly.fromComponents(comps);\n                },\n            });\n        });\n        this.view = new PointNdTextView(doc, {\n            textViews: this.acs_.map((ac) => ac.view),\n        });\n    }\n    get textControllers() {\n        return this.acs_;\n    }\n}\n\nclass SliderInputBindingApi extends BindingApi {\n    get max() {\n        return this.controller.valueController.sliderController.props.get('max');\n    }\n    set max(max) {\n        this.controller.valueController.sliderController.props.set('max', max);\n    }\n    get min() {\n        return this.controller.valueController.sliderController.props.get('min');\n    }\n    set min(max) {\n        this.controller.valueController.sliderController.props.set('min', max);\n    }\n}\n\nfunction createConstraint$6(params, initialValue) {\n    const constraints = [];\n    const sc = createStepConstraint(params, initialValue);\n    if (sc) {\n        constraints.push(sc);\n    }\n    const rc = createRangeConstraint(params);\n    if (rc) {\n        constraints.push(rc);\n    }\n    const lc = createListConstraint(params.options);\n    if (lc) {\n        constraints.push(lc);\n    }\n    return new CompositeConstraint(constraints);\n}\ncreatePlugin({\n    id: 'input-number',\n    type: 'input',\n    accept: (value, params) => {\n        if (typeof value !== 'number') {\n            return null;\n        }\n        const result = parseRecord(params, (p) => (Object.assign(Object.assign({}, createNumberTextInputParamsParser(p)), { options: p.optional.custom(parseListOptions), readonly: p.optional.constant(false) })));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: (_args) => numberFromUnknown,\n        constraint: (args) => createConstraint$6(args.params, args.initialValue),\n        writer: (_args) => writePrimitive,\n    },\n    controller: (args) => {\n        const value = args.value;\n        const c = args.constraint;\n        const lc = c && findConstraint(c, ListConstraint);\n        if (lc) {\n            return new ListController(args.document, {\n                props: new ValueMap({\n                    options: lc.values.value('options'),\n                }),\n                value: value,\n                viewProps: args.viewProps,\n            });\n        }\n        const textPropsObj = createNumberTextPropsObject(args.params, value.rawValue);\n        const drc = c && findConstraint(c, DefiniteRangeConstraint);\n        if (drc) {\n            return new SliderTextController(args.document, Object.assign(Object.assign({}, createSliderTextProps(Object.assign(Object.assign({}, textPropsObj), { keyScale: createValue(textPropsObj.keyScale), max: drc.values.value('max'), min: drc.values.value('min') }))), { parser: parseNumber, value: value, viewProps: args.viewProps }));\n        }\n        return new NumberTextController(args.document, {\n            parser: parseNumber,\n            props: ValueMap.fromObject(textPropsObj),\n            value: value,\n            viewProps: args.viewProps,\n        });\n    },\n    api(args) {\n        if (typeof args.controller.value.rawValue !== 'number') {\n            return null;\n        }\n        if (args.controller.valueController instanceof SliderTextController) {\n            return new SliderInputBindingApi(args.controller);\n        }\n        if (args.controller.valueController instanceof ListController) {\n            return new ListInputBindingApi(args.controller);\n        }\n        return null;\n    },\n});\n\nclass Point2d {\n    constructor(x = 0, y = 0) {\n        this.x = x;\n        this.y = y;\n    }\n    getComponents() {\n        return [this.x, this.y];\n    }\n    static isObject(obj) {\n        if (isEmpty(obj)) {\n            return false;\n        }\n        const x = obj.x;\n        const y = obj.y;\n        if (typeof x !== 'number' || typeof y !== 'number') {\n            return false;\n        }\n        return true;\n    }\n    static equals(v1, v2) {\n        return v1.x === v2.x && v1.y === v2.y;\n    }\n    toObject() {\n        return {\n            x: this.x,\n            y: this.y,\n        };\n    }\n}\nconst Point2dAssembly = {\n    toComponents: (p) => p.getComponents(),\n    fromComponents: (comps) => new Point2d(...comps),\n};\n\nconst cn$4 = ClassName('p2d');\nclass Point2dView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$4());\n        config.viewProps.bindClassModifiers(this.element);\n        bindValue(config.expanded, valueToClassName(this.element, cn$4(undefined, 'expanded')));\n        const headElem = doc.createElement('div');\n        headElem.classList.add(cn$4('h'));\n        this.element.appendChild(headElem);\n        const buttonElem = doc.createElement('button');\n        buttonElem.classList.add(cn$4('b'));\n        buttonElem.appendChild(createSvgIconElement(doc, 'p2dpad'));\n        config.viewProps.bindDisabled(buttonElem);\n        headElem.appendChild(buttonElem);\n        this.buttonElement = buttonElem;\n        const textElem = doc.createElement('div');\n        textElem.classList.add(cn$4('t'));\n        headElem.appendChild(textElem);\n        this.textElement = textElem;\n        if (config.pickerLayout === 'inline') {\n            const pickerElem = doc.createElement('div');\n            pickerElem.classList.add(cn$4('p'));\n            this.element.appendChild(pickerElem);\n            this.pickerElement = pickerElem;\n        }\n        else {\n            this.pickerElement = null;\n        }\n    }\n}\n\nconst cn$3 = ClassName('p2dp');\nclass Point2dPickerView {\n    constructor(doc, config) {\n        this.onFoldableChange_ = this.onFoldableChange_.bind(this);\n        this.onPropsChange_ = this.onPropsChange_.bind(this);\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.props_ = config.props;\n        this.props_.emitter.on('change', this.onPropsChange_);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$3());\n        if (config.layout === 'popup') {\n            this.element.classList.add(cn$3(undefined, 'p'));\n        }\n        config.viewProps.bindClassModifiers(this.element);\n        const padElem = doc.createElement('div');\n        padElem.classList.add(cn$3('p'));\n        config.viewProps.bindTabIndex(padElem);\n        this.element.appendChild(padElem);\n        this.padElement = padElem;\n        const svgElem = doc.createElementNS(SVG_NS, 'svg');\n        svgElem.classList.add(cn$3('g'));\n        this.padElement.appendChild(svgElem);\n        this.svgElem_ = svgElem;\n        const xAxisElem = doc.createElementNS(SVG_NS, 'line');\n        xAxisElem.classList.add(cn$3('ax'));\n        xAxisElem.setAttributeNS(null, 'x1', '0');\n        xAxisElem.setAttributeNS(null, 'y1', '50%');\n        xAxisElem.setAttributeNS(null, 'x2', '100%');\n        xAxisElem.setAttributeNS(null, 'y2', '50%');\n        this.svgElem_.appendChild(xAxisElem);\n        const yAxisElem = doc.createElementNS(SVG_NS, 'line');\n        yAxisElem.classList.add(cn$3('ax'));\n        yAxisElem.setAttributeNS(null, 'x1', '50%');\n        yAxisElem.setAttributeNS(null, 'y1', '0');\n        yAxisElem.setAttributeNS(null, 'x2', '50%');\n        yAxisElem.setAttributeNS(null, 'y2', '100%');\n        this.svgElem_.appendChild(yAxisElem);\n        const lineElem = doc.createElementNS(SVG_NS, 'line');\n        lineElem.classList.add(cn$3('l'));\n        lineElem.setAttributeNS(null, 'x1', '50%');\n        lineElem.setAttributeNS(null, 'y1', '50%');\n        this.svgElem_.appendChild(lineElem);\n        this.lineElem_ = lineElem;\n        const markerElem = doc.createElement('div');\n        markerElem.classList.add(cn$3('m'));\n        this.padElement.appendChild(markerElem);\n        this.markerElem_ = markerElem;\n        config.value.emitter.on('change', this.onValueChange_);\n        this.value = config.value;\n        this.update_();\n    }\n    get allFocusableElements() {\n        return [this.padElement];\n    }\n    update_() {\n        const [x, y] = this.value.rawValue.getComponents();\n        const max = this.props_.get('max');\n        const px = mapRange(x, -max, +max, 0, 100);\n        const py = mapRange(y, -max, +max, 0, 100);\n        const ipy = this.props_.get('invertsY') ? 100 - py : py;\n        this.lineElem_.setAttributeNS(null, 'x2', `${px}%`);\n        this.lineElem_.setAttributeNS(null, 'y2', `${ipy}%`);\n        this.markerElem_.style.left = `${px}%`;\n        this.markerElem_.style.top = `${ipy}%`;\n    }\n    onValueChange_() {\n        this.update_();\n    }\n    onPropsChange_() {\n        this.update_();\n    }\n    onFoldableChange_() {\n        this.update_();\n    }\n}\n\nfunction computeOffset(ev, keyScales, invertsY) {\n    return [\n        getStepForKey(keyScales[0], getHorizontalStepKeys(ev)),\n        getStepForKey(keyScales[1], getVerticalStepKeys(ev)) * (invertsY ? 1 : -1),\n    ];\n}\nclass Point2dPickerController {\n    constructor(doc, config) {\n        this.onPadKeyDown_ = this.onPadKeyDown_.bind(this);\n        this.onPadKeyUp_ = this.onPadKeyUp_.bind(this);\n        this.onPointerDown_ = this.onPointerDown_.bind(this);\n        this.onPointerMove_ = this.onPointerMove_.bind(this);\n        this.onPointerUp_ = this.onPointerUp_.bind(this);\n        this.props = config.props;\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new Point2dPickerView(doc, {\n            layout: config.layout,\n            props: this.props,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.ptHandler_ = new PointerHandler(this.view.padElement);\n        this.ptHandler_.emitter.on('down', this.onPointerDown_);\n        this.ptHandler_.emitter.on('move', this.onPointerMove_);\n        this.ptHandler_.emitter.on('up', this.onPointerUp_);\n        this.view.padElement.addEventListener('keydown', this.onPadKeyDown_);\n        this.view.padElement.addEventListener('keyup', this.onPadKeyUp_);\n    }\n    handlePointerEvent_(d, opts) {\n        if (!d.point) {\n            return;\n        }\n        const max = this.props.get('max');\n        const px = mapRange(d.point.x, 0, d.bounds.width, -max, +max);\n        const py = mapRange(this.props.get('invertsY') ? d.bounds.height - d.point.y : d.point.y, 0, d.bounds.height, -max, +max);\n        this.value.setRawValue(new Point2d(px, py), opts);\n    }\n    onPointerDown_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerMove_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerUp_(ev) {\n        this.handlePointerEvent_(ev.data, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n    onPadKeyDown_(ev) {\n        if (isArrowKey(ev.key)) {\n            ev.preventDefault();\n        }\n        const [dx, dy] = computeOffset(ev, [this.props.get('xKeyScale'), this.props.get('yKeyScale')], this.props.get('invertsY'));\n        if (dx === 0 && dy === 0) {\n            return;\n        }\n        this.value.setRawValue(new Point2d(this.value.rawValue.x + dx, this.value.rawValue.y + dy), {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPadKeyUp_(ev) {\n        const [dx, dy] = computeOffset(ev, [this.props.get('xKeyScale'), this.props.get('yKeyScale')], this.props.get('invertsY'));\n        if (dx === 0 && dy === 0) {\n            return;\n        }\n        this.value.setRawValue(this.value.rawValue, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n}\n\nclass Point2dController {\n    constructor(doc, config) {\n        var _a, _b;\n        this.onPopupChildBlur_ = this.onPopupChildBlur_.bind(this);\n        this.onPopupChildKeydown_ = this.onPopupChildKeydown_.bind(this);\n        this.onPadButtonBlur_ = this.onPadButtonBlur_.bind(this);\n        this.onPadButtonClick_ = this.onPadButtonClick_.bind(this);\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.foldable_ = Foldable.create(config.expanded);\n        this.popC_ =\n            config.pickerLayout === 'popup'\n                ? new PopupController(doc, {\n                    viewProps: this.viewProps,\n                })\n                : null;\n        const padC = new Point2dPickerController(doc, {\n            layout: config.pickerLayout,\n            props: new ValueMap({\n                invertsY: createValue(config.invertsY),\n                max: createValue(config.max),\n                xKeyScale: config.axes[0].textProps.value('keyScale'),\n                yKeyScale: config.axes[1].textProps.value('keyScale'),\n            }),\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        padC.view.allFocusableElements.forEach((elem) => {\n            elem.addEventListener('blur', this.onPopupChildBlur_);\n            elem.addEventListener('keydown', this.onPopupChildKeydown_);\n        });\n        this.pickerC_ = padC;\n        this.textC_ = new PointNdTextController(doc, {\n            assembly: Point2dAssembly,\n            axes: config.axes,\n            parser: config.parser,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view = new Point2dView(doc, {\n            expanded: this.foldable_.value('expanded'),\n            pickerLayout: config.pickerLayout,\n            viewProps: this.viewProps,\n        });\n        this.view.textElement.appendChild(this.textC_.view.element);\n        (_a = this.view.buttonElement) === null || _a === void 0 ? void 0 : _a.addEventListener('blur', this.onPadButtonBlur_);\n        (_b = this.view.buttonElement) === null || _b === void 0 ? void 0 : _b.addEventListener('click', this.onPadButtonClick_);\n        if (this.popC_) {\n            this.view.element.appendChild(this.popC_.view.element);\n            this.popC_.view.element.appendChild(this.pickerC_.view.element);\n            connectValues({\n                primary: this.foldable_.value('expanded'),\n                secondary: this.popC_.shows,\n                forward: (p) => p,\n                backward: (_, s) => s,\n            });\n        }\n        else if (this.view.pickerElement) {\n            this.view.pickerElement.appendChild(this.pickerC_.view.element);\n            bindFoldable(this.foldable_, this.view.pickerElement);\n        }\n    }\n    get textController() {\n        return this.textC_;\n    }\n    onPadButtonBlur_(e) {\n        if (!this.popC_) {\n            return;\n        }\n        const elem = this.view.element;\n        const nextTarget = forceCast(e.relatedTarget);\n        if (!nextTarget || !elem.contains(nextTarget)) {\n            this.popC_.shows.rawValue = false;\n        }\n    }\n    onPadButtonClick_() {\n        this.foldable_.set('expanded', !this.foldable_.get('expanded'));\n        if (this.foldable_.get('expanded')) {\n            this.pickerC_.view.allFocusableElements[0].focus();\n        }\n    }\n    onPopupChildBlur_(ev) {\n        if (!this.popC_) {\n            return;\n        }\n        const elem = this.popC_.view.element;\n        const nextTarget = findNextTarget(ev);\n        if (nextTarget && elem.contains(nextTarget)) {\n            return;\n        }\n        if (nextTarget &&\n            nextTarget === this.view.buttonElement &&\n            !supportsTouch(elem.ownerDocument)) {\n            return;\n        }\n        this.popC_.shows.rawValue = false;\n    }\n    onPopupChildKeydown_(ev) {\n        if (this.popC_) {\n            if (ev.key === 'Escape') {\n                this.popC_.shows.rawValue = false;\n            }\n        }\n        else if (this.view.pickerElement) {\n            if (ev.key === 'Escape') {\n                this.view.buttonElement.focus();\n            }\n        }\n    }\n}\n\nfunction point2dFromUnknown(value) {\n    return Point2d.isObject(value)\n        ? new Point2d(value.x, value.y)\n        : new Point2d();\n}\nfunction writePoint2d(target, value) {\n    target.writeProperty('x', value.x);\n    target.writeProperty('y', value.y);\n}\n\nfunction createConstraint$5(params, initialValue) {\n    return new PointNdConstraint({\n        assembly: Point2dAssembly,\n        components: [\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.x), initialValue.x),\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.y), initialValue.y),\n        ],\n    });\n}\nfunction getSuitableMaxDimensionValue(params, rawValue) {\n    var _a, _b;\n    if (!isEmpty(params.min) || !isEmpty(params.max)) {\n        return Math.max(Math.abs((_a = params.min) !== null && _a !== void 0 ? _a : 0), Math.abs((_b = params.max) !== null && _b !== void 0 ? _b : 0));\n    }\n    const step = getSuitableKeyScale(params);\n    return Math.max(Math.abs(step) * 10, Math.abs(rawValue) * 10);\n}\nfunction getSuitableMax(params, initialValue) {\n    var _a, _b;\n    const xr = getSuitableMaxDimensionValue(deepMerge(params, ((_a = params.x) !== null && _a !== void 0 ? _a : {})), initialValue.x);\n    const yr = getSuitableMaxDimensionValue(deepMerge(params, ((_b = params.y) !== null && _b !== void 0 ? _b : {})), initialValue.y);\n    return Math.max(xr, yr);\n}\nfunction shouldInvertY(params) {\n    if (!('y' in params)) {\n        return false;\n    }\n    const yParams = params.y;\n    if (!yParams) {\n        return false;\n    }\n    return 'inverted' in yParams ? !!yParams.inverted : false;\n}\ncreatePlugin({\n    id: 'input-point2d',\n    type: 'input',\n    accept: (value, params) => {\n        if (!Point2d.isObject(value)) {\n            return null;\n        }\n        const result = parseRecord(params, (p) => (Object.assign(Object.assign({}, createPointDimensionParser(p)), { expanded: p.optional.boolean, picker: p.optional.custom(parsePickerLayout), readonly: p.optional.constant(false), x: p.optional.custom(parsePointDimensionParams), y: p.optional.object(Object.assign(Object.assign({}, createPointDimensionParser(p)), { inverted: p.optional.boolean })) })));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: () => point2dFromUnknown,\n        constraint: (args) => createConstraint$5(args.params, args.initialValue),\n        equals: Point2d.equals,\n        writer: () => writePoint2d,\n    },\n    controller: (args) => {\n        var _a, _b;\n        const doc = args.document;\n        const value = args.value;\n        const c = args.constraint;\n        const dParams = [args.params.x, args.params.y];\n        return new Point2dController(doc, {\n            axes: value.rawValue.getComponents().map((comp, i) => {\n                var _a;\n                return createPointAxis({\n                    constraint: c.components[i],\n                    initialValue: comp,\n                    params: deepMerge(args.params, ((_a = dParams[i]) !== null && _a !== void 0 ? _a : {})),\n                });\n            }),\n            expanded: (_a = args.params.expanded) !== null && _a !== void 0 ? _a : false,\n            invertsY: shouldInvertY(args.params),\n            max: getSuitableMax(args.params, value.rawValue),\n            parser: parseNumber,\n            pickerLayout: (_b = args.params.picker) !== null && _b !== void 0 ? _b : 'popup',\n            value: value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nclass Point3d {\n    constructor(x = 0, y = 0, z = 0) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n    }\n    getComponents() {\n        return [this.x, this.y, this.z];\n    }\n    static isObject(obj) {\n        if (isEmpty(obj)) {\n            return false;\n        }\n        const x = obj.x;\n        const y = obj.y;\n        const z = obj.z;\n        if (typeof x !== 'number' ||\n            typeof y !== 'number' ||\n            typeof z !== 'number') {\n            return false;\n        }\n        return true;\n    }\n    static equals(v1, v2) {\n        return v1.x === v2.x && v1.y === v2.y && v1.z === v2.z;\n    }\n    toObject() {\n        return {\n            x: this.x,\n            y: this.y,\n            z: this.z,\n        };\n    }\n}\nconst Point3dAssembly = {\n    toComponents: (p) => p.getComponents(),\n    fromComponents: (comps) => new Point3d(...comps),\n};\n\nfunction point3dFromUnknown(value) {\n    return Point3d.isObject(value)\n        ? new Point3d(value.x, value.y, value.z)\n        : new Point3d();\n}\nfunction writePoint3d(target, value) {\n    target.writeProperty('x', value.x);\n    target.writeProperty('y', value.y);\n    target.writeProperty('z', value.z);\n}\n\nfunction createConstraint$4(params, initialValue) {\n    return new PointNdConstraint({\n        assembly: Point3dAssembly,\n        components: [\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.x), initialValue.x),\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.y), initialValue.y),\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.z), initialValue.z),\n        ],\n    });\n}\ncreatePlugin({\n    id: 'input-point3d',\n    type: 'input',\n    accept: (value, params) => {\n        if (!Point3d.isObject(value)) {\n            return null;\n        }\n        const result = parseRecord(params, (p) => (Object.assign(Object.assign({}, createPointDimensionParser(p)), { readonly: p.optional.constant(false), x: p.optional.custom(parsePointDimensionParams), y: p.optional.custom(parsePointDimensionParams), z: p.optional.custom(parsePointDimensionParams) })));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: (_args) => point3dFromUnknown,\n        constraint: (args) => createConstraint$4(args.params, args.initialValue),\n        equals: Point3d.equals,\n        writer: (_args) => writePoint3d,\n    },\n    controller: (args) => {\n        const value = args.value;\n        const c = args.constraint;\n        const dParams = [args.params.x, args.params.y, args.params.z];\n        return new PointNdTextController(args.document, {\n            assembly: Point3dAssembly,\n            axes: value.rawValue.getComponents().map((comp, i) => {\n                var _a;\n                return createPointAxis({\n                    constraint: c.components[i],\n                    initialValue: comp,\n                    params: deepMerge(args.params, ((_a = dParams[i]) !== null && _a !== void 0 ? _a : {})),\n                });\n            }),\n            parser: parseNumber,\n            value: value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nclass Point4d {\n    constructor(x = 0, y = 0, z = 0, w = 0) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n        this.w = w;\n    }\n    getComponents() {\n        return [this.x, this.y, this.z, this.w];\n    }\n    static isObject(obj) {\n        if (isEmpty(obj)) {\n            return false;\n        }\n        const x = obj.x;\n        const y = obj.y;\n        const z = obj.z;\n        const w = obj.w;\n        if (typeof x !== 'number' ||\n            typeof y !== 'number' ||\n            typeof z !== 'number' ||\n            typeof w !== 'number') {\n            return false;\n        }\n        return true;\n    }\n    static equals(v1, v2) {\n        return v1.x === v2.x && v1.y === v2.y && v1.z === v2.z && v1.w === v2.w;\n    }\n    toObject() {\n        return {\n            x: this.x,\n            y: this.y,\n            z: this.z,\n            w: this.w,\n        };\n    }\n}\nconst Point4dAssembly = {\n    toComponents: (p) => p.getComponents(),\n    fromComponents: (comps) => new Point4d(...comps),\n};\n\nfunction point4dFromUnknown(value) {\n    return Point4d.isObject(value)\n        ? new Point4d(value.x, value.y, value.z, value.w)\n        : new Point4d();\n}\nfunction writePoint4d(target, value) {\n    target.writeProperty('x', value.x);\n    target.writeProperty('y', value.y);\n    target.writeProperty('z', value.z);\n    target.writeProperty('w', value.w);\n}\n\nfunction createConstraint$3(params, initialValue) {\n    return new PointNdConstraint({\n        assembly: Point4dAssembly,\n        components: [\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.x), initialValue.x),\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.y), initialValue.y),\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.z), initialValue.z),\n            createDimensionConstraint(Object.assign(Object.assign({}, params), params.w), initialValue.w),\n        ],\n    });\n}\ncreatePlugin({\n    id: 'input-point4d',\n    type: 'input',\n    accept: (value, params) => {\n        if (!Point4d.isObject(value)) {\n            return null;\n        }\n        const result = parseRecord(params, (p) => (Object.assign(Object.assign({}, createPointDimensionParser(p)), { readonly: p.optional.constant(false), w: p.optional.custom(parsePointDimensionParams), x: p.optional.custom(parsePointDimensionParams), y: p.optional.custom(parsePointDimensionParams), z: p.optional.custom(parsePointDimensionParams) })));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: (_args) => point4dFromUnknown,\n        constraint: (args) => createConstraint$3(args.params, args.initialValue),\n        equals: Point4d.equals,\n        writer: (_args) => writePoint4d,\n    },\n    controller: (args) => {\n        const value = args.value;\n        const c = args.constraint;\n        const dParams = [\n            args.params.x,\n            args.params.y,\n            args.params.z,\n            args.params.w,\n        ];\n        return new PointNdTextController(args.document, {\n            assembly: Point4dAssembly,\n            axes: value.rawValue.getComponents().map((comp, i) => {\n                var _a;\n                return createPointAxis({\n                    constraint: c.components[i],\n                    initialValue: comp,\n                    params: deepMerge(args.params, ((_a = dParams[i]) !== null && _a !== void 0 ? _a : {})),\n                });\n            }),\n            parser: parseNumber,\n            value: value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nfunction createConstraint$2(params) {\n    const constraints = [];\n    const lc = createListConstraint(params.options);\n    if (lc) {\n        constraints.push(lc);\n    }\n    return new CompositeConstraint(constraints);\n}\ncreatePlugin({\n    id: 'input-string',\n    type: 'input',\n    accept: (value, params) => {\n        if (typeof value !== 'string') {\n            return null;\n        }\n        const result = parseRecord(params, (p) => ({\n            readonly: p.optional.constant(false),\n            options: p.optional.custom(parseListOptions),\n        }));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: (_args) => stringFromUnknown,\n        constraint: (args) => createConstraint$2(args.params),\n        writer: (_args) => writePrimitive,\n    },\n    controller: (args) => {\n        const doc = args.document;\n        const value = args.value;\n        const c = args.constraint;\n        const lc = c && findConstraint(c, ListConstraint);\n        if (lc) {\n            return new ListController(doc, {\n                props: new ValueMap({\n                    options: lc.values.value('options'),\n                }),\n                value: value,\n                viewProps: args.viewProps,\n            });\n        }\n        return new TextController(doc, {\n            parser: (v) => v,\n            props: ValueMap.fromObject({\n                formatter: formatString,\n            }),\n            value: value,\n            viewProps: args.viewProps,\n        });\n    },\n    api(args) {\n        if (typeof args.controller.value.rawValue !== 'string') {\n            return null;\n        }\n        if (args.controller.valueController instanceof ListController) {\n            return new ListInputBindingApi(args.controller);\n        }\n        return null;\n    },\n});\n\nconst Constants = {\n    monitor: {\n        defaultInterval: 200,\n        defaultRows: 3,\n    },\n};\n\nconst cn$2 = ClassName('mll');\nclass MultiLogView {\n    constructor(doc, config) {\n        this.onValueUpdate_ = this.onValueUpdate_.bind(this);\n        this.formatter_ = config.formatter;\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$2());\n        config.viewProps.bindClassModifiers(this.element);\n        const textareaElem = doc.createElement('textarea');\n        textareaElem.classList.add(cn$2('i'));\n        textareaElem.style.height = `calc(var(${getCssVar('containerUnitSize')}) * ${config.rows})`;\n        textareaElem.readOnly = true;\n        config.viewProps.bindDisabled(textareaElem);\n        this.element.appendChild(textareaElem);\n        this.textareaElem_ = textareaElem;\n        config.value.emitter.on('change', this.onValueUpdate_);\n        this.value = config.value;\n        this.update_();\n    }\n    update_() {\n        const elem = this.textareaElem_;\n        const shouldScroll = elem.scrollTop === elem.scrollHeight - elem.clientHeight;\n        const lines = [];\n        this.value.rawValue.forEach((value) => {\n            if (value !== undefined) {\n                lines.push(this.formatter_(value));\n            }\n        });\n        elem.textContent = lines.join('\\n');\n        if (shouldScroll) {\n            elem.scrollTop = elem.scrollHeight;\n        }\n    }\n    onValueUpdate_() {\n        this.update_();\n    }\n}\n\nclass MultiLogController {\n    constructor(doc, config) {\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new MultiLogView(doc, {\n            formatter: config.formatter,\n            rows: config.rows,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n    }\n}\n\nconst cn$1 = ClassName('sgl');\nclass SingleLogView {\n    constructor(doc, config) {\n        this.onValueUpdate_ = this.onValueUpdate_.bind(this);\n        this.formatter_ = config.formatter;\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn$1());\n        config.viewProps.bindClassModifiers(this.element);\n        const inputElem = doc.createElement('input');\n        inputElem.classList.add(cn$1('i'));\n        inputElem.readOnly = true;\n        inputElem.type = 'text';\n        config.viewProps.bindDisabled(inputElem);\n        this.element.appendChild(inputElem);\n        this.inputElement = inputElem;\n        config.value.emitter.on('change', this.onValueUpdate_);\n        this.value = config.value;\n        this.update_();\n    }\n    update_() {\n        const values = this.value.rawValue;\n        const lastValue = values[values.length - 1];\n        this.inputElement.value =\n            lastValue !== undefined ? this.formatter_(lastValue) : '';\n    }\n    onValueUpdate_() {\n        this.update_();\n    }\n}\n\nclass SingleLogController {\n    constructor(doc, config) {\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new SingleLogView(doc, {\n            formatter: config.formatter,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n    }\n}\n\ncreatePlugin({\n    id: 'monitor-bool',\n    type: 'monitor',\n    accept: (value, params) => {\n        if (typeof value !== 'boolean') {\n            return null;\n        }\n        const result = parseRecord(params, (p) => ({\n            readonly: p.required.constant(true),\n            rows: p.optional.number,\n        }));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: (_args) => boolFromUnknown,\n    },\n    controller: (args) => {\n        var _a;\n        if (args.value.rawValue.length === 1) {\n            return new SingleLogController(args.document, {\n                formatter: BooleanFormatter,\n                value: args.value,\n                viewProps: args.viewProps,\n            });\n        }\n        return new MultiLogController(args.document, {\n            formatter: BooleanFormatter,\n            rows: (_a = args.params.rows) !== null && _a !== void 0 ? _a : Constants.monitor.defaultRows,\n            value: args.value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nclass GraphLogMonitorBindingApi extends BindingApi {\n    get max() {\n        return this.controller.valueController.props.get('max');\n    }\n    set max(max) {\n        this.controller.valueController.props.set('max', max);\n    }\n    get min() {\n        return this.controller.valueController.props.get('min');\n    }\n    set min(min) {\n        this.controller.valueController.props.set('min', min);\n    }\n}\n\nconst cn = ClassName('grl');\nclass GraphLogView {\n    constructor(doc, config) {\n        this.onCursorChange_ = this.onCursorChange_.bind(this);\n        this.onValueUpdate_ = this.onValueUpdate_.bind(this);\n        this.element = doc.createElement('div');\n        this.element.classList.add(cn());\n        config.viewProps.bindClassModifiers(this.element);\n        this.formatter_ = config.formatter;\n        this.props_ = config.props;\n        this.cursor_ = config.cursor;\n        this.cursor_.emitter.on('change', this.onCursorChange_);\n        const svgElem = doc.createElementNS(SVG_NS, 'svg');\n        svgElem.classList.add(cn('g'));\n        svgElem.style.height = `calc(var(${getCssVar('containerUnitSize')}) * ${config.rows})`;\n        this.element.appendChild(svgElem);\n        this.svgElem_ = svgElem;\n        const lineElem = doc.createElementNS(SVG_NS, 'polyline');\n        this.svgElem_.appendChild(lineElem);\n        this.lineElem_ = lineElem;\n        const tooltipElem = doc.createElement('div');\n        tooltipElem.classList.add(cn('t'), ClassName('tt')());\n        this.element.appendChild(tooltipElem);\n        this.tooltipElem_ = tooltipElem;\n        config.value.emitter.on('change', this.onValueUpdate_);\n        this.value = config.value;\n        this.update_();\n    }\n    get graphElement() {\n        return this.svgElem_;\n    }\n    update_() {\n        const bounds = this.svgElem_.getBoundingClientRect();\n        const maxIndex = this.value.rawValue.length - 1;\n        const min = this.props_.get('min');\n        const max = this.props_.get('max');\n        const points = [];\n        this.value.rawValue.forEach((v, index) => {\n            if (v === undefined) {\n                return;\n            }\n            const x = mapRange(index, 0, maxIndex, 0, bounds.width);\n            const y = mapRange(v, min, max, bounds.height, 0);\n            points.push([x, y].join(','));\n        });\n        this.lineElem_.setAttributeNS(null, 'points', points.join(' '));\n        const tooltipElem = this.tooltipElem_;\n        const value = this.value.rawValue[this.cursor_.rawValue];\n        if (value === undefined) {\n            tooltipElem.classList.remove(cn('t', 'a'));\n            return;\n        }\n        const tx = mapRange(this.cursor_.rawValue, 0, maxIndex, 0, bounds.width);\n        const ty = mapRange(value, min, max, bounds.height, 0);\n        tooltipElem.style.left = `${tx}px`;\n        tooltipElem.style.top = `${ty}px`;\n        tooltipElem.textContent = `${this.formatter_(value)}`;\n        if (!tooltipElem.classList.contains(cn('t', 'a'))) {\n            tooltipElem.classList.add(cn('t', 'a'), cn('t', 'in'));\n            forceReflow(tooltipElem);\n            tooltipElem.classList.remove(cn('t', 'in'));\n        }\n    }\n    onValueUpdate_() {\n        this.update_();\n    }\n    onCursorChange_() {\n        this.update_();\n    }\n}\n\nclass GraphLogController {\n    constructor(doc, config) {\n        this.onGraphMouseMove_ = this.onGraphMouseMove_.bind(this);\n        this.onGraphMouseLeave_ = this.onGraphMouseLeave_.bind(this);\n        this.onGraphPointerDown_ = this.onGraphPointerDown_.bind(this);\n        this.onGraphPointerMove_ = this.onGraphPointerMove_.bind(this);\n        this.onGraphPointerUp_ = this.onGraphPointerUp_.bind(this);\n        this.props = config.props;\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.cursor_ = createValue(-1);\n        this.view = new GraphLogView(doc, {\n            cursor: this.cursor_,\n            formatter: config.formatter,\n            rows: config.rows,\n            props: this.props,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        if (!supportsTouch(doc)) {\n            this.view.element.addEventListener('mousemove', this.onGraphMouseMove_);\n            this.view.element.addEventListener('mouseleave', this.onGraphMouseLeave_);\n        }\n        else {\n            const ph = new PointerHandler(this.view.element);\n            ph.emitter.on('down', this.onGraphPointerDown_);\n            ph.emitter.on('move', this.onGraphPointerMove_);\n            ph.emitter.on('up', this.onGraphPointerUp_);\n        }\n    }\n    importProps(state) {\n        return importBladeState(state, null, (p) => ({\n            max: p.required.number,\n            min: p.required.number,\n        }), (result) => {\n            this.props.set('max', result.max);\n            this.props.set('min', result.min);\n            return true;\n        });\n    }\n    exportProps() {\n        return exportBladeState(null, {\n            max: this.props.get('max'),\n            min: this.props.get('min'),\n        });\n    }\n    onGraphMouseLeave_() {\n        this.cursor_.rawValue = -1;\n    }\n    onGraphMouseMove_(ev) {\n        const bounds = this.view.element.getBoundingClientRect();\n        this.cursor_.rawValue = Math.floor(mapRange(ev.offsetX, 0, bounds.width, 0, this.value.rawValue.length));\n    }\n    onGraphPointerDown_(ev) {\n        this.onGraphPointerMove_(ev);\n    }\n    onGraphPointerMove_(ev) {\n        if (!ev.data.point) {\n            this.cursor_.rawValue = -1;\n            return;\n        }\n        this.cursor_.rawValue = Math.floor(mapRange(ev.data.point.x, 0, ev.data.bounds.width, 0, this.value.rawValue.length));\n    }\n    onGraphPointerUp_() {\n        this.cursor_.rawValue = -1;\n    }\n}\n\nfunction createFormatter(params) {\n    return !isEmpty(params.format) ? params.format : createNumberFormatter(2);\n}\nfunction createTextMonitor(args) {\n    var _a;\n    if (args.value.rawValue.length === 1) {\n        return new SingleLogController(args.document, {\n            formatter: createFormatter(args.params),\n            value: args.value,\n            viewProps: args.viewProps,\n        });\n    }\n    return new MultiLogController(args.document, {\n        formatter: createFormatter(args.params),\n        rows: (_a = args.params.rows) !== null && _a !== void 0 ? _a : Constants.monitor.defaultRows,\n        value: args.value,\n        viewProps: args.viewProps,\n    });\n}\nfunction createGraphMonitor(args) {\n    var _a, _b, _c;\n    return new GraphLogController(args.document, {\n        formatter: createFormatter(args.params),\n        rows: (_a = args.params.rows) !== null && _a !== void 0 ? _a : Constants.monitor.defaultRows,\n        props: ValueMap.fromObject({\n            max: (_b = args.params.max) !== null && _b !== void 0 ? _b : 100,\n            min: (_c = args.params.min) !== null && _c !== void 0 ? _c : 0,\n        }),\n        value: args.value,\n        viewProps: args.viewProps,\n    });\n}\nfunction shouldShowGraph(params) {\n    return params.view === 'graph';\n}\ncreatePlugin({\n    id: 'monitor-number',\n    type: 'monitor',\n    accept: (value, params) => {\n        if (typeof value !== 'number') {\n            return null;\n        }\n        const result = parseRecord(params, (p) => ({\n            format: p.optional.function,\n            max: p.optional.number,\n            min: p.optional.number,\n            readonly: p.required.constant(true),\n            rows: p.optional.number,\n            view: p.optional.string,\n        }));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        defaultBufferSize: (params) => (shouldShowGraph(params) ? 64 : 1),\n        reader: (_args) => numberFromUnknown,\n    },\n    controller: (args) => {\n        if (shouldShowGraph(args.params)) {\n            return createGraphMonitor(args);\n        }\n        return createTextMonitor(args);\n    },\n    api: (args) => {\n        if (args.controller.valueController instanceof GraphLogController) {\n            return new GraphLogMonitorBindingApi(args.controller);\n        }\n        return null;\n    },\n});\n\ncreatePlugin({\n    id: 'monitor-string',\n    type: 'monitor',\n    accept: (value, params) => {\n        if (typeof value !== 'string') {\n            return null;\n        }\n        const result = parseRecord(params, (p) => ({\n            multiline: p.optional.boolean,\n            readonly: p.required.constant(true),\n            rows: p.optional.number,\n        }));\n        return result\n            ? {\n                initialValue: value,\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: (_args) => stringFromUnknown,\n    },\n    controller: (args) => {\n        var _a;\n        const value = args.value;\n        const multiline = value.rawValue.length > 1 || args.params.multiline;\n        if (multiline) {\n            return new MultiLogController(args.document, {\n                formatter: formatString,\n                rows: (_a = args.params.rows) !== null && _a !== void 0 ? _a : Constants.monitor.defaultRows,\n                value: value,\n                viewProps: args.viewProps,\n            });\n        }\n        return new SingleLogController(args.document, {\n            formatter: formatString,\n            value: value,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nclass ButtonCellApi {\n    constructor(controller) {\n        this.controller_ = controller;\n    }\n    get disabled() {\n        return this.controller_.viewProps.get('disabled');\n    }\n    set disabled(disabled) {\n        this.controller_.viewProps.set('disabled', disabled);\n    }\n    get title() {\n        var _a;\n        return (_a = this.controller_.props.get('title')) !== null && _a !== void 0 ? _a : '';\n    }\n    set title(title) {\n        this.controller_.props.set('title', title);\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        const emitter = this.controller_.emitter;\n        emitter.on(eventName, () => {\n            bh(new TpEvent(this));\n        });\n        return this;\n    }\n}\n\nclass TpButtonGridEvent extends TpEvent {\n    constructor(target, cell, index) {\n        super(target);\n        this.cell = cell;\n        this.index = index;\n    }\n}\n\nclass ButtonGridApi extends BladeApi {\n    constructor(controller) {\n        super(controller);\n        this.cellToApiMap_ = new Map();\n        this.emitter_ = new Emitter();\n        const gc = this.controller.valueController;\n        gc.cellControllers.forEach((cc, i) => {\n            const api = new ButtonCellApi(cc);\n            this.cellToApiMap_.set(cc, api);\n            cc.emitter.on('click', () => {\n                const x = i % gc.size[0];\n                const y = Math.floor(i / gc.size[0]);\n                this.emitter_.emit('click', {\n                    event: new TpButtonGridEvent(this, api, [x, y]),\n                });\n            });\n        });\n    }\n    cell(x, y) {\n        const gc = this.controller.valueController;\n        const cc = gc.cellControllers[y * gc.size[0] + x];\n        return this.cellToApiMap_.get(cc);\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        this.emitter_.on(eventName, (ev) => {\n            bh(ev.event);\n        });\n        return this;\n    }\n}\n\nclass ButtonGridController {\n    constructor(doc, config) {\n        this.size = config.size;\n        const [w, h] = this.size;\n        const bcs = [];\n        for (let y = 0; y < h; y++) {\n            for (let x = 0; x < w; x++) {\n                const bc = new ButtonController(doc, {\n                    props: ValueMap.fromObject(Object.assign({}, config.cellConfig(x, y))),\n                    viewProps: ViewProps.create(),\n                });\n                bcs.push(bc);\n            }\n        }\n        this.cellCs_ = bcs;\n        this.viewProps = ViewProps.create();\n        this.viewProps.handleDispose(() => {\n            this.cellCs_.forEach((c) => {\n                c.viewProps.set('disposed', true);\n            });\n        });\n        this.view = new PlainView(doc, {\n            viewProps: this.viewProps,\n            viewName: 'btngrid',\n        });\n        this.view.element.style.gridTemplateColumns = `repeat(${w}, 1fr)`;\n        this.cellCs_.forEach((bc) => {\n            this.view.element.appendChild(bc.view.element);\n        });\n    }\n    get cellControllers() {\n        return this.cellCs_;\n    }\n}\n\nclass ButtonGridBladeController extends BladeController {\n    constructor(doc, config) {\n        const bc = config.valueController;\n        const lc = new LabelController(doc, {\n            blade: config.blade,\n            props: config.labelProps,\n            valueController: bc,\n        });\n        super({\n            blade: config.blade,\n            view: lc.view,\n            viewProps: bc.viewProps,\n        });\n        this.valueController = bc;\n        this.labelController = lc;\n    }\n}\n\nconst ButtonGridBladePlugin = createPlugin({\n    id: 'buttongrid',\n    type: 'blade',\n    accept(params) {\n        const result = parseRecord(params, (p) => ({\n            cells: p.required.function,\n            size: p.required.array(p.required.number),\n            view: p.required.constant('buttongrid'),\n            label: p.optional.string,\n        }));\n        return result ? { params: result } : null;\n    },\n    controller(args) {\n        return new ButtonGridBladeController(args.document, {\n            blade: args.blade,\n            labelProps: ValueMap.fromObject({\n                label: args.params.label,\n            }),\n            valueController: new ButtonGridController(args.document, {\n                cellConfig: args.params.cells,\n                size: args.params.size,\n            }),\n        });\n    },\n    api(args) {\n        if (args.controller instanceof ButtonGridBladeController) {\n            return new ButtonGridApi(args.controller);\n        }\n        return null;\n    },\n});\n\nclass CubicBezierApi extends BladeApi {\n    get label() {\n        return this.controller.labelController.props.get('label');\n    }\n    set label(label) {\n        this.controller.labelController.props.set('label', label);\n    }\n    get value() {\n        return this.controller.valueController.value.rawValue;\n    }\n    set value(value) {\n        this.controller.valueController.value.rawValue = value;\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        this.controller.valueController.value.emitter.on(eventName, (ev) => {\n            bh(new TpChangeEvent(this, ev.rawValue, ev.options.last));\n        });\n        return this;\n    }\n}\n\nfunction interpolate(x1, x2, t) {\n    return x1 * (1 - t) + x2 * t;\n}\nconst MAX_ITERATION = 20;\nconst X_DELTA = 0.001;\nconst CACHE_RESOLUTION = 100;\nfunction y(cb, x) {\n    let dt = 0.25;\n    let t = 0.5;\n    let y = -1;\n    for (let i = 0; i < MAX_ITERATION; i++) {\n        const [tx, ty] = cb.curve(t);\n        t += dt * (tx < x ? +1 : -1);\n        y = ty;\n        dt *= 0.5;\n        if (Math.abs(x - tx) < X_DELTA) {\n            break;\n        }\n    }\n    return y;\n}\nclass CubicBezier {\n    constructor(x1 = 0, y1 = 0, x2 = 1, y2 = 1) {\n        this.cache_ = [];\n        this.comps_ = [x1, y1, x2, y2];\n    }\n    get x1() {\n        return this.comps_[0];\n    }\n    get y1() {\n        return this.comps_[1];\n    }\n    get x2() {\n        return this.comps_[2];\n    }\n    get y2() {\n        return this.comps_[3];\n    }\n    static isObject(obj) {\n        if (isEmpty(obj)) {\n            return false;\n        }\n        if (!Array.isArray(obj)) {\n            return false;\n        }\n        return (typeof obj[0] === 'number' &&\n            typeof obj[1] === 'number' &&\n            typeof obj[2] === 'number' &&\n            typeof obj[3] === 'number');\n    }\n    static equals(v1, v2) {\n        return (v1.x1 === v2.x1 && v1.y1 === v2.y1 && v1.x2 === v2.x2 && v1.y2 === v2.y2);\n    }\n    curve(t) {\n        const x01 = interpolate(0, this.x1, t);\n        const y01 = interpolate(0, this.y1, t);\n        const x12 = interpolate(this.x1, this.x2, t);\n        const y12 = interpolate(this.y1, this.y2, t);\n        const x23 = interpolate(this.x2, 1, t);\n        const y23 = interpolate(this.y2, 1, t);\n        const xr0 = interpolate(x01, x12, t);\n        const yr0 = interpolate(y01, y12, t);\n        const xr1 = interpolate(x12, x23, t);\n        const yr1 = interpolate(y12, y23, t);\n        return [interpolate(xr0, xr1, t), interpolate(yr0, yr1, t)];\n    }\n    y(x) {\n        if (this.cache_.length === 0) {\n            const cache = [];\n            for (let i = 0; i < CACHE_RESOLUTION; i++) {\n                cache.push(y(this, mapRange(i, 0, CACHE_RESOLUTION - 1, 0, 1)));\n            }\n            this.cache_ = cache;\n        }\n        return this.cache_[Math.round(mapRange(constrainRange(x, 0, 1), 0, 1, 0, CACHE_RESOLUTION - 1))];\n    }\n    toObject() {\n        return [this.comps_[0], this.comps_[1], this.comps_[2], this.comps_[3]];\n    }\n}\nconst CubicBezierAssembly = {\n    toComponents: (p) => p.toObject(),\n    fromComponents: (comps) => new CubicBezier(...comps),\n};\n\nfunction cubicBezierToString(cb) {\n    const formatter = createNumberFormatter(2);\n    const comps = cb.toObject().map((c) => formatter(c));\n    return `cubic-bezier(${comps.join(', ')})`;\n}\nconst COMPS_EMPTY = [0, 0.5, 0.5, 1];\nfunction cubicBezierFromString(text) {\n    const m = text.match(/^cubic-bezier\\s*\\(\\s*([0-9.]+)\\s*,\\s*([0-9.]+)\\s*,\\s*([0-9.]+)\\s*,\\s*([0-9.]+)\\s*\\)$/);\n    if (!m) {\n        return new CubicBezier(...COMPS_EMPTY);\n    }\n    const comps = [m[1], m[2], m[3], m[4]].reduce((comps, comp) => {\n        if (!comps) {\n            return null;\n        }\n        const n = Number(comp);\n        if (isNaN(n)) {\n            return null;\n        }\n        return [...comps, n];\n    }, []);\n    return new CubicBezier(...(comps !== null && comps !== void 0 ? comps : COMPS_EMPTY));\n}\n\nconst className$7 = ClassName('cbz');\nclass CubicBezierView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(className$7());\n        config.viewProps.bindClassModifiers(this.element);\n        config.foldable.bindExpandedClass(this.element, className$7(undefined, 'expanded'));\n        bindValueMap(config.foldable, 'completed', valueToClassName(this.element, className$7(undefined, 'cpl')));\n        const headElem = doc.createElement('div');\n        headElem.classList.add(className$7('h'));\n        this.element.appendChild(headElem);\n        const buttonElem = doc.createElement('button');\n        buttonElem.classList.add(className$7('b'));\n        config.viewProps.bindDisabled(buttonElem);\n        const iconElem = doc.createElementNS(SVG_NS, 'svg');\n        iconElem.innerHTML = '<path d=\"M2 13C8 13 8 3 14 3\"/>';\n        buttonElem.appendChild(iconElem);\n        headElem.appendChild(buttonElem);\n        this.buttonElement = buttonElem;\n        const textElem = doc.createElement('div');\n        textElem.classList.add(className$7('t'));\n        headElem.appendChild(textElem);\n        this.textElement = textElem;\n        if (config.pickerLayout === 'inline') {\n            const pickerElem = doc.createElement('div');\n            pickerElem.classList.add(className$7('p'));\n            this.element.appendChild(pickerElem);\n            this.pickerElement = pickerElem;\n        }\n        else {\n            this.pickerElement = null;\n        }\n    }\n}\n\nconst className$6 = ClassName('cbzp');\nclass CubicBezierPickerView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(className$6());\n        config.viewProps.bindClassModifiers(this.element);\n        const graphElem = doc.createElement('div');\n        graphElem.classList.add(className$6('g'));\n        this.element.appendChild(graphElem);\n        this.graphElement = graphElem;\n        const textElem = doc.createElement('div');\n        textElem.classList.add(className$6('t'));\n        this.element.appendChild(textElem);\n        this.textElement = textElem;\n    }\n}\n\nfunction waitToBeAddedToDom(elem, callback) {\n    const ob = new MutationObserver((ml) => {\n        for (const m of ml) {\n            if (m.type !== 'childList') {\n                continue;\n            }\n            m.addedNodes.forEach((elem) => {\n                if (!elem.contains(elem)) {\n                    return;\n                }\n                callback();\n                ob.disconnect();\n            });\n        }\n    });\n    const doc = elem.ownerDocument;\n    ob.observe(doc.body, {\n        attributes: true,\n        childList: true,\n        subtree: true,\n    });\n}\n\nconst className$5 = ClassName('cbzg');\n// TODO: Apply to core\nfunction compose(h1, h2) {\n    return (input) => h2(h1(input));\n}\nclass CubicBezierGraphView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(className$5());\n        config.viewProps.bindClassModifiers(this.element);\n        config.viewProps.bindTabIndex(this.element);\n        const previewElem = doc.createElement('div');\n        previewElem.classList.add(className$5('p'));\n        this.element.appendChild(previewElem);\n        this.previewElement = previewElem;\n        const svgElem = doc.createElementNS(SVG_NS, 'svg');\n        svgElem.classList.add(className$5('g'));\n        this.element.appendChild(svgElem);\n        this.svgElem_ = svgElem;\n        const guideElem = doc.createElementNS(SVG_NS, 'path');\n        guideElem.classList.add(className$5('u'));\n        this.svgElem_.appendChild(guideElem);\n        this.guideElem_ = guideElem;\n        const lineElem = doc.createElementNS(SVG_NS, 'polyline');\n        lineElem.classList.add(className$5('l'));\n        this.svgElem_.appendChild(lineElem);\n        this.lineElem_ = lineElem;\n        this.handleElems_ = [doc.createElement('div'), doc.createElement('div')];\n        this.handleElems_.forEach((elem) => {\n            elem.classList.add(className$5('h'));\n            this.element.appendChild(elem);\n        });\n        this.vectorElems_ = [\n            doc.createElementNS(SVG_NS, 'line'),\n            doc.createElementNS(SVG_NS, 'line'),\n        ];\n        this.vectorElems_.forEach((elem) => {\n            elem.classList.add(className$5('v'));\n            this.svgElem_.appendChild(elem);\n        });\n        this.value_ = config.value;\n        this.value_.emitter.on('change', this.onValueChange_.bind(this));\n        this.sel_ = config.selection;\n        this.handleElems_.forEach((elem, index) => {\n            bindValue(this.sel_, compose((selection) => selection === index, valueToClassName(elem, className$5('h', 'sel'))));\n        });\n        waitToBeAddedToDom(this.element, () => {\n            this.refresh();\n        });\n    }\n    getVertMargin_(h) {\n        return h * 0.25;\n    }\n    valueToPosition(x, y) {\n        const { clientWidth: w, clientHeight: h } = this.element;\n        const vm = this.getVertMargin_(h);\n        return {\n            x: mapRange(x, 0, 1, 0, w),\n            y: mapRange(y, 0, 1, h - vm, vm),\n        };\n    }\n    positionToValue(x, y) {\n        const bounds = this.element.getBoundingClientRect();\n        const w = bounds.width;\n        const h = bounds.height;\n        const vm = this.getVertMargin_(h);\n        return {\n            x: constrainRange(mapRange(x, 0, w, 0, 1), 0, 1),\n            y: mapRange(y, h - vm, vm, 0, 1),\n        };\n    }\n    refresh() {\n        this.guideElem_.setAttributeNS(null, 'd', [0, 1]\n            .map((index) => {\n            const p1 = this.valueToPosition(0, index);\n            const p2 = this.valueToPosition(1, index);\n            return [`M ${p1.x},${p1.y}`, `L ${p2.x},${p2.y}`].join(' ');\n        })\n            .join(' '));\n        const bezier = this.value_.rawValue;\n        const points = [];\n        let t = 0;\n        for (;;) {\n            const p = this.valueToPosition(...bezier.curve(t));\n            points.push([p.x, p.y].join(','));\n            if (t >= 1) {\n                break;\n            }\n            t = Math.min(t + 0.05, 1);\n        }\n        this.lineElem_.setAttributeNS(null, 'points', points.join(' '));\n        const obj = bezier.toObject();\n        [0, 1].forEach((index) => {\n            const p1 = this.valueToPosition(index, index);\n            const p2 = this.valueToPosition(obj[index * 2], obj[index * 2 + 1]);\n            const vElem = this.vectorElems_[index];\n            vElem.setAttributeNS(null, 'x1', String(p1.x));\n            vElem.setAttributeNS(null, 'y1', String(p1.y));\n            vElem.setAttributeNS(null, 'x2', String(p2.x));\n            vElem.setAttributeNS(null, 'y2', String(p2.y));\n            const hElem = this.handleElems_[index];\n            hElem.style.left = `${p2.x}px`;\n            hElem.style.top = `${p2.y}px`;\n        });\n    }\n    onValueChange_() {\n        this.refresh();\n    }\n}\n\nconst TICK_COUNT = 24;\nconst PREVIEW_DELAY = 400;\nconst PREVIEW_DURATION = 1000;\nconst className$4 = ClassName('cbzprv');\nclass CubicBezierPreviewView {\n    constructor(doc, config) {\n        this.stopped_ = true;\n        this.startTime_ = -1;\n        this.onDispose_ = this.onDispose_.bind(this);\n        this.onTimer_ = this.onTimer_.bind(this);\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.element = doc.createElement('div');\n        this.element.classList.add(className$4());\n        config.viewProps.bindClassModifiers(this.element);\n        const svgElem = doc.createElementNS(SVG_NS, 'svg');\n        svgElem.classList.add(className$4('g'));\n        this.element.appendChild(svgElem);\n        this.svgElem_ = svgElem;\n        const ticksElem = doc.createElementNS(SVG_NS, 'path');\n        ticksElem.classList.add(className$4('t'));\n        this.svgElem_.appendChild(ticksElem);\n        this.ticksElem_ = ticksElem;\n        const markerElem = doc.createElement('div');\n        markerElem.classList.add(className$4('m'));\n        this.element.appendChild(markerElem);\n        this.markerElem_ = markerElem;\n        this.value_ = config.value;\n        this.value_.emitter.on('change', this.onValueChange_);\n        config.viewProps.handleDispose(this.onDispose_);\n        waitToBeAddedToDom(this.element, () => {\n            this.refresh();\n        });\n    }\n    play() {\n        this.stop();\n        this.updateMarker_(0);\n        this.markerElem_.classList.add(className$4('m', 'a'));\n        this.startTime_ = new Date().getTime() + PREVIEW_DELAY;\n        this.stopped_ = false;\n        requestAnimationFrame(this.onTimer_);\n    }\n    stop() {\n        this.stopped_ = true;\n        this.markerElem_.classList.remove(className$4('m', 'a'));\n    }\n    onDispose_() {\n        this.stop();\n    }\n    updateMarker_(progress) {\n        const p = this.value_.rawValue.y(constrainRange(progress, 0, 1));\n        this.markerElem_.style.left = `${p * 100}%`;\n    }\n    refresh() {\n        const { clientWidth: w, clientHeight: h } = this.svgElem_;\n        const ds = [];\n        const bezier = this.value_.rawValue;\n        for (let i = 0; i < TICK_COUNT; i++) {\n            const px = mapRange(i, 0, TICK_COUNT - 1, 0, 1);\n            const x = mapRange(bezier.y(px), 0, 1, 0, w);\n            ds.push(`M ${x},0 v${h}`);\n        }\n        this.ticksElem_.setAttributeNS(null, 'd', ds.join(' '));\n    }\n    onTimer_() {\n        if (this.startTime_ === null) {\n            return;\n        }\n        const dt = new Date().getTime() - this.startTime_;\n        const p = dt / PREVIEW_DURATION;\n        this.updateMarker_(p);\n        if (dt > PREVIEW_DURATION + PREVIEW_DELAY) {\n            this.stop();\n        }\n        if (!this.stopped_) {\n            requestAnimationFrame(this.onTimer_);\n        }\n    }\n    onValueChange_() {\n        this.refresh();\n        this.play();\n    }\n}\n\nfunction getDistance(x1, y1, x2, y2) {\n    const dx = x2 - x1;\n    const dy = y2 - y1;\n    return Math.sqrt(dx * dx + dy * dy);\n}\nfunction lockAngle(x1, y1, x2, y2) {\n    const d = getDistance(x1, y1, x2, y2);\n    const a = Math.atan2(y2 - y1, x2 - x1);\n    const la = (Math.round(a / (Math.PI / 4)) * Math.PI) / 4;\n    return {\n        x: x1 + Math.cos(la) * d,\n        y: y1 + Math.sin(la) * d,\n    };\n}\nclass CubicBezierGraphController {\n    constructor(doc, config) {\n        this.onKeyDown_ = this.onKeyDown_.bind(this);\n        this.onKeyUp_ = this.onKeyUp_.bind(this);\n        this.onPointerDown_ = this.onPointerDown_.bind(this);\n        this.onPointerMove_ = this.onPointerMove_.bind(this);\n        this.onPointerUp_ = this.onPointerUp_.bind(this);\n        this.keyScale_ = config.keyScale;\n        this.value = config.value;\n        this.sel_ = createValue(0);\n        this.viewProps = config.viewProps;\n        this.view = new CubicBezierGraphView(doc, {\n            selection: this.sel_,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view.element.addEventListener('keydown', this.onKeyDown_);\n        this.view.element.addEventListener('keyup', this.onKeyUp_);\n        this.prevView_ = new CubicBezierPreviewView(doc, {\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.prevView_.element.addEventListener('mousedown', (ev) => {\n            ev.stopImmediatePropagation();\n            ev.preventDefault();\n            this.prevView_.play();\n        });\n        this.view.previewElement.appendChild(this.prevView_.element);\n        const ptHandler = new PointerHandler(this.view.element);\n        ptHandler.emitter.on('down', this.onPointerDown_);\n        ptHandler.emitter.on('move', this.onPointerMove_);\n        ptHandler.emitter.on('up', this.onPointerUp_);\n    }\n    refresh() {\n        this.view.refresh();\n        this.prevView_.refresh();\n        this.prevView_.play();\n    }\n    updateValue_(point, locksAngle, opts) {\n        const index = this.sel_.rawValue;\n        const comps = this.value.rawValue.toObject();\n        const vp = this.view.positionToValue(point.x, point.y);\n        const v = locksAngle ? lockAngle(index, index, vp.x, vp.y) : vp;\n        comps[index * 2] = v.x;\n        comps[index * 2 + 1] = v.y;\n        this.value.setRawValue(new CubicBezier(...comps), opts);\n    }\n    onPointerDown_(ev) {\n        const data = ev.data;\n        if (!data.point) {\n            return;\n        }\n        const bezier = this.value.rawValue;\n        const p1 = this.view.valueToPosition(bezier.x1, bezier.y1);\n        const d1 = getDistance(data.point.x, data.point.y, p1.x, p1.y);\n        const p2 = this.view.valueToPosition(bezier.x2, bezier.y2);\n        const d2 = getDistance(data.point.x, data.point.y, p2.x, p2.y);\n        this.sel_.rawValue = d1 <= d2 ? 0 : 1;\n        this.updateValue_(data.point, ev.shiftKey, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerMove_(ev) {\n        const data = ev.data;\n        if (!data.point) {\n            return;\n        }\n        this.updateValue_(data.point, ev.shiftKey, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerUp_(ev) {\n        const data = ev.data;\n        if (!data.point) {\n            return;\n        }\n        this.updateValue_(data.point, ev.shiftKey, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n    onKeyDown_(ev) {\n        if (isArrowKey(ev.key)) {\n            ev.preventDefault();\n        }\n        const index = this.sel_.rawValue;\n        const comps = this.value.rawValue.toObject();\n        const keyScale = this.keyScale_.rawValue;\n        comps[index * 2] += getStepForKey(keyScale, getHorizontalStepKeys(ev));\n        comps[index * 2 + 1] += getStepForKey(keyScale, getVerticalStepKeys(ev));\n        this.value.setRawValue(new CubicBezier(...comps), {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onKeyUp_(ev) {\n        if (isArrowKey(ev.key)) {\n            ev.preventDefault();\n        }\n        const keyScale = this.keyScale_.rawValue;\n        const xStep = getStepForKey(keyScale, getHorizontalStepKeys(ev));\n        const yStep = getStepForKey(keyScale, getVerticalStepKeys(ev));\n        if (xStep === 0 && yStep === 0) {\n            return;\n        }\n        this.value.setRawValue(this.value.rawValue, {\n            forceEmit: true,\n            last: true,\n        });\n    }\n}\n\nclass CubicBezierPickerController {\n    constructor(doc, config) {\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new CubicBezierPickerView(doc, {\n            viewProps: this.viewProps,\n        });\n        this.gc_ = new CubicBezierGraphController(doc, {\n            keyScale: config.axis.textProps.value('keyScale'),\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view.graphElement.appendChild(this.gc_.view.element);\n        const xAxis = Object.assign(Object.assign({}, config.axis), { constraint: new RangeConstraint({ max: 1, min: 0 }) });\n        const yAxis = Object.assign(Object.assign({}, config.axis), { constraint: undefined });\n        this.tc_ = new PointNdTextController(doc, {\n            assembly: CubicBezierAssembly,\n            axes: [xAxis, yAxis, xAxis, yAxis],\n            parser: parseNumber,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view.textElement.appendChild(this.tc_.view.element);\n    }\n    get allFocusableElements() {\n        return [\n            this.gc_.view.element,\n            ...this.tc_.view.textViews.map((v) => v.inputElement),\n        ];\n    }\n    refresh() {\n        this.gc_.refresh();\n    }\n}\n\nclass CubicBezierController {\n    constructor(doc, config) {\n        this.onButtonBlur_ = this.onButtonBlur_.bind(this);\n        this.onButtonClick_ = this.onButtonClick_.bind(this);\n        this.onPopupChildBlur_ = this.onPopupChildBlur_.bind(this);\n        this.onPopupChildKeydown_ = this.onPopupChildKeydown_.bind(this);\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.foldable_ = Foldable.create(config.expanded);\n        this.view = new CubicBezierView(doc, {\n            foldable: this.foldable_,\n            pickerLayout: config.pickerLayout,\n            viewProps: this.viewProps,\n        });\n        this.view.buttonElement.addEventListener('blur', this.onButtonBlur_);\n        this.view.buttonElement.addEventListener('click', this.onButtonClick_);\n        this.tc_ = new TextController(doc, {\n            parser: cubicBezierFromString,\n            props: ValueMap.fromObject({\n                formatter: cubicBezierToString,\n            }),\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        this.view.textElement.appendChild(this.tc_.view.element);\n        this.popC_ =\n            config.pickerLayout === 'popup'\n                ? new PopupController(doc, {\n                    viewProps: this.viewProps,\n                })\n                : null;\n        const pickerC = new CubicBezierPickerController(doc, {\n            axis: config.axis,\n            value: this.value,\n            viewProps: this.viewProps,\n        });\n        pickerC.allFocusableElements.forEach((elem) => {\n            elem.addEventListener('blur', this.onPopupChildBlur_);\n            elem.addEventListener('keydown', this.onPopupChildKeydown_);\n        });\n        this.pickerC_ = pickerC;\n        if (this.popC_) {\n            this.view.element.appendChild(this.popC_.view.element);\n            this.popC_.view.element.appendChild(this.pickerC_.view.element);\n            bindValue(this.popC_.shows, (shows) => {\n                if (shows) {\n                    pickerC.refresh();\n                }\n            });\n            connectValues({\n                primary: this.foldable_.value('expanded'),\n                secondary: this.popC_.shows,\n                forward: (p) => p,\n                backward: (_, s) => s,\n            });\n        }\n        else if (this.view.pickerElement) {\n            this.view.pickerElement.appendChild(this.pickerC_.view.element);\n            bindFoldable(this.foldable_, this.view.pickerElement);\n        }\n    }\n    onButtonBlur_(ev) {\n        if (!this.popC_) {\n            return;\n        }\n        const nextTarget = forceCast(ev.relatedTarget);\n        if (!nextTarget || !this.popC_.view.element.contains(nextTarget)) {\n            this.popC_.shows.rawValue = false;\n        }\n    }\n    onButtonClick_() {\n        this.foldable_.set('expanded', !this.foldable_.get('expanded'));\n        if (this.foldable_.get('expanded')) {\n            this.pickerC_.allFocusableElements[0].focus();\n        }\n    }\n    onPopupChildBlur_(ev) {\n        if (!this.popC_) {\n            return;\n        }\n        const elem = this.popC_.view.element;\n        const nextTarget = findNextTarget(ev);\n        if (nextTarget && elem.contains(nextTarget)) {\n            // Next target is in the popup\n            return;\n        }\n        if (nextTarget &&\n            nextTarget === this.view.buttonElement &&\n            !supportsTouch(elem.ownerDocument)) {\n            // Next target is the trigger button\n            return;\n        }\n        this.popC_.shows.rawValue = false;\n    }\n    onPopupChildKeydown_(ev) {\n        if (!this.popC_) {\n            return;\n        }\n        if (ev.key === 'Escape') {\n            this.popC_.shows.rawValue = false;\n        }\n    }\n}\n\nfunction createConstraint$1() {\n    return new PointNdConstraint({\n        assembly: CubicBezierAssembly,\n        components: [0, 1, 2, 3].map((index) => index % 2 === 0\n            ? new RangeConstraint({\n                min: 0,\n                max: 1,\n            })\n            : undefined),\n    });\n}\nconst CubicBezierBladePlugin = createPlugin({\n    id: 'cubicbezier',\n    type: 'blade',\n    accept(params) {\n        const result = parseRecord(params, (p) => ({\n            value: p.required.array(p.required.number),\n            view: p.required.constant('cubicbezier'),\n            expanded: p.optional.boolean,\n            label: p.optional.string,\n            picker: p.optional.custom((v) => {\n                return v === 'inline' || v === 'popup' ? v : undefined;\n            }),\n        }));\n        return result ? { params: result } : null;\n    },\n    controller(args) {\n        var _a, _b;\n        const rv = new CubicBezier(...args.params.value);\n        const v = createValue(rv, {\n            constraint: createConstraint$1(),\n            equals: CubicBezier.equals,\n        });\n        const vc = new CubicBezierController(args.document, {\n            axis: {\n                textProps: ValueMap.fromObject({\n                    keyScale: 0.1,\n                    pointerScale: 0.01,\n                    formatter: createNumberFormatter(2),\n                }),\n            },\n            expanded: (_a = args.params.expanded) !== null && _a !== void 0 ? _a : false,\n            pickerLayout: (_b = args.params.picker) !== null && _b !== void 0 ? _b : 'popup',\n            value: v,\n            viewProps: args.viewProps,\n        });\n        return new LabeledValueBladeController(args.document, {\n            blade: args.blade,\n            props: ValueMap.fromObject({\n                label: args.params.label,\n            }),\n            value: v,\n            valueController: vc,\n        });\n    },\n    api(args) {\n        if (!(args.controller instanceof LabeledValueBladeController)) {\n            return null;\n        }\n        if (!(args.controller.valueController instanceof CubicBezierController)) {\n            return null;\n        }\n        return new CubicBezierApi(args.controller);\n    },\n});\n\nclass FpsGraphBladeApi extends BladeApi {\n    get fps() {\n        return this.controller.valueController.fps;\n    }\n    get max() {\n        return this.controller.valueController.props.get('max');\n    }\n    set max(max) {\n        this.controller.valueController.props.set('max', max);\n    }\n    get min() {\n        return this.controller.valueController.props.get('min');\n    }\n    set min(min) {\n        this.controller.valueController.props.set('min', min);\n    }\n    begin() {\n        this.controller.valueController.begin();\n    }\n    end() {\n        this.controller.valueController.end();\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        const emitter = this.controller.valueController.ticker.emitter;\n        emitter.on(eventName, () => {\n            bh(new TpEvent(this));\n        });\n        return this;\n    }\n}\n\nconst MAX_TIMESTAMPS = 20;\nclass Fpswatch {\n    constructor() {\n        this.start_ = null;\n        this.duration_ = 0;\n        this.fps_ = null;\n        this.frameCount_ = 0;\n        this.timestamps_ = [];\n    }\n    get duration() {\n        return this.duration_;\n    }\n    get fps() {\n        return this.fps_;\n    }\n    begin(now) {\n        this.start_ = now.getTime();\n    }\n    calculateFps_(nowTime) {\n        if (this.timestamps_.length === 0) {\n            return null;\n        }\n        const ts = this.timestamps_[0];\n        return (1000 * (this.frameCount_ - ts.frameCount)) / (nowTime - ts.time);\n    }\n    compactTimestamps_() {\n        if (this.timestamps_.length <= MAX_TIMESTAMPS) {\n            return;\n        }\n        const len = this.timestamps_.length - MAX_TIMESTAMPS;\n        this.timestamps_.splice(0, len);\n        const df = this.timestamps_[0].frameCount;\n        this.timestamps_.forEach((ts) => {\n            ts.frameCount -= df;\n        });\n        this.frameCount_ -= df;\n    }\n    end(now) {\n        if (this.start_ === null) {\n            return;\n        }\n        const t = now.getTime();\n        this.duration_ = t - this.start_;\n        this.start_ = null;\n        this.fps_ = this.calculateFps_(t);\n        this.timestamps_.push({\n            frameCount: this.frameCount_,\n            time: t,\n        });\n        ++this.frameCount_;\n        this.compactTimestamps_();\n    }\n}\n\nconst className$3 = ClassName('fps');\nclass FpsView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(className$3());\n        config.viewProps.bindClassModifiers(this.element);\n        this.graphElement = doc.createElement('div');\n        this.graphElement.classList.add(className$3('g'));\n        this.element.appendChild(this.graphElement);\n        const labelElement = doc.createElement('div');\n        labelElement.classList.add(className$3('l'));\n        this.element.appendChild(labelElement);\n        const valueElement = doc.createElement('span');\n        valueElement.classList.add(className$3('v'));\n        valueElement.textContent = '--';\n        labelElement.appendChild(valueElement);\n        this.valueElement = valueElement;\n        const unitElement = doc.createElement('span');\n        unitElement.classList.add(className$3('u'));\n        unitElement.textContent = 'FPS';\n        labelElement.appendChild(unitElement);\n    }\n}\n\nclass FpsGraphController {\n    constructor(doc, config) {\n        this.stopwatch_ = new Fpswatch();\n        this.onTick_ = this.onTick_.bind(this);\n        this.ticker = config.ticker;\n        this.ticker.emitter.on('tick', this.onTick_);\n        this.props = config.props;\n        this.value_ = config.value;\n        this.viewProps = config.viewProps;\n        this.view = new FpsView(doc, {\n            viewProps: this.viewProps,\n        });\n        this.graphC_ = new GraphLogController(doc, {\n            formatter: createNumberFormatter(0),\n            props: this.props,\n            rows: config.rows,\n            value: this.value_,\n            viewProps: this.viewProps,\n        });\n        this.view.graphElement.appendChild(this.graphC_.view.element);\n        this.viewProps.handleDispose(() => {\n            this.graphC_.viewProps.set('disposed', true);\n            this.ticker.dispose();\n        });\n    }\n    get fps() {\n        return this.stopwatch_.fps;\n    }\n    begin() {\n        this.stopwatch_.begin(new Date());\n    }\n    end() {\n        this.stopwatch_.end(new Date());\n    }\n    onTick_() {\n        const fps = this.fps;\n        if (fps !== null) {\n            const buffer = this.value_.rawValue;\n            this.value_.rawValue = createPushedBuffer(buffer, fps);\n            this.view.valueElement.textContent = fps.toFixed(0);\n        }\n    }\n}\n\nclass FpsGraphBladeController extends BladeController {\n    constructor(doc, config) {\n        const fc = config.valueController;\n        const lc = new LabelController(doc, {\n            blade: config.blade,\n            props: config.labelProps,\n            valueController: fc,\n        });\n        super({\n            blade: config.blade,\n            view: lc.view,\n            viewProps: fc.viewProps,\n        });\n        this.valueController = fc;\n        this.labelController = lc;\n    }\n}\n\nfunction createTicker(document, interval) {\n    return interval === 0\n        ? new ManualTicker()\n        : new IntervalTicker(document, interval !== null && interval !== void 0 ? interval : Constants.monitor.defaultInterval);\n}\nconst FpsGraphBladePlugin = createPlugin({\n    id: 'fpsgraph',\n    type: 'blade',\n    accept(params) {\n        const result = parseRecord(params, (p) => ({\n            view: p.required.constant('fpsgraph'),\n            interval: p.optional.number,\n            label: p.optional.string,\n            rows: p.optional.number,\n            max: p.optional.number,\n            min: p.optional.number,\n        }));\n        return result ? { params: result } : null;\n    },\n    controller(args) {\n        var _a, _b, _c, _d;\n        const interval = (_a = args.params.interval) !== null && _a !== void 0 ? _a : 500;\n        return new FpsGraphBladeController(args.document, {\n            blade: args.blade,\n            labelProps: ValueMap.fromObject({\n                label: args.params.label,\n            }),\n            valueController: new FpsGraphController(args.document, {\n                props: ValueMap.fromObject({\n                    max: (_b = args.params.max) !== null && _b !== void 0 ? _b : 90,\n                    min: (_c = args.params.min) !== null && _c !== void 0 ? _c : 0,\n                }),\n                rows: (_d = args.params.rows) !== null && _d !== void 0 ? _d : 2,\n                ticker: createTicker(args.document, interval),\n                value: createValue(initializeBuffer(80)),\n                viewProps: args.viewProps,\n            }),\n        });\n    },\n    api(args) {\n        if (!(args.controller instanceof FpsGraphBladeController)) {\n            return null;\n        }\n        return new FpsGraphBladeApi(args.controller);\n    },\n});\n\nclass Interval {\n    constructor(min, max) {\n        this.min = min;\n        this.max = max;\n    }\n    static isObject(obj) {\n        if (typeof obj !== 'object' || obj === null) {\n            return false;\n        }\n        const min = obj.min;\n        const max = obj.max;\n        if (typeof min !== 'number' || typeof max !== 'number') {\n            return false;\n        }\n        return true;\n    }\n    static equals(v1, v2) {\n        return v1.min === v2.min && v1.max === v2.max;\n    }\n    get length() {\n        return this.max - this.min;\n    }\n    toObject() {\n        return {\n            min: this.min,\n            max: this.max,\n        };\n    }\n}\nconst IntervalAssembly = {\n    fromComponents: (comps) => new Interval(comps[0], comps[1]),\n    toComponents: (p) => [p.min, p.max],\n};\n\nclass IntervalConstraint {\n    constructor(edge) {\n        this.edge = edge;\n    }\n    constrain(value) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n        if (value.min <= value.max) {\n            return new Interval((_b = (_a = this.edge) === null || _a === void 0 ? void 0 : _a.constrain(value.min)) !== null && _b !== void 0 ? _b : value.min, (_d = (_c = this.edge) === null || _c === void 0 ? void 0 : _c.constrain(value.max)) !== null && _d !== void 0 ? _d : value.max);\n        }\n        const c = (value.min + value.max) / 2;\n        return new Interval((_f = (_e = this.edge) === null || _e === void 0 ? void 0 : _e.constrain(c)) !== null && _f !== void 0 ? _f : c, (_h = (_g = this.edge) === null || _g === void 0 ? void 0 : _g.constrain(c)) !== null && _h !== void 0 ? _h : c);\n    }\n}\n\nconst className$2 = ClassName('rsltxt');\nclass RangeSliderTextView {\n    constructor(doc, config) {\n        this.sliderView_ = config.sliderView;\n        this.textView_ = config.textView;\n        this.element = doc.createElement('div');\n        this.element.classList.add(className$2());\n        const sliderElem = doc.createElement('div');\n        sliderElem.classList.add(className$2('s'));\n        sliderElem.appendChild(this.sliderView_.element);\n        this.element.appendChild(sliderElem);\n        const textElem = doc.createElement('div');\n        textElem.classList.add(className$2('t'));\n        textElem.appendChild(this.textView_.element);\n        this.element.appendChild(textElem);\n    }\n}\n\nconst className$1 = ClassName('rsl');\nclass RangeSliderView {\n    constructor(doc, config) {\n        this.onSliderPropsChange_ = this.onSliderPropsChange_.bind(this);\n        this.onValueChange_ = this.onValueChange_.bind(this);\n        this.sliderProps_ = config.sliderProps;\n        this.sliderProps_.emitter.on('change', this.onSliderPropsChange_);\n        this.element = doc.createElement('div');\n        this.element.classList.add(className$1());\n        config.viewProps.bindClassModifiers(this.element);\n        this.value_ = config.value;\n        this.value_.emitter.on('change', this.onValueChange_);\n        const trackElem = doc.createElement('div');\n        trackElem.classList.add(className$1('t'));\n        this.element.appendChild(trackElem);\n        this.trackElement = trackElem;\n        const barElem = doc.createElement('div');\n        barElem.classList.add(className$1('b'));\n        trackElem.appendChild(barElem);\n        this.barElement = barElem;\n        const knobElems = ['min', 'max'].map((modifier) => {\n            const elem = doc.createElement('div');\n            elem.classList.add(className$1('k'), className$1('k', modifier));\n            trackElem.appendChild(elem);\n            return elem;\n        });\n        this.knobElements = [knobElems[0], knobElems[1]];\n        this.update_();\n    }\n    valueToX_(value) {\n        const min = this.sliderProps_.get('min');\n        const max = this.sliderProps_.get('max');\n        return constrainRange(mapRange(value, min, max, 0, 1), 0, 1) * 100;\n    }\n    update_() {\n        const v = this.value_.rawValue;\n        if (v.length === 0) {\n            this.element.classList.add(className$1(undefined, 'zero'));\n        }\n        else {\n            this.element.classList.remove(className$1(undefined, 'zero'));\n        }\n        const xs = [this.valueToX_(v.min), this.valueToX_(v.max)];\n        this.barElement.style.left = `${xs[0]}%`;\n        this.barElement.style.right = `${100 - xs[1]}%`;\n        this.knobElements.forEach((elem, index) => {\n            elem.style.left = `${xs[index]}%`;\n        });\n    }\n    onSliderPropsChange_() {\n        this.update_();\n    }\n    onValueChange_() {\n        this.update_();\n    }\n}\n\nclass RangeSliderController {\n    constructor(doc, config) {\n        this.grabbing_ = null;\n        this.grabOffset_ = 0;\n        this.onPointerDown_ = this.onPointerDown_.bind(this);\n        this.onPointerMove_ = this.onPointerMove_.bind(this);\n        this.onPointerUp_ = this.onPointerUp_.bind(this);\n        this.sliderProps = config.sliderProps;\n        this.viewProps = config.viewProps;\n        this.value = config.value;\n        this.view = new RangeSliderView(doc, {\n            sliderProps: this.sliderProps,\n            value: this.value,\n            viewProps: config.viewProps,\n        });\n        const ptHandler = new PointerHandler(this.view.trackElement);\n        ptHandler.emitter.on('down', this.onPointerDown_);\n        ptHandler.emitter.on('move', this.onPointerMove_);\n        ptHandler.emitter.on('up', this.onPointerUp_);\n    }\n    ofs_() {\n        if (this.grabbing_ === 'min') {\n            return this.view.knobElements[0].getBoundingClientRect().width / 2;\n        }\n        if (this.grabbing_ === 'max') {\n            return -this.view.knobElements[1].getBoundingClientRect().width / 2;\n        }\n        return 0;\n    }\n    valueFromData_(data) {\n        if (!data.point) {\n            return null;\n        }\n        const p = (data.point.x + this.ofs_()) / data.bounds.width;\n        const min = this.sliderProps.get('min');\n        const max = this.sliderProps.get('max');\n        return mapRange(p, 0, 1, min, max);\n    }\n    onPointerDown_(ev) {\n        if (!ev.data.point) {\n            return;\n        }\n        const p = ev.data.point.x / ev.data.bounds.width;\n        const v = this.value.rawValue;\n        const min = this.sliderProps.get('min');\n        const max = this.sliderProps.get('max');\n        const pmin = mapRange(v.min, min, max, 0, 1);\n        const pmax = mapRange(v.max, min, max, 0, 1);\n        if (Math.abs(pmax - p) <= 0.025) {\n            this.grabbing_ = 'max';\n        }\n        else if (Math.abs(pmin - p) <= 0.025) {\n            this.grabbing_ = 'min';\n        }\n        else if (p >= pmin && p <= pmax) {\n            this.grabbing_ = 'length';\n            this.grabOffset_ = mapRange(p - pmin, 0, 1, 0, max - min);\n        }\n        else if (p < pmin) {\n            this.grabbing_ = 'min';\n            this.onPointerMove_(ev);\n        }\n        else if (p > pmax) {\n            this.grabbing_ = 'max';\n            this.onPointerMove_(ev);\n        }\n    }\n    applyPointToValue_(data, opts) {\n        const v = this.valueFromData_(data);\n        if (v === null) {\n            return;\n        }\n        const rmin = this.sliderProps.get('min');\n        const rmax = this.sliderProps.get('max');\n        if (this.grabbing_ === 'min') {\n            this.value.setRawValue(new Interval(v, this.value.rawValue.max), opts);\n        }\n        else if (this.grabbing_ === 'max') {\n            this.value.setRawValue(new Interval(this.value.rawValue.min, v), opts);\n        }\n        else if (this.grabbing_ === 'length') {\n            const len = this.value.rawValue.length;\n            let min = v - this.grabOffset_;\n            let max = min + len;\n            if (min < rmin) {\n                min = rmin;\n                max = rmin + len;\n            }\n            else if (max > rmax) {\n                min = rmax - len;\n                max = rmax;\n            }\n            this.value.setRawValue(new Interval(min, max), opts);\n        }\n    }\n    onPointerMove_(ev) {\n        this.applyPointToValue_(ev.data, {\n            forceEmit: false,\n            last: false,\n        });\n    }\n    onPointerUp_(ev) {\n        this.applyPointToValue_(ev.data, {\n            forceEmit: true,\n            last: true,\n        });\n        this.grabbing_ = null;\n    }\n}\n\nclass RangeSliderTextController {\n    constructor(doc, config) {\n        this.value = config.value;\n        this.viewProps = config.viewProps;\n        this.sc_ = new RangeSliderController(doc, config);\n        const axis = {\n            constraint: config.constraint,\n            textProps: config.textProps,\n        };\n        this.tc_ = new PointNdTextController(doc, {\n            assembly: IntervalAssembly,\n            axes: [axis, axis],\n            parser: config.parser,\n            value: this.value,\n            viewProps: config.viewProps,\n        });\n        this.view = new RangeSliderTextView(doc, {\n            sliderView: this.sc_.view,\n            textView: this.tc_.view,\n        });\n    }\n    get textController() {\n        return this.tc_;\n    }\n}\n\nfunction intervalFromUnknown(value) {\n    return Interval.isObject(value)\n        ? new Interval(value.min, value.max)\n        : new Interval(0, 0);\n}\nfunction writeInterval(target, value) {\n    target.writeProperty('max', value.max);\n    target.writeProperty('min', value.min);\n}\n\nfunction createConstraint(params) {\n    const constraints = [];\n    const rc = createRangeConstraint(params);\n    if (rc) {\n        constraints.push(rc);\n    }\n    const sc = createStepConstraint(params);\n    if (sc) {\n        constraints.push(sc);\n    }\n    return new IntervalConstraint(new CompositeConstraint(constraints));\n}\nconst IntervalInputPlugin = createPlugin({\n    id: 'input-interval',\n    type: 'input',\n    accept: (exValue, params) => {\n        if (!Interval.isObject(exValue)) {\n            return null;\n        }\n        const result = parseRecord(params, (p) => (Object.assign(Object.assign({}, createNumberTextInputParamsParser(p)), { readonly: p.optional.constant(false) })));\n        return result\n            ? {\n                initialValue: new Interval(exValue.min, exValue.max),\n                params: result,\n            }\n            : null;\n    },\n    binding: {\n        reader: (_args) => intervalFromUnknown,\n        constraint: (args) => createConstraint(args.params),\n        equals: Interval.equals,\n        writer: (_args) => writeInterval,\n    },\n    controller(args) {\n        const v = args.value;\n        const c = args.constraint;\n        if (!(c instanceof IntervalConstraint)) {\n            throw TpError.shouldNeverHappen();\n        }\n        const midValue = (v.rawValue.min + v.rawValue.max) / 2;\n        const textProps = ValueMap.fromObject(createNumberTextPropsObject(args.params, midValue));\n        const drc = c.edge && findConstraint(c.edge, DefiniteRangeConstraint);\n        if (drc) {\n            return new RangeSliderTextController(args.document, {\n                constraint: c.edge,\n                parser: parseNumber,\n                sliderProps: new ValueMap({\n                    keyScale: textProps.value('keyScale'),\n                    max: drc.values.value('max'),\n                    min: drc.values.value('min'),\n                }),\n                textProps: textProps,\n                value: v,\n                viewProps: args.viewProps,\n            });\n        }\n        const axis = {\n            constraint: c.edge,\n            textProps: textProps,\n        };\n        return new PointNdTextController(args.document, {\n            assembly: IntervalAssembly,\n            axes: [axis, axis],\n            parser: parseNumber,\n            value: v,\n            viewProps: args.viewProps,\n        });\n    },\n});\n\nclass RadioCellApi {\n    constructor(controller) {\n        this.controller_ = controller;\n    }\n    get disabled() {\n        return this.controller_.viewProps.get('disabled');\n    }\n    set disabled(disabled) {\n        this.controller_.viewProps.set('disabled', disabled);\n    }\n    get title() {\n        var _a;\n        return (_a = this.controller_.props.get('title')) !== null && _a !== void 0 ? _a : '';\n    }\n    set title(title) {\n        this.controller_.props.set('title', title);\n    }\n}\n\nclass TpRadioGridChangeEvent extends TpChangeEvent {\n    constructor(target, cell, index, value, last) {\n        super(target, value, last);\n        this.cell = cell;\n        this.index = index;\n    }\n}\n\nclass RadioGridApi extends BladeApi {\n    constructor(controller) {\n        super(controller);\n        this.cellToApiMap_ = new Map();\n        const gc = this.controller.valueController;\n        gc.cellControllers.forEach((cc) => {\n            const api = new RadioCellApi(cc);\n            this.cellToApiMap_.set(cc, api);\n        });\n    }\n    get value() {\n        return this.controller.value;\n    }\n    cell(x, y) {\n        const gc = this.controller.valueController;\n        const cc = gc.cellControllers[y * gc.size[0] + x];\n        return this.cellToApiMap_.get(cc);\n    }\n    on(eventName, handler) {\n        const bh = handler.bind(this);\n        this.controller.value.emitter.on(eventName, (ev) => {\n            const gc = this.controller.valueController;\n            const cc = gc.findCellByValue(ev.rawValue);\n            if (!cc) {\n                return;\n            }\n            const capi = this.cellToApiMap_.get(cc);\n            if (!capi) {\n                return;\n            }\n            const i = gc.cellControllers.indexOf(cc);\n            bh(new TpRadioGridChangeEvent(this, capi, [i % gc.size[0], Math.floor(i / gc.size[0])], ev.rawValue));\n        });\n    }\n}\n\nconst className = ClassName('rad');\nclass RadioView {\n    constructor(doc, config) {\n        this.element = doc.createElement('div');\n        this.element.classList.add(className());\n        config.viewProps.bindClassModifiers(this.element);\n        const labelElem = doc.createElement('label');\n        labelElem.classList.add(className('l'));\n        this.element.appendChild(labelElem);\n        const inputElem = doc.createElement('input');\n        inputElem.classList.add(className('i'));\n        inputElem.name = config.name;\n        inputElem.type = 'radio';\n        config.viewProps.bindDisabled(inputElem);\n        labelElem.appendChild(inputElem);\n        this.inputElement = inputElem;\n        const bodyElem = doc.createElement('div');\n        bodyElem.classList.add(className('b'));\n        labelElem.appendChild(bodyElem);\n        const titleElem = doc.createElement('div');\n        titleElem.classList.add(className('t'));\n        bodyElem.appendChild(titleElem);\n        bindValueMap(config.props, 'title', (title) => {\n            titleElem.textContent = title;\n        });\n    }\n}\n\nclass RadioController {\n    constructor(doc, config) {\n        this.props = config.props;\n        this.viewProps = config.viewProps;\n        this.view = new RadioView(doc, {\n            name: config.name,\n            props: this.props,\n            viewProps: this.viewProps,\n        });\n    }\n}\n\nclass RadioGridController {\n    constructor(doc, config) {\n        this.cellCs_ = [];\n        this.cellValues_ = [];\n        this.onCellInputChange_ = this.onCellInputChange_.bind(this);\n        this.size = config.size;\n        const [w, h] = this.size;\n        for (let y = 0; y < h; y++) {\n            for (let x = 0; x < w; x++) {\n                const bc = new RadioController(doc, {\n                    name: config.groupName,\n                    props: ValueMap.fromObject(Object.assign({}, config.cellConfig(x, y))),\n                    viewProps: ViewProps.create(),\n                });\n                this.cellCs_.push(bc);\n                this.cellValues_.push(config.cellConfig(x, y).value);\n            }\n        }\n        this.value = config.value;\n        bindValue(this.value, (value) => {\n            const cc = this.findCellByValue(value);\n            if (!cc) {\n                return;\n            }\n            cc.view.inputElement.checked = true;\n        });\n        this.viewProps = ViewProps.create();\n        this.view = new PlainView(doc, {\n            viewProps: this.viewProps,\n            viewName: 'radgrid',\n        });\n        this.view.element.style.gridTemplateColumns = `repeat(${w}, 1fr)`;\n        this.cellCs_.forEach((bc) => {\n            bc.view.inputElement.addEventListener('change', this.onCellInputChange_);\n            this.view.element.appendChild(bc.view.element);\n        });\n    }\n    get cellControllers() {\n        return this.cellCs_;\n    }\n    findCellByValue(value) {\n        const index = this.cellValues_.findIndex((v) => v === value);\n        if (index < 0) {\n            return null;\n        }\n        return this.cellCs_[index];\n    }\n    onCellInputChange_(ev) {\n        const inputElem = ev.currentTarget;\n        const index = this.cellCs_.findIndex((c) => c.view.inputElement === inputElem);\n        if (index < 0) {\n            return;\n        }\n        this.value.rawValue = this.cellValues_[index];\n    }\n}\n\nconst RadioGridBladePlugin = (function () {\n    return createPlugin({\n        id: 'radiogrid',\n        type: 'blade',\n        accept(params) {\n            const result = parseRecord(params, (p) => ({\n                cells: p.required.function,\n                groupName: p.required.string,\n                size: p.required.array(p.required.number),\n                value: p.required.raw,\n                view: p.required.constant('radiogrid'),\n                label: p.optional.string,\n            }));\n            return result ? { params: result } : null;\n        },\n        controller(args) {\n            const value = createValue(args.params.value);\n            return new LabeledValueBladeController(args.document, {\n                blade: args.blade,\n                props: ValueMap.fromObject({\n                    label: args.params.label,\n                }),\n                value: value,\n                valueController: new RadioGridController(args.document, {\n                    groupName: args.params.groupName,\n                    cellConfig: args.params.cells,\n                    size: args.params.size,\n                    value: value,\n                }),\n            });\n        },\n        api(args) {\n            if (!(args.controller instanceof LabeledValueBladeController)) {\n                return null;\n            }\n            if (!(args.controller.valueController instanceof RadioGridController)) {\n                return null;\n            }\n            return new RadioGridApi(args.controller);\n        },\n    });\n})();\n\nfunction createRadioGridInputPlugin(config) {\n    return createPlugin({\n        id: 'input-radiogrid',\n        type: 'input',\n        accept(value, params) {\n            if (!config.isType(value)) {\n                return null;\n            }\n            const result = parseRecord(params, (p) => ({\n                cells: p.required.function,\n                groupName: p.required.string,\n                size: p.required.array(p.required.number),\n                view: p.required.constant('radiogrid'),\n            }));\n            return result\n                ? {\n                    initialValue: value,\n                    params: result,\n                }\n                : null;\n        },\n        binding: config.binding,\n        controller: (args) => {\n            return new RadioGridController(args.document, {\n                cellConfig: args.params.cells,\n                groupName: args.params.groupName,\n                size: args.params.size,\n                value: args.value,\n            });\n        },\n    });\n}\nconst RadioGruidNumberInputPlugin = createRadioGridInputPlugin({\n    isType: (value) => {\n        return typeof value === 'number';\n    },\n    binding: {\n        reader: (_args) => numberFromUnknown,\n        writer: (_args) => writePrimitive,\n    },\n});\nconst RadioGruidStringInputPlugin = createRadioGridInputPlugin({\n    isType: (value) => {\n        return typeof value === 'string';\n    },\n    binding: {\n        reader: (_args) => stringFromUnknown,\n        writer: (_args) => writePrimitive,\n    },\n});\nconst RadioGruidBooleanInputPlugin = createRadioGridInputPlugin({\n    isType: (value) => {\n        return typeof value === 'boolean';\n    },\n    binding: {\n        reader: (_args) => boolFromUnknown,\n        writer: (_args) => writePrimitive,\n    },\n});\n\nconst id = 'essentials';\nconst css = '.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--bld-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--cnt-usz);line-height:var(--cnt-usz);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--cnt-usz);line-height:var(--cnt-usz);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--bld-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--cnt-usz)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--cnt-usp);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-hp));position:absolute;right:calc(-1 * var(--cnt-hp));top:var(--cnt-usz)}.tp-cbzpv_t{margin-top:var(--cnt-usp)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--cnt-usz) * 5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--cnt-usz));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:\"\";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:\"\";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--cnt-usz) - 8px);margin-top:calc((var(--cnt-usz) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--bld-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}';\nconst plugins = [\n    ButtonGridBladePlugin,\n    CubicBezierBladePlugin,\n    FpsGraphBladePlugin,\n    IntervalInputPlugin,\n    RadioGridBladePlugin,\n    RadioGruidBooleanInputPlugin,\n    RadioGruidNumberInputPlugin,\n    RadioGruidStringInputPlugin,\n];\n\nexport { ButtonCellApi, ButtonGridApi, ButtonGridController, CubicBezier, CubicBezierApi, CubicBezierAssembly, CubicBezierController, CubicBezierGraphController, CubicBezierGraphView, CubicBezierPickerController, CubicBezierPickerView, CubicBezierPreviewView, CubicBezierView, FpsGraphBladeApi, FpsGraphController, FpsView, Fpswatch, Interval, IntervalAssembly, IntervalConstraint, RadioCellApi, RadioController, RadioGridApi, RadioGridController, RadioView, RangeSliderController, RangeSliderTextController, RangeSliderTextView, RangeSliderView, TpRadioGridChangeEvent, css, id, plugins };\n","import { Pane } from 'tweakpane';\nimport * as EssentialsPlugin from '@tweakpane/plugin-essentials';\n\nexport const pane = new Pane();\npane.registerPlugin(EssentialsPlugin);\nexport const info = pane.addFolder({ title: 'Info', expanded: false });\nexport const settings = pane.addFolder({ title: 'Settings', expanded: false });\nexport const nextBtn = settings.addButton({ title: 'Next mesh >>', index: 0 });\nsettings.addBlade({ view: 'separator', index: 1 });\n","import {\n    Scene,\n    PerspectiveCamera,\n    AmbientLight,\n    DirectionalLight,\n    WebGPURenderer,\n    NoColorSpace,\n    Clock,\n    PostProcessing,\n} from 'three/webgpu';\nimport { pass, mrt, output, emissive } from 'three/tsl';\nimport { bloom } from 'three/addons/tsl/display/BloomNode.js';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\nimport { info, settings } from './gui';\n\nconst fpsGraph = info.addBlade({\n    view: 'fpsgraph',\n    label: 'fps',\n    rows: 2,\n    min: 0,\n    max: 300,\n});\n// *******************************************************************************************************************\n// Canvas\nconst canvas = document.querySelector('canvas');\n\n// *******************************************************************************************************************\n// Scene\nexport const scene = new Scene();\n\n// *******************************************************************************************************************\n// Base camera\nexport const camera = new PerspectiveCamera(\n    65,\n    window.innerWidth / window.innerHeight,\n    0.1,\n    100\n);\ncamera.position.set(1.8, 0.3, -4).divideScalar(2.7);\nscene.add(camera);\n\n// *******************************************************************************************************************\n// Lighting\nconst alight = new AmbientLight(0xffffff, 5.5);\nconst dlight1 = new DirectionalLight(0xffffff, 6.5);\nconst dlight2 = new DirectionalLight(0xffffff, 3.5);\n\ndlight1.position.set(-3, 2, 3);\ndlight1.lookAt(0, 0, 0);\n\ndlight2.position.set(3, 2, 3);\ndlight2.lookAt(0, 0, 0);\n\nscene.add(alight, dlight1, dlight2);\n\n// *******************************************************************************************************************\n// Controls\nconst controls = new OrbitControls(camera, canvas);\ncontrols.target.set(0, 0, 0);\ncontrols.enableDamping = true;\ncontrols.enablePan = false;\n\n// *******************************************************************************************************************\n// Renderer\nexport const renderer = new WebGPURenderer({\n    // forceWebGL: true,\n    canvas,\n    antialias: true,\n});\nrenderer.setClearColor(0x000000, 1);\nrenderer.setSize(window.innerWidth, window.innerHeight);\nrenderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));\nrenderer.outputColorSpace = NoColorSpace;\n\nwindow.addEventListener('resize', () => {\n    const [width, height] = [window.innerWidth, window.innerHeight];\n\n    camera.aspect = width / height;\n    camera.updateProjectionMatrix();\n\n    renderer.setSize(width, height);\n});\n\n// *******************************************************************************************************************\n// Postprocessing\nconst scenePass = pass(scene, camera);\nscenePass.setMRT(\n    mrt({\n        output,\n        emissive,\n    })\n);\n\nconst outputPass = scenePass.getTextureNode();\nconst emissivePass = scenePass.getTextureNode('emissive');\n\nconst bloomPass = bloom(emissivePass, 6.5, 1.5);\n\nconst postProcessing = new PostProcessing(renderer);\npostProcessing.outputNode = outputPass.add(bloomPass);\n\n// *******************************************************************************************************************\n// GUI\nconst params = {\n    rotationSpeed: 0.07,\n    spotLight: false,\n    frameTime: 0,\n    avgFrameTime: 0,\n    framesTimeSum: 0,\n    framesCount: 0,\n    floor: false,\n};\ninfo.addBinding(params, 'frameTime', {\n    label: 'Frame time',\n    view: 'graph',\n    readonly: true,\n    min: 0,\n    max: 15,\n    rows: 2,\n});\ninfo.addBinding(params, 'avgFrameTime', {\n    label: 'Avg frame time',\n    readonly: true,\n    interval: 1000,\n});\n\nsettings.addBinding(params, 'rotationSpeed', {\n    label: 'rot/sec',\n    min: 0,\n    max: 0.3,\n    step: 0.01,\n});\nsettings\n    .addBinding(dlight1, 'intensity', {\n        label: 'Light intensity',\n        min: 0,\n        max: 20,\n        step: 0.1,\n    })\n    .on('change', ({ value }) => {\n        dlight2.intensity = value / 2;\n    });\n\n// *******************************************************************************************************************\n// Animation loop\nconst clock = new Clock();\nconst avgFrameTimeBatchSize = 100;\nlet animationCallback = null;\nlet postProcessingEnabled = false;\n\nconst tick = () => {\n    const delta = clock.getDelta();\n\n    controls.update();\n\n    animationCallback?.(delta, params);\n\n    fpsGraph.begin();\n    const start = performance.now();\n    postProcessingEnabled\n        ? postProcessing.renderAsync()\n        : renderer.renderAsync(scene, camera);\n    params.frameTime = performance.now() - start;\n    fpsGraph.end();\n\n    if (params.framesCounterStartTime === null) {\n        params.framesCounterStartTime = start;\n    }\n    params.framesCount += 1;\n    params.framesTimeSum += params.frameTime;\n    if (params.framesCount >= avgFrameTimeBatchSize) {\n        params.avgFrameTime = params.framesTimeSum / params.framesCount;\n        params.framesCount = 0;\n        params.framesTimeSum = 0;\n    }\n\n    requestAnimationFrame(tick);\n};\ntick();\n\nexport const onFrame = (callback) => {\n    animationCallback = callback;\n};\n\nexport const togglePostProcessing = (enabled) => {\n    postProcessingEnabled = enabled;\n};\n","import {\n    Fn,\n    abs,\n    clamp,\n    colorToDirection,\n    cross,\n    cubeTexture,\n    dot,\n    mat3,\n    max,\n    min,\n    mix,\n    normalGeometry,\n    normalize,\n    positionGeometry,\n    pow,\n    step,\n    texture,\n    vec4,\n} from 'three/tsl';\n\nlet subsurfaceNormal;\nlet subsurfacePosition;\nlet surfaceNormal;\nlet viewVecDotSubsurfNormal;\nlet viewVec;\nlet subsurfaceBasicNormal;\nlet mipLevel;\n\nconst calcFinalColor = Fn(\n    ([surfaceColor, mediumColor, thinMediumColor, subsurfaceTint]) =>\n        mix(\n            mix(\n                mediumColor,\n                surfaceColor.mul(subsurfaceTint),\n                min(pow(max(viewVecDotSubsurfNormal, 0), 4), 1)\n            ),\n            thinMediumColor,\n            pow(max(viewVecDotSubsurfNormal.negate(), 0), 4)\n        )\n);\nconst triplanarProject = ([\n    textureSampler,\n    position,\n    normal,\n    mipLevel,\n    scale,\n]) => {\n    const absN = abs(normal);\n    const positionScaled = position.toVar().mul(scale);\n    const uvX = positionScaled.yz;\n    const uvY = positionScaled.xz;\n    const uvZ = positionScaled.xy;\n    const componentsSum = absN.x.add(absN.y).add(absN.z).toVar();\n    const blendX = absN.x.div(componentsSum);\n    const blendY = absN.y.div(componentsSum);\n    const blendZ = absN.z.div(componentsSum);\n    const xColor = texture(textureSampler, uvX, mipLevel);\n    const yColor = texture(textureSampler, uvY, mipLevel);\n    const zColor = texture(textureSampler, uvZ, mipLevel);\n\n    return xColor.mul(blendX).add(yColor.mul(blendY)).add(zColor.mul(blendZ));\n};\n\nexport const getSubsurfaceNormalFromCubeMap = Fn(\n    ({ subsurfacePosition, normalCubeMap }) =>\n        normalize(\n            cubeTexture(normalCubeMap, subsurfacePosition).xyz.mul(2).sub(1)\n        )\n);\n\nexport const getSubsurfaceNormalValue = Fn(() => subsurfaceBasicNormal);\n\nexport const getSubsurfaceNormalWithNormalMapping = Fn(\n    ({\n        subsurfacePosition,\n        tangentCubeMap,\n        normalMap,\n        textureScale,\n        viewVec,\n        mipLevel,\n    }) => {\n        const tangent = normalize(\n            cubeTexture(tangentCubeMap, subsurfacePosition).xyz.mul(2).sub(1)\n        );\n        const bitangent = cross(subsurfaceBasicNormal, tangent);\n        const TBN = mat3(tangent, bitangent, subsurfaceBasicNormal);\n        const normalMapValue = colorToDirection(\n            triplanarProject([\n                normalMap,\n                subsurfacePosition,\n                surfaceNormal,\n                mipLevel,\n                textureScale,\n            ])\n        );\n        const mappedNormal = TBN.mul(normalMapValue);\n        const normalDotViewVec = dot(subsurfaceBasicNormal, viewVec);\n\n        return mix(\n            subsurfaceBasicNormal,\n            mappedNormal,\n            step(0.1, normalDotViewVec)\n        );\n    }\n);\n\nexport const buildSubsurfaceShader = ({\n    modelSpaceCameraPos,\n    mediumColor,\n    thinMediumColor,\n    subsurfaceTint,\n    depth,\n    mipMultiplier,\n    minMipLevel,\n}) =>\n    Fn(\n        ({\n            normalCubeMap,\n            colorTexture,\n            colorBoost,\n            textureScale,\n            getSubsurfaceNormal,\n        }) => {\n            viewVec = normalize(\n                modelSpaceCameraPos.sub(positionGeometry)\n            ).toVar();\n            const scaleFactor = depth.div(dot(viewVec, normalGeometry));\n            const subsurfaceIntersectionVector = viewVec\n                .negate()\n                .mul(scaleFactor);\n            subsurfacePosition = positionGeometry\n                .add(subsurfaceIntersectionVector)\n                .toVar();\n            surfaceNormal = normalize(\n                cubeTexture(normalCubeMap, positionGeometry).xyz.mul(2).sub(1)\n            ).toVar();\n\n            subsurfaceBasicNormal = getSubsurfaceNormalFromCubeMap({\n                normalCubeMap,\n                subsurfacePosition,\n            }).toVar();\n\n            mipLevel = dot(subsurfaceBasicNormal, viewVec)\n                .oneMinus()\n                .mul(mipMultiplier)\n                .add(minMipLevel);\n\n            subsurfaceNormal = getSubsurfaceNormal({\n                subsurfacePosition,\n                viewVec,\n                mipLevel,\n            }).toVar();\n\n            const surfaceColor = triplanarProject([\n                colorTexture,\n                subsurfacePosition,\n                surfaceNormal,\n                mipLevel,\n                textureScale,\n            ]);\n\n            viewVecDotSubsurfNormal = dot(\n                subsurfaceNormal.xyz,\n                viewVec\n            ).toVar();\n\n            return calcFinalColor([\n                vec4(surfaceColor.mul(colorBoost).rgb, 1),\n                mediumColor,\n                thinMediumColor,\n                subsurfaceTint,\n            ]);\n        }\n    );\n\nexport const buildEmissiveShader = ({ subsurfaceTint }) =>\n    Fn(({ emissiveMap, colorBoost, textureScale }) => {\n        const emission = triplanarProject([\n            emissiveMap,\n            subsurfacePosition,\n            surfaceNormal,\n            mipLevel,\n            textureScale,\n        ]);\n        const mcolor = mix(\n            vec4(0, 0, 0, 1),\n            emission.mul(subsurfaceTint),\n            pow(clamp(viewVecDotSubsurfNormal, 0, 1), 4)\n        );\n\n        return vec4(mcolor.rgb.mul(colorBoost), 1);\n    });\n","import {\n    CubeCamera,\n    DoubleSide,\n    HalfFloatType,\n    LinearFilter,\n    LinearSRGBColorSpace,\n    Mesh,\n    NodeMaterial,\n    RGBAFormat,\n    Scene,\n    WebGLCubeRenderTarget,\n} from 'three/webgpu';\nimport { attribute, normalGeometry, vec4 } from 'three/tsl';\n\nconst scene = new Scene();\nconst normalMaterial = new NodeMaterial();\nnormalMaterial.side = DoubleSide;\nnormalMaterial.colorNode = vec4(normalGeometry.add(1).div(2), 1);\nconst tangentMaterial = new NodeMaterial();\ntangentMaterial.side = DoubleSide;\ntangentMaterial.colorNode = vec4(attribute('tangent', 'vec3').add(1).div(2), 1);\nconst cubeCamera = new CubeCamera(0.1, 3);\ncubeCamera.position.set(0, 0, 0);\n\nexport const createNormalCubeMap = async (renderer, geometry) => {\n    if (!renderer._initialized) {\n        await renderer.init();\n    }\n\n    const normalsCubeRT = new WebGLCubeRenderTarget(256, {\n        generateMipmaps: true,\n        minFilter: LinearFilter,\n        magFilter: LinearFilter,\n        format: RGBAFormat,\n        colorSpace: LinearSRGBColorSpace,\n        type: HalfFloatType,\n    });\n    const tangentsCubeRT = new WebGLCubeRenderTarget(256, {\n        generateMipmaps: true,\n        minFilter: LinearFilter,\n        magFilter: LinearFilter,\n        format: RGBAFormat,\n        colorSpace: LinearSRGBColorSpace,\n        type: HalfFloatType,\n    });\n\n    const mesh = new Mesh(geometry, normalMaterial);\n    cubeCamera.renderTarget = normalsCubeRT;\n    geometry.computeTangents();\n\n    scene.clear();\n    scene.add(mesh);\n    scene.add(cubeCamera);\n    cubeCamera.update(renderer, scene);\n\n    mesh.material = tangentMaterial;\n    cubeCamera.renderTarget = tangentsCubeRT;\n    cubeCamera.update(renderer, scene);\n\n    return [normalsCubeRT.texture, tangentsCubeRT.texture];\n};\n","import { Color, Matrix4, Vector4 } from 'three/webgpu';\nimport { uniform } from 'three/tsl';\nimport { settings } from './gui';\nimport { camera } from './sceneSetup';\n\nconst bindings = {};\n// *******************************************************************************************************************\n// Uniforms\nconst colorParams = { view: 'color', color: { alpha: false, type: 'float' } };\nconst params = [\n    {\n        name: 'depth',\n        value: 0.1,\n        params: {\n            label: 'Depth',\n            min: 0,\n            max: 0.15,\n            step: 0.001,\n            index: 2,\n        },\n    },\n    'delimiter',\n    {\n        name: 'mediumColor',\n        value: new Color(0.05, 0.02, 0.02),\n        params: { ...colorParams, label: 'Medium color' },\n    },\n    {\n        name: 'thinMediumColor',\n        value: new Color(0.79, 0.07, 0.04),\n        params: { ...colorParams, label: 'Thin medium color' },\n    },\n    {\n        name: 'subsurfaceTint',\n        value: new Color(0.6, 0.32, 0.09),\n        params: { ...colorParams, label: 'Subsurface tint' },\n    },\n    'delimiter',\n    {\n        name: 'mipMultiplier',\n        value: 4,\n        params: { label: 'Mip multiplier', min: 0, max: 20, step: 1 },\n    },\n    {\n        name: 'minMipLevel',\n        value: 2,\n        params: { label: 'Min mip level', min: 0, max: 10, step: 1 },\n    },\n];\n\nexport const uniforms = params.reduce((result, param) => {\n    if (param !== 'delimiter') {\n        result[param.name] = uniform(param.value);\n    }\n    return result;\n}, {});\n\nconst _inverseModelMatrix = new Matrix4();\nconst _cameraPosition = new Vector4();\nuniforms.modelSpaceCameraPos = uniform(camera.position);\nuniforms.modelSpaceCameraPos.onObjectUpdate(({ object }) =>\n    _cameraPosition\n        .copy(camera.position)\n        .applyMatrix4(_inverseModelMatrix.copy(object.matrixWorld).transpose())\n);\n\nparams.forEach((param) => {\n    if (param === 'delimiter') {\n        settings.addBlade({ view: 'separator' });\n        return;\n    }\n    if (typeof param === 'function') {\n        param();\n        return;\n    }\n\n    bindings[param.name] = settings\n        .addBinding(param, 'value', param.params)\n        .on('change', () => (uniforms[param.name].value = param.value));\n});\n\n// *******************************************************************************************************************\n// Color preset\nconst p = { colorPreset: 'Red' };\nconst colorPresets = {\n    Red: {\n        mediumColor: new Color(0.05, 0.02, 0.02),\n        thinMediumColor: new Color(0.79, 0.07, 0.04),\n        subsurfaceTint: new Color(0.6, 0.32, 0.09),\n    },\n    Yellow: {\n        mediumColor: new Color(0.05, 0.03, 0.02),\n        thinMediumColor: new Color(0.82, 0.38, 0.02),\n        subsurfaceTint: new Color(0.56, 0.32, 0.09),\n    },\n    Green: {\n        mediumColor: new Color(0.02, 0.05, 0.02),\n        thinMediumColor: new Color(0.02, 0.76, 0.13),\n        subsurfaceTint: new Color(0.08, 0.47, 0.34),\n    },\n    'Light blue': {\n        mediumColor: new Color(0.02, 0.05, 0.05),\n        thinMediumColor: new Color(0.03, 0.75, 0.89),\n        subsurfaceTint: new Color(0.1, 0.45, 0.59),\n    },\n    Purple: {\n        mediumColor: new Color(0.04, 0.02, 0.05),\n        thinMediumColor: new Color(0.46, 0.03, 0.89),\n        subsurfaceTint: new Color(0.46, 0.1, 0.59),\n    },\n    White: {\n        mediumColor: new Color(0.08, 0.08, 0.08),\n        thinMediumColor: new Color(0.78, 0.71, 0.66),\n        subsurfaceTint: new Color(0.36, 0.41, 0.41),\n    },\n};\n\nsettings\n    .addBinding(p, 'colorPreset', {\n        label: 'Color preset',\n        groupName: 'Color preset',\n        view: 'radiogrid',\n        size: [2, 3],\n        cells: (x, y) => {\n            const key = Object.keys(colorPresets)[x + y * 2];\n            return { value: key, title: key };\n        },\n        index: 2,\n    })\n    .on('change', ({ value }) => {\n        const preset = colorPresets[value];\n        Object.keys(preset).forEach((key) => {\n            params.find((param) => param.name === key).value.copy(preset[key]);\n            bindings[key].refresh();\n        });\n    });\n\nsettings.addBlade({ view: 'separator', index: 3 });\n\nexport const updateUniform = (name, value) => {\n    params.find((param) => param.name === name).value = value;\n    bindings[name].refresh();\n};\n","import {\n    LoadingManager,\n    TextureLoader,\n    MirroredRepeatWrapping,\n    RepeatWrapping,\n    SRGBColorSpace,\n    NodeMaterial,\n    DoubleSide,\n    MeshStandardNodeMaterial,\n    FrontSide,\n} from 'three/webgpu';\nimport {\n    cameraPosition,\n    dot,\n    min,\n    normalWorld,\n    normalize,\n    positionWorld,\n    vec3,\n    vec4,\n} from 'three/tsl';\nimport {\n    buildEmissiveShader,\n    buildSubsurfaceShader,\n    getSubsurfaceNormalWithNormalMapping,\n    getSubsurfaceNormalValue,\n} from './subsurfaceShader';\nimport { createNormalCubeMap } from './createNormalCubeMap';\nimport { renderer, togglePostProcessing } from './sceneSetup';\nimport { uniforms, updateUniform } from './uniforms';\nimport { settings } from './gui';\nimport { addAsset, assetLoaded } from './assetsLoadingIndicator';\n\nconst subsurfaceShader = buildSubsurfaceShader(uniforms);\nconst emissiveShader = buildEmissiveShader(uniforms);\nconst loadingManager = new LoadingManager();\nconst textureLoader = new TextureLoader(loadingManager);\n\n// *********************************************************************************************************************\n// GUI\nconst materials = [];\nconst meshes = [];\nconst loadedTextures = new Set();\nconst loadTexture = (url) => {\n    if (loadedTextures.has(url)) {\n        return textureLoader.load(url);\n    }\n\n    loadedTextures.add(url);\n    addAsset('Textures');\n\n    return textureLoader.load(url, () => assetLoaded('Textures'));\n};\n\nconst texuresConfig = [\n    {\n        colorMap: loadTexture('textures/stonewall_18_basecolor_gs.webp'),\n        normalMap: loadTexture('textures/stonewall_18_normal.webp'),\n        scale: 4,\n        label: 'stone nm',\n        mirror: true,\n        colorBoost: 6.5,\n        onSelect: () => {\n            // updateUniform('minMipLevel', 2);\n            // updateUniform('mipMultiplier', 10);\n            togglePostProcessing(false);\n        },\n    },\n    {\n        colorMap: loadTexture('textures/stonewall_18_basecolor_gs.webp'),\n        scale: 4,\n        label: 'stone',\n        mirror: true,\n        colorBoost: 6.5,\n        onSelect: () => {\n            // updateUniform('minMipLevel', 2);\n            // updateUniform('mipMultiplier', 10);\n            togglePostProcessing(false);\n        },\n    },\n    {\n        colorMap: loadTexture('textures/tree_11_diffuse_gs.webp'),\n        normalMap: loadTexture('textures/tree_11_normal.webp'),\n        scale: 2,\n        label: 'tree nm',\n        mirror: true,\n        colorBoost: 6.5,\n        onSelect: () => {\n            // updateUniform('minMipLevel', 1);\n            // updateUniform('mipMultiplier', 8);\n            togglePostProcessing(false);\n        },\n    },\n    {\n        colorMap: loadTexture('textures/tree_11_diffuse_gs.webp'),\n        scale: 2,\n        label: 'tree',\n        mirror: true,\n        colorBoost: 6.5,\n        onSelect: () => {\n            // updateUniform('minMipLevel', 1);\n            // updateUniform('mipMultiplier', 8);\n            togglePostProcessing(false);\n        },\n    },\n    {\n        colorMap: loadTexture('textures/lava_02_emissive.webp'),\n        emissiveMap: loadTexture('textures/lava_02_emissive.webp'),\n        colorBoost: 6,\n        emissiveColorBoost: 1.5,\n        scale: 4,\n        label: 'emissive',\n        onSelect: () => {\n            // updateUniform('minMipLevel', 2);\n            // updateUniform('mipMultiplier', 8);\n            togglePostProcessing(true);\n        },\n    },\n    {\n        colorMap: loadTexture('textures/marble_32-diffuse.webp'),\n        mirror: false,\n        scale: 3,\n        label: 'potato',\n        colorBoost: 2,\n        onSelect: () => {\n            // updateUniform('minMipLevel', 0);\n            // updateUniform('mipMultiplier', 6);\n            togglePostProcessing(false);\n        },\n    },\n];\n\ntexuresConfig.forEach(({ colorMap, emissiveMap, mirror, normalMap }) => {\n    const em = emissiveMap || {};\n    const nm = normalMap || {};\n    const wrap = mirror ? MirroredRepeatWrapping : RepeatWrapping;\n    nm.wrapS = em.wrapS = colorMap.wrapS = wrap;\n    nm.wrapT = em.wrapT = colorMap.wrapT = wrap;\n    em.colorSpace = colorMap.colorSpace = SRGBColorSpace;\n});\n\nconst applyTexture = (textureIndex, material) => {\n    const config = texuresConfig[textureIndex];\n    config.normalMap\n        ? (material.colorNode = subsurfaceShader({\n              colorTexture: config.colorMap,\n              normalCubeMap: material.userData.normalCubeMap,\n              colorBoost: config.colorBoost || 1,\n              textureScale: config.scale || 1,\n              getSubsurfaceNormal: ({\n                  subsurfacePosition,\n                  viewVec,\n                  mipLevel,\n              }) =>\n                  getSubsurfaceNormalWithNormalMapping({\n                      normalCubeMap: material.userData.normalCubeMap,\n                      tangentCubeMap: material.userData.tangentCubeMap,\n                      subsurfacePosition,\n                      textureScale: config.scale || 1,\n                      normalMap: config.normalMap,\n                      viewVec,\n                      mipLevel,\n                  }),\n          }))\n        : (material.colorNode = subsurfaceShader({\n              colorTexture: config.colorMap,\n              normalCubeMap: material.userData.normalCubeMap,\n              colorBoost: config.colorBoost || 1,\n              textureScale: config.scale || 1,\n              getSubsurfaceNormal: getSubsurfaceNormalValue,\n          }));\n\n    material.emissiveNode = config.emissiveMap\n        ? emissiveShader({\n              emissiveMap: config.emissiveMap,\n              colorBoost: config.emissiveColorBoost || 1,\n              textureScale: config.scale || 1,\n          })\n        : null;\n    config.onSelect?.();\n    material.needsUpdate = true;\n};\nconst params = { textureIndex: 0, wireframe: false, scattering: 1 };\n\nsettings\n    .addBinding(params, 'wireframe', {\n        label: 'Wireframe',\n        index: 2,\n    })\n    .on('change', ({ value }) => {\n        meshes.forEach(\n            (mesh) =>\n                (mesh.material = value\n                    ? mesh.userData.overviewMaterial\n                    : mesh.userData.effectMaterial)\n        );\n    });\n\nconst applyScatteringPreset = (value) => {\n    updateUniform('minMipLevel', [0, 1, 2][value]);\n    updateUniform('mipMultiplier', [0, 6, 10][value]);\n};\napplyScatteringPreset(params.scattering);\nsettings\n    .addBinding(params, 'scattering', {\n        label: 'Scattering intensity',\n        groupName: 'Scattering intensity',\n        view: 'radiogrid',\n        size: [3, 1],\n        cells: (x) => ({ value: x, title: ['Off', 'Low', 'High'][x] }),\n        index: 4,\n    })\n    .on('change', ({ value }) => applyScatteringPreset(value));\n\nsettings\n    .addBinding(params, 'textureIndex', {\n        label: 'Subsurface texture',\n        groupName: 'Subsurface texture',\n        view: 'radiogrid',\n        size: [2, 3],\n        cells: (x, y) => {\n            const index = x + y * 2;\n            const item = texuresConfig[index];\n            return { value: index, title: item.label };\n        },\n        index: 3,\n    })\n    .on('change', ({ value }) => {\n        materials.forEach((material) => applyTexture(value, material));\n    });\n\n// *********************************************************************************************************************\n// Mesh material initialization\n\nconst overviewMaterial = new NodeMaterial();\noverviewMaterial.colorNode = (() => {\n    const viewVec = normalize(cameraPosition.sub(positionWorld));\n    return vec4(\n        vec3(min(dot(normalWorld, viewVec).mul(0.5).add(0.5).add(0.2), 0.7)),\n        1\n    );\n})();\noverviewMaterial.wireframe = true;\noverviewMaterial.side = DoubleSide;\n\nexport const initMeshMaterial = async (mesh) => {\n    const [normalCubeMap, tangentCubeMap] = await createNormalCubeMap(\n        renderer,\n        mesh.geometry\n    );\n    const originalMaterial = mesh.material;\n    const newMaterial = new MeshStandardNodeMaterial();\n\n    // This may look odd, but I ran into a peculiar problem.\n    // Even though the normal cube maps for two different meshes were generated correctly and were distinct,\n    // The cube maps passed to the subsurface shader ended up being the same for both meshes.\n    // Interestingly, this issue only appeared for those specific two meshes,\n    // And changing their loading order didn’t help.\n    // I tried investigating the problem, but decided not to spend too much time on it.\n    // Recreating the material for each mesh ultimately resolved the issue.\n    Object.entries(originalMaterial).forEach(\n        ([key, value]) => (newMaterial[key] = value)\n    );\n    newMaterial.emissiveIntensity = 0;\n    newMaterial.aoMapIntensity = 0;\n    newMaterial.userData = { normalCubeMap, tangentCubeMap };\n    newMaterial.emissiveMap = null;\n    newMaterial.side = FrontSide;\n    applyTexture(0, newMaterial);\n    mesh.material = newMaterial;\n\n    materials.push(newMaterial);\n    meshes.push(mesh);\n\n    mesh.userData = { effectMaterial: newMaterial, overviewMaterial };\n    return mesh;\n};\n","import { Group } from 'three/webgpu';\n\nimport { loadMesh } from './loadMesh';\nimport { onFrame, scene } from './sceneSetup';\nimport { nextBtn } from './gui';\nimport { initMeshMaterial } from './initMeshMaterial';\nimport { assetLoaded } from './assetsLoadingIndicator';\n\nconst main = async () => {\n    // *******************************************************************************************************************\n    // Assets\n\n    let meshes = await Promise.all([\n        loadMesh('models/crystal_d_3_min.glb'),\n        loadMesh('models/crystal_d_6_min.glb'),\n        loadMesh('models/crystal_heart_min.glb'),\n    ]);\n\n    meshes = await Promise.all(\n        meshes.map(async (mesh) => {\n            await initMeshMaterial(mesh);\n            assetLoaded('Meshes');\n            return mesh;\n        })\n    );\n\n    // *******************************************************************************************************************\n    // GUI\n\n    let currentMeshIndex = 0;\n    const meshGroup = new Group();\n    scene.add(meshGroup);\n\n    const applyMesh = async () => {\n        meshGroup.clear();\n        const mesh = meshes[currentMeshIndex];\n\n        onFrame((delta, params) => {\n            mesh.rotation.y += Math.PI * 2 * delta * params.rotationSpeed;\n        });\n\n        meshGroup.add(mesh);\n    };\n    const nextMesh = async () => {\n        currentMeshIndex = (currentMeshIndex + 1) % meshes.length;\n        await applyMesh();\n    };\n\n    await applyMesh();\n\n    nextBtn.on('click', nextMesh);\n\n    const assetsInfo = document.querySelector('.assets-info');\n    document.querySelectorAll('.assets-info-toggle').forEach((element) =>\n        element.addEventListener('click', () => {\n            assetsInfo.classList.toggle('visible');\n        })\n    );\n};\n\nmain();\n"],"names":["REVISION","MOUSE","TOUCH","CullFaceNone","CullFaceBack","CullFaceFront","BasicShadowMap","PCFShadowMap","VSMShadowMap","FrontSide","BackSide","DoubleSide","NoBlending","NormalBlending","AdditiveBlending","SubtractiveBlending","MultiplyBlending","CustomBlending","AddEquation","SubtractEquation","ReverseSubtractEquation","MinEquation","MaxEquation","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor","NeverDepth","AlwaysDepth","LessDepth","LessEqualDepth","EqualDepth","GreaterEqualDepth","GreaterDepth","NotEqualDepth","MultiplyOperation","MixOperation","AddOperation","NoToneMapping","LinearToneMapping","ReinhardToneMapping","CineonToneMapping","ACESFilmicToneMapping","AgXToneMapping","NeutralToneMapping","AttachedBindMode","DetachedBindMode","UVMapping","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","CubeUVReflectionMapping","RepeatWrapping","ClampToEdgeWrapping","MirroredRepeatWrapping","NearestFilter","NearestMipmapNearestFilter","NearestMipmapLinearFilter","LinearFilter","LinearMipmapNearestFilter","LinearMipmapLinearFilter","LinearMipMapLinearFilter","UnsignedByteType","ByteType","ShortType","UnsignedShortType","IntType","UnsignedIntType","FloatType","HalfFloatType","UnsignedShort4444Type","UnsignedShort5551Type","UnsignedInt248Type","UnsignedInt5999Type","AlphaFormat","RGBFormat","RGBAFormat","LuminanceFormat","LuminanceAlphaFormat","DepthFormat","DepthStencilFormat","RedFormat","RedIntegerFormat","RGFormat","RGIntegerFormat","RGBIntegerFormat","RGBAIntegerFormat","RGB_S3TC_DXT1_Format","RGBA_S3TC_DXT1_Format","RGBA_S3TC_DXT3_Format","RGBA_S3TC_DXT5_Format","RGB_PVRTC_4BPPV1_Format","RGB_PVRTC_2BPPV1_Format","RGBA_PVRTC_4BPPV1_Format","RGBA_PVRTC_2BPPV1_Format","RGB_ETC1_Format","RGB_ETC2_Format","RGBA_ETC2_EAC_Format","RGBA_ASTC_4x4_Format","RGBA_ASTC_5x4_Format","RGBA_ASTC_5x5_Format","RGBA_ASTC_6x5_Format","RGBA_ASTC_6x6_Format","RGBA_ASTC_8x5_Format","RGBA_ASTC_8x6_Format","RGBA_ASTC_8x8_Format","RGBA_ASTC_10x5_Format","RGBA_ASTC_10x6_Format","RGBA_ASTC_10x8_Format","RGBA_ASTC_10x10_Format","RGBA_ASTC_12x10_Format","RGBA_ASTC_12x12_Format","RGBA_BPTC_Format","RED_RGTC1_Format","SIGNED_RED_RGTC1_Format","RED_GREEN_RGTC2_Format","SIGNED_RED_GREEN_RGTC2_Format","InterpolateDiscrete","InterpolateLinear","InterpolateSmooth","ZeroCurvatureEnding","ZeroSlopeEnding","WrapAroundEnding","NormalAnimationBlendMode","TrianglesDrawMode","TriangleStripDrawMode","TriangleFanDrawMode","TangentSpaceNormalMap","ObjectSpaceNormalMap","NoColorSpace","SRGBColorSpace","LinearSRGBColorSpace","LinearTransfer","SRGBTransfer","ZeroStencilOp","KeepStencilOp","ReplaceStencilOp","IncrementStencilOp","DecrementStencilOp","IncrementWrapStencilOp","DecrementWrapStencilOp","InvertStencilOp","NeverStencilFunc","LessStencilFunc","EqualStencilFunc","LessEqualStencilFunc","GreaterStencilFunc","NotEqualStencilFunc","GreaterEqualStencilFunc","AlwaysStencilFunc","NeverCompare","LessCompare","EqualCompare","LessEqualCompare","GreaterCompare","NotEqualCompare","GreaterEqualCompare","AlwaysCompare","StaticDrawUsage","DynamicDrawUsage","WebGLCoordinateSystem","WebGPUCoordinateSystem","EventDispatcher","type","listener","listeners","listenerArray","index","event","array","i","l","_lut","_seed","DEG2RAD","RAD2DEG","generateUUID","d0","d1","d2","d3","clamp","value","min","max","euclideanModulo","n","m","mapLinear","x","a1","a2","b1","b2","inverseLerp","y","lerp","damp","lambda","dt","pingpong","length","smoothstep","smootherstep","randInt","low","high","randFloat","randFloatSpread","range","seededRandom","s","t","degToRad","degrees","radToDeg","radians","isPowerOfTwo","ceilPowerOfTwo","floorPowerOfTwo","setQuaternionFromProperEuler","q","a","b","c","order","cos","sin","c2","s2","c13","s13","c1_3","s1_3","c3_1","s3_1","denormalize","normalize","MathUtils","Vector2","scalar","v","e","minVal","maxVal","denominator","theta","dx","dy","alpha","v1","v2","offset","attribute","center","angle","Matrix3","n11","n12","n13","n21","n22","n23","n31","n32","n33","te","me","xAxis","yAxis","zAxis","ae","be","a11","a12","a13","a21","a22","a23","a31","a32","a33","b11","b12","b13","b21","b22","b23","b31","b32","b33","d","f","g","h","t11","t12","t13","det","detInv","tmp","matrix4","r","tx","ty","sx","sy","rotation","cx","cy","_m3","matrix","arrayNeedsUint32","createElementNS","name","createCanvasElement","canvas","_cache","warnOnce","message","LINEAR_REC709_TO_XYZ","XYZ_TO_LINEAR_REC709","createColorManagement","ColorManagement","color","sourceColorSpace","targetColorSpace","SRGBToLinear","LinearToSRGB","colorSpace","target","colorSpaces","targetMatrix","REC709_PRIMARIES","REC709_LUMINANCE_COEFFICIENTS","D65","_canvas","ImageUtils","image","context","imageData","data","_sourceId","Source","meta","isRootObject","output","url","serializeImage","_textureId","Texture","mapping","wrapS","wrapT","magFilter","minFilter","format","anisotropy","source","uv","Vector4","z","w","m11","m12","m13","m21","m22","m23","m31","m32","m33","xx","yy","zz","xy","xz","yz","RenderTarget","width","height","options","texture","count","depth","il","WebGLRenderTarget","DataArrayTexture","layerIndex","Quaternion","dst","dstOffset","src0","srcOffset0","src1","srcOffset1","x0","y0","z0","w0","x1","y1","z1","w1","dir","sqrSin","len","tDir","quaternion","euler","update","c1","c3","s1","s3","axis","halfAngle","trace","vFrom","vTo","step","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","qb","cosHalfTheta","sqrSinHalfTheta","sinHalfTheta","halfTheta","ratioA","ratioB","qa","theta1","theta2","r1","r2","callback","Vector3","_quaternion$4","vx","vy","vz","qx","qy","qz","qw","tz","camera","ax","ay","az","bx","by","bz","planeNormal","_vector$c","normal","dz","radius","phi","sinPhiRadius","sz","u","Box3","_vector$b","points","size","halfSize","object","precise","box","point","vector","geometry","positionAttribute","_box$4","children","sphere","plane","triangle","_center","_extents","_v0$2","_v1$7","_v2$4","_f0","_f1","_f2","axes","satForAxes","_triangleNormal","_points","_testAxis","v0","extents","j","p0","p1","p2","_box$3","_v1$6","_v2$3","Sphere","optionalCenter","maxRadiusSq","radiusSum","deltaLengthSq","lengthSq","delta","_vector$a","_segCenter","_segDir","_diff","_edge1","_edge2","_normal$1","Ray","origin","direction","ray","directionDistance","optionalPointOnRay","optionalPointOnSegment","segExtent","a01","b0","s0","sqrDist","extDet","invDet","tca","radius2","thc","t0","t1","distToPoint","tmin","tmax","tymin","tymax","tzmin","tzmax","invdirx","invdiry","invdirz","backfaceCulling","DdN","sign","DdQxE2","DdE1xQ","QdN","Matrix4","n14","n24","n34","n41","n42","n43","n44","scaleX","_v1$5","scaleY","scaleZ","af","bf","ce","cf","de","df","ac","ad","bc","bd","_zero","_one","eye","up","_z","_x","_y","a14","a24","a34","a41","a42","a43","a44","b14","b24","b34","b41","b42","b43","b44","t14","scaleXSq","scaleYSq","scaleZSq","yx","zx","zy","position","scale","x2","y2","z2","wx","wy","wz","_m1$2","invSX","invSY","invSZ","left","right","top","bottom","near","far","coordinateSystem","p","zInv","_matrix$2","_quaternion$3","Euler","newOrder","Layers","channel","layers","_object3DId","_v1$4","_q1","_m1$1","_target","_position$3","_scale$2","_quaternion$2","_xAxis","_yAxis","_zAxis","_addedEvent","_removedEvent","_childaddedEvent","_childremovedEvent","Object3D","onRotationChange","onQuaternionChange","distance","parent","id","result","force","updateParents","updateChildren","bound","serialize","library","element","parameters","shapes","shape","uuids","animation","geometries","extractFromCache","materials","textures","images","skeletons","animations","nodes","cache","values","key","recursive","child","_v0$1","_v1$3","_v2$2","_v3$2","_vab","_vac","_vbc","_vap","_vbp","_vcp","_v40","_v41","_v42","Triangle","targetLengthSq","dot00","dot01","dot02","dot11","dot12","denom","invDenom","p3","v3","attr","i1","i2","i3","barycoord","i0","d4","vc","d5","d6","vb","va","_colorKeywords","_hslA","_hslB","hue2rgb","Color","hex","style","handleAlpha","string","components","_color","hue","saturation","lightness","color1","color2","_materialId","Material","newValue","currentValue","srcPlanes","dstPlanes","MeshBasicMaterial","_tables","_generateTables","buffer","floatView","uint32View","baseTable","shiftTable","mantissaTable","exponentTable","offsetTable","toHalfFloat","val","fromHalfFloat","_vector$9","_vector2$1","BufferAttribute","itemSize","normalized","start","index1","index2","component","Uint16BufferAttribute","Uint32BufferAttribute","Float16BufferAttribute","Float32BufferAttribute","_id$1","_m1","_obj","_offset","_box$2","_boxMorphTargets","_vector$8","BufferGeometry","indirect","materialIndex","normalMatrix","tangent","morphAttributesPosition","morphAttribute","morphTargetsRelative","jl","attributes","normalAttribute","uvAttribute","tangentAttribute","tan1","tan2","vA","vB","vC","uvA","uvB","uvC","sdir","tdir","handleTriangle","groups","group","tmp2","n2","handleVertex","pA","pB","pC","nA","nB","nC","cb","ab","normals","convertBufferAttribute","indices","array2","geometry2","newAttribute","morphAttributes","morphArray","hasMorphAttributes","attributeArray","boundingSphere","boundingBox","_inverseMatrix$3","_ray$3","_sphere$6","_sphereHitAt","_vA$1","_vB$1","_vC$1","_tempA","_morphA","_intersectionPoint","_intersectionPointWorld","Mesh","material","keys","ml","morphPosition","morphInfluences","influence","raycaster","intersects","matrixWorld","rayLocalSpace","intersection","uv1","drawRange","groupMaterial","end","checkGeometryIntersection","checkIntersection$1","intersect","face","BoxGeometry","widthSegments","heightSegments","depthSegments","scope","vertices","uvs","numberOfVertices","groupStart","buildPlane","udir","vdir","gridX","gridY","segmentWidth","segmentHeight","widthHalf","heightHalf","depthHalf","gridX1","gridY1","vertexCounter","groupCount","iy","ix","cloneUniforms","src","property","cloneUniformsGroups","default_vertex","default_fragment","ShaderMaterial","extensions","Camera","_v3$1","_minTarget","_maxTarget","PerspectiveCamera","fov","aspect","focalLength","vExtentSlope","minTarget","maxTarget","fullWidth","fullHeight","view","skew","CubeCamera","renderTarget","cameraPX","cameraNX","cameraPY","cameraNY","cameraPZ","cameraNZ","cameras","renderer","scene","activeMipmapLevel","currentRenderTarget","currentActiveCubeFace","currentActiveMipmapLevel","currentXrEnabled","generateMipmaps","CubeTexture","WebGLCubeRenderTarget","shader","mesh","currentMinFilter","stencil","Scene","InterleavedBuffer","stride","ib","_vector$7","InterleavedBufferAttribute","interleavedBuffer","SpriteMaterial","_basePosition","_skinIndex","_skinWeight","_vector3","_matrix4","_vertex","_sphere$5","_inverseMatrix$2","_ray$2","SkinnedMesh","skeleton","bindMatrix","skinWeight","weight","boneIndex","Bone","DataTexture","_offsetMatrix","_identityMatrix","Skeleton","bones","boneInverses","inverse","bone","boneMatrices","boneTexture","json","uuid","boneInverse","InstancedBufferAttribute","meshPerAttribute","_instanceLocalMatrix","_instanceWorldMatrix","_instanceIntersects","_box3","_identity","_mesh$1","_sphere$4","InstancedMesh","objectInfluences","dataIndex","raycastTimes","instanceId","morphInfluencesSum","morphBaseInfluence","_vector1","_vector2","_normalMatrix","Plane","constant","inverseNormalLength","line","startSign","endSign","optionalNormalMatrix","referencePoint","_sphere$3","_vector$6","Frustum","p4","p5","planes","frustum","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","sprite","negRadius","LineBasicMaterial","_vStart","_vEnd","_inverseMatrix$1","_ray$1","_sphere$1","_intersectPointOnRay","_intersectPointOnSegment","Line","lineDistances","threshold","localThreshold","localThresholdSq","checkIntersection","thresholdSq","_start","_end","LineSegments","LineLoop","PointsMaterial","_inverseMatrix","_ray","_sphere","_position$2","Points","testPoint","rayPointDistanceSq","intersectPoint","Group","FramebufferTexture","DepthTexture","SphereGeometry","phiStart","phiLength","thetaStart","thetaLength","thetaEnd","grid","vertex","verticesRow","uOffset","ShadowMaterial","MeshStandardMaterial","MeshPhysicalMaterial","reflectivity","MeshPhongMaterial","MeshToonMaterial","MeshNormalMaterial","MeshLambertMaterial","MeshMatcapMaterial","LineDashedMaterial","convertArray","forceClone","isTypedArray","getKeyframeOrder","times","compareTime","sortedArray","nValues","srcOffset","flattenJSON","jsonKeys","valuePropertyName","Interpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","pp","validate_interval","seek","linear_scan","forward_scan","giveUpAt","t1global","mid","CubicInterpolant","iPrev","iNext","tPrev","tNext","halfDt","o1","o0","oP","oN","wP","wN","ppp","sP","sN","LinearInterpolant","offset1","offset0","weight1","weight0","DiscreteInterpolant","KeyframeTrack","interpolation","track","trackType","factoryMethod","timeOffset","timeScale","startTime","endTime","nKeys","from","to","valid","valueSize","prevTime","currTime","smoothInterpolation","lastIndex","writeIndex","keep","time","timeNext","offsetP","offsetN","readOffset","writeOffset","TypedKeyframeTrack","BooleanKeyframeTrack","ColorKeyframeTrack","NumberKeyframeTrack","QuaternionLinearInterpolant","QuaternionKeyframeTrack","StringKeyframeTrack","VectorKeyframeTrack","AnimationClip","duration","tracks","blendMode","jsonTracks","frameTime","parseKeyframeTrack","clip","clipTracks","morphTargetSequence","fps","noLoop","numMorphTargets","objectOrClipArray","clipArray","o","morphTargets","animationToMorphTargets","pattern","morphTarget","parts","animationMorphTargets","clips","addNonemptyTrack","trackName","animationKeys","propertyName","destTracks","clipName","hierarchyTracks","morphTargetNames","k","morphTargetName","animationKey","boneName","getTrackTypeForValueTypeName","typeName","Cache","file","LoadingManager","onLoad","onProgress","onError","isLoading","itemsLoaded","itemsTotal","urlModifier","handlers","transform","regex","loader","DefaultLoadingManager","Loader","manager","resolve","reject","crossOrigin","path","resourcePath","requestHeader","loading","HttpError","response","FileLoader","cached","req","mimeType","responseType","callbacks","reader","contentLength","total","lengthComputable","loaded","stream","controller","readData","done","text","exec","label","decoder","err","ImageLoader","onImageLoad","removeEventListeners","onImageError","TextureLoader","Light","intensity","HemisphereLight","skyColor","groundColor","_projScreenMatrix$1","_lightPositionWorld$1","_lookTarget$1","LightShadow","light","shadowCamera","shadowMatrix","viewportIndex","SpotLightShadow","SpotLight","penumbra","decay","power","_projScreenMatrix","_lightPositionWorld","_lookTarget","PointLightShadow","PointLight","OrthographicCamera","scaleW","scaleH","DirectionalLightShadow","DirectionalLight","AmbientLight","RectAreaLight","SphericalHarmonics3","coefficients","coeff","sh","shBasis","LightProbe","LoaderUtils","ImageBitmapLoader","imageBitmap","fetchOptions","promise","res","blob","Clock","autoStart","now","diff","newTime","_RESERVED_CHARS_RE","_reservedRe","_wordChar","_wordCharOrDot","_directoryRe","_nodeRe","_objectRe","_propertyRe","_trackRe","_supportedObjectNames","Composite","targetGroup","optionalParsedPath","parsedPath","PropertyBinding","firstValidIndex","binding","bindings","rootNode","root","matches","results","lastDot","objectName","nodeName","searchNodeSubtree","childNode","subTreeNode","dest","targetArray","sourceArray","targetObject","propertyIndex","objectIndex","nodeProperty","versioning","bindingType","InstancedInterleavedBuffer","Spherical","other","Controls","domElement","refreshUniforms","NodeMaterialObserver","builder","renderObject","attributesData","renderObjectData","materialData","mtlValue","storedGeometryData","storedAttributes","storedAttributeNames","currentAttributeNames","storedAttributeData","storedIndexVersion","currentIndexVersion","morphChanged","nodeFrame","renderId","isStatic","isBundle","cyrb53","seed","h1","h2","ch","hashString","str","hashArray","hash$1","params","getCacheKey$1","getNodeChildren","node","toJSON","subProperty","typeFromLength","getTypeFromLength","getLengthFromType","getValueType","typeOf","getValueFromType","last4","base64ToArrayBuffer","arrayBufferToBase64","arrayBuffer","chars","base64","NodeShaderStage","NodeUpdateType","NodeType","NodeAccess","defaultShaderStages","defaultBuildStages","shaderStages","vectorComponents","_nodeId","Node","nodeType","updateType","nodeProperties","hash","outputNode","refNode","buildStage","properties","stackNodesBeforeSetup","nodeData","nodeChildren","inputNodes","inputArray","inputObject","isRoot","ArrayElementNode","indexNode","nodeSnippet","indexSnippet","ConvertNode","convertTo","requestType","overloadingType","snippet","TempNode","nodeVar","JoinNode","cur","primitiveType","snippetValues","input","inputSnippet","inputPrimitiveType","stringVectorComponents","SplitNode","vectorLength","nodeTypeLength","SetNode","sourceNode","targetNode","sourceType","targetType","targetSnippet","sourceSnippet","FlipNode","sourceCache","sourceProperty","componentIndex","InputNode","precision","ConstNode","currentStack","NodeElements","addMethodChaining","nodeElement","parseSwizzle","props","parseSwizzleAndSort","shaderNodeHandler","NodeClosure","inputs","nodeObjects","prop","nodeObj","nodeObject","nodeObjectsCacheMap","nodeBuilderFunctionsCacheMap","ShaderNodeObject","obj","altType","getConstNode","Fn","ShaderNodeObjects","objects","ShaderNodeArray","ShaderNodeProxy","NodeClass","factor","settings","assignNode","nodeArray","ShaderNodeImmutable","ShaderCallNodeInternal","shaderNode","functionNodesCacheMap","functionNode","jsFunc","ShaderNodeInternal","layout","bools","uints","ints","floats","boolsCacheMap","bool","uintsCacheMap","uint","intsCacheMap","el","int","floatsCacheMap","float","cacheMaps","constNodesCacheMap","safeGetNodeType","ConvertType","cacheMap","param","defined","getConstNodeType","ShaderNode","nodeProxy","nodeImmutable","fn","tslFn","setCurrentStack","stack","getCurrentStack","If","append","vec2","ivec2","uvec2","bvec2","vec3","ivec3","uvec3","bvec3","vec4","ivec4","uvec4","bvec4","mat2","mat3","mat4","convert","types","split","channels","UniformGroupNode","shared","uniformGroup","sharedUniformGroup","frameGroup","renderGroup","objectGroup","UniformNode","self","frame","sharedNode","sharedNodeType","nodeUniform","uniform","arg1","arg2","PropertyNode","varying","varyingProperty","diffuseColor","emissive","roughness","metalness","clearcoat","clearcoatRoughness","sheen","sheenRoughness","iridescence","iridescenceIOR","iridescenceThickness","alphaT","anisotropyT","anisotropyB","specularColor","specularF90","shininess","dashSize","gapSize","pointWidth","ior","transmission","thickness","attenuationDistance","attenuationColor","dispersion","AssignNode","targetLength","needsSplitAssign","sourceVar","targetRoot","assign","FunctionCallNode","generateInput","inputNode","pointer","call","func","OperatorNode","op","aNode","bNode","finalOp","typeA","typeB","typeLength","outputLength","fnOpSnippet","add","sub","mul","div","modInt","equal","notEqual","lessThan","greaterThan","lessThanEqual","greaterThanEqual","and","or","not","xor","bitAnd","bitNot","bitOr","bitXor","shiftLeft","shiftRight","remainder","MathNode","method","cNode","aType","bType","cType","aLen","bLen","cLen","inputType","isWebGL","tA","tB","mulNode","abs","EPSILON","INFINITY","PI","PI2","all","any","equals","exp","exp2","log","log2","sqrt","inverseSqrt","floor","ceil","fract","tan","asin","acos","atan","negate","oneMinus","dFdx","dFdy","round","reciprocal","trunc","fwidth","bitcast","transpose","atan2","min$1","max$1","mod","reflect","difference","dot","cross","pow","pow2","pow3","pow4","transformDirection","cbrt","mix","saturate","refract","faceForward","rand","sn","mixElement","e1","e2","smoothstepElement","ConditionalNode","condNode","ifNode","elseNode","ifType","elseType","currentNodeBlock","needsOutput","ifSnippet","elseSnippet","select","cond","ContextNode","previousContext","VarNode","createVar","temp","VaryingNode","sRGBTransferEOTF","sRGBTransferOETF","WORKING_COLOR_SPACE","OUTPUT_COLOR_SPACE","ColorSpaceNode","colorNode","toOutputColorSpace","toWorkingColorSpace","workingToColorSpace","colorSpaceToWorking","convertColorSpace","ReferenceElementNode$1","referenceNode","arrayType","elementType","ReferenceBaseNode","uniformType","state","reference$1","RendererReferenceNode","rendererReference","ToneMappingNode","toneMapping","exposureNode","toneMappingExposure","toneMappingFn","exposure","BufferAttributeNode","bufferType","bufferStride","bufferOffset","bufferData","bufferAttribute","nodeAttribute","dynamicBufferAttribute","instancedBufferAttribute","instancedDynamicBufferAttribute","bufferNode","ComputeNode","computeNode","workgroupSize","shaderStage","compute","CacheNode","previousCache","BypassNode","returnNode","callNode","bypass","RemapNode","inLowNode","inHighNode","outLowNode","outHighNode","doClamp","remap","remapClamp","ExpressionNode","expression","Discard","conditional","Return","RenderOutputNode","outputColorSpace","renderOutput","addNodeElement","AttributeNode","attributeName","attributeType","TextureSizeNode","textureNode","levelNode","textureProperty","level","textureSize","MaxMipLevelNode","maxMipLevel","TextureNode","uvNode","biasNode","uvSnippet","levelSnippet","biasSnippet","depthSnippet","compareSnippet","gradSnippet","compareNode","depthNode","gradNode","amountNode","gradNodeX","gradNodeY","matrixUniform","newNode","textureLoad","sampler","aTexture","cameraNear","cameraFar","cameraProjectionMatrix","cameraProjectionMatrixInverse","cameraViewMatrix","cameraWorldMatrix","cameraNormalMatrix","cameraPosition","Object3DNode","object3d","uniformNode","objectDirection","objectWorldMatrix","objectPosition","objectScale","objectViewPosition","ModelNode","modelDirection","modelWorldMatrix","modelPosition","modelScale","modelViewPosition","modelNormalMatrix","modelWorldMatrixInverse","modelViewMatrix","highPrecisionModelViewMatrix","highPrecisionModelNormalViewMatrix","isHighPrecisionModelViewMatrix","positionGeometry","positionLocal","positionPrevious","positionWorld","positionWorldDirection","positionView","positionViewDirection","FrontFacingNode","frontFacing","faceDirection","normalGeometry","normalLocal","normalFlat","normalView","transformNormalToView","normalWorld","transformedNormalView","transformedNormalWorld","transformedClearcoatNormalView","transformNormal","transformedNormal","modelNormalViewMatrix","materialRefractionRatio","reflectView","refractView","reflectVector","refractVector","CubeTextureNode","cubeUV","cubeTexture","BufferNode","bufferCount","UniformArrayElementNode","UniformArrayNode","elementLength","uniformArray","uniforms","ReferenceElementNode","ReferenceNode","reference","referenceBuffer","MaterialReferenceNode","materialReference","tangentGeometry","tangentLocal","tangentView","tangentWorld","transformedTangentView","transformedTangentWorld","getBitangent","crossNormalTangent","bitangentGeometry","bitangentLocal","bitangentView","bitangentWorld","transformedBitangentView","transformedBitangentWorld","TBNViewMatrix","parallaxDirection","parallaxUV","transformedBentNormalView","bentNormal","perturbNormal2Arb","eye_pos","surf_norm","mapN","q0","q1","st0","st1","N","q1perp","q0perp","T","B","NormalMapNode","scaleNode","normalMapType","normalMap","dHdxy_fwd","bumpScale","sampleTexture","texNode","Hll","perturbNormalArb","surf_pos","dHdxy","vSigmaX","vSigmaY","vN","R1","R2","fDet","vGrad","BumpMapNode","bumpMap","_propertyCache","MaterialNode","opacityNode","specularIntensity","specularColorNode","roughnessNode","metalnessNode","emissiveIntensityNode","emissiveNode","clearcoatNode","clearcoatRoughnessNode","sheenNode","sheenRoughnessNode","anisotropyPolar","materialAnisotropyVector","iridescenceThicknessMaximum","iridescenceThicknessMinimum","transmissionNode","thicknessNode","outputType","materialAlphaTest","materialColor","materialShininess","materialEmissive","materialOpacity","materialSpecular","materialSpecularIntensity","materialSpecularColor","materialSpecularStrength","materialReflectivity","materialRoughness","materialMetalness","materialNormal","materialClearcoat","materialClearcoatRoughness","materialClearcoatNormal","materialRotation","materialSheen","materialSheenRoughness","materialAnisotropy","materialIridescence","materialIridescenceIOR","materialIridescenceThickness","materialTransmission","materialThickness","materialIOR","materialAttenuationDistance","materialAttenuationColor","materialLineScale","materialLineDashSize","materialLineGapSize","materialLineWidth","materialLineDashOffset","materialPointWidth","materialDispersion","materialLightMap","materialAOMap","ModelViewProjectionNode","positionNode","viewMatrix","modelViewProjection","IndexNode","vertexIndex","instanceIndex","subgroupIndex","invocationSubgroupIndex","invocationLocalIndex","drawIndex","InstanceNode","instanceMatrix","instanceColor","instanceMatrixNode","instanceColorNode","bufferFn","instanceBuffers","instancePosition","instanceNormal","instance","InstancedMeshNode","instanceMesh","instancedMesh","BatchNode","batchMesh","indirectId","matricesTexture","batchingMatrix","colorsTexture","bm","batchingNormal","batch","_frameId","SkinningNode","skinnedMesh","useReference","bindMatrixNode","bindMatrixInverseNode","boneMatricesNode","skinIndexNode","skinWeightNode","boneMatX","boneMatY","boneMatZ","boneMatW","skinVertex","skinned","skinMatrix","mrt","skinPosition","skinNormal","skinning","skinningReference","LoopNode","returnsNode","stackNode","condition","internalParam","startSnippet","endSnippet","declarationSnippet","conditionalSnippet","updateSnippet","forSnippet","stackSnippet","returnsSnippet","Loop","Continue","Break","loop","_morphTextures","_morphVec4","getMorph","bufferMap","texelIndex","getEntry","hasMorphPosition","hasMorphNormals","hasMorphColors","morphTargetsCount","entry","disposeTexture","bufferTexture","morphNormals","morphColors","vertexDataCount","maxTextureSize","vertexDataStride","morphNormal","morphColor","MorphNode","morphReference","LightingNode","AONode","aoNode","LightingContextNode","lightingModel","backdropNode","backdropAlphaNode","directDiffuse","directSpecular","indirectDiffuse","indirectSpecular","reflectedLight","lightingContext","IrradianceNode","screenSizeVec","viewportVec","ScreenNode","screenCoordinate","screenSize","coord","screenUV","viewport","viewportSize","viewportCoordinate","viewportUV","viewportResolution","viewportTopLeft","viewportBottomLeft","_size$4","ViewportTextureNode","framebufferTexture","currentGenerateMipmaps","viewportTextureNode","viewportTexture","viewportMipTexture","sharedDepthbuffer","ViewportDepthTextureNode","viewportDepthTexture","ViewportDepthNode","valueNode","depthBase","viewZToPerspectiveDepth","viewZToOrthographicDepth","viewZ","perspectiveDepthToViewZ","orthographicDepthToViewZ","viewZToLogarithmicDepth","numerator","logarithmicDepthToViewZ","exponent","linearDepth","viewportLinearDepth","BuiltinNode","builtin","ClippingNode","clippingContext","intersectionPlanes","unionPlanes","distanceToPlane","distanceGradient","clipOpacity","numUnionPlanes","clippingPlanes","numIntersectionPlanes","intersectionClipOpacity","clipped","hw_clip_distances","clipping","clippingAlpha","hardwareClipping","ALPHA_HASH_SCALE","hash2D","hash3D","getAlphaHashThreshold","maxDeriv","pixScale","pixScales","lerpFactor","cases","NodeMaterial","_value","resultNode","clippingNode","outgoingLightNode","basicOutput","materialMRT","fragmentNode","samples","candidateCount","displacementMap","displacementScale","displacementBias","mvp","alphaTestNode","materialLightsNode","envNode","lightMapNode","lightsN","lightsNode","fogNode","descriptors","_defaultValues$d","LineBasicNodeMaterial","_defaultValues$c","LineDashedNodeMaterial","offsetNode","dashScaleNode","dashSizeNode","gapSizeNode","vLineDistance","_sharedFramebuffer","ViewportSharedTextureNode","viewportSharedTexture","directionToColor","colorToDirection","_defaultValues$a","MeshNormalNodeMaterial","EquirectUVNode","dirNode","equirectUV","CubeRenderTarget","texture$1","currentMRT","_cache$1","CubeMapNode","defaultTexture","cubeMap","mapTextureMapping","isEquirectangularMapReady$1","onTextureDispose","cubeMapNode","BasicEnvironmentNode","BasicLightMapNode","RECIPROCAL_PI","LightingModel","BasicLightingModel","ambientOcclusion","irradianceLightMap","outgoingLight","_defaultValues$9","MeshBasicNodeMaterial","F_Schlick","f0","f90","dotVH","fresnel","BRDF_Lambert","G_BlinnPhong_Implicit","D_BlinnPhong","dotNH","BRDF_BlinnPhong","lightDirection","halfDir","F","G","D","PhongLightingModel","specular","lightColor","irradiance","_defaultValues$8","MeshLambertNodeMaterial","_defaultValues$7","MeshPhongNodeMaterial","shininessNode","specularNode","getGeometryRoughness","dxy","getRoughness","geometryRoughness","roughnessFactor","V_GGX_SmithCorrelated","dotNL","dotNV","gv","gl","V_GGX_SmithCorrelated_Anisotropic","alphaB","dotTV","dotBV","dotTL","dotBL","D_GGX","D_GGX_Anisotropic","dotTH","dotBH","w2","BRDF_GGX","USE_IRIDESCENCE","USE_ANISOTROPY","V","DFGApprox","c0","a004","EnvironmentBRDF","fab","Schlick_to_F0","x5","D_Charlie","invAlpha","sin2h","V_Neubelt","BRDF_Sheen","LTC_Uv","LUT_BIAS","LTC_ClippedSphereFormFactor","LTC_EdgeVectorFormFactor","theta_sintheta","LTC_Evaluate","P","mInv","lightNormal","T1","T2","mat","coords0","coords1","coords2","coords3","vectorFormFactor","bC","w3","g0","g1","h0","bicubic","texelSize","lod","uvScaled","iuv","fuv","g0x","g1x","h0x","h1x","h0y","h1y","textureBicubic","lodNode","fLodSize","cLodSize","fLodSizeInv","cLodSizeInv","fSample","cSample","getVolumeTransmissionRay","modelMatrix","refractionVector","applyIorToRoughness","viewportBackSideTexture","viewportFrontSideTexture","getTransmissionSample","fragCoord","transmissionSample","volumeAttenuation","transmissionDistance","attenuationCoefficient","getIBLVolumeRefraction","projMatrix","transmittedLight","transmittance","halfSpread","iors","transmissionRay","refractedRayExit","ndcPos","refractionCoords","attenuatedColor","transmittanceFactor","XYZ_TO_REC709","Fresnel0ToIor","fresnel0","sqrtF0","IorToFresnel0","transmittedIor","incidentIor","evalSensitivity","OPD","shift","phase","pos","VAR","xyz","evalIridescence","outsideIOR","eta2","cosTheta1","thinFilmThickness","baseF0","cosTheta2Sq","cosTheta2","R0","R12","T121","phi12","phi21","baseIOR","R23","phi23","R123","r123","Rs","Cm","Sm","IBLSheenBRDF","viewDir","clearcoatF0","clearcoatF90","PhysicalLightingModel","dotNVi","singleScatter","multiScatter","FssEss","Ems","Favg","Fms","ccIrradiance","lightPosition","halfWidth","halfHeight","ltc_1","ltc_2","t2","radiance","iblIrradiance","dotNVcc","clearcoatEnv","singleScattering","multiScattering","cosineWeightedIrradiance","totalScattering","diffuse","aoNV","aoExp","Fcc","clearcoatLight","sheenEnergyComp","sheenLight","cubeUV_r0","cubeUV_m0","cubeUV_r1","cubeUV_m1","cubeUV_r4","cubeUV_m4","cubeUV_r5","cubeUV_m5","cubeUV_r6","cubeUV_m6","cubeUV_minMipLevel","cubeUV_minTileSize","getFace","absDirection","getUV","roughnessToMip","mip","getDirection","uv_immutable","textureCubeUV","envMap","sampleDir_immutable","roughness_immutable","CUBEUV_TEXEL_WIDTH","CUBEUV_TEXEL_HEIGHT","CUBEUV_MAX_MIP","sampleDir","mipF","mipInt","color0","bilinearCubeUV","direction_immutable","mipInt_immutable","filterInt","faceSize","getSample","outputDirection","cosTheta","sampleDirection","blur","latitudinal","poleAxis","weights","dTheta","gl_FragColor","_generator","_generateCubeUVSize","imageHeight","maxMip","texelHeight","_getPMREMFromTexture","cacheTexture","isCubeMapReady","isEquirectangularMapReady","PMREMNode","cubeUVSize","pmrem","pmremVersion","pmremTexture","_envNodeCache","EnvironmentNode","cacheEnvNode","radianceNormalView","createRadianceContext","createIrradianceContext","isolateRadiance","isolateIrradiance","clearcoatRadiance","clearcoatRadianceContext","isolateClearcoatRadiance","normalViewNode","reflectVec","normalWorldNode","_defaultValues$6","MeshStandardNodeMaterial","_defaultValues$5","MeshPhysicalNodeMaterial","iorNode","iridescenceNode","iridescenceIORNode","iridescenceThicknessNode","anisotropyV","attenuationDistanceNode","attenuationColorNode","dispersionNode","getGradientIrradiance","gradientMap","fw","ToonLightingModel","_defaultValues$4","MeshToonNodeMaterial","MatcapUVNode","matcapUV","_defaultValues$3","MeshMatcapNodeMaterial","matcapColor","_defaultValues$2","PointsNodeMaterial","RotateNode","rotationNode","cosAngle","sinAngle","rotationXMatrix","rotationYMatrix","rotationZMatrix","rotate","_defaultValues$1","SpriteNodeMaterial","sizeAttenuation","mvPosition","orthoScale","alignedPosition","rotatedPosition","ShadowMaskModel","shadowMask","_defaultValues","ShadowNodeMaterial","ret","Texture3DNode","texture3D","Animation","info","ChainMap","map","_id$7","getKeys","proto","descriptor","RenderObject","renderContext","nodeAttributes","vertexBuffers","drawParams","hasIndex","instanceCount","rangeFactor","firstVertex","lastVertex","itemCount","cacheKey","valueKey","chainArray","RenderObjects","pipelines","passId","chainMap","DataMap","AttributeType","GPU_CHUNK_BYTES","BlendColorFactor","OneMinusBlendColorFactor","Attributes","backend","attributeData","getWireframeVersion","getWireframeIndex","geometryIndex","geometryPosition","Geometries","geometryData","onDispose","geometryAttributes","geometryAttribute","wireframeAttribute","callId","wireframes","Info","previousRenderFrameCalls","previousComputeFrameCalls","Pipeline","RenderPipeline","vertexProgram","fragmentProgram","ComputePipeline","computeProgram","_id$6","ProgrammableStage","code","transforms","Pipelines","previousPipeline","nodeBuilderState","stageCompute","pipeline","promises","stageVertex","stageFragment","program","stage","Bindings","bindGroup","groupData","needsBindingsUpdate","cacheBindings","cacheIndex","version","texturesTextureData","updated","textureData","painterSortStable","reversePainterSortStable","needsDoublePass","RenderList","lighting","groupOrder","renderItem","customOpaqueSort","customTransparentSort","RenderLists","lists","list","id$1","RenderContext","getCacheKey","activeCubeFace","RenderContexts","chainKey","attachmentState","renderState","_size$3","Textures","renderTargetData","sampleCount","depthTextureMips","mipWidth","mipHeight","depthTexture","useDepthTexture","textureNeedsUpdate","isRenderTarget","mipLevelCount","Color4","ParameterNode","parameter","StackNode","boolNode","methodNode","previousStack","StructTypeNode","OutputStructNode","members","structPrefix","outputStruct","getTextureIndex","MRTNode","outputNodes","mrtNode","outputs","word","parabola","gain","pcurve","sinc","tri","tri3","triNoise3D","p_immutable","spd","rz","bp","dg","FunctionOverloadingNode","functionNodes","parametersNodes","candidateFnCall","candidateFn","candidateScore","score","overloadingBaseFn","overloadingFn","deltaTime","frameId","timerLocal","timerGlobal","timerDelta","oscSine","oscSquare","oscTriangle","oscSawtooth","rotateUV","spherizeUV","strength","delta2","deltaOffset","billboarding","horizontal","vertical","worldMatrix","viewportSafeUV","SpriteSheetUVNode","countNode","frameNode","frameNum","column","row","uvFrameOffset","spritesheetUV","TriplanarTexturesNode","textureXNode","textureYNode","textureZNode","normalNode","textureX","textureY","textureZ","cz","triplanarTextures","triplanarTexture","_reflectorPlane","_normal","_reflectorWorldPosition","_cameraWorldPosition","_rotationMatrix","_lookAtPosition","clipPlane","_view","_q","_size$2","_defaultRT","_defaultUV","_inReflector","ReflectorNode","ReflectorBaseNode","resolution","bounces","virtualCamera","projectionMatrix","clipBias","reflector","_camera","QuadGeometry","flipY","_geometry","QuadMesh","_size$1","RTTNode","effectiveWidth","effectiveHeight","pixelRatio","rtt","convertToTexture","getViewPosition","screenPosition","projectionMatrixInverse","clipSpacePosition","viewSpacePosition","getScreenPosition","viewPosition","sampleClipPos","sampleUv","getNormalFromDepth","l2","l1","dl","dr","db","dpdx","dpdy","StorageInstancedBufferAttribute","typeClass","StorageBufferAttribute","StorageArrayElementNode","storageBufferNode","isAssignContext","storageElement","StorageBufferNode","storage","storageObject","instancedArray","VertexColorNode","vertexColor","PointUVNode","pointUV","_e1","SceneNode","background","backgroundBlurriness","backgroundIntensity","backgroundRotation","StorageTextureNode","storeNode","storeSnippet","storageTexture","textureStore","UserDataNode","userData","_objectData","VelocityNode","previousModelMatrix","getPreviousMatrix","cameraData","getData","previousModelViewMatrix","clipPositionCurrent","clipPositionPrevious","ndcPositionCurrent","ndcPositionPrevious","objectData","velocity","blendBurn","base","blend","blendDodge","blendScreen","blendOverlay","blendColor","outAlpha","burn","dodge","screen","overlay","grayscale","luminance","adjustment","vibrance","average","mx","amt","luminanceCoefficients","cdl","slope","luma","pv","PosterizeNode","stepsNode","posterize","_size","PassTextureNode","passNode","PassMultipleTextureNode","textureName","previousTexture","PassNode","prevTexture","viewZNode","linearDepthNode","pass","passTexture","depthPass","ToonOutlinePassNode","alphaNode","currentRenderObjectFunction","outlineMaterial","outlineNormal","ratio","pos2","norm","originalMaterial","toonOutlinePass","linearToneMapping","reinhardToneMapping","cineonToneMapping","RRTAndODTFit","acesFilmicToneMapping","ACESInputMat","ACESOutputMat","LINEAR_REC2020_TO_LINEAR_SRGB","LINEAR_SRGB_TO_LINEAR_REC2020","agxDefaultContrastApprox","x_immutable","x4","agxToneMapping","colortone","AgXInsetMatrix","AgXOutsetMatrix","AgxMinEv","AgxMaxEv","neutralToneMapping","StartCompression","Desaturation","peak","newPeak","CodeNode","includes","language","include","nodeCode","js","wgsl","glsl","FunctionNode","nodeFunction","nativeFn","glslFn","wgslFn","ScriptableValueNode","scriptableValue","Resources","Parameters","scriptableNode","ScriptableNodeResources","ScriptableNode","codeNode","refresh","setOutput","THREE","TSL","parametersProps","declarations","returns","scriptable","FogNode","factorNode","getViewZ","fog","FogRangeNode","nearNode","farNode","rangeFog","FogExp2Node","densityNode","density","densityFog","RangeNode","minNode","maxNode","minLength","maxLength","minValue","maxValue","minElementValue","maxElementValue","ComputeBuiltinNode","builtinName","computeBuiltin","numWorkgroups","workgroupId","localId","subgroupSize","BarrierNode","barrier","workgroupBarrier","storageBarrier","textureBarrier","WorkgroupInfoElementNode","workgroupInfoNode","WorkgroupInfoNode","workgroupArray","AtomicFunctionNode","pointerNode","methodSnippet","varSnippet","atomicNode","atomicFunc","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","uniformsLib","getLightData","lightShadowMatrix","lightProjectionUV","spotLightCoord","_","lightTargetPosition","lightViewPosition","lightTargetDirection","sortLights","lights","getLightNodeById","lightNodes","lightNode","_lightsNodeRef","LightsNode","previousLightNodes","nodeLibrary","lightNodeClass","_lightNodes","totalDiffuseNode","totalSpecularNode","backdrop","backdropAlpha","totalDiffuse","shadowMaterialLib","shadowWorldPosition","linearDistance","dist","linearShadowDistance","nearDistance","farDistance","referencePosition","getShadowMaterial","BasicShadowFilter","shadowCoord","PCFShadowFilter","shadow","depthCompare","compare","mapSize","dx0","dy0","dx1","dy1","dx2","dy2","dx3","dy3","PCFSoftShadowFilter","VSMShadowFilter","occlusion","distribution","hardShadow","variance","softnessProbability","VSMPassVertical","shadowPass","mean","squaredMean","uvStride","uvStart","uvOffset","std_dev","VSMPassHorizontal","_shadowFilterLib","_quadMesh$1","ShadowNode","filterFn","frustumTest","shadowNode","shadowPosition","bias","coordZ","cameraNearLocal","cameraFarLocal","shadowMapType","shadowMap","shadowPassVertical","shadowPassHorizontal","shadowIntensity","normalBias","shadowDepthTexture","shadowColor","shadowOutput","shadowType","depthVersion","currentOverrideMaterial","AnalyticLightNode","shadowColorNode","customShadowNode","getDistanceAttenuation","lightDistance","cutoffDistance","decayExponent","distanceFalloff","_clearColor$2","cubeToUV","texelSizeY","absV","scaleToCube","planar","almostOne","signX","signY","BasicPointShadowFilter","bd3D","dp","PointShadowFilter","pointShadowFilter","lightToPosition","lightToPositionLength","_viewport","_viewportSize","_shadowMapSize","PointShadowNode","shadowTexture","shadowFrameExtents","previousAutoClear","previousClearColor","previousClearAlpha","viewportCount","vp","pointShadow","directPointLight","lVector","lightAttenuation","PointLightNode","checker","mx_select","b_immutable","t_immutable","f_immutable","mx_negate_if","val_immutable","mx_floor","mx_floorfrac","mx_bilerp_0","v0_immutable","v1_immutable","v2_immutable","v3_immutable","s_immutable","mx_bilerp_1","mx_bilerp","mx_trilerp_0","v4_immutable","v5_immutable","v6_immutable","v7_immutable","r_immutable","v7","v6","v5","v4","mx_trilerp_1","mx_trilerp","mx_gradient_float_0","hash_immutable","y_immutable","mx_gradient_float_1","z_immutable","mx_gradient_float","mx_gradient_vec3_0","mx_gradient_vec3_1","mx_gradient_vec3","mx_gradient_scale2d_0","v_immutable","mx_gradient_scale3d_0","mx_gradient_scale2d_1","mx_gradient_scale2d","mx_gradient_scale3d_1","mx_gradient_scale3d","mx_rotl32","k_immutable","mx_bjmix","mx_bjfinal","a_immutable","c_immutable","mx_bits_to_01","bits_immutable","bits","mx_fade","mx_hash_int_0","mx_hash_int_1","mx_hash_int_2","mx_hash_int_3","xx_immutable","mx_hash_int_4","yy_immutable","mx_hash_int","mx_hash_vec3_0","mx_hash_vec3_1","mx_hash_vec3","mx_perlin_noise_float_0","X","Y","fx","fy","mx_perlin_noise_float_1","Z","fz","mx_perlin_noise_float","mx_perlin_noise_vec3_0","mx_perlin_noise_vec3_1","mx_perlin_noise_vec3","mx_cell_noise_float_0","mx_cell_noise_float_1","mx_cell_noise_float_2","iz","mx_cell_noise_float_3","iw","mx_cell_noise_float$1","mx_cell_noise_vec3_0","mx_cell_noise_vec3_1","mx_cell_noise_vec3_2","mx_cell_noise_vec3_3","mx_cell_noise_vec3","mx_fractal_noise_float$1","octaves_immutable","lacunarity_immutable","diminish_immutable","diminish","lacunarity","octaves","amplitude","mx_fractal_noise_vec3$1","mx_fractal_noise_vec2$1","mx_fractal_noise_vec4$1","mx_worley_distance_0","xoff_immutable","yoff_immutable","jitter_immutable","metric_immutable","metric","jitter","yoff","xoff","off","cellpos","mx_worley_distance_1","zoff_immutable","zoff","mx_worley_distance","mx_worley_noise_float_0","localpos","sqdist","mx_worley_noise_vec2_0","mx_worley_noise_vec3_0","mx_worley_noise_float_1","mx_worley_noise_float$1","mx_worley_noise_vec2_1","mx_worley_noise_vec2$1","mx_worley_noise_vec3_1","mx_worley_noise_vec3$1","mx_hsvtorgb","hsv","hi","mx_rgbtohsv","mincomp","maxcomp","mx_srgb_texture_to_lin_rec709","color_immutable","isAbove","linSeg","powSeg","mx_aastep","afwidth","_ramp","mx_ramplr","valuel","valuer","texcoord","mx_ramptb","valuet","valueb","_split","mx_splitlr","mx_splittb","mx_transform_uv","uv_scale","uv_offset","uv_geo","mx_safepower","in1","in2","mx_contrast","amount","pivot","mx_noise_float","mx_noise_vec3","mx_noise_vec4","mx_worley_noise_float","mx_worley_noise_vec2","mx_worley_noise_vec3","mx_cell_noise_float","mx_fractal_noise_float","mx_fractal_noise_vec2","mx_fractal_noise_vec3","mx_fractal_noise_vec4","getParallaxCorrectNormal","cubeSize","cubePos","nDir","rbmax","rbmin","rbminmax","correction","getShIrradianceAt","shCoefficients","_clearColor$1","Background","renderList","forceClear","sceneData","backgroundNode","backgroundMesh","backgroundMeshNode","viewProj","nodeMaterial","backgroundCacheKey","clearColorValue","_id$5","BindGroup","bindingsReference","NodeBuilderState","vertexShader","fragmentShader","computeShader","updateNodes","updateBeforeNodes","updateAfterNodes","monitor","instanceGroup","bindingsGroup","instanceBinding","NodeAttribute","NodeUniform","NodeVar","NodeVarying","NodeCode","NodeCache","Uniform","NumberUniform","Vector2Uniform","Vector3Uniform","Vector4Uniform","ColorUniform","Matrix3Uniform","Matrix4Uniform","NumberNodeUniform","Vector2NodeUniform","Vector3NodeUniform","Vector4NodeUniform","ColorNodeUniform","Matrix3NodeUniform","Matrix4NodeUniform","LOD_MIN","EXTRA_LOD_SIGMA","MAX_SAMPLES","_flatCamera","_cubeCamera","_clearColor","_oldTarget","_oldActiveCubeFace","_oldActiveMipmapLevel","PHI","INV_PHI","_axisDirections","_faceLib","PMREMGenerator","sigma","cubeUVRenderTarget","equirectangular","cubemap","_getCubemapMaterial","_getEquirectMaterial","outputTarget","_setViewport","_createRenderTarget","_lodMax","_createPlanes","_getBlurShader","tmpMesh","cubeCamera","upSign","forwardSign","originalAutoClear","backgroundBox","backgroundMaterial","useSolidColor","col","isCubeTexture","autoClear","lodIn","lodOut","pingPongRenderTarget","targetIn","targetOut","sigmaRadians","blurMaterial","STANDARD_DEVIATIONS","blurMesh","blurUniforms","pixels","radiansPerPixel","sigmaPixels","sum","outputSize","lodMax","lodPlanes","sizeLods","sigmas","lodMeshes","totalLods","sizeLod","cubeFaces","positionSize","uvSize","faceIndexSize","faceIndex","coordinates","faceIdx","fill","_getMaterial","materialUniforms","envTexture","rendererCache","typeFromArray","toFloat","NodeBuilder","parser","bindGroupsCache","groupName","bindingsArray","sharedGroup","bindingsGroups","bindingGroup","updateBeforeType","updateAfterType","componentType","generateConst","baseType","dataAttribute","vecType","vecNum","newComponentType","lastStack","vars","nodeVarying","varyings","codes","nodeBlock","flowCodes","flowCodeBlock","needsFlowCode","nodeBlockHierarchy","flowCode","codeBlock","flowData","previous","previousFlow","previousVars","previousBuildStage","flow","previousShaderStage","variable","flowNodes","fromType","toType","fromTypeLength","toTypeLength","NodeFrame","referenceMap","nodeRef","maps","frameMap","renderMap","NodeFunctionInput","qualifier","isConst","DirectionalLightNode","_matrix41","_matrix42","ltcLib","RectAreaLightNode","ltc","SpotLightNode","angleCosine","coneCosNode","penumbraCosNode","cutoffDistanceNode","decayExponentNode","angleCos","spotAttenuation","projectedTexture","IESSpotLightNode","iesMap","AmbientLightNode","HemisphereLightNode","groundColorNode","lightDirectionNode","hemiDiffuseWeight","LightProbeNode","NodeParser","NodeFunction","declarationRegexp$1","propertiesRegexp$1","pragmaMain","parse$1","pragmaMainIndex","mainCode","declaration","inputsCode","propsMatches","nameMatch","blockCode","headerCode","GLSLNodeFunction","declarationCode","GLSLNodeParser","outputNodeMap","Nodes","nodeUniformsGroup","groupNode","uniformsGroupData","groupChain","nodeBuilderCache","nodeBuilder","computeData","chain","cacheKeyData","environmentNode","forceUpdate","environment","outputTexture","_plane","ClippingContext","parentContext","destination","clippingGroup","srcClippingPlanes","dstClippingPlanes","RenderBundle","RenderBundles","NodeLibrary","nodeMaterialClass","toneMappingNode","materialType","materialNodeClass","materialClassType","lightClass","nodeClass","baseClass","_defaultLights","Lighting","_scene","_drawingBufferSize","_screen","_frustum","_vector4","Renderer","logarithmicDepthBuffer","antialias","getFallback","alphaClear","error","targetScene","previousRenderId","previousRenderContext","previousRenderObjectFunction","previousCompilationPromises","sceneRef","compilationPromises","opaqueObjects","transparentObjects","transparentDoublePassObjects","errorMessage","bundle","bundleGroup","renderBundle","renderBundleData","needsUpdate","renderBundleNeedsUpdate","renderObjects","currentToneMapping","currentColorSpace","frameBufferTarget","useFrameBufferTarget","outputRenderTarget","scissor","minDepth","maxDepth","bundles","quad","updateStyle","boolean","renderObjectFunction","computeNodes","computeList","dispose","onInitFn","computeBindings","computePipeline","rectangle","srcTexture","dstTexture","srcRegion","dstPosition","baseRenderList","doublePassList","camera2","viewportValue","overridePositionNode","overrideColorNode","overrideDepthNode","overrideMaterial","needsRefresh","Binding","visibility","getFloatLength","floatLength","Buffer","UniformBuffer","_id$4","NodeUniformBuffer","UniformsGroup","byteLength","boundary","chunkOffset","remainingSizeInChunk","arraysEqual","setArray","_id$3","NodeUniformsGroup","_id$2","SampledTexture","generation","NodeSampledTexture","access","NodeSampledCubeTexture","NodeSampledTexture3D","glslMethods","precisionLib","supports$1","defaultPrecisions","GLSLNodeBuilder","originalArray","numElements","isInteger","typeMap","newSize","newArray","pboTexture","pbo","storageArrayElementNode","elementNodeData","bufferNodeData","propertySizeName","prefix","uvIndexSnippet","snippets","bindingSnippets","uniformGroups","typePrefix","bufferCountSnippet","groupSnippets","location","struct","member","structs","flat","acc","curr","behavior","ext","extensionName","planeCount","varyingName","attributeNode","shaderData","shadersData","mainNode","flowSlotData","slotName","stageData","uniformGPU","uniformsStage","uniformsGroup","vector2","vector4","color4","Backend","DualAttributeData","dualBuffer","WebGLAttributeUtils","usage","bufferGPU","bufferGPUDual","updateRanges","writeBuffer","dstBuffer","initialized$1","equationToGL","factorToGL","WebGLState","enabled","flipSided","cullFace","currentLineWidth","blending","blendEquation","blendSrc","blendDst","blendEquationAlpha","blendSrcAlpha","blendDstAlpha","premultipliedAlpha","colorMask","depthTest","depthMask","depthFunc","stencilTest","stencilMask","stencilFunc","stencilRef","stencilFail","stencilZFail","stencilZPass","frontFaceCW","hardwareClippingPlanes","stencilWrite","polygonOffset","units","framebuffer","currentBoundFramebuffers","drawBuffers","webglSlot","currentTextureSlot","maxTextures","webglType","webglTexture","currentBoundTextures","boundTexture","WebGLUtils","extension","sync","test","initialized","wrappingToGL","filterToGL","compareToGL","WebGLTextureUtils","glTextureType","internalFormatName","glFormat","glType","forceLinearTransfer","internalFormat","textureType","hasMipmaps","defaultTextures","textureGPU","levels","glInternalFormat","getImage","mipmaps","mipmap","renderContextData","dstTextureGPU","minX","minY","dstX","dstY","currentUnpackRowLen","currentUnpackImageHeight","currentUnpackSkipPixels","currentUnpackSkipRows","currentUnpackSkipImages","srcTextureData","dstTextureData","srcRenderContextData","dstRenderContextData","srcFramebuffer","dstFramebuffer","mask","requireDrawFrameBuffer","srcHeight","partial","attachment","renderTargetContextData","fb","msaaFrameBuffer","flippedY","renderbuffer","depthBuffer","stencilBuffer","typedArrayType","bytesPerTexel","bytesPerComponent","WebGLExtensions","WebGLCapabilities","GLFeatureName","WebGLBufferRenderer","mode","primcount","starts","counts","drawCount","elementCount","WebGLBackend","glContext","onContextLost","contextLossInfo","nextRenderContext","queryInfo","available","disjoint","elapsed","occlusionQueryCount","viewY","currentOcclusionQueries","currentOcclusionQueryObjects","occluded","check","completed","query","setFrameBuffer","clearColor","clear","computeGroup","programGPU","transformBuffers","vaoKey","vaoGPU","transformFeedbackGPU","dualAttributeData","contextData","staticVao","lastObject","vertexCount","indexData","parallel","checkStatus","errorLine","lines","lines2","status","errors","errorMatches","glFragmentShader","glVertexShader","programLog","vertexErrors","fragmentErrors","pipelineData","transformVaryingNames","transformAttributeNodes","attributeNodes","uniformBuffers","bindGroupData","keysMatching","currentFrameBuffer","isCube","msaaFb","depthRenderbuffer","cubeFace","depthStyle","invalidationArray","msaaRenderbuffers","bindingData","GPUPrimitiveTopology","GPUCompareFunction","GPUStoreOp","GPULoadOp","GPUFrontFace","GPUCullMode","GPUIndexFormat","GPUTextureFormat","GPUAddressMode","GPUFilterMode","GPUBlendFactor","GPUBlendOperation","GPUColorWriteFlags","GPUStencilOperation","GPUBufferBindingType","GPUStorageTextureAccess","GPUTextureSampleType","GPUTextureDimension","GPUTextureViewDimension","GPUTextureAspect","GPUInputStepMode","GPUFeatureName","Sampler","NodeSampler","StorageBuffer","_id","NodeStorageBuffer","WebGPUTexturePassUtils","device","mipmapVertexSource","mipmapFragmentSource","flipYFragmentSource","textureGPUDescriptor","baseArrayLayer","transferPipeline","flipYPipeline","tempTexture","srcView","dstView","commandEncoder","sourceView","destinationView","bindGroupLayout","passEncoder","passes","passDescriptor","_compareToWebGPU","_flipMap","WebGPUTextureUtils","samplerDescriptorGPU","getFormat","dimension","primarySampleCount","textureDescriptorGPU","video","videoFrame","msaaTextureDescriptorGPU","depthTextureGPU","bytesPerRow","readBuffer","encoder","defaultCubeTexture","defaultVideoFrame","init","flipIndex","originDepth","passUtils","blockData","isTextureArray","bytesPerImage","addressMode","filterMode","formatGPU","declarationRegexp","propertiesRegexp","wgslTypeLib$1","parse","match","resolvedType","WGSLNodeFunction","WGSLNodeParser","GPUShaderStage","accessNames","wrapNames","gpuShaderStageLib","supports","wgslFnOpLib","wgslTypeLib","wgslCodeCache","wgslPolyfill","wgslMethods","diagnostics","WGSLNodeBuilder","functionName","addWrapSnippet","wrap","textureDimensionNode","textureDimensionsParams","wrapFunction","textureDimension","coordSnippet","valueSnippet","fnOp","bufferClass","directives","directive","builtins","attributesSnippet","bufferSnippets","structSnippets","uniformIndexes","multisampled","componentPrefix","bufferTypeSnippet","bufferSnippet","bufferAccessMode","vectorType","isOutputStruct","structSnippet","wgslMethod","structName","WebGPUUtils","typedArraysToVertexFormatPrefix","typedAttributeToVertexFormatPrefix","typeArraysToVertexFormatPrefixForItemSize1","WebGPUAttributeUtils","tempArray","byteOffsetFactor","dataOffset","slot","bytesPerElement","vertexBufferLayout","arrayStride","stepMode","readBufferGPU","cmdEncoder","gpuCommands","ArrayType","bytesPerUnit","paddedItemSize","WebGPUBindingUtils","entries","bindingGPU","bindGroupLayoutCache","bindingsData","bindLayoutGPU","bindGroupGPU","layoutGPU","bindingPoint","entriesGPU","resourceGPU","aspectGPU","dimensionViewGPU","WebGPUPipelineUtils","renderObjectContext","utils","bindGroupLayouts","stencilFront","colorWriteMask","targets","colorFormat","vertexModule","fragmentModule","primitiveState","depthStencilFormat","pipelineDescriptor","depthStencil","renderDepth","renderStencil","pipelineGPU","setBlend","srcRGB","dstRGB","srcAlpha","dstAlpha","blendFactor","stencilCompare","stencilOperation","blendOperation","WebGPUBackend","adapterOptions","adapter","features","supportedFeatures","deviceDescriptor","deviceLossInfo","alphaMode","colorAttachment","colorAttachments","textureView","resolveTarget","depthStencilAttachment","occlusionQuerySet","currentPass","bufferSize","queryResolveBuffer","currentOcclusionQueryBuffer","clearValue","supportsDepth","supportsStencil","groupGPU","passEncoderGPU","maxComputeWorkgroupsPerDimension","computeNodeData","dispatchSize","currentSets","currentBindingGroups","indexFormat","vertexBuffer","drawInstances","firstInstance","indexCount","firstIndex","primitiveTopology","timeStampQuerySet","resolveBuffer","bundleGPU","dstLayer","srcX","srcY","srcLayer","srcWidth","sourceGPU","destinationGPU","IESSpotLight","StandardNodeLibrary","WebGPURenderer","BackendClass","_material","_quadMesh","PostProcessing","saveRendererState","resetRendererState","restoreRendererState","saveRendererAndSceneState","resetRendererAndSceneState","restoreRendererAndSceneState","PostProcessingUtils","toTrianglesDrawMode","drawMode","numberOfTriangles","newIndices","newGeometry","GLTFLoader","GLTFMaterialsClearcoatExtension","GLTFMaterialsDispersionExtension","GLTFTextureBasisUExtension","GLTFTextureWebPExtension","GLTFTextureAVIFExtension","GLTFMaterialsSheenExtension","GLTFMaterialsTransmissionExtension","GLTFMaterialsVolumeExtension","GLTFMaterialsIorExtension","GLTFMaterialsEmissiveStrengthExtension","GLTFMaterialsSpecularExtension","GLTFMaterialsIridescenceExtension","GLTFMaterialsAnisotropyExtension","GLTFMaterialsBumpExtension","GLTFLightsExtension","GLTFMeshoptCompression","GLTFMeshGpuInstancing","relativeUrl","_onError","gltf","dracoLoader","ktx2Loader","meshoptDecoder","plugins","textDecoder","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","GLTFBinaryExtension","GLTFParser","plugin","extensionsRequired","GLTFMaterialsUnlitExtension","GLTFDracoMeshCompressionExtension","GLTFTextureTransformExtension","GLTFMeshQuantizationExtension","GLTFRegistry","nodeDefs","nodeIndex","nodeLength","nodeDef","lightIndex","dependency","lightDef","assignExtrasToUserData","materialParams","materialDef","pending","metallicRoughness","emissiveStrength","colorFactor","colorArray","textureIndex","textureDef","handler","isSupported","bufferView","extensionDef","byteOffset","meshDef","primitive","WEBGL_CONSTANTS","attributesDef","accessor","meshes","instancedMeshes","BINARY_EXTENSION_HEADER_LENGTH","BINARY_EXTENSION_CHUNK_TYPES","headerView","chunkContentsLength","chunkView","chunkIndex","chunkLength","chunkType","contentArray","bufferViewIndex","gltfAttributeMap","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","threeAttributeName","ATTRIBUTES","accessorDef","WEBGL_COMPONENT_TYPES","GLTFCubicSplineInterpolant","stride2","stride3","td","m0","m1","GLTFCubicSplineQuaternionInterpolant","WEBGL_FILTERS","WEBGL_WRAPPINGS","WEBGL_TYPE_SIZES","PATH_PROPERTIES","INTERPOLATION","ALPHA_MODES","createDefaultMaterial","addUnknownExtensionsToUserData","knownExtensions","objectDef","gltfDef","addMorphTargets","hasMorphNormal","hasMorphColor","pendingPositionAccessors","pendingNormalAccessors","pendingColorAccessors","pendingAccessor","accessors","morphPositions","updateMorphTargets","targetNames","createPrimitiveKey","primitiveDef","geometryKey","dracoExtension","createAttributesKey","attributesKey","getNormalizedComponentScale","constructor","getImageURIMimeType","uri","isSafari","safariVersion","isFirefox","firefoxVersion","userAgent","safariMatch","dependencies","skinDefs","meshDefs","skinIndex","skinLength","joints","ref","updateMappings","original","clone","mappings","defs","def","bufferIndex","bufferDef","bufferViewDef","accessorIndex","TypedArray","pendingBufferViews","bufferViews","elementBytes","itemBytes","byteStride","ibSlice","ibCacheKey","itemSizeIndices","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","sourceIndex","sourceDef","URL","sourceURI","isObjectURL","mapName","mapDef","gltfReference","useDerivativeTangents","useVertexColors","useFlatShading","pointsMaterial","lineMaterial","cachedMaterial","materialExtensions","kmuExtension","emissiveFactor","originalName","sanitizedName","primitives","createDracoPrimitive","addPrimitiveAttributes","geometryPromise","meshIndex","cameraIndex","cameraDef","skinDef","inverseBindMatrices","jointNodes","jointNode","animationIndex","animationDef","animationName","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","inputAccessors","outputAccessors","samplers","inputAccessor","outputAccessor","createdTracks","nodePending","childPending","childrenDef","skeletonPending","meshPromise","sceneIndex","sceneDef","nodeIds","reduceAssociations","reducedAssociations","targetName","outputArray","scaled","interpolantType","computeBounds","boxScale","maxDisplacement","assignAttributeAccessor","gltfAttributeName","_taskCache","DRACOLoader","config","workerLimit","attributeIDs","attributeTypes","vertexColorSpace","taskConfig","taskKey","cachedTask","worker","taskID","taskCost","geometryPending","_worker","inputColorSpace","useJS","librariesPending","libraries","jsContent","DRACOWorker","body","decoderConfig","decoderPending","draco","module","decodeGeometry","buffers","dracoGeometry","decodingStatus","geometryType","attributeID","attributeResult","decodeAttribute","decodeIndex","numIndices","ptr","numComponents","numValues","dataType","getDracoDataType","assetsRegistry","progressBar","indicator","container","frameRequested","updateLoadIndicator","textContent","msg","assetType","evt","initLoadIndicator","addAsset","assetLoaded","gltfLoader","loadMesh","_BlurDirectionX","_BlurDirectionY","_rendererState","BloomNode","renderTargetHorizontal","renderTargetVertical","resx","resy","inputRenderTarget","luminosityHighPass","texel","kernelSizeArray","bloomFactors","bloomTintColors","lerpBloomFactor","mirrorFactor","compositePass","color3","kernelRadius","colorTexture","gaussianCoefficients","invSize","sampleTexel","seperableBlurPass","weightSum","diffuseSum","sample1","sample2","seperableBlurMaterial","bloom","_changeEvent","_startEvent","_endEvent","_TILT_LIMIT","_v","_twoPI","_STATE","_EPS","OrbitControls","onPointerMove","onPointerDown","onPointerUp","onContextMenu","onMouseWheel","onKeyDown","onTouchStart","onTouchMove","onMouseDown","onMouseMove","interceptControlDown","interceptControlUp","zoomChanged","prevRadius","newRadius","radiusDelta","mouseBefore","prevZoom","mouseAfter","normalizedDelta","objectMatrix","deltaX","deltaY","targetDistance","dollyScale","rect","centerX","centerY","pointerId","newEvent","mouseAction","isEmpty","isObject$1","isRecord","deepEqualsArray","deepMerge","isBinding","CREATE_MESSAGE_MAP","TpError$1","TpError","bundleId","_a","BindingTarget$1","BindingTarget","valueObj","Emitter$1","eventName","opt_options","observers","observer","ComplexValue$1","initialValue","Emitter","rawValue","opts","constrainedValue","prevValue","PrimitiveValue$1","ReadonlyPrimitiveValue$1","ev","createValue","constraint","PrimitiveValue","ComplexValue","createReadonlyValue","ReadonlyPrimitiveValue","ValueMap$1","ValueMap","valueMap","core","DefiniteRangeConstraint$1","RangeConstraint$1","StepConstraint$1","NumberLiteralNode$1","BINARY_OPERATION_MAP","BinaryOperationNode$1","operator","UNARY_OPERATION_MAP","UnaryOperationNode$1","expr","combineReader","parsers","cursor","readWhitespace","readNonZeroDigit","readDecimalDigits","readSignedInteger","ds","sds","readExponentPart","si","readDecimalIntegerLiteral","nzd","readDecimalLiteral1","dil","dds","readDecimalLiteral2","readDecimalLiteral3","readDecimalLiteral","parseBinaryDigits","readBinaryIntegerLiteral","bds","readOctalDigits","readOctalIntegerLiteral","ods","readHexDigits","readHexIntegerLiteral","hds","readNonDecimalIntegerLiteral","readNumericLiteral","parseLiteral","num","NumberLiteralNode","parseParenthesizedExpression","parseExpression","cl","parsePrimaryExpression","parseUnaryExpression","UnaryOperationNode","readBinaryOperator","ops","createBinaryOperationExpressionParser","exprParser","firstExpr","nextExpr","BinaryOperationNode","parseBinaryOperationExpression","parseEcmaNumberExpression","parseNumber","numberFromUnknown","numberToString","createNumberFormatter","digits","mapRange","start1","end1","start2","end2","getDecimalDigits","constrainRange","loopRange","getSuitableDecimalDigits","getSuitableKeyScale","getSuitablePointerScale","createStepConstraint","StepConstraint","createRangeConstraint","DefiniteRangeConstraint","RangeConstraint","createNumberTextPropsObject","_b","_c","createNumberTextInputParamsParser","createPointAxis","BladeApi$1","disabled","hidden","TpEvent$1","TpEvent","last","expanded","TpMouseEvent","nativeEvent","BladeApi","tag","bh","TpChangeEvent","InputBindingValue","isInputBindingValue","parseObject","keyToParserMap","parseArray","parseItem","item","isObject","createMicroParserBuilder","optional","createMicroParserBuilders","itemParser","MicroParsers","parseRecord","importBladeState","superImport","exportBladeState","superExport","thisState","isValueBladeController","isBindingValue","SVG_NS","forceReflow","disableTransitionTemporarily","supportsTouch","doc","getGlobalObject","getWindowDocument","getCanvasContext","canvasElement","win","ICON_ID_TO_INNER_HTML_MAP","createSvgIconElement","document","iconId","elem","insertElementAt","parentElement","removeElement","removeChildElements","removeChildNodes","findNextTarget","bindValue","applyValue","bindValueMap","PREFIX","ClassName","viewName","opt_elementName","opt_modifier","cn$r","createLabelNode","frag","lineNode","LabelView$1","labelElem","valueElem","LabelController$1","LabelView","getAllBladePositions","cn$q","POS_TO_CLASS_NAME_MAP","BladeController$1","BladeController","viewProps","lc","LabelController","excludeValue","BindingController","LabeledValueBladeController","_s","isBindingController","InputBindingController","isInputBindingController","fillBuffer","initializeBuffer","createTrimmedBuffer","createPushedBuffer","newBuffer","MonitorBindingValue","isMonitorBindingValue","MonitorBindingController","isMonitorBindingController","title","applyClass","className","active","valueToClassName","bindValueToTextContent","cn$p","ButtonView$1","buttonElem","titleElem","ButtonController$1","ButtonView","ButtonController","Semver$1","prerelease","coreComps","VERSION$1","Semver","createPlugin","ButtonBladePlugin","args","ButtonBladeController","ButtonApi","addButtonAsBlade","api","addFolderAsBlade","addTabAsBlade","isRefreshable","createBindingTarget","RackApi$1","pool","opt_params","opt_index","RackApi","isContainerBladeController","NestedOrderedSet$1","extract","subList","findValueBladeController","bcs","findSubBladeControllerSet","Rack$1","NestedOrderedSet","finder","rack","emitter","visibleItems","firstVisibleItem","lastVisibleItem","ps","_ev","RackController$1","Rack","createBlade","Foldable","coreObj","exHeight","expandedClassName","onExpand","computeExpandedFolderHeight","folder","containerElement","applyHeight","foldable","bindFoldable","ContainerBladeApi","TpFoldEvent","bladeContainerClassName","FolderView$1","indentElem","markElem","containerElem","ContainerBladeController","FolderView","RackController","FolderBladePlugin","FolderController","FolderApi","cn$o","valueToModifier","modifier","ViewProps","opt_initialValue","disposed","prevParent","cn$n","TabPageView$1","cn$m","TabItemView$1","selected","TabItemController$1","TabItemView","TabPageView","TabItemController","pc","TabPageController","papi","TpTabSelectEvent","INDEX_NOT_SELECTED","Tab$1","firstSelIndex","cn$l","TabView$1","contentsElem","tab","Tab","TabView","TabBladePlugin","TabController","TabApi","TabPageApi","createBladeController","BindingApi","ManualTicker$1","IntervalTicker$1","interval","inactive","CompositeConstraint$1","constraints","findConstraint","constraintClass","CompositeConstraint","tmpResult","sc","ListConstraint$1","parseListOptions","normalizeListOptions","items","createListConstraint","ListConstraint","cn$k","ListView$1","selectElem","optionElem","ListController$1","ListView","cn$j","PopupView$1","PopupController$1","PopupView","cn$i","TextView$1","inputElem","formatter","TextController$1","TextView","parsedValue","boolToString","boolFromUnknown","BooleanFormatter","composeParsers","innerFormatter","formatPercentage","stringFromUnknown","formatString","connectValues","primary","secondary","forward","backward","changing","preventFeedback","getStepForKey","keyScale","getVerticalStepKeys","getHorizontalStepKeys","isVerticalArrowKey","isArrowKey","computeOffset$1","PointerHandler$1","touch","cn$h","NumberTextView$1","knobElem","guideElem","bodyElem","headElem","tooltipElem","aox","adx","NumberTextController$1","NumberTextView","ph","PointerHandler","cn$g","SliderView$1","trackElem","SliderController$1","SliderView","cn$f","SliderTextView$1","sliderElem","textElem","SliderTextController$1","SliderController","NumberTextController","SliderTextView","sliderProps","createSliderTextProps","CSS_VAR_MAP","getCssVar","createPointDimensionParser","parsePointDimensionParams","createDimensionConstraint","cs","rs","isCompatible","ver","parsePickerLayout","writePrimitive","cn$e","CheckboxView$1","wrapperElem","CheckboxController$1","CheckboxView","createConstraint$6","BooleanInputPlugin","_args","ListController","CheckboxController","ListInputBindingApi","cn$d","ColorView$1","swatchElem","pickerElem","rgbToHslInt","rp","gp","cmax","cmin","hslToRgbInt","hp","sp","lp","rgbToHsvInt","hsvToRgbInt","hslToHsvInt","sd","hsvToHslInt","removeAlphaComponent","comps","appendAlphaComponent","MODE_CONVERTER_MAP","getColorMaxComponents","loopHueRange","constrainColorComponents","ms","convertColorType","fms","tms","convertColor","intComps","IntColor$1","IntColor","opt_mode","rgbComps","cn$c","ColorPickerView$1","hsvElem","svElem","hElem","rgbElem","aElem","apElem","atElem","elems","parseColorType","parseColorInputParams","getKeyScaleForColor","forAlpha","extractColorType","FloatColor$1","TYPE_TO_CONSTRUCTOR_MAP","FloatColor","createColor","isFloatColor","isIntColor","convertFloatToInt","convertIntToFloat","ci","mapColorType","equalsStringColorFormat","f1","f2","parseCssNumberOrPercentage","ANGLE_TO_DEG_MAP","parseCssNumberOrAngle","unit","parseFunctionalRgbColorComponents","parseFunctionalRgbColor","parseFunctionalRgbaColorComponents","parseFunctionalRgbaColor","parseFunctionalHslColorComponents","parseFunctionalHslColor","parseHslaColorComponents","parseFunctionalHslaColor","parseHexRgbColorComponents","mRgb","mRrggbb","parseHexRgbColor","parseHexRgbaColorComponents","parseHexRgbaColor","parseObjectRgbColorComponents","createObjectRgbColorParser","parseObjectRgbaColorComponents","createObjectRgbaColorParser","PARSER_AND_RESULT","detectStringColor","prev","detection","detectStringColorFormat","createColorStringParser","readIntColorString","zerofill","comp","colorToHexRgbString","hexes","colorToHexRgbaString","rgbaComps","colorToFunctionalRgbString","colorToFunctionalRgbaString","aFormatter","rgbFormatter","colorToFunctionalHslString","formatters","colorToFunctionalHslaString","colorToObjectRgbString","names","cc","createObjectRgbColorFormatter","colorToObjectRgbaString","createObjectRgbaColorFormatter","FORMAT_AND_STRINGIFIERS","findColorStringifier","fas","cn$b","APaletteView$1","barElem","colorElem","markerElem","previewElem","leftColor","rightColor","gradientComps","APaletteController$1","APaletteView","cn$a","createModeSelectElement","optElem","ColorTextsView$1","modeElem","modeMarkerElem","inputsElem","inputViews","compElem","createFormatter$2","createConstraint$5","createComponentController","createComponentControllers","pickedMode","createHexController","TextController","isColorMode","ColorTextsController$1","ColorTextsView","cn$9","HPaletteView$1","HPaletteController$1","HPaletteView","cn$8","CANVAS_RESOL","SvPaletteView$1","canvasElem","ctx","hsvComps","imgData","SvPaletteController$1","SvPaletteView","dv","ColorPickerController$1","HPaletteController","SvPaletteController","APaletteController","ColorTextsController","ColorPickerView","cn$7","ColorSwatchView$1","ColorSwatchController$1","ColorSwatchView","ColorController$1","ColorSwatchController","ColorView","PopupController","pickerC","ColorPickerController","nextTarget","colorToRgbNumber","colorToRgbaNumber","numberToRgbColor","numberToRgbaColor","colorFromRgbNumber","colorFromRgbaNumber","isRgbColorComponent","isRgbColorObject","isRgbaColorObject","isColorObject","equalsColor","comps1","comps2","createColorComponentsFromRgbObject","createColorStringWriter","stringify","createColorNumberWriter","supportsAlpha","colorToNumber","writeRgbaColorObject","writeRgbColorObject","createColorObjectWriter","inValue","shouldSupportAlpha$1","inputParams","createFormatter$1","isForColor","NumberColorInputPlugin","ColorController","colorFromObject","shouldSupportAlpha","createColorObjectBindingReader","createColorObjectFormatter","ObjectColorInputPlugin","StringColorInputPlugin","stringifier","writer","PointNdConstraint$1","cn$6","PointNdTextView$1","axisElem","createAxisController","PointNdTextController$1","PointNdTextView","createConstraint$4","rc","NumberInputPlugin","textPropsObj","drc","SliderTextController","SliderInputBindingApi","Point2d$1","Point2dAssembly","Point2d","cn$5","Point2dView$1","cn$4","Point2dPickerView$1","padElem","svgElem","xAxisElem","yAxisElem","lineElem","px","py","ipy","computeOffset","keyScales","invertsY","Point2dPickerController$1","Point2dPickerView","Point2dController$1","padC","Point2dPickerController","PointNdTextController","Point2dView","point2dFromUnknown","writePoint2d","createConstraint$3","PointNdConstraint","getSuitableMaxDimensionValue","getSuitableMax","xr","yr","shouldInvertY","yParams","Point2dInputPlugin","dParams","Point2dController","Point3d$1","Point3dAssembly","Point3d","point3dFromUnknown","writePoint3d","createConstraint$2","Point3dInputPlugin","Point4d$1","Point4dAssembly","Point4d","point4dFromUnknown","writePoint4d","createConstraint$1","Point4dInputPlugin","createConstraint","StringInputPlugin","Constants","cn$3","MultiLogView$1","textareaElem","shouldScroll","MultiLogController$1","MultiLogView","cn$2","SingleLogView$1","lastValue","SingleLogController$1","SingleLogView","BooleanMonitorPlugin","SingleLogController","MultiLogController","cn$1","GraphLogView$1","maxIndex","GraphLogController$1","GraphLogView","createFormatter","createTextMonitor","createGraphMonitor","GraphLogController","shouldShowGraph","NumberMonitorPlugin","GraphLogMonitorBindingApi","StringMonitorPlugin","BladeApiCache","ReadWriteBinding","createInputBindingController","valueArgs","ReadonlyBinding","createTicker","ManualTicker","IntervalTicker","createMonitorBindingController","bindingArgs","PluginPool","apiCache","ic","mc","sharedCache","createDefaultPluginPool","ListBladeApi","SeparatorBladeApi","SliderBladeApi","TextBladeApi","ListBladePlugin","RootApi","RootController","cn","SeparatorView","hrElem","SeparatorController","SeparatorBladePlugin","SliderBladePlugin","TextBladePlugin","createDefaultWrapperElement","embedStyle","css","styleElem","Pane","opt_config","rootController","parentElem","VERSION","PlainView","createConstraint$8","createConstraint$7","bounds","ButtonCellApi","TpButtonGridEvent","cell","ButtonGridApi","gc","ButtonGridController","ButtonGridBladeController","ButtonGridBladePlugin","CubicBezierApi","interpolate","MAX_ITERATION","X_DELTA","CACHE_RESOLUTION","CubicBezier","x01","y01","x12","y12","x23","y23","xr0","yr0","xr1","yr1","CubicBezierAssembly","cubicBezierToString","COMPS_EMPTY","cubicBezierFromString","className$7","CubicBezierView","iconElem","className$6","CubicBezierPickerView","graphElem","waitToBeAddedToDom","ob","className$5","compose","CubicBezierGraphView","selection","vm","bezier","vElem","TICK_COUNT","PREVIEW_DELAY","PREVIEW_DURATION","className$4","CubicBezierPreviewView","ticksElem","progress","getDistance","lockAngle","la","CubicBezierGraphController","ptHandler","locksAngle","xStep","yStep","CubicBezierPickerController","CubicBezierController","shows","CubicBezierBladePlugin","rv","FpsGraphBladeApi","MAX_TIMESTAMPS","Fpswatch","nowTime","ts","className$3","FpsView","labelElement","valueElement","unitElement","FpsGraphController","FpsGraphBladeController","fc","FpsGraphBladePlugin","_d","Interval","IntervalAssembly","IntervalConstraint","edge","_e","_f","_g","_h","className$2","RangeSliderTextView","className$1","RangeSliderView","knobElems","xs","RangeSliderController","pmin","pmax","rmin","rmax","RangeSliderTextController","intervalFromUnknown","writeInterval","IntervalInputPlugin","exValue","midValue","textProps","RadioCellApi","TpRadioGridChangeEvent","RadioGridApi","capi","RadioView","RadioController","RadioGridController","RadioGridBladePlugin","createRadioGridInputPlugin","RadioGruidNumberInputPlugin","RadioGruidStringInputPlugin","RadioGruidBooleanInputPlugin","pane","EssentialsPlugin","nextBtn","fpsGraph","alight","dlight1","dlight2","controls","scenePass","outputPass","emissivePass","bloomPass","postProcessing","clock","avgFrameTimeBatchSize","animationCallback","postProcessingEnabled","tick","onFrame","togglePostProcessing","subsurfaceNormal","subsurfacePosition","surfaceNormal","viewVecDotSubsurfNormal","viewVec","subsurfaceBasicNormal","mipLevel","calcFinalColor","surfaceColor","mediumColor","thinMediumColor","subsurfaceTint","triplanarProject","textureSampler","absN","positionScaled","uvX","uvY","uvZ","componentsSum","blendX","blendY","blendZ","xColor","yColor","zColor","getSubsurfaceNormalFromCubeMap","normalCubeMap","getSubsurfaceNormalValue","getSubsurfaceNormalWithNormalMapping","tangentCubeMap","textureScale","bitangent","TBN","normalMapValue","mappedNormal","normalDotViewVec","buildSubsurfaceShader","modelSpaceCameraPos","mipMultiplier","minMipLevel","colorBoost","getSubsurfaceNormal","scaleFactor","subsurfaceIntersectionVector","buildEmissiveShader","emissiveMap","emission","mcolor","normalMaterial","tangentMaterial","createNormalCubeMap","normalsCubeRT","tangentsCubeRT","colorParams","_inverseModelMatrix","_cameraPosition","colorPresets","preset","updateUniform","subsurfaceShader","emissiveShader","loadingManager","textureLoader","loadedTextures","loadTexture","texuresConfig","colorMap","mirror","em","nm","applyTexture","applyScatteringPreset","overviewMaterial","initMeshMaterial","newMaterial","main","currentMeshIndex","meshGroup","applyMesh","nextMesh","assetsInfo"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,7,8,9,10,11]}